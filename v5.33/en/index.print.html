<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.119.0"><meta name=generator content="Relearn 5.23.2+tip"><meta name=description content="Learn how to build observability solutions with Splunk"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Learn how to build observability solutions with Splunk"><meta property="og:title" content="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Learn how to build observability solutions with Splunk"><meta property="og:type" content="website"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.33/en/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><title>Splunk Observability Workshops :: Splunk Observability Cloud Workshops</title><link href=https://splunk.github.io/observability-workshop/v5.33/en/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/v5.33/en/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/v5.33/ja/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/v5.33/en/index.html rel=canonical type=text/html title="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><link href=../en/index.xml rel=alternate type=application/rss+xml title="Splunk Observability Workshops :: Splunk Observability Cloud Workshops"><link href=../images/favicon.ico?1702058699 rel=icon type=image/x-icon sizes=any><link href=../css/fontawesome-all.min.css?1702058703 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fontawesome-all.min.css?1702058703 rel=stylesheet></noscript><link href=../css/nucleus.css?1702058703 rel=stylesheet><link href=../css/auto-complete.css?1702058703 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/auto-complete.css?1702058703 rel=stylesheet></noscript><link href=../css/perfect-scrollbar.min.css?1702058703 rel=stylesheet><link href=../css/fonts.css?1702058703 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../css/fonts.css?1702058703 rel=stylesheet></noscript><link href=../css/theme.css?1702058703 rel=stylesheet><link href=../css/theme-splunk-light.css?1702058703 rel=stylesheet id=R-variant-style><link href=../css/variant.css?1702058703 rel=stylesheet><link href=../css/print.css?1702058703 rel=stylesheet media=print><link href=../css/format-print.css?1702058703 rel=stylesheet><link href=../css/ie.css?1702058703 rel=stylesheet><script src=../js/url.js?1702058703></script>
<script src=../js/variant.js?1702058703></script>
<script>window.index_js_url="../en/index.search.js";var root_url="../",baseUri=root_url.replace(/\/$/,"");window.relearn=window.relearn||{},window.relearn.baseUriFull="https://splunk.github.io/observability-workshop/v5.33/",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script>
<script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script>
<script>SplunkRum.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rum",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g",app:"observability-workshop",version:"1",environment:"observability-workshop-env"}),SplunkSessionRecorder.init({beaconUrl:"https://rum-ingest.eu0.signalfx.com/v1/rumreplay",rumAuth:"EDIbCJR4LlxWdXMLjkYX1g"})</script><style>@media screen and (min-width:1000px){#R-body .flex-block-wrapper{margin-left:auto;margin-right:auto;max-width:1000px;width:100%}}:root{--MENU-WIDTH-L:21rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../en/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)">
<i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Splunk Observability Workshops</span><meta itemprop=position content="1"></li></ol><div class="topbar-area topbar-area-end" data-area=end></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable home" tabindex=-1><div class=flex-block-wrapper><article class=home><header class=headline></header><h1 id=splunk-observability-workshops>Splunk Observability Workshops</h1><p>Get insights into your applications and infrastructure in real-time with the help of the monitoring, analytics and response tools of the Splunk Observability Cloud</p><p>These workshops are going to take you through the best-in-class observability platform for ingesting, monitoring, visualizing and analyzing metrics, traces and logs.</p><p><a href=#R-image-6638723940c091e5b30083fc592ff5b8 class=lightbox-link><img src=../en/images/observability-hero-dashboard.gif alt=gif class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6638723940c091e5b30083fc592ff5b8><img src=../en/images/observability-hero-dashboard.gif alt=gif class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk Observability Workshops</h1><article class=default><header class=headline></header><h1 id=splunk4rookies---observability>Splunk4Rookies - Observability</h1><p><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span></span> <span class="badge cstyle blue badge-with-title"><span class=badge-title>Authors</span><span class=badge-content>Robert Castley & Pieter Hagen</span></span></p><p>In this workshop, we will be showing how Splunk Observability Cloud provides instant visibility of the user experience ‚Äì from the perspective of the front-end application to its back-end services ‚Äì Letting you experience some of the most compelling product features and differentiators of <strong>Splunk Observability Cloud</strong>:</p><ul><li>Infrastructure Monitoring</li><li><strong>Full-fidelity</strong> Real User Monitoring (RUM)</li><li>Complete <strong>end-to-end NoSample‚Ñ¢ Full-fidelity</strong> trace visibility with Application Performance Monitoring (APM)</li><li><strong>No code</strong> log querying</li><li>Synthetic Monitoring</li><li>Finding root causes with tag analytics and error stacks</li><li>Related content</li></ul><p>A key factor in building the Splunk Observability Cloud is to unify telemetry data to create a complete picture of an end-user experience and your application stack.</p><p>The workshop uses a microservices-based application that is deployed on AWS EC2 instances. The application is a simple e-commerce application that allows users to browse products, add them to a cart, and checkout. The application is instrumented with OpenTelemetry.</p><hr><p><strong><a href=https://opentelemetry.io target=_blank>OpenTelemetry</a></strong> is a collection of tools, APIs, and software development kits (SDKs), used to instrument, generate, collect, and export telemetry data (metrics, traces, and logs) to help you analyze your software‚Äôs performance and behavior.</p><p>The OpenTelemetry community is growing. As a joint project between Splunk, Google, Microsoft, Amazon, and many other organizations, it currently has the second-largest number of contributors in the Cloud Native Computing Foundation after Kubernetes.</p><p><a href=#R-image-af86270efba3b2391e04d77c7affeb51 class=lightbox-link><img src=../en/s4r/images/splunk-full-stack.png alt="Full Stack" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af86270efba3b2391e04d77c7affeb51><img src=../en/s4r/images/splunk-full-stack.png alt="Full Stack" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk4Rookies - Observability</h1><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 1</div><h1 id=workshop-overview>Workshop Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2 minutes</span></span><h4 id=introduction>Introduction</h4><p>The goal of this workshop is to experience an issue and use Splunk Observability Cloud to troubleshoot and identify the root cause. For this, we have provided a complete microservices-based application running in Kubernetes that has been instrumented to send <strong>metrics, traces, and logs</strong> to Splunk Observability Cloud.</p><h4 id=who-should-attend>Who should attend?</h4><p>Those wanting to gain an understanding of Splunk Observability in a hands-on environment. This workshop is designed for people with little or no experience with Splunk Observability.</p><h4 id=what-youll-need>What you‚Äôll need</h4><p>Just you, your laptop, and a browser that can access external websites. We run these workshops in person or on Zoom, if you don‚Äôt have the Zoom client on your device you will be able to access them via a web browser.</p><h4 id=whats-covered-in-this-workshop>What&rsquo;s covered in this workshop?</h4><p>This 3-hour session will take you through the basics of Splunk Observability, the only observability platform with <strong>streaming analytics</strong>, <strong>NoSample‚Ñ¢ Full Fidelity</strong> distributed tracing in a hands-on environment.</p><h5 id=opentelemetry>OpenTelemetry</h5><p>A Quick introduction to <strong>why OpenTelemetry</strong> and why is it important for Observability.</p><h5 id=tour-of-the-splunk-observability-user-interface>Tour of the Splunk Observability User Interface</h5><p>A walkthrough of the various components of Splunk Observability Cloud showing you how to easily navigate the 5 main components:- <strong>APM, RUM, Log Observer, Synthetics and Infrastructure</strong>.</p><h5 id=generate-real-user-data>Generate Real User Data</h5><p>Enjoy some retail therapy using the Online Boutique Website. Use your browser, mobile or tablet to spend some hard-earned virtual money to send <strong>metrics <em>(do we have a problem?)</em>, traces <em>(where is the problem?)</em> and logs <em>(what is the problem?)</em></strong>.</p><h5 id=splunk-real-user-monitoring-rum>Splunk Real User Monitoring (RUM)</h5><p>Examine the real user data that has been provided by the telemetry received from all participants&rsquo; browser sessions. The goal is to find a browser, mobile or tablet session that performed poorly and begin the troubleshooting process.</p><h5 id=splunk-application-performance-monitoring-apm>Splunk Application Performance Monitoring (APM)</h5><p>Discover the power of <strong>full end-to-end visibility</strong> by jumping from a RUM trace (front-end) to an APM trace (back-end). All the services are sending telemetry (traces and spans) that Splunk Observability Cloud can visualize, analyze and use to detect anomalies and errors.</p><h5 id=splunk-log-observer-lo>Splunk Log Observer (LO)</h5><p>Related Content is a powerful feature that allows you to jump from one component to another. In this case, we will jump from the APM trace to the logs to the related logs.</p><h5 id=splunk-synthetics>Splunk Synthetics</h5><p>Wouldn‚Äôt it be great if we could have <strong>24/7</strong> monitoring of our application, and be <strong>alerted</strong> when there is a problem? This is where Synthetics comes in. We will show you a simple test that runs every 1 minute and checks the performance and availability of a typical user journey through the Online Boutique.</p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 2</div><h1 id=what-is-opentelemetry--why-should-you-care>What is OpenTelemetry & why should you care?</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2 minutes</span></span><h2 id=opentelemetry>OpenTelemetry</h2><p>With the rise of cloud computing, microservices architectures, and ever-more complex business requirements, the need for Observability has never been greater. Observability is the ability to understand the internal state of a system by examining its outputs. In the context of software, this means being able to understand the internal state of a system by examining its telemetry data, which includes <strong>metrics</strong>, <strong>traces</strong>, and <strong>logs</strong>.</p><p>To make a system observable, it must be instrumented. That is, the code must emit traces, metrics, and logs. The instrumented data must then be sent to an Observability back-end such as <strong>Splunk Observability Cloud</strong>.</p><table><thead><tr><th style=text-align:center>Metrics</th><th style=text-align:center>Traces</th><th style=text-align:center>Logs</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>Do I have a problem?</strong></em></td><td style=text-align:center><em><strong>Where is the problem?</strong></em></td><td style=text-align:center><em><strong>What is the problem?</strong></em></td></tr></tbody></table><p>OpenTelemetry does two important things:</p><ul><li>Allows you to <strong>own</strong> the data that you generate rather than be stuck with a proprietary data format or tool.</li><li>Allows you to learn <strong>a single set</strong> of APIs and conventions</li></ul><p>These two things combined enable teams and organizations the flexibility they need in today‚Äôs modern computing world.</p><p>There are a lot of variables to consider when getting started with Observability, including the all-important question: <em>&ldquo;How do I get my data into an Observability tool?&rdquo;</em>. The industry-wide adoption of OpenTelemetry makes this question easier to answer than ever.</p><h2 id=why-should-you-care>Why Should You Care?</h2><p>OpenTelemetry is completely open-source and free to use. In the past, monitoring and Observability tools relied heavily on proprietary agents meaning that the effort required to change or set up additional tooling required a large amount of changes across systems, from the infrastructure level to the application level.</p><p>Since OpenTelemetry is vendor-neutral and supported by many industry leaders in the Observability space, adopters can switch between supported Observability tools at any time with minor changes to their instrumentation. This is true regardless of which distribution of OpenTelemetry is used ‚Äì like with Linux, the various distributions bundle settings and add-ons but are all fundamentally based on the community-driven OpenTelemetry project.</p><p>Splunk has fully committed to OpenTelemetry so that our customers can collect and use <strong>ALL</strong> their data, in any type, any structure, from any source, on any scale, and all in real-time. OpenTelemetry is fundamentally changing the monitoring landscape, enabling IT and DevOps teams to bring data to every question and every action. You will experience this during these workshops.</p><p><a href=#R-image-0fb55e282c095dafe22caf79ffe6b1a8 class=lightbox-link><img src=../en/s4r/2-opentelemetry/images/otel.png alt="OpenTelemetry Logo" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0fb55e282c095dafe22caf79ffe6b1a8><img src=../en/s4r/2-opentelemetry/images/otel.png alt="OpenTelemetry Logo" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 3</div><h1 id=ui---quick-tour->UI - Quick Tour üöå</h1><p>We are going to start with a short walkthrough of the various components of Splunk Observability Cloud. The aim of this is to get you familiar with the UI.</p><ol><li><strong>Signing in to Splunk Observability Cloud</strong></li><li><strong>Real User Monitoring (RUM)</strong></li><li><strong>Application Performance Monitoring (APM)</strong></li><li><strong>Log Observer</strong></li><li><strong>Synthetics</strong></li><li><strong>Infrastructure Monitoring</strong></li></ol><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (‚óÄÔ∏è) and right (‚ñ∂Ô∏è) cursor keys on your keyboard</li></ul></div></div><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of UI - Quick Tour üöå</h1><article class=default><header class=headline></header><h1 id=getting-started>Getting Started</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>2 minutes</span></span><h3 id=1-sign-in-to-splunk-observability-cloud>1. Sign in to Splunk Observability Cloud</h3><p>You should have received an e-mail from Splunk inviting you to the Workshop Org. This e-mail will look like the screenshot below, if you cannot find it, please check your Spam/Junk folders or inform your Instructor. You can also check for other solutions in our <a href=../en/s4r/3-quick-tour/1-homepage/99-login-faq/index.html><strong>login F.A.Q.</strong></a>.</p><p>To proceed click the <strong>Join Now</strong> button or click on the link provided in the e-mail.</p><p>If you have already completed the registration process you can skip the rest and proceed directly to Splunk Observability Cloud and log in:</p><ul><li><a href=https://app.eu0.signalfx.com target=_blank><strong>https://app.eu0.signalfx.com (EMEA)</strong></a></li><li><a href=https://app.us1.signalfx.com target=_blank><strong>https://app.us1.signalfx.com (APAC/AMER)</strong></a></li></ul><p><a href=#R-image-11cb5325b89bcf229777c2784803eca5 class=lightbox-link><img src="../en/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw" alt=email class="figure-image noborder lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11cb5325b89bcf229777c2784803eca5><img src="../en/s4r/3-quick-tour/1-homepage/images/invite-email.png?width=25vw" alt=email class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If this is your first time using Splunk Observability Cloud, you will be presented with the registration form. Enter your full name, and desired password. Please note that the password requirements are:</p><ul><li><strong>Must</strong> be between 8 and 32 characters</li><li><strong>Must</strong> contain at least one capital letter</li><li><strong>Must</strong> have at least one number</li><li><strong>Must</strong> have at least one symbol (e.g. !@#$%^&*()_+)</li></ul><p>Click the checkbox to agree to the terms and conditions and click the <strong>SIGN IN NOW</strong> button.</p><p><a href=#R-image-ad7e042abc827c199014a4dcae71593d class=lightbox-link><img src="../en/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw" alt=User-Setup class="figure-image noborder lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ad7e042abc827c199014a4dcae71593d><img src="../en/s4r/3-quick-tour/1-homepage/images/enter-password.png?width=25vw" alt=User-Setup class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Getting Started</h1><article class=default><header class=headline></header><h1 id=home-page>Home Page</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>After you have registered and logged into Splunk Observability Cloud you will be taken to the home or landing page. Here, you will find several useful features to help you get started.</p><p><a href=#R-image-e361babd6f3fe7894138de65f81b36c0 class=lightbox-link><img src=../en/s4r/3-quick-tour/1-homepage/1-home-page/../images/home-screen.png alt="home page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e361babd6f3fe7894138de65f81b36c0><img src=../en/s4r/3-quick-tour/1-homepage/1-home-page/../images/home-screen.png alt="home page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Explore your data pane:</strong> Displays which integrations are enabled and allows you to add additional integrations if you are an Administrator.</li><li><strong>Documentation pane:</strong> Training videos and links to documentation to get you started with Splunk Observability Cloud.</li><li><strong>Recents pane:</strong> Recently created/visited dashboards and/or detectors for quick access.</li><li><strong>Main Menu pane:</strong> Navigate the components of Splunk Observability Cloud.</li><li><strong>Org Switcher:</strong> Easily switch between Organizations (if you are a member of more than one Organization).</li><li><strong>Expand/Contract Main Menu:</strong> Expand <strong>&#187;</strong> / Collapse <strong>&#171;</strong> the main menu if space is at a premium.</li></ol><p>Let&rsquo;s start with our first exercise:</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Expand the Main Menu and click on <strong>Settings</strong>.</li><li>Check in the <strong>Org Switcher</strong> if you have access to more than one Organization.</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>If you have used Splunk Observability before, you may be placed in an Organization you have used previously. Make sure you are in the correct workshop organization. Verify this with your instructor if you have access to multiple Organizations.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click <strong>Onboarding Guidance</strong> (Here you can toggle the visibility of the onboarding panes. This is useful if you know the product well enough, and can use the space to show more information).</li><li>Hide the Onboarding Content for the <strong>Home Page</strong>.</li><li>At the bottom of the menu, select your preferred appearance: <strong>Light</strong>, <strong>Dark</strong> or <strong>Auto</strong> mode.</li><li>Did you also notice this is where the <strong>Sign Out</strong> option is? Please don&rsquo;t üòä !</li><li>Click <strong>&lt;</strong> to get back to the main menu.</li></ul></div></div><p>Next, let&rsquo;s check out <strong>Splunk Real User Monitoring (RUM)</strong>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=real-user-monitoring-overview>Real User Monitoring Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk RUM is the industry‚Äôs only end-to-end, <strong>NoSample‚Ñ¢</strong> RUM solution - providing visibility into the full user experience of every web and mobile session to uniquely combine all front-end traces with back-end metrics, traces, and logs as they happen. IT Operations and Engineering teams can quickly scope, prioritize and isolate errors, measure how performance impacts real users and optimize end-user experiences by correlating performance metrics alongside video reconstructions of all user interactions.</p><p><strong>Full user session analysis:</strong> Streaming analytics capture full user sessions from single and multi-page apps, measuring the customer impact of every resource, image, route change and API call.<br><strong>Correlate issues faster:</strong> Infinite cardinality and full transaction analysis help you pinpoint and correlate issues faster across complex distributed systems.<br><strong>Isolate latency and errors:</strong> Easily identify latency, errors and poor performance for each code change and deployment. Measure how content, images and third-party dependencies impact your customers.<br><strong>Benchmark and improve page performance:</strong> Leverage core web vitals to measure and improve your page load experience, interactivity and visual stability. Find and fix impactful JavaScript errors, and easily understand which pages to improve first.<br><strong>Explore meaningful metrics:</strong> Instantly visualize the customer impact with metrics on specific workflows, custom tags and auto-suggest un-indexed tags to quickly find the root cause of issues.<br><strong>Optimize end-user experience:</strong> Correlate performance metrics alongside video reconstructions of all user interactions to optimize end-user experiences.</p><p><a href=#R-image-e3bcc9b8caa36f35b9de91d2cc5d330d class=lightbox-link><img src=../en/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3bcc9b8caa36f35b9de91d2cc5d330d><img src=../en/s4r/3-quick-tour/2-rum-home/images/rum-architecture.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Real User Monitoring Overview</h1><article class=default><header class=headline></header><h1 id=real-user-monitoring-home-page>Real User Monitoring Home Page</h1><p>Click <strong>RUM</strong> in the main menu, this will bring you to the main RUM Home or Landing page. The main concept of this page is to provide you at a glance, the overall status of all selected RUM applications, either in a full dashboard or the compact view.</p><p>Independent of the type of Status Dashboard used, the RUM Home Page is made up of 3 distinct sections:</p><p><a href=#R-image-411e716e17d1ac5047da14e6956d831c class=lightbox-link><img src=../en/s4r/3-quick-tour/2-rum-home/1-rum-home/../images/rum-main.png alt="RUM Page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-411e716e17d1ac5047da14e6956d831c><img src=../en/s4r/3-quick-tour/2-rum-home/1-rum-home/../images/rum-main.png alt="RUM Page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk RUM. (You can hide this pane in case you need the screen real estate).</li><li><strong>Filter Pane:</strong> Filter on the time frame, environment, application and source type.</li><li><strong>Application Summary Pane:</strong> Summary of all your applications that send RUM data.</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> RUM Environments & Application and Source Type</div><div class=box-content><ul><li>Splunk Observability uses the <strong>environments</strong> Tag that is sent as part of the RUM trace, (created with every interaction with your website or Mobile App), to separate data coming from different environments like &ldquo;Production&rdquo; or &ldquo;Development&rdquo;.</li><li>A further separation can be made by the <strong>Applications</strong> Tag. This allows you to distinguish between separate browser/mobile applications running in the same environment.</li><li>Splunk RUM is available for both browser and mobile applications, you could use <strong>Source Type</strong> to distinguish between them, however for this workshop, we will only use browser-based RUM.</li></ul></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Ensure the time window is set to <strong>-15m</strong></li><li>Select the environment for your workshop from the drop-down box. The naming convention is <strong>[NAME OF WORKSHOP]</strong> (Selecting this will make sure the workshop RUM application is visible)</li><li>Select the <strong>App</strong> name. There the naming convention is <strong>[NAME OF WORKSHOP]-shop</strong> and leave <strong>Source</strong> set to <strong>All</strong></li><li>In the <strong>JavaScript Errors</strong> tile click on the <strong>TypeError</strong> entry that says: <em>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</em> to see more details. Note that you are given a quick indication of what part of the website the error occurred, allowing you to fix this quickly.</li><li>Close the pane.</li><li>The 3rd tile reports <strong>Web Vitals</strong>, a metric that focuses on three important aspects of the user experience: <em>loading</em>, <em>interactivity</em>, and <em>visual stability</em>.</li></ul><div class=tab-panel data-tab-group=1ab282c62c36b89f159a6380c54453b8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("1ab282c62c36b89f159a6380c54453b8","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1ab282c62c36b89f159a6380c54453b8","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Based on the <strong>Web Vitals</strong> metrics, how do you rate the current web performance of the site?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>According to the <em>Web Vitals</em> Metrics, the initial load of the site is OK and is rated <em>Good</em></strong></p></div></div></div></div><ul><li>The last tile, <strong>Most recent detectors</strong> tile, will show if any alerts have been triggered for the application.</li><li>Click on the down <strong>‚åµ</strong> arrow in front of the Application name to toggle the view to the compact style. Note that you have all the main information available in this view as well. Click anywhere in the compact view to go back to the full view.</li></ul></div></div><p>Next, let&rsquo;s check out <strong>Splunk Application Performance Monitoring (APM)</strong>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=real-user-monitoring-home-page>Real User Monitoring Home Page</h1><p>Click <strong>RUM</strong> in the main menu, this will bring you to the main RUM Home or Landing page. The main concept of this page is to provide you at a glance, the overall status of all selected RUM applications, either in a full dashboard or the compact view.</p><p>Independent of the type of Status Dashboard used, the RUM Home Page is made up of 3 distinct sections:</p><p><a href=#R-image-41be9613b12376051c8fbeac8c7159e4 class=lightbox-link><img src=../en/s4r/3-quick-tour/2-rum-home/2-rum-home/../images/rum-main.png alt="RUM Page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-41be9613b12376051c8fbeac8c7159e4><img src=../en/s4r/3-quick-tour/2-rum-home/2-rum-home/../images/rum-main.png alt="RUM Page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk RUM. (You can hide this pane in case you need the screen real estate).</li><li><strong>Filter Pane:</strong> Filter on the time frame, environment, application and source type.</li><li><strong>Application Summary Pane:</strong> Summary of all your applications that send RUM data.</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> RUM Environments & Application and Source Type</div><div class=box-content><ul><li>Splunk Observability uses the <strong>environments</strong> Tag that is sent as part of the RUM trace, (created with every interaction with your website or Mobile App), to separate data coming from different environments like &ldquo;Production&rdquo; or &ldquo;Development&rdquo;.</li><li>A further separation can be made by the <strong>Applications</strong> Tag. This allows you allows you to distinguish between separate browser/mobile applications running in the same environment.</li><li>Splunk RUM is available for both browser and mobile applications, you could use <strong>Source Type</strong> to distinguish between them, however for this workshop, we will only use browser-based RUM.</li></ul></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Ensure the time window is set to <strong>-15m</strong></li><li>Select the environment for your workshop from the drop-down box. The naming convention is <strong>[NAME OF WORKSHOP]</strong> (Selecting this will make sure the workshop RUM application is visible)</li><li>Select the application from the <strong>App</strong> drop down. The naming convention is <strong>[NAME OF WORKSHOP]-store</strong> and leave <strong>Source</strong> set to <strong>All</strong></li><li>In the <strong>JavaScript Errors</strong> tile click on the <strong>TypeError</strong> entry that says: <em>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</em> to see more details. Note that you are given a quick indication of the part of the website where the error occurred, allowing you to fix this quickly.</li><li>Close the pane.</li><li>The 3rd tile reports <strong>Web Vitals</strong>, a metric that focuses on three important aspects of the user experience: <em>Largest Contentful Paint(LCP)</em>, <em>First Input Delay(FID)</em>, and <em>Cumulative Layout Shift(CLS)</em>.</li></ul><div class=tab-panel data-tab-group=1eebd53d51e0631518479abb40981696><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("1eebd53d51e0631518479abb40981696","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1eebd53d51e0631518479abb40981696","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Based on the <strong>Web Vitals</strong> information provided, how do you rate the current web performance of the site?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>According the <em>Web Vitals</em> Metrics, the initial loading of the site is ok, and overall rating is <em>Good Performance</em></strong></p></div></div></div></div><ul><li>The last tile, <strong>Most recent detectors</strong>, will show if any alerts have been triggered for the application.</li><li>Click on the down <strong>‚åµ</strong> arrow in front of the Application name to toggle the view to the compact style. Note that you have all the main information available in this view as well. Click anywhere in the compact view to go back to the full view.</li></ul></div></div><p>We will revisit RUM in more detail later. Next, let&rsquo;s check out <strong>Splunk Application Performance Monitoring (APM)</strong>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=application-performance-monitoring-overview>Application Performance Monitoring Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk APM provides a <strong>NoSample‚Ñ¢</strong> end-to-end visibility of every service and its dependency to solve problems quicker across monoliths and microservices. Teams can immediately detect problems from new deployments, confidently troubleshoot by scoping and isolating the source of an issue, and optimize service performance by understanding how back-end services impact end users and business workflows.</p><p><strong>Real-time monitoring and alerting:</strong> Splunk provides out-of-the-box service dashboards and automatically detects and alerts on RED metrics (rate, error and duration) when there is a sudden change.
<strong>Dynamic telemetry maps:</strong> Easily visualize service performance in modern production environments in real-time. End-to-end visibility of service performance from infrastructure, applications, end users, and all dependencies helps quickly scope new issues and troubleshoot more effectively.<br><strong>Intelligent tagging and analysis:</strong> View all tags from your business, infrastructure and applications in one place to easily compare new trends in latency or errors to their specific tag values.<br><strong>AI-directed troubleshooting identifies the most impactful issues:</strong> Instead of manually digging through individual dashboards, isolate problems more efficiently. Automatically identify anomalies and the sources of errors that impact services and customers the most.<br><strong>Complete distributed tracing analyses every transaction:</strong> Identify problems in your cloud-native environment more effectively. Splunk distributed tracing visualizes and correlates every transaction from the back-end and front-end in context with your infrastructure, business workflows and applications.<br><strong>Full stack correlation:</strong> Within Splunk Observability, APM links traces, metrics, logs and profiling together to easily understand the performance of every component and its dependency across your stack.<br><strong>Monitor database query performance:</strong> Easily identify how slow and high execution queries from SQL and NoSQL databases impact your services, endpoints and business workflows ‚Äî no instrumentation required.</p><p><a href=#R-image-abaf1ef23e48292e60e491bc4d99e8cc class=lightbox-link><img src=../en/s4r/3-quick-tour/3-apm-home/images/arch-overview.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-abaf1ef23e48292e60e491bc4d99e8cc><img src=../en/s4r/3-quick-tour/3-apm-home/images/arch-overview.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Application Performance Monitoring Overview</h1><article class=default><header class=headline></header><h1 id=application-performance-monitoring-home-page>Application Performance Monitoring Home page</h1><p>Click <strong>APM</strong> in the main menu, the APM Home Page is made up of 3 distinct sections:</p><p><a href=#R-image-9a19ff40027f409873b1e8f0a8fae675 class=lightbox-link><img src=../en/s4r/3-quick-tour/3-apm-home/1-apm-home/../images/apm-main.png alt="APM page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a19ff40027f409873b1e8f0a8fae675><img src=../en/s4r/3-quick-tour/3-apm-home/1-apm-home/../images/apm-main.png alt="APM page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane Pane:</strong> Training videos and links to documentation to get you started with Splunk APM.</li><li><strong>APM Overview Pane:</strong> Real-time metrics for the Top Services and Top Business Workflows.</li><li><strong>Functions Pane:</strong> Links for deeper analysis of your services, tags, traces, database query performance and code profiling.</li></ol><p>The <strong>APM Overview</strong> pan provides a high-level view of the health of your application. It includes a summary of the services, latency and errors in your application. It also includes a list of the top services by error rate and the top business workflows by error rate (a business workflow is the start-to-finish journey of the collection of traces associated with a given activity or transaction and enables monitoring of end-to-end KPIs and identifying root causes and bottlenecks).</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> About Environments</div><div class=box-content><p>To easily differentiate between multiple applications, Splunk uses <strong>environments</strong>. The naming convention for workshop environments is <strong>[NAME OF WORKSHOP]-workshop</strong>. Your instructor will provide you with the correct one to select.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Verify that the time window we are working with is set to the last 15 minutes (<strong>-15m</strong>).</li><li>Change the environment to the workshop one by selecting its name from the drop-down box and make sure that is the only one selected.</li></ul><div class=tab-panel data-tab-group=89396887e895418438f1305fb17fbee8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("89396887e895418438f1305fb17fbee8","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("89396887e895418438f1305fb17fbee8","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What can you conclude from the <em>Top Services by Error Rate</em> chart?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The <em>paymentservice</em> has a high error rate</strong></p></div></div></div></div></div></div><p>If you scroll down the Overview Page you will notice some services listed have <strong>Inferred Service</strong> next to them.</p><p>Splunk APM can infer the presence of the remote service, or inferred service if the span calling the remote service has the necessary information. Examples of possible inferred services include databases, HTTP endpoints, and message queues. Inferred services are not instrumented, but they are displayed on the service map and the service list.</p><p>Next, let&rsquo;s check out <strong>Splunk Log Observer (LO)</strong>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=log-observer-overview>Log Observer Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Log Observer Connect allows you to seamlessly bring in the same log data from your Splunk Platform into an intuitive and <strong>no-code</strong> interface designed to help you find and fix problems quickly. You can easily perform log-based analysis and seamlessly correlate your logs with Splunk Infrastructure Monitoring‚Äôs real-time metrics and Splunk APM traces in one place.</p><p><strong>End-to-end visibility:</strong> By combining the powerful logging capabilities of Splunk Platform with Splunk Observability Cloud‚Äôs traces and real-time metrics for deeper insights and more context of your hybrid environment.<br><strong>Perform quick and easy log-based investigations:</strong> By reusing logs that are already ingested in Splunk Cloud Platform or Enterprise in a simplified and intuitive interface (no need to know SPL!) with customizable and out-of-the-box dashboards<br><strong>Achieve higher economies of scale and operational efficiency:</strong> By centralizing log management across teams, breaking down data and team silos, and getting better overall support</p><p><a href=#R-image-c7674fd02c0d01893a16e8cb74732d50 class=lightbox-link><img src=../en/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png alt="Logo graph" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c7674fd02c0d01893a16e8cb74732d50><img src=../en/s4r/3-quick-tour/4-log-observer-home/images/logo-image-loop.png alt="Logo graph" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Log Observer Overview</h1><article class=default><header class=headline></header><h1 id=log-observer-home-page>Log Observer Home Page</h1><p>Click <strong>Log Observer</strong> in the main menu, the Log Observer Home Page is made up of 4 distinct sections:</p><p><a href=#R-image-dc76aaf0b32f489bcac4198ee17cdb84 class=lightbox-link><img src=../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-observer-main.png alt="Lo Page" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc76aaf0b32f489bcac4198ee17cdb84><img src=../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-observer-main.png alt="Lo Page" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk Log Observer.</li><li><strong>Filter Bar:</strong> Filter on time, indexes, and fields and also Save Queries.</li><li><strong>Logs Table Pane:</strong> List of log entries that match the current filter criteria.</li><li><strong>Fields Pane:</strong> List of fields available in the currently selected index.</li></ol><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Splunk indexes</div><div class=box-content><p>Generally, in Splunk, an &ldquo;index&rdquo; refers to a designated place where your data is stored. It&rsquo;s like a folder or container for your data. Data within a Splunk index is organized and structured in a way that makes it easy to search and analyze. Different indexes can be created to store specific types of data. For example, you might have one index for web server logs, another for application logs, and so on.</p></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>If you have used Splunk Enterprise or Splunk Cloud before, you are probably used to starting investigations with logs. As you will see in the following exercise, you can do that with Splunk Observability Cloud as well. This workshop, however, will use all the <strong>OpenTelemetry</strong> signals for investigations.</p></div></div><p>Let&rsquo;s run a little search exercise:</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>Set the time frame to <strong>-15m</strong>.</p></li><li><p>Click on
<span class="btn cstyle gray"><button type=button>
Add Filter</button></span> in the filter bar then click on <strong>Fields</strong> in the dialog.</p></li><li><p>Type in <strong>cardType</strong> and select it.</p></li><li><p>Under <strong>Top values</strong> click on <strong>visa</strong>, then click on <strong>=</strong> to add it to the filter.</p><p><a href=#R-image-aa126f3f6421e9cbd0e418d853376723 class=lightbox-link><img src="../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-filter-bar.png?width=920px" alt="logo search" class="figure-image noborder lightbox noshadow" style=height:auto;width:920px loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa126f3f6421e9cbd0e418d853376723><img src="../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/log-filter-bar.png?width=920px" alt="logo search" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>Click on one of the log entries in the Logs table to validate that the entry contains <code>cardType: "visa"</code>.</p></li><li><p>Let&rsquo;s find all the orders that have been shipped. Click on <strong>Clear All</strong> in the filter bar to remove the previous filter.</p></li><li><p>Click again on
<span class="btn cstyle gray"><button type=button>
Add Filter</button></span> in the filter bar, then select <strong>Keyword</strong>. Next just type <code>order:</code> in the <strong>Enter Keyword&mldr;</strong> box and press enter.</p></li><li><p>You should now only have log lines that contain the word &ldquo;order:&rdquo;. There are still a lot of log lines, so let&rsquo;s filter some more.</p></li><li><p>Add another filter, this time select the <strong>Fields</strong> box, then type <code>severity</code> in the <strong>Find a field&mldr;</strong> search box and select it.
<a href=#R-image-a7d3aa1ac62c9ea8b5bcd0a5b6ba7965 class=lightbox-link><img src="../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/find-severity.png?width=15vw&amp;classes=left" alt=severity class="figure-image noborder left lightbox noshadow" style=height:auto;width:15vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a7d3aa1ac62c9ea8b5bcd0a5b6ba7965><img src="../en/s4r/3-quick-tour/4-log-observer-home/1-log-observer-home/../images/find-severity.png?width=15vw&amp;classes=left" alt=severity class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></p></li><li><p>Make sure you click the
<span class="btn cstyle gray"><button type=button>
<strong>Exclude all logs with this fields</strong></button></span> at the bottom of the dialog box, as the order log line does not have a severity assigned. This will remove the others.</p></li><li><p>You may need to scroll down the page if you still have the onboarding content displayed at the top to see the <strong>Exclude all logs with this fields</strong> button.</p></li><li><p>You should now have a list of orders sold for the last 15 minutes.</p></li></ul></div></div><p>Next, let&rsquo;s check out <strong>Splunk Synthetics</strong>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=synthetics-overview>Synthetics Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk Synthetic Monitoring provides visibility across URLs, APIs and critical web services to solve problems faster. IT Operations and engineering teams can easily detect, alert and prioritize issues, simulate multi-step user journeys, measure business impact from new code deployments and optimize web performance with guided step-by-step recommendations to ensure better digital experiences.</p><p><strong>Ensure Availability:</strong> Proactively monitor and alert on the health and availability of critical services, URLs and APIs with customizable browser tests to simulate multi-step workflows that make up the user experience.<br><strong>Improve Metrics:</strong> Core Web Vitals and modern performance metrics allow users to view all their performance defects in one place, measure and improve page load, interactivity and visual stability, and find and fix JavaScript errors to improve page performance.<br><strong>front-end to back-end:</strong> Integrations with Splunk APM, Infrastructure Monitoring, On-Call and ITSI help teams view endpoint uptime against back-end services, the underlying infrastructure and within their incident response coordination so they can troubleshoot across their entire environment, in a single UI.<br><strong>Detect and Alert:</strong> Monitor and simulate end-user experiences to detect, communicate and resolve issues for APIs, service endpoints and critical business transactions before they impact customers.<br><strong>Business Performance:</strong> Easily define multi-step user flows for key business transactions and start recording and testing your critical user journeys in minutes. Track and report SLAs and SLOs for uptime and performance.<br><strong>Filmstrips and Video Playback:</strong> View screen recordings, film strips, and screenshots alongside modern performance scores, competitive benchmarking, and metrics to visualize artificial end-user experiences. Optimize how fast you deliver visual content, and improve page stability and interactivity to deploy better digital experiences.</p><p><a href=#R-image-7202c71c1746af51d289d46507a1e8aa class=lightbox-link><img src=../en/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png alt="Synthetics overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7202c71c1746af51d289d46507a1e8aa><img src=../en/s4r/3-quick-tour/5-synthetics-home/images/synthetic-tests.png alt="Synthetics overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Synthetics Overview</h1><article class=default><header class=headline></header><h1 id=synthetics-home-page>Synthetics Home Page</h1><p>Click on <strong>Synthetics</strong> in the main menu. This will bring us to the Synthetics Home Page. It has 3 distinct sections that provide either useful information or allow you to pick or create a Synthetic Test.</p><p><a href=#R-image-450102e1150190118c17fcd4bcfde4c1 class=lightbox-link><img src=../en/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-main.png alt="Synthetic main" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-450102e1150190118c17fcd4bcfde4c1><img src=../en/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-main.png alt="Synthetic main" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk Synthetics.</li><li><strong>Test Pane:</strong> List of all the tests that are configured (<strong>Browser</strong>, <strong>API</strong> and <strong>Uptime</strong>)</li><li><strong>Create Test Pane:</strong> Drop-down for creating new Synthetic tests.</li></ol><p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>As part of the workshop we have created a default browser test against the application we are running. You find it in the Test Pane (<strong>2</strong>). It will have the following name <strong>Workshop Browser Test for</strong>, followed by the name of your Workshop (your instructor should have provided that to you).</p></div></div>To continue our tour, let&rsquo;s look at the result of our workshop&rsquo;s automatic browser test.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the Test Pane, click on the line that contains the name of your workshop. The result should look like this:</li></ul><p><a href=#R-image-5ca9b0016942f104c871e28f44d6c62b class=lightbox-link><img src=../en/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-test-overview.png alt=Synthetics-overview class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ca9b0016942f104c871e28f44d6c62b><img src=../en/s4r/3-quick-tour/5-synthetics-home/1-synthetics-home/../images/synthetics-test-overview.png alt=Synthetics-overview class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Note, On the Synthetic Tests Page, the first pane will show the performance of your site for the last day, 8 days and 30 days. As shown in the screenshot above, only if a test started far enough in the past, the corresponding chart will contain valid data. For the workshop, this depends on when it was created.</li><li>In the Performance KPI drop-down, change the time from the default 4 hours to the 1 last hour.</li></ul><div class=tab-panel data-tab-group=3ca00a0d56256bfaaff89abc09629b86><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3ca00a0d56256bfaaff89abc09629b86","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3ca00a0d56256bfaaff89abc09629b86","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>How often is the test run, and from where?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The test runs at <strong>a 1-minute <strong>round-robin</strong> interval from</strong> Frankfurt, London and Paris</strong></p></div></div></div></div></div></div><p>Next, let‚Äôs examine the infrastructure our application is running on using <strong>Splunk Infrastructure Monitoring (IM)</strong>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=infrastructure-overview>Infrastructure Overview</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><p>Splunk Infrastructure Monitoring (IM) is a market-leading monitoring and observability service for hybrid cloud environments. Built on a patented streaming architecture, it provides a <strong>real-time</strong> solution for engineering teams to visualize and analyze performance across infrastructure, services, and applications in a fraction of the time and with greater accuracy than traditional solutions.</p><p><strong>OpenTelemetry standardization:</strong> Gives you full control over your data ‚Äî freeing you from vendor lock-in and implementing proprietary agents.<br><strong>Splunk‚Äôs OTel Collector:</strong> Seamless installation and dynamic configuration, auto-discovers your entire stack in seconds for visibility across clouds, services, and systems.<br><strong>300+ Easy-to-use OOTB content:</strong> Pre-built navigators and dashboards, deliver immediate visualizations of your entire environment so that you can interact with all your data in real time.<br><strong>Kubernetes navigator:</strong> Provides an instant, comprehensive out-of-the-box hierarchical view of nodes, pods, and containers. Ramp up even the most novice Kubernetes user with easy-to-understand interactive cluster maps.<br><strong>AutoDetect alerts and detectors:</strong> Automatically identify the most important metrics, out-of-the-box, to create alert conditions for detectors that accurately alert from the moment telemetry data is ingested and use real-time alerting capabilities for important notifications in seconds.<br><strong>Log views in dashboards:</strong> Combine log messages and real-time metrics on one page with common filters and time controls for faster in-context troubleshooting.<br><strong>Metrics pipeline management:</strong> Control metrics volume at the point of ingest without re-instrumentation with a set of aggregation and data-dropping rules to store and analyze only the needed data. Reduce metrics volume and optimize observability spend.</p><p><a href=#R-image-2698e037bbd79c0e621a17722fc48bbe class=lightbox-link><img src=../en/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png alt="Infrastructure Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2698e037bbd79c0e621a17722fc48bbe><img src=../en/s4r/3-quick-tour/6-infrastructure-home/images/infrastructure-overview.png alt="Infrastructure Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Infrastructure Overview</h1><article class=default><header class=headline></header><h1 id=infrastructure-navigators>Infrastructure Navigators</h1><p>Click on <strong>Infrastructure</strong> in the main menu, the Infrastructure Home Page is made up of 4 distinct sections.</p><p><a href=#R-image-95dd375565f6c0d488647d5a0fde4632 class=lightbox-link><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/infrastructure-main.png alt="Infra main" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-95dd375565f6c0d488647d5a0fde4632><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/infrastructure-main.png alt="Infra main" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Onboarding Pane:</strong> Training videos and links to documentation to get you started with Splunk Infrastructure Monitoring.</li><li><strong>Time & Filter Pane:</strong> Time window (not configurable at the top level)</li><li><strong>Integrations Pane:</strong> List of all the technologies that are sending metrics to Splunk Observability Cloud.</li><li><strong>Tile Pane:</strong> Total number of services being monitored broken down by integration.</li></ol><p>Using the Infrastructure pane, we can select the infrastructure/technology we are interested in, let&rsquo;s do that now.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>Under the <strong>Containers</strong> section in the Integrations Pane (<strong>3</strong>), select <strong>Kubernetes</strong> as the technology you wish to examine.</p></li><li><p>This should show you two tiles, <strong>K8s Nodes</strong> and <strong>K8s Workloads</strong>.</p></li><li><p>The bottom part of each tile will have a history graph and the top part will show notifications for alerts that fired. Across all tiles, this additional information on each of the tiles will give you a good overview of the health of your infrastructure.</p></li><li><p>Click on the <strong>K8s Nodes</strong> tile.</p></li><li><p>You will be presented with one or more representations of a Kubernetes Cluster.</p></li><li><p>Click on the
<span class="btn cstyle transparent"><button type=button>
Add filters</button></span> button. Type in <code>k8s.cluster.name</code> and click on the search result.</p></li><li><p>From the list, select <strong>[NAME OF WORKSHOP]-k3s-cluster</strong> then click on the
<span class="btn cstyle blue"><button type=button>
Apply Filter</button></span> button.</p><p><a href=#R-image-7cf525e5925dc08f91a33ed251595a2b class=lightbox-link><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/k8s-cluster.png alt=cluster class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7cf525e5925dc08f91a33ed251595a2b><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/k8s-cluster.png alt=cluster class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>The Kubernetes Navigator uses color to indicate health. As you can see there are two pods or services that are unhealthy and in a Failed state (<strong>1</strong>). The rest are healthy and running. This is not uncommon in shared Kubernetes environments, so we replicated that for the workshop.</p></li><li><p>Note the tiles to the side, under <strong>Nodes dependencies</strong> (<strong>2</strong>), specifically the MySQL and Redis tiles. These are the two databases used by our e-commerce application.</p></li></ul></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Node Dependencies</div><div class=box-content><p>The UI will show services that are running on the node you have selected if they have been configured to be monitored in the OpenTelemetry Collector.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the <strong>Redis</strong> tile and this will take you to the <strong>Redis instances</strong> navigator. Under <strong>REDIS INSTANCE</strong> click on <strong>redis-[NAME OF WORKSHOP]</strong>.</li><li>This will bring you to the <strong>Redis instance</strong>. This navigator will show charts with metric data from the active Redis instance from our e-commerce site.
<a href=#R-image-f466460edfb0aae2f69a6144f375acd4 class=lightbox-link><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/redis-2.png alt=redis class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f466460edfb0aae2f69a6144f375acd4><img src=../en/s4r/3-quick-tour/6-infrastructure-home/1-infrastructure-home/../images/redis-2.png alt=redis class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul><div class=tab-panel data-tab-group=0c28b7eea6012f8db4c2f0a32a353bab><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("0c28b7eea6012f8db4c2f0a32a353bab","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("0c28b7eea6012f8db4c2f0a32a353bab","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Can you name the Instance dependencies tile in this view?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Yes, there is one for Kubernetes.</strong></p></div></div></div></div>* Click the tile, it will bring us back into the Kubernetes Navigator, this time at the Pod level showing the Pod that runs the Redis Service.
* To return to the Cluster level, simply click on the link **Cluster** (**1**) at the top of the screen.
![node](../images/node-link.png)</div></div><p>This completes the tour of <strong>Splunk Observability Cloud</strong>.</p><p>Here, have some virtual üí∂ and let&rsquo;s go and look at our e-commerce site, the &lsquo;Online Boutique&rsquo; and do some shopping.</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=lets-go-shopping->Let's go shopping üí∂</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>5 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>You are a <strong>hip urban professional</strong>, longing to buy your next novelty items in the famous Online Boutique shop. You have heard that the Online Boutique is the place to go for all your hipster needs.</p></div></div><p>The purpose of this exercise is for you to interact with the Online Boutique web application. This is a sample application that is used to demonstrate the capabilities of Splunk Observability Cloud. The application is a simple e-commerce site that allows you to browse items, add them to your cart, and then checkout.</p><p>The application will already be deployed for you and your instructor will provide you with a link to the Online Boutique website.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise - Let&rsquo;s go shopping</div><div class=box-content><ul><li>Once you have the link to the Online Boutique, have a browse through a few items, add them to your cart and then, finally, do a checkout.</li><li>Repeat this exercise a few times and if possible use different browsers, mobile devices or tablets as this will generate more data for you to explore.</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>While you are waiting for pages to load, please move your mouse cursor around the page. This will generate more data for us to explore at a later date in this workshop.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise (cont.)</div><div class=box-content><ul><li>Did you notice anything about the checkout process? Did it seem to take a while to complete, but it did ultimately complete? When this happens please copy the <strong>Order Confirmation ID</strong> and save it locally somewhere as we will need it later.</li><li>Close the browser sessions you used to shop.</li></ul></div></div><p>This is what a poor user experience can feel like and since this is a potential customer satisfaction issue we had better jump on this and troubleshoot.</p><p><a href=#R-image-f89bf55ffa9cb2ef60dc6a8f1d2e66b6 class=lightbox-link><img src=../en/s4r/4-online-boutique/images/shop.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f89bf55ffa9cb2ef60dc6a8f1d2e66b6><img src=../en/s4r/4-online-boutique/images/shop.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Let‚Äôs go take a look at what the data looks like in <strong>Splunk RUM</strong>.</p><footer class=footline></footer></article><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 5</div><h1 id=splunk-rum>Splunk RUM</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>You are a <strong>frontend engineer</strong>, or an <strong>SRE</strong> tasked to do the first triage of a performance issue. You have been asked to investigate a potential customer satisfaction issue with the Online Boutique application.</p></div></div><p>We are going to examine the real user data that has been provided by the telemetry received from all participants&rsquo; browser sessions. The goal is to find a browser, mobile or tablet session that performed poorly and begin the troubleshooting process.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk RUM</h1><article class=default><header class=headline></header><h1 id=1-rum-dashboard>1. RUM Dashboard</h1><p>In Splunk Observability Cloud from the main menu, click on <strong>RUM</strong>. you arrive at the RUM Home page, this view has already been covered in the short introduction earlier.</p><p><a href=#R-image-18725bf56e67f983960fccdcf9b005a4 class=lightbox-link><img src=../en/s4r/5-rum/1-rum-dashboard/../images/multiple-apps.png alt="multiple apps" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-18725bf56e67f983960fccdcf9b005a4><img src=../en/s4r/5-rum/1-rum-dashboard/../images/multiple-apps.png alt="multiple apps" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Make sure you select your workshop by ensuring the drop-downs are set/selected as follows:<ul><li>The <strong>Time frame</strong> is set to <strong>-15m</strong>.</li><li>The <strong>Environment</strong> selected is <strong>[NAME OF WORKSHOP]-workshop</strong>.</li><li>The <strong>App</strong> selected is <strong>[NAME OF WORKSHOP]-store</strong>.</li><li>The <strong>Source</strong> is set to <strong>All</strong>.</li></ul></li><li>Next, click on the <strong>[NAME OF WORKSHOP]-store</strong> above the <strong>Page Views / JavaScript Errors</strong> chart.</li><li>This will bring up a new dashboard view breaking down the metrics by <strong>UX Metrics</strong>, <strong>Front-end Health</strong>, <strong>Back-end Health</strong> and <strong>Custom Events</strong> and comparing them to historic metrics (1 hour by default).</li></ul></div></div><p><a href=#R-image-8ebdba9d313f31bed020b9d90512dac9 class=lightbox-link><img src=../en/s4r/5-rum/1-rum-dashboard/../images/rum-dashboard.png alt="RUM Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8ebdba9d313f31bed020b9d90512dac9><img src=../en/s4r/5-rum/1-rum-dashboard/../images/rum-dashboard.png alt="RUM Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><strong>UX Metrics:</strong> Page Views, Page Load and Web Vitals metrics.</li><li><strong>Front-end Health:</strong> Breakdown of Javascript Errors and Long Task duration and count.</li><li><strong>Back-end Health:</strong> Network Errors and Requests and Time to First Byte.</li><li><strong>Custom Events:</strong> RED metrics (Rate, Error & Duration) for custom events.</li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click through each of the tabs (<strong>UX Metrics</strong>, <strong>Front-end Health</strong>, <strong>Back-end Health</strong> and <strong>Custom Events</strong>) and examine the data.</li></ul><div class=tab-panel data-tab-group=34a99b6970c9674afdf232dfc63e569c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("34a99b6970c9674afdf232dfc63e569c","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("34a99b6970c9674afdf232dfc63e569c","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>If you examine the charts in the <em>Custom Events</em> Tab, <strong>what chart <strong>shows</strong> clearly the</strong> latency Spikes?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>It is the <em>Custom Event Latency</em> chart</strong></p></div></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-tag-spotlight>2. Tag Spotlight</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>Make sure you are on the <strong>Custom Events</strong> tab by selecting it.</p></li><li><p>Have a look at the <strong>Custom Event Latency</strong> chart. The metrics shown here show the application latency. The comparison metrics to the side show the latency compared to 1 hour ago (which is selected in the top filter bar).</p></li><li><p>Click on the <strong>see all</strong> link under the chart title.</p></li></ul></div></div><p><a href=#R-image-00f583456767cd45f804abbcc7a67161 class=lightbox-link><img src=../en/s4r/5-rum/2-tag-spotlight/../images/rum-tag-spotlight.png alt="RUM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-00f583456767cd45f804abbcc7a67161><img src=../en/s4r/5-rum/2-tag-spotlight/../images/rum-tag-spotlight.png alt="RUM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In this dashboard view, you are presented with all the tags associated with the RUM data. Tags are key-value pairs that are used to identify the data. In this case, the tags are automatically generated by the OpenTelemetry instrumentation. The tags are used to filter the data and to create the charts and tables. The Tag Spotlight view allows you to drill down into a user session.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Change the timeframe to <strong>Last 1 hour</strong>.</li><li>Click <strong>Add Filters</strong>, select <strong>OS Version</strong>, click <strong>!=</strong> and select <strong>Synthetics</strong> and <strong>RUMLoadGen</strong> then click the
<span class="btn cstyle blue"><button type=button>
Apply Filter</button></span> button.</li><li>Find the <strong>Custom Event Name</strong> chart, locate <strong>PlaceOrder</strong> in the list, click on it and select <strong>Add to filter</strong>.</li><li>Notice the large spikes in the graph across the top.</li><li>Click on the <strong>User Sessions</strong> tab.</li><li>Click on the <strong>Duration</strong> heading twice to sort the sessions by duration (longest at the top).</li><li>Click on the <i class="fa-fw fas fa-cog"></i> above the table and select <strong>Sf Geo City</strong> from the list of additional columns and click
<span class="btn cstyle blue"><button type=button>
Save</button></span></li></ul></div></div><p>We now have a User Session table that is sorted by longest duration descending and includes the cities of all the users that have been shopping on the site. We could apply more filters to further narrow down the data e.g. OS version, browser version, etc.</p><p><a href=#R-image-241f8651bf07baedde03d3e4cd631156 class=lightbox-link><img src=../en/s4r/5-rum/2-tag-spotlight/../images/rum-user-sessions.png alt="RUM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-241f8651bf07baedde03d3e4cd631156><img src=../en/s4r/5-rum/2-tag-spotlight/../images/rum-user-sessions.png alt="RUM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-session-replay>3. Session Replay</h1><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Sessions</div><div class=box-content><p>A session is a collection of traces that correspond to the actions a single user takes when interacting with an application. By default, a session lasts until 15 minutes have passed from the last event captured in the session. The maximum session duration is 4 hours.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the <strong>User Sessions</strong> table, click on the top <strong>Session ID</strong> with the longest <strong>Duration</strong> (over 20 seconds or longer), this will take you to the RUM Session view.</li></ul></div></div><p><a href=#R-image-92aa5db70b9749fe7d9e0d1ab9893477 class=lightbox-link><img src=../en/s4r/5-rum/3-session-replay/../images/rum-session.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-92aa5db70b9749fe7d9e0d1ab9893477><img src=../en/s4r/5-rum/3-session-replay/../images/rum-session.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click the RUM Session Replay
<span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-play"></i>
Replay</button></span> button. RUM Session Replay allows you to replay and see the user session. This is a great way to see exactly what the user experienced.</li><li>Click the button to start the replay.</li></ul></div></div><p><a href=#R-image-3fbd29d971ad03f6596c26baf854acfc class=lightbox-link><img src=../en/s4r/5-rum/3-session-replay/../images/rum-session-replay.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3fbd29d971ad03f6596c26baf854acfc><img src=../en/s4r/5-rum/3-session-replay/../images/rum-session-replay.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>RUM Session Replay can redact information, by default text is redacted. You can also redact images (which has been done for this workshop example). This is useful if you are replaying a session that contains sensitive information. You can also change the playback speed and pause the replay.</p><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>When playing back the session, notice how the mouse movements are captured. This is useful to see where the user is focusing their attention.</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-user-sessions>4. User Sessions</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Close the RUM Session Replay by clicking on the <strong>X</strong> in the top right corner. We had set a filter on <strong>PlaceOrder</strong> in the previous exercise. It should be selected here as well, as shown in the screenshot below (<strong>1</strong>).</li><li>Note the length of the span, this is the time it took to complete the order, not good!</li><li>Scroll down the page and you will see the <strong>Tags</strong> metadata (which is used in Tag Spotlight). After the tags, we come to the waterfall which shows the page objects that have been loaded (HTML, CSS, images, JavaScript etc.)</li><li>Keep scrolling down the page until you come to a blue <strong>APM</strong> link (the one with <code>/cart/checkout</code> at the end of the URL) and hover over it.</li></ul></div></div><p><a href=#R-image-02945c8ba80ad7358e7d55c9180cd184 class=lightbox-link><img src=../en/s4r/5-rum/4-user-sessions/../images/rum-waterfall.png alt="RUM Session" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-02945c8ba80ad7358e7d55c9180cd184><img src=../en/s4r/5-rum/4-user-sessions/../images/rum-waterfall.png alt="RUM Session" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This brings up the APM Performance Summary. Having this end-to-end (RUM to APM) view is very useful when troubleshooting issues.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>You will see <strong>paymentservice</strong> (<strong>2</strong>) and <strong>checkoutservice</strong> (<strong>3</strong>) are in an error state as per the screenshot above.</li><li>Under <strong>Workflow Name</strong> click on <code>front-end:/cart/checkout</code>, this will bring up the <strong>APM Service Map</strong>.</li></ul></div></div><p><a href=#R-image-6af6beab3ee6565781e29e937e4be793 class=lightbox-link><img src=../en/s4r/5-rum/4-user-sessions/../images/rum-to-apm.png alt="RUM to APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6af6beab3ee6565781e29e937e4be793><img src=../en/s4r/5-rum/4-user-sessions/../images/rum-to-apm.png alt="RUM to APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 6</div><h1 id=splunk-apm>Splunk APM</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>20 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>You are a <strong>back-end developer</strong> and you have been called in to help investigate an issue found by the SRE. The SRE has identified a poor user experience and has asked you to investigate the issue.</p></div></div><p>Discover the power of full end-to-end visibility by jumping from a RUM trace (front-end) to an APM trace (back-end). All the services are sending telemetry (traces and spans) that Splunk Observability Cloud can visualize, analyze and use to detect anomalies and errors.</p><p>RUM and APM are two sides of the same coin. RUM is the client-side view of the application and APM is the server-side view. In this section, we will use APM to drill down and identify where the problem is.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk APM</h1><article class=default><header class=headline></header><h1 id=1-apm-explore>1. APM Explore</h1><p>The APM Service Map displays the dependencies and connections among your instrumented and inferred services in APM. The map is dynamically generated based on your selections in the time range, environment, workflow, service, and tag filters.</p><p>When we clicked on the APM link in the RUM waterfall, filters were automatically added to the service map view to show the services that were involved in that <strong>WorkFlow Name</strong> (<code>frontend:/cart/checkout</code>).</p><p>You can see the services involved in the workflow in the <strong>Service Map</strong>. In the side pane, under <strong>Business Workflow</strong>, charts for the selected workflow are displayed. The <strong>Service Map</strong> and <strong>Business Workflow</strong> charts are synchronized. When you select a service in the <strong>Service Map</strong>, the charts in the <strong>Business Workflow</strong> pane are updated to show metrics for the selected service.</p><p><a href=#R-image-eccacf8bac13814250682849dc27c023 class=lightbox-link><img src=../en/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png alt="APM Business Workflow" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eccacf8bac13814250682849dc27c023><img src=../en/s4r/6-apm/1-apm-explore/../images/apm-business-workflow.png alt="APM Business Workflow" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the <strong>paymentservice</strong> in the Service Map.</li></ul></div></div><p><a href=#R-image-e233fb1b07d2e9873acc155523833533 class=lightbox-link><img src=../en/s4r/6-apm/1-apm-explore/../images/apm-explore.png alt="APM Explore" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e233fb1b07d2e9873acc155523833533><img src=../en/s4r/6-apm/1-apm-explore/../images/apm-explore.png alt="APM Explore" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Splunk APM also provides a set of built-in dashboards that present charts and visualized metrics to help you see problems occurring in real time and quickly determine whether the problem is associated with a service, a specific endpoint, or the underlying infrastructure. Let&rsquo;s have a closer look.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on <strong>View Dashboard</strong> top right of the <strong>paymentservice</strong> pane.</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-apm-service-dashboard>2. APM Service Dashboard</h1><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Service Dashboard</div><div class=box-content><p>APM Service Dashboards provide request, error, and duration (<strong>RED</strong>) metrics based on Monitoring MetricSets created from endpoint spans for your services, endpoints, and Business Workflows. If you scroll down the dashboard you will also see the host and Kubernetes-related metrics which help you determine whether there are problems with the underlying infrastructure.</p></div></div><p><a href=#R-image-20070ca6687ad86a1852e3e0af6545ff class=lightbox-link><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png alt="Service Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20070ca6687ad86a1852e3e0af6545ff><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-dashboard.png alt="Service Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Check the <strong>Time</strong> box <strong>(1)</strong>, you can see that the dashboards only show data relevant to the time it took for the APM trace we selected to complete (note that the charts are static).</li><li>In the <strong>time</strong> box change enter <strong>-1h</strong> and hit enter.</li><li>The Single Value charts, <strong>Request rate</strong>, **Request latency (p90)**and <strong>Error rate</strong> will start updating every 10 seconds showing that we still have a large number of errors occurring.</li><li>These charts are very useful to quickly identify performance issues. You can use this dashboard to keep an eye on the health of your service or use it as a base for a custom one.</li><li>We want to use some of these charts in a later exercise:<ul><li>In the <strong>Request rate</strong> Single Value chart (<strong>2</strong>), click the <strong>&mldr;</strong> and select <strong>Copy</strong>. Note that you now have a <strong>1</strong> before the <strong>+</strong> at the top right of the page (<strong>3</strong>), indicating you have a copied chart to the clipboard.</li><li>In the <strong>Request rate</strong> line chart (<strong>4</strong>), either click on the <strong>Add to clipboard</strong> indicator that appeared (just at the <strong>(4)</strong> in the screenshot) to add it to the clipboard or use the <strong>&mldr;</strong> and select <strong>Add to clipboard</strong>.</li></ul></li><li>Note that you now have <strong>2</strong> before the <strong>+</strong> on the top right of the page. (<strong>3</strong>)</li><li>Now let&rsquo;s go back to the explore view, you can hit the back button in your Browser</li></ul></div></div><p><a href=#R-image-d8be938bfb7b6537f202d9cd85ec02b3 class=lightbox-link><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png alt="APM Explore" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d8be938bfb7b6537f202d9cd85ec02b3><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-explore.png alt="APM Explore" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=99a5f258f7fa0416d8d8cc17481a5ccf><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("99a5f258f7fa0416d8d8cc17481a5ccf","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("99a5f258f7fa0416d8d8cc17481a5ccf","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>In the Service Map hover over the <strong>paymentservice</strong>. What can you conclude from the popup service chart?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The error percentage is very high.</strong></p></div></div></div></div></div></div><p><a href=#R-image-9bd5bd9cd83513be11553775c2dca520 class=lightbox-link><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png alt="APM Service Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9bd5bd9cd83513be11553775c2dca520><img src=../en/s4r/6-apm/2-apm-service-dashboard/../images/apm-service-popup-chart.png alt="APM Service Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We need to understand if there is a pattern to this error rate. We have a handy tool for that, <strong>Tag Spotlight</strong>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-apm-tag-spotlight>3. APM Tag Spotlight</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>To view the tags for the <strong>paymentservice</strong> click on the <strong>paymentservice</strong> and then click on <strong>Tag Spotlight</strong> in the right-hand side functions pane (you may need to scroll down depending upon your screen resolution).</li><li>Once in <strong>Tag Spotlight</strong> ensure the toggle <strong>Show tags with no values</strong> is off.</li></ul></div></div><p><a href=#R-image-e752463e9cca214cdaea94e0216bc3bd class=lightbox-link><img src=../en/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png alt="APM Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e752463e9cca214cdaea94e0216bc3bd><img src=../en/s4r/6-apm/3-apm-tag-spotlight/../images/apm-tag-spotlight.png alt="APM Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>There are two views available in <strong>Tag Spotlight</strong>. The default is <strong>Request/Errors</strong> and the other is <strong>Latency</strong>.</p><p>Request/Error charts display the total number of requests, errors, and root cause errors. The Latency charts display p50, p90, and p99 latency. These values are based on Troubleshooting MetricSets (TMS), which Splunk APM generates for every indexed span tag. These are known as RED metrics (request, error, and duration).</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><div class=tab-panel data-tab-group=cc6dd3c45b00750d396e470e5317c338><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("cc6dd3c45b00750d396e470e5317c338","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("cc6dd3c45b00750d396e470e5317c338","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Which chart exposes the tag that identifies what the problem is?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The <em>version</em> chart. The number of requests against <code>v350.10</code> matches the number of errors.</strong></p></div></div></div></div><ul><li>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. Click on <strong>‚Üê Tag Spotlight</strong> at the top of the page to get back to the Service Map.</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-apm-service-breakdown>4. APM Service Breakdown</h1><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the right-hand pane click on the
<span class="btn cstyle grey"><button type=button>
Breakdown</button>
</span>.</li><li>Select <code>tenant.level</code> in the list. This is a tag that exposes the customers&rsquo; status and can be useful to see trends related to customer status.</li><li>Back in the Service Map Click on <strong>gold</strong> to select it.</li><li>Click on
<span class="btn cstyle grey"><button type=button>
Breakdown</button></span> and select <code>version</code>, this is the tag that exposes the service version.</li><li>Repeat this for <strong>silver</strong> and <strong>bronze</strong>.</li></ul><div class=tab-panel data-tab-group=802dd82280e2aec344dcf08d3c2d1d32><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("802dd82280e2aec344dcf08d3c2d1d32","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("802dd82280e2aec344dcf08d3c2d1d32","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What can you conclude from what you are seeing?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Every tenant is being impacted by <code>v350.10</code></strong></p></div></div></div></div></div></div><p>You will now see the <strong>paymentservice</strong> broken down into three services, <strong>gold</strong>, <strong>silver</strong> and <strong>bronze</strong>. Each tenant is broken down into two services, one for each version (<code>v350.10</code> and <code>v350.9</code>).</p><p><a href=#R-image-f357b89d87d47ab2e4ee4750445656d3 class=lightbox-link><img src=../en/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png alt="APM Service Breakdown" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f357b89d87d47ab2e4ee4750445656d3><img src=../en/s4r/6-apm/4-apm-service-breakdown/../images/apm-service-breakdown.png alt="APM Service Breakdown" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the outer main box that surrounds the 3 red circles, the box will become highlighted.</li></ul></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Span Tags</div><div class=box-content><p>Using span tags to break down services is a very powerful feature. It allows you to see how your services are performing for different customers, different versions, different regions, etc. In this exercise, we have determined that <code>v350.10</code> of the <strong>paymentservice</strong> is causing problems for all our customers.</p></div></div><p>Next, we need to drill down into a trace to see what is going on.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=5-apm-trace-analyzer>5. APM Trace Analyzer</h1><p>As Splunk APM provides a <strong>NoSample‚Ñ¢</strong> end-to-end visibility of every service Splunk APM captures every trace. For this workshop, the <strong>Order Confirmation ID</strong> is available as a tag. This means that we can use this to search for the exact trace of the poor user experience you encountered earlier in the workshop.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Trace Analyzer</div><div class=box-content><p>Splunk Observability Cloud provides several tools for exploring application monitoring data. <strong>Trace Analyzer</strong> is suited to scenarios where you have high-cardinality, high-granularity searches and explorations to research unknown or new issues.</p></div></div><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>With the outer box of the <strong>paymentservice</strong> selected, in the right-hand pane, click on <strong>Traces</strong>.</li><li>To ensure we are using <strong>Trace Analyzer</strong> make sure the button
<span class="btn cstyle transparent"><button type=button>
Switch to Classic View</button></span> is showing. If it is not, click on
<span class="btn cstyle blue"><button type=button>
Switch to Trace Analyzer</button>
</span>.</li></ul></div></div><p><a href=#R-image-ec164cefa7a1965496ed0c6864ca88ff class=lightbox-link><img src=../en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer.png alt="APM Trace Analyzer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec164cefa7a1965496ed0c6864ca88ff><img src=../en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-analyzer.png alt="APM Trace Analyzer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the time picker select <strong>Last 1 hour</strong>.</li><li>Note, that most of our traces have errors (red) and there are only a limited amount of traces that are error-free (blue).</li><li>Make sure the <strong>Sample Ratio</strong> is set to <code>1:1</code> and <strong>not</strong> <code>1:10</code>.</li><li>Click on <strong>Add filters</strong>, type in <code>orderId</code> and select <strong>orderId</strong> from the list.</li><li>Paste in your <strong>Order Confirmation ID</strong> from when you went shopping earlier in the workshop and hit enter. If you didn&rsquo;t capture one, please ask your instructor for one.
<a href=#R-image-85b252cb2cf6580142dd371c0f128f2d class=lightbox-link><img src=../en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-by-duration.png alt="Traces by Duration" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85b252cb2cf6580142dd371c0f128f2d><img src=../en/s4r/6-apm/5-apm-trace-analyzer/../images/apm-trace-by-duration.png alt="Traces by Duration" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>We have now filtered down to the exact trace where you encountered a poor user experience with a very long checkout wait. A secondary benefit to viewing this trace is that the trace will be accessible for up to 13 months. This will allow developers to come back to this issue at a later stage and still view this trace for example.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the trace in the list.</li></ul></div></div><p>Next, we will walk through the trace waterfall.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=6-apm-waterfall>6. APM Waterfall</h1><p>We have arrived at the <strong>Trace Waterfall</strong> from the <strong>Trace Analyzer</strong>. A trace is a collection of spans that share the same trace ID, representing a unique transaction handled by your application and its constituent services.</p><p>Each span in Splunk APM captures a single operation. Splunk APM considers a span to be an error span if the operation that the span captures results in an error.</p><p><a href=#R-image-35fed1c52ac59207d17f05ff45a56e28 class=lightbox-link><img src=../en/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png alt="Trace Waterfall" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35fed1c52ac59207d17f05ff45a56e28><img src=../en/s4r/6-apm/6-apm-waterfall/../images/apm-trace-waterfall.png alt="Trace Waterfall" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on the
<span class="btn cstyle red"><button type=button>
!</button></span> next to any of the <code>paymentservice:grpc.hipstershop.PaymentService/Charge</code> spans in the waterfall.</li></ul><div class=tab-panel data-tab-group=f9e8f8dbc641c5630d1d7a87a98d0b5c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("f9e8f8dbc641c5630d1d7a87a98d0b5c","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f9e8f8dbc641c5630d1d7a87a98d0b5c","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>What is the error message and version being reported in the span metadata?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>Invalid request and <code>v350.10</code></strong>.</p></div></div></div></div></div></div>Now that we have identified the version of the <strong>paymentservice</strong> that is causing the issue, let&rsquo;s see if we can find out more information about the error. This is where <strong>Related Logs</strong> come in.</p><p><a href=#R-image-b464a56474b71d706090583b551de23e class=lightbox-link><img src=../en/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png alt="Related Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b464a56474b71d706090583b551de23e><img src=../en/s4r/6-apm/6-apm-waterfall/../images/apm-related-logs.png alt="Related Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Related Content relies on specific metadata that allow APM, Infrastructure Monitoring, and Log Observer to pass filters around Observability Cloud. For related logs to work, you need to have the following metadata in your logs:</p><ul><li><code>service.name</code></li><li><code>deployment.environment</code></li><li><code>host.name</code></li><li><code>trace_id</code></li><li><code>span_id</code></li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>At the very bottom of the <strong>Trace Waterfall</strong> click on the word <strong>Logs (1)</strong>. This highlights that there are <strong>Related Logs</strong> for this trace.</li><li>Click on the <strong>Logs for trace XXX</strong> entry in the pop-up, this will open the logs for the complete trace in <strong>Log Observer</strong>.</li></ul></div></div><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 7</div><h1 id=splunk-log-observer>Splunk Log Observer</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>20 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>Remaining in your <strong>back-end developer</strong> role, you need to inspect the logs from your application to determine the root cause of the issue.</p></div></div><p>Using the content related to the APM trace (logs) we will now use Splunk Log Observer to drill down further to understand exactly what the problem is.</p><p>Related Content is a powerful feature that allows you to jump from one component to another and is available for <strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong>.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk Log Observer</h1><article class=default><header class=headline></header><h1 id=1-log-filtering>1. Log Filtering</h1><p><strong>Log Observer (LO)</strong>, can be used in multiple ways. In the quick tour, you used the LO <strong>no-code interface</strong> to search for specific entries in the logs. This section, however, assumes you have arrived in LO from a trace in APM using the <strong>Related Content</strong> link.</p><p>The advantage of this is, as it was with the link between RUM & APM, that you are looking at your logs within the context of your previous actions. In this case, the context is the time frame (<strong>1</strong>), which matches that of the trace and the filter (<strong>2</strong>) which is set to the <strong>trace_id</strong>.</p><p><a href=#R-image-649f54507ccf04b4919e94336982ff7e class=lightbox-link><img src=../en/s4r/7-log-observer/1-log-filtering/../images/log-observer-trace-logs.png alt="Trace Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-649f54507ccf04b4919e94336982ff7e><img src=../en/s4r/7-log-observer/1-log-filtering/../images/log-observer-trace-logs.png alt="Trace Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This view will include <strong>all</strong> the log lines from <strong>all</strong> applications or services that participated in the back-end transaction started by the end-user interaction with the Online Boutique.</p><p>Even in a small application such as our Online Boutique, the sheer amount of logs found can make it hard to see the specific log lines that matter to the actual incident we are investigating.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><p>We need to focus on just the Error messages in the logs:</p><ul><li>Click on the <strong>Group By</strong> drop-down box and use the filter to find <strong>Severity</strong>.</li><li>Once selected click the
<span class="btn cstyle blue"><button type=button>
Apply</button></span> button (notice that the chart legend changes to show debug, error and info).
<a href=#R-image-d2491d11e12b774d34408e4051d67e23 class=lightbox-link><img src=../en/s4r/7-log-observer/1-log-filtering/../images/severity-logs.png alt=legend class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d2491d11e12b774d34408e4051d67e23><img src=../en/s4r/7-log-observer/1-log-filtering/../images/severity-logs.png alt=legend class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Selecting just the error logs can be done by either clicking on the word error (<strong>1</strong>) in the legend, followed by selecting <strong>Add to filter</strong>.</li><li>You could also add the service name, <code>sf_service=paymentservice</code>, to the filter if there are error lines for multiple services, but in our case, this is not necessary.
<a href=#R-image-dec9d23b69723d88d0f969a3362f8200 class=lightbox-link><img src=../en/s4r/7-log-observer/1-log-filtering/../images/log-observer-errors.png alt="Error Logs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dec9d23b69723d88d0f969a3362f8200><img src=../en/s4r/7-log-observer/1-log-filtering/../images/log-observer-errors.png alt="Error Logs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>Next, we will look at log entries in detail.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-viewing-log-entries>2. Viewing Log Entries</h1><p>Before we look at a specific log line, let&rsquo;s quickly recap what we have done so far and why we are here based on the 3 pillars of Observability:</p><table><thead><tr><th style=text-align:center>Metrics</th><th style=text-align:center>Traces</th><th style=text-align:center>Logs</th></tr></thead><tbody><tr><td style=text-align:center><em><strong>Do I have a problem?</strong></em></td><td style=text-align:center><em><strong>Where is the problem?</strong></em></td><td style=text-align:center><em><strong>What is the problem?</strong></em></td></tr></tbody></table><ul><li>Using metrics we identified <strong>we have a problem</strong> with our application. This was obvious from the error rate in the Service Dashboards as it was higher than it should be.</li><li>Using traces and span tags we found <strong>where the problem is</strong>. The <strong>paymentservice</strong> comprises of two versions, <code>v350.9</code> and <code>v350.10</code>, and the error rate was <strong>100%</strong> for <code>v350.10</code>.</li><li>We did see that this error from the <strong>paymentservice</strong> <code>v350.10</code> caused multiple retries and a long delay in the response back from the Online Boutique checkout.</li><li>From the trace, using the power of <strong>Related Content</strong>, we arrived at the log entries for the failing <strong>paymentservice</strong> version. Now, we can determine <strong>what the problem is</strong>.</li></ul><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Click on an error entry in the log table (make sure it says <code>hostname: "paymentservice-xxxx"</code> in case there is a rare error from a different service in the list too.</li></ul><div class=tab-panel data-tab-group=f19797aa075c53f49ba9759408a50e26><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=question class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("f19797aa075c53f49ba9759408a50e26","question")'>
<span class=tab-nav-text>Question</span></button>
<button data-tab-item=answer class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f19797aa075c53f49ba9759408a50e26","answer")'>
<span class=tab-nav-text>Answer</span></button></div><div class=tab-content-container><div data-tab-item=question class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>Based on the message, what would you tell the development team to do to resolve the issue?</strong></p></div></div><div data-tab-item=answer class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>The development team needs to rebuild and deploy the container with a valid API Token or rollback to <code>v350.9</code></strong>.</p></div></div></div></div><p><a href=#R-image-b6c835f59b7e11edc8698839e490c23c class=lightbox-link><img src=../en/s4r/7-log-observer/2-log-entry/../images/log-observer-log-message.png alt="Log Message" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b6c835f59b7e11edc8698839e490c23c><img src=../en/s4r/7-log-observer/2-log-entry/../images/log-observer-log-message.png alt="Log Message" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Click on the <strong>X</strong> in the log message pane to close it.</li></ul></div></div><div class="box notices cstyle blue"><div class=box-label><i class="fa-fw fas fa-wine-bottle"></i> Congratulations</div><div class=box-content><p>You have <strong>successfully</strong> used Splunk Observability Cloud to understand why you experienced a poor user experience whilst shopping at the Online Boutique. You used RUM, APM and logs to understand what happened in your service landscape and subsequently, found the underlying cause, all based on the 3 pillars of Observability, <strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong></p><p>You also learned how to use Splunk&rsquo;s <strong>intelligent tagging and analysis</strong> with <strong>Tag Spotlight</strong> to detect patterns in your applications&rsquo; behavior and to use the <strong>full stack correlation</strong> power of <strong>Related Content</strong> to quickly move between the different components whilst keeping in context of the issue.</p></div></div><p>In the next part of the workshop, we will move from <strong>problem-finding mode</strong> into <strong>mitigation</strong>, <strong>prevention</strong> and <strong>process improvement mode</strong>.</p><p>Next up, creating log charts in a custom dashboard.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-log-timeline-chart>3. Log Timeline Chart</h1><p>Once you have a specific view in Log Observer, it is very useful to be able to use that view in a dashboard, to help in the future with reducing the time to detect or resolve issues. As part of the workshop, we will create an example custom dashboard that will use these charts.</p><p>Let&rsquo;s look at creating a <strong>Log Timeline</strong> chart. The Log Timeline chart is used for visualizing log messages over time. It is a great way to see the frequency of log messages and to identify patterns. It is also a great way to see the distribution of log messages across your environment. These charts can be saved to a custom dashboard.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><p>First, we will reduce the amount of information to only the columns we are interested in:</p><ul><li>Click on the Configure Table <i class="fa-fw fas fa-cog"></i> icon above the <strong>Logs table</strong> to open the <strong>Table Settings</strong>, untick <code>_raw</code> and ensure the following fields are selected <code>k8s.pod_name</code>, <code>message</code> and <code>version</code>.
<a href=#R-image-40a29e40d8b59afc6babb128e02373dc class=lightbox-link><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/log-observer-table.png alt="Log Table Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-40a29e40d8b59afc6babb128e02373dc><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/log-observer-table.png alt="Log Table Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Remove the fixed time from the time picker, and set it to the <strong>Last 15 minutes</strong>.</li><li>To make this work for all traces, remove the <code>trace_id</code> from the filter and add the fields <code>sf_service=paymentservice</code> and <code>sf_environment=[WORKSHOPNAME]</code>.</li><li>Click <strong>Save</strong> and select <strong>Save to Dashboard</strong>.
<a href=#R-image-375148d3ffa909dd32713eca89088e23 class=lightbox-link><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/save-query.png alt="save it" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-375148d3ffa909dd32713eca89088e23><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/save-query.png alt="save it" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>In the chart creation dialog box that appears, for the <strong>Chart name</strong> use <code>Log Timeline</code>.</li><li>Click
<span class="btn cstyle blue"><button type=button>
Select Dashboard</button></span> and then click
<span class="btn cstyle blue"><button type=button>
New dashboard</button></span> in the Dashboard Selection dialog box.</li><li>In the <strong>New dashboard</strong> dialog box, enter a name for the new dashboard (no need to enter a description). Use the following format: <code>Initials - Service Health Dashboard</code> and click
<span class="btn cstyle blue"><button type=button>
Save</button></span></li><li>Ensure the new dashboard is highlighted in the list (<strong>1</strong>) and click
<span class="btn cstyle blue"><button type=button>
OK</button></span> (<strong>2</strong>).
<a href=#R-image-2bd2654c4702067dd1badeea565e49ec class=lightbox-link><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/dashboard-save.png alt="Save dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2bd2654c4702067dd1badeea565e49ec><img src=../en/s4r/7-log-observer/3-log-timeline-chart/../images/dashboard-save.png alt="Save dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Ensure that <strong>Log Timeline</strong> is selected as the <strong>Chart Type</strong>.
<a href=#R-image-ca41d822aeb74729d5946d1ecacf97a4 class=lightbox-link><img src="../en/s4r/7-log-observer/3-log-timeline-chart/../images/log-timeline.png?classes=left&amp;width=25vw" alt="log timeline" class="figure-image noborder left lightbox noshadow" style=height:auto;width:25vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca41d822aeb74729d5946d1ecacf97a4><img src="../en/s4r/7-log-observer/3-log-timeline-chart/../images/log-timeline.png?classes=left&amp;width=25vw" alt="log timeline" class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></li><li>Click the
<span class="btn cstyle transparent"><button type=button>
Save</button></span> button (<strong>do not</strong> click <strong>Save and goto dashboard</strong> at this time).</li></ul></div></div><p>Next, we will create a <strong>Log View</strong> chart.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-log-view-chart>4. Log View Chart</h1><p>The next chart type that can be used with logs is the <strong>Log View</strong> chart type. This chart will allow us to see log messages based on predefined filters.</p><p>As with the previous Log Timeline chart, we will add a version of this chart to our Customer Health Service Dashboard:</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>After the previous exercise make sure you are still in <strong>Log Observer</strong>.</li><li>The filters should be the same as the previous exercise, with the time picker set to the <strong>Last 15 minutes</strong> and filtering on severity=error, <code>sf_service=paymentservice</code> and <code>sf_environment=[WORKSHOPNAME]</code>.</li><li>Make sure we have the header with just the fields we wanted.</li><li>Click again on <strong>Save</strong> and then <strong>Save to Dashboard</strong>.</li><li>This will again provide you with the Chart creation dialog.</li><li>For the <strong>Chart name</strong> use <strong>Log View</strong>.</li><li>This time Click
<span class="btn cstyle blue"><button type=button>
Select Dashboard</button></span> and search for the Dashboard you created in the previous exercise. You can start by typing your initials in the search box (<strong>1</strong>).
<a href=#R-image-d0de9bb005be29c8946c36d00bcb1934 class=lightbox-link><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/search-dashboard.png alt="search dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d0de9bb005be29c8946c36d00bcb1934><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/search-dashboard.png alt="search dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Click on your dashboard name to highlight it (<strong>2</strong>) and click
<span class="btn cstyle blue"><button type=button>
OK</button></span> (<strong>3</strong>).</li><li>This will return you to the create chart dialog.</li><li>Ensure <strong>Log View</strong> is selected as the <strong>Chart Type</strong>.
<a href=#R-image-2df1a174097894b981a2e87c6b511950 class=lightbox-link><img src="../en/s4r/7-log-observer/4-log-view-chart/../images/log-view.png?classes=left&amp;width=30vw" alt="log view" class="figure-image noborder left lightbox noshadow" style=height:auto;width:30vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2df1a174097894b981a2e87c6b511950><img src="../en/s4r/7-log-observer/4-log-view-chart/../images/log-view.png?classes=left&amp;width=30vw" alt="log view" class="lightbox-image noborder left lightbox noshadow" loading=lazy></a></li><li>To see your dashboard click
<span class="btn cstyle blue"><button type=button>
Save and go to dashboard</button>
</span>.</li><li>The result should be similar to the dashboard below:
<a href=#R-image-f288e99c36be3d009133c065c8a9de8c class=lightbox-link><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/log-observer-custom-dashboard.png alt="Custom Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f288e99c36be3d009133c065c8a9de8c><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/log-observer-custom-dashboard.png alt="Custom Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>As the last step in this exercise, let us add your dashboard to your workshop team page, this will make it easy to find later in the workshop.</li><li>At the top of the page, click on the <em><strong>&mldr;</strong></em> to the left of your dashboard name (<strong>1</strong>).
<a href=#R-image-747b1f9f1e016071303e381f2e7c7213 class=lightbox-link><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/linking.png alt=linking class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-747b1f9f1e016071303e381f2e7c7213><img src=../en/s4r/7-log-observer/4-log-view-chart/../images/linking.png alt=linking class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Select <strong>Link to teams</strong> from the drop-down (<strong>2</strong>).</li><li>In the following <strong>Link to teams</strong> dialog box, find the Workshop team that your instructor will have provided for you and click
<span class="btn cstyle blue"><button type=button>
Done</button>
</span>.</li></ul></div></div><p>In the next session, we will look at Splunk Synthetics and see how we can automate the testing of web-based applications.</p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 8</div><h1 id=splunk-synthetics>Splunk Synthetics</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>Putting your <strong>SRE</strong> hat back on, you have been asked to set up monitoring for the Online Boutique. You need to ensure that the application is available and performing well 24 hours a day, 7 days a week.</p></div></div><p>Wouldn‚Äôt it be great if we could have 24/7 monitoring of our application, and be alerted when there is a problem? This is where Synthetics comes in. We will show you a simple test that runs every 1 minute and checks the performance and availability of a typical user journey through the Online Boutique.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk Synthetics</h1><article class=default><header class=headline></header><h1 id=1-synthetics-dashboard>1. Synthetics Dashboard</h1><p>In Splunk Observability Cloud from the main menu, click on <strong>Synthetics</strong>. Click on <strong>All</strong> or <strong>Browser tests</strong> to see the list of active tests.</p><p>During our investigation in the RUM section, we found there was an issue with the <strong>Place Order</strong> Transaction. Let&rsquo;s see if we can confirm this from the Synthetics test as well. We will be using the metric <strong>First byte time</strong> for the 4th page of the test, which is the <strong>Place Order</strong> step.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the <strong>Search</strong> box enter <strong>[WORKSHOP NAME]</strong> and select the test for your workshop (your instructor will advise as to which one to select).</li><li>Under <strong>Performance KPIs</strong> set the Time Picker to <strong>-30m</strong> and hit enter.</li><li>Click on <strong>Location</strong> and from the drop-down select <strong>Page</strong>. The next filter will be populated with the pages that are part of the test.</li><li>Click on <strong>Duration</strong>, deselect <strong>Duration</strong> and select <strong>First byte time</strong>.
<a href=#R-image-fab93746f51ce5fc5bbb4bcb422e52a0 class=lightbox-link><img src=../en/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-transaction-filter.png alt="Transaction Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fab93746f51ce5fc5bbb4bcb422e52a0><img src=../en/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-transaction-filter.png alt="Transaction Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Look at the legend and note the color of <strong>First byte time - Page 4</strong>.</li><li>Select the highest data point for <strong>First byte time - Page 4</strong>.</li><li>A new pane will slide in from the right. Note the time at the top of the pane. Find this time in the list and click on it as this is the slowest test result.
<a href=#R-image-c9dbee3c5d4be7754c0b3d2e1314aa64 class=lightbox-link><img src=../en/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-multiple-runs.png alt="Multiple Runs" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c9dbee3c5d4be7754c0b3d2e1314aa64><img src=../en/s4r/8-synthetics/1-synthetics-dashboard/../images/synthetics-multiple-runs.png alt="Multiple Runs" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>You will now be taken to the <strong>Run results</strong> for this particular test run.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-synthetics-test-detail>2. Synthetics Test Detail</h1><p>Right now we are looking at the result of a single Synthetic Browser Test. This test is split up into <strong>Business Transactions</strong>, think of this as a group of one or more logically related interactions that represent a business-critical user flow.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>The screenshot below doesn&rsquo;t contain a red banner with an error in it however you might be seeing one in your run results. This is expected as in some cases the test run fails and does not impact the workshop.</p></div></div><p><a href=#R-image-e296051058e480db904ac689df7bc309 class=lightbox-link><img src=../en/s4r/8-synthetics/2-synthetics-detail/../images/synth-waterfall.png alt=waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e296051058e480db904ac689df7bc309><img src=../en/s4r/8-synthetics/2-synthetics-detail/../images/synth-waterfall.png alt=waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ol><li><strong>Filmstrip:</strong> Offers a set of screenshots of site performance so that you can see how the page responds in real-time.</li><li><strong>Video:</strong> This lets you see exactly what a user trying to load your site from the location and device of a particular test run would experience.</li><li><strong>Browser test metrics:</strong> A View that offers you a picture of website performance.</li><li><strong>Synthetic transactions:</strong> List of the Synthetic transactions that made up the interaction with the site</li><li><strong>Waterfall chart</strong> The waterfall chart is a visual representation of the interaction between the test runner and the site being tested.</li></ol><p>By default, Splunk Synthetics provides screenshots and video capture of the test. This is useful for debugging issues. You can see, for example, the slow loading of large images, the slow rendering of a page etc.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Use your mouse to scroll left and right through the filmstrip to see how the site was being rendered during the test run.</li><li>In the Video pane, press on the play button <strong>‚ñ∂</strong> to see the test playback. If you click the ellipses <strong>‚ãÆ</strong> you can change the <em>playback speed</em>, view it <em>Picture in Picture</em> and even <em>Download</em> the video.</li><li>In the Synthetic Transaction pane, under the header <em>Business Transactions</em>, click on the first button
<span class="btn cstyle blue"><button type=button>
<strong>Home</strong></button></span></li><li>The waterfall below will show all the objects that make up the page. The first line is the HTML page itself. The next lines are the objects that make up the page (HTML, CSS, JavaScript, Images, Fonts, etc.).</li><li>In the waterfall find the line <strong>GET</strong> <em>splunk-otel-web.js</em>.</li><li>Click on the <strong>></strong> button to open the metadata section to see the Request/Response Header information.</li><li>In the Synthetic Transaction pane, click on the second Business Transaction
<span class="btn cstyle blue"><button type=button>
<strong>Shop</strong></button>
</span>. Note that the filmstrip adjusts and moves to the beginning of the new transaction.</li><li>Repeat this for all the other Transactions, then finally select the
<span class="btn cstyle blue"><button type=button>
<strong>PlaceOrder</strong></button></span> transaction.</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-synthetics-to-apm>3. Synthetics to APM</h1><p>We now should have a view similar to the one below.</p><p><a href=#R-image-7532cdf4d6e0f9b0d50a5e1c61bc3778 class=lightbox-link><img src=../en/s4r/8-synthetics/3-synthetics-to-apm/../images/run-results-place-order.png alt="Place Order" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7532cdf4d6e0f9b0d50a5e1c61bc3778><img src=../en/s4r/8-synthetics/3-synthetics-to-apm/../images/run-results-place-order.png alt="Place Order" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>In the waterfall find an entry that starts with <strong>POST checkout</strong>.</li><li>Click on the <strong>></strong> button in front of it to drop open the metadata section. Observe the metadata that is collected, and note the <strong>Server-Timing</strong> header. This header is what allows us to correlate the test run to a back-end trace.</li><li>Click on the blue <i class="fa-fw fas fa-link"></i> <strong>APM</strong> link on the <strong>POST checkout</strong> line in the waterfall.</li></ul></div></div><p><a href=#R-image-755c07233fdf7a8df68a32156c4513f1 class=lightbox-link><img src=../en/s4r/8-synthetics/3-synthetics-to-apm/../images/apm-trace.png alt="APM trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-755c07233fdf7a8df68a32156c4513f1><img src=../en/s4r/8-synthetics/3-synthetics-to-apm/../images/apm-trace.png alt="APM trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Validate you see one or more errors for the <strong>paymentservice</strong> (<strong>1</strong>).</li><li>To validate that it&rsquo;s the same error, click on the related content for <strong>Logs</strong> (<strong>2</strong>).</li><li>Repeat the earlier exercise to filter down to the errors only.</li><li>View the error log to validate the failed payment due to an invalid token.</li></ul></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-synthetics-detector>4. Synthetics Detector</h1><p>Given you can run these tests 24/7, it is an ideal tool to get warned early if your tests are failing or starting to run longer than your agreed SLA instead of getting informed by social media, or Uptime websites.</p><p><a href=#R-image-5228f07993df768daa8f483bd8ecc9c2 class=lightbox-link><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/social-media-post.png alt="Social media" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5228f07993df768daa8f483bd8ecc9c2><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/social-media-post.png alt="Social media" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To stop that from happening let&rsquo;s detect if our test is taking more than 1.1 minutes.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li><p>Go back to the Synthetics home page via the menu on the left</p></li><li><p>Select the workshop test again and click the
<span class="btn cstyle white"><button type=button>
Create Detector</button></span> button at the top of the page.<br><a href=#R-image-a4e969cf1082526bb25dc3ca2ad4b5cb class=lightbox-link><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/synth-detector.png alt="synth detector" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4e969cf1082526bb25dc3ca2ad4b5cb><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/synth-detector.png alt="synth detector" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>Edit the text <strong>New Synthetics Detector</strong> (<strong>1</strong>) and replace it with <code>INITIALS -</code> [WORKSHOPNAME]`.</p></li><li><p>Ensure that
<span class="btn cstyle transparent"><button type=button>
Run duration</button></span> and
<span class="btn cstyle transparent"><button type=button>
Static threshold</button></span> are selected.</p></li><li><p>Set the <strong>Trigger threshold</strong> (<strong>2</strong>) to be around <code>65,000</code> to <code>68,000</code> and hit enter to update the chart. Make sure you have more than one spike cutting through the threshold line as shown above (you may have to adjust the threshold value a bit to match your actual latency).</p></li><li><p>Leave the rest as default.</p></li><li><p>Note that there is now a row of red and white triangles appearing below the spikes (<strong>3</strong>). The red triangles let you know that your detector found that your test was above the given threshold & the white triangle indicates that the result returned below the threshold. Each red triangle will trigger an alert.</p></li><li><p>You can change the Alerts criticality (<strong>4</strong>) by changing the drop-down to a different level, as well as the method of alerting. Make sure you do <strong>NOT</strong> add a Recipient as this could lead to you being subjected to an alert storm!</p></li><li><p>Click
<span class="btn cstyle blue"><button type=button>
Activate</button></span> to deploy your detector.</p></li><li><p>To see your new created detector click
<span class="btn cstyle white"><button type=button>
Edit Test</button></span> button</p></li><li><p>At the bottom of the page is a list of active detectors.</p><p><a href=#R-image-ecd3704e287cdc06bd2bdbb417094da5 class=lightbox-link><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/detector-list.png alt="list of detectors" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ecd3704e287cdc06bd2bdbb417094da5><img src=../en/s4r/8-synthetics/4-synthetics-detector/../images/detector-list.png alt="list of detectors" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></li><li><p>If you can&rsquo;t find yours, but see one called <em>New Synthetic Detector</em>, you may not have saved it correctly with your name. Click on the <em>New Synthetic Detector</em> link, and redo the rename.</p></li><li><p>Click on the
<span class="btn cstyle transparent"><button type=button>
Close</button></span> button to exit the edit mode.</p></li></ul></div></div><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 9</div><h1 id=custom-service-health-dashboard->Custom Service Health Dashboard üè•</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>15 minutes</span></span><div class="box notices cstyle orange"><div class=box-label><i class="fa-fw fas fa-user"></i> Persona</div><div class=box-content><p>As the <strong>SRE</strong> hat suits you let&rsquo;s keep it on as you have been asked to build a custom Service Health Dashboard for the <strong>paymentservice</strong>. The requirement is to display RED metrics, logs and Synthetic test duration results.</p></div></div><p>It is common for development and SRE teams to require a summary of the health of their applications and/or services. More often or not these are displayed on wall-mounted TVs. Splunk Observability Cloud has the perfect solution for this by creating custom dashboards.</p><p>In this section we are going to build a <strong>Service Health Dashboard</strong> we can use to display on teams&rsquo; monitors or TVs.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Custom Service Health Dashboard üè•</h1><article class=default><header class=headline></header><h1 id=enhancing-the-dashboard>Enhancing the Dashboard</h1><p>As we already saved some useful log charts in a dashboard in the Log Observer exercise, we are going to extend that dashboard.</p><p><a href=#R-image-e175965a27f0804861bab60451a4af7a class=lightbox-link><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../images/wall-mount.png alt="Wall mounted" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e175965a27f0804861bab60451a4af7a><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../images/wall-mount.png alt="Wall mounted" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>To get back to your dashboard with the two log charts, click on <strong>Dashboards</strong> from the main menu and you will be taken to your Team Dashboard view. Under <strong>Dashboards</strong> click in <strong>Search dashboards</strong> to search for your Service Health Dashboard group.</li><li>Click on the name and this will bring up your previously saved dashboard.
<a href=#R-image-dad0d4ba4587c7807c037333159a5d49 class=lightbox-link><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../../7-log-observer/images/log-observer-custom-dashboard.png alt="log list" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dad0d4ba4587c7807c037333159a5d49><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../../7-log-observer/images/log-observer-custom-dashboard.png alt="log list" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Even if the log information is useful, it will need more information to have it make sense for our team so let&rsquo;s add a bit more information</li><li>The first step is adding a description chart to the dashboard. Click on the
<span class="btn cstyle grey"><button type=button>
New text note</button></span> and replace the text in the note with the following text and then click the
<span class="btn cstyle blue"><button type=button>
Save and close</button></span> button and name the chart <strong>Instructions</strong></li></ul><div class="box notices cstyle grey"><div class=box-label>Information to use with text note</div><div class=box-content><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>This is a Custom Health Dashboard for the **Payment service**,  
</span></span><span class=line><span class=cl>Please pay attention to any errors in the logs.
</span></span><span class=line><span class=cl>For more detail visit [link](https://https://www.splunk.com/en_us/products/observability.html)</span></span></code></pre></div></div></div><ul><li>The charts are not in a nice order, let&rsquo;s correct that and rearrange the charts so that they are useful.</li><li>Move your mouse over the top edge of the <strong>Instructions</strong> chart, your mouse pointer will change to a <strong>‚ò©</strong>. This will allow you to drag the chart in the dashboard. Drag the <strong>Instructions</strong> chart to the top left location and resize it to a 1/3rd of the page by dragging the right-hand edge.</li><li>Drag and add the <strong>Log Timeline view</strong> chart next to the <strong>Instruction</strong> chart, resize it so it fills the other 2/3rd of the page to be the error rate chart next to the two the chart and resize it so it fills the page</li><li>Next, resize the <strong>Log lines</strong> chart to be the width of the page and resize it the make it at least twice as long.</li><li>You should have something similar to the dashboard below:
<a href=#R-image-7270a4fd00f61ac6f748dd4c53e02f14 class=lightbox-link><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../images/inital-dashboard.png alt="Initial Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7270a4fd00f61ac6f748dd4c53e02f14><img src=../en/s4r/9-custom-dashboard/1-custom-dashboard/../images/inital-dashboard.png alt="Initial Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>This looks great, let&rsquo;s continue and add more meaningful charts.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=adding-copied-charts>Adding Copied Charts</h1><p>In this section, we are going to use the <strong>Copy and Paste</strong> functionality to extend our dashboard. Remember we copied some charts during the APM Service Dashboard section, we will now add those charts to our dashboard.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>Select the <strong>2+</strong> at the top of the page and select <strong>Paste charts</strong>, this will create the charts in your custom dashboard.</li><li>The chart currently shows data for all <strong>Environments</strong> and <strong>Services</strong>, so let&rsquo;s add a filter for our environment and the <strong>paymentservice</strong>.</li><li>Click on the 3 dots <strong>&mldr;</strong> at the top right side of the <strong>Request Rate</strong> single value chart. This will open the chart in edit mode.</li><li>In the new screen, click on the <strong>x</strong> in the
<span class="btn cstyle blue"><button type=button>
sf_environment:* x</button></span> button (<strong>1</strong>) in the middle of the screen to close it.</li><li>Click on the
<span class="btn cstyle blue"><button type=button>
<strong>+</strong></button></span> to add a new filter and select <strong>sf_environment</strong> then pick the [WORKSHOPNAME] from the drop-down and hit <strong>Apply</strong>. The button will change to <strong>sf_environment:[WORKSHOPNAME]</strong></li><li>Do the same with for the
<span class="btn cstyle blue"><button type=button>
sf_service.</button></span> button (<strong>2</strong>), close it and create a new filter for <strong>sf_service</strong>. Only this time change it to <code>paymentservice</code>.
<a href=#R-image-621f15d152fff8bca839387d4e359c6d class=lightbox-link><img src=../en/s4r/9-custom-dashboard/2-add-chart/../images/edit-chart.png alt="edit chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-621f15d152fff8bca839387d4e359c6d><img src=../en/s4r/9-custom-dashboard/2-add-chart/../images/edit-chart.png alt="edit chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Click the
<span class="btn cstyle blue"><button type=button>
Save and close</button></span> button (<strong>3</strong>).</li><li>Repeat the previous 4 steps for the <strong>Request Rate</strong> text chart</li><li>Click
<span class="btn cstyle blue"><button type=button>
Save</button></span> after you have update the two charts.</li><li>As the new pasted charts appeared at the bottom of our dashboard, we need to re-organize our dashboard again.</li><li>Using the drag and drop and resizing skills you learned earlier, make your dashboard look like the image below.
<a href=#R-image-77375ded37ee08b664f46a4a19cf6889 class=lightbox-link><img src=../en/s4r/9-custom-dashboard/2-add-chart/../images/copyandpastedcharts.png alt="New dashboard look" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77375ded37ee08b664f46a4a19cf6889><img src=../en/s4r/9-custom-dashboard/2-add-chart/../images/copyandpastedcharts.png alt="New dashboard look" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul></div></div><p>Next, we are going to create a custom chart based on our Synthetic test that is running.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=adding-a-custom-chart>Adding a Custom Chart</h1><p>In this part of the workshop we are going to create a chart that we will add to our dashboard, we will also link it to the detector we previously built. This will allow us to see the behavior of our test and get alerted if one or more of our test runs breach its SLA.</p><div class="box notices cstyle green"><div class=box-label><i class="fa-fw fas fa-running"></i> Exercise</div><div class=box-content><ul><li>At the top of the dashboard click on the <strong>+</strong> and select <strong>Chart</strong>.
<a href=#R-image-e310d2ef47c4ce6ad74372d57e0ce39b class=lightbox-link><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/new-chart.png alt="new chart screen" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e310d2ef47c4ce6ad74372d57e0ce39b><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/new-chart.png alt="new chart screen" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>First, use the
<span class="btn cstyle grey"><button type=button>
Untitled chart</button></span> input field and name the chart <strong>Overall Test Duration</strong>.</li><li>For this exercise we want a bar or column chart, so click on the 3rd icon <i class="fa-fw fas fa-chart-bar"></i> in the chart option box.</li><li>In the <strong>Plot editor</strong> enter <code>synthetics.run.duration.time.ms</code> (this is runtime in duration for our test) in the <strong>Signal</strong> box and hit enter.</li><li>Right now we see different colored bars, a different color for each region the test runs from. As this is not needed we can change that behavior by adding some analytics.</li><li>Click the
<span class="btn cstyle blue"><button type=button>
Add analytics</button></span> button.</li><li>From the drop-down choose the <strong>Mean</strong> option, then pick <code>mean:aggregation</code> and click outside the dialog box. Notice how the chart changes to a single color as the metrics are now aggregated.</li><li>The x-axis does not currently represent time to change this click on the settings <i class="fa-fw fas fa-cog"></i> icon at the end of the plot line. The following following dialog will open:
<a href=#R-image-0e615f99fe2385eefa4214d6c8cd8bf8 class=lightbox-link><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/signal-setup.png alt="signal setup" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e615f99fe2385eefa4214d6c8cd8bf8><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/signal-setup.png alt="signal setup" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Change the <strong>Display units</strong> (<strong>2</strong>) in the drop-down box from <strong>None</strong> to <strong>Time (autoscaling)/Milliseconds(ms)</strong>. The drop-down changes to <strong>Millisecond</strong> and the x-axis of the chart now represents the test duration time.</li><li>Close the dialog, either by clicking on the settings <i class="fa-fw fas fa-cog"></i> icon or the
<span class="btn cstyle gray"><button type=button>
close</button></span> button.</li><li>Add our detector by clicking the
<span class="btn cstyle blue"><button type=button>
Link Detector</button></span> button and start typing the name of the detector you created earlier.</li><li>Click on the detector name to select it.</li><li>Notice that a colored border appears around the chart, indicating the status of the alert, along with a bell icon at the top of the dashboard as shown below:
<a href=#R-image-e356f6cfab8180c860843c01e92727d7 class=lightbox-link><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/detector-added.png alt="detector added" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e356f6cfab8180c860843c01e92727d7><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/detector-added.png alt="detector added" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Click the
<span class="btn cstyle blue"><button type=button>
Save and close</button></span> button.</li><li>In the dashboard, move the charts so they look like the screenshot below:
<a href=#R-image-a9e36ce91ff098499ec87196bf0a5bfd class=lightbox-link><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/service-health-dashboard.png alt="Service Health Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a9e36ce91ff098499ec87196bf0a5bfd><img src=../en/s4r/9-custom-dashboard/3-custom-chart/../images/service-health-dashboard.png alt="Service Health Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>For the final task, click three dots <strong>&mldr;</strong> at the top of the page (next to <strong>Event Overlay</strong>) and click on <strong>View fullscreen</strong>. This will be the view you would use on the TV monitor on the wall (press Esc to go back).</li></ul></div></div><div class="box notices cstyle primary"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>In your spare time have a try at adding another custom chart to the dashboard using RUM metrics. You could copy a chart from the out-of-the-box <strong>RUM applications</strong> dashboard group. Or you could use the RUM metric <code>rum.client_error.count</code> to create a chart that shows the number of client errors in the application.</p></div></div><p>Finally, we will run through a workshop wrap-up.</p><footer class=footline></footer></article></section><article class=chapter><header class=headline></header><div class=article-subheading>Chapter 10</div><h1 id=workshop-wrap-up->Workshop Wrap-up üéÅ</h1><span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content style=background-color:#ed0090>10 minutes</span></span><p>Congratulations, you have completed the <strong>Splunk4Rookies Observability Workshop</strong>. Today, you have become familiar with how to use Splunk Observability Cloud to monitor your applications and infrastructure.</p><p>Celebrate your achievement by adding this certificate to your <span class="badge cstyle blue badge-with-title"><span class=badge-title><i class="fab fa-fw fa-linkedin-in"></i></span><span class=badge-content><a href='https://www.linkedin.com/profile/add?startTask=CERTIFICATION_NAME&name=Splunk4Rookies%20-%20Observability&organizationId=20226&issueYear
=2023&issueMonth=12&certUrl=https%3A%2F%2Fsplunk.github.io%2Fobservability-workshop%2Flatest%2Fen%2Fs4r%2Fimages%2Fcertificate.png' style=color:#fff target=_blank>LinkedIn</a></span></span> profile.</p><p>Let&rsquo;s recap what we have learned and what you can do next.</p><p><a href=#R-image-4f6f0359d70b54f1bc98bd24ea7615e0 class=lightbox-link><img src="../en/s4r/10-wrap-up/images/champagne.png?width=45vw" alt=Champagne class="figure-image noborder lightbox noshadow" style=height:auto;width:45vw loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f6f0359d70b54f1bc98bd24ea7615e0><img src="../en/s4r/10-wrap-up/images/champagne.png?width=45vw" alt=Champagne class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Workshop Wrap-up üéÅ</h1><article class=default><header class=headline></header><h1 id=key-takeaways>Key Takeaways</h1><p>During the workshop, we have seen how the Splunk Observability Cloud in combination with the OpenTelemetry signals (<strong>metrics</strong>, <strong>traces</strong> and <strong>logs</strong>) can help you to reduce mean time to detect (<strong>MTTD</strong>) and also reduce mean time to resolution (<strong>MTTR</strong>).</p><ul><li>We have a better understanding of the Main User interface and its components, the <em>Landing, Infrastructure, APM, RUM, Synthetics, Dashboard</em> pages, and a quick peek at the <em>Settings</em> page.</li><li>Depending on time, we did an <em>Infrastructure</em> exercise and looked at <em>Metrics</em> used in the Kubernetes Navigators and saw related services found on our Kubernetes cluster:</li></ul><p><a href=#R-image-7a49d100d93931b9d6c19878a7b08322 class=lightbox-link><img src=../en/s4r/10-wrap-up/key-takeaways/../images/infra.png alt=Kubernetes class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a49d100d93931b9d6c19878a7b08322><img src=../en/s4r/10-wrap-up/key-takeaways/../images/infra.png alt=Kubernetes class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Understood what users were experiencing and used RUM & APM to Troubleshoot a particularly long page load, by following its trace across the front and back end and right to the log entries.
We used tools like RUM <em>Session replay</em> and the APM <em>Dependency map</em> with Breakdown to discover what is causing our issue:</li></ul><p><a href=#R-image-639ba57f005f8f44912c00819826f0b0 class=lightbox-link><img src=../en/s4r/10-wrap-up/key-takeaways/../images/rum-apm.png alt="rum and apm" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-639ba57f005f8f44912c00819826f0b0><img src=../en/s4r/10-wrap-up/key-takeaways/../images/rum-apm.png alt="rum and apm" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Used <em>Tag Spotlight</em>, in both RUM and APM, to understand blast radius, detect trends and context for our performance issues and errors. We drilled down in <em>Span&rsquo;s</em> in the APM <em>Trace waterfall</em> to see how services interacted and find errors:</li></ul><p><a href=#R-image-1d4887d9fed66dd4ccab2f287c2232dd class=lightbox-link><img src=../en/s4r/10-wrap-up/key-takeaways/../images/tag-spotlight-waterfall.png alt="tag and waterfall" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1d4887d9fed66dd4ccab2f287c2232dd><img src=../en/s4r/10-wrap-up/key-takeaways/../images/tag-spotlight-waterfall.png alt="tag and waterfall" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>We used the <em>Related content</em> feature to follow the link between our <em>Trace</em> directly to the <em>Logs</em> related to our <em>Trace</em> and used filters to drill down to the exact cause of our issue.</li></ul><p><a href=#R-image-827652907f3a9b90a7da7765a4212b5b class=lightbox-link><img src=../en/s4r/10-wrap-up/key-takeaways/../images/log.png alt=logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-827652907f3a9b90a7da7765a4212b5b><img src=../en/s4r/10-wrap-up/key-takeaways/../images/log.png alt=logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><p>We then looked at Synthetics, which can simulate web and mobile traffic and we used the available Synthetic Test, first to confirm our finding from RUM/AMP and Log observer, then we created a <em>Detector</em> so we would be alerted if when the run time of a test exceeded our SLA.</p></li><li><p>In the final exercise, we created a health dashboard to keep that running for our Developers and SREs on a TV screen:</p></li></ul><p><a href=#R-image-7595d49a36fce2df6d39255c1aea5b50 class=lightbox-link><img src=../en/s4r/10-wrap-up/key-takeaways/../images/synth-tv.png alt="synth and TV" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7595d49a36fce2df6d39255c1aea5b50><img src=../en/s4r/10-wrap-up/key-takeaways/../images/synth-tv.png alt="synth and TV" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-im>Splunk IM</h1><p>During this <em><strong>technical</strong></em> Splunk Observability Cloud Infrastructure Monitoring and APM Workshop, you will build out an environment based on a <a href=https://k3s.io/ target=_blank>lightweight</a> Kubernetes<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> cluster.</p><p>To simplify the workshop modules, a pre-configured AWS/EC2 instance is provided.</p><p>The instance is pre-configured with all the software required to deploy the Splunk OpenTelemetry Connector<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> in Kubernetes, deploy an NGINX^3 ReplicaSet^4 and finally deploy a microservices-based application which has been instrumented using OpenTelemetry to send metrics, traces, spans and logs<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><p>The workshops also introduce you to dashboards, editing and creating charts, creating detectors to fire alerts, Monitoring as Code and the Service Bureau<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><p>By the end of these technical workshops, you will have a good understanding of some of the key features and capabilities of the Splunk Observability Cloud.</p><p>Here are the instructions on how to access your pre-configured <a href=../en/imt/initial-setup/index.html>AWS</a>/EC2 instance](./initial-setup/)</p><p><a href=#R-image-7a6461f087615b4b140c354d13fb1b79 class=lightbox-link><img src=../en/imt/images/architecture.png alt="Splunk Architecture" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a6461f087615b4b140c354d13fb1b79><img src=../en/imt/images/architecture.png alt="Splunk Architecture" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://kubernetes.io/docs/concepts/overview/what-is-kubernetes/ target=_blank><strong>Kubernetes</strong></a> is a portable, extensible, open-source platform for managing containerized workloads and services, that facilitates both declarative configuration and automation.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://opentelemetry.io/ target=_blank><strong>OpenTelemetry Collector</strong></a> offers a vendor-agnostic implementation on how to receive, process and export telemetry data. In addition, it removes the need to run, operate and maintain multiple agents/collectors to support open-source telemetry data formats (e.g. Jaeger, Prometheus, etc.) sending to multiple open-source or commercial back-ends.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.jaegertracing.io/ target=_blank><strong>Jaeger</strong></a>, inspired by Dapper and OpenZipkin, is a distributed tracing system released as open source by Uber Technologies. It is used for monitoring and troubleshooting microservices-based distributed systems&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p><a href=https://www.splunk.com/en_us/blog/it/monitoring-observability-enterprise-service.html target=_blank><strong>Monitoring as Code and Service Bureau</strong></a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk IM</h1><article class=default><header class=headline></header><h1 id=how-to-connect-to-your-workshop-environment>How to connect to your workshop environment</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
5 minutes ü•∑üèª</button></span><ol><li>How to retrieve the IP address of the AWS/EC2 instance assigned to you.</li><li>Connect to your instance using SSH, Putty<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> or your web browser.</li><li>Verify your connection to your AWS/EC2 cloud instance.</li><li>Using Putty (Optional)</li><li>Using Multipass (Optional)</li></ol><hr><h2 id=1-awsec2-ip-address>1. AWS/EC2 IP Address</h2><p>In preparation for the workshop, Splunk has prepared an Ubuntu Linux instance in AWS/EC2.</p><p>To get access to the instance that you will be using in the workshop please visit the URL to access the Google Sheet provided by the workshop leader.</p><p>Search for your AWS/EC2 instance by looking for your first and last name, as provided during registration for this workshop.</p><p><a href=#R-image-b811e198ff3141b901a2598328b19bf8 class=lightbox-link><img src=../en/imt/initial-setup/../images/spreadsheet-info.png alt="attendee spreadsheet" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b811e198ff3141b901a2598328b19bf8><img src=../en/imt/initial-setup/../images/spreadsheet-info.png alt="attendee spreadsheet" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Find your allocated IP address, SSH command (for Mac OS, Linux and the latest Windows versions) and password to enable you to connect to your workshop instance.</p><p>It also has the Browser Access URL that you can use in case you cannot connect via ssh or putty - see <a href=#4-web-browser-all>EC2 access via Web browser</a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>Please use SSH or Putty to gain access to your EC2 instance if possible and
make a note of the IP address as you will need this during the workshop.</p></div></div><h2 id=2-ssh-mac-oslinux>2. SSH (Mac OS/Linux)</h2><p>Most attendees will be able to connect to the workshop by using SSH from their Mac or Linux device, or on Windows 10 and above.</p><p>To use SSH, open a terminal on your system and type <code>ssh ubuntu@x.x.x.x</code> (replacing x.x.x.x with the IP address found in Step #1).</p><p><a href=#R-image-e0adf2fa9925a6ff6a0230d51c6529cd class=lightbox-link><img src=../en/imt/initial-setup/../images/ssh-1.png alt="ssh login" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0adf2fa9925a6ff6a0230d51c6529cd><img src=../en/imt/initial-setup/../images/ssh-1.png alt="ssh login" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>When prompted <strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> please type <strong><code>yes</code></strong>.</p><p><a href=#R-image-baea3bf52da42aebe20afb683b4e9446 class=lightbox-link><img src=../en/imt/initial-setup/../images/ssh-2.png alt="ssh password" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-baea3bf52da42aebe20afb683b4e9446><img src=../en/imt/initial-setup/../images/ssh-2.png alt="ssh password" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Enter the password provided in the Google Sheet from Step #1.</p><p>Upon successful login, you will be presented with the Splunk logo and the Linux prompt.</p><p><a href=#R-image-19e004f117f3bdf7d16343d94aeb1fd4 class=lightbox-link><img src=../en/imt/initial-setup/../images/ssh-3.png alt="ssh connected" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-19e004f117f3bdf7d16343d94aeb1fd4><img src=../en/imt/initial-setup/../images/ssh-3.png alt="ssh connected" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-ssh-windows-10-and-above>3. SSH (Windows 10 and above)</h2><p>The procedure described above is the same on Windows 10, and the commands can be executed either in the Windows Command Prompt or PowerShell.
However, Windows regards its SSH Client as an &ldquo;optional feature&rdquo;, which might need to be enabled.</p><p>You can verify if SSH is enabled by simply executing <code>ssh</code></p><p>If you are shown a help text on how to use the ssh-command (like shown on the screenshot below), you are all set.</p><p><a href=#R-image-115dbdbe31a3957f5a0d40873f23792a class=lightbox-link><img src=../en/imt/initial-setup/../images/windows-ssh-enabled-feedback.png alt="Windows SSH enabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-115dbdbe31a3957f5a0d40873f23792a><img src=../en/imt/initial-setup/../images/windows-ssh-enabled-feedback.png alt="Windows SSH enabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If the result of executing the command looks something like the screenshot below, you want to enable the &ldquo;OpenSSH Client&rdquo; feature manually.</p><p><a href=#R-image-debc0fd37065a603645d2fb91b0e30d3 class=lightbox-link><img src=../en/imt/initial-setup/../images/windows-ssh-disabled-feedback.png alt="Windows SSH disabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-debc0fd37065a603645d2fb91b0e30d3><img src=../en/imt/initial-setup/../images/windows-ssh-disabled-feedback.png alt="Windows SSH disabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To do that, open the &ldquo;Settings&rdquo; menu, and click on &ldquo;Apps&rdquo;. While in the &ldquo;Apps & features&rdquo; section, click on &ldquo;Optional features&rdquo;.</p><p><a href=#R-image-ea80a28b1e6dd4cc1f67f3bef66c9b2a class=lightbox-link><img src=../en/imt/initial-setup/../images/windows-gui-optionalfeatures.png alt="Windows Apps Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ea80a28b1e6dd4cc1f67f3bef66c9b2a><img src=../en/imt/initial-setup/../images/windows-gui-optionalfeatures.png alt="Windows Apps Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Here, you are presented with a list of installed features. On the top, you see a button with a plus icon to &ldquo;Add a feature&rdquo;. Click it.
In the search input field, type &ldquo;OpenSSH&rdquo;, and find a feature called &ldquo;OpenSSH Client&rdquo;, or respectively, &ldquo;OpenSSH Client (Beta)&rdquo;, click on it, and click the &ldquo;Install&rdquo;-button.</p><p><a href=#R-image-6ee46d3c1814b629aab05880e65441e4 class=lightbox-link><img src=../en/imt/initial-setup/../images/windows-enable-openssh-client.png alt="Windows Enable OpenSSH Client" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ee46d3c1814b629aab05880e65441e4><img src=../en/imt/initial-setup/../images/windows-enable-openssh-client.png alt="Windows Enable OpenSSH Client" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now you are set! In case you are not able to access the provided instance despite enabling the OpenSSH feature, please do not shy away from reaching
out to the course instructor, either via chat or directly.</p><p>At this point you are ready to continue and <a href=../en/imt/initial-setup/../gdi/index.html>start the workshop</a></p><hr><h2 id=4-putty-for-windows-versions-prior-to-windows-10>4. Putty (For Windows Versions prior to Windows 10)</h2><p>If you do not have SSH pre-installed or if you are on a Windows system, the best option is to install putty, you can find <a href=https://www.putty.org/ target=_blank>here.</a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>If you <strong>cannot</strong> install Putty, please go to <a href=#4-web-browser-all>Web Browser (All)</a>.</p></div></div><p>Open Putty and enter in the <strong>Host Name (or IP address)</strong> field the IP address provided in the Google Sheet.</p><p>You can optionally save your settings by providing a name and pressing <strong>Save</strong>.</p><p><a href=#R-image-d4cb75b1381f0c5f17233a8520606413 class=lightbox-link><img src=../en/imt/initial-setup/../images//putty-settings.png alt=putty-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4cb75b1381f0c5f17233a8520606413><img src=../en/imt/initial-setup/../images//putty-settings.png alt=putty-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To then login to your instance click on the <strong>Open</strong> button as shown above.</p><p>If this is the first time connecting to your AWS/EC2 workshop instance, you will be presented with a security dialogue, please click <strong>Yes</strong>.</p><p><a href=#R-image-04f474434a1a5daa0163f307c3b9631d class=lightbox-link><img src=../en/imt/initial-setup/../images//putty-security.png alt=putty-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-04f474434a1a5daa0163f307c3b9631d><img src=../en/imt/initial-setup/../images//putty-security.png alt=putty-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once connected, login in as <strong>ubuntu</strong> and the password is the one provided in the Google Sheet.</p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-be827efd62c148e5ec8058af6a89ea3a class=lightbox-link><img src=../en/imt/initial-setup/../images//putty-loggedin.png alt=putty-4 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-be827efd62c148e5ec8058af6a89ea3a><img src=../en/imt/initial-setup/../images//putty-loggedin.png alt=putty-4 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>At this point, you are ready to continue and <a href=../en/imt/initial-setup/../gdi/index.html>start the workshop</a></p><hr><h2 id=5-web-browser-all>5. Web Browser (All)</h2><p>If you are blocked from using SSH (Port 22) or unable to install Putty you may be able to connect to the workshop instance by using a web browser.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>This assumes that access to port 6501 is not restricted by your company&rsquo;s firewall.</p></div></div><p>Open your web browser and type <strong><a href=http://x.x.x.x:6501 target=_blank>http://x.x.x.x:6501</a></strong> (where X.X.X.X is the IP address from the Google Sheet).</p><p><a href=#R-image-76cacaf04ea09807451ff67b9b16215d class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-url.png alt=http-6501 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76cacaf04ea09807451ff67b9b16215d><img src=../en/imt/initial-setup/../images//shellinabox-url.png alt=http-6501 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once connected, login in as <strong>ubuntu</strong> and the password is the one provided in the Google Sheet.</p><p><a href=#R-image-919ed6817be011f7c037436dedf17740 class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-connect.png alt=http-connect class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-919ed6817be011f7c037436dedf17740><img src=../en/imt/initial-setup/../images//shellinabox-connect.png alt=http-connect class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-b49020a2cc09d926a3da5bca05c99bbc class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-login.png alt="web login" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b49020a2cc09d926a3da5bca05c99bbc><img src=../en/imt/initial-setup/../images//shellinabox-login.png alt="web login" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Unlike when you are using regular SSH, <em>copy and paste</em> does require a few extra steps to complete when using a browser session. This is due to cross browser restrictions.</p><p>When the workshop asks you to copy instructions into your terminal, please do the following:</p><p><em>Copy the instruction as normal, but when ready to paste it in the web terminal, choose <strong>Paste from browser</strong> as show below:</em></p><p><a href=#R-image-9841668f78ff477b3a44bac181c11b8d class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-paste-browser.png alt="web paste 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9841668f78ff477b3a44bac181c11b8d><img src=../en/imt/initial-setup/../images//shellinabox-paste-browser.png alt="web paste 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open a dialogue box asking for the text to be pasted into the web terminal:</p><p><a href=#R-image-f59b642d80ecd02a4c0b78c8c27f2a28 class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-example-1.png alt="web paste 3" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f59b642d80ecd02a4c0b78c8c27f2a28><img src=../en/imt/initial-setup/../images//shellinabox-example-1.png alt="web paste 3" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Paste the text in the text box as shown, then press <strong>OK</strong> to complete the copy and paste process.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>Unlike regular SSH connection, the web browser has a 60-second time out, and you will be disconnected, and a <strong>Connect</strong> button will be shown in the center of the web terminal.</p><p>Simply click the <strong>Connect</strong> button and you will be reconnected and will be able to continue.</p></div></div><p><a href=#R-image-b9f93610d9d7ee345fba65c25543e566 class=lightbox-link><img src=../en/imt/initial-setup/../images//shellinabox-reconnect.png alt="web reconnect" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b9f93610d9d7ee345fba65c25543e566><img src=../en/imt/initial-setup/../images//shellinabox-reconnect.png alt="web reconnect" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>At this point you are ready to continue and <a href=../en/imt/initial-setup/../gdi/index.html>start the workshop</a>.</p><hr><h2 id=6-multipass-all>6. Multipass (All)</h2><p>If you are unable to access AWS, but want to install software locally, follow the instructions for <a href=https://github.com/splunk/observability-workshop/blob/main/multipass/README.md target=_blank>using Multipass</a>.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://www.chiark.greenend.org.uk/~sgtatham/putty/ target=_blank>Download Putty</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-collector-in-kubernetes>Deploying the OpenTelemetry Collector in Kubernetes</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
15 minutes</button></span><ul><li>Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s</li><li>Explore your cluster in the Kubernetes Navigator</li></ul><hr><h2 id=1-installation-using-helm>1. Installation using Helm</h2><p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository to Helm and update:</p><div class=tab-panel data-tab-group=89a07886d3f7562948070d7305167860><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-repo-add class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("89a07886d3f7562948070d7305167860","helm-repo-add")'>
<span class=tab-nav-text>Helm Repo Add</span></button>
<button data-tab-item=helm-repo-add-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("89a07886d3f7562948070d7305167860","helm-repo-add-output")'>
<span class=tab-nav-text>Helm Repo Add Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-repo-add class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=helm-repo-add-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
&ldquo;splunk-otel-collector-chart&rdquo; has been added to your repositories
Using ACCESS_TOKEN={REDACTED}
Using REALM=eu0
Hang tight while we grab the latest from your chart repositories&mldr;
&mldr;Successfully got an update from the &ldquo;splunk-otel-collector-chart&rdquo; chart repository
Update Complete. ‚éàHappy Helming!‚éà</p></div></div></div></div><p>Install the OpenTelemetry Collector Helm chart with the following commands, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=6ea53da889388efb3eee53a032fc34f7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("6ea53da889388efb3eee53a032fc34f7","helm-install")'>
<span class=tab-nav-text>Helm Install</span></button>
<button data-tab-item=helm-install-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("6ea53da889388efb3eee53a032fc34f7","helm-install-output")'>
<span class=tab-nav-text>Helm Install Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.logsEnabled=false&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.infrastructureMonitoringEventsEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$INSTANCE</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div><div data-tab-item=helm-install-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Fri May  7 11:19:01 2021
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 1
</span></span><span class=line><span class=cl>TEST SUITE: None</span></span></code></pre></div></div></div></div></div><p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report a new pod is up and running after about 30 seconds.</p><p>Ensure the status is reported as Running before continuing.</p><div class=tab-panel data-tab-group=ef81bd2ff9c5069d7888491849791764><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ef81bd2ff9c5069d7888491849791764","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ef81bd2ff9c5069d7888491849791764","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-2sk6k                             0/1     Running   0          10s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6956d4446f-gwnd7   0/1     Running   0          10s</span></span></code></pre></div></div></div></div></div><p>Ensure there are no errors by tailing the logs from the OpenTelemetry Collector pod. The output should look similar to the log output shown in the Output tab below.</p><p>Use the label set by the <code>helm</code> install to tail logs (You will need to press <code>ctrl+c</code> to exit). Or use the installed <code>k9s</code> terminal UI for bonus points!</p><div class=tab-panel data-tab-group=da79896f5da9e15e29df9bfc707aaf3a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("da79896f5da9e15e29df9bfc707aaf3a","kubectl-logs")'>
<span class=tab-nav-text>Kubectl Logs</span></button>
<button data-tab-item=kubectl-logs-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("da79896f5da9e15e29df9bfc707aaf3a","kubectl-logs-output")'>
<span class=tab-nav-text>Kubectl Logs Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div><div data-tab-item=kubectl-logs-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>2021-03-21T16:11:10.900Z INFO service/service.go:364 Starting receivers&mldr;
2021-03-21T16:11:10.900Z INFO builder/receivers_builder.go:70 Receiver is starting&mldr; {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;prometheus&rdquo;, &ldquo;component_name&rdquo;: &ldquo;prometheus&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:75 Receiver started. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;prometheus&rdquo;, &ldquo;component_name&rdquo;: &ldquo;prometheus&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:70 Receiver is starting&mldr; {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.009Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0>k8sclusterreceiver@v0.21.0</a>/watcher.go:195 Configured Kubernetes MetadataExporter {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;exporter_name&rdquo;: &ldquo;signalfx&rdquo;}
2021-03-21T16:11:11.009Z INFO builder/receivers_builder.go:75 Receiver started. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.009Z INFO healthcheck/handler.go:128 Health Check state change {&ldquo;component_kind&rdquo;: &ldquo;extension&rdquo;, &ldquo;component_type&rdquo;: &ldquo;health_check&rdquo;, &ldquo;component_name&rdquo;: &ldquo;health_check&rdquo;, &ldquo;status&rdquo;: &ldquo;ready&rdquo;}
2021-03-21T16:11:11.009Z INFO service/service.go:267 Everything is ready. Begin running and processing data.
2021-03-21T16:11:11.009Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0>k8sclusterreceiver@v0.21.0</a>/receiver.go:59 Starting shared informers and wait for initial cache sync. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}
2021-03-21T16:11:11.281Z INFO <a href=mailto:k8sclusterreceiver@v0.21.0>k8sclusterreceiver@v0.21.0</a>/receiver.go:75 Completed syncing shared informer caches. {&ldquo;component_kind&rdquo;: &ldquo;receiver&rdquo;, &ldquo;component_type&rdquo;: &ldquo;k8s_cluster&rdquo;, &ldquo;component_name&rdquo;: &ldquo;k8s_cluster&rdquo;}</p></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Deleting a failed installation</div><div class=box-content><p>If you make an error installing the OpenTelemetry Collector you can start over by deleting the installation using:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></div><hr><h2 id=2-validate-metrics-in-the-ui>2. Validate metrics in the UI</h2><p>In the Splunk UI, click the <strong>&#187;</strong> bottom left and click on <strong>Infrastructure</strong>.</p><p><a href=#R-image-c114d36329d19e3327811cd357e71733 class=lightbox-link><img src=../en/imt/gdi/../images/clustermap-nav.png alt="Selecting the Kubernetes Navigator Map" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c114d36329d19e3327811cd357e71733><img src=../en/imt/gdi/../images/clustermap-nav.png alt="Selecting the Kubernetes Navigator Map" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Under <strong>Containers</strong> click on <strong>Kubernetes</strong> to open the Kubernetes Navigator Cluster Map to ensure metrics are being sent in.</p><p>Validate that your cluster is discovered and reported by finding your cluster (in the workshop you will see many other clusters). To find your cluster name run the following command and copy the output to your clipboard:</p><div class=tab-panel data-tab-group=791d64216910a8407e3e25498c32de1d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-cluster-name class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("791d64216910a8407e3e25498c32de1d","echo-cluster-name")'>
<span class=tab-nav-text>Echo Cluster Name</span></button></div><div class=tab-content-container><div data-tab-item=echo-cluster-name class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span>-k3s-cluster</span></span></code></pre></div></div></div></div></div><p>Then in the UI, click on the &ldquo;Cluster: - " menu just below the Splunk Logo, and paste the Cluster name you just copied into the search box, click the box to select your cluster, and finally click off the menu into white space to apply the filter.</p><p><a href=#R-image-59c2f0c78341b257039b737509855fdb class=lightbox-link><img src=../en/imt/gdi/../images/search-k3s-cluster.png alt="K8S Clusters Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-59c2f0c78341b257039b737509855fdb><img src=../en/imt/gdi/../images/search-k3s-cluster.png alt="K8S Clusters Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-69fec1eda9f3c32bcdbf0f2fa5e4f7c6 class=lightbox-link><img src=../en/imt/gdi/../images/selecting-k3s-cluster.png alt="Select K8S Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-69fec1eda9f3c32bcdbf0f2fa5e4f7c6><img src=../en/imt/gdi/../images/selecting-k3s-cluster.png alt="Select K8S Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-e106c6ad82e623a5da3e0e692fe4e13c class=lightbox-link><img src=../en/imt/gdi/../images/filtered-k3s-cluster.png alt="Filtered K8S Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e106c6ad82e623a5da3e0e692fe4e13c><img src=../en/imt/gdi/../images/filtered-k3s-cluster.png alt="Filtered K8S Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To examine the health of your node, hover over the pale blue background of your cluster, then click on the blue magnifying glass <a href=#R-image-985f52cb75132908d12b68940ca7fd7b class=lightbox-link><img src="../en/imt/gdi/../images/blue-cross.png?classes=inline&amp;height=25px" alt="Magnifying Glass" class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-985f52cb75132908d12b68940ca7fd7b><img src="../en/imt/gdi/../images/blue-cross.png?classes=inline&amp;height=25px" alt="Magnifying Glass" class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> that appears in the top left-hand corner.</p><p>This will drill down to the node level. Next, open the Metrics sidebar by clicking on the sidebar button.</p><p>Once it is open, you can use the slider on the side to explore the various charts relevant to your cluster/node: CPU, Memory, Network, Events etc.</p><p><a href=#R-image-509b5c254bfb17d2006cdafbf17efd59 class=lightbox-link><img src=../en/imt/gdi/../images/explore-metrics.png alt="Sidebar metrics" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-509b5c254bfb17d2006cdafbf17efd59><img src=../en/imt/gdi/../images/explore-metrics.png alt="Sidebar metrics" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Deploying the OpenTelemetry Collector in Kubernetes</h1><article class=default><header class=headline></header><h1 id=deploying-nginx-in-k3s>Deploying NGINX in K3s</h1><ul><li>Deploy a NGINX ReplicaSet into your K3s cluster and confirm the discovery of your NGINX deployment.</li><li>Run a load test to create metrics and confirm them streaming into Splunk Observability Cloud!</li></ul><hr><h2 id=1-start-your-nginx>1. Start your NGINX</h2><p>Verify the number of pods running in the Splunk UI by selecting the <strong>WORKLOADS</strong> tab. This should give you an overview of the workloads on your cluster.</p><p><a href=#R-image-83bb86b6ef5e9352ac13d8ee45adbc1d class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/k8s-workloads.png alt="Workload Agent" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-83bb86b6ef5e9352ac13d8ee45adbc1d><img src=../en/imt/gdi/nginx/../../images/k8s-workloads.png alt="Workload Agent" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Note the single agent container running per node among the default Kubernetes pods. This single container will monitor all the pods and services being deployed on this node!</p><p>Now switch back to the default cluster node view by selecting the <strong>MAP</strong> tab and selecting your cluster again.</p><p>In your AWS/EC2 or Multipass shell session change into the <code>nginx</code> directory:</p><div class=tab-panel data-tab-group=2f2cbeb92f4dc20f9d81851764537089><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("2f2cbeb92f4dc20f9d81851764537089","change-directory")'>
<span class=tab-nav-text>Change Directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/k3s/nginx</span></span></code></pre></div></div></div></div></div><hr><h2 id=2-create-nginx-deployment>2. Create NGINX deployment</h2><p>Create the NGINX ConfigMap<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> using the <code>nginx.conf</code> file:</p><div class=tab-panel data-tab-group=c3bd317f74d613207378cc405bddc60c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-configmap-create class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("c3bd317f74d613207378cc405bddc60c","kubectl-configmap-create")'>
<span class=tab-nav-text>Kubectl Configmap Create</span></button>
<button data-tab-item=kubectl-create-configmap-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("c3bd317f74d613207378cc405bddc60c","kubectl-create-configmap-output")'>
<span class=tab-nav-text>Kubectl Create Configmap Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-configmap-create class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create configmap nginxconfig --from-file<span class=o>=</span>nginx.conf</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-configmap-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>configmap/nginxconfig created</p></div></div></div></div><p>Then create the deployment:</p><div class=tab-panel data-tab-group=0e429cd3e0912e40f505ed54c2367158><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("0e429cd3e0912e40f505ed54c2367158","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span></button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("0e429cd3e0912e40f505ed54c2367158","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f nginx-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>deployment.apps/nginx created
service/nginx created</p></div></div></div></div><p>Next, we will deploy Locust<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> which is an open-source tool used for creating a load test against NGINX:</p><div class=tab-panel data-tab-group=881c85b3df4ff121028efae79e88f635><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-create-deployment class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("881c85b3df4ff121028efae79e88f635","kubectl-create-deployment")'>
<span class=tab-nav-text>Kubectl Create Deployment</span></button>
<button data-tab-item=kubectl-create-deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("881c85b3df4ff121028efae79e88f635","kubectl-create-deployment-output")'>
<span class=tab-nav-text>Kubectl Create Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-create-deployment class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f locust-deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=kubectl-create-deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>deployment.apps/nginx-loadgenerator created
service/nginx-loadgenerator created</p></div></div></div></div><p>Validate the deployment has been successful and that the Locust and NGINX pods are running.</p><p>If you have the Splunk UI open you should see new Pods being started and containers being deployed.</p><p>It should only take around 20 seconds for the pods to transition into a Running state. In the Splunk UI you will have a cluster that looks like the screenshot below:</p><p><a href=#R-image-99bd98e09b97c1f3b25398608a0c667b class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/cluster.png alt="back to Cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-99bd98e09b97c1f3b25398608a0c667b><img src=../en/imt/gdi/nginx/../../images/cluster.png alt="back to Cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you select the <strong>WORKLOADS</strong> tab again you will now see that there is a new ReplicaSet and a deployment added for NGINX:</p><p><a href=#R-image-339a7103b11149a66b34bc89832a8a9b class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/k8s-workloads-nginx.png alt="NGINX loaded" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-339a7103b11149a66b34bc89832a8a9b><img src=../en/imt/gdi/nginx/../../images/k8s-workloads-nginx.png alt="NGINX loaded" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>Let&rsquo;s validate this in your shell as well:</p><div class=tab-panel data-tab-group=026ff2224b8add91ed7911efb7ba1982><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("026ff2224b8add91ed7911efb7ba1982","kubectl-get-pods")'>
<span class=tab-nav-text>Kubectl Get Pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("026ff2224b8add91ed7911efb7ba1982","kubectl-get-pods-output")'>
<span class=tab-nav-text>Kubectl Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>NAME READY STATUS RESTARTS AGE
splunk-otel-collector-k8s-cluster-receiver-77784c659c-ttmpk 1/1 Running 0 9m19s
splunk-otel-collector-agent-249rd 1/1 Running 0 9m19s
svclb-nginx-vtnzg 1/1 Running 0 5m57s
nginx-7b95fb6b6b-7sb9x 1/1 Running 0 5m57s
nginx-7b95fb6b6b-lnzsq 1/1 Running 0 5m57s
nginx-7b95fb6b6b-hlx27 1/1 Running 0 5m57s
nginx-7b95fb6b6b-zwns9 1/1 Running 0 5m57s
svclb-nginx-loadgenerator-nscx4 1/1 Running 0 2m20s
nginx-loadgenerator-755c8f7ff6-x957q 1/1 Running 0 2m20s</p></div></div></div></div><hr><h2 id=3-run-locust-load-test>3. Run Locust load test</h2><p>Locust, an open-source load generator, is available on port 8083 of the EC2 instance&rsquo;s IP address. Open a new tab in your web browser and go to <code>http://{==EC2-IP==}:8083/</code>, you will then be able to see the Locust running.</p><p><a href=#R-image-b650d88e04da47509be6a959b8d470d9 class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/nginx-locust.png alt=Locust class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b650d88e04da47509be6a959b8d470d9><img src=../en/imt/gdi/nginx/../../images/nginx-locust.png alt=Locust class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Set the <strong>Spawn rate</strong> to 2 and click <strong>Start Swarming</strong>.</p><p><a href=#R-image-3f8f53cc12691e798d03ef1b607f6aeb class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/nginx-locust-spawn-rate.png alt="Locust Spawn Rate" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f8f53cc12691e798d03ef1b607f6aeb><img src=../en/imt/gdi/nginx/../../images/nginx-locust-spawn-rate.png alt="Locust Spawn Rate" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will start a gentle continuous load on the application.</p><p><a href=#R-image-3bd2029630e205a1b58316d81f6d9d88 class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/nginx-locust-statistics.png alt="Locust Statistics" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3bd2029630e205a1b58316d81f6d9d88><img src=../en/imt/gdi/nginx/../../images/nginx-locust-statistics.png alt="Locust Statistics" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>As you can see from the above screenshot, most of the calls will report a fail, this is expected, as we have not yet deployed the application behind it, however, NGINX is reporting on your attempts and you should be able to see those metrics.</p><p>Validate you are seeing those metrics in the UI by selecting <strong>Dashboards ‚Üí Built-in Dashboard Groups ‚Üí NGINX ‚Üí NGINX Servers</strong>. Using the <strong>Overrides</strong> filter on <code>k8s.cluster.name:</code>, find the name of your cluster as returned by <code>echo $INSTANCE-k3s-cluster</code> in the terminal.</p><p><a href=#R-image-8581045ea78d5b8bf92b13fe412f45ec class=lightbox-link><img src=../en/imt/gdi/nginx/../../images/nginx-dashboard.png alt="NGINX Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8581045ea78d5b8bf92b13fe412f45ec><img src=../en/imt/gdi/nginx/../../images/nginx-dashboard.png alt="NGINX Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A ConfigMap is an API object used to store non-confidential data in key-value pairs. Pods can consume ConfigMaps as environment variables, command-line arguments, or configuration files in a volume. A ConfigMap allows you to decouple environment-specific configuration from your container images so that your applications are easily portable.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://locust.io/ target=_blank>What is Locust?</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=working-with-dashboards>Working with Dashboards</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
20 minutes</button></span><ul><li>Introduction to the Dashboards and charts</li><li>Editing and creating charts</li><li>Filtering and analytical functions</li><li>Using formulas</li><li>Saving charts in a dashboard</li><li>Introduction to SignalFlow</li></ul><hr><h2 id=1-dashboards>1. Dashboards</h2><p>Dashboards are groupings of charts and visualizations of metrics. Well-designed dashboards can provide useful and actionable insight into your system at a glance. Dashboards can be complex or contain just a few charts that drill down only into the data you want to see.</p><p>During this module we are going to create the following charts and dashboard and connect it to your Team page.</p><p><a href=#R-image-09221c69fc937a67cd472e69af9c52d8 class=lightbox-link><img src=../en/imt/dashboards/../images/example-dashboard.png alt="Example Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-09221c69fc937a67cd472e69af9c52d8><img src=../en/imt/dashboards/../images/example-dashboard.png alt="Example Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=2-your-teams-page>2. Your Teams&rsquo; Page</h2><p>Click on the <a href=#R-image-f9f374ac44636953473764c6ccd88cfa class=lightbox-link><img src="../en/imt/dashboards/../images/dashboards.png?classes=inline&amp;height=25px" alt="dashboards button" class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9f374ac44636953473764c6ccd88cfa><img src="../en/imt/dashboards/../images/dashboards.png?classes=inline&amp;height=25px" alt="dashboards button" class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> from the navbar. As you have already been assigned to a team, you will land on the team dashboard. We use the <em><strong>Example Team</strong></em> as an example here. The one in your workshop will be different!</p><p><a href=#R-image-7caceacaa0fab9201b44b9278aeea949 class=lightbox-link><img src=../en/imt/dashboards/../images/team-dashboard.png alt="Team Dashboard1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7caceacaa0fab9201b44b9278aeea949><img src=../en/imt/dashboards/../images/team-dashboard.png alt="Team Dashboard1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This page shows the total number of team members, how many active alerts for your team and all dashboards that are assigned to your team. Right now they are no dashboards assigned but as stated before, we will add the new dashboard that you will create to your Teams page later.</p><hr><h2 id=3-sample-charts>3. Sample Charts</h2><p>To continue, click on <strong>All Dashboards</strong> on the top right corner of the screen.
This brings you to the view that shows all the available dashboards, including the pre-built ones.</p><p><a href=#R-image-3a7acb4f45f9001deec159321987d2c4 class=lightbox-link><img src=../en/imt/dashboards/../images/sample-data.png alt="Sample Data" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3a7acb4f45f9001deec159321987d2c4><img src=../en/imt/dashboards/../images/sample-data.png alt="Sample Data" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you are already receiving metrics from a Cloud API integration or another service through the Splunk Agent you will see relevant dashboards for these services.</p><hr><h2 id=4-inspecting-the-sample-data>4. Inspecting the Sample Data</h2><p>Among the dashboards you will see a Dashboard group called <strong>Sample Data</strong>. Expand the <strong>Sample Data</strong> dashboard group by clicking on it, and then click on the <strong>Sample Charts</strong> dashboard.</p><p>In the Sample Charts dashboard you can see a selection of charts that show a sample of the various styles, colors and formats you can apply to your charts in the dashboards.</p><p>Have a look through all the dashboards in this dashboard group (<strong>PART 1</strong>, <strong>PART 2</strong>, <strong>PART 3</strong> and <strong>INTRO TO SPLUNK OBSERVABILITY CLOUD</strong>)</p><p><a href=#R-image-ba909696f53540e95b333e7f7cd6b521 class=lightbox-link><img src=../en/imt/dashboards/../images/sample-charts.png alt="Sample Charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ba909696f53540e95b333e7f7cd6b521><img src=../en/imt/dashboards/../images/sample-charts.png alt="Sample Charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Working with Dashboards</h1><article class=default><header class=headline></header><h1 id=editing-charts>Editing charts</h1><h2 id=1-editing-a-chart>1. Editing a chart</h2><p>Select the <strong>SAMPLE CHARTS</strong> dashboard and then click on the three dots <strong><code>...</code></strong> on the <strong>Latency histogram</strong> chart, then on <strong>Open</strong> (or you can click on the name of the chart which here is <strong>Latency histogram</strong>).</p><p><a href=#R-image-7bf81da4272f6713268d0956da5ce0b4 class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/latency-histogram-open.png alt="Sample Charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7bf81da4272f6713268d0956da5ce0b4><img src=../en/imt/dashboards/editing/../../images/latency-histogram-open.png alt="Sample Charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will see the plot options, current plot and signal (metric) for the <strong>Latency histogram</strong> chart in the chart editor UI.</p><p><a href=#R-image-62e8f049ed130d98ed8e02e9d0ab81a5 class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/latency-histogram.png alt="Latency Histogram" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62e8f049ed130d98ed8e02e9d0ab81a5><img src=../en/imt/dashboards/editing/../../images/latency-histogram.png alt="Latency Histogram" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the <strong>Plot Editor</strong> tab under <strong>Signal</strong> you see the metric <strong><code>demo.trans.latency</code></strong> we are currently plotting.</p><p><a href=#R-image-e0b19c7687bc98402fdcf2056c683273 class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/plot-editor.png alt="Plot Editor" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0b19c7687bc98402fdcf2056c683273><img src=../en/imt/dashboards/editing/../../images/plot-editor.png alt="Plot Editor" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will see a number of <strong>Line</strong> plots. The number <strong><code>18 ts</code></strong> indicates that we are plotting 18 metric time series in the chart.</p><p>Click on the different chart type icons to explore each of the visualizations. Notice their name while you swipe over them. For example, click on the Heat Map icon:</p><p><a href=#R-image-b13a86a0bdcaa33d34f7d5e7b7d53cde class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/M-Editing-2.png alt="Chart Types" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b13a86a0bdcaa33d34f7d5e7b7d53cde><img src=../en/imt/dashboards/editing/../../images/M-Editing-2.png alt="Chart Types" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>See how the chart changes to a heat map.</p><p><a href=#R-image-b30336b9bb3ba494fe7472b4a792193c class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/change-to-heatmap.png alt="Change to Heatmap" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b30336b9bb3ba494fe7472b4a792193c><img src=../en/imt/dashboards/editing/../../images/change-to-heatmap.png alt="Change to Heatmap" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>You can use different charts to visualize your metrics - you choose which chart type fits best for the visualization you want to have.</p><p>For more info on the different chart types see <a href=https://docs.splunk.com/Observability/data-visualization/charts/chart-types.html#chart-types target=_blank>Choosing a chart type.</a></p></div></div><p>Click on the <strong>Line</strong> chart type and you will see the line plot.</p><p><a href=#R-image-e28838aedcf671c37190eba6218c9edf class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/M-Editing-3b.png alt="Line Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e28838aedcf671c37190eba6218c9edf><img src=../en/imt/dashboards/editing/../../images/M-Editing-3b.png alt="Line Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-changing-the-time-window>2. Changing the time window</h2><p>You can also increase the time window of the chart by changing the time to <strong>Past 15 minutes</strong> by selecting from the <strong>Time</strong> dropdown.</p><p><a href=#R-image-fa04e3991f3367040303cc52828bfda1 class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/line-chart.png alt="Line Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa04e3991f3367040303cc52828bfda1><img src=../en/imt/dashboards/editing/../../images/line-chart.png alt="Line Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-viewing-the-data-table>3. Viewing the Data Table</h2><p>Click on the <strong>Data Table</strong> tab.</p><p><a href=#R-image-ebb0a2eacc585122081ca6d0434419b2 class=lightbox-link><img src=../en/imt/dashboards/editing/../../images/data-table.png alt="Data Table" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ebb0a2eacc585122081ca6d0434419b2><img src=../en/imt/dashboards/editing/../../images/data-table.png alt="Data Table" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You now see 18 rows, each representing a metric time series with a number of columns. These columns represent the dimensions of the metric. The dimensions for <code>demo.trans.latency</code> are:</p><ul><li><code>demo_datacenter</code></li><li><code>demo_customer</code></li><li><code>demo_host</code></li></ul><p>In the <strong><code>demo_datacenter</code></strong> column you see that there are two data centers, <strong>Paris</strong> and <strong>Tokyo</strong>, for which we are getting metrics.</p><p>If you move your cursor over the lines in the chart horizontally you will see the data table update accordingly. If you click on one of the lines in the chart you will see a pinned value appear in the data table.</p><hr><p>Now click on <strong>Plot editor</strong> again to close the Data Table and let&rsquo;s save this chart into a dashboard for later use!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=saving-charts>Saving charts</h1><h2 id=1-saving-a-chart>1. Saving a chart</h2><p>To start saving your chart, lets give it a name and description. Click the name of the chart <strong>Copy of Latency Histogram</strong> and rename it to <strong>&ldquo;Active Latency&rdquo;</strong>.</p><p>To change the description click on <strong>Spread of latency values across time.</strong> and change this to <strong>Overview of latency values in real-time.</strong></p><p><a href=#R-image-9a93cddd919e9f0568b3c3af4e0cd321 class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/save-chart.png alt="Save Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a93cddd919e9f0568b3c3af4e0cd321><img src=../en/imt/dashboards/savingcharts/../../images/save-chart.png alt="Save Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click the
<span class="btn cstyle blue"><button type=button>
Save As</button></span> button. Make sure your chart has a name, it will use the name <strong>Active Latency</strong> the you defined in the previous step, but you can edit it here if needed.</p><p>Press the
<span class="btn cstyle blue"><button type=button>
Ok</button></span>
button to continue.</p><p><a href=#R-image-c30ad95ff54fc1267fb9a7591e8ebb5f class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/name-chart.png alt="Name Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c30ad95ff54fc1267fb9a7591e8ebb5f><img src=../en/imt/dashboards/savingcharts/../../images/name-chart.png alt="Name Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-creating-a-dashboard>2. Creating a dashboard</h2><p>In the <strong>Choose dashboard</strong> dialog, we need to create a new dashboard, click on the
<span class="btn cstyle blue"><button type=button>
New Dashboard</button></span>
button.</p><p><a href=#R-image-3cbc99e876dc2d7619408eee815c365b class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/create-dashboard.png alt="Create Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3cbc99e876dc2d7619408eee815c365b><img src=../en/imt/dashboards/savingcharts/../../images/create-dashboard.png alt="Create Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will now see the <strong>New Dashboard</strong> Dialog. In here you can give you dashboard a name and description, and set <strong>Read and Write Permissions</strong>.</p><p>Please use your own name in the following format to give your dashboard a name e.g. <strong>YOUR_NAME-Dashboard</strong>.</p><p>Please replace <strong>YOUR_NAME</strong> with your own name, change the dashboard permissions to <em>Restricted Read and Write access</em>, and verify your user can read/write.</p><p><a href=#R-image-a66d2e28d59e3810c000293d6d320c59 class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/name-dashboard.png alt="Name Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a66d2e28d59e3810c000293d6d320c59><img src=../en/imt/dashboards/savingcharts/../../images/name-dashboard.png alt="Name Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should see you own login information displayed, meaning you are now the only one who can edit this dashboard. Of course you have the option to add other users or teams from the drop box below that may edit your dashboard and charts, but for now make sure you change it back to <em>Everyone can Read or Write</em> to remove any restrictions and press the
<span class="btn cstyle blue"><button type=button>
Save</button></span>
Button to continue.</p><p>Your new dashboard is now available and selected so you can save your chart in your new dashboard.</p><p><a href=#R-image-a0a5d3293ff03ddf66ecab03c66291ab class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/choose-dashboard.png alt="Choose Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a0a5d3293ff03ddf66ecab03c66291ab><img src=../en/imt/dashboards/savingcharts/../../images/choose-dashboard.png alt="Choose Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Make sure you have your dashboard selected and press the
<span class="btn cstyle blue"><button type=button>
Ok</button></span> button.</p><p>You will now be taken to your dashboard like below. You can see at the top left that your <strong>YOUR_NAME-DASHBOARD</strong> is part of a Dashboard Group <strong>YOUR_NAME-Dashboard</strong>. You can add other dashboards to this dashboard group.</p><p><a href=#R-image-f70ca3971c2ddf70278553b424668460 class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/new-dashboard-group.png alt="New Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f70ca3971c2ddf70278553b424668460><img src=../en/imt/dashboards/savingcharts/../../images/new-dashboard-group.png alt="New Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=3-add-to-team-page>3. Add to Team page</h2><p>It is common practice to link dashboards that are relevant to a Team to a teams page. So let&rsquo;s add your dashboard to the team page for easy access later. Use the <a href=#R-image-769e7835dcc014c2e66303b1cb5dc57b class=lightbox-link><img src="../en/imt/dashboards/savingcharts/../../images/dashboards.png?classes=inline&amp;height=25px" alt="dashboards button" class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-769e7835dcc014c2e66303b1cb5dc57b><img src="../en/imt/dashboards/savingcharts/../../images/dashboards.png?classes=inline&amp;height=25px" alt="dashboards button" class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> from the navbar again.</p><p>This will bring you to your teams dashboard, We use the team <em><strong>Example Team</strong></em> as an example here, the workshop one will be different.</p><p><a href=#R-image-783b040b3f5a17183fa07df57b87a72c class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/team-dashboard.png alt="Team Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-783b040b3f5a17183fa07df57b87a72c><img src=../en/imt/dashboards/savingcharts/../../images/team-dashboard.png alt="Team Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Press the
<span class="btn cstyle white"><button type=button>
+</button></span> <em>Add Dashboard Group</em> button to add you dashboard to the team page.</p><p>This will bring you to the <strong>Select a dashboard group to link to this team</strong> dialog.
Type your name (that you used above) in the search box to find your Dashboard. Select it so its highlighted and click the <strong>Ok</strong> button to add your dashboard.</p><p><a href=#R-image-1974e04cbdb9d2753dbab8323387829a class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/select-dashboard-group.png alt="Select Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1974e04cbdb9d2753dbab8323387829a><img src=../en/imt/dashboards/savingcharts/../../images/select-dashboard-group.png alt="Select Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Your dashboard group will appear as part of the team page. Please note during the course of the workshop many more will appear here.</p><p><a href=#R-image-0e022f03567b3cbd115a7cc544fdd122 class=lightbox-link><img src=../en/imt/dashboards/savingcharts/../../images/new-team-dashboard.png alt="New Team Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e022f03567b3cbd115a7cc544fdd122><img src=../en/imt/dashboards/savingcharts/../../images/new-team-dashboard.png alt="New Team Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>Now click on the link for your Dashboard to add more charts!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=33-using-filters--formulas>3.3 Using Filters & Formulas</h1><h2 id=1-creating-a-new-chart>1 Creating a new chart</h2><p>Let&rsquo;s now create a new chart and save it in our dashboard!</p><p>Select the plus icon (top right of the UI) and from the drop down, choose the option <strong>Chart</strong>.
Or click on the
<span class="btn cstyle blue"><button type=button>
+ New Chart</button></span> Button to create a new chart.</p><p><a href=#R-image-cc9b160663a1202301b4a19c1d47d11a class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-0.png alt="Create new chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cc9b160663a1202301b4a19c1d47d11a><img src=../en/imt/dashboards/filtering/../../images/M-Filter-0.png alt="Create new chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will now see a chart template like the following.</p><p><a href=#R-image-f5b9d953797cfa857983d3b9f484bc70 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Editing-6.png alt="Empty Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5b9d953797cfa857983d3b9f484bc70><img src=../en/imt/dashboards/filtering/../../images/M-Editing-6.png alt="Empty Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Let&rsquo;s enter a metric to plot. We are still going to use the metric <strong><code>demo.trans.latency</code></strong>.</p><p>In the <strong>Plot Editor</strong> tab under <strong>Signal</strong> enter <strong><code>demo.trans.latency</code></strong>.</p><p><a href=#R-image-13631747643fbc9881a067755436e818 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/plot-editor.png alt=Signal class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-13631747643fbc9881a067755436e818><img src=../en/imt/dashboards/filtering/../../images/plot-editor.png alt=Signal class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now have a familiar line chart. Please switch the time to 15 mins.</p><p><a href=#R-image-1ab7c36f49c57864d6e95dae453f9fb2 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-10.png alt=Signal class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1ab7c36f49c57864d6e95dae453f9fb2><img src=../en/imt/dashboards/filtering/../../images/M-Filter-10.png alt=Signal class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-filtering-and-analytics>2. Filtering and Analytics</h2><p>Let&rsquo;s now select the <strong>Paris</strong> datacenter to do some analytics - for that we will use a filter.</p><p>Let&rsquo;s go back to the <strong>Plot Editor</strong> tab and click on
<span class="btn cstyle blue"><button type=button>
Add Filter</button></span>
, wait until it automatically populates, choose <strong><code>demo_datacenter</code></strong>, and then <strong><code>Paris</code></strong>.</p><p><a href=#R-image-28fa54cc892c15cb56cdd7526dd254d6 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-1.png alt=Filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28fa54cc892c15cb56cdd7526dd254d6><img src=../en/imt/dashboards/filtering/../../images/M-Filter-1.png alt=Filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the <strong>F(x)</strong> column, add the analytic function <strong><code>Percentile:Aggregation</code></strong>, and leave the value to <strong><code>95</code></strong> (click outside to confirm).</p><p><a href=#R-image-72ee2d0229d8b09e272b4279d903b4f2 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-2.png alt=Analytics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-72ee2d0229d8b09e272b4279d903b4f2><img src=../en/imt/dashboards/filtering/../../images/M-Filter-2.png alt=Analytics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>For info on the <strong>Percentile</strong> function and the other functions see <a href=https://docs.splunk.com/Observability/data-visualization/charts/gain-insights-through-chart-analytics.html#gain-insights-through-chart-analytics target=_blank>Chart Analytics</a>.</p><hr><h2 id=3-using-timeshift-analytical-function>3. Using Timeshift analytical function</h2><p>Let&rsquo;s now compare with older metrics. Click on <strong><code>...</code></strong> and then on <strong>Clone</strong> in the dropdown to clone Signal <strong>A</strong>.</p><p><a href=#R-image-9842859a94fb3acd0861da0fc4227594 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-3.png alt="Clone Signal" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9842859a94fb3acd0861da0fc4227594><img src=../en/imt/dashboards/filtering/../../images/M-Filter-3.png alt="Clone Signal" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will see a new row identical to <strong>A</strong>, called <strong>B</strong>, both visible and plotted.</p><p><a href=#R-image-6fb46a8a942201d02bded65afa46f86e class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-4.png alt="Plot Editor" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6fb46a8a942201d02bded65afa46f86e><img src=../en/imt/dashboards/filtering/../../images/M-Filter-4.png alt="Plot Editor" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>For Signal <strong>B</strong>, in the <strong>F(x)</strong> column add the analytic function <strong>Timeshift</strong> and enter <strong><code>1w</code></strong> (or 7d for 7 days), and click outside to confirm.</p><p><a href=#R-image-1860644e0531aa4401e426d78e8ceae4 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-5.png alt=Timeshift class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1860644e0531aa4401e426d78e8ceae4><img src=../en/imt/dashboards/filtering/../../images/M-Filter-5.png alt=Timeshift class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the cog on the far right, and choose a <strong>Plot Color</strong> e.g. pink, to change color for the plot of <strong>B</strong>.</p><p><a href=#R-image-92b9699f886f9fae9df0e801e2890321 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-6.png alt="Change Plot Colour" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-92b9699f886f9fae9df0e801e2890321><img src=../en/imt/dashboards/filtering/../../images/M-Filter-6.png alt="Change Plot Colour" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on <strong>Close</strong>.</p><p>We now see plots for Signal <strong>A</strong> (the past 15 minutes) as a blue plot, and the plots from a week ago in pink.</p><p>In order to make this clearer we can click on the <strong>Area chart</strong> icon to change the visualization.</p><p><a href=#R-image-00dfc9bd80212fb1b594e62e26d3731b class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-8.png alt="Area Chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-00dfc9bd80212fb1b594e62e26d3731b><img src=../en/imt/dashboards/filtering/../../images/M-Filter-8.png alt="Area Chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We now can see when last weeks latency was higher!</p><p>Next, click into the field next to <strong>Time</strong> on the Override bar and choose <strong><code>Past Hour</code></strong> from the dropdown.</p><p><a href=#R-image-9c5fc4927cb708954c0ac4513e26786d class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-9.png alt=Timeframe class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9c5fc4927cb708954c0ac4513e26786d><img src=../en/imt/dashboards/filtering/../../images/M-Filter-9.png alt=Timeframe class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=4-using-formulas>4. Using Formulas</h2><p>Let&rsquo;s now plot the difference of all metric values for a day with 7 days in between.</p><p>Click on
<span class="btn cstyle blue"><button type=button>
Enter Formula</button></span>
then enter <strong><code>A-B</code></strong> (A minus B) and hide (deselect) all Signals using the eye, except <strong>C</strong>.</p><p><a href=#R-image-db452cebe36a4d60b007ac148df572c1 class=lightbox-link><img src=../en/imt/dashboards/filtering/../../images/M-Filter-11.png alt=Formulas class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db452cebe36a4d60b007ac148df572c1><img src=../en/imt/dashboards/filtering/../../images/M-Filter-11.png alt=Formulas class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We now see only the difference of all metric values of <strong>A</strong> and <strong>B</strong> being plotted. We see that we have some negative values on the plot because a metric value of <strong>B</strong> has some times larger value than the metric value of <strong>A</strong> at that time.</p><p>Lets look at the Signalflow that drives our Charts and Detectors!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=34-signalflow>3.4 SignalFlow</h1><h2 id=1-introduction>1. Introduction</h2><p>Let&rsquo;s take a look at SignalFlow - the analytics language of Observability Cloud that can be used to setup monitoring as code.</p><p>The heart of Splunk Infrastructure Monitoring is the SignalFlow analytics engine that runs computations written in a Python-like language. SignalFlow programs accept streaming input and produce output in real time. SignalFlow provides built-in analytical functions that take metric time series (MTS) as input, perform computations, and output a resulting MTS.</p><ul><li>Comparisons with historical norms, e.g. on a week-over-week basis</li><li>Population overviews using a distributed percentile chart</li><li>Detecting if the rate of change (or other metric expressed as a ratio, such as a service level objective) has exceeded a critical threshold</li><li>Finding correlated dimensions, e.g. to determine which service is most correlated with alerts for low disk space</li></ul><p>Infrastructure Monitoring creates these computations in the Chart Builder user interface, which lets you specify the input MTS to use and the analytical functions you want to apply to them. You can also run SignalFlow programs directly by using the <a href=https://dev.splunk.com/observability/docs/ target=_blank>SignalFlow API</a>.</p><p>SignalFlow includes a large library of built-in analytical functions that take a metric time series as an input, performs computations on its datapoints, and outputs time series that are the result of the computation.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>For more information on SignalFlow see <a href=https://docs.splunk.com/Observability/infrastructure/analytics/signalflow.html target=_blank>Analyze incoming data using SignalFlow</a>.</p></div></div><h2 id=2-view-signalflow>2. View SignalFlow</h2><p>In the chart builder, click on <strong>View SignalFlow</strong>.</p><p><a href=#R-image-cee57f74eebdb16ecd65f8dc52e0feaf class=lightbox-link><img src=../en/imt/dashboards/signalflow/../../images/view-signalflow.png alt=SignalFlow class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cee57f74eebdb16ecd65f8dc52e0feaf><img src=../en/imt/dashboards/signalflow/../../images/view-signalflow.png alt=SignalFlow class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will see the SignalFlow code that composes the chart we were working on. You can now edit the SignalFlow directly within the UI. Our documentation has the <a href=https://dev.splunk.com/observability/docs/signalflow/function_method_list target=_blank>full list</a> of SignalFlow functions and methods.</p><p>Also, you can copy the SignalFlow and use it when interacting with the API or with Terraform to enable Monitoring as Code.</p><p><a href=#R-image-87d65ad450e1c609b34b605062b7801e class=lightbox-link><img src=../en/imt/dashboards/signalflow/../../images/show-signalflow.png alt=Code class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-87d65ad450e1c609b34b605062b7801e><img src=../en/imt/dashboards/signalflow/../../images/show-signalflow.png alt=Code class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=tab-panel data-tab-group=5060f85cf014474313076b964a1933e4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=signalflow class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("5060f85cf014474313076b964a1933e4","signalflow")'>
<span class=tab-nav-text>SignalFlow</span></button></div><div class=tab-content-container><div data-tab-item=signalflow class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>timeshift</span><span class=p>(</span><span class=s1>&#39;1w&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=n>B</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;C&#39;</span><span class=p>)</span></span></span></code></pre></div></div></div></div></div><p>Click on <strong>View Builder</strong> to go back to the Chart <strong>Builder</strong> UI.</p><p><a href=#R-image-72e95428e302d2444b921a015f9791f5 class=lightbox-link><img src=../en/imt/dashboards/signalflow/../../images/view-builder.png alt="View Builder" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-72e95428e302d2444b921a015f9791f5><img src=../en/imt/dashboards/signalflow/../../images/view-builder.png alt="View Builder" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Let&rsquo;s save this new chart to our Dashboard!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=adding-charts-to-dashboards>Adding charts to dashboards</h1><h2 id=1-save-to-existing-dashboard>1. Save to existing dashboard</h2><p>Check that you have <strong>YOUR_NAME-Dashboard: YOUR_NAME-Dashboard</strong> in the top left corner. This means you chart will be saved in this Dashboard.</p><p>Name the Chart <strong>Latency History</strong> and add a Chart Description if you wish.</p><p><a href=#R-image-cff3a9ba91cf7907937eb1c45f2ff174 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-1.png alt="Save Chart 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cff3a9ba91cf7907937eb1c45f2ff174><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-1.png alt="Save Chart 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on
<span class="btn cstyle transparent"><button type=button>
Save And Close</button>
</span>. This returns you to your dashboard that now has two charts!</p><p><a href=#R-image-8b3f95010979a176c35fb0b253483539 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-2.png alt="Save Chart 2" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b3f95010979a176c35fb0b253483539><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-2.png alt="Save Chart 2" class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
Now let&rsquo;s quickly add another Chart based on the previous one.</p><h2 id=2-copy-and-paste-a-chart>2. Copy and Paste a chart</h2><p>Click on the three dots <strong><code>...</code></strong> on the <strong>Latency History</strong> chart in your dashboard and then on <strong>Copy</strong>.</p><p><a href=#R-image-9411bb532536e0dc577a91fcb014fbbd class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-3.png alt="Copy chart" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9411bb532536e0dc577a91fcb014fbbd><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-3.png alt="Copy chart" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You see the chart being copied, and you should now have a red circle with a white 1 next to the <strong>+</strong> on the top left of the page.</p><p>Click on the plus icon the top of the page, and then in the menu on <em>Paste Charts</em> (There should also be a red dot with a 1 visible at the end of the line).</p><p><a href=#R-image-e0b35ba3185dedf3acf67b1e6ea873ff class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-5.png alt="Past charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e0b35ba3185dedf3acf67b1e6ea873ff><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-5.png alt="Past charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will place a copy of the previous chart in your dashboard.</p><p><a href=#R-image-17525e10669abc9e9ee2ea3a758e7d7d class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-6.png alt="Three Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-17525e10669abc9e9ee2ea3a758e7d7d><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-6.png alt="Three Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-edit-the-pasted-chart>3. Edit the pasted chart</h2><p>Click on the three dots <strong><code>...</code></strong> on one of the <strong>Latency History</strong> charts in your dashboard and then on <strong>Open</strong> (or you can click on the name of the chart which here is <strong>Latency History</strong>).</p><p>This will bring you to the editor environment again.</p><p>First set the time for the chart to -1 hour in the Time box at the top right of the chart. Then to make this a different chart, click on the eye icon in front of signal &ldquo;<em>A</em>&rdquo; to make it visible again, and then hide signal &ldquo;<em>C</em>&rdquo; via the eye icon and change the name for <em>Latency history</em> to <strong>Latency vs Load</strong>.</p><p><a href=#R-image-d4d132bab127085591546ae92471fed5 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-7.png alt="Set Visibility" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4d132bab127085591546ae92471fed5><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-7.png alt="Set Visibility" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the
<span class="btn cstyle blue"><button type=button>
Add Metric Or Event</button></span> button. This will bring up the box for a new signal. Type and select <code>demo.trans.count</code> for Signal <strong>D</strong>.</p><p><a href=#R-image-74ea698202aa1085f3497db29ae10f49 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-8.png alt="Dashboard Info" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-74ea698202aa1085f3497db29ae10f49><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-8.png alt="Dashboard Info" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will add a new Signal <strong>D</strong> to your chart, It shows the number of active requests. Add the filter for the <em>demo_datacenter:Paris</em>, then change the Rollup type by clicking on the <strong>Configure Plot</strong> button and changing the roll-up from <strong>Auto (Delta)</strong> to <strong>Rate/sec</strong>. Change the name from <strong>demo.trans.count</strong> to <strong>Latency vs Load</strong>.</p><p><a href=#R-image-3625850c75a9baa34eb6a49d564f9a40 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-9.png alt="rollup change" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3625850c75a9baa34eb6a49d564f9a40><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-9.png alt="rollup change" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Finally press the
<span class="btn cstyle transparent"><button type=button>
Save And Close</button></span> button. This returns you to your dashboard that now has three different charts!</p><p><a href=#R-image-b101bca17c6d673a242e1fc013a500c0 class=lightbox-link><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-10.png alt="three charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b101bca17c6d673a242e1fc013a500c0><img src=../en/imt/dashboards/adding-charts/../../images/M-MoreCharts-10.png alt="three charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Let&rsquo;s add an &ldquo;instruction&rdquo; note and arrange the charts!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=adding-notes-and-dashboard-layout>Adding Notes and Dashboard Layout</h1><h2 id=1-adding-notes>1. Adding Notes</h2><p>Often on dashboards it makes sense to place a short &ldquo;instruction&rdquo; pane that helps users of a dashboard. Lets add one now by clicking on the
<span class="btn cstyle white"><button type=button>
New Text Note</button></span>
Button.</p><p><a href=#R-image-bf544c6c6f7b25d7141e7b8174bf5538 class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-0.png alt="three charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf544c6c6f7b25d7141e7b8174bf5538><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-0.png alt="three charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open the notes editor.</p><p><a href=#R-image-b2f665d94c6bf19d3a60dc016cde222c class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-1.png alt="Notes 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b2f665d94c6bf19d3a60dc016cde222c><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-1.png alt="Notes 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To allow you to add more then just text to you notes, Splunk is allowing you to use Markdown in these notes/panes.
Markdown is a lightweight markup language for creating formatted text using plain-text often used in Webpages.</p><p>This includes (but not limited to):</p><ul><li>Headers. (in various sizes)</li><li>Emphasis styles.</li><li>Lists and Tables.</li><li>Links. These can be external webpages (for documentation for example) or directly to other Splunk IM Dashboards</li></ul><p>Below is an example of above Markdown options you can use in your note.</p><div class=tab-panel data-tab-group=fb86b21954a61275d04b58c82e8c3fac><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=sample-markdown-text class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("fb86b21954a61275d04b58c82e8c3fac","sample-markdown-text")'>
<span class=tab-nav-text>Sample Markdown text</span></button></div><div class=tab-content-container><div data-tab-item=sample-markdown-text class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># h1 Big headings
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>###### h6 To small headings
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gu>##### Emphasis
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gs>**This is bold text**</span>, <span class=ge>*This is italic text*</span> , <span class=gd>~~Strikethrough~~</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Lists
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>Unordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+ Create a list by starting a line with <span class=sb>`+`</span>, <span class=sb>`-`</span>, or <span class=sb>`*`</span>
</span></span><span class=line><span class=cl><span class=k>-</span> Sub-lists are made by indenting 2 spaces:
</span></span><span class=line><span class=cl><span class=k>-</span> Marker character change forces new list start:
</span></span><span class=line><span class=cl>    <span class=k>*</span> Ac tristique libero volutpat at
</span></span><span class=line><span class=cl>    + Facilisis in pretium nisl aliquet
</span></span><span class=line><span class=cl><span class=k>*</span> Very easy!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Lorem ipsum dolor sit amet
</span></span><span class=line><span class=cl><span class=k>2.</span> Consectetur adipiscing elit
</span></span><span class=line><span class=cl><span class=k>3.</span> Integer molestie lorem at massa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Tables
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>| Option | Description |
</span></span><span class=line><span class=cl>| ------ | ----------- |
</span></span><span class=line><span class=cl>| chart  | path to data files to supply the data that will be passed into templates. |
</span></span><span class=line><span class=cl>| engine | engine to be used for processing templates. Handlebars is the default. |
</span></span><span class=line><span class=cl>| ext    | extension to be used for dest files. |
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>#### Links
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>[<span class=nt>link to webpage</span>](<span class=na>https://www.splunk.com</span>)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[<span class=nt>link to dashboard with title</span>](<span class=na>https://app.eu0.signalfx.com/#/dashboard/EaJHrbPAEAA?groupId=EaJHgrsAIAA&amp;configId=EaJHsHzAEAA &#34;Link to the Sample chart Dashboard!&#34;</span>)</span></span></code></pre></div></div></div></div></div><p>Copy the above by using the copy button and paste it in the <em>Edit</em> box.
the preview will show you how it will look.</p><hr><h2 id=2-saving-our-chart>2. Saving our chart</h2><p>Give the Note chart a name, in our example we used <em>Example text chart</em>, then press the
<span class="btn cstyle transparent"><button type=button>
Save And Close</button></span> Button.</p><p><a href=#R-image-05be8e245708a856251456765a6fdf82 class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-2.png alt="saving note" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-05be8e245708a856251456765a6fdf82><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-2.png alt="saving note" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will bring you back to you Dashboard, that now includes the note.</p><p><a href=#R-image-1eb8fa3c93a6e0b7403abb2f75a5a80d class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-3.png alt="three charts and note" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1eb8fa3c93a6e0b7403abb2f75a5a80d><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-3.png alt="three charts and note" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=3-ordering--sizing-of-charts>3. Ordering & sizing of charts</h2><p>If you do not like the default order and sizes of your charts you can simply use window dragging technique to move and size them to the desired location.</p><p>Grab the <strong>top</strong> border of a chart and you should see the mouse pointer change to a drag icon (see picture below).</p><p><a href=#R-image-df58fff3e2e1504787898478991ff0b2 class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-4.png alt="dragging charts" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df58fff3e2e1504787898478991ff0b2><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-4.png alt="dragging charts" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now drag the <strong>Latency vs Load</strong> chart to sit between the <strong>Latency History</strong> Chart and the <strong>Example text chart</strong>.</p><p><a href=#R-image-1a8354f1bdd2a9b3c137912260c2c9e6 class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-5.png alt=sizing class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a8354f1bdd2a9b3c137912260c2c9e6><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-5.png alt=sizing class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can also resize windows by dragging from the left, right and bottom edges.</p><p>As a last exercise reduce the width of the note chart to about a third of the other charts. The chart will automatically snap to one of the sizes it supports. Widen the 3 other charts to about a third of the Dashboard. Drag the notes to the right of the others and resize it to match it to the 3 others. Set the <strong>Time</strong> to <strong>-1h</strong> and you should have the following dashboard!</p><p><a href=#R-image-cc95a6b0782b997daec67f23c5684d13 class=lightbox-link><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-6.png alt=TaDA! class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cc95a6b0782b997daec67f23c5684d13><img src=../en/imt/dashboards/notes-and-layout/../../images/M-Notes-6.png alt=TaDA! class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>On to Detectors!</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=working-with-detectors>Working with Detectors</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
10 minutes</button></span><ul><li>Create a Detector from one of your charts</li><li>Setting Alert conditions</li><li>Running a pre-flight check</li><li>Working with muting rules</li></ul><hr><h2 id=1-introduction>1. Introduction</h2><p>Splunk Observability Cloud uses detectors, events, alerts, and notifications to keep you informed when certain criteria are met. For example, you might want a message sent to a Slack channel or to an email address for the Ops team when CPU Utilization has reached 95%, or when the number of concurrent users is approaching a limit that might require you to spin up an additional AWS instance.</p><p>These conditions are expressed as one or more rules that trigger an alert when the conditions in the rules are met. Individual rules in a detector are labeled according to criticality: Info, Warning, Minor, Major, and Critical.</p><h2 id=2-creating-a-detector>2. Creating a Detector</h2><p>In <strong>Dashboards</strong> click on your <strong>Custom Dashboard Group</strong> (that you created in the previous module) and then click on the dashboard name.</p><p><a href=#R-image-b433a42e3681250940d8b7a549794271 class=lightbox-link><img src=../en/imt/detectors/../images/custom-dashboard-group.png alt="Custom Dashboard Group" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b433a42e3681250940d8b7a549794271><img src=../en/imt/detectors/../images/custom-dashboard-group.png alt="Custom Dashboard Group" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We are now going to create a new detector from a chart on this dashboard. Click on the bell icon on the <strong>Latency vs Load</strong> chart, and then click <strong>New Detector From Chart</strong>.</p><p><a href=#R-image-2f19de01d0398ae494ef4b9a5abd84b3 class=lightbox-link><img src=../en/imt/detectors/../images/new-detector.png alt="New Detector" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f19de01d0398ae494ef4b9a5abd84b3><img src=../en/imt/detectors/../images/new-detector.png alt="New Detector" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the text field next to <strong>Detector Name</strong>, <strong>ADD YOUR INITIALS</strong> before the proposed detector name.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Naming the detector</div><div class=box-content><p>It&rsquo;s important that you add your initials in front of the proposed detector name.</p><p>It should be something like this: <strong>XYZ&rsquo;s Latency Chart Detector</strong>.</p></div></div><p>Click on
<span class="btn cstyle blue"><button type=button>
Create Alert Rule</button></span></p><p><a href=#R-image-57c07a54bb226b13f98e01777f36477c class=lightbox-link><img src=../en/imt/detectors/../images/create-alert-rule.png alt="Create Alert Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-57c07a54bb226b13f98e01777f36477c><img src=../en/imt/detectors/../images/create-alert-rule.png alt="Create Alert Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the Detector window, inside <strong>Alert signal</strong>, the Signal we will alert on is marked with a (blue) bell in the <strong>Alert on</strong> column. The bell indicates which Signal is being used to generate the alert.</p><p>Click on
<span class="btn cstyle blue"><button type=button>
Proceed to Alert Condition</button></span></p><p><a href=#R-image-9a551236afe6880d2455668c334044cc class=lightbox-link><img src=../en/imt/detectors/../images/alert-signal.png alt="Alert Signal" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a551236afe6880d2455668c334044cc><img src=../en/imt/detectors/../images/alert-signal.png alt="Alert Signal" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-setting-alert-condition>3. Setting Alert condition</h2><p>In <strong>Alert condition</strong>, click on <strong>Static Threshold</strong> and then on
<span class="btn cstyle blue"><button type=button>
Proceed to Alert Settings</button></span></p><p><a href=#R-image-1a2c6119b8d1e7a4151eb102ddf1e754 class=lightbox-link><img src=../en/imt/detectors/../images/alert-condition.png alt="Alert Condition" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a2c6119b8d1e7a4151eb102ddf1e754><img src=../en/imt/detectors/../images/alert-condition.png alt="Alert Condition" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In <strong>Alert Settings</strong>, enter the value <strong><code>290</code></strong> in the <strong>Threshold</strong> field. In the same window change <strong>Time</strong> on top right to past day (<strong>-1d</strong>).</p><hr><h2 id=4-alert-pre-flight-check>4. Alert pre-flight check</h2><p>A pre-flight check will take place after 5 seconds. See the <strong>Estimated alert count</strong>. Based on the current alert settings, the amount of alerts we would have received in 1 day would have been <strong>3</strong>.</p><p><a href=#R-image-6999a688e2aaa26cccb4ab2e33f44000 class=lightbox-link><img src=../en/imt/detectors/../images/alert-threshold.png alt="Alert Threshold" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6999a688e2aaa26cccb4ab2e33f44000><img src=../en/imt/detectors/../images/alert-threshold.png alt="Alert Threshold" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> About pre-flight checks</div><div class=box-content><p>Once you set an alert condition, the UI estimates how many alerts you might get based on the current settings, and in the timeframe set on the upper right corner - in this case, the past day.</p><p>Immediately, the platform will start analyzing the signals with the current settings, and perform something we call a Pre-flight Check. This enables you to test the alert conditions using the historical data in the platform, to ensure the settings are logical and will not inadvertently generate an alert storm, removing the guess work from configuring alerts in a simple but very powerful way, only available using the Splunk Observability Cloud.</p><p>To read more about detector previewing, please visit this link
<a href=https://docs.splunk.com/Observability/alerts-detectors-notifications/preview-detector-alerts.html#nav-Preview-detector-alerts target=_blank>Preview detector alerts.</a></p></div></div><p>Click on
<span class="btn cstyle blue"><button type=button>
Proceed to Alert Message</button></span></p><hr><h2 id=5-alert-message>5. Alert message</h2><p>In <strong>Alert message</strong>, under <strong>Severity</strong> choose <strong>Major</strong>.</p><p><a href=#R-image-35716a464fd253c465274184749b06c6 class=lightbox-link><img src=../en/imt/detectors/../images/alert-message.png alt="Alert Message" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-35716a464fd253c465274184749b06c6><img src=../en/imt/detectors/../images/alert-message.png alt="Alert Message" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on
<span class="btn cstyle blue"><button type=button>
Proceed to Alert Recipients</button></span></p><p>Click on <strong>Add Recipient</strong> and then on your email address displayed as the first option.</p><p><a href=#R-image-3956c9e9f7c90824951e55766d141c74 class=lightbox-link><img src=../en/imt/detectors/../images/add-recipient.png alt="Add Recipient" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3956c9e9f7c90824951e55766d141c74><img src=../en/imt/detectors/../images/add-recipient.png alt="Add Recipient" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Notification Services</div><div class=box-content><p>That&rsquo;s the same as entering that email address OR you can enter another email address by clicking on <strong>E-mail&mldr;</strong>.</p><p>This is just one example of the many <strong>Notification Services</strong> the suite has available. You can check this out by going to the <strong>Integrations</strong> tab of the top menu, and see <strong>Notification Services</strong>.</p></div></div><hr><h2 id=6-alert-activation>6. Alert Activation</h2><p>Click on
<span class="btn cstyle blue"><button type=button>
Proceed to Alert Activation</button></span></p><p>In <strong>Activate&mldr;</strong> click on
<span class="btn cstyle blue"><button type=button>
Activate Alert Rule</button></span></p><p><a href=#R-image-a5385a4abb690d9db3ba92061d2529a7 class=lightbox-link><img src=../en/imt/detectors/../images/activate-alert.png alt="Activate Alert" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a5385a4abb690d9db3ba92061d2529a7><img src=../en/imt/detectors/../images/activate-alert.png alt="Activate Alert" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you want to get alerts quicker you edit the rule and lower the value from <strong><code>290</code></strong> to say <strong><code>280</code></strong>.</p><p>If you change the <strong>Time</strong> to <strong>-1h</strong> you can see how many alerts you might get with the threshold you have chosen based on the metrics from the last 1 hour.</p><p>Click on the <a href=#R-image-d211261fdd5f83f925b8eb3e4f2aa95f class=lightbox-link><img src="../en/imt/detectors/../images/alerts-and-detectors.png?classes=inline&amp;height=25px" alt="alerts and detectors button" class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d211261fdd5f83f925b8eb3e4f2aa95f><img src="../en/imt/detectors/../images/alerts-and-detectors.png?classes=inline&amp;height=25px" alt="alerts and detectors button" class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> in the navbar and then click on <strong>Detectors</strong>. You can optionally filter for your initials. You will see you detector listed here. If you don&rsquo;t then please refresh your browser.</p><p><a href=#R-image-16d41ee0a6f2b04c6c2cf7398aa34273 class=lightbox-link><img src=../en/imt/detectors/../images/detectors.png alt="Detector List" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-16d41ee0a6f2b04c6c2cf7398aa34273><img src=../en/imt/detectors/../images/detectors.png alt="Detector List" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations</strong>! You have created your first detector and activated it!</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Working with Detectors</h1><article class=default><header class=headline></header><h1 id=working-with-muting-rules>Working with Muting Rules</h1><ul><li>Learn how to configure Muting Rules</li><li>Learn how to resume notifications</li></ul><hr><h2 id=1-configuring-muting-rules>1. Configuring Muting Rules</h2><p>There will be times when you might want to mute certain notifications. For example, if you want to schedule downtime for maintenance on a server or set of servers, or if you are testing new code or settings etc. For that you can use muting rules in Splunk Observability Cloud. Let&rsquo;s create one!</p><p>Click on <strong>Alerts & Detectors</strong> in the sidebar and then click <strong>Detectors</strong> to see the list of active detectors.</p><p><a href=#R-image-217895ed7088afec1ea77016081ceb43 class=lightbox-link><img src=../en/imt/detectors/muting/../../images/detectors.png alt="detectors list" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-217895ed7088afec1ea77016081ceb43><img src=../en/imt/detectors/muting/../../images/detectors.png alt="detectors list" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you created a detector in <strong>Creating a Detector</strong> you can click on the three dots <strong><code>...</code></strong> on the far right for that detector; if not, do that for another detector.</p><p>From the drop-down click on <strong>Create Muting Rule&mldr;</strong></p><p><a href=#R-image-28314cd195e5cf5727282caa6bf163bf class=lightbox-link><img src=../en/imt/detectors/muting/../../images/create-muting-rule.png alt="Create Muting Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28314cd195e5cf5727282caa6bf163bf><img src=../en/imt/detectors/muting/../../images/create-muting-rule.png alt="Create Muting Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the <strong>Muting Rule</strong> window check <strong>Mute Indefinitely</strong> and enter a reason.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Important</div><div class=box-content><p>This will mute the notifications permanently until you come back here and un-check this box or resume notifications for this detector.</p></div></div><p><a href=#R-image-32bd25c6c23a995db6c30937aa6678fb class=lightbox-link><img src=../en/imt/detectors/muting/../../images/mute-indefinitely.png alt="Mute Indefinitely" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-32bd25c6c23a995db6c30937aa6678fb><img src=../en/imt/detectors/muting/../../images/mute-indefinitely.png alt="Mute Indefinitely" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click <strong>Next</strong> and in the new modal window confirm the muting rule setup.</p><p><a href=#R-image-bfe3f7e23dd50a3737085e7f16d46899 class=lightbox-link><img src=../en/imt/detectors/muting/../../images/confirm-rule.png alt="Confirm Rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bfe3f7e23dd50a3737085e7f16d46899><img src=../en/imt/detectors/muting/../../images/confirm-rule.png alt="Confirm Rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on
<span class="btn cstyle blue"><button type=button>
Mute Indefinitely</button></span> to confirm.</p><p><a href=#R-image-fbdb59dd0d44035f6b926e74ca368313 class=lightbox-link><img src=../en/imt/detectors/muting/../../images/alert-muted.png alt="List muted rule" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fbdb59dd0d44035f6b926e74ca368313><img src=../en/imt/detectors/muting/../../images/alert-muted.png alt="List muted rule" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You won&rsquo;t be receiving any email notifications from your detector until you resume notifications again. Let&rsquo;s now see how to do that!</p><hr><h2 id=2-resuming-notifications>2. Resuming notifications</h2><p>To Resume notifications, click on <strong>Muting Rules</strong>, you will see the name of the detector you muted notifications for under <strong>Detector</strong> heading.</p><p>Click on the thee dots <strong><code>...</code></strong> on the far right, and click on <strong>Resume Notifications</strong>.</p><p><a href=#R-image-5994eb32e512e0ce2eaf61adce4a5818 class=lightbox-link><img src=../en/imt/detectors/muting/../../images/muting-list.png alt=Resume class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5994eb32e512e0ce2eaf61adce4a5818><img src=../en/imt/detectors/muting/../../images/muting-list.png alt=Resume class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on
<span class="btn cstyle blue"><button type=button>
Resume</button></span> to confirm and resume notifications for this detector.</p><p><a href=#R-image-e7a00de1b83809d4f10ce73d5b09b765 class=lightbox-link><img src=../en/imt/detectors/muting/../../images/resume.png alt=Resume class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e7a00de1b83809d4f10ce73d5b09b765><img src=../en/imt/detectors/muting/../../images/resume.png alt=Resume class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations!</strong> You have now resumed your alert notifications!</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=monitoring-as-code>Monitoring as Code</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
10 minutes</button></span><ul><li>Use Terraform<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> to manage Observability Cloud Dashboards and Detectors</li><li>Initialize the Terraform Splunk Provider<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</li><li>Run Terraform to create detectors and dashboards from code using the Splunk Terraform Provider.</li><li>See how Terraform can also delete detectors and dashboards.</li></ul><hr><h2 id=1-initial-setup>1. Initial setup</h2><p>Monitoring as code adopts the same approach as infrastructure as code. You can manage monitoring the same way you do applications, servers, or other infrastructure components.</p><p>You can use monitoring as code to build out your visualizations, what to monitor, and when to alert, among other things. This means your monitoring setup, processes, and rules can be versioned, shared, and reused.</p><p>Full documentation for the Splunk Terraform Provider is available <a href=https://registry.terraform.io/providers/splunk-terraform/signalfx/latest/docs target=_blank><strong>here</strong></a>.</p><p>Remaining in your AWS/EC2 instance, change into the <code>o11y-cloud-jumpstart</code> directory</p><div class=tab-panel data-tab-group=ae8f6dabefa6d58875b6aecf757f59f5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=change-directory class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ae8f6dabefa6d58875b6aecf757f59f5","change-directory")'>
<span class=tab-nav-text>Change directory</span></button></div><div class=tab-content-container><div data-tab-item=change-directory class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/observability-content-contrib/integration-examples/terraform-jumpstart</span></span></code></pre></div></div></div></div></div><p>Initialize Terraform and upgrade to the latest version of the Splunk Terraform Provider.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: Upgrading the SignalFx Terraform Provider</div><div class=box-content><p>You will need to run the command below each time a new version of the Splunk Terraform Provider is released. You can track the releases on <a href=https://github.com/splunk-terraform/terraform-provider-signalfx/releases target=_blank>GitHub.</a></p></div></div><div class=tab-panel data-tab-group=a69db6d8d452a49dde689dfc731dbda8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=initialise-terraform class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a69db6d8d452a49dde689dfc731dbda8","initialise-terraform")'>
<span class=tab-nav-text>Initialise Terraform</span></button>
<button data-tab-item=initialise-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a69db6d8d452a49dde689dfc731dbda8","initialise-output")'>
<span class=tab-nav-text>Initialise Output</span></button></div><div class=tab-content-container><div data-tab-item=initialise-terraform class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init -upgrade</span></span></code></pre></div></div></div><div data-tab-item=initialise-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    Upgrading modules...
</span></span><span class=line><span class=cl>    - aws in modules/aws
</span></span><span class=line><span class=cl>    - azure in modules/azure
</span></span><span class=line><span class=cl>    - docker in modules/docker
</span></span><span class=line><span class=cl>    - gcp in modules/gcp
</span></span><span class=line><span class=cl>    - host in modules/host
</span></span><span class=line><span class=cl>    - kafka in modules/kafka
</span></span><span class=line><span class=cl>    - kubernetes in modules/kubernetes
</span></span><span class=line><span class=cl>    - parent_child_dashboard in modules/dashboards/parent
</span></span><span class=line><span class=cl>    - pivotal in modules/pivotal
</span></span><span class=line><span class=cl>    - rum_and_synthetics_dashboard in modules/dashboards/rum_and_synthetics
</span></span><span class=line><span class=cl>    - usage_dashboard in modules/dashboards/usage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing the backend...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Initializing provider plugins...
</span></span><span class=line><span class=cl>    - Finding latest version of splunk-terraform/signalfx...
</span></span><span class=line><span class=cl>    - Installing splunk-terraform/signalfx v6.20.0...
</span></span><span class=line><span class=cl>    - Installed splunk-terraform/signalfx v6.20.0 (self-signed, key ID CE97B6074989F138)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Partner and community providers are signed by their developers.
</span></span><span class=line><span class=cl>    If you&#39;d like to know more about provider signing, you can read about it here:
</span></span><span class=line><span class=cl>    https://www.terraform.io/docs/cli/plugins/signing.html
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has created a lock file .terraform.lock.hcl to record the provider
</span></span><span class=line><span class=cl>    selections it made above. Include this file in your version control repository
</span></span><span class=line><span class=cl>    so that Terraform can guarantee to make the same selections by default when
</span></span><span class=line><span class=cl>    you run &#34;terraform init&#34; in the future.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    Terraform has been successfully initialized!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    You may now begin working with Terraform. Try running &#34;terraform plan&#34; to see
</span></span><span class=line><span class=cl>    any changes that are required for your infrastructure. All Terraform commands
</span></span><span class=line><span class=cl>    should now work.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    If you ever set or change modules or backend configuration for Terraform,
</span></span><span class=line><span class=cl>    rerun this command to reinitialize your working directory. If you forget, other
</span></span><span class=line><span class=cl>    commands will detect it and remind you to do so if necessary.</span></span></code></pre></div></div></div></div></div><h2 id=2-create-execution-plan>2. Create execution plan</h2><p>The <code>terraform plan</code> command creates an execution plan. By default, creating a plan consists of:</p><ul><li>Reading the current state of any already-existing remote objects to make sure that the Terraform state is up-to-date.</li><li>Comparing the current configuration to the prior state and noting any differences.</li><li>Proposing a set of change actions that should, if applied, make the remote objects match the configuration.</li></ul><p>The plan command alone will not actually carry out the proposed changes, and so you can use this command to check whether the proposed changes match what you expected before you apply the changes</p><div class=tab-panel data-tab-group=7b8b6051c0dc88dbd97d68b525678db3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=execution-plan class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7b8b6051c0dc88dbd97d68b525678db3","execution-plan")'>
<span class=tab-nav-text>Execution Plan</span></button>
<button data-tab-item=execution-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7b8b6051c0dc88dbd97d68b525678db3","execution-plan-output")'>
<span class=tab-nav-text>Execution Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=execution-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=nv>$INSTANCE</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=execution-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Plan: 146 to add, 0 to change, 0 to destroy.</span></span></code></pre></div></div></div></div></div><p>If the plan executes successfully, we can go ahead and apply:</p><hr><h2 id=3-apply-execution-plan>3. Apply execution plan</h2><p>The <code>terraform apply</code> command executes the actions proposed in the Terraform plan above.</p><p>The most straightforward way to use <code>terraform apply</code> is to run it without any arguments at all, in which case it will automatically create a new execution plan (as if you had run terraform plan) and then prompt you to provide the API Token, Realm (the prefix defaults to <code>Splunk</code>) and approve the plan, before taking the indicated actions.</p><p>Due to this being a workshop it is required that the prefix is to be unique so you need to run the <code>terraform apply</code> below.</p><div class=tab-panel data-tab-group=bafa24831492305843ffc821933856a6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=apply-plan class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("bafa24831492305843ffc821933856a6","apply-plan")'>
<span class=tab-nav-text>Apply Plan</span></button>
<button data-tab-item=apply-plan-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("bafa24831492305843ffc821933856a6","apply-plan-output")'>
<span class=tab-nav-text>Apply Plan Output</span></button></div><div class=tab-content-container><div data-tab-item=apply-plan class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;o11y_prefix=[</span><span class=nv>$INSTANCE</span><span class=s2>]&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=apply-plan-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Apply complete! Resources: 146 added, 0 changed, 0 destroyed.</span></span></code></pre></div></div></div></div></div><p>Once the apply has been completed, validate that the detectors were created, under the <strong>Alerts & Detectors</strong> and click on the <strong>Detectors</strong> tab. They will be prefixed by the instance name. To check the prefix value run:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span></span></span></code></pre></div><p>You will see a list of the new detectors and you can search for the prefix that was output from above.</p><p><a href=#R-image-2f585f132930e3a529acf94996b44340 class=lightbox-link><img src=../en/imt/monitoring-as-code/../images/detectors.png alt=Detectors class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f585f132930e3a529acf94996b44340><img src=../en/imt/monitoring-as-code/../images/detectors.png alt=Detectors class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-destroy-all-your-hard-work>3. Destroy all your hard work</h2><p>The <code>terraform destroy</code> command is a convenient way to destroy all remote objects managed by your Terraform configuration.</p><p>While you will typically not want to destroy long-lived objects in a production environment, Terraform is sometimes used to manage ephemeral infrastructure for development purposes, in which case you can use <code>terraform destroy</code> to conveniently clean up all of those temporary objects once you are finished with your work.</p><p>Now go and destroy all the Detectors and Dashboards that were previously applied!</p><div class=tab-panel data-tab-group=550606fcf4c969b5caf7f6c854ecafa8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=destroy class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("550606fcf4c969b5caf7f6c854ecafa8","destroy")'>
<span class=tab-nav-text>Destroy</span></button>
<button data-tab-item=destroy-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("550606fcf4c969b5caf7f6c854ecafa8","destroy-output")'>
<span class=tab-nav-text>Destroy Output</span></button></div><div class=tab-content-container><div data-tab-item=destroy class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy -var<span class=o>=</span><span class=s2>&#34;api_token=</span><span class=nv>$API_TOKEN</span><span class=s2>&#34;</span> -var<span class=o>=</span><span class=s2>&#34;realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span></span></span></code></pre></div></div></div><div data-tab-item=destroy-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Destroy complete! Resources: 146 destroyed.</span></span></code></pre></div></div></div></div></div><p>Validate all the detectors have been removed by navigating to <em><strong>Alerts ‚Üí Detectors</strong></em></p><p><a href=#R-image-bb43f17ef53df0cd43f83e8dc2220b83 class=lightbox-link><img src=../en/imt/monitoring-as-code/../images/destroy.png alt=Destroyed class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb43f17ef53df0cd43f83e8dc2220b83><img src=../en/imt/monitoring-as-code/../images/destroy.png alt=Destroyed class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Terraform is a tool for building, changing, and versioning infrastructure safely and efficiently. Terraform can manage existing and popular service providers as well as custom in-house solutions.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>A provider is responsible for understanding API interactions and exposing resources. Providers generally are an IaaS (e.g. Alibaba Cloud, AWS, GCP, Microsoft Azure, OpenStack), PaaS (e.g. Heroku), or SaaS services (e.g. Splunk, Terraform Cloud, DNSimple, Cloudflare).&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=service-bureau>Service Bureau</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
10 minutes</button></span><ul><li>How to keep track of the usage of Observability Cloud in your organization</li><li>Learn how to keep track of spend by exploring the Subscription Usage interface</li><li>Creating Teams</li><li>Adding notification rules to Teams</li><li>Controlling usage</li></ul><hr><h2 id=1-understanding-engagement>1. Understanding engagement</h2><p>To fully understand Observability Cloud engagement inside your organization, click on the <strong>&#187;</strong> bottom left and select the <strong>Settings ‚Üí Organization Overview</strong>, this will provide you with the following dashboards that show you how your Observability Cloud organization is being used:</p><p><a href=#R-image-e2e42c9c4aab4ab1551cf2bfe55d7999 class=lightbox-link><img src=../en/imt/servicebureau/../images/engagement.png alt="Organization Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e2e42c9c4aab4ab1551cf2bfe55d7999><img src=../en/imt/servicebureau/../images/engagement.png alt="Organization Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will see various dashboards such as Throttling, System Limits, Entitlements & Engagement. The workshop organization you&rsquo;re using now may have less data to work with as this is cleared down after each workshop.</p><p>Take a minute to explore the various dashboards and charts in the Organization Overview of this workshop instance.</p><h2 id=2-subscription-usage>2. Subscription Usage</h2><p>If you want to see what your usage is against your subscription you can select <strong>Subscription Usage</strong>.</p><p><a href=#R-image-813f9c297840b10b8cbeeabbaa928c12 class=lightbox-link><img src=../en/imt/servicebureau/../images/billing-and-usage-menu.png alt="Left pane" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-813f9c297840b10b8cbeeabbaa928c12><img src=../en/imt/servicebureau/../images/billing-and-usage-menu.png alt="Left pane" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This screen may take a few seconds to load whilst it calculates and pulls in the usage.</p><h2 id=3-understanding-usage>3. Understanding usage</h2><p>You will see a screen similar to the one below that will give you an overview of the current usage, the average usage and your entitlement per category: Hosts, Containers, Custom Metrics and High Resolution Metrics.</p><p>For more information about these categories please refer to <a href=https://docs.splunk.com/Observability/admin/monitor-imm-billing-usage.html target=_blank>Monitor Splunk Infrastructure Monitoring subscription usage</a>.</p><p><a href=#R-image-3e15ca9d1e3c50e1c7855fadb4ad3d79 class=lightbox-link><img src=../en/imt/servicebureau/../images/usage-charts.png alt="Billing and Usage" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e15ca9d1e3c50e1c7855fadb4ad3d79><img src=../en/imt/servicebureau/../images/usage-charts.png alt="Billing and Usage" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=4-examine-usage-in-detail>4. Examine usage in detail</h2><p>The top chart shows you the current subscription levels per category (shown by the red arrows at the top in the screenshot below).</p><p>Also, your current usage of the four categories is displayed (shown in the red lines at the bottom of the chart).</p><p>In this example, you can see that there are 25 Hosts, 0 Containers, 100 Custom Metrics and 0 High Resolution Metrics.</p><p><a href=#R-image-d046a1c85d23c50d9f98860256e1b2c4 class=lightbox-link><img src=../en/imt/servicebureau/../images/usage-detail.png alt="Billing and Usage-top" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d046a1c85d23c50d9f98860256e1b2c4><img src=../en/imt/servicebureau/../images/usage-detail.png alt="Billing and Usage-top" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the bottom chart, you can see the usage per category for the current period (shown in the drop-down box on the top right of the chart).</p><p>The blue line marked <strong>Average Usage</strong> indicates what Observability Cloud will use to calculate your average usage for the current Subscription Usage Period.</p><p><a href=#R-image-1e34a9ff66c5e746e5214d97dfb252f3 class=lightbox-link><img src=../en/imt/servicebureau/../images/usage-trends.png alt="Billing and Usage-Bottom" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e34a9ff66c5e746e5214d97dfb252f3><img src=../en/imt/servicebureau/../images/usage-trends.png alt="Billing and Usage-Bottom" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>As you can see from the screenshot, Observability Cloud does not use High Watermark or P95% for cost calculation but the actual average hourly usage, allowing you to do performance testing or Blue/Green style deployments etc. without the risk of overage charges.</p></div></div><p>To get a feel for the options you can change the metric displayed by selecting the different options from the <strong>Usage Metric</strong> drop-down on the left, or change the <strong>Subscription Usage Period</strong> with the drop-down on the right.</p><p>Please take a minute to explore the different time periods & categories and their views.</p><p>Finally, the pane on the right shows you information about your Subscription.</p><p><a href=#R-image-ac4897ff6e974d1703894abf678169ca class=lightbox-link><img src=../en/imt/servicebureau/../images/subscription.png alt="Billing and Usage-Pane" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ac4897ff6e974d1703894abf678169ca><img src=../en/imt/servicebureau/../images/subscription.png alt="Billing and Usage-Pane" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Service Bureau</h1><article class=default><header class=headline></header><h1 id=teams>Teams</h1><ul><li>Introduction to Teams</li><li>Create a Team and add members to the Team</li></ul><hr><h2 id=1-introduction-to-teams>1. Introduction to Teams</h2><p>To make sure that users see the dashboards and alerts that are relevant to them when using Observability Cloud, most organizations will use Observability Cloud&rsquo;s Teams feature to assign a member to one or more Teams.</p><p>Ideally, this matches work-related roles, for example, members of a Dev-Ops or Product Management group would be assigned to the corresponding Teams in Observability Cloud.</p><p>When a user logs into Observability Cloud, they can choose which Team Dashboard will be their home page and they will typically select the page for their primary role.</p><p>In the example below, the user is a member of the Development, Operations and Product Management Teams, and is currently viewing the Dashboard for the Operations Team.</p><p>This Dashboard has specific Dashboard Groups for Usage, SaaS and APM Business Workflows assigned but any Dashboard Group can be linked to a Teams Dashboard.</p><p>They can use the menu along the top left to quickly navigate between their allocated teams, or they can use the <strong>ALL TEAMS</strong> dropdown on the right to select specific Team Dashboards, as well as quickly access <strong>ALL Dashboards</strong>** using the adjacent link.</p><p><a href=#R-image-e29904ecd8de11146d294882518fb10c class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/teams-homepage.png alt=Teams class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e29904ecd8de11146d294882518fb10c><img src=../en/imt/servicebureau/teams/../../images/teams-homepage.png alt=Teams class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Alerts can be linked to specific Teams so the Team can monitor only the Alerts they are interested in, and in the above example, they currently have 1 active Critical Alert.</p><p>The Description for the Team Dashboard can be customized and can include links to team-specific resources (using Markdown).</p><hr><h2 id=2-creating-a-new-team>2. Creating a new Team</h2><p>To work with Splunk&rsquo;s Team UI click on the hamburger icon top left and select the <strong>Organizations Settings ‚Üí Teams</strong>.</p><p>When the <strong>Team</strong> UI is selected you will be presented with the list of current Teams.</p><p>To add a new <strong>Team</strong> click on the
<span class="btn cstyle blue"><button type=button>
Create New Team</button></span> button. This will present you with the <strong>Create New Team</strong> dialog.</p><p><a href=#R-image-5c7c479e56dbbb15704f00302882ff9d class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/create-new-team.png alt="Add Team" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5c7c479e56dbbb15704f00302882ff9d><img src=../en/imt/servicebureau/teams/../../images/create-new-team.png alt="Add Team" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Create your own team by naming it <code>[YOUR-INITIALS]-Team and</code> add yourself by searching for your name and selecting the <strong>Add</strong> link next to your name. This should result in a dialog similar to the one below:</p><p><a href=#R-image-db33b919252c7af688d8830a19caa4ca class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/add-to-team.png alt="Add Team complete" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-db33b919252c7af688d8830a19caa4ca><img src=../en/imt/servicebureau/teams/../../images/add-to-team.png alt="Add Team complete" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can remove selected users by pressing <strong>Remove</strong> or the small <strong>x</strong>.</p><p>Make sure you have your group created with your initials and with yourself added as a member, then click
<span class="btn cstyle blue"><button type=button>
Done</button></span></p><p>This will bring you back to the <strong>Teams</strong> list that will now show your Team and the ones created by others.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>The Teams(s) you are a member of have a grey <strong>Member</strong> icon in front of it.</p></div></div><p>If no members are assigned to your Team, you should see a blue <strong>Add Members</strong> link instead of the member count, clicking on that link will get you to the <strong>Edit Team</strong> dialog where you can add yourself.</p><p>This is the same dialog you get when pressing the 3 dots <strong>&mldr;</strong> at the end of the line with your Team and selecting <strong>Edit Team</strong></p><p>The <strong>&mldr;</strong> menu gives you the option to Edit, Join, Leave or Delete a Team (leave and join will depend on if you are currently a member).</p><hr><h2 id=3-adding-notification-rules>3. Adding Notification Rules</h2><p>You can set up specific Notification rules per team, by clicking on the <strong>Notification Policy</strong> tab, this will open the notification edit menu.</p><p><a href=#R-image-dcdf7161b5a9b8ef688a7323d2e34c9c class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/notification-policy.png alt="Base notification menu" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dcdf7161b5a9b8ef688a7323d2e34c9c><img src=../en/imt/servicebureau/teams/../../images/notification-policy.png alt="Base notification menu" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>By default, the system offers you the ability to set up a general notification rule for your team.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>The <strong>Email all team members</strong> option means all members of this Team will receive an email with the Alert information, regardless of the alert type.</p></div></div><h3 id=31-adding-recipients>3.1 Adding recipients</h3><p>You can add other recipients, by clicking
<span class="btn cstyle blue"><button type=button>
Add Recipient</button>
</span>. These recipients do not need to be Observability Cloud users.</p><p>However, if you click on the link <strong>Configure separate notification tiers for different severity alerts</strong> you can configure every alert level independently.</p><p><a href=#R-image-b62024a189504b9e16131aaf673ba0e4 class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/single-policy.png alt="Multiple Notifications" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b62024a189504b9e16131aaf673ba0e4><img src=../en/imt/servicebureau/teams/../../images/single-policy.png alt="Multiple Notifications" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Different alert rules for the different alert levels can be configured, as shown in the above image.</p><p>Critical and Major are using <a href=https://www.splunk.com/en_us/observability/on-call.html target=_blank>Splunk's On-Call</a> Incident Management solution. For the Minor alerts, we send it to the Teams Slack channel and for Warning and Info we send an email.</p><h3 id=32-notification-integrations>3.2 Notification Integrations</h3><p>In addition to sending alert notifications via email, you can configure Observability Cloud to send alert notifications to the services shown below.</p><p><a href=#R-image-a9023d47bb433bab3c67dba1b6041ab8 class=lightbox-link><img src=../en/imt/servicebureau/teams/../../images/integrations.png alt="Notifications options" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a9023d47bb433bab3c67dba1b6041ab8><img src=../en/imt/servicebureau/teams/../../images/integrations.png alt="Notifications options" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Take a moment to create some notification rules for your Team.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=controlling-usage>Controlling Usage</h1><ul><li>Discover how you can restrict usage by creating separate Access Tokens and setting limits.</li></ul><h2 id=1-access-tokens>1. Access Tokens</h2><p>If you wish to control the consumption of Hosts, Containers, Custom Metrics and High Resolution Metrics, you can create multiple Access Tokens and allocate them to different parts of your organization.</p><p>In the UI click on the <strong>&#187;</strong> bottom left and select the <strong>Settings ‚Üí Access Tokens</strong> under <strong>General Settings</strong>.</p><p>The <strong>Access Tokens</strong> Interface provides an overview of your allotments in the form of a list of Access Tokens that have been generated. Every Organization will have a <strong>Default</strong> token generated when they are first set up, but there will typically be multiple Tokens configured.</p><p>Each Token is unique and can be assigned limits for the number of Hosts, Containers, Custom Metrics and High Resolution Metrics it can consume.</p><p>The <strong>Usage Status</strong> Column quickly shows if a token is above or below its assigned limits.</p><p><a href=#R-image-8540149a7ee429b10bf8128329f10b5d class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/access-tokens.png alt="New token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8540149a7ee429b10bf8128329f10b5d><img src=../en/imt/servicebureau/tokens/../../images/access-tokens.png alt="New token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-creating-a-new-token>2. Creating a new token</h2><p>Let create a new token by clicking on the
<span class="btn cstyle blue"><button type=button>
New Token</button></span> button. This will provide you with the <strong>Name Your Access Token</strong> dialog.</p><p>Enter the new name of the new Token by using your Initials e.g. RWC-Token and make sure to tick both <strong>Ingest Token</strong> and <strong>API Token</strong> checkboxes!</p><p><a href=#R-image-84c5bf8b9fe742ba01ae409ab378fa5b class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/new-access-token.png alt="Name Your token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-84c5bf8b9fe742ba01ae409ab378fa5b><img src=../en/imt/servicebureau/tokens/../../images/new-access-token.png alt="Name Your token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>After you press
<span class="btn cstyle blue"><button type=button>
OK</button></span> you will be taken back to the <strong>Access Token</strong> UI. Here your new token should be present, among the ones created by others.</p><p><a href=#R-image-3157e2e2e304d691363deb76e88d1cb3 class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/access-token-created.png alt="full tokenlist" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3157e2e2e304d691363deb76e88d1cb3><img src=../en/imt/servicebureau/tokens/../../images/access-token-created.png alt="full tokenlist" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you have made an error in your naming, want to disable/enable a token or set a Token limit, click on the ellipsis (<strong>&mldr;</strong>) menu button behind a token limit to open the manage token menu.</p><p><a href=#R-image-3a612792742e1aa7b6352c6d7c161dac class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/manage-access-token.png alt="Show Menu" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3a612792742e1aa7b6352c6d7c161dac><img src=../en/imt/servicebureau/tokens/../../images/manage-access-token.png alt="Show Menu" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you made a typo you can use the <strong>Rename Token</strong> option to correct the name of your token.</p><h2 id=3-disabling-a-token>3. Disabling a token</h2><p>If you need to make sure a token cannot be used to send Metrics in you can disable a token.</p><p>Click on <strong>Disable</strong> to disable the token, this means the token cannot be used for sending in data to Splunk Observability Cloud.</p><p>The line with your token should have become greyed out to indicate that it has been disabled as you can see in the screenshot below.</p><p><a href=#R-image-6d5d6900bf4a77e1b48a4d59b6ceac62 class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/disable-access-token.png alt="Token disabled" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6d5d6900bf4a77e1b48a4d59b6ceac62><img src=../en/imt/servicebureau/tokens/../../images/disable-access-token.png alt="Token disabled" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Go ahead and click on the ellipsis (<strong>&mldr;</strong>) menu button to Disable and Enable your token.</p><h2 id=4-manage-token-usage-limits>4. Manage token usage limits</h2><p>Now, let&rsquo;s start limiting usage by clicking on Manage Token Limit in the 3 <strong>&mldr;</strong> menu.</p><p>This will show the Manage Token Limit Dialog:</p><p><a href=#R-image-ea4e34d2f45fe6768c290ca26a8ca065 class=lightbox-link><img src=../en/imt/servicebureau/tokens/../../images/manage-token-limit.png alt="Set Limits on token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ea4e34d2f45fe6768c290ca26a8ca065><img src=../en/imt/servicebureau/tokens/../../images/manage-token-limit.png alt="Set Limits on token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In this dialog, you can set the limits per category.</p><p>Please go ahead and specify the limits as follows for each usage metric:</p><table><thead><tr><th>Limit</th><th>Value</th></tr></thead><tbody><tr><td>Host Limit</td><td>5</td></tr><tr><td>Container Limit</td><td>15</td></tr><tr><td>Custom Metric Limit</td><td>20</td></tr><tr><td>High Resolution Metric Limit</td><td>0</td></tr></tbody></table><p>For our lab use your email address, and double check that you have the correct numbers in your dialog box as shown in the table above.</p><p>Token limits are used to trigger an alert that notifies one or more recipients when the usage has been above 90% of the limit for 5 minutes.</p><p>To specify the recipients, click
<span class="btn cstyle blue"><button type=button>
Add Recipient</button>
</span>, then select the recipient or notification method you want to use (specifying recipients is optional but highly recommended).</p><p>The severity of token alerts is always Critical.</p><p>Click on
<span class="btn cstyle blue"><button type=button>
Update</button></span> to save your Access Tokens limits and The Alert Settings.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: Going above token limit</div><div class=box-content><p>When a token is at or above its limit in a usage category, new metrics for that usage category will not be stored and processed by Observability Cloud. This will make sure there will be no unexpected cost due to a team sending in data without restriction.</p></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note: Advanced alerting</div><div class=box-content><p>If you wish to get alerts before you hit 90%, you can create additional detectors using whatever values you want. These detectors could target the Teams consuming the specific Access Tokens so they can take action before the admins need to get involved.</p></div></div><p>In your company you would distribute these new Access Tokens to various teams, controlling how much information/data they can send to Observability Cloud.</p><p>This will allow you to fine-tune the way you consume your Observability Cloud allotment and prevent overages from happening.</p><p><strong>Congratulations!</strong> You have now completed the Service Bureau module.</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-apm>Splunk APM</h1><p>Splunk APM is a NoSample‚Ñ¢ Full-fidelity application performance monitoring and troubleshooting solution for cloud-native, microservices-based applications.</p><p>By collecting all traces, instead of a sampled subset, no anomaly goes undetected. Whether a user experiences an error or longer-than-usual latency, you‚Äôll be able to know and act on it within seconds. Furthermore, not all bad behavior results in errors ‚Äî as your developers create new applications they need to know whether their canary releases provide the expected results. Only by collecting all trace data will you ensure that your cloud-native applications behave the way they are supposed to.</p><p>Infrastructure and application performance are interdependent. To see the full picture, Splunk APM provides a seamless correlation between cloud infrastructure and the microservices running on top of it. If your application acts out because of memory leakage, a noisy neighbor container or any other infrastructure-related issue, Splunk will let you know. To complete the picture, in-context access to Splunk logs and events enables deeper troubleshooting and root-cause analysis.</p><p><a href=#R-image-8b172ceaa98858cdb04d1d99c722ad9d class=lightbox-link><img src=../en/apm/images/arch-overview.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b172ceaa98858cdb04d1d99c722ad9d><img src=../en/apm/images/arch-overview.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk APM</h1><article class=default><header class=headline></header><h1 id=1-the-online-boutique>1. The Online Boutique</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
15 minutes</button></span><ul><li><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong></span></span> Deploy the Online Boutique application in Kubernetes</li><li>Verify the application is running</li><li>Generate some artificial traffic using Locust</li><li>See APM metrics in the UI</li></ul><hr><div class=expand><input type=checkbox id=R-expand-7ce4f6a2a24557e6ae138cf22b8ddd27 aria-controls=R-expandcontent-7ce4f6a2a24557e6ae138cf22b8ddd27>
<label class=expand-label for=R-expand-7ce4f6a2a24557e6ae138cf22b8ddd27><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> - Deploy the Online Boutique</span></span></label><div id=R-expandcontent-7ce4f6a2a24557e6ae138cf22b8ddd27 class=expand-content><h2 id=1-check-your-ec2-server>1. Check your EC2 server</h2><p>This workshop module assumes you are completing this after you have run the IM workshop, and still have access to your EC2 instance.</p><p>If this is the case, continue with <a href=#2-deploy-online-boutique><strong>Deploy Online Boutique</strong></a>, otherwise, if you have received a fresh instance, please run the first two (2) sections of <a href=../en/imt/gdi/index.html><strong>Deploy the OTel Collector</strong></a> to get the system ready for the APM workshop, then continue with the next section.</p><h2 id=2-deploy-online-boutique>2. Deploy Online Boutique</h2><p>To deploy the Online Boutique application into K3s apply the deployment:</p><div class=tab-panel data-tab-group=d7a6b4112c36683f42993224429d40dd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-online-boutique class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("d7a6b4112c36683f42993224429d40dd","deploy-online-boutique")'>
<span class=tab-nav-text>Deploy Online Boutique</span></button>
<button data-tab-item=deployment-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d7a6b4112c36683f42993224429d40dd","deployment-output")'>
<span class=tab-nav-text>Deployment Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-online-boutique class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/apm
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div data-tab-item=deployment-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>APM Only Deployment
</span></span><span class=line><span class=cl>deployment.apps/recommendationservice created
</span></span><span class=line><span class=cl>service/recommendationservice created
</span></span><span class=line><span class=cl>deployment.apps/productcatalogservice created
</span></span><span class=line><span class=cl>service/productcatalogservice created
</span></span><span class=line><span class=cl>deployment.apps/cartservice created
</span></span><span class=line><span class=cl>service/cartservice created
</span></span><span class=line><span class=cl>deployment.apps/adservice created
</span></span><span class=line><span class=cl>service/adservice created
</span></span><span class=line><span class=cl>deployment.apps/paymentservice created
</span></span><span class=line><span class=cl>service/paymentservice created
</span></span><span class=line><span class=cl>deployment.apps/loadgenerator created
</span></span><span class=line><span class=cl>service/loadgenerator created
</span></span><span class=line><span class=cl>deployment.apps/shippingservice created
</span></span><span class=line><span class=cl>service/shippingservice created
</span></span><span class=line><span class=cl>deployment.apps/currencyservice created
</span></span><span class=line><span class=cl>service/currencyservice created
</span></span><span class=line><span class=cl>deployment.apps/redis-cart created
</span></span><span class=line><span class=cl>service/redis-cart created
</span></span><span class=line><span class=cl>deployment.apps/checkoutservice created
</span></span><span class=line><span class=cl>service/checkoutservice created
</span></span><span class=line><span class=cl>deployment.apps/frontend created
</span></span><span class=line><span class=cl>service/frontend created
</span></span><span class=line><span class=cl>service/frontend-external created
</span></span><span class=line><span class=cl>deployment.apps/emailservice created
</span></span><span class=line><span class=cl>service/emailservice created
</span></span><span class=line><span class=cl>deployment.apps/rum-loadgen-deployment created</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> In case of a message about a VARIABLE being unset</div><div class=box-content><p>Delete the deployment running <code>kubectl delete -f deployment.yaml</code>.</p><p>Then, export the variable as described in the guide/message, followed by re-running the deployment script above.</p></div></div><p>To ensure the Online Boutique application is running:</p><div class=tab-panel data-tab-group=2891232d8c48195cb1b8a0ea97c73eb4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("2891232d8c48195cb1b8a0ea97c73eb4","get-pods")'>
<span class=tab-nav-text>Get Pods</span></button>
<button data-tab-item=get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2891232d8c48195cb1b8a0ea97c73eb4","get-pods-output")'>
<span class=tab-nav-text>Get Pods Output</span></button></div><div class=tab-content-container><div data-tab-item=get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                       READY  STATUS  RESTARTS      AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-849cf595bf-l7mnq 1/1   Running   0           31m
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-pxrgp                           2/2   Running   0           31m
</span></span><span class=line><span class=cl>productcatalogservice-8464cd56d-n8f89                       1/1   Running   0            1m
</span></span><span class=line><span class=cl>redis-cart-bcf44df97-djv6z                                  1/1   Running   0            1m
</span></span><span class=line><span class=cl>checkoutservice-8558fd7b95-b9pn8                            1/1   Running   0            1m
</span></span><span class=line><span class=cl>shippingservice-7cc4bdd6f4-xsvnx                            1/1   Running   0            1m
</span></span><span class=line><span class=cl>recommendationservice-647d57fd44-l7tkq                      1/1   Running   0            1m
</span></span><span class=line><span class=cl>frontend-66c5d589d-55vzb                                    1/1   Running   0            1m
</span></span><span class=line><span class=cl>emailservice-6ff5bbd67d-pdcm2                               1/1   Running   0            1m
</span></span><span class=line><span class=cl>paymentservice-6866558995-8xmf2                             1/1   Running   0            1m
</span></span><span class=line><span class=cl>currencyservice-8668d75d6f-mr68h                            1/1   Running   0            1m
</span></span><span class=line><span class=cl>rum-loadgen-deployment-58ccf7bd8f-cr4pr                     1/1   Running   0            1m
</span></span><span class=line><span class=cl>rum-loadgen-deployment-58ccf7bd8f-qjr4b                     1/1   Running   0            1m
</span></span><span class=line><span class=cl>rum-loadgen-deployment-58ccf7bd8f-fvb4x                     1/1   Running   0            1m
</span></span><span class=line><span class=cl>cartservice-7b58c88c45-xvxhq                                1/1   Running   0            1m
</span></span><span class=line><span class=cl>loadgenerator-6bdc7b4857-9kxjd                              1/1   Running   2 (49s ago)  1m
</span></span><span class=line><span class=cl>adservice-7b68d5b969-89ft2                                  1/1   Running   0            1m</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>Usually it should only take around 1min 30secs for the pods to transition into a Running state.</p></div></div></div></div><h2 id=validate-online-boutique-is-deployed>Validate Online Boutique is deployed</h2><p>In the Splunk UI click on <strong>Infrastructure</strong> this will bring you to the Infrastructure Overview dashboard, then click on <strong>Kubernetes</strong>.</p><p>Use the <strong>Cluster</strong> dropdown to select the cluster name, you will see the new pods started and containers deployed. When you click on your Cluster in the Splunk UI you should have a view that looks like below:</p><p><a href=#R-image-1b592459f504feffcb8b80599a26d05d class=lightbox-link><img src=../en/apm/online-boutique/../images/online-boutique-k8s.png alt="Back to cluster" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b592459f504feffcb8b80599a26d05d><img src=../en/apm/online-boutique/../images/online-boutique-k8s.png alt="Back to cluster" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you select the <strong>WORKLOADS</strong> tab again you should now see that there are some Deployments and ReplicaSets:</p><p><a href=#R-image-4dadbdd98d0273ea6f5a383e74ebaab2 class=lightbox-link><img src=../en/apm/online-boutique/../images/online-boutique-workload.png alt="Online Boutique loaded" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4dadbdd98d0273ea6f5a383e74ebaab2><img src=../en/apm/online-boutique/../images/online-boutique-workload.png alt="Online Boutique loaded" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=visit-the-online-boutique>Visit the Online Boutique</h2><div class=expand><input type=checkbox id=R-expand-3a9b6a3419bd2fd091b8293264e1ac27 aria-controls=R-expandcontent-3a9b6a3419bd2fd091b8293264e1ac27>
<label class=expand-label for=R-expand-3a9b6a3419bd2fd091b8293264e1ac27><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> - Visit the Online Boutique you just deployed</span></span></label><div id=R-expandcontent-3a9b6a3419bd2fd091b8293264e1ac27 class=expand-content><div class="box notices cstyle blue"><div class=box-label></div><div class=box-content><p>The Online Boutique is viewable on port 81 of the EC2 instance&rsquo;s IP address. The IP address is the one you used to SSH into the instance at the beginning of the workshop.</p><p>Open your web browser and go to <code>http://&lt;ec2-ip-address>:81/</code> where you will then be able to see the Online Boutique running.</p></div></div></div></div><p>Your Workshop instructor will provide you with a URL to access the Online Boutique. Enter this URL into your browser and you will see the Online Boutique homepage.</p><p><a href=#R-image-62ba69d4ca8f41474d3402439ec874dc class=lightbox-link><img src=../en/apm/online-boutique/../images/online-boutique.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62ba69d4ca8f41474d3402439ec874dc><img src=../en/apm/online-boutique/../images/online-boutique.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of 1. The Online Boutique</h1><article class=default><header class=headline></header><h1 id=11-validate-apm-data>1.1 Validate APM data</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
5 minutes</button></span><h2 id=1-red-metrics>1. RED Metrics</h2><p>Go to <strong>Dashboards ‚Üí All Dashboards ‚Üí APM Services ‚Üí Service</strong>. Here we can view the RED metrics (Rate, Error & Duration) for the Online Boutique application.</p><p>For this, we need to know the name of your application environment. In this workshop all the environments use: <code>&lt;instance>-workshop</code>.</p><p>To find the <code>instance</code>, on the AWS/EC2 instance run the following command:</p><div class=tab-panel data-tab-group=a4a799666757121e7f723b48c70b8637><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=echo-instance class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a4a799666757121e7f723b48c70b8637","echo-instance")'>
<span class=tab-nav-text>Echo Instance</span></button>
<button data-tab-item=output-example class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a4a799666757121e7f723b48c70b8637","output-example")'>
<span class=tab-nav-text>Output Example</span></button></div><div class=tab-content-container><div data-tab-item=echo-instance class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span>-workshop</span></span></code></pre></div></div></div><div data-tab-item=output-example class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>bdzx-workshop</span></span></code></pre></div></div></div></div></div><p>Select the environment you found in the previous step then select the <code>frontend</code> service and set the time to Past 15 minutes.</p><p><a href=#R-image-645c6f13ac25e991c6bb85421e7bea12 class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-service-dashboard.png alt="APM Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-645c6f13ac25e991c6bb85421e7bea12><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-service-dashboard.png alt="APM Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>With this automatically generated dashboard, you can keep an eye out for the health of your service(s) using RED (Rate, Error & Duration) metrics. It provides various performance-related charts as well as correlated information on the underlying host and Kubernetes pods (if applicable).</p><p>Take some time to explore the various charts in this dashboard</p><hr><h2 id=2-apm-metrics>2. APM Metrics</h2><p>In the left-hand menu card click on <strong>APM</strong> this will bring you to the APM Overview dashboard:</p><p><a href=#R-image-f911a5bb54b42704026a29d93fbcda2b class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-apm.png alt="select APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f911a5bb54b42704026a29d93fbcda2b><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-apm.png alt="select APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Select <strong>Explore</strong> on the right-hand side select the environment you found before and set the time to 15 minutes. This will show you the automatically generated Dependency/Service Map for the Online Boutique application.</p><p>It should look similar to the screenshot below:</p><p><a href=#R-image-33675b7a171677cb609eb85194df7bb5 class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-map.png alt="Online Boutique in APM" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-33675b7a171677cb609eb85194df7bb5><img src=../en/apm/online-boutique/validate-apm/../../images/online-boutique-map.png alt="Online Boutique in APM" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The legend at the bottom of the page explains the different visualizations in the Dependency/Service Map.</p><p><a href=#R-image-355485db06e7876a06667e5bab0adcbe class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/apm-legend.png alt="APM Legend" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-355485db06e7876a06667e5bab0adcbe><img src=../en/apm/online-boutique/validate-apm/../../images/apm-legend.png alt="APM Legend" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Service requests, error rate and root error rate.</li><li>Request rate, latency and error rate</li></ul><p>Also in this view, you can see the overall Error and Latency rates over time charts.</p><h2 id=3-opentelemetry-dashboard>3. OpenTelemetry Dashboard</h2><p>Once the Open Telemetery Collector is deployed the platform will automatically provide a built in dashboard display OpenTelemetry Collector metrics.</p><p>From the top left hamburger menu <strong>Dashboards ‚Üí OpenTelemetry Collector</strong>, scroll all the way to the bottom of the page and validate metrics and spans are being sent:</p><p><a href=#R-image-bf857c33d7143af9c24443b372fd9727 class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/otel-dashboard.png alt="OpenTelemetry Collector dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf857c33d7143af9c24443b372fd9727><img src=../en/apm/online-boutique/validate-apm/../../images/otel-dashboard.png alt="OpenTelemetry Collector dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-opentelemetry-zpages>4. OpenTelemetry zpages</h2><p>To debug the traces being sent you can use the zpages extension. <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/experimental/trace/zpages.md#tracez target=_blank>zpages</a> are part of the OpenTelemetry collector and provide live data for troubleshooting and statistics.</p><div class=expand><input type=checkbox id=R-expand-6e87078c6e85adf6bf211555a2934aa0 aria-controls=R-expandcontent-6e87078c6e85adf6bf211555a2934aa0>
<label class=expand-label for=R-expand-6e87078c6e85adf6bf211555a2934aa0><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> - Access zPages on your EC2 instance</span></span></label><div id=R-expandcontent-6e87078c6e85adf6bf211555a2934aa0 class=expand-content><div class="box notices cstyle blue"><div class=box-label></div><div class=box-content><p>zPages is available on port <code>55679</code> of the EC2 instance&rsquo;s IP address. Open a new tab in your web browser and enter in <code>http://{==EC2-IP==}:55679/debug/tracez</code>, you will then be able to see the zpages output.</p><p>Alternatively, from your shell prompt you can run a text based browser:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>lynx http://localhost:55679/debug/tracez</span></span></code></pre></div></div></div></div></div><p>Your Workshop instructor will provide you with a URL to access zPages. Enter this URL into your browser and you will see the zPages output.</p><p><a href=#R-image-b0db2592cd7a660a1858ad2f4a69c5bf class=lightbox-link><img src=../en/apm/online-boutique/validate-apm/../../images/zpages.png alt=zpages class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0db2592cd7a660a1858ad2f4a69c5bf><img src=../en/apm/online-boutique/validate-apm/../../images/zpages.png alt=zpages class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=2-using-splunk-apm>2. Using Splunk APM</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
15 minutes</button></span><ul><li>APM Overview - RED metrics</li><li>Using the Service Map</li><li>Introduction to Tag Spotlight</li><li>Example Traces</li><li>Contextual Links to Infra</li></ul><h2 id=1-traces-and-spans-explained>1. Traces and Spans explained</h2><p>A trace is a collection of spans that share the same trace ID, representing a unique transaction handled by your application and its constituent services.</p><p><a href=#R-image-adbd307e1d36b30906f1ff0a8863b0d5 class=lightbox-link><img src=../en/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-adbd307e1d36b30906f1ff0a8863b0d5><img src=../en/apm/using-splunk-apm/../images/trace-spans.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Each span has a name, representing the operation captured by this span, and a service name, representing within which service the operation took place.</p><p>Additionally, spans may reference another span as their parent, defining the relationships between the operations captured in the trace that were performed to process that transaction.</p><p>Each span contains a lot of information about the method, operation, or block of code that it captures, including:</p><ul><li>the operation name</li><li>the start time of the operation with microsecond precision</li><li>how long the operation took to execute, also with microsecond precision</li><li>the logical name of the service on which the operation took place</li><li>the IP address of the service instance on which the operation took place</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of 2. Using Splunk APM</h1><article class=default><header class=headline></header><h1 id=21-service-map>2.1 Service Map</h1><h2 id=service-map>Service Map</h2><p>Click on <strong>paymentservice</strong> in the service map and select <strong>version</strong> from the <code>breakdown</code> drop down filter underneath <strong>paymentservice</strong>. This will filter our service map by the custom span tag <strong>version</strong>.</p><p>You will now see the service map has been updated like the below screenshot to show the different versions of the <strong>paymentservice</strong>.</p><p>Splunk Observability shows that not only is paymentservice experiencing errors (you can see request rate vs error rate) but that this service is the root cause.</p><p>This happens automatically with our AI-directed triage capabilities once distributed tracing is enabled in your services. You don‚Äôt have to set a threshold or anything for it to populate just like this.</p><p>This is one example of how customers can detect issues faster and know where to look for errors and hence helps reduce the MTTD and MTTR.</p><p><a href=#R-image-4723801ebf7b7c04a989bbda54b87cec class=lightbox-link><img src=../en/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4723801ebf7b7c04a989bbda54b87cec><img src=../en/apm/using-splunk-apm/service_map/../../images/paymentservice.png alt="Payment Service" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=22-tag-spotlight>2.2 Tag Spotlight</h1><h2 id=tag-spotlight>Tag Spotlight</h2><p>On the right hand side of the screen scroll down on <strong>Tag Spotlight</strong>, ensure <strong>Top Across All Indexed Tags</strong> is selected in the dropdown click the full screen button as indicated in the screenshot below.</p><p><a href=#R-image-76772c8146c7ae5344fd5ffd4def1518 class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76772c8146c7ae5344fd5ffd4def1518><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight.png alt="Tag Spotlight" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The Tag Spotlight Page will be displayed. From this page you can view the top tags in your application and their corresponding error rates and request rates.</p><p>Note that for the <strong>version</strong> span tag it appears that version <code>350.10</code> has a 100% error rate and for our <strong>tenant.level</strong> span tag it shows that all three tenants (Gold, Silver & Bronze) have errors present.</p><p><a href=#R-image-4f2a7d6830c5c62efbee94977490245c class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f2a7d6830c5c62efbee94977490245c><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/tag-spotlight-dashboard.png alt="Tag Spotlight Dashboard" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The Tag Spotlight page is interactive and allows you to add a tag as a filter by simply clicking on your desired tag. Click on <strong>gold</strong> under <strong>tenant.level</strong> to add it as a filter. Once this is done the page will now only display data with <strong>gold</strong> as it‚Äôs <strong>tenant.level</strong>.</p><p><a href=#R-image-c92116732fd7d2ef9dd1255b71e82fb6 class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c92116732fd7d2ef9dd1255b71e82fb6><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/gold-tenant.png alt="Gold Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Tag Spotlight is very useful for analysing your data and spotting trends. We can see that for the Gold Tenant that out of the total number of requests, 55 of them are in error (this number will vary in your workshop).</p><p>If we correlate this to the version tag, we can see that version <code>350.10</code> served 55 requests and version <code>350.9</code> served 17 requests. This means that all of the requests that went through version <code>350.10</code> ended up in an error state.</p><p>In order to test this theory further that all of the requests from <strong>paymentservice</strong> version <code>350.10</code> result in an error, we can change our filter to another tenant by using the tag selector. Change your filter from <strong>gold</strong> tenant to <strong>silver</strong> tenant.</p><p><a href=#R-image-fbd8de35c434a1fecbc858eaa2f38b19 class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fbd8de35c434a1fecbc858eaa2f38b19><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tag-filter.png alt="Silver Tag Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now we can perform a similar analysis by looking at the number of requests in error for the <strong>silver</strong> tenant and correlating that with the version number. Note the amount of errors for the <strong>silver</strong> tenant match the amount of requests for version <code>350.10</code>.</p><p><a href=#R-image-3124e266e4c9cd73d4808abdf1517a06 class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3124e266e4c9cd73d4808abdf1517a06><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/silver-tenant.png alt="Silver Tenant" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Tag Spotlight not only allows you to look at request and error rates but also at the latency per service. In order to do this just select the latency button and remove your Silver Tenant Tag so that you can see the latency for all of the Payment Service.</p><p><a href=#R-image-bc68f3a1d85a76709d538253eb9c19a1 class=lightbox-link><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bc68f3a1d85a76709d538253eb9c19a1><img src=../en/apm/using-splunk-apm/tag_spotlight/../../images/latency.png alt=Latency class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Go back to your service map by pressing the <strong>X</strong> button on the far right underneath <strong>Clear All</strong>.</p><p>Click anywhere on the pink line in the <strong>Services by Error Rate</strong> graph in the top right hand corner. Once selected you should see a list of example traces. Click on one of the example traces with an initiating operation of <strong>frontend: POST /cart/checkout</strong>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=23-example-trace>2.3 Example trace</h1><h2 id=example-trace>Example Trace</h2><p><a href=#R-image-661502e7242017bbab4b111cbc1b6a44 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-661502e7242017bbab4b111cbc1b6a44><img src=../en/apm/using-splunk-apm/example_trace/../../images/example-trace.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now see the entire trace along with the spans for the example trace that was selected. Spans which have errors are indicated by a red exclamation mark beside it. If you have a number such as <strong>x6</strong> in a grey box, click it to expand the compacted <code>paymentservice</code> spans.</p><p><a href=#R-image-8e528da3c70837f960a9cf78b3c213b3 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8e528da3c70837f960a9cf78b3c213b3><img src=../en/apm/using-splunk-apm/example_trace/../../images/trace-span.png alt="Example Trace" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now click one of the <code>paymentservice</code> spans with the red exclamation mark to expand it and see the associated metadata and some error details. Note that we are able to see that this error is caused by a 401 error and other useful information such as ‚Äòtenant‚Äô and ‚Äòversion‚Äô is also displayed.</p><p><a href=#R-image-bed2c9398d96457c1f540d4bde2ae779 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bed2c9398d96457c1f540d4bde2ae779><img src=../en/apm/using-splunk-apm/example_trace/../../images/trace-metadata.png alt="Traces and Spans" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>So we now know that the error is caused by an <strong>Invalid Request</strong> but we don&rsquo;t know what exact request. At the bottom of the page you should see a contextual link to Logs, clink on this link to view the logs associated with this span.</p><p><a href=#R-image-1f6e26aa3058f6fbf4113e685fdb8e68 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1f6e26aa3058f6fbf4113e685fdb8e68><img src=../en/apm/using-splunk-apm/example_trace/../../images/logs_link.png alt="Logs Link" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now be looking at a <strong>Log Observer</strong> dashboard simialar to the image below.</p><p><a href=#R-image-634b7dfb1bb79ee684d03664f63f5959 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-634b7dfb1bb79ee684d03664f63f5959><img src=../en/apm/using-splunk-apm/example_trace/../../images/log_observer.png alt="Log Observer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can use the filter to display only the error logs. Click on <code>ERROR</code> in the top right hand corner, then <code>Add to filter</code></p><p><a href=#R-image-7fc3117d69fa84089a43bb47ace0bee3 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7fc3117d69fa84089a43bb47ace0bee3><img src=../en/apm/using-splunk-apm/example_trace/../../images/error_filter.png alt="Error Filter" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now have a shorter list of log entries which have a <code>severity</code> of <code>ERROR</code></p><p><a href=#R-image-23d29453c7d5809f9a988c302e1b301c class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-23d29453c7d5809f9a988c302e1b301c><img src=../en/apm/using-splunk-apm/example_trace/../../images/filtered_results.png alt="Filtered Results" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Select any of the entries to view the details. We can now see how the error was caused by the use of an <strong>Invalid API Token</strong> that our developers have accidentally pushed to production!</p><p><a href=#R-image-67df053c7699d52fde87d48b8893b655 class=lightbox-link><img src=../en/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-67df053c7699d52fde87d48b8893b655><img src=../en/apm/using-splunk-apm/example_trace/../../images/error_details.png alt="Error Details" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations</strong>, you have now completed the APM Workshop.</p><footer class=footline></footer></article></section></section><article class=home><header class=headline></header><h1 id=ninja-workshops>Ninja Workshops</h1><div class="children children-h5 children-sort-"><h5><a href=../en/other/pet-clinic/index.html>PetClinic Java Workshop</a></h5><p>A workshop using Zero Configuration Auto-Instrumentation for Java.</p><h5><a href=../en/other/gdi/index.html>Getting Data In (GDI) with OTel and UF</a></h5><p>Learn how to get data into Splunk Observability Cloud with OpenTelemetry and the Splunk Universal Forwarder.</p><h5><a href=../en/other/hpa/index.html>Monitoring Horizontal Pod Autoscaling in Kubernetes</a></h5><p>This workshop will equip you with the basic understanding of monitoring Kubernetes using the Splunk OpenTelemetry Collector</p><h5><a href=../en/other/lambda-kinesis/index.html>Build a Distributed Trace in Lambda and Kinesis</a></h5><p>This workshop will equip you with how a distributed trace is constructed for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis</p><h5><a href=../en/other/dev-mttr-custom-tags/index.html>Improving MTTR with Custom Tags</a></h5><p>This workshop will equip you with...</p><h5><a href=../en/other/rum/index.html>Splunk RUM</a></h5><p>End-to-end visibility helps you pinpoint customer-impacting issues from web browsers and native mobile apps to your backend services.</p><h5><a href=../en/other/synthetics-scripting/index.html>Splunk Synthetic Scripting</a></h5><p>Proactively find and fix performance issues across user flows, business transactions and APIs to deliver better digital experiences.</p><h5><a href=../en/other/oncall/index.html>Splunk OnCall</a></h5><p>Make expensive service outages a thing of the past. Remediate issues faster, reduce on-call burnout and keep your services up and running.</p><h5><a href=../en/other/opentelemetry-collector/index.html>Making Your Observability Cloud Native With OpenTelemetry</a></h5><p>Learn the concepts of the OpenTelemetry Collector and how to use it to send data to Splunk Observability Cloud.</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Ninja Workshops</h1><article class=default><header class=headline></header><h1 id=petclinic-java-workshop>PetClinic Java Workshop</h1><p>The goal is to walk through the basic steps to configure the following components of the Splunk Observability platform:</p><ul><li>Splunk Infrastructure Monitoring (IM)</li><li>Splunk Zero Configuration Auto Instrumentation for Java (APM)<ul><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Real User Monitoring (RUM)</li><li>RUM to APM Correlation</li><li>Splunk Log Observer</li></ul><p>We will also show the steps about how to clone (download) a sample Java application (Spring PetClinic), as well as how to compile, package and run the application.</p><p>Once the application is up and running, we will instantly start seeing metrics and traces via the Zero Configuration Auto Instrumentation for Java that will be used by the Splunk APM product.</p><p>After that, we will instrument PetClinic&rsquo;s end user interface (HTML pages rendered by the application) with the Splunk OpenTelemetry Javascript Libraries (RUM) that will generate RUM traces around all the individual clicks and page loads executed by an end user.</p><p>Lastly, we will configure the Spring PetClinic application to write application logs to the filesystem and also configure the Splunk OpenTelemetry Collector to read (tail) the logs and send them to Splunk Cloud.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Prerequisites</div><div class=box-content><p>A Splunk-run workshop where a host/instance is provided <strong>OR</strong> a self-led workshop on your own host / <a href=https://github.com/splunk/observability-workshop/tree/main/multipass target=_blank>multipass instance</a></p><p>For your own system, you will need the following installed and enabled:</p><ol><li>JDK 17 installed</li><li>Maven</li><li>Port <code>8083</code> open inbound/outbound</li></ol></div></div><p><a href=#R-image-b600b7650d0dcf19f94ca77b906498e7 class=lightbox-link><img src=../en/other/pet-clinic/images/petclinic-exercise.png alt="PetClinic Exercise" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b600b7650d0dcf19f94ca77b906498e7><img src=../en/other/pet-clinic/images/petclinic-exercise.png alt="PetClinic Exercise" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of PetClinic Java Workshop</h1><article class=default><header class=headline></header><h1 id=installing-the-opentelemetry-collector>Installing the OpenTelemetry Collector</h1><h2 id=1-introduction>1. Introduction</h2><p>The OpenTelemetry Collector is the core component of instrumenting infrastructure and applications. Its role is to collect and send:</p><ul><li>Infrastructure metrics (disk, cpu, memory, etc)</li><li>Application Performance Monitoring (APM) traces</li><li>Profiling data</li><li>Host and application logs</li></ul><p>Splunk Observability Cloud offers a wizard to walk you through the setup of the Collector on both your infrastructure and applications.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Delete any existing OpenTelemetry Collectors</div><div class=box-content><p>If you have completed the Splunk IM workshop, please ensure you have deleted the collector running in Kubernetes before continuing. This can be done by running the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></div><h2 id=2-confirm-environment-variables>2. Confirm environment variables</h2><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal run the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>env</span></span></code></pre></div><p>In the output check the following environment variables are present and have values set:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ACCESS_TOKEN
</span></span><span class=line><span class=cl>REALM
</span></span><span class=line><span class=cl>RUM_TOKEN</span></span></code></pre></div><p>For this workshop, <strong>all</strong> of the above are required. If any are missing, please contact your instructor.</p><h2 id=3-install-the-opentelemetry-collector>3. Install the OpenTelemetry Collector</h2><p>We can then go ahead and install the Collector. Some additional parameters are passed to the install script, they are:</p><ul><li><code>--with-instrumentation</code> - This will install the agent from the Splunk distribution of OpenTelemetry Java, which is then loaded automatically when the PetClinic Java application starts up. No configuration is required!</li><li><code>--deployment-environment</code> - Sets the resource attribute <code>deployment.environment</code> to the value passed. This is used to filter views in the UI.</li><li><code>--enable-profiler</code> - Enables the profiler for the Java application. This will generate CPU profiles for the application.</li><li><code>--enable-profiler-memory</code> - Enables the profiler for the Java application. This will generate memory profiles for the application.</li><li><code>--enable-metrics</code> - Enables the exporting of Micrometer metrics</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>sudo sh /tmp/splunk-otel-collector.sh --realm <span class=nv>$REALM</span> -- <span class=nv>$ACCESS_TOKEN</span> --mode agent --without-fluentd --with-instrumentation --deployment-environment <span class=nv>$INSTANCE</span>-petclinic --enable-profiler --enable-profiler-memory --enable-metrics</span></span></code></pre></div><p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> AWS/EC2 instances</div><div class=box-content><p>If you are attempting this workshop on an AWS/EC2 instance you will have to patch the collector to expose the hostname of the instance:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sed -i <span class=s1>&#39;s/gcp, ecs, ec2, azure, system/system, gcp, ecs, ec2, azure/g&#39;</span> /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Once the <code>agent_config.yaml</code> has been patched, you will need to restart the collector:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div></div></div>Once the installation is completed, you can navigate to the <strong>Hosts with agent installed</strong> dashboard to see the data from your host, <strong>Dashboards ‚Üí Hosts with agent installed</strong>.</p><p>Use the dashboard filter and select <code>host.name</code> and type or select the hostname of your virtual machine. Once you see data flowing for your host, we are then ready to get started with the APM component.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=zero-configuration-auto-instrumentation-for-java>Zero Configuration Auto Instrumentation for Java</h1><h2 id=1-spring-petclinic-application>1. Spring PetClinic Application</h2><p>The first thing we need to set up APM is&mldr; well, an application. For this exercise, we will use the Spring PetClinic application. This is a very popular sample Java application built with Spring framework (Springboot).</p><p>First, clone the PetClinic GitHub repository, and then we will compile, build, package and test the application:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/spring-projects/spring-petclinic</span></span></code></pre></div><p>Change into the <code>spring-petclinic</code> directory (and checkout a specific commit):</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> spring-petclinic <span class=o>&amp;&amp;</span> git checkout 276880e</span></span></code></pre></div><p>Start a MySQL database for PetClinic to use:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d -e <span class=nv>MYSQL_USER</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_PASSWORD</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span>root -e <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>petclinic -p 3306:3306 docker.io/mysql:5.7.8</span></span></code></pre></div><p>Next, we will start a Docker container running Locust that will generate some simple traffic to the PetClinic application. Locust is a simple load-testing tool that can be used to generate traffic to a web application.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --network<span class=o>=</span><span class=s2>&#34;host&#34;</span> -d -p 8090:8090 -v /home/ubuntu/workshop/petclinic:/mnt/locust docker.io/locustio/locust -f /mnt/locust/locustfile.py --headless -u <span class=m>1</span> -r <span class=m>1</span> -H http://127.0.0.1:8083</span></span></code></pre></div><p>Next, run the <code>maven</code> command to compile/build/package PetClinic:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>This will take a few minutes the first time you run, <code>maven</code> will download a lot of dependencies before it compiles the application. Future executions will be a lot quicker.</p></div></div><p>Once the compilation is complete, you can run the application with the following command. Notice that we are passing the <code>mysql</code> profile to the application, this will tell the application to use the MySQL database we started earlier. We are also setting the <code>otel.service.name</code> to a logical service name that will also be used in the UI for filtering:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>You can validate if the application is running by visiting <code>http://&lt;VM_IP_ADDRESS>:8083</code>.</p><h2 id=2-alwayson-profiling-and-metrics>2. AlwaysOn Profiling and Metrics</h2><p>When we installed the collector we configured it to enable AlwaysOn Profiling and Metrics. This means that the collector will automatically generate CPU and Memory profiles for the application and send them to Splunk Observability Cloud.</p><p>When you start the PetClinic application you will see the collector automatically detect the application and instrument it for traces and profiling.</p><div class=tab-panel data-tab-group=14ae0d7eaa64d0a5a0a04e396a2a14c8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("14ae0d7eaa64d0a5a0a04e396a2a14c8","example-output")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/lib/splunk-instrumentation/splunk-otel-javaagent.jar -Dsplunk.profiler.enabled=true -Dsplunk.profiler.memory.enabled=true
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:04:661 +0100] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: splunk-1.25.0-otel-1.27.0
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:05:294 +0100] [main] INFO com.splunk.javaagent.shaded.io.micrometer.core.instrument.push.PushMeterRegistry - publishing metrics for SignalFxMeterRegistry every 30s
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:043 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:044 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - Profiler configuration:
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:047 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                  splunk.profiler.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:048 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                splunk.profiler.directory : /tmp
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:049 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -       splunk.profiler.recording.duration : 20s
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:050 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -               splunk.profiler.keep-files : false
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:051 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -            splunk.profiler.logs-endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:053 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -              otel.exporter.otlp.endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:054 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -           splunk.profiler.memory.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:055 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -             splunk.profiler.tlab.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:056 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -        splunk.profiler.memory.event.rate : 150/s
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:057 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.call.stack.interval : PT10S
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:058 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -  splunk.profiler.include.internal.stacks : false
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:059 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.tracing.stacks.only : false
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:059 +0100] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2023-06-26 13:32:07:060 +0100] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.</span></span></code></pre></div></div></div></div></div><h2 id=3-review-profiling-data-collection>3. Review Profiling Data Collection</h2><p>You can now visit the Splunk APM UI and examine the application components, traces, profiling, DB Query performance and metrics. From the left-hand menu <strong>APM</strong> ‚Üí Explore**, click the environment dropdown and select your environment (which is prefixed with the hostname of your instance).</p><p><a href=#R-image-ea899e15e651c9473f8e690907b16b4e class=lightbox-link><img src=../en/other/pet-clinic/2-zero-configuration/../images/apm-environment.png alt="APM Environment" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ea899e15e651c9473f8e690907b16b4e><img src=../en/other/pet-clinic/2-zero-configuration/../images/apm-environment.png alt="APM Environment" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once your validation is complete you can stop the application by pressing <code>Ctrl-c</code>.</p><h2 id=4-adding-resource-attributes-to-spans>4. Adding Resource Attributes to Spans</h2><p>Resource attributes can be added to every reported span. For example <code>version=0.314</code>. A comma-separated list of resource attributes can also be defined e.g. <code>key1=val1,key2=val2</code>.</p><p>Let&rsquo;s launch the PetClinic again using a new resource attribute. Note, that adding resource attributes to the run command will override what was defined when we installed the collector. Let&rsquo;s add a new resource attribute <code>version=0.314</code>:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span><span class=nv>version</span><span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Back in the Splunk APM UI we can drill down on a recent trace and see the new <code>version</code> attribute in a span.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-real-user-monitoring>3. Real User Monitoring</h1><h2 id=1-enable-rum>1. Enable RUM</h2><p>For the Real User Monitoring (RUM) instrumentation, we will add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web target=_blank>https://github.com/signalfx/splunk-otel-js-web</a> snippet in the pages, we will use the wizard again <strong>Data Management ‚Üí Add Integration ‚Üí RUM Instrumentation ‚Üí Browser Instrumentation</strong>.</p><p>Select the preconfigured <strong>RUM ACCESS TOKEN</strong> from the dropdown, and click <strong>Next</strong>. Enter <strong>App name</strong> and <strong>Environment</strong> using the following syntax:</p><ul><li><code>[instance]-petclinic-service</code> - replacing <code>[instance]</code> with your actual hostname.</li><li><code>[instance]-petclinic-env</code> - replacing <code>[instance]</code> with your actual hostname.</li></ul><p>Then you&rsquo;ll need to select the workshop RUM token and define the application and environment names. The wizard will then show a snippet of HTML code that needs to be placed at the top of the pages in the <code>&lt;head></code> section. In this example, we are using:</p><ul><li>Application Name: <code>&lt;instance>-petclinic-service</code></li><li>Environment: <code>&lt;instance>-petclinic-env</code></li></ul><p>Copy the generated code snippet in the wizard or copy and edit the snippet below accordingly. You need to replace <code>&lt;REALM></code>, <code>&lt;RUM_ACCESS_TOKEN></code> and <code>&lt;instance></code> with the actual values.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>    <span class=nx>beaconUrl</span><span class=o>:</span> <span class=s2>&#34;https://rum-ingest.&lt;REALM&gt;.signalfx.com/v1/rum&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>rumAuth</span><span class=o>:</span> <span class=s2>&#34;&lt;RUM_ACCESS_TOKEN&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>app</span><span class=o>:</span> <span class=s2>&#34;&lt;instance&gt;-petclinic-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>environment</span><span class=o>:</span> <span class=s2>&#34;&lt;instance&gt;-petclinic-env&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><p>The Spring PetClinic application uses a single HTML page as the &ldquo;layout&rdquo; page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded in all pages automatically.</p><p>Let&rsquo;s then edit the layout page:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi src/main/resources/templates/fragments/layout.html</span></span></code></pre></div><p>Next, insert the snippet we generated above in the <code>&lt;head></code> section of the page. Now we need to rebuild the application and run it again:</p><h2 id=2-rebuild-petclinic>2. Rebuild PetClinic</h2><p>Run the <code>maven</code> command to compile/build/package PetClinic:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span><span class=nv>version</span><span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Then let&rsquo;s visit the application using a browser to generate real-user traffic <code>http://&lt;VM_IP_ADDRESS>:8083</code>, now we should see RUM traces being reported.</p><p>Let&rsquo;s visit RUM and see some of the traces and metrics <strong>Hamburger Menu ‚Üí RUM</strong> and you will see some of the Spring PetClinic URLs showing up in the UI.</p><p>When you drill down into a RUM trace you will see a link to APM in the spans. Clicking on the trace ID will take you to the corresponding APM trace for the current RUM trace.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-log-observer>4. Log Observer</h1><h2 id=1-introduction>1. Introduction</h2><p>For the Splunk Log Observer component, we will configure the Spring PetClinic application to write logs to a file in the filesystem and configure the Splunk OpenTelemetry Collect to read (tail) that log file and report the information to the Splunk Observability Platform.</p><h2 id=2-opentelemetry-filelog-configuration>2. OpenTelemetry Filelog Configuration</h2><p>We need to configure the Splunk OpenTelemetry Collector to tail the Spring PetClinic log file and report the data to the Splunk Cloud HEC URL.</p><p>The Splunk OpenTelemetry Collector uses the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/filelogreceiver/README.md target=_blank>Filelog Receiver</a> to consume logs. We will need to edit the collectors&rsquo; configuration file:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Under <code>receivers:</code> create the Filelog Receiver (make sure to indent correctly):</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>filelog</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>/home/ubuntu/spring-petclinic.log]</span></span></span></code></pre></div><p>The under the <code>service:</code> section, find the <code>logs:</code> pipeline, replace <code>fluentforward</code> with<code>filelog</code> and remove <code>otlp</code>(again, make sure to indent correctly):</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>filelog]</span></span></span></code></pre></div><p>Save the file and exit the editor. Next, we need to validate that the HEC Token and HEC URL are configured for the collector to use. We will inspect the <code>/etc/otel/collector/splunk-otel-collector.conf</code> file:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo cat /etc/otel/collector/splunk-otel-collector.conf</span></span></code></pre></div><p>Make sure <code>SPLUNK_HEC_URL</code> and <code>SPLUNK_HEC_TOKEN</code> have values set, we can then restart the collector to apply the changes:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div><h2 id=3-logback-settings>3. Logback Settings</h2><p>The Spring PetClinic application can be configured to use several different Java logging libraries. In this scenario, we are going to use logback. We just need to create a file named <code>logback.xml</code> in the configuration folder:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi ~/spring-petclinic/src/main/resources/logback.xml</span></span></code></pre></div><p>Copy and paste the following XML content:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE xml&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;configuration</span> <span class=na>scan=</span><span class=s>&#34;true&#34;</span> <span class=na>scanPeriod=</span><span class=s>&#34;30 seconds&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;contextListener</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.classic.jul.LevelChangePropagator&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;resetJUL&gt;</span>true<span class=nt>&lt;/resetJUL&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/contextListener&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;logger</span> <span class=na>name=</span><span class=s>&#34;org.springframework.samples.petclinic&#34;</span> <span class=na>level=</span><span class=s>&#34;info&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;file&#34;</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;file&gt;</span>/home/ubuntu/spring-petclinic.log<span class=nt>&lt;/file&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rollingPolicy</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;fileNamePattern&gt;</span>springLogFile.%d{yyyy-MM-dd}.log<span class=nt>&lt;/fileNamePattern&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;maxHistory&gt;</span>5<span class=nt>&lt;/maxHistory&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;totalSizeCap&gt;</span>1GB<span class=nt>&lt;/totalSizeCap&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/rollingPolicy&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;encoder&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;pattern&gt;</span>
</span></span><span class=line><span class=cl>        %d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg trace_id=%X{trace_id} span_id=%X{span_id} trace_flags=%X{trace_flags} %n service.name=%property{otel.resource.service.name}, deployment.environment=%property{otel.resource.deployment.environment}: %m%n
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/pattern&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;root</span> <span class=na>level=</span><span class=s>&#34;info&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;file&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/root&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span></span></span></code></pre></div><p>Now we need to rebuild the application and run it again:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><p>Once the rebuild has been completed we can then run the application again:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span><span class=nv>version</span><span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><h2 id=4-view-logs>4. View Logs</h2><p>From the left-hand menu click on <strong>Log Observer</strong>. Click on <strong>Index</strong> and select <strong>o11y-workshop-XXX.splunkcloud.com</strong> (where <strong>XXX</strong> will be the realm you are running in). On the right-hand side select <strong>petclinic-workshop</strong> and then click <strong>Apply</strong>. You should see log messages being reported.</p><p>Next, click <strong>Add Filter</strong> search for the field <code>service_name</code> select the value <code>&lt;your host name>-petclinic-service</code> and click <code>=</code> (include). You should now see only the log messages from your PetClinic application.</p><p><a href=#R-image-3b9382a57edee2cef5a97e50ad82508a class=lightbox-link><img src=../en/other/pet-clinic/4-log-observer-connect/../images/log-observer.png alt="Log Observer" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b9382a57edee2cef5a97e50ad82508a><img src=../en/other/pet-clinic/4-log-observer-connect/../images/log-observer.png alt="Log Observer" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-summary>4. Summary</h2><p>This is the end of the exercise and we have certainly covered a lot of ground. At this point, you should have metrics, traces (APM & RUM), logs, database query performance and code profiling being reported into Splunk Observability Cloud. <strong>Congratulations</strong>!</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=getting-data-in-gdi-with-otel-and-uf>Getting Data In (GDI) with OTel and UF</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
45 minutes</button></span><p>During this technical workshop you will learn how to:</p><ul><li>Efficiently deploy complex environments</li><li>Capture metrics from these environments to Splunk Observability Cloud</li><li>Auto-instrument a python application</li><li>Enable OS logging to Splunk Enterprise via Universal Forwarder</li></ul><p>In order to simplify the workshop modules, a pre-configured AWS EC2 instance is provided.</p><p>By the end of this technical workshop you will have an approach to demonstrating metrics collection for complex environments and services.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Getting Data In (GDI) with OTel and UF</h1><article class=default><header class=headline></header><h1 id=getting-started-with-o11y-gdi---real-time-enrichment-workshop>Getting Started with O11y GDI - Real Time Enrichment Workshop</h1><p>Please note to begin the following lab, you must have completed the prework:</p><ul><li>Obtain a Splunk Observability Cloud access key</li><li>Understand cli commands</li></ul><p>Follow these steps if using O11y Workshop EC2 instances</p><h2 id=1-verify-yelp-data-files-are-present>1. Verify yelp data files are present</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ll /var/appdata/yelp*</span></span></code></pre></div><h2 id=2-export-the-following-variables>2. Export the following variables</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;your-access-token&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span>&lt;your-o11y-cloud-realm&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>clusterName</span><span class=o>=</span>&lt;your-k8s-cluster&gt;</span></span></code></pre></div><h2 id=3-clone-the-following-repo>3. Clone the following repo</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu 
</span></span><span class=line><span class=cl>git clone https://github.com/leungsteve/realtime_enrichment.git 
</span></span><span class=line><span class=cl><span class=nb>cd</span> realtime_enrichment/workshop 
</span></span><span class=line><span class=cl>python3 -m venv rtapp-workshop 
</span></span><span class=line><span class=cl><span class=nb>source</span> rtapp-workshop/bin/activate</span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=deploy-complex-environments-and-capture-metrics>Deploy Complex Environments and Capture Metrics</h1><p><strong>Objective:</strong> Learn how to efficiently deploy complex infrastructure components such as Kafka and MongoDB to demonstrate metrics collection with Splunk O11y IM integrations</p><p><strong>Duration</strong>: 15 Minutes</p><h2 id=scenario>Scenario</h2><p>A prospect uses Kafka and MongoDB in their environment. Since there are integrations for these services, you‚Äôd like to demonstrate this to the prospect. What is a quick and efficient way to set up a live environment with these services and have metrics collected?</p><h3 id=1-where-can-i-find-helm-charts>1. Where can I find helm charts?</h3><ul><li>Google ‚Äúmyservice helm chart‚Äù</li><li><code>https://artifacthub.io/</code> (<strong>Note:</strong> Look for charts from trusted organizations, with high star count and frequent updates)</li></ul><h3 id=2-review-apache-kafka-packaged-by-bitnamihttpsgithubcombitnamichartstreemainbitnamikafkainstalling-the-chart>2. Review <a href=https://github.com/bitnami/charts/tree/main/bitnami/kafka/#installing-the-chart target=_blank>Apache Kafka packaged by Bitnami</a></h3><p>We will deploy the helm chart with these options enabled:</p><ul><li><code>replicaCount=3</code></li><li><code>metrics.jmx.enabled=true</code></li><li><code>metrics.kafka.enabled=true</code></li><li><code>deleteTopicEnable=true</code></li></ul><h3 id=3-review-mongodbr-packaged-by-bitnamihttpsgithubcombitnamichartstreemasterbitnamimongodbinstalling-the-chart>3. Review <a href=https://github.com/bitnami/charts/tree/master/bitnami/mongodb/#installing-the-chart target=_blank>MongoDB(R) packaged by Bitnami</a></h3><p>We will deploy the helm chart with these options enabled:</p><ul><li><code>version 12.1.31</code></li><li><code>metrics.enabled=true</code></li><li><code>global.namespaceOverride=default</code></li><li><code>auth.rootUser=root</code></li><li><code>auth.rootPassword=splunk</code></li><li><code>auth.enabled=false</code></li></ul><h3 id=4-install-kafka-and-mongodb-with-helm-charts>4. Install Kafka and MongoDB with helm charts</h3><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add bitnami https://charts.bitnami.com/bitnami</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install kafka --set <span class=nv>replicaCount</span><span class=o>=</span><span class=m>3</span> --set metrics.jmx.enabled<span class=o>=</span><span class=nb>true</span> --set metrics.kafka.enabled<span class=o>=</span><span class=nb>true</span>  --set <span class=nv>deleteTopicEnable</span><span class=o>=</span><span class=nb>true</span> bitnami/kafka</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install mongodb --set metrics.enabled<span class=o>=</span><span class=nb>true</span> bitnami/mongodb --set global.namespaceOverride<span class=o>=</span>default --set auth.rootUser<span class=o>=</span>root --set auth.rootPassword<span class=o>=</span>splunk --set auth.enabled<span class=o>=</span><span class=nb>false</span> --version 12.1.31</span></span></code></pre></div><p>Verify the helm chart installation</p><div class=tab-panel data-tab-group=4f6196d4f8d80b47091cdc13acfcaa5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-list class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("4f6196d4f8d80b47091cdc13acfcaa5d","helm-list")'>
<span class=tab-nav-text>helm list</span></button>
<button data-tab-item=helm-list-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4f6196d4f8d80b47091cdc13acfcaa5d","helm-list-output")'>
<span class=tab-nav-text>helm list output</span></button></div><div class=tab-content-container><div data-tab-item=helm-list class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm list</span></span></code></pre></div></div></div><div data-tab-item=helm-list-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME    NAMESPACE   REVISION    UPDATED                                 STATUS      CHART           APP VERSION
</span></span><span class=line><span class=cl>kafka   default     1           2022-11-14 11:21:36.328956822 -0800 PST deployed    kafka-19.1.3    3.3.1
</span></span><span class=line><span class=cl>mongodb default     1           2022-11-14 11:19:36.507690487 -0800 PST deployed    mongodb-12.1.31 5.0.10</span></span></code></pre></div></div></div></div></div><p>Verify the helm chart installation</p><div class=tab-panel data-tab-group=7ad3de4bcb3c1cfd94105de440fd7d75><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7ad3de4bcb3c1cfd94105de440fd7d75","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7ad3de4bcb3c1cfd94105de440fd7d75","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                              READY   STATUS              RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-exporter-595778d7b4-99ztt   0/1     ContainerCreating   0          17s
</span></span><span class=line><span class=cl>mongodb-b7c968dbd-jxvsj           0/2     Pending             0          6s
</span></span><span class=line><span class=cl>kafka-1                           0/2     ContainerCreating   0          16s
</span></span><span class=line><span class=cl>kafka-2                           0/2     ContainerCreating   0          16s
</span></span><span class=line><span class=cl>kafka-zookeeper-0                 0/1     Pending             0          17s
</span></span><span class=line><span class=cl>kafka-0                           0/2     Pending             0          17s</span></span></code></pre></div></div></div></div></div><p>Use information for each Helm chart and Splunk O11y Data Setup to generate values.yaml for capturing metrics from Kafka and MongoDB.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p><code>values.yaml</code> for the different services will be passed to the Splunk Helm Chart at installation time. These will configure the OTEL collector to capture metrics from these services.</p></div></div><ul><li>References:<ul><li><a href=https://github.com/bitnami/charts/tree/master/bitnami/spark/#installing-the-chart target=_blank>Apache Kafka packaged by Bitnami</a></li><li><a href=https://docs.splunk.com/Observability/gdi/kafka/kafka.html target=_blank>Configure application receivers for databases ¬ª Apache Kafka</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/kafkametricsreceiver target=_blank>Kafkametricsreceiver</a></li></ul></li></ul><h4 id=41-example-kafkavaluesyaml>4.1 Example kafka.values.yaml</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>smartagent/kafka</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;kafka&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=c>#endpoint: &#39;`endpoint`:5555&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5555</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>clusterName</span><span class=p>:</span><span class=w> </span><span class=l>sl-kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>otelK8sClusterReceiver</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>k8sEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kafkametrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>brokers</span><span class=p>:</span><span class=w> </span><span class=l>kafka:9092</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>protocol_version</span><span class=p>:</span><span class=w> </span><span class=m>2.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>brokers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>topics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>consumers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=c>#- prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>kafkametrics</span></span></span></code></pre></div><h4 id=42-example-mongodbvaluesyaml>4.2 Example mongodb.values.yaml</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>smartagent/mongodb</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;mongo&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>mongodb.default.svc.cluster.local</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>27017</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>databases</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;admin&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;O11y&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;local&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;config&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>sendCollectionMetrics</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>sendCollectionTopMetrics</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div><h4 id=43-example-zookeepervaluesyaml>4.3 Example zookeeper.values.yaml</h4><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otelAgent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>smartagent/zookeeper</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; name matches &#34;kafka-zookeeper&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>kafka-zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>2181</span></span></span></code></pre></div><h3 id=5-install-the-splunk-otel-helm-chart>5. Install the Splunk OTEL helm chart</h3><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/realtime_enrichment/otel_yamls/ 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm repo update</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install --set <span class=nv>provider</span><span class=o>=</span><span class=s1>&#39; &#39;</span> --set <span class=nv>distro</span><span class=o>=</span><span class=s1>&#39; &#39;</span> --set splunkObservability.accessToken<span class=o>=</span><span class=nv>$ACCESS_TOKEN</span> --set <span class=nv>clusterName</span><span class=o>=</span><span class=nv>$clusterName</span> --set splunkObservability.realm<span class=o>=</span><span class=nv>$REALM</span> --set otelCollector.enabled<span class=o>=</span><span class=s1>&#39;false&#39;</span> --set splunkObservability.logsEnabled<span class=o>=</span><span class=s1>&#39;true&#39;</span> --set gateway.enabled<span class=o>=</span><span class=s1>&#39;false&#39;</span> --values kafka.values.yaml --values mongodb.values.yaml --values zookeeper.values.yaml --values alwayson.values.yaml --values k3slogs.yaml --generate-name splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><h3 id=6-verify-installation>6. Verify installation</h3><p>Verify that the Kafka, MongoDB and Splunk OTEL Collector helm charts are installed, note that names may differ.</p><div class=tab-panel data-tab-group=1ede5699fe23316bf19e88ee06e56d63><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-list class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("1ede5699fe23316bf19e88ee06e56d63","helm-list")'>
<span class=tab-nav-text>helm list</span></button>
<button data-tab-item=helm-list-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1ede5699fe23316bf19e88ee06e56d63","helm-list-output")'>
<span class=tab-nav-text>helm list Output</span></button></div><div class=tab-content-container><div data-tab-item=helm-list class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm list</span></span></code></pre></div></div></div><div data-tab-item=helm-list-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                NAMESPACE   REVISION    UPDATED                                 STATUS      CHART                           APP VERSION
</span></span><span class=line><span class=cl>kafka                               default     1           2021-12-07 12:48:47.066421971 -0800 PST deployed    kafka-14.4.1                    2.8.1
</span></span><span class=line><span class=cl>mongodb                             default     1           2021-12-07 12:49:06.132771625 -0800 PST deployed    mongodb-10.29.2                 4.4.10
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184    default     1           2021-12-07 12:49:45.694013749 -0800 PST deployed    splunk-otel-collector-0.37.1    0.37.1</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=8f582072f9a01498f45848d2a6edcb6f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("8f582072f9a01498f45848d2a6edcb6f","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("8f582072f9a01498f45848d2a6edcb6f","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running   0          18m
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>mongodb-79cf87987f-gsms8                                          2/2     Running   0          18m
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>kafka-exporter-7c65fcd646-dvmtv                                   1/1     Running   3          18m
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running   1          18m
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184-agent-27s5c                      2/2     Running   0          17m
</span></span><span class=line><span class=cl>splunk-otel-collector-1638910184-k8s-cluster-receiver-8587qmh9l   1/1     Running   0          17m</span></span></code></pre></div></div></div></div></div><h3 id=7-verify-dashboards>7. Verify dashboards</h3><p>Verify that out of the box dashboards for Kafka, MongoDB and Zookeeper are populated in the Infrastructure Monitor landing page. Drill down into each component to view granular details for each service.</p><p>Tip: You can use the filter <code>k8s.cluster.name</code> with your cluster name to find your instance.</p><ul><li>Infrastructure Monitoring Landing page:</li></ul><p><a href=#R-image-3255e40a27f5dd21f665503e05a068c6 class=lightbox-link><img src=../en/other/gdi/2-deploy/../images/inframon.jpg alt=IM-landing-page class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3255e40a27f5dd21f665503e05a068c6><img src=../en/other/gdi/2-deploy/../images/inframon.jpg alt=IM-landing-page class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>K8 Navigator:</li></ul><p><a href=#R-image-7fa832516044473904362928674cd849 class=lightbox-link><img src=../en/other/gdi/2-deploy/../images/k8navigator.jpg alt=k8-navigator class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7fa832516044473904362928674cd849><img src=../en/other/gdi/2-deploy/../images/k8navigator.jpg alt=k8-navigator class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>MongoDB Dashboard:</li></ul><p><a href=#R-image-80b3938ae72b4ec7a35ee546063dccb1 class=lightbox-link><img src=../en/other/gdi/2-deploy/../images/mongoDB.jpg alt=mongodb-dash class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-80b3938ae72b4ec7a35ee546063dccb1><img src=../en/other/gdi/2-deploy/../images/mongoDB.jpg alt=mongodb-dash class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Kafka Dashboard:</li></ul><p><a href=#R-image-72dd4f46edd7f66434057b924096234c class=lightbox-link><img src=../en/other/gdi/2-deploy/../images/kafka.jpg alt=kafka-dash class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-72dd4f46edd7f66434057b924096234c><img src=../en/other/gdi/2-deploy/../images/kafka.jpg alt=kafka-dash class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=code-to-kubernetes---python>Code to Kubernetes - Python</h1><h2 id=code-to-kubernetes---python>Code to Kubernetes - Python</h2><p><strong>Objective:</strong> Understand activities to instrument a python application and run it on Kubernetes.</p><ul><li>Verify the code</li><li>Containerize the app</li><li>Deploy the container in Kubernetes</li></ul><p><strong>Note:</strong> these steps do not involve Splunk</p><p><strong>Duration:</strong> 15 Minutes</p><h2 id=1-verify-the-code---review-service>1. Verify the code - Review service</h2><p>Navigate to the review directory</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/realtime_enrichment/flask_apps/review/</span></span></code></pre></div><p>Inspect review.py (realtime_enrichment/flask_apps/review)</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat review.py</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>jsonify</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>review</span> <span class=o>=</span> <span class=n>Flask</span><span class=p>(</span><span class=vm>__name__</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>num_reviews</span> <span class=o>=</span> <span class=mi>8635403</span>
</span></span><span class=line><span class=cl><span class=n>num_reviews</span> <span class=o>=</span> <span class=mi>100000</span>
</span></span><span class=line><span class=cl><span class=n>reviews_file</span> <span class=o>=</span> <span class=s1>&#39;/var/appdata/yelp_academic_dataset_review.json&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@review.route</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>hello_world</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>jsonify</span><span class=p>(</span><span class=n>message</span><span class=o>=</span><span class=s1>&#39;Hello, you want to hit /get_review. We have &#39;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>num_reviews</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39; reviews!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nd>@review.route</span><span class=p>(</span><span class=s1>&#39;/get_review&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_review</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>random_review_int</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=n>num_reviews</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>line_num</span> <span class=o>=</span> <span class=n>random_review_int</span> <span class=o>+</span> <span class=s1>&#39;q;d&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>command</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;sed&#34;</span><span class=p>,</span> <span class=n>line_num</span><span class=p>,</span> <span class=n>reviews_file</span><span class=p>]</span> <span class=c1># sed &#34;7997242q;d&#34; &lt;file&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>random_review</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>command</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>,</span> <span class=n>text</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>random_review</span><span class=o>.</span><span class=n>stdout</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>review</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>host</span> <span class=o>=</span><span class=s1>&#39;0.0.0.0&#39;</span><span class=p>,</span> <span class=n>port</span> <span class=o>=</span> <span class=mi>5000</span><span class=p>,</span> <span class=n>debug</span> <span class=o>=</span> <span class=kc>True</span><span class=p>)</span></span></span></code></pre></div><p>Inspect requirements.txt</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Flask==2.0.2</span></span></code></pre></div><p>Create a virtual environment and Install the necessary python packages</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/realtime_enrichment/workshop/flask_apps_start/review/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pip freeze <span class=c1>#note output</span>
</span></span><span class=line><span class=cl>pip install -r requirements.txt
</span></span><span class=line><span class=cl>pip freeze <span class=c1>#note output</span></span></span></code></pre></div><p>Start the REVIEW service. <strong>Note:</strong> You can stop the app with control+C</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 review.py
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> * Serving Flask app <span class=s1>&#39;review&#39;</span> <span class=o>(</span>lazy loading<span class=o>)</span>
</span></span><span class=line><span class=cl> * Environment: production
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl> * Running on http://10.160.145.246:5000/ <span class=o>(</span>Press CTRL+C to quit<span class=o>)</span>
</span></span><span class=line><span class=cl> * Restarting with stat
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:46:38<span class=o>]</span> <span class=s2>&#34;GET / HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:47:02<span class=o>]</span> <span class=s2>&#34;GET /get_review HTTP/1.1&#34;</span> <span class=m>200</span> -
</span></span><span class=line><span class=cl>127.0.0.1 - - <span class=o>[</span>17/May/2022 22:47:58<span class=o>]</span> <span class=s2>&#34;GET /get_review HTTP/1.1&#34;</span> <span class=m>200</span> -</span></span></code></pre></div><p>Verify that the service is working</p><ul><li>Open a new terminal and ssh into your ec2 instance. Then use the curl command in your terminal.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:5000</span></span></code></pre></div><ul><li>Or hit the URL <code>http://{Your_EC2_IP_address}:5000</code> and <code>http://{Your_EC2_IP_address}:5000/get_review</code> with a browser</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:5000
</span></span><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Hello, you want to hit /get_review. We have 100000 reviews!&#34;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl localhost:5000/get_review
</span></span><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;review_id&#34;</span>:<span class=s2>&#34;NjbiESXotcEdsyTc4EM3fg&#34;</span>,<span class=s2>&#34;user_id&#34;</span>:<span class=s2>&#34;PR9LAM19rCM_HQiEm5OP5w&#34;</span>,<span class=s2>&#34;business_id&#34;</span>:<span class=s2>&#34;UAtX7xmIfdd1W2Pebf6NWg&#34;</span>,<span class=s2>&#34;stars&#34;</span>:3.0,<span class=s2>&#34;useful&#34;</span>:0,<span class=s2>&#34;funny&#34;</span>:0,<span class=s2>&#34;cool&#34;</span>:0,<span class=s2>&#34;text&#34;</span>:<span class=s2>&#34;-If you&#39;re into cheap beer (pitcher of bud-light for </span><span class=nv>$7</span><span class=s2>) decent wings and a good time, this is the place for you. Its generally very packed after work hours and weekends. Don&#39;t expect cocktails. \n\n-You run into a lot of sketchy characters here sometimes but for the most part if you&#39;re chilling with friends its not that bad. \n\n-Friendly bouncer and bartenders.&#34;</span>,<span class=s2>&#34;date&#34;</span>:<span class=s2>&#34;2016-04-12 20:23:24&#34;</span><span class=o>}</span></span></span></code></pre></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><ul><li>What does this application do?</li><li>Do you see the yelp dataset being used?</li><li>Why did the output of pip freeze differ each time you ran it?</li><li>Which port is the REVIEW app listening on? Can other python apps use this same port?</li></ul></div></div><h2 id=2-create-a-review-container>2. Create a REVIEW container</h2><p>To create a container image, you need to create a Dockerfile, run docker build to build the image referencing the Docker file and push it up to a remote repository so it can be pulled by other sources.</p><ul><li><a href=https://docs.docker.com/get-started/02_our_app/ target=_blank>Create a Dockerfile</a></li><li>Creating a Dockerfile typically requires you to consider the following:<ul><li>Identify an appropriate container image<ul><li>ubuntu vs. python vs. alpine/slim</li><li>ubuntu - overkill, large image size, wasted resources when running in K8</li><li>this is a python app, so pick an image that is optimized for it</li><li><a href=https://lih-verma.medium.com/alpine-makes-python-docker-builds-way-too-50-slower-and-images-double-2-larger-61d1d43cbc79 target=_blank>avoid alpine for python</a></li></ul></li><li>Order matters<ul><li>you&rsquo;re building layers.</li><li>re-use the layers as much as possible</li><li>have items that change often towards the end</li></ul></li><li><a href=https://docs.docker.com/develop/develop-images/dockerfile_best-practices/ target=_blank>Other Best practices for writing Dockerfiles</a></li></ul></li></ul><p>Dockerfile for review</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.10-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./review.py /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 5000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span> <span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;review.py&#34;</span> <span class=p>]</span></span></span></code></pre></div><p>Create a container image (locally)
Run ‚Äòdocker build‚Äô to build a local container image referencing the Dockerfile</p><div class=tab-panel data-tab-group=5c845bac4b9d3c3b38a186b9efc5b876><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-build class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("5c845bac4b9d3c3b38a186b9efc5b876","docker-build")'>
<span class=tab-nav-text>docker build</span></button>
<button data-tab-item=docker-build-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("5c845bac4b9d3c3b38a186b9efc5b876","docker-build-output")'>
<span class=tab-nav-text>docker build Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-build class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -f Dockerfile -t localhost:8000/review:0.01 .</span></span></code></pre></div></div></div><div data-tab-item=docker-build-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[+] Building 35.5s (11/11) FINISHED
</span></span><span class=line><span class=cl> =&gt; [internal] load build definition from Dockerfile                              0.0s
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl> =&gt; [3/5] COPY requirements.txt /app                                              0.0s
</span></span><span class=line><span class=cl> =&gt; [4/5] RUN pip install -r requirements.txt                                     4.6s
</span></span><span class=line><span class=cl> =&gt; [5/5] COPY ./review.py /app                                                   0.0s
</span></span><span class=line><span class=cl> =&gt; exporting to image                                                            0.2s
</span></span><span class=line><span class=cl> =&gt; =&gt; exporting layers                                                           0.2s
</span></span><span class=line><span class=cl> =&gt; =&gt; writing image sha256:61da27081372723363d0425e0ceb34bbad6e483e698c6fe439c5  0.0s
</span></span><span class=line><span class=cl> =&gt; =&gt; naming to docker.io/localhost:8000/review:0.1                                   0.0</span></span></code></pre></div></div></div></div></div><p>Push the container image into a container repository
Run ‚Äòdocker push‚Äô to place a copy of the REVIEW container to a remote location</p><div class=tab-panel data-tab-group=1818d095115138b951f1447279d659a5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-push class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("1818d095115138b951f1447279d659a5","docker-push")'>
<span class=tab-nav-text>docker push</span></button>
<button data-tab-item=docker-push-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("1818d095115138b951f1447279d659a5","docker-push-output")'>
<span class=tab-nav-text>docker push Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-push class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker push localhost:8000/review:0.01</span></span></code></pre></div></div></div><div data-tab-item=docker-push-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [docker.io/localhost:8000/review]
</span></span><span class=line><span class=cl>02c36dfb4867: Pushed
</span></span><span class=line><span class=cl>         ...snip...
</span></span><span class=line><span class=cl>fd95118eade9: Pushed
</span></span><span class=line><span class=cl>0.1: digest: sha256:3651f740abe5635af95d07acd6bcf814e4d025fcc1d9e4af9dee023a9b286f38 size: 2202</span></span></code></pre></div></div></div></div></div><p>Verify that the image is in Docker Hub. The same info can be found in Docker Desktop</p><div class=tab-panel data-tab-group=3247a46dd7b3a7f59a5a8ffeee859717><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-catalog class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3247a46dd7b3a7f59a5a8ffeee859717","get-catalog")'>
<span class=tab-nav-text>get catalog</span></button>
<button data-tab-item=get-catalog-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3247a46dd7b3a7f59a5a8ffeee859717","get-catalog-output")'>
<span class=tab-nav-text>get catalog Output</span></button></div><div class=tab-content-container><div data-tab-item=get-catalog class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -s http://localhost:8000/v2/_catalog</span></span></code></pre></div></div></div><div data-tab-item=get-catalog-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;repositories&#34;:[&#34;review&#34;]}</span></span></code></pre></div></div></div></div></div><h2 id=3-run-review-in-kubernetes>3. Run REVIEW in Kubernetes</h2><p>Create K8 deployment yaml file for the REVIEW app</p><p>Reference: <a href=https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#creating-a-deployment target=_blank>Creating a Deployment</a></p><p>review.deployment.yaml</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>imagePullSecrets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>regcred</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8000/review:0.01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span></span></span></code></pre></div><p>Notes regarding review.deployment.yaml:</p><ul><li>labels - K8 uses labels and selectors to tag and identify resources<ul><li>In the next step, we&rsquo;ll create a service and associate it to this deployment using the label</li></ul></li><li>replicas = 1<ul><li>K8 allows you to scale your deployments horizontally</li><li>We&rsquo;ll leverage this later to add load and increase our ingestion rate</li></ul></li><li>regcred provides this deployment with the ability to access your dockerhub credentials which is necessary to pull the container image.</li><li>The volume definition and volumemount make the yelp dataset visible to the container</li></ul><p>Create a K8 service yaml file for the review app.</p><p>Reference: <a href=https://kubernetes.io/docs/concepts/services-networking/service/#defining-a-service target=_blank>Creating a service:</a></p><p>review.service.yaml</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>NodePort</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>5000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>targetPort</span><span class=p>:</span><span class=w> </span><span class=m>5000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>nodePort</span><span class=p>:</span><span class=w> </span><span class=m>30000</span></span></span></code></pre></div><p>Notes about review.service.yaml:</p><ul><li>the selector associates this service to pods with the label app with the value being review</li><li>the review service exposes the review pods as a network service<ul><li>other pods can now ping &lsquo;review&rsquo; and they will hit a review pod.</li><li>a pod would get a review if it ran <code>curl http://review:5000</code></li></ul></li><li>NodePort service<ul><li>the service is accessible to the K8 host by the nodePort, 30000</li><li>Another machine that has this can get a review if it ran <code>curl http://&lt;k8 host ip>:30000</code></li></ul></li></ul><p>Apply the review deployment and service</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f review.service.yaml -f review.deployment.yaml</span></span></code></pre></div><p>Verify that the deployment and services are running:</p><div class=tab-panel data-tab-group=698e8a5320b114c96f0c211f5e9b8108><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-deployments class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("698e8a5320b114c96f0c211f5e9b8108","kubectl-get-deployments")'>
<span class=tab-nav-text>kubectl get deployments</span></button>
<button data-tab-item=kubectl-get-deployments-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("698e8a5320b114c96f0c211f5e9b8108","kubectl-get-deployments-output")'>
<span class=tab-nav-text>kubectl get deployments output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-deployments class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get deployments</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-deployments-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                    READY   UP-TO-DATE   AVAILABLE   AGE
</span></span><span class=line><span class=cl>review                                                  1/1     1            1           19h</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=6cbae7af602caa4d5e2f533aa03e9531><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-services class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("6cbae7af602caa4d5e2f533aa03e9531","kubectl-get-services")'>
<span class=tab-nav-text>kubectl get services</span></button>
<button data-tab-item=kubectl-get-services-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("6cbae7af602caa4d5e2f533aa03e9531","kubectl-get-services-output")'>
<span class=tab-nav-text>kubectl get services output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-services class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get services</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-services-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                       TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)                         AGE
</span></span><span class=line><span class=cl>review                     NodePort    10.43.175.21    &lt;none&gt;        5000:30000/TCP                  154d</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=2ecb1f6c20cd7b8cd966ea93ac896149><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=curl-localhost class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("2ecb1f6c20cd7b8cd966ea93ac896149","curl-localhost")'>
<span class=tab-nav-text>curl localhost</span></button>
<button data-tab-item=curl-localhost-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2ecb1f6c20cd7b8cd966ea93ac896149","curl-localhost-output")'>
<span class=tab-nav-text>curl localhost Output</span></button></div><div class=tab-content-container><div data-tab-item=curl-localhost class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:30000</span></span></code></pre></div></div></div><div data-tab-item=curl-localhost-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;message&#34;: &#34;Hello, you want to hit /get_review. We have 100000 reviews!&#34;
</span></span><span class=line><span class=cl>}</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=ed1606661ff0c592dd1a92601280699f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=get-review class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ed1606661ff0c592dd1a92601280699f","get-review")'>
<span class=tab-nav-text>get review</span></button>
<button data-tab-item=get-review-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ed1606661ff0c592dd1a92601280699f","get-review-output")'>
<span class=tab-nav-text>get review Output</span></button></div><div class=tab-content-container><div data-tab-item=get-review class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:30000/get_review</span></span></code></pre></div></div></div><div data-tab-item=get-review-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;review_id&#34;:&#34;Vv9rHtfBrFc-1M1DHRKN9Q&#34;,&#34;user_id&#34;:&#34;EaNqIwKkM7p1bkraKotqrg&#34;,&#34;business_id&#34;:&#34;TA1KUSCu8GkWP9w0rmElxw&#34;,&#34;stars&#34;:3.0,&#34;useful&#34;:1,&#34;funny&#34;:0,&#34;cool&#34;:0,&#34;text&#34;:&#34;This is the first time I&#39;ve actually written a review for Flip, but I&#39;ve probably been here about 10 times.  \n\nThis used to be where I would take out of town guests who wanted a good, casual, and relatively inexpensive meal.  \n\nI hadn&#39;t been for a while, so after a long day in midtown, we decided to head to Flip.  \n\nWe had the fried pickles, onion rings, the gyro burger, their special burger, and split a nutella milkshake.  I have tasted all of the items we ordered previously (with the exception of the special) and have been blown away with how good they were.  My guy had the special which was definitely good, so no complaints there.  The onion rings and the fried pickles were greasier than expected.  Though I&#39;ve thought they were delicious in the past, I probably wouldn&#39;t order either again.  The gyro burger was good, but I could have used a little more sauce.  It almost tasted like all of the ingredients didn&#39;t entirely fit together.  Something was definitely off. It was a friday night and they weren&#39;t insanely busy, so I&#39;m not sure I would attribute it to the staff not being on their A game...\n\nDon&#39;t get me wrong.  Flip is still good.  The wait staff is still amazingly good looking.  They still make delicious milk shakes.  It&#39;s just not as amazing as it once was, which really is a little sad.&#34;,&#34;date&#34;:&#34;2010-10-11 18:18:35&#34;}</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What changes are required if you need to make an update to your Dockerfile now?</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=instrument-reviews-for-tracing>Instrument REVIEWS for Tracing</h1><h2 id=1-use-data-setup-to-instrument-a-python-application>1. Use Data Setup to instrument a Python application</h2><p>Within the O11y Cloud UI:</p><p>Data Management -> Add Integration -> Monitor Applications -> Python (traces) -> Add Integration</p><p>Provide the following to the Configure Integration Wizard:</p><ul><li><p>Service: review</p></li><li><p>Django: no</p></li><li><p>collector endpoint: <code>http://localhost:4317</code></p></li><li><p>Environment: rtapp-workshop-[YOURNAME]</p></li><li><p>Kubernetes: yes</p></li><li><p>Legacy Agent: no</p></li></ul><p><a href=#R-image-c1116cd2605e6c67a4aa702a81d34e73 class=lightbox-link><img src=../en/other/gdi/4-instrument/../images/configureintegration.png alt=o11y_cloud_ui class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c1116cd2605e6c67a4aa702a81d34e73><img src=../en/other/gdi/4-instrument/../images/configureintegration.png alt=o11y_cloud_ui class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We are instructed to:</p><ul><li>Install the instrumentation packages for your Python environment.</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pip install splunk-opentelemetry[all]
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>splunk-py-trace-bootstrap</span></span></code></pre></div><ul><li><p>Configure the Downward API to expose environment variables to Kubernetes resources.</p><p>For example, update a Deployment to inject environment variables by adding <code>.spec.template.spec.containers.env</code> like:</p></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>your-application</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>myapp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_OTEL_AGENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;review&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=rtapp-workshop-stevel&#34;</span></span></span></code></pre></div><ul><li><p>Enable the Splunk OTel Python agent by editing your Python service command.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>splunk-py-trace python3 main.py --port=8000</span></span></code></pre></div></li><li><p>The actions we must perform include:</p><ul><li>Update the Dockerfile to install the splunk-opentelemetry packages</li><li>Update the deployment.yaml for each service to include these environment variables which will be used by the pod and container.</li><li>Update our Dockerfile for REVIEW so that our program is bootstrapped with splunk-py-trace</li></ul></li></ul><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>We will accomplish this by:</p><ol><li>generating a new requirements.txt file</li><li>generating a new container image with an updated Dockerfile for REVIEW and then</li><li>update the review.deployment.yaml to capture all of these changes.</li></ol></div></div><h2 id=2-update-the-review-container>2. Update the REVIEW container</h2><ul><li><p>Generate a new container image</p></li><li><p>Update the Dockerfile for REVIEW (<code>/workshop/flask_apps_finish/review</code>)</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.10-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install splunk-opentelemetry<span class=o>[</span>all<span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> splk-py-trace-bootstrap<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> ./review.py /app<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 5000</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span> <span class=s2>&#34;splunk-py-trace&#34;</span> <span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span> <span class=s2>&#34;python&#34;</span><span class=p>,</span> <span class=s2>&#34;review.py&#34;</span> <span class=p>]</span></span></span></code></pre></div></li></ul><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>Note that the only lines, in bold, added to the Dockerfile</p></div></div><ul><li>Generate a new container image with docker build in the ‚Äòfinished‚Äô directory</li><li>Notice that I have changed the repository name from <code>localhost:8000/review:0.01</code> to <code>localhost:8000/review-splkotel:0.01</code></li></ul><p>Ensure you are in the correct directory.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>pwd</span>
</span></span><span class=line><span class=cl>./workshop/flask_apps_finish/review</span></span></code></pre></div><div class=tab-panel data-tab-group=85d04c45746b30be2c203cbabe1fac24><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-build class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("85d04c45746b30be2c203cbabe1fac24","docker-build")'>
<span class=tab-nav-text>docker build</span></button>
<button data-tab-item=docker-build-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("85d04c45746b30be2c203cbabe1fac24","docker-build-output")'>
<span class=tab-nav-text>docker build Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-build class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -f Dockerfile.review -t localhost:8000/review-splkotel:0.01 .</span></span></code></pre></div></div></div><div data-tab-item=docker-build-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[+] Building 27.1s (12/12) FINISHED
</span></span><span class=line><span class=cl>=&gt; [internal] load build definition from Dockerfile                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring dockerfile: 364B                                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load .dockerignore                                                                           0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring context: 2B                                                                             0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load metadata for docker.io/library/python:3.10-slim                                         1.6s
</span></span><span class=line><span class=cl>=&gt; [auth] library/python:pull token for registry-1.docker.io                                               0.0s
</span></span><span class=line><span class=cl>=&gt; [1/6] FROM docker.io/library/python:3.10-slim@sha256:54956d6c929405ff651516d5ebbc204203a6415c9d2757aad  0.0s
</span></span><span class=line><span class=cl>=&gt; [internal] load build context                                                                           0.3s
</span></span><span class=line><span class=cl>=&gt; =&gt; transferring context: 1.91kB                                                                         0.3s
</span></span><span class=line><span class=cl>=&gt; CACHED [2/6] WORKDIR /app                                                                               0.0s
</span></span><span class=line><span class=cl>=&gt; [3/6] COPY requirements.txt /app                                                                        0.0s
</span></span><span class=line><span class=cl>=&gt; [4/6] RUN pip install -r requirements.txt                                                              15.3s
</span></span><span class=line><span class=cl>=&gt; [5/6] RUN splk-py-trace-bootstrap                                                                       9.0s
</span></span><span class=line><span class=cl>=&gt; [6/6] COPY ./review.py /app                                                                             0.0s
</span></span><span class=line><span class=cl>=&gt; exporting to image                                                                                      0.6s
</span></span><span class=line><span class=cl>=&gt; =&gt; exporting layers                                                                                     0.6s
</span></span><span class=line><span class=cl>=&gt; =&gt; writing image sha256:164977dd860a17743b8d68bcc50c691082bd3bfb352d1025dc3a54b15d5f4c4d                0.0s
</span></span><span class=line><span class=cl>=&gt; =&gt; naming to docker.io/localhost:8000/review-splkotel:0.01                                              0.0s</span></span></code></pre></div></div></div></div></div><ul><li>Push the image to Docker Hub with docker push command</li></ul><div class=tab-panel data-tab-group=b39785ea97140440f795f7e6e0dee149><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=docker-push class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("b39785ea97140440f795f7e6e0dee149","docker-push")'>
<span class=tab-nav-text>docker push</span></button>
<button data-tab-item=docker-push-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("b39785ea97140440f795f7e6e0dee149","docker-push-output")'>
<span class=tab-nav-text>docker push Output</span></button></div><div class=tab-content-container><div data-tab-item=docker-push class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker push localhost:8000/review-splkotel:0.01</span></span></code></pre></div></div></div><div data-tab-item=docker-push-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [docker.io/localhost:8000/review-splkotel]
</span></span><span class=line><span class=cl>682f0e550f2c: Pushed
</span></span><span class=line><span class=cl>dd7dfa312442: Pushed
</span></span><span class=line><span class=cl>917fd8334695: Pushed
</span></span><span class=line><span class=cl>e6782d51030d: Pushed
</span></span><span class=line><span class=cl>c6b19a64e528: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>8f52e3bfc0ab: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>f90b85785215: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>d5c0beb90ce6: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>3759be374189: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>fd95118eade9: Mounted from localhost:8000/review
</span></span><span class=line><span class=cl>0.01: digest: sha256:3b251059724dbb510ea81424fc25ed03554221e09e90ef965438da33af718a45 size: 2412</span></span></code></pre></div></div></div></div></div><h2 id=3-update-the-review-deployment-in-kubernetes>3. Update the REVIEW deployment in Kubernetes</h2><ul><li><p>review.deployment.yaml must be updated with the following changes:</p><ul><li>Load the new container image on Docker Hub</li><li>Add environment variables so traces can be emitted to the OTEL collector</li></ul></li><li><p>The deployment must be replaced using the updated review.deployment.yaml</p><ul><li><p>Update review.deployment.yaml (updates highlighted in bold)</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>imagePullSecrets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>regcred</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8000/review-splkotel:0.01</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>review</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_OTEL_AGENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;review&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>SPLUNK_METRICS_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):9943&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;deployment.environment=rtapp-workshop-stevel&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>appdata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>hostPath</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/var/appdata</span></span></span></code></pre></div></li></ul></li><li><p>Apply review.deployment.yaml. Kubernetes will automatically pick up the changes to the deployment and redeploy new pods with these updates</p><ul><li>Notice that the review-* pod has been restarted</li></ul></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f review.deployment.yaml</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                              READY   STATUS        RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-client                                                      0/1     Unknown       0          155d
</span></span><span class=line><span class=cl>curl                                                              0/1     Unknown       0          155d
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running       0          26h
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running       0          26h
</span></span><span class=line><span class=cl>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running       2          26h
</span></span><span class=line><span class=cl>mongodb-6f6c78c76-kl4vv                                           2/2     Running       0          26h
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running       1          26h
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running       1          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running       0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running       0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running       0          26h
</span></span><span class=line><span class=cl>review-6686859bd7-4pf5d                                           1/1     Running       0          11s
</span></span><span class=line><span class=cl>review-5dd8cfd77b-52jbd                                           0/1     Terminating   0          2d10h
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>kubectl get pods
</span></span><span class=line><span class=cl>NAME                                                              READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>kafka-client                                                      0/1     Unknown   0          155d
</span></span><span class=line><span class=cl>curl                                                              0/1     Unknown   0          155d
</span></span><span class=line><span class=cl>kafka-zookeeper-0                                                 1/1     Running   0          26h
</span></span><span class=line><span class=cl>kafka-2                                                           2/2     Running   0          26h
</span></span><span class=line><span class=cl>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running   2          26h
</span></span><span class=line><span class=cl>mongodb-6f6c78c76-kl4vv                                           2/2     Running   0          26h
</span></span><span class=line><span class=cl>kafka-1                                                           2/2     Running   1          26h
</span></span><span class=line><span class=cl>kafka-0                                                           2/2     Running   1          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running   0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running   0          26h
</span></span><span class=line><span class=cl>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running   0          26h
</span></span><span class=line><span class=cl>review-6686859bd7-4pf5d                                           1/1     Running   0          15s</span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=monitor-system-logs-with-splunk-universal-forwarder>Monitor System Logs with Splunk Universal Forwarder</h1><p><strong>Objective:</strong> Learn how to monitor Linux system logs with the Universal Forwarder sending logs to Splunk Enterprise</p><p><strong>Duration</strong>: 10 Minutes</p><h2 id=scenario>Scenario</h2><p>You&rsquo;ve been tasked with monitoring the OS logs of the host running your Kubernetes cluster. We are going to utilize a script that will autodeploy the Splunk Universal Forwarder. You will then configure the Universal Forwarder to send logs to the Splunk Enterprise instance assigned to you.</p><h3 id=1-ensure-youre-in-the-correct-directory>1. Ensure You&rsquo;re in the Correct Directory</h3><ul><li>we will need to be in /home/ubuntu/session-2</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/session-2</span></span></code></pre></div><h3 id=2-review-the-universal-forwarder-install-script>2. Review the Universal Forwarder Install Script</h3><ul><li>Let&rsquo;s take a look at the script that will install the Universal Forwarder and Linux TA automatically for you.<ul><li>This script is primarily used for remote instances.</li><li>Note we are not using a deployment server in this lab, however it is recommended in production we do that.</li><li>What user are we installing Splunk as?</li></ul></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh  
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># This EXAMPLE script shows how to deploy the Splunk universal forwarder</span>
</span></span><span class=line><span class=cl><span class=c1># to many remote hosts via ssh and common Unix commands.</span>
</span></span><span class=line><span class=cl><span class=c1># For &#34;real&#34; use, this script needs ERROR DETECTION AND LOGGING!!</span>
</span></span><span class=line><span class=cl><span class=c1># --Variables that you must set -----</span>
</span></span><span class=line><span class=cl><span class=c1># Set username using by splunkd to run.</span>
</span></span><span class=line><span class=cl>  <span class=nv>SPLUNK_RUN_USER</span><span class=o>=</span><span class=s2>&#34;ubuntu&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Populate this file with a list of hosts that this script should install to,</span>
</span></span><span class=line><span class=cl><span class=c1># with one host per line. This must be specified in the form that should</span>
</span></span><span class=line><span class=cl><span class=c1># be used for the ssh login, ie. username@host</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Example file contents:</span>
</span></span><span class=line><span class=cl><span class=c1># splunkuser@10.20.13.4</span>
</span></span><span class=line><span class=cl><span class=c1># splunkker@10.20.13.5</span>
</span></span><span class=line><span class=cl>  <span class=nv>HOSTS_FILE</span><span class=o>=</span><span class=s2>&#34;myhost.txt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This should be a WGET command that was *carefully* copied from splunk.com!!</span>
</span></span><span class=line><span class=cl><span class=c1># Sign into splunk.com and go to the download page, then look for the wget</span>
</span></span><span class=line><span class=cl><span class=c1># link near the top of the page (once you have selected your platform)</span>
</span></span><span class=line><span class=cl><span class=c1># copy and paste your wget command between the &#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nv>WGET_CMD</span><span class=o>=</span><span class=s2>&#34;wget -O splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz &#39;https://download.splunk.com/products/universalforwarder/releases/9.0.3/linux/splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz&#39;&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Set the install file name to the name of the file that wget downloads</span>
</span></span><span class=line><span class=cl><span class=c1># (the second argument to wget)</span>
</span></span><span class=line><span class=cl>  <span class=nv>INSTALL_FILE</span><span class=o>=</span><span class=s2>&#34;splunkforwarder-9.0.3-dd0128b1f8cd-Linux-x86_64.tgz&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># After installation, the forwarder will become a deployment client of this</span>
</span></span><span class=line><span class=cl><span class=c1># host.  Specify the host and management (not web) port of the deployment server</span>
</span></span><span class=line><span class=cl><span class=c1># that will be managing these forwarder instances.</span>
</span></span><span class=line><span class=cl><span class=c1># Example 1.2.3.4:8089</span>
</span></span><span class=line><span class=cl><span class=c1>#  DEPLOY_SERVER=&#34;x.x.x.x:8089&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># After installation, the forwarder can have additional TA&#39;s added to the </span>
</span></span><span class=line><span class=cl><span class=c1># /app directory please provide the local where TA&#39;s will be. </span>
</span></span><span class=line><span class=cl>  <span class=nv>TA_INSTALL_DIRECTORY</span><span class=o>=</span><span class=s2>&#34;/home/ubuntu/session-2&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set the seed app folder name for deploymentclien.conf</span>
</span></span><span class=line><span class=cl><span class=c1>#  DEPLOY_APP_FOLDER_NAME=&#34;seed_all_deploymentclient&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Set the new Splunk admin password</span>
</span></span><span class=line><span class=cl>  <span class=nv>PASSWORD</span><span class=o>=</span><span class=s2>&#34;buttercup&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>REMOTE_SCRIPT_DEPLOY</span><span class=o>=</span><span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>  cd /opt
</span></span></span><span class=line><span class=cl><span class=s2>  sudo </span><span class=nv>$WGET_CMD</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo tar xvzf </span><span class=nv>$INSTALL_FILE</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo rm </span><span class=nv>$INSTALL_FILE</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo useradd </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  sudo find </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2> -name &#39;*.tgz&#39; -exec tar xzvf {} --directory /opt/splunkforwarder/etc/apps \;
</span></span></span><span class=line><span class=cl><span class=s2>  sudo chown -R </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>:</span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2> /opt/splunkforwarder
</span></span></span><span class=line><span class=cl><span class=s2>  echo \&#34;[user_info] 
</span></span></span><span class=line><span class=cl><span class=s2>  USERNAME = admin
</span></span></span><span class=line><span class=cl><span class=s2>  PASSWORD = </span><span class=nv>$PASSWORD</span><span class=s2>\&#34; &gt; /opt/splunkforwarder/etc/system/local/user-seed.conf   
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo cp </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2>/*.tgz /opt/splunkforwader/etc/apps/
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo find /opt/splunkforwarder/etc/apps/ -name &#39;*.tgz&#39; -exec tar xzvf {} \;
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo -u splunk /opt/splunkforwarder/bin/splunk start --accept-license --answer-yes --auto-ports --no-prompt
</span></span></span><span class=line><span class=cl><span class=s2>  /opt/splunkforwarder/bin/splunk start --accept-license --answer-yes --auto-ports --no-prompt
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo /opt/splunkforwarder/bin/splunk enable boot-start -user </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  /opt/splunkforwarder/bin/splunk enable boot-start -user </span><span class=nv>$SPLUNK_RUN_USER</span><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  #sudo cp </span><span class=nv>$TA_INSTALL_DIRECTORY</span><span class=s2>/*.tgz /opt/splunkforwarder/etc/apps/
</span></span></span><span class=line><span class=cl><span class=s2>
</span></span></span><span class=line><span class=cl><span class=s2>  exit
</span></span></span><span class=line><span class=cl><span class=s2> &#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>DIR</span><span class=o>=</span><span class=s2>&#34;</span><span class=k>$(</span> <span class=nb>cd</span> <span class=s2>&#34;</span><span class=k>$(</span> dirname <span class=s2>&#34;</span><span class=si>${</span><span class=nv>BASH_SOURCE</span><span class=p>[0]</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>)</span><span class=s2>&#34;</span> &gt;/dev/null <span class=o>&amp;&amp;</span> <span class=nb>pwd</span> <span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#===============================================================================================</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;In 5 seconds, will run the following script on each remote host:&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;====================&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$REMOTE_SCRIPT_DEPLOY</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;====================&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> 
</span></span><span class=line><span class=cl>  sleep <span class=m>5</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Reading host logins from </span><span class=nv>$HOSTS_FILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Starting.&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> DST in <span class=sb>`</span>cat <span class=s2>&#34;</span><span class=nv>$DIR</span><span class=s2>/</span><span class=nv>$HOSTS_FILE</span><span class=s2>&#34;</span><span class=sb>`</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -z <span class=s2>&#34;</span><span class=nv>$DST</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>      <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;---------------------------&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Installing to </span><span class=nv>$DST</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;Initial UF deployment&#34;</span>
</span></span><span class=line><span class=cl>    sudo ssh -t <span class=s2>&#34;</span><span class=nv>$DST</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$REMOTE_SCRIPT_DEPLOY</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>  <span class=k>done</span>  
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;---------------------------&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Done&#34;</span>
</span></span><span class=line><span class=cl>  <span class=nb>echo</span> <span class=s2>&#34;Please use the following app folder name to override deploymentclient.conf options: </span><span class=nv>$DEPLOY_APP_FOLDER_NAME</span><span class=s2>&#34;</span></span></span></code></pre></div><h3 id=3-run-the-install-script>3. Run the install script</h3><p>We will run the install script now. You will see some Warnings at the end. This is totally normal. The script is built for use on remote machines, however for todays lab you will be using localhost.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./install.sh</span></span></code></pre></div><p>You will be asked <code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code>
Answer Yes.</p><p>Enter your ssh password when prompted.</p><h3 id=4-verify-installation-of-the-universal-forwarader>4. Verify installation of the Universal Forwarader</h3><ul><li>We need to verify that the Splunk Universal Forwarder is installed and running.<ul><li>You should see a couple PID&rsquo;s return and a &ldquo;Splunk is currently running.&rdquo; message.</li></ul></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/opt/splunkforwarder/bin/splunk status</span></span></code></pre></div><h4 id=5-configure-the-universal-forwarder-to-send-data-to-splunk-enterprise>5. Configure the Universal Forwarder to Send Data to Splunk Enterprise</h4><ul><li>We will be able to send the data to our Splunk Enterprise environment easily by entering one line into the cli.<ul><li><a href=https://docs.splunk.com/Documentation/Forwarder/9.0.3/Forwarder/Configuretheuniversalforwarder target=_blank>Universal Forwarder Config Guide</a></li></ul></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/opt/splunkforwarder/bin/splunk add forward-server &lt;your_splunk_enterprise_ip&gt;:9997</span></span></code></pre></div><h4 id=6-verify-the-data-in-your-splunk-enterprise-environment>6. Verify the Data in Your Splunk Enterprise Environment</h4><ul><li><p>We are now going to take a look at the Splunk Enterprise environment to verify logs are coming in.</p><ul><li>Logs will be coming into <code>index=main</code></li></ul></li><li><p>Open your web browser and navigate to: <code>http://&lt;your_splunk_enterprise_ip:8000</code></p><ul><li>You will use the credentials <code>admin:&lt;your_ssh_password></code></li></ul></li><li><p>In the search bar, type in the following:</p></li><li><p><code>index=main host=&lt;your_host_name></code></p></li><li><p>You should see data from your host. Take note of the interesting fields and the different data sources flowing in.</p></li></ul><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=monitoring-horizontal-pod-autoscaling-in-kubernetes>Monitoring Horizontal Pod Autoscaling in Kubernetes</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
45 minutes</button></span><p>This workshop will equip you with the basic understanding of monitoring Kubernetes using the Splunk OpenTelemetry Collector. During the workshop you will deploy PHP/Apache and a load generator.</p><p>You will learn about OpenTelemetry Receivers, Kubernetes Namespaces, ReplicaSets, Kubernetes Horizontal Pod AutoScaling and how to monitor all this using the Splunk Observability Cloud. The main learnings from the workshop will be a better understanding of the Kubernetes Navigator (and Dashboards) in Splunk Observability Cloud as well as seeing Kubernetes metrics, events and Detectors.</p><p>For this workshop Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you.</p><p>To get access to the instance that you will be using in the workshop, please visit the URL provided by the workshop leader.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Monitoring Horizontal Pod Autoscaling in Kubernetes</h1><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-collector-in-kubernetes-using-a-namespace>Deploying the OpenTelemetry Collector in Kubernetes using a NameSpace</h1><h2 id=1-kubernetes-navigator-20-ui>1. Kubernetes Navigator 2.0 UI</h2><p>We will be starting this workshop using the new Kubernetes Navigator so please check that you are already using the new Navigator.</p><p>When you select <strong>Infrastructure</strong> from the main menu on the left, followed by selecting <strong>Kubernetes</strong>, you should see two service panes (<strong>K8s nodes</strong> and <strong>K8s workloads</strong>) for Kubernetes, similar to the ones below:</p><p><a href=#R-image-af23f780a641df2785a29acf098fee29 class=lightbox-link><img src=../en/other/hpa/1-deploy-otel/../images/k8s-nav2-two.png alt=k8s-navi-v-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af23f780a641df2785a29acf098fee29><img src=../en/other/hpa/1-deploy-otel/../images/k8s-nav2-two.png alt=k8s-navi-v-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-connect-to-ec2-instance>2. Connect to EC2 instance</h2><p>You will be able to connect to the workshop instance by using SSH from your Mac, Linux or Windows device. Open the link to the sheet provided by your instructor. This sheet contains the IP addresses and the password for the workshop instances.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>Your workshop instance has been pre-configured with the correct <strong>Access Token</strong> and <strong>Realm</strong> for this workshop. There is no need for you to configure these.</p></div></div><h2 id=3-namespaces-in-kubernetes>3. Namespaces in Kubernetes</h2><p>Most of our customers will make use of some kind of private or public cloud service to run Kubernetes. They often choose to have only a few large Kubernetes clusters as it is easier to manage centrally.</p><p>Namespaces are a way to organize these large Kubernetes clusters into virtual sub-clusters. This can be helpful when different teams or projects share a Kubernetes cluster as this will give them the easy ability to just see and work with their resources.</p><p>Any number of namespaces are supported within a cluster, each logically separated from others but with the ability to communicate with each other. Components are only <strong>visible</strong> when selecting a namespace or when adding the <code>--all-namespaces</code> flag to <code>kubectl</code> instead of allowing you to view just the components relevant to your project by selecting your namespace.</p><p>Most customers will want to install the Splunk OpenTelemetry Collector into a separate namespace. This workshop will follow that best practice.</p><h2 id=4-install-splunk-otel-using-helm>4. Install Splunk OTel using Helm</h2><p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository and update.</p><div class=tab-panel data-tab-group=d15a3dfd0fedb914e8ccc2e3de4d3c2c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-repo-add class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("d15a3dfd0fedb914e8ccc2e3de4d3c2c","helm-repo-add")'>
<span class=tab-nav-text>helm repo add</span></button>
<button data-tab-item=helm-repo-add-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d15a3dfd0fedb914e8ccc2e3de4d3c2c","helm-repo-add-output")'>
<span class=tab-nav-text>helm repo add output</span></button></div><div class=tab-content-container><div data-tab-item=helm-repo-add class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div data-tab-item=helm-repo-add-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>&#34;splunk-otel-collector-chart&#34; has been added to your repositories
</span></span><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>Hang tight while we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
</span></span><span class=line><span class=cl>Update Complete. ‚éàHappy Helming!‚éà</span></span></code></pre></div></div></div></div></div><p>Install the OpenTelemetry Collector Helm chart into a new <strong>splunk</strong> namespace with the following commands, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=fcdc48b36bc7e0ffaa6d8936b92787db><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-install class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("fcdc48b36bc7e0ffaa6d8936b92787db","helm-install")'>
<span class=tab-nav-text>helm install</span></button></div><div class=tab-content-container><div data-tab-item=helm-install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.logsEnabled=false&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.infrastructureMonitoringEventsEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--namespace splunk <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--create-namespace <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div></div></div><h2 id=5-verify-deployment>5. Verify Deployment</h2><p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> and adding <code>-n splunk</code> to the command to see the pods in the <code>splunk</code> namespace which should typically report that the new pods are up and running after about 30 seconds.</p><p>Ensure the status is reported as <strong>Running</strong> before continuing.</p><div class=tab-panel data-tab-group=3c2086aebf0c0c3d64770ac8eff24b94><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-get-pods class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3c2086aebf0c0c3d64770ac8eff24b94","kubectl-get-pods")'>
<span class=tab-nav-text>kubectl get pods</span></button>
<button data-tab-item=kubectl-get-pods-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3c2086aebf0c0c3d64770ac8eff24b94","kubectl-get-pods-output")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-get-pods class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -n splunk</span></span></code></pre></div></div></div><div data-tab-item=kubectl-get-pods-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                          READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-pvstb                             2/2     Running   0          19s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6c454894f8-mqs8n   1/1     Running   0          19s</span></span></code></pre></div></div></div></div></div><p>Use the label set by the <code>helm</code> install to tail logs (You will need to press <code>ctrl + c</code> to exit).</p><div class=tab-panel data-tab-group=6d7db93826aa06e7b91ed1a3a68a892d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=kubectl-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("6d7db93826aa06e7b91ed1a3a68a892d","kubectl-logs")'>
<span class=tab-nav-text>kubectl logs</span></button></div><div class=tab-content-container><div data-tab-item=kubectl-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector -n splunk</span></span></code></pre></div></div></div></div></div><p>Or use the installed <code>k9s</code> terminal UI.</p><p><a href=#R-image-3cc19b8e967a6662b3d28c6471864fe4 class=lightbox-link><img src=../en/other/hpa/1-deploy-otel/../images/k9s.png alt=k9s class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3cc19b8e967a6662b3d28c6471864fe4><img src=../en/other/hpa/1-deploy-otel/../images/k9s.png alt=k9s class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Deleting a failed installation</div><div class=box-content><p>If you make an error installing the Splunk OpenTelemetry Collector you can start over by deleting the installation using:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector -n splunk</span></span></code></pre></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=tour-of-the-kubernetes-navigator>Tour of the Kubernetes Navigator</h1><h2 id=1-cluster-vs-workload-view>1. Cluster vs Workload View</h2><p>The Kubernetes Navigator offers you two separate use cases to view your Kubernetes data.</p><ul><li>The <strong>K8s workloads</strong> are focusing on providing information in regards to workloads a.k.a. <em>your deployments</em>.</li><li>The <strong>K8s nodes</strong> are focusing on providing insight into the performance of clusters, nodes, pods and containers.</li></ul><p>You will initially select either view depending on your need (you can switch between the view on the fly if required). The most common one we will use in this workshop is the workload view and we will focus on that specifically.</p><h3 id=11-finding-your-k8s-cluster-name>1.1 Finding your K8s Cluster Name</h3><p>Your first task is to identify and find your cluster. The cluster will be named as determined by the preconfigured environment variable <code>INSTANCE</code>. To confirm the cluster name enter the following command in your terminal:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=nv>$INSTANCE</span>-k3s-cluster</span></span></code></pre></div><p>Please make a note of your cluster name as you will need this later in the workshop for filtering.</p><h2 id=2-workloads--workload-details-pane>2. Workloads & Workload Details Pane</h2><p>Go to the <strong>Infrastructure</strong> page in the Observability UI and select <strong>Kubernetes</strong>, this will offer you a set of Kubernetes services, one of them being the <strong>K8s workloads</strong> pane.</p><p>The pane will show a tiny graph giving you a bird&rsquo;s eye view of the load being handled across those Workloads. Also, if there are any alerts for one of the workloads, you will see a small alert indicator as shown in the image below.</p><p><a href=#R-image-3ea0ec855d237eff40eaa85365cefd7e class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/K8s-Workloads.png alt=k8sWorkloads class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3ea0ec855d237eff40eaa85365cefd7e><img src=../en/other/hpa/2-check-new-navigator-short/../images/K8s-Workloads.png alt=k8sWorkloads class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the <strong>K8s workloads</strong> pane and you will be taken to the workload view.</p><p>Initially, you will see all the workloads for all clusters that are reported into your Observability Cloud Org. If an alert has fired for any of the workloads, it will be highlighted on the top right (as marked with a red stripe) in the image below. You can go directly to the alert by clicking it to expand it.</p><p><a href=#R-image-0cdcaa33d173488026f61610626ef781 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-screen.png alt=Workloads class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0cdcaa33d173488026f61610626ef781><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-screen.png alt=Workloads class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now, let&rsquo;s find your cluster by filtering on the field <code>k8s.cluster.name</code> in the filter toolbar (as marked with a blue stripe).</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>You can enter a partial name into the search box, such as <code>emea-ws-7*</code>, to quickly find your Cluster.</p><p>Also, it&rsquo;s a very good idea to switch the default time from the default <strong>-3h</strong> back to the last 15 minutes (<strong>-15m</strong>).</p></div></div><p><a href=#R-image-1ab7241676f32be314b8660dddd2c6a5 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-filter.png alt=Workloads class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1ab7241676f32be314b8660dddd2c6a5><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-filter.png alt=Workloads class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now just see information for your own cluster.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>How many workloads are running & how many namespaces are in your Cluster?</p></div></div><h3 id=21-using-the-navigator-selection-chart>2.1 Using the Navigator Selection Chart</h3><p>The <strong>K8s workloads</strong> table is a common feature used across most of the Navigators and will offer you a list view of the data you are viewing. In our case, it shows a list of <code>Pods Failed</code> grouped by <code>k8s.namespace.name</code>.</p><p><a href=#R-image-62991040104f04491c72f60fa7e44510 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/workload-selection.png alt=k8s-workload-list class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-62991040104f04491c72f60fa7e44510><img src=../en/other/hpa/2-check-new-navigator-short/../images/workload-selection.png alt=k8s-workload-list class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now let&rsquo;s change the list view to a heat map view by selecting either the Heat map icon or the List icon in the upper-right corner of the screen (as marked with the purple line).</p><p>Changing this option will result in the following visualization:</p><p><a href=#R-image-55740448aa2c61dcaf51f62368a6b10e class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/heatmap.png alt=k8s-Heat-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-55740448aa2c61dcaf51f62368a6b10e><img src=../en/other/hpa/2-check-new-navigator-short/../images/heatmap.png alt=k8s-Heat-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In this view, you will note that each workload is now a colored square. These squares will change color according to the <strong>Color by</strong> option you selected, <em>as marked by the first green line</em> in the image above. The colors give a visual indication of health and/or usage. You can check the meaning by hovering over the <strong>legend</strong> exclamation icon <i class="fa-fw fas fa-exclamation-circle"></i>
bottom right of the heatmaps.</p><p>Another valuable option in this screen is <strong>Find Outliers</strong> which provides historical analytics of your clusters based on what is selected in the <strong>Color by</strong> dropdown.</p><p>Now, let&rsquo;s select the <strong>File system usage (bytes)</strong> from the <strong>Color by</strong> drop-down box, then click on the <strong>Find outliers</strong> drop-down <em>as marked by a yellow line</em> in the above image and make sure you change the <strong>Scope</strong> in the dialog to <strong>Per k8s.namespace.name</strong> and <strong>Deviation from Median</strong> as below:</p><p><a href=#R-image-29d847fee730cc346d7bf8dab26b9033 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/set-find-outliers.png alt=k8s-Heat-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-29d847fee730cc346d7bf8dab26b9033><img src=../en/other/hpa/2-check-new-navigator-short/../images/set-find-outliers.png alt=k8s-Heat-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The <strong>Find Outliers</strong> view is very useful when you need to view a selection of your workloads (or any service depending on the Navigator used) and quickly need to figure out if something has changed.</p><p>It will give you fast insight into items (workloads in our case) that are performing differently (both increased or decreased) which helps to make it easier to spot problems.</p><h3 id=22-the-deployment-overview-pane>2.2 The Deployment Overview pane</h3><p>The Deployment Overview pane gives you a quick insight into the status of your deployments. You can see at once if the pods of your deployments are Pending, Running, Succeeded, Failed or in an Unknown state.</p><p><a href=#R-image-eee13b65fc66477abac51e24dd4136a5 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-deployment-overview.png alt=k8s-workload-overview class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eee13b65fc66477abac51e24dd4136a5><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-deployment-overview.png alt=k8s-workload-overview class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><em>Running:</em> Pod is deployed and in a running state</li><li><em>Pending:</em> Waiting to be deployed</li><li><em>Succeeded:</em> Pod has been deployed and completed its job and is finished</li><li><em>Failed:</em> Containers in the pod have run and returned some kind of error</li><li><em>Unknown:</em> Kubernetes isn&rsquo;t reporting any of the known states. (This may be during the starting or stopping of pods, for example).</li></ul><p>You can expand the Workload name by hovering your mouse on it, in case the name is longer than the chart allows.</p><p><a href=#R-image-3f7ac286b7d474af9890cc01390f84cc class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-hover.png alt=k8s-workload-hoover class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f7ac286b7d474af9890cc01390f84cc><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-hover.png alt=k8s-workload-hoover class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To filter to a specific workload, you can click on three dots <strong>&mldr;</strong> next to the workload name in the <strong>k8s.workload.name</strong> column and choose <strong>Filter</strong> from the dropdown box.</p><p><a href=#R-image-5056967cc50bcec053c81c09c4acfc80 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/workload-add-filter.png alt=workload-add-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5056967cc50bcec053c81c09c4acfc80><img src=../en/other/hpa/2-check-new-navigator-short/../images/workload-add-filter.png alt=workload-add-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will add the selected workload to your filters. Try this for the <strong>splunk-otel-collector-k8s-cluster-receiver</strong> workload. It will then list a single workload in the <strong>splunk</strong> namespace.</p><p>The Heat map above will also filter down to a single-colored square. Click on the square to see more information about the workload.</p><p><a href=#R-image-9c93c6e0ac2eebc5ba3e58593ea7e254 class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-detail.png alt=workload-add-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9c93c6e0ac2eebc5ba3e58593ea7e254><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-detail.png alt=workload-add-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What are the CPU request & CPU limit units for the otel-collector?</p></div></div><p>At this point, you can drill into the information of the pods, but that is outside the scope of this workshop, for now reset your view by removing the filter for the <strong>splunk-otel-collector-k8s-cluster-receiver</strong> workload and setting the <strong>Color by</strong> option to <strong>Pods Running</strong>.</p><p><a href=#R-image-90db46b9d460fd73b7063b2a4d32bb5f class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-remove-filter.png alt=workload-add-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90db46b9d460fd73b7063b2a4d32bb5f><img src=../en/other/hpa/2-check-new-navigator-short/../images/k8s-workload-remove-filter.png alt=workload-add-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-navigator-sidebar>3. Navigator Sidebar</h2><p>Later in the workshop, you will deploy an Apache server into your cluster which will display an icon in the <strong>Navigator Sidebar</strong>.</p><p>In navigators for Kubernetes, you can track dependent services and containers in the navigator sidebar. To get the most out of the navigator sidebar you configure the services you want to track by configuring an extra dimension called <code>service.name</code>. For this workshop, we have already configured the <code>extraDimensions</code> in the collector configuration for monitoring Apache e.g.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extraDimensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>service.name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><p>The Navigator Sidebar will expand and a link to the discovered service will be added as seen in the image below:</p><p><a href=#R-image-96af9e1ce2c1c286e8d616c940f8ae2d class=lightbox-link><img src=../en/other/hpa/2-check-new-navigator-short/../images/pivotbar.png alt=Pivotbar class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-96af9e1ce2c1c286e8d616c940f8ae2d><img src=../en/other/hpa/2-check-new-navigator-short/../images/pivotbar.png alt=Pivotbar class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will allow for easy switching between Navigators. The same applies to your Apache server instance, it will have a Navigator Sidebar allowing you to quickly jump back to the Kubernetes Navigator.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=deploying-phpapache>Deploying PHP/Apache</h1><h2 id=1--dns-and-services-in-kubernetes>1. DNS and Services in Kubernetes</h2><p>The Domain Name System (DNS) is a mechanism for linking various sorts of information with easy-to-remember names, such as IP addresses. Using a DNS system to translate request names into IP addresses makes it easy for end-users to reach their target domain name effortlessly.</p><p>Most Kubernetes clusters include an internal DNS service configured by default to offer a lightweight approach for service discovery. Even when Pods and Services are created, deleted, or shifted between nodes, built-in service discovery simplifies applications to identify and communicate with services on the Kubernetes clusters.</p><p>In short, the DNS system for Kubernetes will create a DNS entry for each Pod and Service. In general, a Pod has the following DNS resolution:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pod-name.my-namespace.pod.cluster-domain.example</span></span></code></pre></div><p>For example, if a Pod in the <code>default</code> namespace has the Pod name <code>my_pod</code>, and the domain name for your cluster is <code>cluster.local</code>, then the Pod has a DNS name:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.default.pod.cluster.local</span></span></code></pre></div><p>Any Pods exposed by a Service have the following DNS resolution available:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.service-name.my-namespace.svc.cluster-domain.example</span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/ target=_blank><strong>DNS for Service and Pods</strong></a></p><h2 id=2-review-otel-receiver-for-phpapache>2. Review OTel receiver for PHP/Apache</h2><p>Inspect the YAML file <code>~/workshop/k3s/otel-apache.yaml</code> and validate the contents using the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the OpenTelemetry agent to monitor the PHP/Apache deployment.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>smartagent/apache</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; pod.name matches &#34;apache&#34; &amp;&amp; port == 80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>collectd/apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>url</span><span class=p>:</span><span class=w> </span><span class=l>http://php-apache-svc.apache.svc.cluster.local/server-status?auto</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>extraDimensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>service.name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><h2 id=3--observation-rules-in-the-opentelemetry-config>3. Observation Rules in the OpenTelemetry config</h2><p>The above file contains an observation rule for Apache using the OTel <code>receiver_creator</code>. This receiver can instantiate other receivers at runtime based on whether observed endpoints match a configured rule.</p><p>The configured rules will be evaluated for each endpoint discovered. If the rule evaluates to true, then the receiver for that rule will be started as configured against the matched endpoint.</p><p>In the file above we tell the OpenTelemetry agent to look for Pods that match the name <code>apache</code> and have port <code>80</code> open. Once found, the agent will configure an Apache receiver to read Apache metrics from the configured URL. Note, the K8s DNS-based URL in the above YAML for the service.</p><p>To use the Apache configuration, you can upgrade the existing Splunk OpenTelemetry Collector Helm chart to use the <code>otel-apache.yaml</code> file with the following command:</p><div class=tab-panel data-tab-group=f3b7bf21ee8eb605908e61ebad5b4e63><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=helm-upgrade class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("f3b7bf21ee8eb605908e61ebad5b4e63","helm-upgrade")'>
<span class=tab-nav-text>Helm Upgrade</span></button></div><div class=tab-content-container><div data-tab-item=helm-upgrade class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.logsEnabled=false&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;logsEngine=otel&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.infrastructureMonitoringEventsEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--namespace splunk <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> NOTE</div><div class=box-content><p>The <strong>REVISION</strong> number of the deployment has changed, which is a helpful way to keep track of your changes.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Release &#34;splunk-otel-collector&#34; has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Tue Jan 31 16:57:22 2023
</span></span><span class=line><span class=cl>NAMESPACE: splunk
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 2
</span></span><span class=line><span class=cl>TEST SUITE: None</span></span></code></pre></div></div></div><h2 id=4-kubernetes-configmaps>4. Kubernetes ConfigMaps</h2><p>A ConfigMap is an object in Kubernetes consisting of key-value pairs that can be injected into your application. With a ConfigMap, you can separate configuration from your Pods.</p><p>Using ConfigMap, you can prevent hardcoding configuration data. ConfigMaps are useful for storing and sharing non-sensitive, unencrypted configuration information.</p><p>The OpenTelemetry collector/agent uses ConfigMaps to store the configuration of the agent and the K8s Cluster receiver. You can/will always verify the current configuration of an agent after a change by running the following commands:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm -n splunk</span></span></code></pre></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>How many ConfigMaps are used by the collector?</p></div></div><p>When you have a list of ConfigMaps from the namespace, select the one for the <code>otel-agent</code> and view it with the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm splunk-otel-collector-otel-agent -n splunk -o yaml</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> NOTE</div><div class=box-content><p>The option <code>-o yaml</code> will output the content of the ConfigMap in a readable YAML format.</p></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Is the configuration from <code>otel-apache.yaml</code> visible in the ConfigMap for the collector agent?</p></div></div><h2 id=5-review-phpapache-deployment-yaml>5. Review PHP/Apache deployment YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/php-apache.yaml</code> and validate the contents using the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the PHP/Apache deployment and will create a new StatefulSet with a single replica of the PHP/Apache image.</p><p>A stateless application does not care which network it is using, and it does not need permanent storage. Examples of stateless apps may include web servers such as Apache, Nginx, or Tomcat.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>updateStrategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;php-apache-svc&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/splunk/php-apache:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;9Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache-svc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><h2 id=6-deploy-phpapache>6. Deploy PHP/Apache</h2><p>Create an <code>apache</code> namespace then deploy the PHP/Apache application to the cluster.</p><p>Create the <code>apache</code> namespace:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create namespace apache</span></span></code></pre></div><p>Deploy the PHP/Apache application:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><p>Ensure the deployment has been created:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get statefulset -n apache</span></span></code></pre></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What metrics for your Apache instance are being reported in the Apache Navigator?</p><p><strong>Tip:</strong> Use the Navigator Sidebar and click on the service name.</p></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Using Log Observer what is the issue with the PHP/Apache deployment?</p><p><strong>Tip:</strong> Adjust your <strong>Table settings</strong> by clicking on the cog to use only <code>object.involvedObject.name</code>, <code>object.message</code> and <code>k8s.cluster.name</code>. Make sure you unselect <code>_raw</code>!</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=fix-phpapache-issue>Fix PHP/Apache Issue</h1><h2 id=1-kubernetes-resources>1. Kubernetes Resources</h2><p>Especially in Production Kubernetes Clusters, CPU and Memory are considered precious resources. Cluster Operators will normally require you to specify the amount of CPU and Memory your Pod or Service will require in the deployment, so they can have the Cluster automatically manage on which Node(s) your solution will be placed.</p><p>You do this by placing a Resource section in the deployment of your application/Pod</p><p><strong>Example:</strong></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>         </span><span class=c># Maximum amount of CPU &amp; memory for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>      </span><span class=c># Maximum of 8 cores of CPU allowed at for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;9Mi&#34;</span><span class=w> </span><span class=c># Maximum allowed 9Mb of memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>       </span><span class=c># Request are the expected amount of CPU &amp; memory for normal use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>      </span><span class=c># Requesting 4 cores of a CPU</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w> </span><span class=c># Requesting 4Mb of memory</span></span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/ target=_blank><strong>Resource Management for Pods and Containers</strong></a></p><p>If your application or Pod will go over the limits set in your deployment, Kubernetes will kill and restart your Pod to protect the other applications on the Cluster.</p><p>Another scenario that you will run into is when there is not enough Memory or CPU on a Node. In that case, the Cluster will try to reschedule your Pod(s) on a different Node with more space.</p><p>If that fails, or if there is not enough space when you deploy your application, the Cluster will put your workload/deployment in schedule mode until there is enough room on any of the available Nodes to deploy the Pods according to their limits.</p><h2 id=2-fix-phpapache-deployment>2. Fix PHP/Apache Deployment</h2><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Before we start, let&rsquo;s check the current status of the PHP/Apache deployment. Under <strong>Alerts & Detectors</strong> which detector has fired? Where else can you find this information?</p></div></div><p>To fix the PHP/Apache StatefulSet, edit <code>~/workshop/k3s/php-apache.yaml</code> using the following commands to reduce the CPU resources:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>Find the resources section and reduce the CPU limits to <strong>1</strong> and the CPU requests to <strong>0.5</strong>:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;9Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span></span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><p>Now, we must delete the existing StatefulSet and re-create it. StatefulSets are immutable, so we must delete the existing one and re-create it with the new changes.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete statefulset php-apache -n apache</span></span></code></pre></div><p>Now, deploy your changes:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><h2 id=3-validate-the-changes>3. Validate the changes</h2><p>You can validate the changes have been applied by running the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><p>Validate the Pod is now running in Splunk Observability Cloud.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Is the <strong>Apache Web Servers</strong> dashboard showing any data now?</p><p><strong>Tip:</strong> Don&rsquo;t forget to use filters and time frames to narrow down your data.</p></div></div><p>Monitor the Apache web servers Navigator dashboard for a few minutes.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What is happening with the # Hosts reporting chart?</p></div></div><h2 id=4-fix-the-memory-issue>4. Fix the memory issue</h2><p>If you navigate back to the Apache dashboard, you will notice that metrics are no longer coming in. We have another resource issue and this time we are Out of Memory. Let&rsquo;s edit the stateful set and increase the memory to what is shown in the image below:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit statefulset php-apache -n apache</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>16Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>500m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>12Mi</span></span></span></code></pre></div><p>Save the changes you have made.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-exclamation"></i> Hint</div><div class=box-content><p><code>kubectl edit</code> will open the contents in the <code>vi</code> editor, use <code>Esc</code> followed by <code>:wq!</code> to save your changes.</p></div></div><p>Because StatefulSets are immutable, we must delete the existing Pod and let the StatefulSet re-create it with the new changes.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete pod php-apache-0 -n apache</span></span></code></pre></div><p>Validate the changes have been applied by running the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=deploy-load-generator>Deploy Load Generator</h1><p>Now let&rsquo;s apply some load against the <code>php-apache</code> pod. To do this, you will need to start a different Pod to act as a client. The container within the client Pod runs in an infinite loop, sending HTTP GETs to the <code>php-apache</code> service.</p><h2 id=1-review-loadgen-yaml>1. Review loadgen YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/loadgen.yaml</code> and validate the contents using the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/loadgen.yaml</span></span></code></pre></div><p>This file contains the configuration for the load generator and will create a new ReplicaSet with two replicas of the load generator image.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ReplicaSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>infinite-calls</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>/bin/sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;while true; do wget -q -O- http://php-apache-svc.apache.svc.cluster.local; done&#34;</span></span></span></code></pre></div><h2 id=2-create-a-new-namespace>2. Create a new namespace</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl create namespace loadgen</span></span></code></pre></div><h2 id=3-deploy-the-loadgen-yaml>3. Deploy the loadgen YAML</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/loadgen.yaml --namespace loadgen</span></span></code></pre></div><p>Once you have deployed the load generator, you can see the Pods running in the <code>loadgen</code> namespace. Use previous similar commands to check the status of the Pods from the command line.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Which metrics in the Apache Navigator have now significantly increased?</p></div></div><h2 id=4-scale-the-load-generator>4. Scale the load generator</h2><p>A ReplicaSet is a process that runs multiple instances of a Pod and keeps the specified number of Pods constant. Its purpose is to maintain the specified number of Pod instances running in a cluster at any given time to prevent users from losing access to their application when a Pod fails or is inaccessible.</p><p>ReplicaSet helps bring up a new instance of a Pod when the existing one fails, scale it up when the running instances are not up to the specified number, and scale down or delete Pods if another instance with the same label is created. A ReplicaSet ensures that a specified number of Pod replicas are running continuously and helps with load-balancing in case of an increase in resource usage.</p><p>Let&rsquo;s scale our ReplicaSet to 4 replicas using the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl scale replicaset/loadgen --replicas 4 -n loadgen</span></span></code></pre></div><p>Validate the replicas are running from both the command line and Splunk Observability Cloud:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get replicaset loadgen -n loadgen</span></span></code></pre></div><p><a href=#R-image-aa2ebe3348b4a6abd25e4c69c82ee56f class=lightbox-link><img src=../en/other/hpa/5-deploy-loadgen/../images/k8s-workload-replicaset.png alt=ReplicaSet class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa2ebe3348b4a6abd25e4c69c82ee56f><img src=../en/other/hpa/5-deploy-loadgen/../images/k8s-workload-replicaset.png alt=ReplicaSet class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What impact can you see in the Apache Navigator?</p></div></div><p>Let the load generator run for around 2-3 minutes and keep observing the metrics in the Kubernetes Navigator and the Apache Navigator.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=setup-horizontal-pod-autoscaling-hpa>Setup Horizontal Pod Autoscaling (HPA)</h1><p>In Kubernetes, a HorizontalPodAutoscaler automatically updates a workload resource (such as a Deployment or StatefulSet), to automatically scale the workload to match demand.</p><p>Horizontal scaling means that the response to increased load is to deploy more Pods. This is different from vertical scaling, which for Kubernetes would mean assigning more resources (for example: memory or CPU) to the Pods that are already running for the workload.</p><p>If the load decreases, and the number of Pods is above the configured minimum, the HorizontalPodAutoscaler instructs the workload resource (the Deployment, StatefulSet, or other similar resource) to scale back down.</p><h2 id=1-setup-hpa>1. Setup HPA</h2><p>Inspect the <code>~/workshop/k3s/hpa.yaml</code> file and validate the contents using the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><p>This file contains the configuration for the Horizontal Pod Autoscaler and will create a new HPA for the <code>php-apache</code> deployment.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>autoscaling/v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>HorizontalPodAutoscaler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>50</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>75</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><p>Once deployed, <code>php-apache</code> will autoscale when either the average CPU usage goes above 50% or the average memory usage for the deployment goes above 75%, with a minimum of 1 pod and a maximum of 4 pods.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><h2 id=2-validate-hpa>2. Validate HPA</h2><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get hpa -n apache</span></span></code></pre></div><p>Go to the <strong>Workloads</strong> or <strong>Node Detail</strong> tab in Kubernetes and check the HPA deployment.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>How many additional <code>php-apache-x</code> pods have been created?</p></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Which metrics in the Apache Navigator have significantly increased again?</p></div></div><h2 id=3-increase-the-hpa-replica-count>3. Increase the HPA replica count</h2><p>Increase the <code>maxReplicas</code> to 8</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit hpa php-apache -n apache</span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Questions</div><div class=box-content><ol><li><p>How many pods are now running?</p></li><li><p>How many are pending?</p></li><li><p>Why are they pending?</p></li></ol></div></div><p><strong>Congratulations!</strong> You have completed the workshop.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=build-a-distributed-trace-in-lambda-and-kinesis>Build a Distributed Trace in Lambda and Kinesis</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
45 minutes</button></span><p>This workshop will equip you with how a distributed trace is constructed for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis.</p><p>We will see how auto-instrumentation works with manual steps to force a Producer function&rsquo;s context to be sent to Consumer function via a Record put on a Kinesis stream.</p><p>For this workshop Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you.</p><p>To get access to the instance that you will be using in the workshop, please visit the URL provided by the workshop leader.d</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Build a Distributed Trace in Lambda and Kinesis</h1><article class=default><header class=headline></header><h1 id=setup>Setup</h1><p>This lab will make a tracing superhero out of you!</p><p>In this lab you will learn how a distributed trace is constructed for a small serverless application that runs on AWS Lambda, producing and consuming your message via AWS Kinesis.</p><p><a href=#R-image-b0a6ceb6b7540359a0a4e630a2a54180 class=lightbox-link><img src=../en/other/lambda-kinesis/1-setup/../images/1-architecture.png alt=1-architecture class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0a6ceb6b7540359a0a4e630a2a54180><img src=../en/other/lambda-kinesis/1-setup/../images/1-architecture.png alt=1-architecture class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=pre-requisites>Pre-requisites</h2><p>You should already have the lab content available on your EC2 lab host.</p><p>Ensure that this lab&rsquo;s required folder o11y-lambda-lab is on your home directory:</p><div class=tab-panel data-tab-group=52d842f5405b2e6fc5660fb6d029ffd3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("52d842f5405b2e6fc5660fb6d029ffd3","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("52d842f5405b2e6fc5660fb6d029ffd3","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~ <span class=o>&amp;&amp;</span> ls</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>o11y-lambda-lab</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>If you don&rsquo;t see it, fetch the lab contents by running the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/kdroukman/o11y-lambda-lab.git</span></span></code></pre></div></div></div><h2 id=set-environment-variables>Set Environment Variables</h2><p>In your Splunk Observability Cloud Organisation (Org) obtain your Access Token and Realm Values.</p><p>Please reset your environment variables from the earlier lab. Take care that for this lab we may be using different names - make sure to match the Environment Variable names below.</p><div class=tab-panel data-tab-group=1c28bffd205b6baf3d18589c9358208d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-environment-variables class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("1c28bffd205b6baf3d18589c9358208d","export-environment-variables")'>
<span class=tab-nav-text>Export Environment Variables</span></button></div><div class=tab-content-container><div data-tab-item=export-environment-variables class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>export ACCESS_TOKEN</span><span class=o>=</span><span class=s>CHANGE_ME \</span>
</span></span><span class=line><span class=cl><span class=na>export REALM</span><span class=o>=</span><span class=s>CHANGE_ME \</span>
</span></span><span class=line><span class=cl><span class=na>export PREFIX</span><span class=o>=</span><span class=s>$INSTANCE</span></span></span></code></pre></div></div></div></div></div><h2 id=update-auto-instrumentation-serverless-template>Update Auto-instrumentation serverless template</h2><p>Update your auto-instrumentation Serverless template to include new values from the Enviornment variables.</p><div class=tab-panel data-tab-group=e948058c18f6081892e847183d3224d4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=substitute-environment-variables class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("e948058c18f6081892e847183d3224d4","substitute-environment-variables")'>
<span class=tab-nav-text>Substitute Environment Variables</span></button></div><div class=tab-content-container><div data-tab-item=substitute-environment-variables class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-lab/auto/serverless_unset.yml <span class=p>|</span> envsubst &gt; ~/o11y-lambda-lab/auto/serverless.yml</span></span></code></pre></div></div></div></div></div><p>Examine the output of the updated serverless.yml contents (you may need to scroll up to the relevant section).</p><div class=tab-panel data-tab-group=747d86fa6c12976d4074fd0d14fbbefb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=check-file-contents class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("747d86fa6c12976d4074fd0d14fbbefb","check-file-contents")'>
<span class=tab-nav-text>Check file contents</span></button>
<button data-tab-item=expected-content class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("747d86fa6c12976d4074fd0d14fbbefb","expected-content")'>
<span class=tab-nav-text>Expected Content</span></button></div><div class=tab-content-container><div data-tab-item=check-file-contents class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-lab/auto/serverless.yml</span></span></code></pre></div></div></div><div data-tab-item=expected-content class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># USER SET VALUES =====================              </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>custom</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessToken</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Access Token&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>realm</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Realm&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prefix</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Hostname&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#====================================== </span></span></span></code></pre></div></div></div></div></div><h2 id=update-manual-instrumentation-template>Update Manual instrumentation template</h2><p>Update your manual instrumentation Serverless template to include new values from the Enviornment variables.</p><div class=tab-panel data-tab-group=dbf15a1c7786699e12fb037b752ce1aa><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=substitute-environment-variables class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("dbf15a1c7786699e12fb037b752ce1aa","substitute-environment-variables")'>
<span class=tab-nav-text>Substitute Environment Variables</span></button></div><div class=tab-content-container><div data-tab-item=substitute-environment-variables class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-lab/manual/serverless_unset.yml <span class=p>|</span> envsubst &gt; ~/o11y-lambda-lab/manual/serverless.yml</span></span></code></pre></div></div></div></div></div><p>Examine the output of the updated serverless.yml contents (you may need to scroll up to the relevant section).</p><div class=tab-panel data-tab-group=3fb2607363342ebc5d29f35716556180><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=check-file-contents class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3fb2607363342ebc5d29f35716556180","check-file-contents")'>
<span class=tab-nav-text>Check file contents</span></button>
<button data-tab-item=expected-content class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3fb2607363342ebc5d29f35716556180","expected-content")'>
<span class=tab-nav-text>Expected Content</span></button></div><div class=tab-content-container><div data-tab-item=check-file-contents class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/o11y-lambda-lab/manual/serverless.yml</span></span></code></pre></div></div></div><div data-tab-item=expected-content class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># USER SET VALUES =====================              </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>custom</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessToken</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Access Token&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>realm</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Realm&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prefix</span><span class=p>:</span><span class=w> </span><span class=l>&lt;updated to your Hostname&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#====================================== </span></span></span></code></pre></div></div></div></div></div><h2 id=set-your-aws-credentials>Set your AWS Credentials</h2><p>You will be provided with AWS Access Key ID and AWS Secret Access Key values - substitue these values in place of AWS_ACCESS_KEY_ID and AWS_ACCESS_KEY_SECRET in the bellow command:</p><div class=tab-panel data-tab-group=7e8d2cb94da272a1e5dfe87aae079296><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=set-aws-credentials class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7e8d2cb94da272a1e5dfe87aae079296","set-aws-credentials")'>
<span class=tab-nav-text>Set AWS Credentials</span></button></div><div class=tab-content-container><div data-tab-item=set-aws-credentials class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls config credentials --provider aws --key AWS_ACCCESS_KEY_ID --secret AWS_ACCESS_KEY_SECRET</span></span></code></pre></div></div></div></div></div><p>This command will create a file <code>~/.aws/credentials</code> with your AWS Credentials populated.</p><p>Note that we are using sls here, which is a Serverless framework for developing and deploying AWS Lambda functions. We will be using this command throughout the lab.</p><p>Now you are set up and ready go!</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=auto-instrumentation>Auto-Instrumentation</h1><h2 id=auto-instrumentation>Auto-Instrumentation</h2><p>Navigate to the auto directory that contains auto-instrumentation code.</p><div class=tab-panel data-tab-group=b8ec27c2ef593f040f706dd029c1b215><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("b8ec27c2ef593f040f706dd029c1b215","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>cd ~/o11y-lambda-lab/auto</code></pre></div></div></div></div></div><p>Inspect the contents of the files in this directory. Take a look at the serverless.yml template.</p><div class=tab-panel data-tab-group=9380797f51a7956fc143e0b4418c49d4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("9380797f51a7956fc143e0b4418c49d4","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>cat serverless.yml</code></pre></div></div></div></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><ul><li>Can you identify which AWS entities are being created by this template?</li><li>Can you identify where OpenTelemetry instrumentation is being set up?</li><li>Can you determine which instrumentation information is being provided by the Environment Variables?</li></ul></div></div><p>You should see the Splunk OpenTelemetry Lambda layer being added to each fuction.</p><div class="wrap-code highlight"><pre tabindex=0><code>layers:
      - arn:aws:lambda:us-east-1:254067382080:layer:splunk-apm:70</code></pre></div><p>You can see the relevant layer ARNs (Amazon Resource Name) and latest versions for each AWS region here: <a href=https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md target=_blank>https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md</a></p><p>You should also see a section where the Environment variables that are being set.</p><div class="wrap-code highlight"><pre tabindex=0><code>environment:
  AWS_LAMBDA_EXEC_WRAPPER: /opt/nodejs-otel-handler
  OTEL_RESOURCE_ATTRIBUTES: deployment.environment=${self:custom.prefix}-apm-lambda
  OTEL_SERVICE_NAME: consumer-lambda
  SPLUNK_ACCESS_TOKEN: ${self:custom.accessToken}
  SPLUNK_REALM: ${self:custom.realm}</code></pre></div><p>Using the environment variables we are configuring and enriching our auto-instrumentation.</p><p>Here we provide minimum information, such as NodeJS wrapper location in the Splunk APM Layer, environment name, service name, and our Splunk Org credentials. We are sending trace data directly to Splunk Observability Cloud. You could alternatively export traces to an OpenTelemetry Collector set up in Gateway mode.</p><p>Take a look at the function code.</p><div class=tab-panel data-tab-group=fc60f1ee0915c2eff7f2e98a76603276><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("fc60f1ee0915c2eff7f2e98a76603276","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>cat handler.js</code></pre></div></div></div></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><ul><li>Can you identify the code for producer function?</li><li>Can you identify the code for consumer function?</li></ul></div></div><p>Notice there is no mention of Splunk or OpenTelemetry in the code. We are adding the instrumentation using the Lambda layer and Environment Variables only.</p><h2 id=deploy-your-lambdas>Deploy your Lambdas</h2><p>Run the following command to deploy your Lambda Functions:</p><div class=tab-panel data-tab-group=2e93885bccf36faf3b63ffe33bc0390d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("2e93885bccf36faf3b63ffe33bc0390d","deploy-command")'>
<span class=tab-nav-text>Deploy Command</span></button>
<button data-tab-item=expected-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("2e93885bccf36faf3b63ffe33bc0390d","expected-output")'>
<span class=tab-nav-text>Expected Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>sls deploy</code></pre></div></div></div><div data-tab-item=expected-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>Deploying hostname-lambda-lab to stage dev (us-east-1)
...
...
endpoint: POST - https://randomstring.execute-api.us-east-1.amazonaws.com/dev/producer
functions:
  producer: hostname-lambda-lab-dev-producer (1.6 kB)
  consumer: hostname-lambda-lab-dev-consumer (1.6 kB)</code></pre></div></div></div></div></div><p>This command will follow the instructions in your serverless.yml template to create your Lambda functions and your Kinesis stream. Note it may take a 1-2 minutes to execute.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>serverless.yml is in fact a CloudFormation template. CloudFormation is an infrastructure as code service from AWS. You can read more about it here - <a href=https://aws.amazon.com/cloudformation/ target=_blank>https://aws.amazon.com/cloudformation/</a></div></div><p>Check the details of your serverless functions:</p><div class=tab-panel data-tab-group=313af1b1a91da238b06d54f081e6c1d6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("313af1b1a91da238b06d54f081e6c1d6","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>sls info</code></pre></div></div></div></div></div><p>Take note of your endpoint value:
<a href=#R-image-f657fde1fbc7f898e19cb966ae8e6e77 class=lightbox-link><img src=../en/other/lambda-kinesis/2-auto-instrumentation/../images/2-auto-1-endpoint-value.png alt=2-auto-1-endpoint-value class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f657fde1fbc7f898e19cb966ae8e6e77><img src=../en/other/lambda-kinesis/2-auto-instrumentation/../images/2-auto-1-endpoint-value.png alt=2-auto-1-endpoint-value class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=send-some-traffic>Send some Traffic</h2><p>Use the curl command to send a payload to your producer function. Note the command option -d is followed by your message payload.</p><p>Try changing the value of name to your name and telling the Lambda function about your superpower. Replace YOUR_ENDPOINT with the endpoint from your previous step.</p><div class=tab-panel data-tab-group=49fe1de9e66ab50b682c336032117db6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("49fe1de9e66ab50b682c336032117db6","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>curl -d &#39;{ &#34;name&#34;: &#34;CHANGE_ME&#34;, &#34;superpower&#34;: &#34;CHANGE_ME&#34; }&#39; YOUR_ENDPOINT</code></pre></div></div></div></div></div><p>For example:</p><div class="wrap-code highlight"><pre tabindex=0><code>curl -d &#39;{ &#34;name&#34;: &#34;Kate&#34;, &#34;superpower&#34;: &#34;Distributed Tracing&#34; }&#39; https://xvq043lj45.execute-api.us-east-1.amazonaws.com/dev/producer</code></pre></div><p>You should see the following output if your message is successful:</p><div class="wrap-code highlight"><pre tabindex=0><code>{&#34;message&#34;:&#34;Message placed in the Event Stream: hostname-eventSteam&#34;}</code></pre></div><p>If unsuccessful, you will see:</p><div class="wrap-code highlight"><pre tabindex=0><code>{&#34;message&#34;: &#34;Internal server error&#34;}</code></pre></div><p>If this occurs, ask one of the lab facilitators for assistance.</p><p>If you see a success message, generate more load: re-send that messate 5+ times. You should keep seeing a success message after each send.</p><p>Check the lambda logs output:</p><p>Producer function logs:</p><div class=tab-panel data-tab-group=3d7cc0c65dcc911b66f0ef650b793dda><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=producer-function-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3d7cc0c65dcc911b66f0ef650b793dda","producer-function-logs")'>
<span class=tab-nav-text>Producer Function Logs</span></button></div><div class=tab-content-container><div data-tab-item=producer-function-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>sls logs -f producer</code></pre></div></div></div></div></div><p>Consumer function logs:</p><div class=tab-panel data-tab-group=07455edda0431edb364ae3afbba6e80e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=consumer-function-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("07455edda0431edb364ae3afbba6e80e","consumer-function-logs")'>
<span class=tab-nav-text>Consumer Function Logs</span></button></div><div class=tab-content-container><div data-tab-item=consumer-function-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0><code>sls logs -f consumer</code></pre></div></div></div></div></div><p>Examine the logs carefully.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Do you see OpenTelemetry being loaded? Look out for lines with splunk-extension-wrapper.</p></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=lambdas-in-splunk-apm>Lambdas in Splunk APM</h1><h2 id=lambdas-in-splunk-apm>Lambdas in Splunk APM</h2><p>Now it&rsquo;s time to check how your Lambda traffic has been captured in Splunk APM.</p><h2 id=navigate-to-your-splunk-observability-cloud>Navigate to your Splunk Observability Cloud</h2><p>Select APM from the Main Menu and then select your APM Environment. Your APM environment should be in the format <code>$INSTANCE-apm-lambda</code> where the hostname value is a four letter name of your lab host. (Check it by looking at your command prompt, or by running <code>echo $INSTANCE</code>).</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>It may take a few minutes for you traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environement name in the list of Envrionments</div></div><p><a href=#R-image-9e85eaeaed619d39cb6e48b931ac55a4 class=lightbox-link><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-1-filter.png alt=3-splunk-1-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9e85eaeaed619d39cb6e48b931ac55a4><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-1-filter.png alt=3-splunk-1-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Go to <code>Explore</code> the Service Map to see the Dependencies between your Lambda Functions.</p><p><a href=#R-image-c68c1e322037f6242d6d247862e60f59 class=lightbox-link><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-2-explore.png alt=3-splunk-2-explore class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c68c1e322037f6242d6d247862e60f59><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-2-explore.png alt=3-splunk-2-explore class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should be able to see the <code>producer-lambda</code> and the call it is making to <code>Kinesis</code> service.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>What about your <code>consumer-lambda</code>?</p></div></div><p><a href=#R-image-bf33f83789bc0e09b710f6c109341672 class=lightbox-link><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-3-map-producer.png alt=3-splunk-3-map-producer class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf33f83789bc0e09b710f6c109341672><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-3-map-producer.png alt=3-splunk-3-map-producer class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click into <code>Traces</code> and examine some traces that container procuder function calls and traces with consumer function calls.</p><p><a href=#R-image-444a357546faab8aa52990b155ac195d class=lightbox-link><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-4-trace-producer.png alt=3-splunk-4-trace-producer.png class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-444a357546faab8aa52990b155ac195d><img src=../en/other/lambda-kinesis/3-lambdas-in-splunk/../images/3-splunk-4-trace-producer.png alt=3-splunk-4-trace-producer.png class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can see the <code>producer-lambda</code> putting a Record on the Kinesis stream. But the action of <code>consumer-function</code> is disconnected!</p><p>This is because the Trace Context is not being propagated.</p><p>This is not something that is supported automatically Out-of-the-Box by Kinesis service at the time of this lab. Our Distributed Trace stops at Kinesis inferred service, and we can&rsquo;t see the propagation any further.</p><p>Not yet&mldr;</p><p>Let&rsquo;s see how we work around this in the next section of this lab.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=manual-instrumentation>Manual Instrumentation</h1><h2 id=manual-instrumentation>Manual Instrumentation</h2><p>Navigate to the manual directory that contains manually instrumentated code.</p><div class=tab-panel data-tab-group=cf6f371be103f418f9beb33319f6824f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("cf6f371be103f418f9beb33319f6824f","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/o11y-lambda-lab/manual</span></span></code></pre></div></div></div></div></div><p>Inspect the contents of the files in this directory. Take a look at the serverless.yml template.</p><div class=tab-panel data-tab-group=84b05ef1593783d0b7a4fb35e801935b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("84b05ef1593783d0b7a4fb35e801935b","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat serverless.yml</span></span></code></pre></div></div></div></div></div><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Do you see any difference from the same file in your auto directory?</p></div></div><p>You can try to compare them with a diff command:</p><div class=tab-panel data-tab-group=e43eb6b11974ddd13ad2a99386934867><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=diff-command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("e43eb6b11974ddd13ad2a99386934867","diff-command")'>
<span class=tab-nav-text>Diff Command</span></button>
<button data-tab-item=expected-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("e43eb6b11974ddd13ad2a99386934867","expected-output")'>
<span class=tab-nav-text>Expected Output</span></button></div><div class=tab-content-container><div data-tab-item=diff-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/o11y-lambda-lab/auto/serverless.yml ~/o11y-lambda-lab/manual/serverless.yml </span></span></code></pre></div></div></div><div data-tab-item=expected-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>19c19
</span></span><span class=line><span class=cl>&lt; #======================================    
</span></span><span class=line><span class=cl>---
</span></span><span class=line><span class=cl>&gt; #======================================   </span></span></code></pre></div></div></div></div></div><p>There is no difference! (Well, there shouldn&rsquo;t be. Ask your lab facilitator to assist you if there is)</p><p>Now compare handler.js it with the same file in auto directory using the diff command:</p><div class=tab-panel data-tab-group=fbaf6d5dd269cfeab110de67eaa8dac0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=diff-command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("fbaf6d5dd269cfeab110de67eaa8dac0","diff-command")'>
<span class=tab-nav-text>Diff Command</span></button></div><div class=tab-content-container><div data-tab-item=diff-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/o11y-lambda-lab/auto/handler.js ~/o11y-lambda-lab/manual/handler.js </span></span></code></pre></div></div></div></div></div><p>Look at all these differences!</p><p>You may wish to view the entire file with <code>cat handler.js</code> command and examine its content.</p><p>Notice how we are now importing some OpenTelemetry libraries directly into our function to handle some of the manual instrumenation tasks we require.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>otelapi</span>  <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@opentelemetry/api&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>otelcore</span> <span class=o>=</span> <span class=nx>require</span><span class=p>(</span><span class=s1>&#39;@opentelemetry/core&#39;</span><span class=p>);</span></span></span></code></pre></div><p>We are using <a href=https://www.npmjs.com/package/@opentelemetry/api target=_blank>https://www.npmjs.com/package/@opentelemetry/api</a> to manipulate the tracing logic in our functions. We are using <a href=https://www.npmjs.com/package/@opentelemetry/core target=_blank>https://www.npmjs.com/package/@opentelemetry/core</a> to access the Propagator objects that we will use to manually propagate our context with.</p><h2 id=inject-trace-context-in-producer-function>Inject Trace Context in Producer Function</h2><p>The below code executes the following steps inside the Producer function:</p><ol><li>Get the current Active Span.</li><li>Create a Propagator.</li><li>Initialize a context carrier object.</li><li>Inject the context of the active span into the carrier object.</li><li>Modify the record we are about to put on our Kinesis stream to include the carrier that will carry the active span&rsquo;s context to the consumer.</li></ol><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>activeSpan</span> <span class=o>=</span> <span class=nx>otelapi</span><span class=p>.</span><span class=nx>trace</span><span class=p>.</span><span class=nx>getSpan</span><span class=p>(</span><span class=nx>otelapi</span><span class=p>.</span><span class=nx>context</span><span class=p>.</span><span class=nx>active</span><span class=p>());</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>propagator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>otelcore</span><span class=p>.</span><span class=nx>W3CTraceContextPropagator</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kd>let</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl><span class=nx>propagator</span><span class=p>.</span><span class=nx>inject</span><span class=p>(</span><span class=nx>otelapi</span><span class=p>.</span><span class=nx>trace</span><span class=p>.</span><span class=nx>setSpanContext</span><span class=p>(</span><span class=nx>otelapi</span><span class=p>.</span><span class=nx>ROOT_CONTEXT</span><span class=p>,</span> <span class=nx>activeSpan</span><span class=p>.</span><span class=nx>spanContext</span><span class=p>()),</span>
</span></span><span class=line><span class=cl>    <span class=nx>carrier</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>otelapi</span><span class=p>.</span><span class=nx>defaultTextMapSetter</span>
</span></span><span class=line><span class=cl>  <span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=s2>&#34;{\&#34;tracecontext\&#34;: &#34;</span> <span class=o>+</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>carrier</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;, \&#34;record\&#34;:&#34;</span> <span class=o>+</span> <span class=nx>event</span><span class=p>.</span><span class=nx>body</span> <span class=o>+</span> <span class=s2>&#34;}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=sb>`Record with Trace Context added: 
</span></span></span><span class=line><span class=cl><span class=sb>  </span><span class=si>${</span><span class=nx>data</span><span class=si>}</span><span class=sb>`</span><span class=p>);</span></span></span></code></pre></div><h2 id=extract-trace-context-in-consumer-function>Extract Trace Context in Consumer Function</h2><p>The bellow code executes the following steps inside the Consumer function:</p><ol><li>Extract the context that we obtained from the Producer into a carrier object.</li><li>Create a Propagator.</li><li>Extract the context from the carrier object in Customer function&rsquo;s parent span context.</li><li>Start a new span with the parent span context.</li><li>Bonus: Add extra attributes to your span, including custom ones with the values from your message!</li><li>Once completed, end the span.</li></ol><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>const</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>tracecontext</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>propagator</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>otelcore</span><span class=p>.</span><span class=nx>W3CTraceContextPropagator</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>parentContext</span> <span class=o>=</span> <span class=nx>propagator</span><span class=p>.</span><span class=nx>extract</span><span class=p>(</span><span class=nx>otelapi</span><span class=p>.</span><span class=nx>ROOT_CONTEXT</span><span class=p>,</span> <span class=nx>carrier</span><span class=p>,</span> <span class=nx>otelapi</span><span class=p>.</span><span class=nx>defaultTextMapGetter</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>otelapi</span><span class=p>.</span><span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>OTEL_SERVICE_NAME</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>span</span> <span class=o>=</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startSpan</span><span class=p>(</span><span class=s2>&#34;Kinesis.getRecord&#34;</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>,</span> <span class=nx>parentContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                         
</span></span><span class=line><span class=cl><span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;span.kind&#34;</span><span class=p>,</span> <span class=s2>&#34;server&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>record</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.name&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl> <span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.superpower&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=o>---</span> <span class=kd>function</span> <span class=nx>does</span> <span class=nx>some</span> <span class=nx>work</span>
</span></span><span class=line><span class=cl> <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span></span></span></code></pre></div><p>Now let&rsquo;s see the difference this makes.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=redeploy-lambdas>Redeploy Lambdas</h1><h2 id=re-deploy-your-lambdas>Re-deploy your Lambdas</h2><p>While remaining in your manual directory, run the following commandd to re-deploy your Lambda Functions:</p><div class=tab-panel data-tab-group=ccf21ca31b9b2940e98439832372987f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-producer-code class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ccf21ca31b9b2940e98439832372987f","deploy-producer-code")'>
<span class=tab-nav-text>Deploy Producer Code</span></button>
<button data-tab-item=expected-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("ccf21ca31b9b2940e98439832372987f","expected-output")'>
<span class=tab-nav-text>Expected Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-producer-code class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls deploy -f producer</span></span></code></pre></div></div></div><div data-tab-item=expected-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Deploying function producer to stage dev (us-east-1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>‚úî Function code deployed (6s)
</span></span><span class=line><span class=cl>Configuration did not change. Configuration update skipped. (6s)</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=7554f762e9ab0f9fec4f25cfe25e11e1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=deploy-consumer-code class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7554f762e9ab0f9fec4f25cfe25e11e1","deploy-consumer-code")'>
<span class=tab-nav-text>Deploy Consumer Code</span></button>
<button data-tab-item=expected-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7554f762e9ab0f9fec4f25cfe25e11e1","expected-output")'>
<span class=tab-nav-text>Expected Output</span></button></div><div class=tab-content-container><div data-tab-item=deploy-consumer-code class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls deploy -f consumer</span></span></code></pre></div></div></div><div data-tab-item=expected-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Deploying function consumer to stage dev (us-east-1)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>‚úî Function code deployed (6s)
</span></span><span class=line><span class=cl>Configuration did not change. Configuration update skipped. (6s)</span></span></code></pre></div></div></div></div></div><p>Note that this deployment now only updates the code changes within the function. Our configuration remains the same.</p><p>Check the details of your serverless functions:</p><div class=tab-panel data-tab-group=23939cd0c535a52bd7448af3c6bd889b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("23939cd0c535a52bd7448af3c6bd889b","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls info</span></span></code></pre></div></div></div></div></div><p>You endpoint value should remain the same:</p><p><a href=#R-image-408870ffd205e437333f7e926ba51712 class=lightbox-link><img src=../en/other/lambda-kinesis/5-redeploy-lambdas/../images/5-redeploy-1-endpoint-value.png alt=5-redeploy-1-endpoint-value class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-408870ffd205e437333f7e926ba51712><img src=../en/other/lambda-kinesis/5-redeploy-lambdas/../images/5-redeploy-1-endpoint-value.png alt=5-redeploy-1-endpoint-value class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=send-some-traffic-again>Send some Traffic again</h2><p>Use the <code>curl</code> command to send a payload to your producer function. Note the command option <code>-d</code> is followed by your message payload.</p><p>Try changing the value of name to your name and telling the Lambda function about your superpower. Replace <code>YOUR_ENDPOINT</code> with the endpoint from your previous step.</p><div class=tab-panel data-tab-group=ef3f09263ebc59508982e52304c0b541><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ef3f09263ebc59508982e52304c0b541","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -d <span class=s1>&#39;{ &#34;name&#34;: &#34;CHANGE_ME&#34;, &#34;superpower&#34;: &#34;CHANGE_ME&#34; }&#39;</span> YOUR_ENDPOINT</span></span></code></pre></div></div></div></div></div><p>For example:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -d <span class=s1>&#39;{ &#34;name&#34;: &#34;Kate&#34;, &#34;superpower&#34;: &#34;Distributed Tracing&#34; }&#39;</span> https://xvq043lj45.execute-api.us-east-1.amazonaws.com/dev/producer</span></span></code></pre></div><p>You should see the following output if your message is successful:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;message&#34;</span><span class=p>:</span><span class=s2>&#34;Message placed in the Event Stream: hostname-eventSteam&#34;</span><span class=p>}</span></span></span></code></pre></div><p>If unsuccessful, you will see:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;message&#34;</span><span class=p>:</span> <span class=s2>&#34;Internal server error&#34;</span><span class=p>}</span></span></span></code></pre></div><p>If this occurs, ask one of the lab facilitators for assistance.</p><p>If you see a success message, generate more load: re-send that messate 5+ times. You should keep seeing a success message after each send.</p><p>Check the lambda logs output:</p><div class=tab-panel data-tab-group=a3c83822244cbb0cebaa86ead9288b56><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=producer-function-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a3c83822244cbb0cebaa86ead9288b56","producer-function-logs")'>
<span class=tab-nav-text>Producer Function Logs</span></button></div><div class=tab-content-container><div data-tab-item=producer-function-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls logs -f producer</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=082f865189bc7e88e41f14a5ab28a1eb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=consumer-function-logs class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("082f865189bc7e88e41f14a5ab28a1eb","consumer-function-logs")'>
<span class=tab-nav-text>Consumer Function Logs</span></button></div><div class=tab-content-container><div data-tab-item=consumer-function-logs class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls logs -f consumer</span></span></code></pre></div></div></div></div></div><p>Examine the logs carefully.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Do you notice the difference?</p></div></div><p>Note that we are logging our Record together with the Trace context that we have added to it. Copy one of the underlined sub-sections of your trace parent context, and save it for later.</p><p><a href=#R-image-93f1e4dedf594fbff6375d75399bc8cc class=lightbox-link><img src=../en/other/lambda-kinesis/5-redeploy-lambdas/../images/5-redeploy-2-logs.png alt=5-redeploy-2-logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93f1e4dedf594fbff6375d75399bc8cc><img src=../en/other/lambda-kinesis/5-redeploy-lambdas/../images/5-redeploy-2-logs.png alt=5-redeploy-2-logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=updated-lambdas-in-splunk-apm>Updated Lambdas in Splunk APM</h1><p>Navigate back to APM in <a href=https://app.us1.signalfx.com/#/apm target=_blank>Splunk Observabilty Cloud</a></p><p>Go back to your Service Dependency map.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Notice the difference?</p></div></div><p><a href=#R-image-4b2c05ad608161dfd20d4a5522dd98a5 class=lightbox-link><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-1-map.png alt=6-updated-1-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4b2c05ad608161dfd20d4a5522dd98a5><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-1-map.png alt=6-updated-1-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should be able to see the <code>consumer-lambda</code> now clearly connected to the <code>producer-lambda</code>.</p><p>Remember the value you copied from your producer logs? You can run <code>sls logs -f consumer</code> command again on your EC2 lab host to fetch one.</p><p>Take that value, and paste it into trace search:</p><p><a href=#R-image-5ab82894ee7fc14f9949f7abe05bb10d class=lightbox-link><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-2-trace-search.png alt=6-updated-2-trace-search class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ab82894ee7fc14f9949f7abe05bb10d><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-2-trace-search.png alt=6-updated-2-trace-search class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on Go and you should be able to find the logged Trace:</p><p><a href=#R-image-faf20109ea1cf92201718c781578e902 class=lightbox-link><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-3-trace.png alt=6-updated-3-trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-faf20109ea1cf92201718c781578e902><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-3-trace.png alt=6-updated-3-trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Notice that the <code>Trace ID</code> is something that makes up the trace context that we propagated.</p><p>You can read up on the two common propagation standards:</p><ol><li>W3C: <a href=https://www.w3.org/TR/trace-context/#traceparent-header target=_blank>https://www.w3.org/TR/trace-context/#traceparent-header</a></li><li>B3: <a href=https://github.com/openzipkin/b3-propagation#overall-process target=_blank>https://github.com/openzipkin/b3-propagation#overall-process</a></li></ol><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Which one are we using?</p></div></div><p>It should be self-explanatory from the Propagator we are creating in the Functions</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Bonus Question: What happens if we mix and match the W3C and B3 headers?</p></div></div><p>Expand the <code>consumer-lambda</code> span.</p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-question"></i> Workshop Question</div><div class=box-content><p>Can you find the attributes from your message?</p></div></div><p><a href=#R-image-daf7a92b3e4e160780df11caff5dc8d9 class=lightbox-link><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-4-attributes.png alt=6-updated-4-attributes class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-daf7a92b3e4e160780df11caff5dc8d9><img src=../en/other/lambda-kinesis/6-updated-in-splunk/../images/6-updated-4-attributes.png alt=6-updated-4-attributes class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=summary>Summary</h1><h2 id=before-you-go>Before you Go</h2><p>Please kindly clean up your lab using the following command:</p><div class=tab-panel data-tab-group=d0e6c2aabfde81167a4aca9536fcb92a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=remove-functions class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("d0e6c2aabfde81167a4aca9536fcb92a","remove-functions")'>
<span class=tab-nav-text>Remove Functions</span></button></div><div class=tab-content-container><div data-tab-item=remove-functions class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sls remove</span></span></code></pre></div></div></div></div></div><h2 id=conclusion>Conclusion</h2><p>Congratuations on finishing the lab. You have seen how we complement auto-instrumentation with manual steps to force <code>Producer</code> function&rsquo;s context to be sent to <code>Consumer</code> function via a Record put on a Kinesis stream. This allowed us to build the expected Distributed Trace.</p><p><a href=#R-image-41e79fd2bd8b8d31ad61ba0a99abc862 class=lightbox-link><img src=../en/other/lambda-kinesis/7-summary/../images/7-conclusion-1-architecture.png alt=7-conclusion-1-architecture class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-41e79fd2bd8b8d31ad61ba0a99abc862><img src=../en/other/lambda-kinesis/7-summary/../images/7-conclusion-1-architecture.png alt=7-conclusion-1-architecture class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can now build out a Trace manually by linking two different functions together. This is very powerful when your auto-instrumenation, or third-party systems, do not support context propagation out of the box.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=improving-mttr-with-custom-tags>Improving MTTR with Custom Tags</h1><span class="btn cstyle transparent"><button type=button>
<i class="fa-fw fas fa-clock"></i>
45 minutes</button></span><p>This workshop will ..</p><p>For this workshop Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you.</p><p>To get access to the instance that you will be using in the workshop, please visit the URL provided by the workshop leader.</p><h2 id=splunk-observability-cloud>Splunk Observability Cloud</h2><p>You must have the ability to send traces to Splunk Observability Cloud. If you do not have an account already, please start a trial here: <a href=https://www.splunk.com/en_us/download/apm-free-trial.html target=_blank>https://www.splunk.com/en_us/download/apm-free-trial.html</a></p><h2 id=workshop-story>Workshop Story</h2><p>Here at Splunk Instruments, our business is expanding!</p><p>We have recently added 3 new locations: Two locations in the USA (Colorado and Chicago) and one international location in Sri Lanka.</p><p>Our technical staff has already on-boarded the data from these new locations and incorporated them into our inventory application and it is our job to review these improvements and send any issues back to our developers for repairs.</p><p>We now have a total of 6 locations!</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Improving MTTR with Custom Tags</h1><article class=default><header class=headline></header><h1 id=setting-up-your-aws-instance>Setting up your AWS Instance</h1><h2 id=environment-setup---mac>Environment Setup - Mac</h2><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>If you wish to run this on Mac directly, you can see the instructions <a href=../en/other/dev-mttr-custom-tags/appendix-a-setup-mac/index.html>here in the appendix</a> and skip the next section on Linux.</p><p>All installs must continue at <a href=../en/other/dev-mttr-custom-tags/2-setup-app/index.html>setting up the app</a>.</p></div></div><h2 id=environment-setup---linux>Environment Setup - Linux</h2><p>You can skip past the EC2 configuration to Linux Software Requirements if you already have an Ec2 that meets the specifications below !!!!</p><ul><li>ubuntu 22.04</li></ul><p><a href=#R-image-46d806f20460eb0da43aebde58e8a41a class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-1.png alt=1-setup-config-1 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-46d806f20460eb0da43aebde58e8a41a><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-1.png alt=1-setup-config-1 class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
<a href=#R-image-cb8cd6f8534f1c53a1b0875738d599bc class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-2.png alt=1-setup-config-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cb8cd6f8534f1c53a1b0875738d599bc><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-2.png alt=1-setup-config-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
<a href=#R-image-dd0eeb82740e8eaa7d6161a48ea93877 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-3.png alt=1-setup-config-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dd0eeb82740e8eaa7d6161a48ea93877><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-3.png alt=1-setup-config-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Security Group Security Settings<ul><li>HTTP inbound open on 8010</li><li>All Traffic open outbound</li></ul></li></ul><p><a href=#R-image-fa4ddf68d7e40e623f287948402b01dd class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-4.png alt=1-setup-config-4 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa4ddf68d7e40e623f287948402b01dd><img src=../en/other/dev-mttr-custom-tags/1-setup-os/../images/1-setup-config-4.png alt=1-setup-config-4 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Linux Software Requirements: docker, docker-compose, git, maven</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt upgrade
</span></span><span class=line><span class=cl>sudo apt install docker docker-compose maven</span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=setting-up-your-application>Setting up your Application</h1><h2 id=environment-setup---application>Environment Setup - Application</h2><ul><li>Clone the workshop repository:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone -b tko-fy24-distributed-tracing https://github.com/shabuhabs/javashop-otel.git</span></span></code></pre></div><ul><li>Access the workshop directory:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> javashop-otel</span></span></code></pre></div><ul><li>Set Environment Variables</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano .env</span></span></code></pre></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><ul><li>NO spaces in &lt;your_name></li><li>The shop_user provides us an Environment Tag.</li><li>To get your access token, go to your Splunk O11y UI -> Settings ->Access Tokens.</li><li>It is assumed in this workshop that you can send traces to the org and token you are using.</li></ul></div></div><ul><li>Set the following values:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>SHOP_USER</span><span class=o>=</span><span class=s>&lt;your_name&gt;</span>
</span></span><span class=line><span class=cl><span class=na>SPLUNK_ACCESS_TOKEN</span><span class=o>=</span><span class=s>&lt;your_token&gt;</span>
</span></span><span class=line><span class=cl><span class=na>SPLUNK_REALM</span><span class=o>=</span><span class=s>&lt;your_realm&gt;</span></span></span></code></pre></div><ul><li>Save in nano with <strong>[CTRL]-o [ENTER]</strong></li><li>Exit nano with <strong>[CTRL]-x</strong></li></ul><h2 id=build-and-deploy-application>Build and Deploy Application</h2><p>Let&rsquo;s get started by building and deploying our Application, the Splunk Instrument Shop. Run the commands below to begin and start reading ahead as your traces are coming up!</p><ul><li>Build the app</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./BuildAndDeploy.sh</span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=overview-of-the-workshop>Overview of the Workshop</h1><h2 id=users-and-workflows>Users and Workflows</h2><p>As we go through this workshop we will be switching roles from SRE to Developer. First we will start with alert responders or SREs who will identify an issue in Splunk Observability UI. Next, we will jump to a Developer Role to see how a Developer will debug and repair/fix a software problem using trace data provided by our SRE.</p><p>Of course, we are not requiring 2 people for this workshop as each participant will play both roles.</p><h2 id=today-we-will-learn>Today we will learn</h2><p>Today we will learn how Splunk APM with Full Fidelity tracing can accelerate the time to repair for Development teams. We will focus on the full fidelity data ( In the form of traces ) that an SRE or alert responder would send to a developer to then repair/fix software. We will do this with both Auto-Instrumentation data and Custom attributes or Custom Tags, via Manual Instrumentation data.</p><p>While we will be spending time Debugging code, &mldr;. Don&rsquo;t worry, &mldr;there is no programming experience necessary, as our goal here is for every participant to understand how using Custom Attributes/Tags in Splunk APM @ Full Fidelity accelerates Mean Time to Repair Software problems for Development Teams.</p><h2 id=important-definitions>Important Definitions</h2><p>Let&rsquo;s define a few terms for those new to APM / Software Development or Java</p><ul><li>What Are Custom Attributes / Custom Tags in Splunk APM ?</li></ul><p>First, you will hear poeple refer to Custom Attributes in the context of Splunk Enterprise, however in Splunk APM Custom Attributes are called Custom Tags as defined in Opentelemetry and shown in Splunk APM Tag Splotlight.</p><ul><li>What is a Function or a method in Java?</li></ul><p>A Function in most languages, including Java, is a logical chunk of code that &ndash; when executed &ndash; solves a repeatable task. This is basically what development teams spend thier time building and where software issues will most commonly be.</p><ul><li>What is an Exception in Java?</li></ul><p>An exception is an exceptional error condition that indicates abonormal behavior, or an unhandled condition, that interrupts program execution abnormally.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=review-apm-in-the-ui>Review APM in the UI</h1><h2 id=view-service-map>View Service Map</h2><p>Next step is open your Observability UI, accessing the proper org ( where you sent the traces to ) and click APM and Access the Environemnnt that matches the username you put in .env.</p><p><a href=#R-image-76de3636978bd5a4da31f375d9b26759 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-1-filter.png alt=4-overview-1-filter class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76de3636978bd5a4da31f375d9b26759><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-1-filter.png alt=4-overview-1-filter class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Please note it may take 4-5 minutes or more for traces to show up and you will see full map &ldquo;form&rdquo; as traces are coming in, so you may have to refresh the page a few times each time we Build and Deploy.</p><p>It is recommended to use a -15m look back during this lab. You may need to change it from time to time (for example to -5m or a custom -10m) to make sure you are only looking at the newer traces after your changes.</p><p>NOTE: You may have to refresh the page several times to see your Environment Tag in the UI. The prefix of the Environment tag should match what you entered for SHOP_USER in the .env file.</p><p><a href=#R-image-6c3f787ac14cd9232242a058a711e70b class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-2-time-window.png alt=4-overview-2-time-window class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6c3f787ac14cd9232242a058a711e70b><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-2-time-window.png alt=4-overview-2-time-window class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>NOTE: Typically, to identify root cause and route an issue, an SRE or alert responder would check metrics and logs to determine if it is a software or hardware related issue, and thus route to the correct party. In this excercise we are ONLY handling software issues, so we are skipping the metrics and logs parts of normal triage.</p><p>If your instrumentation was successful, the service-map will show latency from the shop service to the products service.</p><p><a href=#R-image-61a99811e1f6f28d6d4eaed130615736 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-3-map.png alt=4-overview-3-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61a99811e1f6f28d6d4eaed130615736><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-3-map.png alt=4-overview-3-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Ok let&rsquo;s triage this SOFTWARE ISSUE and skip directly to the traces.</p><ul><li>Click on shop service</li><li>Click Traces (on the right side)</li><li>Sort by Duration</li><li>Select the longest duration trace<ul><li>Or one of the obvious much longer ones</li></ul></li></ul><p><a href=#R-image-3008d834596f2ff35c3ef33fddd37932 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-4-trace.png alt=4-overview-4-trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3008d834596f2ff35c3ef33fddd37932><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-4-trace.png alt=4-overview-4-trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now we can see the long latency occurred in the products service and if we click on <strong>products: /products</strong> we can see the offending method was <strong>products:ProductResource.getAllProducts</strong></p><p><a href=#R-image-cd7493834081c8e241eaa1e7bfa2b72c class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-5-span.png alt=4-overview-5-span class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cd7493834081c8e241eaa1e7bfa2b72c><img src=../en/other/dev-mttr-custom-tags/4-review-apm/../images/4-overview-5-span.png alt=4-overview-5-span class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Our next step here would be to send that trace to a developer by clicking download trace and they will have to debug the function. Since we will be the developer there is no need to download the trace. Just remember that is normal workflow for alert responders to route an issue to the &ldquo;Repairers&rdquo; while providing trace data.</p><p>Before we do that please take note of the Tags available for the developer to leverage to find root cause. We see standard out of the box Otel tags on the span, environmental information, but no indications of data specific to something inside custom code (which is where the problem often is).</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=debugging-101>Debugging 101</h1><h2 id=now-lets-play-the-role-of-the-developer>Now let&rsquo;s play the role of the developer</h2><p>As a developer we must debug the function products:ProductResource.getAllProducts to find the problem.</p><h2 id=debugging-101-the-line-by-line-method>Debugging 101, the Line by Line method</h2><p>Without anything to go on other than &ldquo;BAD FUNCTION&rdquo;, a Developer must then look at code visually line by line to find and fix the problem. To make this worse, <strong>functions call other functions</strong>, and it can get very messy in bad code scenarios.</p><p>We will do the visual inspection mehtod next.</p><ul><li>Using Nano:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano products/src/main/java/com/shabushabu/javashop/products/resources/ProductResource.java</span></span></code></pre></div><ul><li>Search in Nano: <strong>[CTRL]-w</strong></li><li>Enter in: <strong>getAllProducts [Enter]</strong></li><li>You will be taken here:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>  <span class=nd>@GET</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>Response</span> <span class=nf>getAllProducts</span><span class=o>(</span><span class=nd>@DefaultValue</span><span class=o>(</span><span class=s>&#34;California&#34;</span><span class=o>)</span> <span class=nd>@QueryParam</span><span class=o>(</span><span class=s>&#34;location&#34;</span><span class=o>)</span> <span class=n>String</span> <span class=n>location</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1>// STEP X: All we know right now is somewhere in this function, latency was introduced.
</span></span></span><span class=line><span class=cl><span class=c1></span>  
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction1</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction2</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction10</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction13</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction5</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=n>myCoolFunction6</span><span class=o>(</span><span class=n>location</span><span class=o>);</span></span></span></code></pre></div><p>We can see here in getAllProducts, the first call is to <code>myCoolFunction1()</code>, so as may have guessed our next step is to go look at <code>myCoolFunction1()</code>.</p><ul><li>Search in Nano: <strong>[CTRL]-w</strong></li><li>Enter in: myCoolFunction1 <strong>[Enter]</strong></li><li>Find the next occurrence: <strong>[CTRL]-w [Enter]</strong></li><li>Keep repeating <strong>[CTRL]-w [Enter]</strong> until you get to the actual function definition</li></ul><p>It looks like this:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>myCoolFunction1</span><span class=o>(</span><span class=n>String</span> <span class=n>location</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Generate a FAST sleep of 0 time !
</span></span></span><span class=line><span class=cl><span class=c1></span>      <span class=kt>int</span> <span class=n>sleepy</span> <span class=o>=</span> <span class=n>lookupLocation1</span><span class=o>(</span><span class=n>location</span><span class=o>);</span>
</span></span><span class=line><span class=cl>      <span class=k>try</span><span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span><span class=n>sleepy</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span></span></span></code></pre></div><p>Now, <code>myCoolFunction1</code> calls <code>lookupLocation1(location)</code></p><ul><li>Search in Nano: <strong>[CTRL]-w</strong></li><li>Enter in: lookupLocation1 <strong>[Enter]</strong></li></ul><p>I think you get the picture by now, you have no choice but to inspect every line of code and every function called and visually inspect them for problems. This can be a VERY long process and kills our customers Mean Time to Repair. This happens quite often to our customers with our competition beacsue they can&rsquo;t provide all the traces 100% of the time and most can&rsquo;t scale to add more data, via Custom Attributes on top of that!</p><p>Remember, without Full Fidelty, you have to either reproduce errors / latency in another environment or inspect code line by line.</p><p>So they are stuck where we are, quite often.</p><p>OK, enough fun. Let&rsquo;s make this easier for our developer, and show off some Splunk APM Scale!</p><ul><li>Exit your editor:</li><li>Exit nano: <strong>[CTRL]-X</strong></li><li>Optional: If it asks you to save, hit <strong>N</strong></li></ul><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=custom-tags>Custom Tags</h1><h2 id=custom-attribution-custom-tags>Custom Attribution (Custom Tags)</h2><p>To take a deeper look at this issue and make this much easier to debug we will implement Custom Attributes via Opentelemetry Manual Instrumentation.</p><p>To speed up manual instrumentation in Java you can leverage OpenTelemetry Annotations, which automatically create a span around a method without modifying the actual code inside the method. This can be very valuable if you are working with an SRE that may have limited access to source code changes.</p><p>To add even more information to help our developers find the root cause faster, OpenTelemetry Annotations can be used to generate span tags with parameter values for the method in question. This is incredibly important to mean time to Repair, because as a Developer, if I know the parameter values of a function at the time of latency or error, I can debug this without having to reproduce an issue in another environment if I have Full Fidelity Tracing.</p><p>Splunk Full Fidelity APM allows our customers development teams to debug their code as it ran in production, 100% of the time. Add with Custom Attribution, you are providing repeatable Mean Time to Repair reduction&mldr; 100% of the time, only with Full Fidelity tracing.</p><p>To expedite manual instrumentation implementation for this exercise, we have provided a tool which will annotate the entirety of the &ldquo;shop&rdquo; and &ldquo;products&rdquo; services with OpenTelemetry standard annotations for every function call without having to write any code. This &ldquo;annotator&rdquo; tool will also tag every parameter in every function, which adds a span tag with Parameter=Value.</p><ul><li>Run Manual Instrumentation Tool</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./AutomateManualInstrumentation.sh</span></span></code></pre></div><ul><li>Rebuild and Deploy the Application</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./BuildAndDeploy.sh</span></span></code></pre></div><h2 id=visualize-in-splunk-apm>Visualize in Splunk APM</h2><p>Now that we have rebuilt and deployed our application, traffic is being sent once again.</p><p>Go back to the Splunk Observability UI and let&rsquo;s see if these annotations help us narrow down the root cause more quickly.</p><p>Let&rsquo;s try to find our latency root cause again, this time with every function and every parameter spanned and tagged respectively&mldr;. You will see exactly what this means and how it benefits developers in a moment.</p><p><a href=#R-image-2304d7d5b702da780a262b16881881b2 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/6-custom-tags/../images/6-custom-tags-1-apm-map.png alt=6-custom-tags-1-apm-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2304d7d5b702da780a262b16881881b2><img src=../en/other/dev-mttr-custom-tags/6-custom-tags/../images/6-custom-tags-1-apm-map.png alt=6-custom-tags-1-apm-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Click on shop service</li><li>Click Traces ( on the right side )</li><li>Sort by Duration</li><li>Select the longest duration trace ( or one of the obvious much longer ones )</li></ul><p><a href=#R-image-f5f2c6f0985c570587c1744c9bcaf867 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/6-custom-tags/../images/6-custom-tags-2-trace.png alt=6-custom-tags-2-trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5f2c6f0985c570587c1744c9bcaf867><img src=../en/other/dev-mttr-custom-tags/6-custom-tags/../images/6-custom-tags-2-trace.png alt=6-custom-tags-2-trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can see that the actual function call that has the latency was not <code>ProductResource.getAllProducts</code> but the function call <code>ProductResource.myCoolFunction234234234</code>.</p><p>Since we now have the parameter tagged as part of our span metadata the actual root cause is seemingly related to the &ldquo;location&rdquo; <strong>Colorado</strong>. And it appears the one custom attribute that was tagged for function <code>ProductResource.myCoolFunction234234234</code> was <code>myInt</code> with a value of <strong>999</strong>. With this information a developer can debug very quickly.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>We added additional span information, which we call <strong>Custom Attributes</strong> here at Splunk. In this case our <strong>Custom Attributes</strong> are <strong>Parameter Values at Time of Latency</strong>.</p></div></div><p>In our exmaple the <code>myInt</code> tag was created due our handy Annotator, that did the OpenTelemetry Annotations for us.</p><ul><li>Using nano:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano products/src/main/java/com/shabushabu/javashop/products/resources/ProductResource.java</span></span></code></pre></div><ul><li>Search in Nano: <strong>[CTRL]-w</strong></li><li>Enter in: <strong>999 [Enter]</strong></li></ul><p>We can see here, someone wrote some very bad code in the form of a long Sleep!</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>if</span> <span class=o>(</span><span class=mi>999</span><span class=o>==</span><span class=n>myInt</span><span class=o>)</span> 
</span></span><span class=line><span class=cl>    <span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span>
</span></span><span class=line><span class=cl>        <span class=n>sleepy</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>5000</span> <span class=o>-</span> <span class=mi>3000</span><span class=o>)</span> <span class=o>+</span> <span class=mi>3000</span><span class=o>);</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=fixing-code>Fixing Code</h1><h2 id=finding-the-problem>Finding the Problem</h2><p>How did we get here? How did the 999 end up in the trace as a Custom Attribute?</p><p>Take a look at the function signature</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>myCoolFunction234234234</span><span class=o>(</span><span class=nd>@SpanAttribute</span><span class=o>(</span><span class=s>&#34;myInt&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>myInt</span><span class=o>)</span></span></span></code></pre></div><p><code>@SpanAttribute("myint")</code> is an OpenTelemetry Annotation that was added by our Java Otel Annotator tool.</p><h2 id=fixing-the-code>Fixing the code</h2><ul><li>Change this:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>myCoolFunction234234234</span><span class=o>(</span><span class=nd>@SpanAttribute</span><span class=o>(</span><span class=s>&#34;myInt&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>myInt</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Generate a FAST sleep of 0 time !
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Random</span> <span class=n>sleepy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=o>{</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>(</span><span class=mi>999</span><span class=o>==</span><span class=n>myInt</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>Thread</span><span class=o>.</span><span class=na>sleep</span><span class=o>(</span>
</span></span><span class=line><span class=cl><span class=n>sleepy</span><span class=o>.</span><span class=na>nextInt</span><span class=o>(</span><span class=mi>5000</span> <span class=o>-</span> <span class=mi>3000</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>+</span> <span class=mi>3000</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>){</span></span></span></code></pre></div><ul><li>to this:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>private</span> <span class=kt>void</span> <span class=nf>myCoolFunction234234234</span><span class=o>(</span><span class=nd>@SpanAttribute</span><span class=o>(</span><span class=s>&#34;myInt&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>myInt</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Generate a FAST sleep of 0 time !
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>Random</span> <span class=n>sleepy</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Random</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=o>{</span>
</span></span><span class=line><span class=cl><span class=c1>// if (999==myInt)
</span></span></span><span class=line><span class=cl><span class=c1>// Thread.sleep(
</span></span></span><span class=line><span class=cl><span class=c1>// sleepy.nextInt(5000 - 3000)
</span></span></span><span class=line><span class=cl><span class=c1>// + 3000);
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>){</span></span></span></code></pre></div><p>which is basically placing comments (//) before the lines in myCoolFunction234234234 that are causing the slowness:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// if (999==myInt)
</span></span></span><span class=line><span class=cl><span class=c1>// Thread.sleep(
</span></span></span><span class=line><span class=cl><span class=c1>// sleepy.nextInt(5000 - 3000)
</span></span></span><span class=line><span class=cl><span class=c1>// + 3000);
</span></span></span></code></pre></div><ul><li>Save the changes: <strong>[CTRL]-o [Enter]</strong></li><li>Exit: <strong>[CTRL]-x</strong></li></ul><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>Until we rebuild and restart our application this change isn&rsquo;t implemented.</p></div></div><h2 id=find-other-issues>Find Other Issues</h2><p>Let&rsquo;s go see if our manual instrumentation uncovered any other issues we did not see before</p><p>So you may be asking yourself: &ldquo;How does manual instrumentation alone show us &ldquo;more problems&rdquo; than before? Latency is latency, isn&rsquo;t it?&rdquo;</p><p>The answer is with auto-instrumentation you are in most situations NOT covering functions our customers&rsquo; development teams wrote, which is of course the bulk of what developers do. They write functions&mldr;. and of course this is where the bulk of software problems occur.</p><p>You may have noticed a new exception in our trace that was not present with Auto-Instrumentation during our latency fix use-case. Since we skipped over this, let&rsquo;s walk you through it.</p><ul><li>Return to the service map</li><li>Click on shop service</li><li>Click Traces (on the right side)</li><li>Click Errors Only</li></ul><p><a href=#R-image-275515e38eee01d66d833d9451e38157 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-1-traces.png alt=7-fixing-code-1-traces class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-275515e38eee01d66d833d9451e38157><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-1-traces.png alt=7-fixing-code-1-traces class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Click on a trace with an error present</li></ul><p><a href=#R-image-8918984625b2159075bfa70ed196b927 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-2-span.png alt=7-fixing-code-2-span class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8918984625b2159075bfa70ed196b927><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-2-span.png alt=7-fixing-code-2-span class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can see our exception is <code>InvalidLocaleException</code>.</p><p>The real problem must be related to the new data associated with <strong>Sri Lanka</strong> as the Exception says <strong>&ldquo;Non English Characters found in Instrument Data&rdquo;</strong>.</p><p>This exception had not surfaced in previous traces based on ONLY Auto-Instrumentation because the method where it was thrown was NOT covered with Auto-Instrumentation.</p><p>Once we completed the Manual Instrumentation via the Otel Annotator, this method was instrumented and we can now see we had a buried Exception being thrown.</p><h2 id=fixing-more-code>Fixing more code</h2><p>We already know exactly what file to look in and what method to look at as it is called out in the trace.</p><p><a href=#R-image-6102c6dca8176905200638b3925a631f class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-3-what-to-fix.png alt=7-fixing-code-3-what-to-fix class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6102c6dca8176905200638b3925a631f><img src=../en/other/dev-mttr-custom-tags/7-fixing-code/../images/7-fixing-code-3-what-to-fix.png alt=7-fixing-code-3-what-to-fix class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Using nano:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano shop/src/main/java/com/shabushabu/javashop/shop/model/Instrument.java</span></span></code></pre></div><ul><li>Search in Nano: <strong>[CTRL]-w</strong></li><li>Enter in: <strong>buildForLocale [Enter]</strong></li></ul><p>Look just above the <code>buildForLocale</code> function.</p><p>Notice the Annotation <code>@WithSpan</code>? <code>@WithSpan</code> is an <a href=https://opentelemetry.io/docs/instrumentation/java/automatic/annotations/ target=_blank>OpenTelemetry Annotation</a> for Java that automatically generates a span around a the function that follows.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@WithSpan</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>Instrument</span> <span class=nf>buildForLocale</span><span class=o>(</span>
</span></span><span class=line><span class=cl>  <span class=nd>@SpanAttribute</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)</span> <span class=kt>long</span> <span class=n>id</span><span class=o>,</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=nd>@SpanAttribute</span><span class=o>(</span><span class=s>&#34;seller_type&#34;</span><span class=o>)</span> <span class=o>...</span>
</span></span><span class=line><span class=cl>  <span class=k>this</span><span class=o>.</span><span class=na>id</span><span class=o>=</span> <span class=n>id</span><span class=o>;</span></span></span></code></pre></div><p>Now let&rsquo;s fix this code. We are going to simply comment this out for now and see if it fixes our latency issue.</p><ul><li>Change this:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=k>if</span> <span class=o>(!</span><span class=n>isEnglish</span><span class=o>(</span><span class=n>title</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=k>throw</span> <span class=k>new</span> <span class=n>InvalidLocaleException</span><span class=o>(</span><span class=s>&#34;Non English Characters found in Instrument Data&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl> <span class=o>}</span> <span class=k>else</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>   <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Characters OK &#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><ul><li>to this (comment out if block):</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// if (!isEnglish(title)) {
</span></span></span><span class=line><span class=cl><span class=c1>//   throw new InvalidLocaleException(&#34;Non English Characters found in Instrument Data&#34;);
</span></span></span><span class=line><span class=cl><span class=c1>// } else {
</span></span></span><span class=line><span class=cl><span class=c1>//   System.out.println(&#34;Characters OK &#34;);
</span></span></span><span class=line><span class=cl><span class=c1>// }
</span></span></span></code></pre></div><ul><li>Save the changes: <strong>[CTRL]-o [Enter]</strong></li><li>Exit: <strong>[CTRL]-x</strong></li></ul><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=rebuild-and-deploy>Rebuild and Deploy</h1><h2 id=rebuild-and-deploy>Rebuild and Deploy</h2><ul><li>Run</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./BuildAndDeploy.sh</span></span></code></pre></div><ul><li>Wait a few minutes . . .</li><li>Return to the service map</li></ul><p>If you do NOT see RED in your service map, you have completed the Latency Repair for the Colorado Location!</p><p>Now let&rsquo;s check for our exception in the traces.</p><ul><li>Click on shop service</li><li>Click Traces (on the right side)</li><li>Click Errors Only</li></ul><p>If you do not have red in your service map and you do not see Errors in traces, you have successfully completed our Inventory application review for Sri Lanka and Colorado locations.</p><p><strong>Well done!</strong></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=dont-forget-chicago>Don't Forget Chicago</h1><h2 id=dont-forget-chicago>Don&rsquo;t forget Chicago</h2><p>We are nearly done, one more location to go&mldr; Chicago.</p><p>Since we have been having so many issues related to &ldquo;location&rdquo; and we have added that custom attribute via Opentelemetry Manual Instrumentation, lets go to the Splunk Observability UI and look at an APM metric set around that tag that I created for us.</p><p><a href=#R-image-bf0f2ccae89863cd233b1d0e537228cc class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-1-metricset.png alt=9-chicago-1-metricset class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bf0f2ccae89863cd233b1d0e537228cc><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-1-metricset.png alt=9-chicago-1-metricset class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Open a browser and navigate to <a href=http://[EC2-Address]:8010 target=_blank>http://[EC2-Address]:8010</a><ul><li>Replace [EC2-Address] with the ip address of your host</li></ul></li><li>Select a few locations and hit the Login button.<ul><li>Make sure to also select the Chicago Location and hit the Login button.</li></ul></li></ul><p><a href=#R-image-d5b0a01fde901b7c5e719af4c7cbcc71 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-2-app.png alt=9-chicago-2-app class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d5b0a01fde901b7c5e719af4c7cbcc71><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-2-app.png alt=9-chicago-2-app class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Uh oh! We received a 500 error, something is wrong there as well.</p><p><a href=#R-image-046e13c46f651bfdab29fd71fd5e8e3a class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-3-map.png alt=9-chicago-3-map class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-046e13c46f651bfdab29fd71fd5e8e3a><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-3-map.png alt=9-chicago-3-map class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Return to the Splunk Observability UI and lets look once again at our Service Map</li><li>Select the Instruments Service</li><li>Click the Breakdowns dropdown on the right and select location</li></ul><p><a href=#R-image-dd0608872ea24afe64f6a90e9fa6927a class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-4-map-breakdown.png alt=9-chicago-4-map-breakdown class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dd0608872ea24afe64f6a90e9fa6927a><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-4-map-breakdown.png alt=9-chicago-4-map-breakdown class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We see there was an un-handled exception thrown in the Instruments service, and some latency from our database that is related to the Chicago location!</p><ul><li>Click on Traces on the right</li><li>Click Errors Only</li><li>Click one of the traces</li></ul><p><a href=#R-image-2e7d72ff97249b43bb3c5ab7e1341cde class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-5-trace.png alt=9-chicago-5-trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2e7d72ff97249b43bb3c5ab7e1341cde><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-5-trace.png alt=9-chicago-5-trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can see the exception was thrown by Hibernate, however it was thrown in our method instruments: <code>InstrumentRepository.findInstruments</code></p><p><a href=#R-image-1285d617400f2b2ae1ffbae99c543c13 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-6-span.png alt=9-chicago-6-span class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1285d617400f2b2ae1ffbae99c543c13><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-6-span.png alt=9-chicago-6-span class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=lets-play-developer-again>Let&rsquo;s play developer again</h2><ul><li>Edit the file <code>instruments: InstrumentRepository.findInstruments</code> using nano:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>nano</span> <span class=n>instruments</span><span class=o>/</span><span class=n>src</span><span class=o>/</span><span class=n>main</span><span class=o>/</span><span class=n>java</span><span class=o>/</span><span class=n>com</span><span class=o>/</span><span class=n>shabushabu</span><span class=o>/</span><span class=n>javashop</span><span class=o>/</span><span class=n>instruments</span><span class=o>/</span><span class=n>repositories</span><span class=o>/</span><span class=n>FindInstrumentRepositoryImpl</span><span class=o>.</span><span class=na>java</span></span></span></code></pre></div><ul><li>Find the method: <code>findInstruments</code><ul><li>You know how to do this now, right?</li></ul></li></ul><p><a href=#R-image-fd720d2665d676148cc90e83f61078b8 class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-7-code.png alt=9-chicago-7-code class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd720d2665d676148cc90e83f61078b8><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-7-code.png alt=9-chicago-7-code class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We can see the developer accidently added the Instruments database with the Chicago Instruments database!</p><p>Let&rsquo;s change the query and fix this, remove instruments_for_sale from our query.</p><ul><li>Change this:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=n>Object</span> <span class=nf>findInstruments</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>LOGGER</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;findInstruments Called (All)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Object</span> <span class=n>obj</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>createNativeQuery</span><span class=o>(</span> <span class=s>&#34;SELECT * FROM instruments_for_sale, instruments_for_sale_chicago&#34;</span><span class=o>).</span><span class=na>getResultList</span><span class=o>();</span> 
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>obj</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><ul><li>to this:</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=n>Object</span> <span class=nf>findInstruments</span><span class=o>()</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=n>LOGGER</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;findInstruments Called (All)&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>  <span class=n>Object</span> <span class=n>obj</span> <span class=o>=</span> <span class=n>entityManager</span><span class=o>.</span><span class=na>createNativeQuery</span><span class=o>(</span> <span class=s>&#34;SELECT * FROM instruments_for_sale_chicago&#34;</span><span class=o>).</span><span class=na>getResultList</span><span class=o>();</span> 
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>obj</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><ul><li><p>Save the changes: <strong>[CTRL]-o [Enter]</strong></p></li><li><p>Exit: <strong>[CTRL]-x</strong></p></li><li><p>Build and Deploy Application</p></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./BuildAndDeploy.sh</span></span></code></pre></div><p>Now let&rsquo;s test the Chicago location once again</p><ul><li>Open a browser and navigate to <a href=http://[EC2-Address]:8010 target=_blank>http://[EC2-Address]:8010</a></li><li>Select the Chicago location and Login</li></ul><p>We now see the 500 error is gone!</p><ul><li>Let&rsquo;s confirm a clean Service Map:</li></ul><p><a href=#R-image-60b526d4c52d6f7609a9e921ae30fc8a class=lightbox-link><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-8-map-clean.png alt=9-chicago-8-map-clean class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60b526d4c52d6f7609a9e921ae30fc8a><img src=../en/other/dev-mttr-custom-tags/9-chicago/../images/9-chicago-8-map-clean.png alt=9-chicago-8-map-clean class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you see a clean service map, free of errors and Latency you have successfully completed the Java Instrumentation Workshop!</p><p><strong>Congratulations!!!</strong></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=appendix---setting-up-on-mac>Appendix - Setting up on Mac</h1><h2 id=mac-setup>Mac Setup</h2><ul><li>Tested on<ul><li>Macos Ventura 13.2.1</li><li>Mac M1/M2</li></ul></li></ul><p>Intel Macs should be work; however if they are slower you may need to run <code>./BuildAndDeploy</code> multiple times.</p><p>IMPORTANT: Docker must have access to 6-GB RAM.</p><ul><li>Prerequisites<ul><li><a href=https://mac.install.guide/commandlinetools/index.html target=_blank>XCode Command line tools</a></li></ul></li></ul><h3 id=homebrew-install>Homebrew Install</h3><ul><li><a href=https://docs.brew.sh/Installation target=_blank>Homebrew full install details</a></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir homebrew <span class=o>&amp;&amp;</span> curl -L https://github.com/Homebrew/brew/tarball/master <span class=p>|</span> tar xz --strip <span class=m>1</span> -C homebrew
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>homebrew/bin/brew shellenv<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>brew update --force --quiet
</span></span><span class=line><span class=cl>chmod -R go-w <span class=s2>&#34;</span><span class=k>$(</span>brew --prefix<span class=k>)</span><span class=s2>/share/zsh&#34;</span></span></span></code></pre></div><h4 id=install-colima>Install Colima</h4><p>Colima - Colima is a docker daemon that does not require Docker Desktop. This is used to avoid any docker license issues with Docker Desktop.</p><ul><li><a href=https://github.com/abiosoft/colima target=_blank>Colima full install details</a></li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew uninstall docker docker-compose colima
</span></span><span class=line><span class=cl>brew install docker docker-compose colima 
</span></span><span class=line><span class=cl>colima stop
</span></span><span class=line><span class=cl>colima start --cpu <span class=m>4</span> --memory <span class=m>6</span></span></span></code></pre></div><ul><li>Java Tools Install</li></ul><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>brew install git
</span></span><span class=line><span class=cl>brew install maven</span></span></code></pre></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-rum>Splunk RUM</h1><p>Splunk RUM is the industry‚Äôs only end-to-end, full-fidelity Real User Monitoring solution. It is built to optimize performance and aid in faster troubleshooting, giving you full visibility into end-user experiences.</p><p>Splunk RUM allows you to identify performance problems in your Web and or Mobile applications that impact the customer experience. We support benchmarking and measuring page performance with core web vitals. This includes but is not limited to W3C timings, the ability to identify long-running tasks, along with anything that can impact your page load.</p><p>With Splunk‚Äôs end-to-end monitoring capabilities, you can view the latency between all of the services that make up your application, from the service itself through to infrastructure metrics such as database calls and everything in between.
Our full-fidelity end-to-end monitoring solution captures 100% of your span data. We do not sample, we are framework agnostic and Open Telemetry standardized.</p><p>More often than not we find that the frontend and backend application&rsquo;s performance are interdependent. Fully understanding and being able to visualize the link between your backend services and your user experience is increasingly important.
To see the full picture, Splunk RUM provides a seamless correlation between our front-end and back-end microservices. If your users are experiencing less than optimal conditions on your web-based application due to an issue related to your microservice or infrastructure, Splunk will be able to detect this issue and alert you.</p><p>To complete the picture and offer full visibility, Splunk is also able to show in-context logs and events to enable deeper troubleshooting and root-cause analysis.</p><p><a href=#R-image-4607b3a96fbbba115281f55402dad116 class=lightbox-link><img src=../en/other/rum/images/rum-architecture.png alt="Architecture Overview" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4607b3a96fbbba115281f55402dad116><img src=../en/other/rum/images/rum-architecture.png alt="Architecture Overview" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk RUM</h1><article class=default><header class=headline></header><h1 id=1-overview>1. Overview</h1><h2 id=overview-of-the-rum-workshop>Overview of the RUM Workshop</h2><p>The aim of this Splunk Real User Monitoring (RUM) workshop is to let you:</p><ul><li><p>Shop for some fantastic items on the Online Boutique to create traffic, and create a number of RUM User Sessions<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> that you can view in the Splunk Observability Suite.</p></li><li><p>See an overview of the performance of all your application(s) in the Application Summary Dashboard (Both Mobile and Web based)</p></li><li><p>Examine the performance of a specific website or Mobile App with RUM metrics.</p></li><li><p>Investigate issues with your website and backend services.</p></li><li><p>(Optionally) See how to add RUM to your website.</p></li></ul><p>In order to reach this goal, we will use an online boutique to order various products. Whilst shopping on the online boutique you will create what is called a User Session.</p><p>You may encounter some issues with this web site, and you will use Splunk RUM to identify the issues, so they can be resolved by the developers.</p><p>If this a standalone RUM workshop, the workshop host will provide you with a URL for an online boutique store that has RUM enabled.</p><p>If you are running this session as part of the IM/APM workshop you will be able to use your current online boutique store after we enable RUM.</p><p>Each of these Online Boutiques are also being visited by a few synthetic users, this will allow us to generate more live data to be analyzed later.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A RUM Users session is a &ldquo;recording&rdquo; of a collection of user interactions on an application, basically collecting a website or app‚Äôs performance measured straight from the browser or Mobile App of the end user. To do this a small amount of JavaScript is embedded in each page. This script then collects data from each user as he or she explores the page, and transfers that data back for analysis.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=2-example-of-rum-enablement-in-your-website>2. Example of RUM enablement in your Website</h1><ul><li>Check the original HEAD section of your Online-boutique webpage (or use the examples here) in your browser</li><li>Find the Web address of your workshop hosts Online Boutique</li><li>Compare the changes made to the hosts Online-Boutique and compare with the base one.</li></ul><hr><h2 id=1-browse-to-the-online-boutique>1. Browse to the Online Boutique</h2><p>If you have access to an EC2 instance and have previously installed the Online Boutique as part of the APM session, you can view it on port 81 of the EC2 instance&rsquo;s IP address.</p><p>If you have not got access to an EC2 instance with the Online Boutique installed then your workshop instructor will provide you with the Online Boutique URL that does not have RUM installed so that you can complete the next steps.</p><h2 id=2--inspecting-the-html-source>2. Inspecting the HTML source</h2><p>The changes needed for RUM are placed in the <code>&lt;head></code> section of the hosts Web page. Below is the updated <code>&lt;head></code> section with the changes required to enable RUM:</p><p><a href=#R-image-a43b54f19860aa9859e6ed52a7a033cf class=lightbox-link><img src=../en/other/rum/2-setup/../images/ViewRUM-HEAD-html.png alt="Online Boutique" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a43b54f19860aa9859e6ed52a7a033cf><img src=../en/other/rum/2-setup/../images/ViewRUM-HEAD-html.png alt="Online Boutique" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The first three lines (marked in red) have been added to the <code>&lt;head></code> section of the host Web page to enable RUM Tracing, the last three (marked in blue) are optional and used to enable Custom RUM events.</p><ul><li>The first part is to indicate where to download the Splunk Open Telemetry Javascript file from: <code>https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js</code> (this can also be hosted locally if so required).</li><li>The second line defines the location where to send the traces to in the beacon url: <code>{beaconUrl: "https://rum-ingest.eu0.signalfx.com/v1/rum"</code></li><li>The RUM Access Token: <code>rumAuth: "&lt;redacted>"</code>.</li><li>Identification tags <code>app</code> and <code>environment</code> to indentify in the SPLUNK RUM UI e.g. <code>app: "ksnq-store", environment: "ksnq-workshop"}</code></li></ul><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>In this example the app name is <strong>ksnq-store</strong>, this will be different in the Workshop. Check with your host what the app name and environment to use in the RUM session will be and make a note of it!</p></div></div><p>The above two lines are all that is required to enable RUM on your website!</p><p>The (blue) optional section that uses <code>var tracer=Provider.getTracer('appModuleLoader');</code> will add a custom event for every page change allowing you to better track your website conversions and usage.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=3-rum-landing-page>3. RUM Landing Page</h1><ul><li>Visit the RUM landing page and and check the overview of the performance of all your RUM enabled applications with the Application Summary Dashboard (Both Mobile and Web based)</li></ul><hr><h2 id=1-visit-the-rum-landing-page>1. Visit the RUM Landing Page</h2><p>Login into your Splunk IM/APM/RUM Website. From the left side menu bar select <strong>RUM</strong> <a href=#R-image-9dd4033b5ea5a728820b5814ed47da8b class=lightbox-link><img src="../en/other/rum/3-rum-landing/../images/RUM_ico.png?classes=inline&amp;height=25px" alt=RUM-ico class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9dd4033b5ea5a728820b5814ed47da8b><img src="../en/other/rum/3-rum-landing/../images/RUM_ico.png?classes=inline&amp;height=25px" alt=RUM-ico class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a>. This will bring you to your the RUM Landing Page.</p><p>The goal of this page is to give you in a single page, a clear indication of the health, performance and potential errors found in your application(s) and allow you to dive deeper into the information about your User Sessions collected from your web page/App. You will have a pane for each of your active RUM applications. (The view below is the default expanded view)</p><p><a href=#R-image-e23926013095a173c8c577265fef4eb4 class=lightbox-link><img src=../en/other/rum/3-rum-landing/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e23926013095a173c8c577265fef4eb4><img src=../en/other/rum/3-rum-landing/../images/Applicationsummarydashboard.png alt=RUM-App-sum class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>If you have multiple applications, (which will be the case when every attendee is using their own ec2 instance for the RUM workshop), the pane view may be automatically reduced by collapsing the panes as shown below:</p><p><a href=#R-image-fcc2a28bf12245b5048a89bb74540144 class=lightbox-link><img src=../en/other/rum/3-rum-landing/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fcc2a28bf12245b5048a89bb74540144><img src=../en/other/rum/3-rum-landing/../images/multiple_apps_collapsed.png alt=RUM-App-sum-collapsed class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can expanded a condensed RUM Application Summary View to the full dashboard by clicking on the small browser <a href=#R-image-4be4b96234d0fe09a1b63d5f1d1f6a44 class=lightbox-link><img src="../en/other/rum/3-rum-landing/../images/browser.png?classes=inline&amp;height=25px" alt=RUM-browser class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4be4b96234d0fe09a1b63d5f1d1f6a44><img src="../en/other/rum/3-rum-landing/../images/browser.png?classes=inline&amp;height=25px" alt=RUM-browser class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> or Mobile <a href=#R-image-c8d20cb4ca0e8dd161f684f18526da88 class=lightbox-link><img src="../en/other/rum/3-rum-landing/../images/mobile.png?classes=inline&amp;height=25px" alt=RUM-mobile class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c8d20cb4ca0e8dd161f684f18526da88><img src="../en/other/rum/3-rum-landing/../images/mobile.png?classes=inline&amp;height=25px" alt=RUM-mobile class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a>icon. (Depending on the type of application: <em>Mobile</em> or <em>Browser</em> based) on the left in front of the applications name, highlighted by the red arrow.</p><p>First find the right application to use for the workshop:</p><p>If you are participating in a stand alone RUM workshop, the workshop leader will tell you the name of the application to use, in the case of a combined workshop, it will follow the naming convention we used for IM and APM and use the ec2 node name as a unique id like <strong>jmcj-store</strong> as shown as the last app in the screenshot above.</p><h2 id=2-configure-the-rum-application-summary-dashboard-header-section>2. Configure the RUM Application Summary Dashboard Header Section</h2><p>RUM Application Summary Dashboard consists of 6 major sections. The first is the selection header, where you can set/filter a number of options:</p><ul><li>A drop down for the <strong>Time Window</strong> you&rsquo;re reviewing (You are looking at the past 15 minutes by default)</li><li>A drop down to select the <strong>Environment</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> you want to look at. This allows you to focus on just the subset of applications belonging to that environment, or Select all to view all available.</li><li>A drop down list with the various <strong>Apps</strong> being monitored. You can use the one provided by the workshop host or select your own. This will focus you on just one application.</li><li>A drop down to select the <strong>Source</strong>, <em>Browser</em> or <em>Mobile</em> applications to view. For the Workshop leave <em>All</em> selected.</li><li>A hamburger menu located at the right of the header allowing you to configure some settings of your Splunk RUM application. (We will visit this in a later section).</li></ul><p><a href=#R-image-cf7d63a96032591c147d7f0fc518413b class=lightbox-link><img src=../en/other/rum/3-rum-landing/../images/RUM_SummaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf7d63a96032591c147d7f0fc518413b><img src=../en/other/rum/3-rum-landing/../images/RUM_SummaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>For the workshop lets do a deeper dive into the Application Summary screen in the next section: <a href=../en/other/rum/4-browser-summary/index.html>Check Health Browser Application</a></p><hr><p>A common application deployment pattern is to have multiple, distinct application environments that don‚Äôt interact directly with each other but that are all being monitored by Splunk APM or RUM: for instance, quality assurance (QA) and production environments, or multiple distinct deployments in different datacenters, regions or cloud providers.
<a href=http://nebezb.com/ target=_blank></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>A deployment environment is a distinct deployment of your system or application that allows you to set up configurations that don‚Äôt overlap with configurations in other deployments of the same application. Separate deployment environments are often used for different stages of the development process, such as development, staging, and production.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=4-check-browser-applications-health-at-a-glance>4. Check Browser Applications health at a glance</h1><ul><li>Get familiar with the UI and options available from this landing page</li><li>Identify Page Views/Errors and Request/Errors and Java Script Errors in a single view</br>Check the Web Vitals metrics and any Detector that has fired for in relation to your Browser Application</li></ul><hr><h2 id=1-application-summary-dashboard-overview>1. Application Summary Dashboard Overview</h2><h3 id=11-header-bar>1.1. Header Bar</h3><p>As seen in the previous section the RUM Application Summary Dashboard consists of 5 major sections.</br>The first section is the selection header, where you can collapse the Pane via the <a href=#R-image-f5de0ab942641d31328dafbeea5210a3 class=lightbox-link><img src="../en/other/rum/4-browser-summary/../images/browser.png?classes=inline&amp;height=25px" alt=RUM-browser class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5de0ab942641d31328dafbeea5210a3><img src="../en/other/rum/4-browser-summary/../images/browser.png?classes=inline&amp;height=25px" alt=RUM-browser class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> Browser icon or the <strong>></strong> in front of the application name, which is <em>jmcj-store</em> in the example below. It also provides access to the <em>Application Overview</em> page if you click the link with your application name which is <em>jmcj-store</em> in the example below.</p><p>Further, you can also open the <em>Application Overview</em> or <em>App Health Dashboard</em> via the triple dot <a href=#R-image-29e14c3fc72b1a082eae61d927656a22 class=lightbox-link><img src="../en/other/rum/4-browser-summary/../images/trippleburger.png?classes=inline&amp;height=25px" alt=trippleburger class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-29e14c3fc72b1a082eae61d927656a22><img src="../en/other/rum/4-browser-summary/../images/trippleburger.png?classes=inline&amp;height=25px" alt=trippleburger class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> menu on the right.</p><p><a href=#R-image-4c208e660117df2854a483b3c1b56d40 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/summaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4c208e660117df2854a483b3c1b56d40><img src=../en/other/rum/4-browser-summary/../images/summaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>First use the <em>View Dashboard</em> link to open the Browser App Health Dashboard which should open in a new tab. Then switch back to original RUM tab, and then use the <em>Open Application Overview</em> link, or click on the name of the app to launch the Application Overview dashboard.</p><p>We will looking at the <em>Application Overview</em> and <em>Browser App Health</em> Dashboards in detail in the following sections.</p><h2 id=2-application-overview>2. Application Overview</h2><p>The RUM Application Overview Dashboard is focused on providing you with <em>at a glance</em> overview of the status of your application.</p><h3 id=21-page-views--errors--network-requests--errors>2.1. Page Views / Errors & Network Requests / Errors</h3><p>The first section shows <em>Page Views / Errors</em>, & <em>Network Requests and Errors</em> charts show the quantity and trend of these issues in your application. This could be Javascript errors, or failed network calls to back end services.</p><p><a href=#R-image-e2597aeaf4be9f231b512d7c0ef6e34a class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/Rum-chart.png alt=RUM-chart class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e2597aeaf4be9f231b512d7c0ef6e34a><img src=../en/other/rum/4-browser-summary/../images/Rum-chart.png alt=RUM-chart class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the example above you can see that there are no failed network calls in the Network chart, but in the Page View chart you can see that a number of pages do experience some errors. These are often not visible for regular users, but can seriously impact the performance of your web site.</p><p>You can see the count of the Page Views / Network Requests / Errors by hovering over the charts.</p><p><a href=#R-image-1b7a2ff891df4b770eeff91bd6eb7323 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/RUM-Chart-Clicked.png alt=RUM-chart-clicked class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b7a2ff891df4b770eeff91bd6eb7323><img src=../en/other/rum/4-browser-summary/../images/RUM-Chart-Clicked.png alt=RUM-chart-clicked class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=22-javascript-errors>2.2. JavaScript Errors</h3><p>With the second section of the RUM Application Summary Dashboard we are showing you an overview of the JavaScript errors occurring in your application, along with a count of each error.</p><p><a href=#R-image-38dd1795d12a1df6210fcbaf70122012 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/RUM-Javascripterrors.png alt=RUM-javascript class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-38dd1795d12a1df6210fcbaf70122012><img src=../en/other/rum/4-browser-summary/../images/RUM-Javascripterrors.png alt=RUM-javascript class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the example above you can see there are three JavaScript errors, one that appears 29 times in the selected time slot, and the other two each appear 12 times.</p><p>If you click on one of the errors a pop-out opens that will show a summary (below) of the errors over time, along with a Stack Trace of the JavaScript error, giving you an indication of where the problems occurred. (We will see this in more detail in one of the following sections)</p><p><a href=#R-image-e3981114f1e9c0fbd29c911798dd77b5 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/expandedRUmJAVAscript-error.png alt=RUM-javascript-chart class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3981114f1e9c0fbd29c911798dd77b5><img src=../en/other/rum/4-browser-summary/../images/expandedRUmJAVAscript-error.png alt=RUM-javascript-chart class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=23-web-vitals>2.3. Web Vitals</h3><p>The third section of the RUM Application Summary Dashboard is showing you the crucial (google) Web Vitals, three metrics, that are used by Google in its ranking system, and give a very good indication of the speed of your site for your end users.</p><p><a href=#R-image-3f6bbedc50db11e35b33c50ab9af26f5 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/RUM-QuickWebVitals.png alt=WEB-vitals class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f6bbedc50db11e35b33c50ab9af26f5><img src=../en/other/rum/4-browser-summary/../images/RUM-QuickWebVitals.png alt=WEB-vitals class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>As you can see our site is well behaved and scores <em>Good</em> for all three Metrics. These metrics can be used to identify the effect changes to your application have, and help you improve the performance of your site.</p><p>If you click on any of the Metrics shown in the Web Vitals pane you will be taken to the corresponding Tag Spotlight Dashboard. e.g. clicking on the <strong>Largest Contentful Paint (LCP)</strong> chartlet, you will be taken to a dashboard similar to the screen shot below, that gives you timeline and table views for how this metric has performed. This should allow you to spot trends and identify where the problem may be more common, such as an OS or browser version, .</p><p><a href=#R-image-b96c09a33f189ee17f8b910405f6abfe class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/RUM-Tag-Spotlight.png alt=WEB-vitals-tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b96c09a33f189ee17f8b910405f6abfe><img src=../en/other/rum/4-browser-summary/../images/RUM-Tag-Spotlight.png alt=WEB-vitals-tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=24-most-recent-detectors>2.4. Most Recent Detectors</h3><p>The fourth and final section of the RUM Application Summary Dashboard is focused on providing you an overview of any detector that has triggered for your application. We have created a detector for this screen shot but your pane will be empty for now, but we will add some detectors to your site and make sure they are triggered in one of the next sections.</p><p><a href=#R-image-cd40bac5c233e215a481c2100b06976b class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/rum-detector.png alt=detectors class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cd40bac5c233e215a481c2100b06976b><img src=../en/other/rum/4-browser-summary/../images/rum-detector.png alt=detectors class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the screen shot you can see we have a critical alert for the <em>RUM Aggregated View Detector</em>, and a Count, how often this alert has triggered in the selected time window. If you happen to have an alert listed, you can click on the name of the Alert (that is shown as a blue link) and you will be taken to the Alert Overview page showing the details of the alert (Note: this will move you away from the current page, Please use the <strong>Back</strong> option of your browser to return to the overview page).</p><p><a href=#R-image-058fc4c0b05112523fb14d24d56b1ef1 class=lightbox-link><img src=../en/other/rum/4-browser-summary/../images/click-alert.png alt=alert class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-058fc4c0b05112523fb14d24d56b1ef1><img src=../en/other/rum/4-browser-summary/../images/click-alert.png alt=alert class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>Please take a few minutes to experiment with the RUM Application Summary Dashboard and the underlying chart and dashboards before going on to the next section.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=5-analyzing-rum-metrics>5. Analyzing RUM Metrics</h1><ul><li>See RUM Metrics and Session information in the RUM UI</li><li>See correlated APM traces in the RUM & APM UI</li></ul><hr><h2 id=1-rum-overview-pages>1. RUM Overview Pages</h2><p>From your RUM Application Summary Dashboard you can see detailed information by opening the Application Overview Page via the tripple dot <a href=#R-image-faeb376854ff850b0993abb14a6a7676 class=lightbox-link><img src="../en/other/rum/5-analyzing-metrics/../images/trippleburger.png?classes=inline&amp;height=25px" alt=trippleburger class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-faeb376854ff850b0993abb14a6a7676><img src="../en/other/rum/5-analyzing-metrics/../images/trippleburger.png?classes=inline&amp;height=25px" alt=trippleburger class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> menu on the right by selecting <em>Open Application Overview</em> or by clicking the link with your application name which is <em>jmcj-store</em> in the example below.</p><p><a href=#R-image-488a4d18c40bd2d9833dc41305918a9e class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/summaryHeader.png alt=RUM-SummaryHeader class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-488a4d18c40bd2d9833dc41305918a9e><img src=../en/other/rum/5-analyzing-metrics/../images/summaryHeader.png alt=RUM-SummaryHeader class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will take you to the RUM Application Overview Page screen as shown below.</p><p><a href=#R-image-1cca3ee3fe2af39e1423c93444f9fe6a class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-1.png alt=RUM-1 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1cca3ee3fe2af39e1423c93444f9fe6a><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-1.png alt=RUM-1 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-rum-browser-overview>2. RUM Browser Overview</h2><h3 id=21-header>2.1. Header</h3><p>The RUM UI consists of 6 major sections. The first is the selection header, where you can set/filter a number of options:</p><ul><li>A drop down for the time window you&rsquo;re reviewing (You are looking at the past hour in this case)</li><li>A drop down to select the Comparison window (You are comparing current performance on a rolling window - in this case compared to 1 hour ago)</li><li>A drop down with the available Environments to view: (Choose the one provided by the workshop host or <em>All</em> like in the example)</li><li>A drop down list with the Various Web apps (You can use the one provided by the workshop host or use <em>All</em>)</li><li><em><strong>Optionally</strong></em> a drop down to select Browser or Mobile metrics (<em>Might not be available in your workshop</em>)</li></ul><p><a href=#R-image-85377f64acc0bcf79cfb231cf77ede0b class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Header.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85377f64acc0bcf79cfb231cf77ede0b><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Header.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=22-overview-pane>2.2. Overview Pane</h3><p>The Overview Panes, down the left hand side of the page, give you a summary of the pages which have increased load times.</p><p>In the example here you can see that the <strong>checkout</strong> and <strong>cart</strong> pages have errors due to the yellow triangles, and you can see that the load time has increased by 2.38 to 5.50 seconds.</p><p><a href=#R-image-dc66080257a39ac1bc06aff9002ea81f class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Page-Load-Times.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc66080257a39ac1bc06aff9002ea81f><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Page-Load-Times.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You also see an overview of the number of Front end Error and Backend Errors per minute, and we appear to have three JavaScript errors on our site.</p><p><a href=#R-image-b0d55d464e7e1595870006ef5156a24b class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-JS-Errors.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b0d55d464e7e1595870006ef5156a24b><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-JS-Errors.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The last two panes show you the <strong>Top Page Views</strong> and the <strong>Top Network Requests</strong>.</p><p><a href=#R-image-e6918f4bf2332a389b478853da1ed552 class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Page-Views-Network.png alt=RUM-Top class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e6918f4bf2332a389b478853da1ed552><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Page-Views-Network.png alt=RUM-Top class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=23-key-metrics-pane>2.3. Key Metrics Pane</h3><p>The Key Metrics View is the location where you will find the metrics for the number of
<strong>JavaScript Errors</strong> per second, <strong>Network Errors</strong> per second an the <strong>Backend/Resource Request Duration</strong>.
These Metrics are very useful to guide you to the location of an issue if you are experiencing problems with your site.</p><p><a href=#R-image-fd85e08e4e29a6bf486ea5009d7a6a56 class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Key-Metrics.png alt=RUM-KeyMetrics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd85e08e4e29a6bf486ea5009d7a6a56><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Key-Metrics.png alt=RUM-KeyMetrics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=24-web-vitals-pane>2.4. Web Vitals Pane</h3><p>The Web Vitals view is the location where you go if you wish to get insight into the experience you are delivering to your End users based on Web Vitals metrics.
Web Vitals is an initiative by Google to provide unified guidance for quality signals that are essential to delivering a great user experience on the web and focuses on three key parameters:</p><ul><li><strong>Largest Contentful Paint (LCP)</strong>, measures loading performance. To provide a good user experience, LCP should occur within 2.5 seconds of when the page first starts loading.</li><li><strong>First Input Delay (FID)</strong>, measures interactivity. To provide a good user experience, pages should have a FID of 100 milliseconds or less.</li><li><strong>Cumulative Layout Shift (CLS)</strong>, measures visual stability. To provide a good user experience, pages should maintain a CLS of 0.1. or less.</li></ul><p><a href=#R-image-7e33dc0e54699171142b2da1abfe7a22 class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Web-Vitals.png alt=RUM-WebVitals class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e33dc0e54699171142b2da1abfe7a22><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Web-Vitals.png alt=RUM-WebVitals class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=25-other-metrics-pane>2.5. Other Metrics Pane</h3><p>The Other Metrics Pane is the location where you find other performance metrics, with a focus on initial load time of your page or tasks that are taking too long to complete.</p><ul><li><strong>Time To First Byte (TTFB)</strong>, measures how long it takes for a client&rsquo;s browser to receive the first byte of the response from the server. The longer it takes for the server to process the request and send a response, the slower your visitors&rsquo; browser is at displaying your page.</li><li><strong>Long Task Duration</strong>, a performance metric that can be used help developers to understand the bad user experience on the website, or can be an indication of a problem.</li><li><strong>Long Task Count</strong>, a metric to indicate how often a long task occurs, again used for exploring user experiences or problem detection.</li></ul><p><a href=#R-image-73e476af4476b8bdd1b874af2e1192c9 class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Other.png alt=RUM-Other class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73e476af4476b8bdd1b874af2e1192c9><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Other.png alt=RUM-Other class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=26-custom-event-pane>2.6. Custom Event Pane</h3><p>The Custom Event View is the location where you will find the metrics for any event you may have added yourself to the web pages you are monitoring.</p><p>As we have seen in the RUM enabled website, we have added the following two lines:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span></span></span></code></pre></div><p>These lines will automatically create custom Events for every new Page, and you can also add these to pieces of custom code that are not part of a framework or an event you created so you can better understand the flow though your application. We support <strong>Custom Event Requests</strong>, <strong>Custom Event Error Rates</strong> and <strong>Custom Event Latency</strong> metrics.</p><p><a href=#R-image-dcae333b9cb76eb512f81dcd39d056b8 class=lightbox-link><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Custom-Events.png alt=RUM-CustomMetrics class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dcae333b9cb76eb512f81dcd39d056b8><img src=../en/other/rum/5-analyzing-metrics/../images/RUM-Custom-Events.png alt=RUM-CustomMetrics class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=6-analyzing-rum-tags-in-the-tag-spotlight-view>6. Analyzing RUM Tags in the Tag Spotlight view</h1><ul><li>Look into the Metrics views for the various endpoints and use the Tags sent via the Tag spotlight for deeper analysis</li></ul><hr><h2 id=1-find-an-url-for-the-cart-endpoint>1. Find an url for the Cart endpoint</h2><p>From the RUM Overview page, please select the url for the <strong>Cart</strong> endpoint to dive deeper into the information available for this endpoint.</p><p><a href=#R-image-475dbcc18fa91de468fa52dd97aed285 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-select-cart.png alt=RUM-Cart2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-475dbcc18fa91de468fa52dd97aed285><img src=../en/other/rum/6-tag-spotlight/../images/RUM-select-cart.png alt=RUM-Cart2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once you have selected and clicked on the blue url, you will find yourself in the <strong>Tag Spotlight</strong> overview</p><p><a href=#R-image-ecfbf7720ba5a6d0c210d5adcbc8d303 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-TAG-Overview.png alt=RUM-Tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ecfbf7720ba5a6d0c210d5adcbc8d303><img src=../en/other/rum/6-tag-spotlight/../images/RUM-TAG-Overview.png alt=RUM-Tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Here you will see all of the tags that have been sent to Splunk RUM as part of the RUM traces. The tags displayed will be relevant to the overview that you have selected. These are generic Tags created automatically when the Trace was sent, and additional Tags you have added to the trace as part of the configuration of your website.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Additional Tags</div><div class=box-content><p>We are already sending two additional tags, you have seen them defined in the <em>Beacon url</em> that was added to your website: <code>app: "[nodename]-store", environment: "[nodename]-workshop"</code> in the first section of this workshop! You can add additional tags in a similar way.</p></div></div><p>In our example we have selected the <strong>Document Load Latency</strong> view as shown here:</p><p><a href=#R-image-70a3d5c6d4b25eebc812e7c4c6dd5c29 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Selection.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-70a3d5c6d4b25eebc812e7c4c6dd5c29><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Selection.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can select any of the following Tag views, each focused on a specific metric.</p><p><a href=#R-image-2581dcbab1b54490c4d04686bcc98a9b class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Tag-views.png alt=RUM-views class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2581dcbab1b54490c4d04686bcc98a9b><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Tag-views.png alt=RUM-views class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h2 id=2-explore-the-information-in-the-tag-spotlight-view>2. Explore the information in the Tag Spotlight view</h2><p>The Tag spotlight is designed to help you identify problems, either through the chart view,, where you may quickly identify outliers or via the TAGs.</p><p>In the <strong>Document Load Latency</strong> view, if you look at the <strong>Browser</strong>, <strong>Browser Version</strong> & <strong>OS Name</strong> Tag views,you can see the various browser types and versions, as well as for the underlying OS.</p><p>This makes it easy to identify problems related to specific browser or OS versions, as they would be highlighted.</p><p><a href=#R-image-565cfd3b5ca8e7cfa0ca4d80016c548d class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUMBrowserTags.png alt=RUM-Tag2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-565cfd3b5ca8e7cfa0ca4d80016c548d><img src=../en/other/rum/6-tag-spotlight/../images/RUMBrowserTags.png alt=RUM-Tag2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the above example you can see that Firefox had the slowest response, various Browser versions ( Chrome) that have different response times and the slow response of the Android devices.</p><p>A further example are the regional Tags that you can use to identify problems related to ISP or locations etc. Here you should be able to find the location you have been using to access the Online Boutique. Drill down by selecting the town or country you are accessing the Online Boutique from by clicking on the name as shown below (City of Amsterdam):</p><p><a href=#R-image-31915eee40227eb2f3aa6b2226e723ce class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Region.png alt=RUM-click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-31915eee40227eb2f3aa6b2226e723ce><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Region.png alt=RUM-click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will select only the traces relevant to the city selected as shown below:</p><p><a href=#R-image-ed928f2281bc634033b27078ddc9a0b3 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Adam.png alt=RUM-Adam class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed928f2281bc634033b27078ddc9a0b3><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Adam.png alt=RUM-Adam class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>By selecting the various Tag you build up a filter, you can see the current selection below</p><p><a href=#R-image-d18947bd852e950f32436f6621dcf6e3 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Filter.png alt=RUM-Adam class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d18947bd852e950f32436f6621dcf6e3><img src=../en/other/rum/6-tag-spotlight/../images/RUM-Filter.png alt=RUM-Adam class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To clear the filter and see every trace click on <strong>Clear All</strong> at the top right of the page.</p><p>If the overview page is empty or shows <a href=#R-image-1e342ad407e0b1fba5b5b9fa5761231f class=lightbox-link><img src="../en/other/rum/6-tag-spotlight/../images/RUM-NoTime.png?classes=inline&amp;height=25px" alt=RUM-Adam class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1e342ad407e0b1fba5b5b9fa5761231f><img src="../en/other/rum/6-tag-spotlight/../images/RUM-NoTime.png?classes=inline&amp;height=25px" alt=RUM-Adam class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a>, no traces have been received in the selected timeslot.
You need to increase the time window at the top left. You can start with the <em>Last 12 hours</em> for example.</p><p>You can then use your mouse to select the time slot you want like show in the view below and activate that time filter by clicking on the little spyglass icon.</p><p><a href=#R-image-fdff153f39ec14438e3d838841ab5d96 class=lightbox-link><img src=../en/other/rum/6-tag-spotlight/../images/RUM-TimeSelect.png alt=RUM-time class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fdff153f39ec14438e3d838841ab5d96><img src=../en/other/rum/6-tag-spotlight/../images/RUM-TimeSelect.png alt=RUM-time class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=7-analyzing-rum-sessions>7. Analyzing RUM Sessions</h1><ul><li>Dive into RUM Session information in the RUM UI</li><li>Identify Javascript errors in the Span of an user interaction</li></ul><hr><h2 id=1-again-select-the-cart-url>1. Again select the cart URL</h2><p>After you have focussed the time slot with the time selector, you need to reselect the <em>cart</em> url from <strong>Url Name</strong> view, as shown below:</p><p><a href=#R-image-2a30fe4e26355497f3d617c91af9e71a class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/RUM-Cart-All.png alt=RUM-Cart-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2a30fe4e26355497f3d617c91af9e71a><img src=../en/other/rum/7-rum-sessions/../images/RUM-Cart-All.png alt=RUM-Cart-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the example above we selected <code>http://34.246.124.162:81/cart</code></p><h2 id=2-drill-down-in-the-sessions>2. Drill down in the Sessions</h2><p>After you have analyzed the information and drilled down via the Tag Spotlight to a subset of the traces, you can view the actual session as it was run by the end-user&rsquo;s browser.</p><p>You do this by clicking on the link <strong>Example Sessions</strong> as shown below:</p><p><a href=#R-image-8b13676db3571af8529dd2e3055d79ff class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/RUM-ExampleSessions.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b13676db3571af8529dd2e3055d79ff><img src=../en/other/rum/7-rum-sessions/../images/RUM-ExampleSessions.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will give you a list of sessions that matched both the time filter and the subset selected in the Tag Profile.</p><p>Select one by clicking on the session ID, It is a good idea to select one that has the longest duration (preferably over 700 ms).</p><p><a href=#R-image-23c0ece00f2f7c294ca6da04e37e3733 class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/RUM-Session-Selected.png alt=RUM-Header class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-23c0ece00f2f7c294ca6da04e37e3733><img src=../en/other/rum/7-rum-sessions/../images/RUM-Session-Selected.png alt=RUM-Header class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once you have selected the session, you will be taken to the session details page. As you are selecting a specific action that is part of the session, you will likely arrive somewhere in the middle of the session, at the moment of the interaction.</p><p>You can see the URL <code>http://34.246.124.162:81/cart</code>, the one you selected earlier, is where we are focusing on in the session stream.</p><p><a href=#R-image-dc354c1b1b39cfa00f727bb4db633b6d class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag.png alt=RUM-Session-Tag class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc354c1b1b39cfa00f727bb4db633b6d><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag.png alt=RUM-Session-Tag class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Scroll down a little bit on the page, so you see the end of the operation as shown below.</p><p><a href=#R-image-421069821c0a83518aa061a0270b9d38 class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-2.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-421069821c0a83518aa061a0270b9d38><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-2.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can see that we have received a few Javascript Console errors that may not have been detected or visible to the end users. To examine these in more detail click on the middle one that says: *<strong>Cannot read properties of undefined (reading &lsquo;Prcie&rsquo;)</strong></p><p><a href=#R-image-50b5d9b9bb688f61a31bbbcd8463e2bc class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-3.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-50b5d9b9bb688f61a31bbbcd8463e2bc><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-3.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will cause the page to expand and show the Span detail for this interaction, It will contain a detailed <em>error.stack</em> you can pass on the developer to solve the issue. You may have noticed when buying in the Online Boutique that the final total always was $0.00.</p><p><a href=#R-image-97211ea4a2b6d9e93fd4c3cba753191b class=lightbox-link><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-4.png alt=RUM-Session-info class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-97211ea4a2b6d9e93fd4c3cba753191b><img src=../en/other/rum/7-rum-sessions/../images/Session-Tag-4.png alt=RUM-Session-info class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=8-correlate-between-splunk-rum-and-apm-backend-services>8. Correlate between Splunk RUM and APM backend services</h1><ul><li>Continue with the RUM Session information in the RUM UI</li><li>See correlated APM traces and logs in the APM & Log Observer UI</li></ul><hr><h2 id=1-finding-backend-service-issues>1. Finding backend service issues</h2><p>Click on the <a href=#R-image-9f0b0c6e197cd248b99ea5b32fa913e2 class=lightbox-link><img src="../en/other/rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&amp;height=25px" alt=RUM-JS class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f0b0c6e197cd248b99ea5b32fa913e2><img src="../en/other/rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&amp;height=25px" alt=RUM-JS class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> to close the Span view.
Now continue to scroll down and find the <strong>POST /cart/checkout</strong> line.</p><p><a href=#R-image-bd421e3bb3c62234f633df86b4754e3c class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd421e3bb3c62234f633df86b4754e3c><img src=../en/other/rum/8-apm-correlation/../images/RUM-APM-Click.png alt=RUM-APM-Click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the blue <a href=#R-image-a4bb400c6d9b386c266d7026d7c9570d class=lightbox-link><img src="../en/other/rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&amp;height=25px" alt=RUM-APM-BLUE class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4bb400c6d9b386c266d7026d7c9570d><img src="../en/other/rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&amp;height=25px" alt=RUM-APM-BLUE class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user.</p><p><a href=#R-image-456d4a8d3a690f95b6378d21ff2fe403 class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-456d4a8d3a690f95b6378d21ff2fe403><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace.png alt=RUM-APM-Trace class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In this popup, there are multiple sections available, providing you with a quick insight in the behavior of your backend services. For example the Performance Summary section will tell you where the time was spent during the backend call.</p><p><a href=#R-image-ab70bb25aacb503186eb512f9f66f44d class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab70bb25aacb503186eb512f9f66f44d><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Performance.png alt=RUM-APM-Trace-perf class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the above example you can see that more than 77,9% was spent in external services.</p><p>If you scroll down to the bottom of the dialog, you can see the complete Trace and Services section like shown below:</p><p><a href=#R-image-a2b72ca25e0b163c55aa525000078b5c class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a2b72ca25e0b163c55aa525000078b5c><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services.png alt=RUM-APM-Trace-services class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>in the Services map, you can see two services flagged red, the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service in both in dark red. Light red means it received an error and dark red means an error originated from that service.</p><p><a href=#R-image-423452bbed1a68172b50689ac57e5fb9 class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-423452bbed1a68172b50689ac57e5fb9><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png alt=RUM-APM-Trace-services-detail class="lightbox-image noborder lightbox noshadow" loading=lazy></a>
So already it is obvious there is a problem in the back end services.</p><p>Let&rsquo;s investigate!</p><h2 id=2--follow-the-trace-to-the-backend-service>2. Follow the Trace to the Backend service</h2><p>You can now click on the Trace Id link:</p><p><a href=#R-image-76ed89ebc900b750fe054e4eb8d0bfa4 class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76ed89ebc900b750fe054e4eb8d0bfa4><img src=../en/other/rum/8-apm-correlation/../images/RUM-Trace-url.png alt=RUM-APM-Trace-link class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will bring you to the Waterfall APM view that will show you what occurred in detail in a call to the backend services.
On the right you see the Trace Id: and again the Performance Summary, as we saw before.
In the waterfall, you can identify the various backend services that were part of this call from the frontend.</p><p>As you can see there are red error indicators <a href=#R-image-f76984e776c4f4a1ca82e7aa5fb102bd class=lightbox-link><img src="../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f76984e776c4f4a1ca82e7aa5fb102bd><img src="../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> before the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service.</p><p><a href=#R-image-5e39da368cc87fba3e7b52587f0e3a32 class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e39da368cc87fba3e7b52587f0e3a32><img src=../en/other/rum/8-apm-correlation/../images/RUM-APM-Waterfall.png alt=RUM-APM-waterfall class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the <a href=#R-image-f0a384488519b4260fc4c827dc94f319 class=lightbox-link><img src="../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="figure-image noborder inline lightbox noshadow" style=height:25px;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f0a384488519b4260fc4c827dc94f319><img src="../en/other/rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&amp;height=25px" alt=RUM-APM-error-flag class="lightbox-image noborder inline lightbox noshadow" loading=lazy></a> after the <strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> line.</p><p><a href=#R-image-ef3a3bf2c890060e1a69c4c1a1edd1aa class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ef3a3bf2c890060e1a69c4c1a1edd1aa><img src=../en/other/rum/8-apm-correlation/../images/payment-click.png alt=RUM-payment-click class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open the span detail page to show you the detailed information about this service call.
You wil see that the call returned a <strong>401</strong> error code or <em>Invalid Request</em>.</p><h2 id=3--use-the-related-content---logs>3. Use the Related Content - Logs</h2><p>As the Splunk Observability cloud suite correlates trace metrics and logs automatically, the system will show you in the related content bar at the bottom of the page, the corresponding logs for this trace.</p><p><a href=#R-image-5deef3724283e7e0aa133c0a13d1c3ca class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5deef3724283e7e0aa133c0a13d1c3ca><img src=../en/other/rum/8-apm-correlation/../images/log-corelation.png alt=RUM-payment-related-content class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on the Log link to see the logs.</p><p>When the logs are shown, notice that the filter at the top of the page contains the logs for the trace.
Next select one of the lines indicating an error for the payment service.
This should open the log message on the right.</p><p>It clearly shows the reason why the payment service fails: we are using an invalid token towards the service:<br>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#R-image-5f4999705b28ff5ad50f44bb9a8c0f4b class=lightbox-link><img src=../en/other/rum/8-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5f4999705b28ff5ad50f44bb9a8c0f4b><img src=../en/other/rum/8-apm-correlation/../images/RUM-LogObserver.png alt=RUM-logs class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4--conclusion>4. Conclusion</h2><p>In the workshop, you have seen how to add RUM functionality to you website.
We investigate the performance of your Website using RUM Metrics.
Using the Tag profile, you have searched for your own session, and with the session waterfall, you identified two problems:</p><ul><li>A Java script error that caused your price calculation to be zero.</li><li>An issue in the payment backend service that caused payments to fail.</li></ul><p>Using the ability to correlate RUM traces with the Backend APM trace and Logs, you have found the reason for the payment failure.</p><p>This concludes the RUM workshop.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=9-custom-alerts-and-charts-based-on-rum-metrics>9. Custom alerts and charts based on RUM Metrics</h1><ul><li>Use RUM Metrics to set up Alerts to be warned in case of an issue</li><li>Create a Custom Chart based on RUM Metrics</li></ul><hr><h2 id=1--overview>1. Overview</h2><p>The fact that Splunk&rsquo;s RUM is designed as a full fidelity solution, and thus can take 100% of your traces, allows it to detect and alert you to any change to the behavior of your website. It also give you the ability to to give you accurate insight in how your website is behaving by allowing you to creating custom Chart and Dashboards.
This allows you to combine data from your Website, Backend service and underlying Infrastructure. Allowing you to observe the complete stack that makes up your application/solution.</p><p>Creating charts or alerts for RUM Metrics are done in the same way as we do for Infrastructure Metrics. In this section we will create a simple chart, detector and alert.</p><p>If you previously done the Splunk IM Part of the Workshop, you will find this section very familiar. If you have not done the Splunk IM workshop before, it is recommended that you run though the <a href=../en/imt/dashboards/index.html>Dashboards</a> and <a href=../en/imt/detectors/index.html>Detectors</a> modules after completing the RUM workshop to get a better understanding of the capabilities.</p><h2 id=2-create-an-alert-on-one-of-the-rum-metrics>2. Create an alert on one of the RUM Metrics</h2><p>From the top left hamburger menu icon click <strong>Alerts</strong> in the menu and then select <strong>Detectors</strong>.</p><h2 id=3-create-a-chart-based-on-rum-metrics>3. Create a Chart based on Rum Metrics</h2><h3 id=31-overview>3.1 Overview</h3><p>Creating charts or alerts for RUM Metrics are done in the same way as we do for Infrastructure Metrics.
In this section we will create a simple chart, detector and alert
If you previously done the Splunk IM Part of the Workshop, you will find this section very familiar.</p><p><a href=#R-image-c102848200d8df707230ae4543e535ab class=lightbox-link><img src=../en/other/rum/9-alerting/../images/RUM-select-cart.png alt=RUM-Cart2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c102848200d8df707230ae4543e535ab><img src=../en/other/rum/9-alerting/../images/RUM-select-cart.png alt=RUM-Cart2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>u have added to the trace as part of the configuration of your website.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Additional Tags</div><div class=box-content><p>We are already sending two additional tags, you have seen them defined in the <em>Beacon url</em> that was added to your website in the first section of this workshop! You can add additional tag in a similar way.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=nx>app</span><span class=o>:</span> <span class=s2>&#34;[nodename]-store&#34;</span><span class=p>,</span> <span class=nx>environment</span><span class=o>:</span> <span class=s2>&#34;[nodename]-workshop&#34;</span></span></span></code></pre></div></div></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=splunk-synthetic-scripting>Splunk Synthetic Scripting</h1><p>Proactively monitor the performance of your web app before problems affect your users. With <strong>Splunk Synthetic Monitoring</strong>, technical and business teams create detailed tests to proactively monitor the speed and reliability of websites, web apps, and resources over time, at any stage in the development cycle.</p><p><strong>Splunk Synthetic Monitoring</strong> offers the most comprehensive and in-depth capabilities for uptime and web performance optimization as part of the only complete observability suite, Splunk Observability Cloud.</p><p>Easily set up monitoring for APIs, service endpoints and end-user-experience. With <strong>Splunk Synthetic Monitoring</strong>, go beyond basic uptime and performance monitoring and focus on proactively finding and fixing issues, optimizing web performance, and ensuring customers get the best user experience.</p><p>With <strong>Splunk Synthetic Monitoring</strong> you can:</p><ul><li>Detect and resolve issues fast across critical user flows, business transactions and API endpoints</li><li>Prevent web performance issues from affecting customers with an intelligence web optimization engine</li><li>And improve performance of all page resources and third-party dependencies</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk Synthetic Scripting</h1><article class=default><header class=headline></header><h1 id=1-real-browser-test>1. Real Browser Test</h1><h2 id=introduction>Introduction</h2><p>This workshop walks you through using the <a href=https://developer.chrome.com/docs/devtools/recorder/ target=_blank>Chrome DevTools Recorder</a> to create a synthetic transaction against a Splunk demonstration instance.</p><p>The exported JSON from the Chrome DevTools Recorder will then be used to create a Splunk Synthetic Monitoring Real Browser Test.</p><p>In addition, you will also get to learn other Splunk Synthetic Monitoring checks like <a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html target=_blank>API Test</a> and <a href=https://docs.splunk.com/Observability/synthetics/uptime-test/uptime-test.html target=_blank>Uptime Test</a>.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Google Chrome Browser installed</li><li>Access to Splunk Observability Cloud</li></ul><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of 1. Real Browser Test</h1><article class=default><header class=headline></header><h1 id=11-recording-a-test>1.1 Recording a test</h1><h2 id=open-the-starting-url>Open the starting URL</h2><p>Open the starting URL for the workshop in Chrome. Click on the appropriate link below to open the site in a new tab.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>The starting URL for the workshop is different for <strong>EMEA</strong> and <strong>AMER/APAC</strong>. Please use the correct URL for your region.</p><div class=tab-panel data-tab-group=04105c8603f71780574133ca907fdbe8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=emea-workshop-url class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("04105c8603f71780574133ca907fdbe8","emea-workshop-url")'>
<span class=tab-nav-text>EMEA Workshop URL</span></button>
<button data-tab-item=amerapac-workshop-url class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("04105c8603f71780574133ca907fdbe8","amerapac-workshop-url")'>
<span class=tab-nav-text>AMER/APAC Workshop URL</span></button></div><div class=tab-content-container><div data-tab-item=emea-workshop-url class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><a href=https://frontend-eu.o11ystore.com:81/ target=_blank>https://frontend-eu.o11ystore.com:81/</a></p></div></div><div data-tab-item=amerapac-workshop-url class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><a href=https://frontend-us.o11ystore.com:81/ target=_blank>https://frontend-us.o11ystore.com/:81/</a></p></div></div></div></div></div></div><h2 id=open-the-chrome-devtools-recorder>Open the Chrome DevTools Recorder</h2><p>Next, open the Developer Tools (in the new tab that was opened above) by pressing <code>Ctrl + Shift + I</code> on Windows or <code>Cmd + Option + I</code> on a Mac, then select <strong>Recorder</strong> from the top-level menu or the <strong>More tools</strong> flyout menu.</p><p><a href=#R-image-2bc5448cf34b1d317221c8868b6b9bc2 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/open-recorder.png alt="Open Recorder" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2bc5448cf34b1d317221c8868b6b9bc2><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/open-recorder.png alt="Open Recorder" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>Site elements might change depending on viewport width. Before recording, set your browser window to the correct width for the test you want to create (Desktop, Tablet, or Mobile). Change the DevTools &ldquo;dock side&rdquo; to pop out as a separate window if it helps.</p></div></div><h2 id=create-a-new-recording>Create a new recording</h2><p>With the Recorder panel open in the DevTools window. Click on the
<span class="btn cstyle blue"><button type=button>
Create a new recording</button></span> button to start.</p><p><a href=#R-image-93516d8708194727dc1a27859f8b3fe5 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/recorder.png alt=Recorder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93516d8708194727dc1a27859f8b3fe5><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/recorder.png alt=Recorder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>For the <strong>Recording Name</strong> use your initials to prefix the name of the recording e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>. Click on <strong>Start Recording</strong> to start recording your actions.</p><p><a href=#R-image-3aa96af860e53a6ad8377e2fc9d1530f class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/recording-name.png alt="Recording Name" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3aa96af860e53a6ad8377e2fc9d1530f><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/recording-name.png alt="Recording Name" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now that we are recording, complete the following actions on the site:</p><ul><li>Click on <strong>Vintage Camera Lens</strong></li><li>Click on <strong>Add to Cart</strong></li><li>Click on <strong>Place Order</strong></li><li>Click on <strong>End recording</strong> in the Recorder panel.</li></ul><p><a href=#R-image-d71c0dbf813c074826bcb04582ef2f97 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/end-recording.png alt="End Recording" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d71c0dbf813c074826bcb04582ef2f97><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/end-recording.png alt="End Recording" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=exporting-the-recording>Exporting the recording</h2><p>Click on the <strong>Export</strong> button:</p><p><a href=#R-image-7c0987c5efa40287c05db0a6922cf68b class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/export-button.png alt="Export button" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c0987c5efa40287c05db0a6922cf68b><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/export-button.png alt="Export button" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Select <strong>JSON</strong> as the format, then click on <strong>Save</strong></p><p><a href=#R-image-03b3084d3b59fed4f29d7c30683d04fd class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/export-json.png alt="Export JSON" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-03b3084d3b59fed4f29d7c30683d04fd><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/export-json.png alt="Export JSON" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-c0fd3a0416b499c325aa704201e36e32 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/save-json.png alt="Save JSON" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c0fd3a0416b499c325aa704201e36e32><img src=../en/other/synthetics-scripting/1-real-browser-test/1-recording-a-test/../../img/save-json.png alt="Save JSON" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations!</strong> You have successfully created a recording using the Chrome DevTools Recorder. Next, we will use this recording to create a Real Browser Test in Splunk Synthetic Monitoring.</p><hr><div class=expand><input type=checkbox id=R-expand-7e89dfd0f6f14f376b0a08bca1b14223 aria-controls=R-expandcontent-7e89dfd0f6f14f376b0a08bca1b14223>
<label class=expand-label for=R-expand-7e89dfd0f6f14f376b0a08bca1b14223><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
Click here to view the JSON file</label><div id=R-expandcontent-7e89dfd0f6f14f376b0a08bca1b14223 class=expand-content><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;RWC - Online Boutique&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;setViewport&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1430</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1016</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isMobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;hasTouch&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isLandscape&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://frontend-eu.o11ystore.com:81/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://frontend-eu.o11ystore.com:81/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Online Boutique&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[2]/div[2]/div/a/div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mi>170</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mi>180</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://34.242.111.159:81/product/66VCHSJNUP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/ADD TO CART&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div[1]/div/div[2]/div/form/div/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Add to Cart&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>35.0078125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>46.4140625</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://34.242.111.159:81/cart&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/PLACE ORDER&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[4]/div/form/div[4]/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Place order&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>29.8125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>66.8203125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;http://34.242.111.159:81/cart/checkout&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=12-create-real-browser-test>1.2 Create Real Browser Test</h1><p>In Splunk Observability Cloud, navigate to <strong>Synthetics</strong> and click on
<span class="btn cstyle blue"><button type=button>
Add new test</button>
</span>.</p><p>From the dropdown select <strong>Browser test</strong>.</p><p><a href=#R-image-0839ac8704bbef46f0a2b8befadc7751 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/2-create-real-browser-test/../../img/add-new-test.png alt="Add new test" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0839ac8704bbef46f0a2b8befadc7751><img src=../en/other/synthetics-scripting/1-real-browser-test/2-create-real-browser-test/../../img/add-new-test.png alt="Add new test" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will then be presented with the <strong>Browser test content</strong> configuration page.</p><p><a href=#R-image-5e113ef143a1b934a9a834bf4501a68c class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/2-create-real-browser-test/../../img/new-test.png alt="New Test" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e113ef143a1b934a9a834bf4501a68c><img src=../en/other/synthetics-scripting/1-real-browser-test/2-create-real-browser-test/../../img/new-test.png alt="New Test" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=13-import-json>1.3 Import JSON</h1><p>To begin configuring our test, we need to import the JSON that we exported from the Chrome DevTools Recorder. To enable the
<span class="btn cstyle transparent"><button type=button>
<strong>Import</strong></button></span> button, we must first give our test a name e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>.</p><p><a href=#R-image-73837057031d61942731a4a3a27b3b68 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import.png alt=Import class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73837057031d61942731a4a3a27b3b68><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import.png alt=Import class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once the
<span class="btn cstyle transparent"><button type=button>
<strong>Import</strong></button></span> button is enabled, click on it and either drop the JSON file that you exported from the Chrome DevTools Recorder or upload the file.</p><p><a href=#R-image-935506bb7d37d6e77e8d5e29e2b1a7bc class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import-json.png alt="Import JSON" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-935506bb7d37d6e77e8d5e29e2b1a7bc><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import-json.png alt="Import JSON" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once the JSON file has been uploaded, click on
<span class="btn cstyle blue"><button type=button>
Continue to edit steps</button></span></p><p><a href=#R-image-f6a140954ad988f78af06506f321c5e9 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import-complete.png alt="Import Complete" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f6a140954ad988f78af06506f321c5e9><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/import-complete.png alt="Import Complete" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><a href=#R-image-453ed672bb7560e8caba77971a539fbc class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/edit-steps.png alt="Edit Steps" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-453ed672bb7560e8caba77971a539fbc><img src=../en/other/synthetics-scripting/1-real-browser-test/3-import-json/../../img/edit-steps.png alt="Edit Steps" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Before we make any edits to the test, let&rsquo;s first configure the settings, click on
<span class="btn cstyle blue"><button type=button>
&lt; Return to test</button></span></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=14-settings>1.4 Settings</h1><p>The simple settings allow you to configure the basics of the test:</p><ul><li><strong>Name</strong>: The name of the test (e.g. RWC - Online Boutique).</li><li><strong>Details</strong>:<ul><li><strong>Locations</strong>: The locations where the test will run from.</li><li><strong>Device</strong>: Emulate different devices and connection speeds. Also, the viewport will be adjusted to match the chosen device.</li><li><strong>Frequency</strong>: How often the test will run.</li><li><strong>Round-robin</strong>: If multiple locations are selected, the test will run from one location at a time, rather than all locations at once.</li><li><strong>Active</strong>: Set the test to active or inactive.</li></ul></li></ul><p>![Return to Test]For this workshop, we will configure the locations that we wish to monitor from. Click in the <strong>Locations</strong> field and you will be presented with a list of global locations (over 50 in total).</p><p><a href=#R-image-ec2e0b991d8cb03df9d1970c70d786ac class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/4-edit-test-settings/../../img/global-locations.png alt="Global Locations" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec2e0b991d8cb03df9d1970c70d786ac><img src=../en/other/synthetics-scripting/1-real-browser-test/4-edit-test-settings/../../img/global-locations.png alt="Global Locations" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Select the following locations:</p><ul><li><strong>AWS - N. Virginia</strong></li><li><strong>AWS - London</strong></li><li><strong>AWS - Melbourne</strong></li></ul><p>Once complete, scroll down and click on Click on
<span class="btn cstyle blue"><button type=button>
Submit</button></span> to save the test.</p><p>The test will now be scheduled to run every 5 minutes from the 3 locations that we have selected. This does take a few minutes for the schedule to be created.</p><p>So whilst we wait for the test to be scheduled, click on
<span class="btn cstyle transparent"><button type=button>
Edit test</button></span> so we can go through the Advanced settings.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=15-advanced-settings>1.5 Advanced Settings</h1><p>Click on <strong>Advanced</strong>, these settings are optional and can be used to further configure the test.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>In the case of this workshop, we will <strong>not</strong> be using any of these settings as this is for informational purposes only.</p></div></div><p><a href=#R-image-8e3dd56ee68edc22576f9701d9cc3869 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/5-advanced-settings/../../img/advanced-settings.png alt="Advanced Settings" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8e3dd56ee68edc22576f9701d9cc3869><img src=../en/other/synthetics-scripting/1-real-browser-test/5-advanced-settings/../../img/advanced-settings.png alt="Advanced Settings" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li><strong>Security</strong>:<ul><li><strong>TLS/SSL validation</strong>: When activated, this feature is used to enforce the validation of expired, invalid hostname, or untrusted issuer on SSL/TLS certificates.</li><li><strong>Authentication</strong>: Add credentials to authenticate with sites that require additional security protocols, for example from within a corporate network. By using <a href=https://docs.splunk.com/Observability/synthetics/test-config/global-variables.html target=_blank>concealed global variables</a> in the Authentication field, you create an additional layer of security for your credentials and simplify the ability to share credentials across checks.</li></ul></li><li><strong>Custom Content</strong>:<ul><li><strong>Custom headers</strong>: Specify custom headers to send with each request. For example, you can add a header in your request to filter out requests from analytics on the back end by sending a specific header in the requests. You can also use custom headers to set cookies.</li><li><strong>Cookies</strong>: Set cookies in the browser before the test starts. For example, to prevent a popup modal from randomly appearing and interfering with your test, you can set cookies. Any cookies that are set will apply to the domain of the starting URL of the check. Splunk Synthetics Monitoring uses the public suffix list to determine the domain.</li><li><strong>Host overrides</strong>: Add host override rules to reroute requests from one host to another. For example, you can create a host override to test an existing production site against page resources loaded from a development site or a specific CDN edge node.</li></ul></li></ul><p>Next, we will edit the test steps to provide more meaningful names for each step.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=16-edit-test-steps>1.6 Edit test steps</h1><p>To edit the steps click on the
<span class="btn cstyle transparent"><button type=button>
+ Edit steps or synthetic transactions</button></span> button. From here, we are going to give meaningful names to each step.</p><p><a href=#R-image-f5ff58e3dbda8aaeee4462f93fd4d0c5 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/edit-steps.png alt="Edit steps" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5ff58e3dbda8aaeee4462f93fd4d0c5><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/edit-steps.png alt="Edit steps" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>For each of the four steps, we are going to give them a meaningful name.</p><ul><li><strong>Step 1</strong> replace the text <strong>Go to URL</strong> with <strong>HomePage - Online Boutique</strong></li><li><strong>Step 2</strong> enter the text <strong>Select Vintage Camera Lens</strong>.</li><li><strong>Step 3</strong> enter <strong>Add to Cart</strong>.</li><li><strong>Step 4</strong> enter <strong>Place Order</strong>.</li></ul><p><a href=#R-image-b045c131612bb1b155e1ad4a347ca676 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/step-names.png alt="Step names" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b045c131612bb1b155e1ad4a347ca676><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/step-names.png alt="Step names" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click
<span class="btn cstyle blue"><button type=button>
&lt; Return to test</button></span> to return to the test configuration page and click
<span class="btn cstyle blue"><button type=button>
Save</button></span> to save the test.</p><p>You will be returned to the test dashboard where you will see test results start to appear.</p><p><a href=#R-image-800e3dc09cb272e5dddcb1496d1162fc class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/scatterplot.png alt=Scatterplot class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-800e3dc09cb272e5dddcb1496d1162fc><img src=../en/other/synthetics-scripting/1-real-browser-test/6-edit-steps/../../img/scatterplot.png alt=Scatterplot class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p><strong>Congratulations!</strong> You have successfully created a Real Browser Test in Splunk Synthetic Monitoring. Next, we will look into a test result in more detail.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=17-view-test-results>1.7 View test results</h1><p>In the Scatterplot from the previous step, click on one of the dots to drill into the test run data. Preferably, select the most recent test run (farthest to the right).</p><p><a href=#R-image-e3fe43b023700b7b5f60852d1e96a1a8 class=lightbox-link><img src=../en/other/synthetics-scripting/1-real-browser-test/7-view-test-results/../../img/drilldown.png alt=Drilldown class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3fe43b023700b7b5f60852d1e96a1a8><img src=../en/other/synthetics-scripting/1-real-browser-test/7-view-test-results/../../img/drilldown.png alt=Drilldown class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=api-test>API Test</h1><p>The API Test provides a flexible way to check the functionality and performance of API endpoints. The shift toward API-first development has magnified the necessity to monitor the back-end services that provide your core front-end functionality.</p><p>Whether you&rsquo;re interested in testing the multi-step API interactions or you want to gain visibility into the performance of your endpoints, the API Test can help you accomplish your goals.</p><p><a href=#R-image-bb9127f06541cc389412f007ee8ea303 class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/../img/api-test-result.png alt="API test result" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb9127f06541cc389412f007ee8ea303><img src=../en/other/synthetics-scripting/2-api-test/../img/api-test-result.png alt="API test result" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of API Test</h1><article class=default><header class=headline></header><h1 id=global-variables>Global Variables</h1><h2 id=global-variables>Global Variables</h2><p>View the global variable that we&rsquo;ll use to perform our API test. Click on <strong>Global Variables</strong> under the cog. The global variable named <code>env.encoded_auth</code> will be the one that we&rsquo;ll use to build the spotify API transaction.</p><p><a href=#R-image-adc08c55f35f423f9f6bee06e10acedf class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/1-global-varilables/../../img/global-variables.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-adc08c55f35f423f9f6bee06e10acedf><img src=../en/other/synthetics-scripting/2-api-test/1-global-varilables/../../img/global-variables.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=create-new-api-test>Create new API test</h1><h2 id=create-a-new-api-test>Create a new API test</h2><p>Create a new API test by clicking on the
<span class="btn cstyle blue"><button type=button>
Add new test</button></span> button and select <strong>API test</strong> from the dropdown. Name the test using <strong>your initials</strong> followed by <strong>Spotify API</strong> e.g. <strong>RWC - Spotify API</strong></p><p><a href=#R-image-0ca7de7c67d01fde949f29084f190973 class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/2-create-new-check/../../img/new-api-check.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0ca7de7c67d01fde949f29084f190973><img src=../en/other/synthetics-scripting/2-api-test/2-create-new-check/../../img/new-api-check.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=authentication-request>Authentication Request</h1><h2 id=add-authentication-request>Add Authentication Request</h2><p>Click on
<span class="btn cstyle transparent"><button type=button>
+ Add requests</button></span> and enter the request step name e.g. <strong>Authenticate with Spotify API</strong>.</p><p><a href=#R-image-c79350899c947a1ac1149fa0d319588a class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/3-authentication-request/../../img/add-request.png alt=placeholder class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c79350899c947a1ac1149fa0d319588a><img src=../en/other/synthetics-scripting/2-api-test/3-authentication-request/../../img/add-request.png alt=placeholder class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Expand the Request section, from the drop-down change the request method to <strong>POST</strong> and enter the following URL:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://accounts.spotify.com/api/token</span></span></code></pre></div><p>In the <strong>Payload body</strong> section enter the following:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>grant_type=client_credentials</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/x-www-form-urlencoded</strong></li><li><strong>AUTHORIZATION: Basic {{env.encoded_auth}}</strong></li></ul><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.access_token</strong> <strong>as</strong> <strong>access_token</strong>.</li></ul><p>This will parse the JSON payload that is received from the Spotify API, extract the access token and store it as a custom variable.</p><p><a href=#R-image-15641d56379eb83c97f3427a1fed5c3a class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/3-authentication-request/../../img/add-payload-token.png alt="Add payload token" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15641d56379eb83c97f3427a1fed5c3a><img src=../en/other/synthetics-scripting/2-api-test/3-authentication-request/../../img/add-payload-token.png alt="Add payload token" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=search-request>Search Request</h1><h2 id=add-search-request>Add Search Request</h2><p>Click on
<span class="btn cstyle transparent"><button type=button>
+ Add Request</button></span> to add the next step. Name the step <strong>Search for Tracks named &ldquo;Up around the bend&rdquo;</strong>.</p><p>Expand the <strong>Request</strong> section and change the request method to <strong>GET</strong> and enter the following URL:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://api.spotify.com/v1/search?q=Up%20around%20the%20bend&amp;type=track&amp;offset=0&amp;limit=5</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/json</strong></li><li><strong>AUTHORIZATION: Bearer {{custom.access_token}}</strong></li></ul><p><a href=#R-image-0536326f12de6707427e996da59adee3 class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/4-search-request/../../img/add-search-request.png alt="Add search request" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0536326f12de6707427e996da59adee3><img src=../en/other/synthetics-scripting/2-api-test/4-search-request/../../img/add-search-request.png alt="Add search request" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.tracks.items[0].id</strong> <strong>as</strong> <strong>track.id</strong>.</li></ul><p><a href=#R-image-7d41872636b3e8d367689032bbe15be5 class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/4-search-request/../../img/add-search-payload.png alt="Add search payload" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7d41872636b3e8d367689032bbe15be5><img src=../en/other/synthetics-scripting/2-api-test/4-search-request/../../img/add-search-payload.png alt="Add search payload" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click on
<span class="btn cstyle blue"><button type=button>
< Return to test</button></span> to return to the test configuration page. And then click
<span class="btn cstyle blue"><button type=button>
Save</button></span> to save the API test.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=view-results>View results</h1><h2 id=view-results>View results</h2><p>Wait for a few minutes for the test to provision and run. Once you see the test has run successfully, click on the run to view the test results:</p><p><a href=#R-image-7f3a7e6fc755f06f549a2791ba321fff class=lightbox-link><img src=../en/other/synthetics-scripting/2-api-test/5-view-results/../../img/api-test-result.png alt="API test result" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7f3a7e6fc755f06f549a2791ba321fff><img src=../en/other/synthetics-scripting/2-api-test/5-view-results/../../img/api-test-result.png alt="API test result" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=6-resources>6. Resources</h2><ul><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/set-up-api-test.html target=_blank>How to Create an API Test</a></p></li><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html target=_blank>API Test Overview</a></p></li></ul><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-oncall>Splunk OnCall</h1><h2 id=aim>Aim</h2><p>This module is simply to ensure you have access to the Splunk On-Call UI (formerly known as VictorOps), Splunk Infrastructure Monitoring UI (formerly known as SignalFx) and the EC2 Instance which has been allocated to you.</p><p>Once you have access to each platform, keep them open for the duration of the workshop as you will be switching between them and the workshop instructions.</p><h2 id=1-activate-your-splunk-on-call-login>1. Activate your Splunk On-Call Login</h2><p>You should have received an invitation to Activate your Splunk On-Call account via e-mail, if you have not already done so, click the <em>Activate Account</em> link and follow the prompts.</p><p>If you did not receive an invitation it is probably because you already have a Splunk On-Call login, linked to a different organisation.</p><p>If so login to that Org, then use the organisation dropdown next to your username in the top left to switch to the Observability Workshop Org.</p><p><a href=#R-image-6ad7dd99593b9a15d81fe4e7f40d0b56 class=lightbox-link><img src=../en/other/oncall/images/switch-org.png alt="Switch Org" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ad7dd99593b9a15d81fe4e7f40d0b56><img src=../en/other/oncall/images/switch-org.png alt="Switch Org" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>If you do not see the Organisation dropdown menu item next to your name with Observability Workshop EMEA that is OK, it simply means you only have access to a single Org so that menu is not visible to you.</p><p>If you have forgotten your password go to the <a href=https://portal.victorops.com/membership/#/ target=_blank>https://portal.victorops.com/membership/#/</a> page and use the forgotten password link to reset your password.</p><p><a href=#R-image-87fb9242ab8f5a3bab2fe87a7dd58248 class=lightbox-link><img src=../en/other/oncall/images/reset-password.png alt="Reset Pwd" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-87fb9242ab8f5a3bab2fe87a7dd58248><img src=../en/other/oncall/images/reset-password.png alt="Reset Pwd" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><h2 id=2-activate-your-splunk-infrastructure-monitoring-login>2. Activate your Splunk Infrastructure Monitoring Login</h2><p>You should have received an invitation to join the Splunk Infrastructure Monitoring - Observability Workshop. If you have not already done so click the
<span class="btn cstyle transparent"><button type=button>
JOIN NOW</button></span> button and follow the prompts to set a password and activate your login.</p><h2 id=3-access-your-ec2-instance>3. Access your EC2 Instance</h2><p>Splunk has provided you with a dedicated EC2 Instance which you can use during this workshop for triggering Incidents the same way the instructor did during the introductory demo. This VM has Splunk Infrastructure Monitoring deployed and has an associated Detector configured. The Detector will pass Alerts to Splunk On-Call which will then create Incidents and page the on-call user.</p><p>The welcome e-mail you received providing you all the details for this Workshop contain the instructions for accessing your allocated EC2 Instance.</p><h3 id=ssh-mac-oslinux>SSH (Mac OS/Linux)</h3><p>Most attendees will be able to connect to the workshop by using SSH from their Mac or Linux device.</p><p>To use SSH, open a terminal on your system and type <code>ssh ubuntu@x.x.x.x</code> (replacing x.x.x.x with the IP address found in your welcome e-mail).</p><p><a href=#R-image-e6e22222cebb7d20c355593fb4249fee class=lightbox-link><img src=../en/other/oncall/images/ssh-1.png alt="ssh login" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e6e22222cebb7d20c355593fb4249fee><img src=../en/other/oncall/images/ssh-1.png alt="ssh login" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>When prompted <strong><code>Are you sure you want to continue connecting (yes/no/[fingerprint])?</code></strong> please type <strong><code>yes</code></strong>.</p><p><a href=#R-image-68b5a25e261c6c056b3b242746d41f5f class=lightbox-link><img src=../en/other/oncall/images/ssh-2.png alt="ssh password" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68b5a25e261c6c056b3b242746d41f5f><img src=../en/other/oncall/images/ssh-2.png alt="ssh password" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Enter the password provided in the welcome e-mail.</p><p>Upon successful login you will be presented with the Splunk logo and the Linux prompt.</p><p><a href=#R-image-af60f1d1f8d3bcc12ad7ae25286690c2 class=lightbox-link><img src=../en/other/oncall/images/ssh-3.png alt="ssh connected" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af60f1d1f8d3bcc12ad7ae25286690c2><img src=../en/other/oncall/images/ssh-3.png alt="ssh connected" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>At this point you are ready to <a href=../en/other/oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><hr><h3 id=putty-windows-users-only>Putty (Windows users only)</h3><p>If you do not have ssh pre-installed or if you are on a Windows system, the best option is to install putty, you can find the downloads <a href=https://www.putty.org/ target=_blank>here</a>.</p><p>!!! important
If you <strong>cannot</strong> install Putty, please go to <a href=../en/other/oncall/index.html#web-browser-all>Web Browser (All)</a>.</p><p>Open Putty and in the <strong>Host Name (or IP address)</strong> field enter the IP address provided in the welcome e-mail.</p><p>You can optionally save your settings by providing a name and pressing <strong>Save</strong>.</p><p><a href=#R-image-9f7cfe4301f0e2a0fcc7f01b4bd85394 class=lightbox-link><img src=../en/other/oncall/images/putty-settings.png alt=putty-2 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f7cfe4301f0e2a0fcc7f01b4bd85394><img src=../en/other/oncall/images/putty-settings.png alt=putty-2 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To then login to your instance click on the <strong>Open</strong> button as shown above.</p><p>If this is the first time connecting to your EC2 instance, you will be presented with a security dialogue, please click <strong>Yes</strong>.</p><p><a href=#R-image-48c1074386a57cc61e60f5811b605bed class=lightbox-link><img src=../en/other/oncall/images/putty-security.png alt=putty-3 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-48c1074386a57cc61e60f5811b605bed><img src=../en/other/oncall/images/putty-security.png alt=putty-3 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once connected, login in as <strong>ubuntu</strong> using the password provided in the welcome e-mail.</p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-893992f43ee025fa4f868617674f02f8 class=lightbox-link><img src=../en/other/oncall/images/putty-loggedin.png alt=putty-4 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-893992f43ee025fa4f868617674f02f8><img src=../en/other/oncall/images/putty-loggedin.png alt=putty-4 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>At this point you are ready to <a href=../en/other/oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><hr><h3 id=web-browser-all>Web Browser (All)</h3><p>If you are blocked from using SSH (Port 22) or unable to install Putty you may be able to connect to the workshop instance by using a web browser.</p><p>!!! note
This assumes that access to port 6501 is not restricted by your company&rsquo;s firewall.</p><p>Open your web browser and type <code>http://x.x.x.x:650</code> (where <code>x.x.x.x</code> is the IP address from the welcome e-mail).</p><p><a href=#R-image-9b2d0cbe529b129d3d797135a6087ffd class=lightbox-link><img src=../en/other/oncall/images/shellinabox-url.png alt=http-6501 class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9b2d0cbe529b129d3d797135a6087ffd><img src=../en/other/oncall/images/shellinabox-url.png alt=http-6501 class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once connected, login in as <strong>ubuntu</strong> and the password is the one provided in the welcome e-mail.</p><p><a href=#R-image-005af00c3b24a551af187b1dd64dae23 class=lightbox-link><img src=../en/other/oncall/images/shellinabox-connect.png alt=http-connect class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-005af00c3b24a551af187b1dd64dae23><img src=../en/other/oncall/images/shellinabox-connect.png alt=http-connect class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once you are connected successfully you should see a screen similar to the one below:</p><p><a href=#R-image-3a48e0d12e89e7a2d60482926d9db228 class=lightbox-link><img src=../en/other/oncall/images/shellinabox-login.png alt="web login" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3a48e0d12e89e7a2d60482926d9db228><img src=../en/other/oncall/images/shellinabox-login.png alt="web login" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><h3 id=copy--paste-in-browser>Copy & Paste in browser</h3><p>Unlike when you are using regular SSH, <em>copy and paste</em> does require a few extra steps to complete when using a browser session. This is due to cross browser restrictions.</p><p>When the workshop asks you to copy instructions into your terminal, please do the following:</p><p><em>Copy the instruction as normal, but when ready to paste it in the web terminal, choose <strong>Paste from browser</strong> as show below:</em></p><p><a href=#R-image-8d4239996a6ff7fe507f1e0b5c887e55 class=lightbox-link><img src=../en/other/oncall/images/shellinabox-paste-browser.png alt="web paste 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d4239996a6ff7fe507f1e0b5c887e55><img src=../en/other/oncall/images/shellinabox-paste-browser.png alt="web paste 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open a dialogue box asking for the text to be pasted into the web terminal:</p><p><a href=#R-image-d402f648947a92cd6520e59111ecba1b class=lightbox-link><img src=../en/other/oncall/images/shellinabox-example-1.png alt="web paste 3" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d402f648947a92cd6520e59111ecba1b><img src=../en/other/oncall/images/shellinabox-example-1.png alt="web paste 3" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Paste the text in the text box as show, then press <strong>OK</strong> to complete the copy and paste process.</p><div class="box notices cstyle primary"><div class=box-label></div><div class=box-content><p>Unlike regular SSH connection, the web browser has a 60 second time out, and you will be disconnected, and a <strong>Connect</strong> button will be shown in the center of the web terminal.</p><p>Simply click the <strong>Connect</strong> button and you will be reconnected and will be able to continue.</p></div></div><p>At this point you are ready to <a href=../en/other/oncall/getting_started/index.html>continue with the workshop</a> when instructed to do so by the instructor</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Splunk OnCall</h1><article class=default><header class=headline></header><h1 id=user-profile>User Profile</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to configure your personal profile which controls how you will be notified by Splunk On-Call whenever you get paged.</p><h2 id=1-contact-methods>1. Contact Methods</h2><p>Switch to the Splunk On-Call UI and click on your login name in the top right hand corner and chose <strong>Profile</strong> from the drop down. Confirm your contact methods are listed correctly and add any additional phone numbers and e-mail address you wish to use.</p><h2 id=2-mobile-devices>2. Mobile Devices</h2><p>To install the Splunk On-Call app for your smartphone search your phones App Store for Splunk On-Call to find the appropriate version of the app. The publisher should be listed as VictorOps Inc.</p><p><a href=https://apps.apple.com/us/app/victorops/id696974262 target=_blank>Apple Store</a></p><p><a href="https://play.google.com/store/apps/details?id=com.victorops.androidclient&amp;hl=en" target=_blank>Google Play</a></p><p>Configuration help guides are available:</p><ul><li><a href=https://help.victorops.com/knowledge-base/ios-application/ target=_blank>Apple</a></li><li><a href=https://help.victorops.com/knowledge-base/android-devices-victorops/ target=_blank>Android</a></li></ul><p>Install the App and login, then refresh the Profile page and your device should now be listed under the devices section. Click the <strong>Test push notification</strong> button and confirm you receive the test message.</p><h2 id=3-personal-calendar>3. Personal Calendar</h2><p>This link will enable you to sync your on-call schedule with your calendar, however as you do not have any allocated shifts yet this will currently be empty. You can add it to your calendar by copying the link into your preferred application and setting it up as a new subscription.</p><h2 id=4-paging-policies>4. Paging Policies</h2><p>Paging Polices specify how you will be contacted when on-call. The Primary Paging Policy will have defaulted to sending you an SMS assuming you added your phone number when activating your account. We will now configure this policy into a three tier multi-stage policy similar to the image below.</p><p><a href=#R-image-34d3b9fea9d586c045ce8758f72fd630 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/primary-paging-policy.png alt="Paging Policy" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34d3b9fea9d586c045ce8758f72fd630><img src=../en/other/oncall/getting_started/../images/primary-paging-policy.png alt="Paging Policy" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h3 id=41-send-a-push-notification>4.1 Send a push notification</h3><p>Click the edit policy button in the top right corner for the Primary Paging Policy.</p><ul><li>Send a push notification to all my devices</li><li>Execute the next step if I have not responded within 5 minutes</li></ul><p><a href=#R-image-a95a9e98b554f61cb9383c6abe77d4c9 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/pri-page-step1.png alt="Step 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a95a9e98b554f61cb9383c6abe77d4c9><img src=../en/other/oncall/getting_started/../images/pri-page-step1.png alt="Step 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click <strong>Add a Step</strong></p><h3 id=42-send-an-e-mail>4.2 Send an e-mail</h3><ul><li>Send an e-mail to [your email address]</li><li>Execute the next step if I have not responded within 5 minutes</li></ul><p><a href=#R-image-5b286b2c7ea7d6b03730bbb1c03554e0 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/pri-page-step2.png alt="Step 2" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5b286b2c7ea7d6b03730bbb1c03554e0><img src=../en/other/oncall/getting_started/../images/pri-page-step2.png alt="Step 2" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click <strong>Add a Step</strong></p><h3 id=43-call-your-number>4.3 Call your number</h3><ul><li>Every 5 minutes until we have reached you</li><li>Make a phone call to [your phone number]</li></ul><p>Click
<span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><button type=button>
Save</button></span> to save the policy.</p><p><a href=#R-image-b88bd933c7180f55efb3d71a7e5e67c1 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/pri-page-step3.png alt="Step 3" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b88bd933c7180f55efb3d71a7e5e67c1><img src=../en/other/oncall/getting_started/../images/pri-page-step3.png alt="Step 3" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>When you are on-call or in the escalation path of an incident, you will receive notifications in this order following these time delays.</p><p>To cease the paging you must acknowledge the incident. Acknowledgements can occur in one of the following ways:</p><ul><li>Expanding the Push Notification on your device and selecting Acknowledge</li><li>Responding to the SMS with the 5 digit code included</li><li>Pressing 4 during the Phone Call</li><li>Slack Button</li></ul><p>For more information on Notification Types, see <a href=https://help.victorops.com/knowledge-base/notification-types/ target=_blank>here</a>.</p><h2 id=5-custom-paging-policies>5. Custom Paging Policies</h2><p>Custom paging polices enable you to override the primary policy based on the time and day of the week. A good example would be to get the system to immediately phone you whenever you get a page during the evening or weekends as this is more likely to get your attention than a push notification.</p><p>Create a new Custom Policy by clicking <strong>Add a Policy</strong> and configure with the following settings:</p><h3 id=51-custom-evening-policy>5.1 Custom evening policy</h3><p>Policy Name: Evening</p><ul><li>Every 5 minutes until we have reached you<ul><li>Make a phone call to [your phone number]</li><li>Time Period: All 7 Days</li><li>Time zone<ul><li>Between 7pm and 9am</li></ul></li></ul></li></ul><p><a href=#R-image-bd4b512cea40de6c1a4fad024bf79b71 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/evening.png alt=Evening class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bd4b512cea40de6c1a4fad024bf79b71><img src=../en/other/oncall/getting_started/../images/evening.png alt=Evening class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click
<span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><button type=button>
Save</button></span> to save the policy then add one more.</p><h3 id=52-custom-weekend-policy>5.2 Custom weekend policy</h3><p>Policy Name: Weekend</p><ul><li>Every 5 minutes until we have reached you<ul><li>Make a phone call to [your phone number]</li><li>Time Period: Sat & Sun</li><li>Time zone<ul><li>Between 9am and 7pm</li></ul></li></ul></li></ul><p>Click
<span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><button type=button>
Save</button></span> to save the policy.</p><p><a href=#R-image-7b822deba1d2d058288fdd710d7f6d77 class=lightbox-link><img src=../en/other/oncall/getting_started/../images/weekends.png alt=Weekends class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7b822deba1d2d058288fdd710d7f6d77><img src=../en/other/oncall/getting_started/../images/weekends.png alt=Weekends class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>These custom paging policies will be used during the specified times in place of the Primary Policy. However, admins do have the ability to ignore these custom policies, and we will highlight how this is achieved in a later module.</p><p>The final option here is the setting for Recovery Notifications. These are typically low priority, will default to Push, but can also be email, sms or phone call. Your profile is now fully configured using these example configurations.</p><p>Organizations will have different views on how profiles should be configured and will typically issue guidelines for paging policies and times between escalations etc.</p><p>Please wait for the instructor before proceeding to the Teams module.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of User Profile</h1><article class=default><header class=headline></header><h1 id=teams>Teams</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to complete the first step of Team configuration by adding users to your Team.</p><h2 id=1-find-your-team>1. Find your Team</h2><p>Navigate to the <strong>Teams</strong> tab on the main toolbar, you should find you that a Team has been created for you as part of the workshop pre-setup and you would have been informed of your Team Name via e-mail.</p><p>If you have found your pre-configured Team, <strong>skip Step 2.</strong> and proceed to <strong><a href=../en/other/oncall/getting_started/team/index.html#3-configure-your-team>Step 3. Configure Your Team</a></strong>. However, if you cannot find your allocated Team, you will need to create a new one, so proceed with <strong>Step 2. Create Team</strong></p><h2 id=2-create-team>2. Create Team</h2><p>Only complete this step if you <strong>cannot</strong> find your pre-allocated Team as detailed in your workshop e-mail. Select <strong>Add Team</strong>, then enter your allocated team name, this will typically be in the format of &ldquo;AttendeeID Workshop&rdquo; and then save by clicking the <strong>Add Team</strong> button.</p><h2 id=3-configure-your-team>3. Configure Your Team</h2><p>You now need to add other users to your team. If you are running this workshop using the Splunk provided environment, the following accounts are available for testing. If you are running this lab in your own environment, you will have been provided a list of usernames you can use in place of the table below.</p><p>These users are dummy accounts who will not receive notifications when they are on call.</p><table><thead><tr><th>Name</th><th>Username</th><th>Shift</th></tr></thead><tbody><tr><td>Duane Chow</td><td>duanechow</td><td>Europe</td></tr><tr><td>Steven Gomez</td><td>gomez</td><td>Europe</td></tr><tr><td>Walter White</td><td>heisenberg</td><td>Europe</td></tr><tr><td>Jim Halpert</td><td>jimhalpert</td><td>Asia</td></tr><tr><td>Lydia Rodarte-Quayle</td><td>lydia</td><td>Asia</td></tr><tr><td>Marie Schrader</td><td>marie</td><td>Asia</td></tr><tr><td>Maximo Arciniega</td><td>maximo</td><td>West Coast</td></tr><tr><td>Michael Scott</td><td>michaelscott</td><td>West Coast</td></tr><tr><td>Tuco Salamanca</td><td>tuco</td><td>West Coast</td></tr><tr><td>Jack Welker</td><td>jackwelker</td><td>24/7</td></tr><tr><td>Hank Schrader</td><td>hank</td><td>24/7</td></tr><tr><td>Pam Beesly</td><td>pambeesly</td><td>24/7</td></tr></tbody></table><p>Add the users to your team, using either the above list or the alternate one provided to you. The value in the <strong>Shift</strong> column can be ignored for now, but will be required for a later step.</p><p>Click
<span class="btn cstyle default" style=--VARIABLE-BOX-color:#00bce4><button type=button>
Invite User</button></span> button on the right hand side, then either start typing the usernames (this will filter the list), or copy and paste them into the dialogue box. Once all users are added to the list click the <strong>Add User</strong> button.</p><p><a href=#R-image-71155c7c39128d3a6a93d4dde648ec83 class=lightbox-link><img src=../en/other/oncall/getting_started/team/../../images/add-team-members.png alt="Add Team Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-71155c7c39128d3a6a93d4dde648ec83><img src=../en/other/oncall/getting_started/team/../../images/add-team-members.png alt="Add Team Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>To make a team member a Team Admin, simply click the :fontawesome-regular-edit: icon in the right hand column, pick any user and make them an Admin.</p><p><a href=#R-image-a38028503b002b0bd9e70b2844133a95 class=lightbox-link><img src=../en/other/oncall/getting_started/team/../../images/team-admin.png alt="Add Admin" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a38028503b002b0bd9e70b2844133a95><img src=../en/other/oncall/getting_started/team/../../images/team-admin.png alt="Add Admin" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle default" style=--VARIABLE-BOX-color:info><div class=box-label>Tip</div><div class=box-content><p>For large team management you can use the APIs to streamline this process.</p></div></div><p>Continue and also complete the <a href=../en/other/oncall/getting_started/rotations/index.html>Configure Rotations</a> module.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=configure-rotations>Configure Rotations</h1><h2 id=aim>Aim</h2><p>A rotation is a recurring schedule, that consists of one or more shifts, with members who rotate through a shift.</p><p>The aim of this module is for you to configure two example Rotations, and assign Team Members to the Rotations.</p><hr><p>Navigate to the <strong>Rotations</strong> tab on the <strong>Teams</strong> sub menu, you should have no existing Rotations so we need to create some.</p><p>The 1st Rotation you will create is for a follow the sun support pattern where the members of each shift provide cover during their normal working hours within their time zone.</p><p>The 2nd will be a Rotation used to provide escalation support by more experienced senior members of the team, based on a 24/7, 1 week shift pattern.</p><h2 id=1-follow-the-sun-support---business-hours>1. Follow the Sun Support - Business Hours</h2><p>Click <strong>Add Rotation</strong></p><p><a href=#R-image-91fb6b99a02f6ee31590017a93b995cb class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/add-rotation.png alt="Add Rotation" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-91fb6b99a02f6ee31590017a93b995cb><img src=../en/other/oncall/getting_started/rotations/../../images/add-rotation.png alt="Add Rotation" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Enter a name of &ldquo;<em>Follow the Sun Support - Business Hours</em>&rdquo; and Select <strong>Partial day</strong> from the three available shift templates.</p><p><a href=#R-image-12c33a3c8ca4dcd8ca9e977d6de9908d class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/follow-the-sun.png alt="Follow the Sun" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-12c33a3c8ca4dcd8ca9e977d6de9908d><img src=../en/other/oncall/getting_started/rotations/../../images/follow-the-sun.png alt="Follow the Sun" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Enter a Shift name of &ldquo;<em>Asia</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Asia/Tokyo</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Rotation</strong></li></ul><p><a href=#R-image-c79874b96fb2b45651ecf2dc25d4916a class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/asia-shift.png alt="Asia Shift" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c79874b96fb2b45651ecf2dc25d4916a><img src=../en/other/oncall/getting_started/rotations/../../images/asia-shift.png alt="Asia Shift" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will now be prompted to add Members to this shift; add the Asia members who are <strong>Jim Halpert, Lydie Rodarte-Quayle and Marie Schrader</strong>, but only if you&rsquo;re using the Splunk provided environment for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-4dc9849ea5361c06e1b1f12d0cc340b1 class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/asia-members.png alt="Asia Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4dc9849ea5361c06e1b1f12d0cc340b1><img src=../en/other/oncall/getting_started/rotations/../../images/asia-members.png alt="Asia Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now add an 2nd shift for Europe by again clicking <strong>+Add a shift ‚Üí Partial Day</strong></p><ul><li>Enter a Shift name of &ldquo;<em>Europe</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Europe/London</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Shift</strong></li></ul><p><a href=#R-image-85567a46dc2b84fb3fe8df9ac1d2fda3 class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/europe-shift.png alt="Europe Shift" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85567a46dc2b84fb3fe8df9ac1d2fda3><img src=../en/other/oncall/getting_started/rotations/../../images/europe-shift.png alt="Europe Shift" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will again be prompted to add Members to this shift; add the Europe members who are <strong>Duane Chow, Steven Gomez and Walter White</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-52d70656d9388c14c6e0e8450fbd79e1 class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/europe-members.png alt="Europe Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-52d70656d9388c14c6e0e8450fbd79e1><img src=../en/other/oncall/getting_started/rotations/../../images/europe-members.png alt="Europe Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Now add a 3rd shift for West Coast USA by again clicking <code>+Add a shift</code> - <code>Partial Day</code></p><ul><li>Enter a Shift name of &ldquo;<em>West Coast</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>US/Pacific</em>&rdquo;</li><li>Each user is on duty from &ldquo;<em>Monday through Friday from 9.00am to 5.00pm</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>5 days</em>&rdquo;</li><li>The next handoff happens - Select the next Monday using the calendar</li><li>Click <strong>Save Shift</strong></li></ul><p><a href=#R-image-c1f44a10d351ea40f0d75c55d27b05ed class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/west-coast-shift.png alt="West Coast Shift" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c1f44a10d351ea40f0d75c55d27b05ed><img src=../en/other/oncall/getting_started/rotations/../../images/west-coast-shift.png alt="West Coast Shift" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will again be prompted to add Members to this shift; add the West Coast members who are <strong>Maximo Arciniega, Michael Scott and Tuco Salamanca</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-975e9b52c66adbe24085f696e59b93d4 class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/west-coast-members.png alt="West Coast Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-975e9b52c66adbe24085f696e59b93d4><img src=../en/other/oncall/getting_started/rotations/../../images/west-coast-members.png alt="West Coast Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The first user added will be the &lsquo;current&rsquo; user for that shift.</p><p>You can re-order the shifts by simply dragging the users up and down, and you can change the current user by clicking <code>Set Current</code> on an alternate user</p><p>You will now have three different Shift patterns, that provide cover 24hr hours, Mon - Fri, but with no cover at weekends.</p><p>We will now add another Rotation for our Senior SRE Escalation cover.</p><hr><h2 id=2-senior-sre-escalation>2. Senior SRE Escalation</h2><ul><li>Click <strong>Add Rotation</strong></li><li>Enter a name of &ldquo;<em>Senior SRE Escalation</em>&rdquo;</li><li>Select <code>24/7</code> from the three available shift templates</li><li>Enter a Shift name of &ldquo;<em>Senior SRE Escalation</em>&rdquo;</li><li>Time Zone set to &ldquo;<em>Asia/Tokyo</em>&rdquo;</li><li>Handoff happens every &ldquo;<em>7 days at 9.00am</em>&rdquo;</li><li>The next handoff happens [select the next Monday from the date picker]</li><li>Click <strong>Save Rotation</strong></li></ul><p><a href=#R-image-7731fc9880fe00b29bf4dde154f5debd class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/24-7-shift.png alt="24/7 Shift" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7731fc9880fe00b29bf4dde154f5debd><img src=../en/other/oncall/getting_started/rotations/../../images/24-7-shift.png alt="24/7 Shift" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will again be prompted to add Members to this shift; add the 24/7 members who are <strong>Jack Welker, Hank Schrader and Pam Beesly</strong>, but only if you&rsquo;re using the Observability Workshop Org for this workshop.</p><p>If you&rsquo;re using your own Organisation refer to the specific list provided separately.</p><p><a href=#R-image-23d909e22bdaf73992a3a851abacc7cf class=lightbox-link><img src=../en/other/oncall/getting_started/rotations/../../images/24-7-members.png alt="24/7 Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-23d909e22bdaf73992a3a851abacc7cf><img src=../en/other/oncall/getting_started/rotations/../../images/24-7-members.png alt="24/7 Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><hr><p>Please wait for the instructor before proceeding to the Configuring Escalation Policies module.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=configure-escalation-policies>Configure Escalation Policies</h1><h2 id=aim>Aim</h2><p>Escalation policies determine who is actually on-call for a given team and are the link to utilizing any rotations that have been created.</p><p>The aim of this module is for you to create three different Escalation Policies to demonstrate a number of different features and operating models.</p><p>The instructor will start by explaining the concepts before you proceed with the configuration.</p><hr><p>Navigate to the Escalation Polices tab on the Teams sub menu, you should have no existing Polices so we need to create some.</p><p><a href=#R-image-e356f6d2be2e2485088399caa61d87dc class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/no-escalation.png alt="No Escalation Policies" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e356f6d2be2e2485088399caa61d87dc><img src=../en/other/oncall/getting_started/escalation/../../images/no-escalation.png alt="No Escalation Policies" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We are going to create the following Polices to cover off three typical use cases.</p><p><a href=#R-image-bc7e377a335acf8f36baac9c0dfe1b46 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/escalation-policies.png alt="Escalation Policies" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bc7e377a335acf8f36baac9c0dfe1b46><img src=../en/other/oncall/getting_started/escalation/../../images/escalation-policies.png alt="Escalation Policies" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=1-247-policy>1. 24/7 Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: 24/7</li><li>Step 1</li><li>Immediately<ul><li>Notify the on-duty user(s) in rotation ‚Üí Senior SRE Escalation</li><li>Click <strong>Save</strong></li></ul></li></ul><p><a href=#R-image-a88a4c0fb8d925b9b2e1416b3810cc77 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/24-7-escalation-policy.png alt="24/7 Escalation Policy " class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a88a4c0fb8d925b9b2e1416b3810cc77><img src=../en/other/oncall/getting_started/escalation/../../images/24-7-escalation-policy.png alt="24/7 Escalation Policy " class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-primary-policy>2. Primary Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: Primary</li><li>Step 1</li><li>Immediately</li><li>Notify the on-duty user(s) in rotation ‚Üí Follow the Sun Support - Business Hours</li><li>Click <strong>Add Step</strong></li></ul><p><a href=#R-image-a1c81252c38756a8a7fa85c11a710863 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-1.png alt="Pri Escalation Policy Step 1" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a1c81252c38756a8a7fa85c11a710863><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-1.png alt="Pri Escalation Policy Step 1" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Step 2</li><li>If still un-acknowledged after 15 minutes</li><li>Notify the next user(s) in the current on-duty shift ‚Üí Follow the Sun Support - Business Hours</li><li>Click <strong>Add Step</strong></li></ul><p><a href=#R-image-d739a048ff68a82449bee21f813a6f39 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-2.png alt="Pri Escalation Policy Step 2" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d739a048ff68a82449bee21f813a6f39><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-2.png alt="Pri Escalation Policy Step 2" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><ul><li>Step 3</li><li>If still un-acknowledged after 15 more minutes</li><li>Execute Policy ‚Üí [Your Team Name] : 24/7</li><li>Click <strong>Save</strong></li></ul><p><a href=#R-image-f67bd5fcbe6e53258092441995cf98e7 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-3.png alt="Pri Escalation Policy Step 3" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f67bd5fcbe6e53258092441995cf98e7><img src=../en/other/oncall/getting_started/escalation/../../images/pri-escalation-policy-step-3.png alt="Pri Escalation Policy Step 3" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-waiting-room-policy>3. Waiting Room Policy</h2><p>Click <strong>Add Escalation Policy</strong></p><ul><li>Policy Name: Waiting Room</li><li>Step 1</li><li>If still un-acknowledged after 10 more minutes</li><li>Execute Policy ‚Üí [Your Team Name] : Primary</li><li>Click <strong>Save</strong></li></ul><p><a href=#R-image-0a43b3f19a416a8dfda575eb2b3f05c6 class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/wr-escalation-policy.png alt="WR Escalation Policy" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a43b3f19a416a8dfda575eb2b3f05c6><img src=../en/other/oncall/getting_started/escalation/../../images/wr-escalation-policy.png alt="WR Escalation Policy" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You should now have the following three escalation polices:</p><p><a href=#R-image-332a8a9d806a43b5df8b46c7de8c7c4f class=lightbox-link><img src=../en/other/oncall/getting_started/escalation/../../images/escalation-policies.png alt="Escalation Policies" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-332a8a9d806a43b5df8b46c7de8c7c4f><img src=../en/other/oncall/getting_started/escalation/../../images/escalation-policies.png alt="Escalation Policies" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You may have noticed that when we created each policy there was the following warning message:</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>There are no routing keys for this policy - it will only receive incidents via manual reroute or when on another escalation policy</p></div></div><p>This is because there are no Routing Keys linked to these Escalation Polices, so now that we have these polices configured we can create the Routing Keys and link them to our Polices..</p><hr><p>Continue and also complete the <a href=../en/other/oncall/getting_started/routing/index.html>Creating Routing Keys</a> module.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=creating-routing-keys>Creating Routing Keys</h1><h2 id=aim>Aim</h2><p>Routing Keys map the incoming alert messages from your monitoring system to an Escalation Policy which in turn sends the notifications to the appropriate team.</p><p>Note that routing keys are case insensitive and should only be composed of letters, numbers, hyphens, and underscores.</p><p>The aim of this module is for you to create some routing keys and then link them to your Escalation Policies you have created in the previous exercise.</p><hr><h2 id=1-instance-id>1. Instance ID</h2><p>Each participant requires a unique Routing Key so we use the Hostname of the EC2 Instance you were allocated. We are only doing this to ensure your Routing Key is unique and we know all Hostnames are unique. In a production deployment the Routing Key would typically reflect the name of a System or Service being monitored, or a Team such as 1st Line Support etc.</p><p>Your welcome e-mail informed you of the details of your EC2 Instance that has been provided for you to use during this workshop and you should have logged into this as part of the 1st exercise.</p><p>The e-mail also contained the Hostname of the Instance, but you can also obtain it from the Instance directly. To get your Hostname from within the shell session connected to your Instance run the following command:</p><div class=tab-panel data-tab-group=4361e2f3aa9ca9d060a9c8280e9f8d5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=export-hostname class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("4361e2f3aa9ca9d060a9c8280e9f8d5d","export-hostname")'>
<span class=tab-nav-text>Export Hostname</span></button>
<button data-tab-item=example-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("4361e2f3aa9ca9d060a9c8280e9f8d5d","example-output")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div data-tab-item=export-hostname class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>echo</span> <span class=si>${</span><span class=nv>HOSTNAME</span><span class=si>}</span></span></span></code></pre></div></div></div><div data-tab-item=example-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>zevn</span></span></code></pre></div></div></div></div></div><p>It is very important that when creating the Routing Keys you use the 4 letter hostname allocated to you as a Detector has been configured within Splunk Infrastructure Monitoring using this hostname, so any deviation will cause future exercises to fail.</p><h2 id=2-create-routing-keys>2 Create Routing Keys</h2><p>Navigate to <strong>Settings</strong> on the main menu bar, you should now be at the <strong>Routing Keys</strong> page.</p><p>You are going to create the following two Routing Keys using the naming conventions listed in the following table, but replacing {==HOSTNAME==} with the value from above and replace <strong><code>TEAM_NAME</code></strong> with the team you were allocated or created earlier.</p><table><thead><tr><th>Routing Key</th><th>Escalation Policies</th></tr></thead><tbody><tr><td><strong><code>HOSTNAME</code></strong>_PRI</td><td><strong><code>TEAM_NAME</code></strong> : Primary</td></tr><tr><td><strong><code>HOSTNAME</code></strong>_WR</td><td><strong><code>TEAM_NAME</code></strong> : Waiting Room</td></tr></tbody></table><p>There will probably already be a number of Routing Keys configured, but to add a new one simply scroll to the bottom of the page and then click <strong>Add Key</strong></p><p>In the left hand box, enter the name for the key as per the table above. In the <strong>Routing Key</strong> column, select your Teams <strong>Primary</strong> policy from the drop down in the <strong>Escalation Polices</strong> column. You can start typing your Team Name to filter the results.</p><p><a href=#R-image-b1071c131bd740e580bac3eae162d322 class=lightbox-link><img src=../en/other/oncall/getting_started/routing/../../images/routing-key-add.png alt="Add Routing Key" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b1071c131bd740e580bac3eae162d322><img src=../en/other/oncall/getting_started/routing/../../images/routing-key-add.png alt="Add Routing Key" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Note</div><div class=box-content><p>If there are a large number of participants on the workshop, resulting in an unusually large number of Escalation Policies sometimes the search filter does not list all the Policies under your Team Name. If this happens instead of using the search feature, simply scroll down to your team name, all the policies will then be listed.</p></div></div><p>Repeat the above steps for both Keys, <strong><code>xxxx_PRI</code></strong> and <strong><code>xxxx_WR</code></strong>, mapping them to your Teams Primary and Waiting Room policies.</p><p>You should now have two Routing Keys configured, similar to the following:</p><p><a href=#R-image-e71b24a997bbc293c3e9f89bf933875b class=lightbox-link><img src=../en/other/oncall/getting_started/routing/../../images/routing-keys.png alt="Routing Keys" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e71b24a997bbc293c3e9f89bf933875b><img src=../en/other/oncall/getting_started/routing/../../images/routing-keys.png alt="Routing Keys" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>You can assign a Routing Key to multiple Escalation Policies if required by simply selecting more from the list</p></div></div><p>If you now navigate back to <strong>Teams ‚Üí [Your Team Name] ‚Üí Escalation Policies</strong> and look at the settings for your <strong>Primary</strong> and <strong>Waiting Room</strong> polices you will see that these now have <strong>Routes</strong> assigned to them.</p><p><a href=#R-image-c3a266db587e1a8a72824a0ba40395f6 class=lightbox-link><img src=../en/other/oncall/getting_started/routing/../../images/routing-keys-assigned.png alt="Routing Keys Assigned" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c3a266db587e1a8a72824a0ba40395f6><img src=../en/other/oncall/getting_started/routing/../../images/routing-keys-assigned.png alt="Routing Keys Assigned" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>The <strong>24/7</strong> policy does not have a Route assigned as this will only be triggered via an <strong>Execute Policy</strong> escalation from the <strong>Primary</strong> policy.</p><hr><p>Please wait for the instructor before proceeding to the Incident Lifecycle/Overview module.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=incident-lifecycle>Incident Lifecycle</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to get more familiar with the Timeline Tab and the filtering features.</p><h2 id=1-timeline>1. Timeline</h2><p>The aim of Splunk On-Call is to make being on call more bearable, and it does this by getting the critical data, to the right people, at the right time.</p><p>The key to making it work for you is to centralize all your alerting sources, sending them all to the Splunk On-Call platform, then you have a single pane of glass in which to manage all of your alerting.</p><p>Login to the Splunk On-Call UI and select the <strong>Timeline</strong> tab on the main menu bar, you should have a screen similar to the following image:</p><p><a href=#R-image-7ab5d317bb98c9463eacd04c84bac6a4 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/../images/m7-vo-ui.png alt="Splunk On-Call UI" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7ab5d317bb98c9463eacd04c84bac6a4><img src=../en/other/oncall/incident_lifecycle/../images/m7-vo-ui.png alt="Splunk On-Call UI" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=2-people>2. People</h2><p>On the left we have the <strong>People</strong> section with the <strong>Teams</strong> and <strong>Users</strong> sub tabs. On the <strong>Teams</strong> tab, click on <strong>All Teams</strong> then expand <em><strong>[Your Team name]</strong></em>.</p><p>Users with the Splunk On-Call Logo against their name are currently on call. Here you can see who is on call within a particular Team, or across all Teams via <strong>Users ‚Üí On-Call</strong>.</p><p>If you click into one of the currently on call users, you can see their status. It shows which Rotation they are on call for, when their current Shift ends and their next Shift starts (times are displayed in your time zone), what contact methods they have and which Teams they belong to (dummy users such as Hank do not have Contact Methods configured).</p><p><a href=#R-image-24f981e3d0a561cbdc4403b830fbe89a class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/../images/m7-user-detail.png alt="User Detail" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-24f981e3d0a561cbdc4403b830fbe89a><img src=../en/other/oncall/incident_lifecycle/../images/m7-user-detail.png alt="User Detail" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=3-timeline>3. Timeline</h2><p>In the centre <strong>Timeline</strong> section you get a realtime view of what is happening within your environment with the newest messages at the top. Here you can quickly post update messages to make your colleagues aware of important developments etc.</p><p>You can filter the view using the buttons on the top toolbar showing only update messages, GitHub integrations, or apply more advanced filters.</p><p>Lets change the Filters settings to streamline your view. Click the <strong>Filters</strong> button then within the <strong>Routing Keys</strong> tab change the <strong>Show</strong> setting from <strong>all routing keys</strong> to <strong>selected routing keys</strong>. Change the <strong>My Keys</strong> value to <strong>all</strong> and the <strong>Other Keys</strong> value to <strong>selected</strong> and deselect all keys under the Other Keys section.</p><p>Click anywhere outside of the dialogue box to close it.</p><p><a href=#R-image-1c56ccf8a9e06ba3ce3094ee79295ddd class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/../images/m7-timeline-filters.png alt="Timeline Filters" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1c56ccf8a9e06ba3ce3094ee79295ddd><img src=../en/other/oncall/incident_lifecycle/../images/m7-timeline-filters.png alt="Timeline Filters" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You will probably now have a much simpler view as you will not currently have Incidents created using your Routing Keys, so you are left with the other types of messages that the Timeline can display.</p><p>Click on <strong>Filters</strong> again, but this time switch to the <strong>Message Types</strong> tab. Here you control the types of messages that are displayed.</p><p>For example, deselect <strong>On-call Changes</strong> and <strong>Escalations</strong>, this will reduce the amount of messages displayed.</p><p><a href=#R-image-2e0b37a69ed2a2cb189e57a043f63074 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/../images/m7-timeline-filters-message-types.png alt="Timeline Filters Message Types" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2e0b37a69ed2a2cb189e57a043f63074><img src=../en/other/oncall/incident_lifecycle/../images/m7-timeline-filters-message-types.png alt="Timeline Filters Message Types" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=4-incidents>4. Incidents</h2><p>On the right we have the <strong>Incidents</strong> section. Here we get a list of all the incidents within the platform, or we can view a more specific list such as incidents you are specifically assigned to, or for any of the Teams you are a member of.</p><p>Select the <strong>Team Incidents</strong> tab you should find that the <strong>Triggered</strong>, <strong>Acknowledged</strong> & <strong>Resolved</strong> tabs are currently all empty as you have had no incidents logged.</p><p>Let&rsquo;s change that by generating your first incident!</p><p>Continue with the <a href=../en/other/oncall/incident_lifecycle/create_incidents/index.html>Create Incidents</a> module.</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Incident Lifecycle</h1><article class=default><header class=headline></header><h1 id=create-incidents>Create Incidents</h1><h2 id=aim>Aim</h2><p>The aim of this module is for you to place yourself &lsquo;On-Call&rsquo; then generate an Incident using the supplied EC2 Instance so you can then work through the lifecycle of an Incident.</p><hr><h2 id=1-on-call>1. On-Call</h2><p>Before generating any incidents you should assign yourself to the current Shift within your <strong>Follow the Sun Support - Business Hours</strong> Rotation and also place yourself <strong>On-Call</strong>.</p><ul><li>Click on the <strong>Schedule</strong> link within your <strong>Team</strong> in the <strong>People</strong> section on the left, or navigate to <strong>Teams ‚Üí [Your Team] ‚Üí Rotations</strong></li><li>Expand the <strong>Follow the Sun Support - Business Hours</strong> Rotation</li><li>Click on the <strong>Manage members</strong> icon (the figures) for the current active shift depending on your time zone
<a href=#R-image-0a54247ac99927807300bbb2cf96426f class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/create_incidents/../../images/manage-members.png alt="Manage Members" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a54247ac99927807300bbb2cf96426f><img src=../en/other/oncall/incident_lifecycle/create_incidents/../../images/manage-members.png alt="Manage Members" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li><li>Use the <strong>Select a user to add&mldr;</strong> dropdown to add yourself to the shift</li><li>Then click on <strong>Set Current</strong> next to your name to make yourself the current <strong>on-call</strong> user within the shift</li><li>You should now get a <strong>Push Notification</strong> to your phone informing you that <strong>You Are Now On-Call</strong>
<a href=#R-image-c313fa4fbcbc2b1fb81136b262c49d47 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/create_incidents/../../images/on-duty.png alt="On Duty" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c313fa4fbcbc2b1fb81136b262c49d47><img src=../en/other/oncall/incident_lifecycle/create_incidents/../../images/on-duty.png alt="On Duty" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></li></ul><h2 id=2-trigger-alert>2. Trigger Alert</h2><p>Switch back to your shell session connected to your EC2 Instance; all of the following commands will be executed from your Instance.</p><p>Force the CPU to spike to 100% by running the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>openssl speed -multi $(grep -ci processor /proc/cpuinfo)</span></span></code></pre></div><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Forked child 0
</span></span><span class=line><span class=cl>+DT:md4:3:16
</span></span><span class=line><span class=cl>+R:19357020:md4:3.000000
</span></span><span class=line><span class=cl>+DT:md4:3:64
</span></span><span class=line><span class=cl>+R:14706608:md4:3.010000
</span></span><span class=line><span class=cl>+DT:md4:3:256
</span></span><span class=line><span class=cl>+R:8262960:md4:3.000000
</span></span><span class=line><span class=cl>+DT:md4:3:1024</span></span></code></pre></div><p>This will result in an Alert being generated by Splunk Infrastructure Monitoring which in turn will generate an Incident within Splunk On-Call within a maximum of 10 seconds. This is the default polling time for the OpenTelemetry Collector installed on your instance (note it can be reduced to 1 second).</p><hr><p>Continue with the <a href=../en/other/oncall/incident_lifecycle/manage_incidents/index.html>Manage Incidents</a> module.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=manage-incidents>Manage Incidents</h1><h2 id=1-acknowledge>1. Acknowledge</h2><p>Use your Splunk On-Call App on your phone to acknowledge the Incident by clicking on the <strong>push notification</strong> &mldr;</p><p><a href=#R-image-b59d00d6169c360dd01ddebbdb14d115 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/mobile-notification.png alt="Push Notification" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b59d00d6169c360dd01ddebbdb14d115><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/mobile-notification.png alt="Push Notification" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>&mldr;to open the alert in the Splunk On-Call mobile app, then clicking on either the <strong>single tick</strong> in the top right hand corner, or the <strong>Acknowledge</strong> link to acknowledge the incident and stop the escalation process.</p><p>The :fontawesome-solid-check: will then transform into a :fontawesome-solid-check::fontawesome-solid-check:, and the status will change from <strong>TRIGGERED</strong> to <strong>ACKNOWLEDGED</strong>.</p><table><thead><tr><th>Triggered Incident</th><th>Acknowledge Incident</th></tr></thead><tbody><tr><td><a href=#R-image-58886b6f34b8e7a4b3ffcca080e8d667 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-annotations.png alt="Acknowledge Alert" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-58886b6f34b8e7a4b3ffcca080e8d667><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-annotations.png alt="Acknowledge Alert" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></td><td><a href=#R-image-069fb8bfe9f2514c3eab557c95a80552 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-alert-acknowledged.png alt="Alert Acknowledged" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-069fb8bfe9f2514c3eab557c95a80552><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-alert-acknowledged.png alt="Alert Acknowledged" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></td></tr></tbody></table><h2 id=2-details-and-annotations>2. Details and Annotations</h2><p>Still on your phone, select the Alert Details tab. Then on the Web UI, navigate back to <strong>Timeline</strong>, select <strong>Team Incidents</strong> on the right, then select <strong>Acknowledged</strong> and click into the new <strong>Incident</strong>, this will open up the War Room Dashboard view of the Incident.</p><p>You should now have the <strong>Details</strong> tab displayed on both your Phone and the Web UI. Notice how they both show the exact same information.</p><p>Now select the <strong>Annotations</strong> tab on both the Phone and the Web UI, you should have a <strong>Graph</strong> displayed in the UI which is generated by Splunk Infrastructure Monitoring.</p><p><a href=#R-image-ff83d4b90a4f5bce56ad4216e69fd2d3 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/ui-annotations.png alt="UI Annotations" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ff83d4b90a4f5bce56ad4216e69fd2d3><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/ui-annotations.png alt="UI Annotations" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>On your phone you should get the same image displayed (sometimes it&rsquo;s a simple hyperlink depending on the image size)</p><p><a href=#R-image-15ac66e308121a4bc9b41431dc263098 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-annotations.png alt="Phone Link" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15ac66e308121a4bc9b41431dc263098><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/phone-annotations.png alt="Phone Link" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Splunk On-Call is a &lsquo;Mobile First&rsquo; platform meaning the phone app is full functionality and you can manage an incident directly from your phone.</p><p>For the remainder of this module we will focus on the Web UI however please spend some time later exploring the phone app features.</p><h2 id=3-link-to-alerting-system>3. Link to Alerting System</h2><p>Sticking with the Web UI, click the <strong>2. Alert Details in SignalFx</strong> link.</p><p><a href=#R-image-51c3606020279efa84c19e0812e8a721 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/alert-details-in-sfx.png alt="Alert Details" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-51c3606020279efa84c19e0812e8a721><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/alert-details-in-sfx.png alt="Alert Details" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This will open a new browser tab and take you directly to the Alert within Splunk Infrastructure Monitoring where you could then progress your troubleshooting using the powerful tools built into its UI.</p><p><a href=#R-image-e84aa8c753eaf6739702583c38798f06 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/sfx-alert-details.png alt="SFX Alert Details" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e84aa8c753eaf6739702583c38798f06><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/sfx-alert-details.png alt="SFX Alert Details" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>However, we are focussing on Splunk On-Call so close this tab and return to the Splunk On-Call UI.</p><h2 id=4-similar-incidents>4. Similar Incidents</h2><p>What if Splunk On-Call could identify previous incidents within the system which may give you a clue to the best way to tackle this incident.</p><p>The <strong>Similar Incidents</strong> tab does exactly that, surfacing previous incidents allowing you to look at them and see what actions were taken to resolve them, actions which could be easily repeated for this incident.</p><p><a href=#R-image-662d32e06d31463bc8eb891f289958ec class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/similar-incidents.png alt="Similar Incidents" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-662d32e06d31463bc8eb891f289958ec><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/similar-incidents.png alt="Similar Incidents" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=5-timeline>5 Timeline</h2><p>On right we have a Time Line view where you can add messages and see the history of previous alerts and interactions.</p><p><a href=#R-image-1115eeb25bc18215206593d6a1fa1370 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/war-room-dashboard.png alt="Incident View" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1115eeb25bc18215206593d6a1fa1370><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/war-room-dashboard.png alt="Incident View" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><h2 id=6-add-responders>6 Add Responders</h2><p>On the far left you have the option of allocating additional resources to this incident by clicking on the <strong>Add Responders</strong> link.</p><p><a href=#R-image-e8ea408b6f3511124864104ac980e457 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/add-responders.png alt=add-responders class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e8ea408b6f3511124864104ac980e457><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/add-responders.png alt=add-responders class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>This allows you build a virtual team specific to this incident by adding other Teams or individual Users, and also share details of a <strong>Conference Bridge</strong> where you can all get together and collaborate.</p><p><a href=#R-image-1282343ab04e71364b72ab041b17955a class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/conference-bridge.png alt="Conference Bridge" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1282343ab04e71364b72ab041b17955a><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/conference-bridge.png alt="Conference Bridge" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Once the system has built up some incident data history, it will use Machine Learning to suggest Teams and Users who have historically worked on similar incidents, as they may be best placed to help resolve this incident quickly.</p><p>You can select different Teams and/or Users and also choose from a pre-configured conference bridge, or populate the details of a new bridge from your preferred provider.</p><p>We do not need to add any Responders in this exercise so close the <strong>Add Responders</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=7-reroute>7 Reroute</h2><p>If it&rsquo;s decided that maybe the incident could be better dealt with by a different Team, the call can be <strong>Rerouted</strong> by clicking the <strong>Reroute</strong> Button at the top of the left hand panel.</p><p><a href=#R-image-368af554e3e550548038291643d00bc7 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/reroute1.png alt=Reroute class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-368af554e3e550548038291643d00bc7><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/reroute1.png alt=Reroute class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In a similar method to that used in the Add Responders dialogue, you can select Teams or Users to Reroute the Incident to.</p><p><a href=#R-image-029efba3625f3a96e24b84de3c2f184e class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/reroute2.png alt="Reroute Incident" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-029efba3625f3a96e24b84de3c2f184e><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/reroute2.png alt="Reroute Incident" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We do not need to actually Reroute in this exercise so close the <strong>Reroute Incident</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=8-snooze>8 Snooze</h2><p>You can also <strong>snooze</strong> this incident by clicking on the <strong>alarm clock</strong> Button at the top of the left hand panel.</p><p><a href=#R-image-19dcc19dce5c881fa3a9b9bf71db0d9e class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/snooze1.png alt=Snnoze class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-19dcc19dce5c881fa3a9b9bf71db0d9e><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/snooze1.png alt=Snnoze class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can enter an amount of time upto 24 hours to snooze the incident. This action will be tracked in the Timeline, and when the time expires the paging will restart.</p><p>This is useful for low priority incidents, enabling you to put them on a back burner for a few hours, but it ensures they do not get forgotten thanks to the paging process starting again.</p><p><a href=#R-image-67adfa0ebe5245eff8c68f61c221a6b1 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/snooze2.png alt="Snooze Incident" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-67adfa0ebe5245eff8c68f61c221a6b1><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/snooze2.png alt="Snooze Incident" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>We do not need to actually Snooze in this exercise so close the <strong>Snooze Incident</strong> dialogue by clicking <strong>Cancel</strong>.</p><h2 id=9-action-tracking>9 Action Tracking</h2><p>Now lets fix this issue and update the Incident with what we did. Add a new message at the top of the right hand panel such as <strong>Discovered rogue process, terminated it</strong>.</p><p><a href=#R-image-0e2a2d52ccc4cdcaf0d08ccfee0d10d0 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/time-line-update-message.png alt="Add Message" class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e2a2d52ccc4cdcaf0d08ccfee0d10d0><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/time-line-update-message.png alt="Add Message" class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>All the actions related to the Incident will be recorded here, and can then be summarized is a <strong>Post Incident Review Report</strong> available from the <strong>Reports</strong> tab</p><h2 id=10-resolution>10 Resolution</h2><p>Now kill off the process we started in the VM to max out the CPU by switching back the Shell session for the VM and pressing <strong>ctrl+c</strong></p><p>Within no more than 10 seconds SignalFx should detect the new CPU value, clear the alert state in SignalFx, then automatically update the Incident in VictorOps marking it as <strong>Resolved</strong>.</p><p><a href=#R-image-2598dfa1224c1212aa5677ac6cabe964 class=lightbox-link><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/m7-resolved.png alt=Resolved class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2598dfa1224c1212aa5677ac6cabe964><img src=../en/other/oncall/incident_lifecycle/manage_incidents/../../images/m7-resolved.png alt=Resolved class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>As we have two way integration between Splunk Infrastructure Monitoring and Splunk On-Call we could have also marked the incident as Resolved in Splunk On-Call, and this would have resulted in the alert in Splunk Infrastructure Monitoring being resolved as well.</p><hr><p>That completes this introduction to Splunk On-Call!</p><footer class=footline></footer></article></section></section><article class=default><header class=headline></header><h1 id=making-your-observability-cloud-native-with-opentelemetry>Making Your Observability Cloud Native With OpenTelemetry</h1><h2 id=abstract>Abstract</h2><p>Organizations getting started with OpenTelemetry may begin by sending data directly to an observability backend. While this works well for initial testing, using the OpenTelemetry collector as part of your observability architecture provides numerous benefits and is recommended for any production deployment.</p><p>In this workshop, we will be focusing on using the OpenTelemetry collector and starting with the fundamentals of configuring the receivers, processors, and exporters ready to use with Splunk Observability Cloud. The journey will take attendees from novices to being able to start adding custom components to help solve for their business observability needs for their distributed platform.</p><h3 id=ninja-sections>Ninja Sections</h3><p>Throughout the workshop there will be expandable <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> Sections</span></span>, these will be more hands on and go into further technical detail that you can explore within the workshop or in your own time.</p><p>Please note that the content in these sections may go out of date due to the frequent development being made to the OpenTelemetry project. Links will be provided in the event details are out of sync, please let us know if you spot something that needs updating.</p><hr><div class=expand><input type=checkbox id=R-expand-6caf31f873ae0ebf2866bc67e3b17ef2 aria-controls=R-expandcontent-6caf31f873ae0ebf2866bc67e3b17ef2>
<label class=expand-label for=R-expand-6caf31f873ae0ebf2866bc67e3b17ef2><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Test Me!</span></span></label><div id=R-expandcontent-6caf31f873ae0ebf2866bc67e3b17ef2 class=expand-content><p><strong>By completing this workshop you will officially be an OpenTelemetry Collector Ninja!</strong></p></div></div><hr><h2 id=target-audience>Target Audience</h2><p>This interactive workshop is for developers and system administrators who are interested in learning more about architecture and deployment of the OpenTelemetry Collector.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Attendees should have a basic understanding of data collection</li><li>Command line and vim/vi experience.</li><li>A instance/host/VM running Ubuntu 20.04 LTS or 22.04 LTS.<ul><li>Minimum requirements are an AWS/EC2 t2.micro (1 CPU, 1GB RAM, 8GB Storage)</li></ul></li></ul><h2 id=learning-objectives>Learning Objectives</h2><p>By the end of this talk, attendees will be able to:</p><ul><li>Understand the components of OpenTelemetry</li><li>Use receivers, processors, and exporters to collect and analyze data</li><li>Identify the benefits of using OpenTelemetry</li><li>Build a custom component to solve their business needs</li></ul><h2 id=opentelemetry-architecture>OpenTelemetry Architecture</h2><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Making Your Observability Cloud Native With OpenTelemetry</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=download-the-opentelemetry-collector-contrib-distribution>Download the OpenTelemetry Collector Contrib distribution</h2><p>The first step in installing the Open Telemetry Collector is downloading it. For our lab, we will use the <code>wget</code> command to download the <code>.deb</code> package from the OpenTelemetry Github repository.</p><p>Obtain the <code>.deb</code> package for your platform from the <a href=https://github.com/open-telemetry/opentelemetry-collector-releases/releases target=_blank><strong>OpenTelemetry Collector Contrib releases page</strong></a></p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.80.0/otelcol-contrib_0.80.0_linux_amd64.deb</span></span></code></pre></div><h2 id=install-the-opentelemetry-collector-contrib-distribution>Install the OpenTelemetry Collector Contrib distribution</h2><p>Install the <code>.deb</code> package using <code>dpkg</code>. Take a look at the <strong>dpkg Output</strong> tab below to see what the example output of a successful install will look like:</p><div class=tab-panel data-tab-group=d8391da373b85cd62c861862459ab46d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=install class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("d8391da373b85cd62c861862459ab46d","install")'>
<span class=tab-nav-text>Install</span></button>
<button data-tab-item=dpkg-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("d8391da373b85cd62c861862459ab46d","dpkg-output")'>
<span class=tab-nav-text>dpkg Output</span></button></div><div class=tab-content-container><div data-tab-item=install class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg -i otelcol-contrib_0.80.0_linux_amd64.deb</span></span></code></pre></div></div></div><div data-tab-item=dpkg-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Selecting previously unselected package otelcol-contrib.
</span></span><span class=line><span class=cl>(Reading database ... 64218 files and directories currently installed.)
</span></span><span class=line><span class=cl>Preparing to unpack otelcol-contrib_0.75.0_linux_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking otelcol-contrib (0.75.0) ...
</span></span><span class=line><span class=cl>Setting up otelcol-contrib (0.75.0) ...
</span></span><span class=line><span class=cl>Created symlink /etc/systemd/system/multi-user.target.wants/otelcol-contrib.service ‚Üí /lib/systemd/system/otelcol-contrib.service.</span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Installing OpenTelemetry Collector Contrib</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=confirm-the-collector-is-running>Confirm the Collector is running</h2><p>The collector should now be running. We will verify this as root using <code>systemctl</code> command. To exit the status just press <code>q</code>.</p><div class=tab-panel data-tab-group=dccb38d1334163bcb59cbcb5c7f9b637><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("dccb38d1334163bcb59cbcb5c7f9b637","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=status-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("dccb38d1334163bcb59cbcb5c7f9b637","status-output")'>
<span class=tab-nav-text>Status Output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status otelcol-contrib</span></span></code></pre></div></div></div><div data-tab-item=status-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>‚óè otelcol-contrib.service - OpenTelemetry Collector Contrib
</span></span><span class=line><span class=cl>     Loaded: loaded (/lib/systemd/system/otelcol-contrib.service; enabled; vendor preset: enabled)
</span></span><span class=line><span class=cl>     Active: active (running) since Tue 2023-05-16 08:23:23 UTC; 25s ago
</span></span><span class=line><span class=cl>   Main PID: 1415 (otelcol-contrib)
</span></span><span class=line><span class=cl>      Tasks: 5 (limit: 1141)
</span></span><span class=line><span class=cl>     Memory: 22.2M
</span></span><span class=line><span class=cl>        CPU: 125ms
</span></span><span class=line><span class=cl>     CGroup: /system.slice/otelcol-contrib.service
</span></span><span class=line><span class=cl>             ‚îî‚îÄ1415 /usr/bin/otelcol-contrib --config=/etc/otelcol-contrib/config.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: NumberDataPoints #0
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Data point attributes:
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; exporter: Str(logging)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_instance_id: Str(df8a57f4-abdc-46b9-a847-acd62db1001f)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_name: Str(otelcol-contrib)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:      -&gt; service_version: Str(0.75.0)
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: StartTimestamp: 2023-05-16 08:23:39.006 +0000 UTC
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Timestamp: 2023-05-16 08:23:39.006 +0000 UTC
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]: Value: 0.000000
</span></span><span class=line><span class=cl>May 16 08:23:39 ip-10-0-9-125 otelcol-contrib[1415]:         {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;metrics&#34;, &#34;name&#34;: &#34;logging&#34;}</span></span></code></pre></div></div></div></div></div><p>Because we will be making multiple configuration file changes, setting environment variables and restarting the collector, we need to stop the collector service and disable it from starting on boot.</p><div class=tab-panel data-tab-group=ba0d2999a104bb855b6878dd0aa8c80c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("ba0d2999a104bb855b6878dd0aa8c80c","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl stop otelcol-contrib <span class=o>&amp;&amp;</span> sudo systemctl disable otelcol-contrib</span></span></code></pre></div></div></div></div></div><hr><div class=expand><input type=checkbox id=R-expand-1849eca232d5bac7fb2777dc9df6c229 aria-controls=R-expandcontent-1849eca232d5bac7fb2777dc9df6c229>
<label class=expand-label for=R-expand-1849eca232d5bac7fb2777dc9df6c229><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Build your own collector using Open Telemetry Collector Builder (ocb)</span></span></label><div id=R-expandcontent-1849eca232d5bac7fb2777dc9df6c229 class=expand-content><p>For this part we will require the following installed on your system:</p><ul><li><p>Golang (latest version)</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>wget https://golang.org/dl/go1.20.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz</span></span></code></pre></div><p>Edit <code>.profile</code> and add the following environment variables:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=nv>$HOME</span>/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$GOPATH</span>/bin:<span class=nv>$GOROOT</span>/bin:<span class=nv>$PATH</span></span></span></code></pre></div><p>Renew your shell session:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.profile</span></span></code></pre></div><p>Check Go version:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go version</span></span></code></pre></div></li><li><p>ocb installed</p><ul><li><p>Download the ocb binary from the <a href=https://github.com/open-telemetry/opentelemetry-collector/releases/tag/cmd%2Fbuilder%2Fv0.80.0 target=_blank>project releases</a>
and run the following commands:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mv ocb_0.80.0_darwin_arm64 /usr/bin/ocb
</span></span><span class=line><span class=cl>chmod <span class=m>755</span> /usr/bin/ocb</span></span></code></pre></div><p>An alternative approach would be to use the golang tool chain to build the binary locally by doing:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go install go.opentelemetry.io/collector/cmd/builder@v0.80.0
</span></span><span class=line><span class=cl>mv <span class=k>$(</span>go env GOPATH<span class=k>)</span>/bin/builder /usr/bin/ocb</span></span></code></pre></div></li></ul></li><li><p>(Optional) Docker</p></li></ul><h2 id=why-build-your-own-collector>Why build your own collector?</h2><p>The default distribution of the collector (core and contrib) either contains too much or too little in what they have to offer.</p><p>It is also not advised to run the contrib collector in your production environments due to the amount of components installed which more than likely are not needed by your deployment.</p><h2 id=benefits-of-building-your-own-collector>Benefits of building your own collector?</h2><p>When creating your own collector binaries, (commonly referred to as distribution), means you build what you need.</p><p>The benefits of this are:</p><ol><li>Smaller sized binaries</li><li>Can use existing go scanners for vulnerabilities</li><li>Include internal components that can tie in with your organization</li></ol><h2 id=considerations-for-building-your-collector>Considerations for building your collector?</h2><p>Now, this would not be a ü•∑ Ninja zone if it didn&rsquo;t come with some drawbacks:</p><ol><li>Go experience is recommended if not required</li><li><strong>No</strong> Splunk support</li><li>Responsibility for distribution and lifecycle management</li></ol><p>It is important to note that the project is working towards stability but it does not mean changes made will not break your workflow. The team at Splunk provides increased support and a higher level of stability so they can provide a curated experience helping you with your deployment needs.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>Once you have all the required tools installed to get started, you will need to create a new file named <code>otelcol-builder.yaml</code> and we will follow this directory structure:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ otelcol-builder.yaml</span></span></code></pre></div><p>Once we have the file created, we need to add a list of components for it to install with some additional metadata.</p><p>For this example, we are going to create a builder manifest that will install only the components we need for the introduction config:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-ninja</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>A custom build of the Open Telemetry Collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/ballastextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/zpagesextension  v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/httpforwarder v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/splunkhecexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/signalfxexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/sapmexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/memorylimiterprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/hostmetricsreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/zipkinreceiver v0.80.0</span></span></span></code></pre></div><p>Once the yaml file has been updated for the <em>ocb</em>, then run the following command:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocb --config<span class=o>=</span>otelcol-builder.yaml</span></span></code></pre></div><p>Which leave you with the following directory structure:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>‚îú‚îÄ‚îÄ dist
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ components.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ components_test.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ go.mod
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ go.sum
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main_others.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ main_windows.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îî‚îÄ‚îÄ otelcol-ninja
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ otelcol-builder.yaml</span></span></code></pre></div><h3 id=references>References</h3><ol><li><a href=https://opentelemetry.io/docs/collector/custom-collector/ target=_blank>https://opentelemetry.io/docs/collector/custom-collector/</a></li></ol></div></div><hr><h2 id=default-configuration>Default configuration</h2><p>OpenTelemetry is configured through YAML files. These files have default configurations that we can modify to meet our needs. Let&rsquo;s look at the default configuration that is supplied:</p><div class=tab-panel data-tab-group=953213113a1a6343c8290e459c72df20><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("953213113a1a6343c8290e459c72df20","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("953213113a1a6343c8290e459c72df20","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div><p>Congratulations! You have successfully downloaded and installed the OpenTelemetry Collector. You are well on your way to becoming an OTel Ninja. But first let&rsquo;s walk through configuration files and different distributions of the OpenTelemetry Collector.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>Splunk does provide its own, fully supported, distribution of the OpenTelemetry Collector. This distribution is available to install from the <a href=https://github.com/signalfx/splunk-otel-collector target=_blank><strong>Splunk GitHub Repository</strong></a> or via a wizard in Splunk Observability Cloud that will build out a simple installation script to copy and paste. This distribution includes many additional features and enhancements that are not available in the OpenTelemetry Collector Contrib distribution.</p><ul><li>The Splunk Distribution of the OpenTelemetry Collector is production-tested; it is in use by the majority of customers in their production environments.</li><li>Customers that use our distribution can receive direct help from official Splunk support within SLAs.</li><li>Customers can use or migrate to the Splunk Distribution of the OpenTelemetry Collector without worrying about future breaking changes to its core configuration experience for metrics and traces collection (OpenTelemetry logs collection configuration is in beta). There may be breaking changes to the Collector&rsquo;s metrics.</li></ul></div></div><p>We will now walk through each section of the configuration file and modify it to send host metrics to Splunk Observability Cloud.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><p>Now that we have the OpenTelemetry Collector installed, let&rsquo;s take a look at extensions for the OpenTelemetry Collector. Extensions are optional and available primarily for tasks that do not involve processing telemetry data. Examples of extensions include health monitoring, service discovery, and data forwarding.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;: &#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style E fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Extensions</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=health-check>Health Check</h2><p>Extensions are configured in the same <code>config.yaml</code> file that we referenced in the installation step. Let&rsquo;s edit the <code>config.yaml</code> file and configure the extensions. Note that the <strong>pprof</strong> and <strong>zpages</strong> extensions are already configured in the default <code>config.yaml</code> file. For the purpose of this workshop, we will only be updating the <strong>health_check</strong> extension to expose the port on all network interfaces on which we can access the health of the collector.</p><div class=tab-panel data-tab-group=e95c698695cd4069a4996a9c62f49a11><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("e95c698695cd4069a4996a9c62f49a11","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=bf68240ea401c6aeb462f1bfa6e335a6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=extensions-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("bf68240ea401c6aeb462f1bfa6e335a6","extensions-configuration")'>
<span class=tab-nav-text>Extensions Configuration</span></button></div><div class=tab-content-container><div data-tab-item=extensions-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span></span></span></code></pre></div></div></div></div></div><p>Start the collector:</p><div class=tab-panel data-tab-group=7dc171fc046e8394b60e8e4b883299c4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7dc171fc046e8394b60e8e4b883299c4","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p>This extension enables an HTTP URL that can be probed to check the status of the OpenTelemetry Collector. This extension can be used as a liveness and/or readiness probe on Kubernetes. To learn more about the <code>curl</code> command, check out the <a href=https://curl.se/docs/manpage.html target=_blank>curl man page</a>.</p><p>Open a new terminal session and SSH into your instance to run the following command:</p><div class=tab-panel data-tab-group=f7bc1a69e59353c270ad1203f3b18dbe><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=curl-command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("f7bc1a69e59353c270ad1203f3b18dbe","curl-command")'>
<span class=tab-nav-text>curl Command</span></button>
<button data-tab-item=curl-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("f7bc1a69e59353c270ad1203f3b18dbe","curl-output")'>
<span class=tab-nav-text>curl Output</span></button></div><div class=tab-content-container><div data-tab-item=curl-command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:13133</span></span></code></pre></div></div></div><div data-tab-item=curl-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;status&#34;:&#34;Server available&#34;,&#34;upSince&#34;:&#34;2023-04-27T10:11:22.153295874+01:00&#34;,&#34;uptime&#34;:&#34;16m24.684476004s&#34;}</span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=performance-profiler>Performance Profiler</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/pprofextension/README.md target=_blank><strong>Performance Profiler</strong></a> extension enables the golang net/http/pprof endpoint. This is typically used by developers to collect performance profiles and investigate issues with the service. <strong>We will not be covering this in this workshop</strong>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=zpages>zPages</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/extension/zpagesextension/README.md target=_blank><strong>zPages</strong></a> are an in-process alternative to external exporters. When included, they collect and aggregate tracing and metrics information in the background; this data is served on web pages when requested. zPages are an extremely useful diagnostic feature to ensure the collector is running as expected.</p><div class=tab-panel data-tab-group=25f9da7d53e21765474573162352d221><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=servicez class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("25f9da7d53e21765474573162352d221","servicez")'>
<span class=tab-nav-text>ServiceZ</span></button>
<button data-tab-item=pipelinez class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("25f9da7d53e21765474573162352d221","pipelinez")'>
<span class=tab-nav-text>PipelineZ</span></button>
<button data-tab-item=extensionz class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("25f9da7d53e21765474573162352d221","extensionz")'>
<span class=tab-nav-text>ExtensionZ</span></button></div><div class=tab-content-container><div data-tab-item=servicez class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>ServiceZ</strong> gives an overview of the collector services and quick access to the pipelinez, extensionz, and featurez zPages. The page also provides build and runtime information.</p><p>Example URL: <a href=http://localhost:55679/debug/servicez target=_blank>http://localhost:55679/debug/servicez</a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-f6cd51cac87c875b93c30deeee3b2a77 class=lightbox-link><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/servicez.png alt=ServiceZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f6cd51cac87c875b93c30deeee3b2a77><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/servicez.png alt=ServiceZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><div data-tab-item=pipelinez class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>PipelineZ</strong> provides insights on the running pipelines running in the collector. You can find information on type, if data is mutated, and you can also see information on the receivers, processors and exporters that are used for each pipeline.</p><p>Example URL: <a href=http://localhost:55679/debug/pipelinez target=_blank>http://localhost:55679/debug/pipelinez</a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-a1a96b0a72d9438079a41d6555632fff class=lightbox-link><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/pipelinez.png alt=PipelineZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a1a96b0a72d9438079a41d6555632fff><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/pipelinez.png alt=PipelineZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div><div data-tab-item=extensionz class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>ExtensionZ</strong> shows the extensions that are active in the collector.</p><p>Example URL: <a href=http://localhost:55679/debug/extensionz target=_blank>http://localhost:55679/debug/extensionz</a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-e02d990847a50c91cf48b8f5fa3556ae class=lightbox-link><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/extensionz.png alt=ExtensionZ class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e02d990847a50c91cf48b8f5fa3556ae><img src=../en/other/opentelemetry-collector/2-extensions/3-zpages/../../images/extensionz.png alt=ExtensionZ class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p></div></div></div></div><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>You can use your browser to access your environment emitting zPages information at (replace <code>&lt;insert_your_ip></code> with your IP address):</p><ul><li><strong>ServiceZ:</strong> <a href=http://%3cinsert_your_ip%3e:55679/debug/servicez target=_blank>http://&lt;insert_your_ip>:55679/debug/servicez</a></li><li><strong>PipelineZ:</strong> <a href=http://%3cinsert_your_ip%3e:55679/debug/pipelinez target=_blank>http://&lt;insert_your_ip>:55679/debug/pipelinez</a></li><li><strong>ExtensionZ:</strong> <a href=http://%3cinsert_your_ip%3e:55679/debug/extensionz target=_blank>http://&lt;insert_your_ip>:55679/debug/extensionz</a></li></ul></div></div><hr><div class=expand><input type=checkbox id=R-expand-c5f51f222509304b38591d9c07a70ac0 aria-controls=R-expandcontent-c5f51f222509304b38591d9c07a70ac0>
<label class=expand-label for=R-expand-c5f51f222509304b38591d9c07a70ac0><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Improve data durability with storage extension</span></span></label><div id=R-expandcontent-c5f51f222509304b38591d9c07a70ac0 class=expand-content><p>For this, we will need to validate that our distribution has the <code>file_storage</code> extension installed. This can be done by running the command <code>otelcol-contrib components</code> which should show results like:</p><div class=tab-panel data-tab-group=53a71973e3a89f37709ca0bcffbb96bf><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=truncated-output class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("53a71973e3a89f37709ca0bcffbb96bf","truncated-output")'>
<span class=tab-nav-text>Truncated Output</span></button>
<button data-tab-item=full-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("53a71973e3a89f37709ca0bcffbb96bf","full-output")'>
<span class=tab-nav-text>Full Output</span></button></div><div class=tab-content-container><div data-tab-item=truncated-output class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage</span></span></span></code></pre></div></div></div><div data-tab-item=full-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>buildinfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>OpenTelemetry Collector Contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus_simple</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>receiver_creator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodbatlas</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>vcenter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>snmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>expvar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jmx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>udplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafkametrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memcached</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowseventlog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsecscontainermetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>iis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nsxt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>aerospike</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>httpcheck</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sobjects</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hostmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>statsd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudfoundry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>collectd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>couchdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kubeletstats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>journald</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>riak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>active_directory_ds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlquery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowsperfcounters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>flinkmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>podman_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>wavefront</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>postgresql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rabbitmq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlserver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>solace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tcplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscontainerinsightreceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsfirehose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bigip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filelog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudspanner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudflare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azureeventhub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>fluentforward</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlpjsonfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>syslog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cumulativetodelta</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbyattrs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbytrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>experimental_metricsgeneration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>metricstransform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deltatorate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>spanmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>span</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redaction</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>servicegraph</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>transform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>probabilistic_sampler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tail_sampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>f5cloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mezmo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>dynatrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loki</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuredataexplorer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuremonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>instana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loadbalancing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sentry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tanzuobservability</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>alibabacloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>clickhouse</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheusremotewrite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatchlogs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger_thrift</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logzio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sumologic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlemanagedprometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awskinesis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>coralogix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logicmonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tencentcloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsemf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zpages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bearertokenauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oidc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>host_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sigv4auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file_storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_ballast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oauth2client</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsproxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>http_forwarder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaegerremotesampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pprof</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>asapclient</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>basicauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>headers_setter</span></span></span></code></pre></div></div></div></div></div><p>This extension provides exporters the ability to queue data to disk in the event that exporter is unable to send data to the configured endpoint.</p><p>In order to configure the extension, you will need to update your config to include the information below. First, be sure to create a /tmp/otel-data directory and give it read/write permissions:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_rebound</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_needed_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_trigger_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages, file_storage]</span></span></span></code></pre></div><h2 id=why-queue-data-to-disk>Why queue data to disk?</h2><p>This allows the collector to weather network interruptions (and even collector restarts) to ensure data is sent to the upstream provider.</p><h2 id=considerations-for-queuing-data-to-disk>Considerations for queuing data to disk?</h2><p>There is a potential that this could impact data throughput performance due to disk performance.</p><h3 id=references>References</h3><ol><li><a href=https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583 target=_blank>https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage target=_blank>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage</a></li></ol></div></div><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered extensions, let&rsquo;s check our configuration changes.</p><hr><div class=expand><input type=checkbox id=R-expand-b62ec6baeab5ffcd0297449e63b88252 aria-controls=R-expandcontent-b62ec6baeab5ffcd0297449e63b88252>
<label class=expand-label for=R-expand-b62ec6baeab5ffcd0297449e63b88252><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></label><div id=R-expandcontent-b62ec6baeab5ffcd0297449e63b88252 class=expand-content><div class=tab-panel data-tab-group=0ab465762ed83bf84a0bdeaa9a92ba4c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("0ab465762ed83bf84a0bdeaa9a92ba4c","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=hl><span class=lnt> 3
</span></span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>Now that we have reviewed extensions, let&rsquo;s dive into the data pipeline portion of the workshop. A pipeline defines a path the data follows in the Collector starting from reception, moving to further processing or modification, and finally exiting the Collector via exporters.</p><p>The data pipeline in the OpenTelemetry Collector is made up of receivers, processors, and exporters. We will first start with receivers.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><p>Welcome to the receiver portion of the workshop! This is the starting point of the data pipeline of the OpenTelemetry Collector. Let&rsquo;s dive in.</p><p>A receiver, which can be push or pull based, is how data gets into the Collector. Receivers may support one or more data sources. Generally, a receiver accepts data in a specified format, translates it into the internal format and passes it to processors and exporters defined in the applicable pipelines.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style M fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Receivers</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=host-metrics-receiver>Host Metrics Receiver</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/hostmetricsreceiver/README.md target=_blank><strong>The Host Metrics Receiver</strong></a> generates metrics about the host system scraped from various sources. This is intended to be used when the collector is deployed as an agent which is what we will be doing in this workshop.</p><p>Let&rsquo;s update the <code>/etc/otel-contrib/config.yaml</code> file and configure the <strong>hostmetrics</strong> receiver. Insert the following YAML under the <strong>receivers</strong> section, taking care to indent by two spaces.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div><div class=tab-panel data-tab-group=76af6b1b2f0254ab122aa7d0b2b6f5f9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=host-metrics-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("76af6b1b2f0254ab122aa7d0b2b6f5f9","host-metrics-receiver-configuration")'>
<span class=tab-nav-text>Host Metrics Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=host-metrics-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span></span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=prometheus-receiver>Prometheus Receiver</h2><p>You will also notice another receiver called <strong>prometheus</strong>. <a href=https://prometheus.io/docs/introduction/overview/ target=_blank><strong>Prometheus</strong></a> is an open-source toolkit used by the OpenTelemetry Collector. This receiver is used to scrape metrics from the OpenTelemetry Collector itself. These metrics can then be used to monitor the health of the collector.</p><p>Let&rsquo;s modify the <code>prometheus</code> receiver to clearly show that it is for collecting metrics from the collector itself. By changing the name of the receiver from <code>prometheus</code> to <code>prometheus/internal</code>, it is now much clearer as to what that receiver is doing. Update the configuration file to look like this:</p><div class=tab-panel data-tab-group=02fab8ac9b35b835e72360f804faae02><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=prometheus-receiver-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("02fab8ac9b35b835e72360f804faae02","prometheus-receiver-configuration")'>
<span class=tab-nav-text>Prometheus Receiver Configuration</span></button></div><div class=tab-content-container><div data-tab-item=prometheus-receiver-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class="line hl"><span class=cl><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span></span></span></code></pre></div></div></div></div></div><h2 id=example-dashboard---prometheus-metrics>Example Dashboard - Prometheus metrics</h2><p>The following screenshot shows an example dashboard of spme of the metrics the Prometheus internal receiver collects from the OpenTelemetry Collector. Here, we can see accepted and sent spans, metrics and log records.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>The following screenshot is an out-of-the-box (OOTB) dashboard from Splunk Observability Cloud that allows you to easily monitor your Splunk OpenTelemetry Collector install base.</p></div></div><p><a href=#R-image-9f86b4c91693919878036cc537ab01c6 class=lightbox-link><img src=../en/other/opentelemetry-collector/3-receivers/2-prometheus/../../images/otel-charts.png alt=otel-charts class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f86b4c91693919878036cc537ab01c6><img src=../en/other/opentelemetry-collector/3-receivers/2-prometheus/../../images/otel-charts.png alt=otel-charts class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=other-receivers>Other Receivers</h2><p>You will notice in the default configuration there are other receivers: <strong>otlp</strong>, <strong>opencensus</strong>, <strong>jaeger</strong> and <strong>zipkin</strong>. These are used to receive telemetry data from other sources. We will not be covering these receivers in this workshop and they can be left as they are.</p><hr><div class=expand><input type=checkbox id=R-expand-fdd6d91b10e32f74f170bb3d6bb8613f aria-controls=R-expandcontent-fdd6d91b10e32f74f170bb3d6bb8613f>
<label class=expand-label for=R-expand-fdd6d91b10e32f74f170bb3d6bb8613f><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Create receivers dynamically</span></span></label><div id=R-expandcontent-fdd6d91b10e32f74f170bb3d6bb8613f class=expand-content><p>To help observe short lived tasks like docker containers, kubernetes pods, or ssh sessions, we can use the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator target=_blank>receiver creator</a> with <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer target=_blank>observer extensions</a> to create a new receiver as these services start up.</p><h2 id=what-do-we-need>What do we need?</h2><p>In order to start using the receiver creator and its associated observer extensions, they will need to be part of your collector build manifest.</p><p>See <a href=../en/other/opentelemetry-collector/1-installation/index.html>installation</a> for the details.</p><h2 id=things-to-consider>Things to consider?</h2><p>Some short lived tasks may require additional configuration such as <em>username</em>, and <em>password</em>.
These values can be referenced via <a href=https://opentelemetry.io/docs/collector/configuration/#configuration-environment-variables target=_blank>environment variables</a>,
or use a scheme expand syntax such as <code>${file:./path/to/database/password}</code>.
Please adhere to your organisation&rsquo;s secret practices when taking this route.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>There are only two things needed for this ninja zone:</p><ol><li>Make sure you have added receiver creater and observer extensions to the builder manifest.</li><li>Create the config that can be used to match against discovered endpoints.</li></ol><p>To create the templated configurations, you can do the following:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>host_observer]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; port == 6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>${env:HOST_REDIS_PASSWORD}</span></span></span></code></pre></div><p>For more examples, refer to these <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator#examples target=_blank>receiver creator&rsquo;s examples</a>.</p></div></div><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>We&rsquo;ve now covered receivers, so let&rsquo;s now check our configuration changes.</p><hr><div class=expand><input type=checkbox id=R-expand-b4e85f3b9733ad241da57849cdc3eff4 aria-controls=R-expandcontent-b4e85f3b9733ad241da57849cdc3eff4>
<label class=expand-label for=R-expand-b4e85f3b9733ad241da57849cdc3eff4><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></label><div id=R-expandcontent-b4e85f3b9733ad241da57849cdc3eff4 class=expand-content><div class=tab-panel data-tab-group=9a947558a38986790535ec9797b05ae6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("9a947558a38986790535ec9797b05ae6","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=hl><span class=lnt>10
</span></span><span class=hl><span class=lnt>11
</span></span><span class=hl><span class=lnt>12
</span></span><span class=hl><span class=lnt>13
</span></span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span><span class=hl><span class=lnt>16
</span></span><span class=hl><span class=lnt>17
</span></span><span class=hl><span class=lnt>18
</span></span><span class=hl><span class=lnt>19
</span></span><span class=hl><span class=lnt>20
</span></span><span class=hl><span class=lnt>21
</span></span><span class=hl><span class=lnt>22
</span></span><span class=hl><span class=lnt>23
</span></span><span class=hl><span class=lnt>24
</span></span><span class=hl><span class=lnt>25
</span></span><span class=hl><span class=lnt>26
</span></span><span class=hl><span class=lnt>27
</span></span><span class=hl><span class=lnt>28
</span></span><span class=hl><span class=lnt>29
</span></span><span class=hl><span class=lnt>30
</span></span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=hl><span class=lnt>39
</span></span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>Now that we have reviewed how data gets into the OpenTelemetry Collector through receivers, let&rsquo;s now take a look at how the Collector processes the received data.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>As the <code>/etc/otelcol-contrib/config.yaml</code> is not complete, please <strong>do not</strong> attempt to restart the collector at this point.</p></div></div><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/README.md target=_blank><strong>Processors</strong></a> are run on data between being received and being exported. Processors are optional though some are recommended. There are <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor target=_blank><strong>a large number of processors</strong></a> included in the OpenTelemetry contrib Collector.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Processors fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Processors</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=batch-processor>Batch Processor</h2><p>By default, only the <strong>batch</strong> processor is enabled. This processor is used to batch up data before it is exported. This is useful for reducing the number of network calls made to exporters. For this workshop, we will inherit the following defaults which are hard-coded into the Collector:</p><ul><li><code>send_batch_size</code> (default = 8192): Number of spans, metric data points, or log records after which a batch will be sent regardless of the timeout. send_batch_size acts as a trigger and does not affect the size of the batch. If you need to enforce batch size limits sent to the next component in the pipeline see send_batch_max_size.</li><li><code>timeout</code> (default = 200ms): Time duration after which a batch will be sent regardless of size. If set to zero, send_batch_size is ignored as data will be sent immediately, subject to only send_batch_max_size.</li><li><code>send_batch_max_size</code> (default = 0): The upper limit of the batch size. 0 means no upper limit on the batch size. This property ensures that larger batches are split into smaller units. It must be greater than or equal to send_batch_size.</li></ul><p>For more information on the Batch processor, see the <a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/batchprocessor/README.md target=_blank><strong>Batch Processor documentation</strong></a>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>The <strong>resourcedetection</strong> processor can be used to detect resource information from the host and append or override the resource value in telemetry data with this information.</p><p>By default, the hostname is set to the FQDN if possible, otherwise, the hostname provided by the OS is used as a fallback. This logic can be changed from using using the <code>hostname_sources</code> configuration option. To avoid getting the FQDN and use the hostname provided by the OS, we will set the <code>hostname_sources</code> to <code>os</code>.</p><div class=tab-panel data-tab-group=de68f4cc3f31d075b9647491f2102bfa><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=system-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("de68f4cc3f31d075b9647491f2102bfa","system-resource-detection-processor-configuration")'>
<span class=tab-nav-text>System Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=system-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span></span></span></code></pre></div></div></div></div></div><p>If the workshop instance is running on an AWS/EC2 instance we can gather the following tags from the EC2 metadata API (this is not available on other platforms).</p><ul><li><code>cloud.provider ("aws")</code></li><li><code>cloud.platform ("aws_ec2")</code></li><li><code>cloud.account.id</code></li><li><code>cloud.region</code></li><li><code>cloud.availability_zone</code></li><li><code>host.id</code></li><li><code>host.image.id</code></li><li><code>host.name</code></li><li><code>host.type</code></li></ul><p>We will create another processor to append these tags to our metrics.</p><div class=tab-panel data-tab-group=5188f0902862fe2b00b892b7a9b0422e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=ec2-resource-detection-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("5188f0902862fe2b00b892b7a9b0422e","ec2-resource-detection-processor-configuration")'>
<span class=tab-nav-text>EC2 Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=ec2-resource-detection-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span></span></span></code></pre></div></div></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=attributes-processor>Attributes Processor</h2><p>The attributes processor modifies attributes of a span, log, or metric. This processor also supports the ability to filter and match input data to determine if they should be included or excluded for specified actions.</p><p>It takes a list of actions that are performed in the order specified in the config. The supported actions are:</p><ul><li><code>insert</code>: Inserts a new attribute in input data where the key does not already exist.</li><li><code>update</code>: Updates an attribute in input data where the key does exist.</li><li><code>upsert</code>: Performs insert or update. Inserts a new attribute in input data where the key does not already exist and updates an attribute in input data where the key does exist.</li><li><code>delete</code>: Deletes an attribute from the input data.</li><li><code>hash</code>: Hashes (SHA1) an existing attribute value.</li><li><code>extract</code>: Extracts values using a regular expression rule from the input key to target keys specified in the rule. If a target key already exists, it will be overridden.</li></ul><p>We are going to create an attributes processor to <code>insert</code> a new attribute to all our host metrics called <code>participant.name</code> with a value of your name e.g. <code>marge_simpson</code>.</p><div class="box notices cstyle warning"><div class=box-label><i class="fa-fw fas fa-exclamation-triangle"></i> Warning</div><div class=box-content><p>Ensure you replace <code>INSERT_YOUR_NAME_HERE</code> with your name and also ensure you <strong>do not</strong> use spaces in your name.</p></div></div><p>Later on in the workshop, we will use this attribute to filter our metrics in Splunk Observability Cloud.</p><div class=tab-panel data-tab-group=a631d65128ea484b085e8c6a650b69cd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=attributes-processor-configuration class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a631d65128ea484b085e8c6a650b69cd","attributes-processor-configuration")'>
<span class=tab-nav-text>Attributes Processor Configuration</span></button></div><div class=tab-content-container><div data-tab-item=attributes-processor-configuration class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span></span></span></code></pre></div></div></div></div></div><hr><div class=expand><input type=checkbox id=R-expand-21a0a6c317b9ec5bf5e1ef3837d1fa79 aria-controls=R-expandcontent-21a0a6c317b9ec5bf5e1ef3837d1fa79>
<label class=expand-label for=R-expand-21a0a6c317b9ec5bf5e1ef3837d1fa79><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Using connectors to gain internal insights</span></span></label><div id=R-expandcontent-21a0a6c317b9ec5bf5e1ef3837d1fa79 class=expand-content><p>One of the most recent additions to the collector was the notion of a <a href=https://opentelemetry.io/docs/collector/configuration/#connectors target=_blank><strong>connector</strong></a>, which allows you to join the output of one pipeline to the input of another pipeline.</p><p>An example of how this is beneficial is that some services emit metrics based on the amount of datapoints being exported, the number of logs containing an error status,
or the amount of data being sent from one deployment environment. The count connector helps address this for you out of the box.</p><h2 id=why-a-connector-instead-of-a-processor>Why a connector instead of a processor?</h2><p>A processor is limited in what additional data it can produce considering it has to pass on the data it has processed making it hard to expose additional information. Connectors do not have to emit the data they receive which means they provide an opportunity to create the insights we are after.</p><p>For example, a connector could be made to count the number of logs, metrics, and traces that do not have the deployment environment attribute.</p><p>A very simple example with the output of being able to break down data usage by deployment environment.</p><h2 id=considerations-with-connectors>Considerations with connectors</h2><p>A connector only accepts data exported from one pipeline and receiver by another pipeline, this means you may have to consider how you construct your collector config to take advantage of it.</p><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#connectors target=_blank><strong>https://opentelemetry.io/docs/collector/configuration/#connectors</strong></a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector target=_blank><strong>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector</strong></a></li></ol></div></div><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>That&rsquo;s processors covered, let&rsquo;s check our configuration changes.</p><hr><div class=expand><input type=checkbox id=R-expand-dc31f4e3e0117ba8dae70ec308b5c98e aria-controls=R-expandcontent-dc31f4e3e0117ba8dae70ec308b5c98e>
<label class=expand-label for=R-expand-dc31f4e3e0117ba8dae70ec308b5c98e><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></label><div id=R-expandcontent-dc31f4e3e0117ba8dae70ec308b5c98e class=expand-content><div class=tab-panel data-tab-group=a7900a811d10643291e85665885236f6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a7900a811d10643291e85665885236f6","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=hl><span class=lnt>58
</span></span><span class=hl><span class=lnt>59
</span></span><span class=hl><span class=lnt>60
</span></span><span class=hl><span class=lnt>61
</span></span><span class=hl><span class=lnt>62
</span></span><span class=hl><span class=lnt>63
</span></span><span class=hl><span class=lnt>64
</span></span><span class=hl><span class=lnt>65
</span></span><span class=hl><span class=lnt>66
</span></span><span class=hl><span class=lnt>67
</span></span><span class=hl><span class=lnt>68
</span></span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><p>An exporter, which can be push or pull-based, is how you send data to one or more backends/destinations. Exporters may support one or more data sources.</p><p>For this workshop, we will be using the <a href=https://opentelemetry.io/docs/specs/otel/protocol/exporter/ target=_blank><strong>otlphttp</strong></a> exporter. The OpenTelemetry Protocol (OTLP) is a vendor-neutral, standardised protocol for transmitting telemetry data. The OTLP exporter sends data to a server that implements the OTLP protocol. The OTLP exporter supports both <a href=https://grpc.io/ target=_blank><strong>gRPC</strong></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview target=_blank><strong>HTTP</strong></a>/<a href=https://www.json.org/json-en.html target=_blank><strong>JSON</strong></a> protocols.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Exporters fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Exporters</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>To send metrics over HTTP to Splunk Observability Cloud, we will need to configure the <strong>otlphttp</strong> exporter.</p><p>Let&rsquo;s edit our <code>/etc/otelcol-contrib/config.yaml</code> file and configure the <strong>otlphttp</strong> exporter. Insert the following YAML under the <strong>exporters</strong> section, taking care to indent by two spaces e.g.</p><p>We will also change the verbosity of the logging exporter to prevent the disk from filling up. The default of <code>detailed</code> is very noisy.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=l>otlphttp/splunk:</span></span></span></code></pre></div><p>Next, we need to define the <code>metrics_endpoint</code> and configure the target URL.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with a Realm environment variable. We will reference that environment variable in our configuration file. Otherwise, you will need to create a new environment variable and set the Realm e.g.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;us1&#34;</span></span></span></code></pre></div></div></div><p>The URL to use is <code>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</code>. (Splunk has Realms in key geographical locations around the world for data residency).</p><p>The <strong>otlphttp</strong> exporter can also be configured to send traces and logs by defining a target URL for <code>traces_endpoint</code> and <code>logs_endpoint</code> respectively. Configuring these is outside the scope of this workshop.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span></span></span></code></pre></div><p>By default, <code>gzip</code> compression is enabled for all endpoints. This can be disabled by setting <code>compression: none</code> in the exporter configuration. We will leave compression enabled for this workshop and accept the default as this is the most efficient way to send data.</p><p>To send metrics to Splunk Observability Cloud, we need to use an Access Token. This can be done by creating a new token in the Splunk Observability Cloud UI. For more information on how to create a token, see <a href=https://docs.splunk.com/Observability/admin/authentication-tokens/org-tokens.html target=_blank>Create a token</a>. The token needs to be of type <strong>INGEST</strong>.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with an Access Token (which has been set as an environment variable). We will reference that environment variable in our configuration file. Otherwise, you will need to create a new token and set it as an environment variable e.g.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;replace-with-your-token&gt;</span></span></code></pre></div></div></div><p>The token is defined in the configuration file by inserting <code>X-SF-TOKEN: ${env:ACCESS_TOKEN}</code> under a <code>headers:</code> section:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span></span></span></code></pre></div><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered exporters, let&rsquo;s check our configuration changes:</p><hr><div class=expand><input type=checkbox id=R-expand-3197fffbe98a5ad0e29ff19dd77018f8 aria-controls=R-expandcontent-3197fffbe98a5ad0e29ff19dd77018f8>
<label class=expand-label for=R-expand-3197fffbe98a5ad0e29ff19dd77018f8><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></label><div id=R-expandcontent-3197fffbe98a5ad0e29ff19dd77018f8 class=expand-content><div class=tab-panel data-tab-group=f98c5eec88ecd367fee39966d0a1ee53><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("f98c5eec88ecd367fee39966d0a1ee53","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=hl><span class=lnt>72
</span></span><span class=hl><span class=lnt>73
</span></span><span class=hl><span class=lnt>74
</span></span><span class=hl><span class=lnt>75
</span></span><span class=hl><span class=lnt>76
</span></span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><p>Of course, you can easily configure the <code>metrics_endpoint</code> to point to any other solution that supports the <strong>OTLP</strong> protocol.</p><p>Next, we need to enable the receivers, processors and exporters we have just configured in the service section of the <code>config.yaml</code>.</p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><p>The <strong>Service</strong> section is used to configure what components are enabled in the Collector based on the configuration found in the receivers, processors, exporters, and extensions sections.</p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>If a component is configured, but not defined within the <strong>Service</strong> section then it is <strong>not</strong> enabled.</p></div></div><p>The service section consists of three sub-sections:</p><ul><li>extensions</li><li>pipelines</li><li>telemetry</li></ul><p>In the default configuration, the extension section has been configured to enable <code>health_check</code>, <code>pprof</code> and <code>zpages</code>, which we configured in the Extensions module earlier.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></div><p>So lets configure our Metric Pipeline!</p><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Service</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=hostmetrics-receiver>Hostmetrics Receiver</h2><p>If you recall from the Receivers portion of the workshop, we defined the <a href=../en/other/opentelemetry-collector/3-receivers/index.html#host-metrics-receiver><strong>Host Metrics Receiver</strong></a> to generate metrics about the host system, which are scraped from various sources. To enable the receiver, we must include the <code>hostmetrics</code> receiver in the metrics pipeline.</p><p>In the <code>metrics</code> pipeline, add <code>hostmetrics</code> to the metrics <code>receivers</code> section.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=prometheus-internal-receiver>Prometheus Internal Receiver</h2><p>Earlier in the workshop, we also renamed the <code>prometheus</code> receiver to reflect that is was collecting metrics internal to the collector, renaming it to <code>prometheus/internal</code>.</p><p>We now need to enable the <code>prometheus/internal</code> receiver under the metrics pipeline. Update the <code>receivers</code> section to include <code>prometheus/internal</code> under the <code>metrics</code> pipeline:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>We also added <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> processors so that the collector can capture the instance hostname and AWS/EC2 metadata. We now need to enable these two processors under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> under the <code>metrics</code> pipeline:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=attributes-processor>Attributes Processor</h2><p>Also in the Processors section of this workshop, we added the <code>attributes/conf</code> processor so that the collector will insert a new attribute called <code>participant.name</code> to all the metrics. We now need to enable this under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>attributes/conf</code> under the <code>metrics</code> pipeline:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>In the Exporters section of the workshop, we configured the <code>otlphttp</code> exporter to send metrics to Splunk Observability Cloud. We now need to enable this under the metrics pipeline.</p><p>Update the <code>exporters</code> section to include <code>otlphttp/splunk</code> under the <code>metrics</code> pipeline:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging, otlphttp/splunk]</span></span></span></code></pre></div><hr><div class=expand><input type=checkbox id=R-expand-91b009ab78a21549d20799c7de9e55ac aria-controls=R-expandcontent-91b009ab78a21549d20799c7de9e55ac>
<label class=expand-label for=R-expand-91b009ab78a21549d20799c7de9e55ac><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Observing the collector internals</span></span></label><div id=R-expandcontent-91b009ab78a21549d20799c7de9e55ac class=expand-content><p>The collector captures internal signals about its behavior this also includes additional signals from running components.
The reason for this is that components that make decisions about the flow of data need a way to surface that information
as metrics or traces.</p><h2 id=why-monitor-the-collector>Why monitor the collector?</h2><p>This is somewhat of a chicken and egg problem of, &ldquo;Who is watching the watcher?&rdquo;, but it is important that we can surface this information. Another interesting part of the collector&rsquo;s history is that it existed before the Go metrics&rsquo; SDK was considered stable so the collector exposes a Prometheus endpoint to provide this functionality for the time being.</p><h2 id=considerations>Considerations</h2><p>Monitoring the internal usage of each running collector in your organization can contribute a significant amount of new Metric Time Series (MTS). The Splunk distribution has curated these metrics for you and would be able to help forecast the expected increases.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>To expose the internal observability of the collector, some additional settings can be adjusted:</p><div class=tab-panel data-tab-group=11ebad34f608df5fd42dc6b57943664e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=telemetry-schema class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("11ebad34f608df5fd42dc6b57943664e","telemetry-schema")'>
<span class=tab-nav-text>telemetry schema</span></button>
<button data-tab-item=example-configyml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("11ebad34f608df5fd42dc6b57943664e","example-configyml")'>
<span class=tab-nav-text>example-config.yml</span></button></div><div class=tab-content-container><div data-tab-item=telemetry-schema class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;info|warn|error&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>&lt;console|json&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_caller</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>error_output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;none|basic|normal|detailed&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Address binds the promethues endpoint to scrape</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>&lt;hostname:port&gt;</span></span></span></code></pre></div></div></div><div data-tab-item=example-configyml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instance.name</span><span class=p>:</span><span class=w> </span><span class=l>${env:INSTANCE}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8888 </span></span></span></code></pre></div></div></div></div></div><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#service target=_blank>https://opentelemetry.io/docs/collector/configuration/#service</a></li></ol></div></div><hr><h2 id=final-configuration>Final configuration</h2><hr><div class=expand><input type=checkbox id=R-expand-75d6d9c00d0bd4a190c452d1b8a2f31d aria-controls=R-expandcontent-75d6d9c00d0bd4a190c452d1b8a2f31d>
<label class=expand-label for=R-expand-75d6d9c00d0bd4a190c452d1b8a2f31d><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your final configuration</span></span></label><div id=R-expandcontent-75d6d9c00d0bd4a190c452d1b8a2f31d class=expand-content><div class=tab-panel data-tab-group=5f26c27bb2f63266360a8156bdeaaf1a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=configyaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("5f26c27bb2f63266360a8156bdeaaf1a","configyaml")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div data-tab-item=configyaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf] </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>logging, otlphttp/splunk]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></div><hr><div class="box notices cstyle tip"><div class=box-label><i class="fa-fw fas fa-lightbulb"></i> Tip</div><div class=box-content><p>It is recommended that you validate your configuration file before restarting the collector. You can do this by using the built-in <code>validate</code> command:</p><div class=tab-panel data-tab-group=62b4bbb84c36b9acb6053ccff3e0b3fc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("62b4bbb84c36b9acb6053ccff3e0b3fc","command")'>
<span class=tab-nav-text>Command</span></button>
<button data-tab-item=example-error-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("62b4bbb84c36b9acb6053ccff3e0b3fc","example-error-output")'>
<span class=tab-nav-text>Example error output</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib validate --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div data-tab-item=example-error-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Error: failed to get config: cannot unmarshal the configuration: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* error decoding &#39;processors&#39;: error reading configuration for &#34;attributes/conf&#34;: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* &#39;actions[0]&#39; has invalid keys: actions
</span></span><span class=line><span class=cl>2023/06/29 09:41:28 collector server run finished with error: failed to get config: cannot unmarshal the configuration: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* error decoding &#39;processors&#39;: error reading configuration for &#34;attributes/conf&#34;: 1 error(s) decoding:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>* &#39;actions[0]&#39; has invalid keys: actions</span></span></code></pre></div></div></div></div></div></div></div><p>Now that we have a working configuration, let&rsquo;s start the collector and then check to see what <a href=../en/other/opentelemetry-collector/2-extensions/index.html#zpages>zPages</a> is reporting.</p><div class=tab-panel data-tab-group=3cb361805b897c28c00770d89e5c1c5e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=command class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("3cb361805b897c28c00770d89e5c1c5e","command")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div data-tab-item=command class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p><a href=#R-image-292b497d187b311fa0217a6a1792e094 class=lightbox-link><img src=../en/other/opentelemetry-collector/6-service/5-otlphttp/../../images/pipelinez-full-config.png alt=pipelinez-full-config class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-292b497d187b311fa0217a6a1792e094><img src=../en/other/opentelemetry-collector/6-service/5-otlphttp/../../images/pipelinez-full-config.png alt=pipelinez-full-config class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><footer class=footline></footer></article></section><article class=default><header class=headline></header><h1 id=data-visualisations>Data Visualisations</h1><h2 id=splunk-observability-cloud>Splunk Observability Cloud</h2><p>Now that we have configured the OpenTelemetry Collector to send metrics to Splunk Observability Cloud, let&rsquo;s take a look at the data in Splunk Observability Cloud. If you have not received an invite to Splunk Observability Cloud, your instructor will provide you with login credentials.</p><p>Before that, let&rsquo;s make things a little more interesting and run a stress test on the instance. This in turn will light up the dashboards.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install stress
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span> stress -c <span class=m>2</span> -t 40<span class=p>;</span> stress -d <span class=m>5</span> -t 40<span class=p>;</span> stress -m <span class=m>20</span> -t 40<span class=p>;</span> <span class=k>done</span></span></span></code></pre></div><p>Once you are logged into Splunk Observability Cloud, using the left-hand navigation, navigate to <strong>Dashboards</strong> from the main menu. This will take you to the Teams view. At the top of this view click on <strong>All Dashboards</strong> :</p><p><a href=#R-image-1b9d3dcdbf8a85a97f73111c95d04136 class=lightbox-link><img src=../en/other/opentelemetry-collector/7-visualisation/../images/menu-dashboards.png alt=menu-dashboards class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b9d3dcdbf8a85a97f73111c95d04136><img src=../en/other/opentelemetry-collector/7-visualisation/../images/menu-dashboards.png alt=menu-dashboards class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>In the search box, search for <strong>OTel Contrib</strong>:</p><p><a href=#R-image-aeadeebee5c599aed95fbeb15a61b2f1 class=lightbox-link><img src=../en/other/opentelemetry-collector/7-visualisation/../images/search-dashboards.png alt=search-dashboards class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aeadeebee5c599aed95fbeb15a61b2f1><img src=../en/other/opentelemetry-collector/7-visualisation/../images/search-dashboards.png alt=search-dashboards class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Info</div><div class=box-content><p>If the dashboard does not exist, then your instructor will be able to quickly add it. If you are not attending a Splunk hosted version of this workshop then the Dashboard Group to import can be found at the bottom of this page.</p></div></div><p>Click on the <strong>OTel Contrib Dashboard</strong> dashboard to open it:</p><p><a href=#R-image-5e4b98a70928f2a1debf11da0ec5a9ae class=lightbox-link><img src=../en/other/opentelemetry-collector/7-visualisation/../images/otel-dashboard.png alt=otel-dashboard class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e4b98a70928f2a1debf11da0ec5a9ae><img src=../en/other/opentelemetry-collector/7-visualisation/../images/otel-dashboard.png alt=otel-dashboard class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>Click in the <strong>Participant Name</strong> box, at the top of the dashboard, and select the name you configured for <code>participant.name</code> in the <code>config.yaml</code> in the drop-down list or start typing the name to search for it:</p><p><a href=#R-image-27c193a9d804ee32afd7d6e9d34ccab9 class=lightbox-link><img src=../en/other/opentelemetry-collector/7-visualisation/../images/select-participant-name.png alt=select-conf-attendee-name class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-27c193a9d804ee32afd7d6e9d34ccab9><img src=../en/other/opentelemetry-collector/7-visualisation/../images/select-participant-name.png alt=select-conf-attendee-name class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><p>You can now see the host metrics for the host upon which you configured the OpenTelemetry Collector.</p><p><a href=#R-image-5ef4de511f982a84e6e4c6eae7a2dc95 class=lightbox-link><img src=../en/other/opentelemetry-collector/7-visualisation/../images/participant-dashboard.png alt=participant-dashboard class="figure-image noborder lightbox noshadow" style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ef4de511f982a84e6e4c6eae7a2dc95><img src=../en/other/opentelemetry-collector/7-visualisation/../images/participant-dashboard.png alt=participant-dashboard class="lightbox-image noborder lightbox noshadow" loading=lazy></a></p><div class="box attachments cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Download Dashboard Group JSON for importing</div><ul class="box-content attachments-files"><li><a href=../en/other/opentelemetry-collector/7-visualisation/index.files/OpenTelemetry-Contrib-Dashboard-Group.json>OpenTelemetry-Contrib-Dashboard-Group.json</a> (40 KB)</li></ul></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=developing-a-custom-component>Developing a custom component</h2><p>Building a component for the Open Telemetry Collector requires three key parts:</p><ol><li>The Configuration - <em>What values are exposed to the user to configure</em></li><li>The Factory - <em>Make the component using the provided values</em></li><li>The Business Logic - <em>What the component needs to do</em></li></ol><p>For this, we will use the example of building a component that works with Jenkins so that we can track important DevOps metrics of our project(s).</p><p>The metrics we are looking to measure are:</p><ol><li>Lead time for changes - <em>&ldquo;How long it takes for a commit to get into production&rdquo;</em></li><li>Change failure rate - <em>&ldquo;The percentage of deployments causing a failure in production&rdquo;</em></li><li>Deployment frequency - <em>&ldquo;How often a [team] successfully releases to production&rdquo;</em></li><li>Mean time to recover - <em>&ldquo;How long does it take for a [team] to recover from a failure in production&rdquo;</em></li></ol><p>These indicators were identified Google&rsquo;s DevOps Research and Assesment (DORA)[^1] team to help
show performance of a software development team. The reason for choosing <em>Jenkins CI</em> is that we remain in the same Open Source Software ecosystem which we can serve as the example for the vendor managed CI tools to adopt in future.</p><h2 id=instrument-vs-component>Instrument Vs Component</h2><p>There is something to consider when improving level of Observability within your organisation
since there are some trade offs that get made.</p><table><thead><tr><th></th><th>Pros</th><th>Cons</th></tr></thead><tbody><tr><td><strong>(Auto) Instrumented</strong></td><td>Does not require an external API to be monitored in order to observe the system.</td><td>Changing instrumentation requires changes to the project.</td></tr><tr><td></td><td>Gives system owners/developers to make changes in their observability.</td><td>Requires additional runtime dependancies.</td></tr><tr><td></td><td>Understands system context and can corrolate captured data with <em>Exemplars</em>.</td><td>Can impact performance of the system.</td></tr><tr><td><strong>Component</strong></td><td>- Changes to data names or semantics can be rolled out independently of the system&rsquo;s release cycle.</td><td>Breaking API changes require a coordinated release between system and collector.</td></tr><tr><td></td><td>Updating/extending data collected is a seemless user facing change.</td><td>Captured data semantics can unexpectedly break that does not align with a new system release.</td></tr><tr><td></td><td>Does not require the supporting teams to have a deep understanding of observability practice.</td><td>Strictly external / exposed information can be surfaced from the system.</td></tr></tbody></table><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Development</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=project-setup-hahahugoshortcode184s0hbhb>Project Setup <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong></span></span></h2><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>The time to finish this section of the workshop can vary depending on experience.</p><p>A complete solution can be found <a href=https://github.com/splunk/collector-workshop-example target=_blank><strong>here</strong></a> in case you&rsquo;re stuck or want to follow
along with the instructor.</p></div></div><p>To get started developing the new <em>Jenkins CI</em> receiver, we first need to set up a Golang project.
The steps to create your new Golang project is:</p><ol><li>Create a new directory named <code>${HOME}/go/src/jenkinscireceiver</code> and change into it<ol><li>The actual directory name or location is not strict, you can choose your own development directory to make it in.</li></ol></li><li>Initialize the golang module by going <code>go mod init splunk.conf/workshop/example/jenkinscireceiver</code><ol><li>This will create a file named <code>go.mod</code> which is used to track our direct and indirect dependencies</li><li>Eventually, there will be a <code>go.sum</code> which is the checksum value of the dependencies being imported.</li></ol></li></ol><div class=expand><input type=checkbox id=R-expand-145e1c1ba932c84a0b0a14644a99a383 aria-controls=R-expandcontent-145e1c1ba932c84a0b0a14644a99a383>
<label class=expand-label for=R-expand-145e1c1ba932c84a0b0a14644a99a383><i class="fas fa-chevron-down"></i>
<i class="fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your go.mod</span></span></label><div id=R-expandcontent-145e1c1ba932c84a0b0a14644a99a383 class=expand-content><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>module splunk.conf/workshop/example/jenkinscireceiver
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>go 1.20</span></span></code></pre></div></div></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-configuration>Building The Configuration</h2><p>The configuration portion of the component is how the user is able to have their inputs over the component,
so the values that is used for the configuration need to be:</p><ol><li>Intuitive for users to understand what that field controls</li><li>Be explicit in what is required and what is optional</li><li>Reuse common names and fields</li><li>Keep the options simple</li></ol><div class=tab-panel data-tab-group=59ac565956b3f799fa97d25a885dbc1b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=bad-config class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("59ac565956b3f799fa97d25a885dbc1b","bad-config")'>
<span class=tab-nav-text>bad config</span></button>
<button data-tab-item=good-config class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("59ac565956b3f799fa97d25a885dbc1b","good-config")'>
<span class=tab-nav-text>good config</span></button></div><div class=tab-content-container><div data-tab-item=bad-config class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_addr</span><span class=p>:</span><span class=w> </span><span class=l>hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_api_port</span><span class=p>:</span><span class=w> </span><span class=m>8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>filter_builds_by</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-awesome-build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=l>amber</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>track</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w> </span><span class=kc>no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w> </span><span class=kc>no</span></span></span></code></pre></div></div></div><div data-tab-item=good-config class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Required Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>http://my-jenkins-server:8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>authenticator</span><span class=p>:</span><span class=w> </span><span class=l>basicauth/jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Optional Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></div></div></div><p>The bad configuration highlights how doing the opposite of the recommendations of configuration practices impacts the usability
of the component. It doesn&rsquo;t make it clear what field values should be, it includes features that can be pushed to existing processors,
and the field naming is not consistent with other components that exist in the collector.</p><p>The good configuration keeps the required values simple, reuses field names from other components, and ensures the component focuses on
just the interaction between Jenkins and the collector.</p><p>The code tab shows how much is required to be added by us and what is already provided for us by shared libraries within the collector.
These will be explained in more detail once we get to the business logic. The configuration should start off small and will change
once the business logic has started to include additional features that is needed.</p><h2 id=write-the-code>Write the code</h2><p>In order to implement the code needed for the configuration, we are going to create a new file named <code>config.go</code> with the following content:</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=component-review>Component Review</h2><p>To recap the type of component we will need to capture metrics from Jenkins:</p><div class=tab-panel data-tab-group=a0cef578c9a847acd3680c00aebd7086><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=extension class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("a0cef578c9a847acd3680c00aebd7086","extension")'>
<span class=tab-nav-text>Extension</span></button>
<button data-tab-item=receiver class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a0cef578c9a847acd3680c00aebd7086","receiver")'>
<span class=tab-nav-text>Receiver</span></button>
<button data-tab-item=processor class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a0cef578c9a847acd3680c00aebd7086","processor")'>
<span class=tab-nav-text>Processor</span></button>
<button data-tab-item=exporter class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a0cef578c9a847acd3680c00aebd7086","exporter")'>
<span class=tab-nav-text>Exporter</span></button>
<button data-tab-item=ninja-connectors class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("a0cef578c9a847acd3680c00aebd7086","ninja-connectors")'>
<span class=tab-nav-text><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Connectors</span></span></span></button></div><div class=tab-content-container><div data-tab-item=extension class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>The business use case an extension helps solves for are:</p><ol><li>Having shared functionality that requires runtime configuration</li><li>Indirectly helps with observing the runtime of the collector</li></ol><p>See <a href=../en/other/opentelemetry-collector/2-extensions/index.html><strong>Extensions Overview</strong></a> for more details.</p></div></div><div data-tab-item=receiver class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a receiver solves for:</p><ul><li>Fetching data from a remote source</li><li>Receiving data from remote source(s)</li></ul><p>This is commonly referred to <em>pull</em> vs <em>push</em> based data collection, and you read more about the details in the <a href=../en/other/opentelemetry-collector/3-receivers/index.html>Receiver Overview</a>.</p></div></div><div data-tab-item=processor class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a processor solves for is:</p><ul><li>Adding or removing data, fields, or values</li><li>Observing and making decisions on the data</li><li>Buffering, queueing, and reordering</li></ul><p>The thing to keep in mind is the data type flowing through a processor needs to forward
the same data type to its downstream components. Read through <a href=../en/other/opentelemetry-collector/4-processors/index.html>Processor Overview</a> for the details.</p></div></div><div data-tab-item=exporter class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case an exporter solves for:</p><ul><li>Send the data to a tool, service, or storage</li></ul><p>The OpenTelemetry collector does not want to be &ldquo;backend&rdquo;, an all-in-one observability suite, but rather
keep to the principles that founded OpenTelemetry to begin with; A vendor agnostic Observability for all.
To help revisit the details, please read through <a href=../en/other/opentelemetry-collector/5-exporters/index.html><strong>Exporter Overview</strong></a>.</p></div></div><div data-tab-item=ninja-connectors class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>This is a component type that was missed in the workshop since it is a relatively new addition to the collector, but the best way to think about a connector is that it is like a processor that allows it to be used across different telemetry types and pipelines. Meaning that a connector can accept data as logs, and output metrics, or accept metrics from one pipeline and provide metrics on the data it has observed.</p><p>The business case that a connector solves for:</p><ul><li>Converting from different telemetry types<ul><li>logs to metrics</li><li>traces to metrics</li><li>metrics to logs</li></ul></li><li>Observing incoming data and producing its own data<ul><li>Accepting metrics and generating analytical metrics of the data.</li></ul></li></ul><p>There was a brief overview within the <strong>Ninja</strong> section as part of the <a href=../en/other/opentelemetry-collector/4-processors/index.html>Processor Overview</a>,
and be sure what the project for updates for new connector components.</p></div></div></div></div><p>From the component overviews, it is clear that developing a pull-based receiver for Jenkins.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h3 id=designing-the-metrics>Designing The Metrics</h3><p>To help define and export the metrics captured by our receiver, we will be using, <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/cmd/mdatagen target=_blank><strong>mdatagen</strong></a>, a tool developed for the collector that turns YAML defined metrics into code.</p><div class=tab-panel data-tab-group=177e8e678a4615d486b1e3f9123e369f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=metadatayaml class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("177e8e678a4615d486b1e3f9123e369f","metadatayaml")'>
<span class=tab-nav-text>metadata.yaml</span></button>
<button data-tab-item=gengo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("177e8e678a4615d486b1e3f9123e369f","gengo")'>
<span class=tab-nav-text>gen.go</span></button></div><div class=tab-content-container><div data-tab-item=metadatayaml class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Type defines the name to reference the component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># in the configuration file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Status defines the component type and the stability level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>metrics]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Attributes are the expected fields reported</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># with the exported values.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.name</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The name of the associated Jenkins job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Shows if the job had passed, or failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>success</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>unknown</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Metrics defines all the pontentially exported values from this receiver. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.jobs.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Provides a count of the total number of configured jobs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{Count}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.duration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Show the duration of the job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.commit_delta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The calculation difference of the time job was finished minus commit timestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span></span></span></code></pre></div></div></div><div data-tab-item=gengo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// To generate the additional code needed to capture metrics, 
</span></span></span><span class=line><span class=cl><span class=c1>// the following command to be run from the shell:
</span></span></span><span class=line><span class=cl><span class=c1>//  go generate -x ./...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=c1>//go:generate go run github.com/open-telemetry/opentelemetry-collector-contrib/cmd/mdatagen@v0.80.0 metadata.yaml
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// There is no code defined within this file.
</span></span></span></code></pre></div></div></div></div></div><p>Create these files within the project folder before continuing onto the next section.</p><h2 id=building-the-factory>Building The Factory</h2><p>The Factory is a software design pattern that effectively allows for an object, in this case a <code>jenkinscireceiver</code>, to be created dynamically with the provided configuration. To use a more real-world example, it would be going to a phone store, asking for a phone
that matches your exact description, and then providing it to you.</p><p>Run the following command <code>go generate -x ./...</code> , it will create a new folder, <code>jenkinscireceiver/internal/metadata</code>, that contains all code required to export the defined metrics. The required code is:</p><div class=tab-panel data-tab-group=7b73dd7eb19a902505c74247bda395c0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=factorygo class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("7b73dd7eb19a902505c74247bda395c0","factorygo")'>
<span class=tab-nav-text>factory.go</span></button>
<button data-tab-item=configgo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7b73dd7eb19a902505c74247bda395c0","configgo")'>
<span class=tab-nav-text>config.go</span></button>
<button data-tab-item=scrapergo class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7b73dd7eb19a902505c74247bda395c0","scrapergo")'>
<span class=tab-nav-text>scraper.go</span></button>
<button data-tab-item=build-configyaml class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7b73dd7eb19a902505c74247bda395c0","build-configyaml")'>
<span class=tab-nav-text>build-config.yaml</span></button>
<button data-tab-item=project-layout class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("7b73dd7eb19a902505c74247bda395c0","project-layout")'>
<span class=tab-nav-text>project layout</span></button></div><div class=tab-content-container><div data-tab-item=factorygo class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewFactory</span><span class=p>()</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>receiver</span><span class=p>.</span><span class=nf>NewFactory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>newDefaultConfig</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>receiver</span><span class=p>.</span><span class=nf>WithMetrics</span><span class=p>(</span><span class=nx>newMetricsReceiver</span><span class=p>,</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsStability</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newMetricsReceiver</span><span class=p>(</span><span class=nx>_</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>,</span> <span class=nx>cfg</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>consumer</span> <span class=nx>consumer</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>)</span> <span class=p>(</span><span class=nx>receiver</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Convert the configuration into the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>conf</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.(</span><span class=o>*</span><span class=nx>Config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;can not convert config&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sc</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>conf</span><span class=p>,</span> <span class=nx>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraperControllerReceiver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=nx>conf</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>set</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>consumer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>AddScraper</span><span class=p>(</span><span class=nx>sc</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=configgo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that are commonly shared across all HTTP interactions
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// performed by the collector.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// how often to check for updates to builds.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// that can be configured.
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newDefaultConfig</span><span class=p>()</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>Config</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ScraperControllerSettings</span><span class=p>:</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewDefaultScraperControllerSettings</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>HTTPClientSettings</span><span class=p>:</span>        <span class=nx>confighttp</span><span class=p>.</span><span class=nf>NewDefaultHTTPClientSettings</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>MetricsBuilderConfig</span><span class=p>:</span>      <span class=nx>metadata</span><span class=p>.</span><span class=nf>DefaultMetricsBuilderConfig</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=scrapergo class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a our scraper with our values 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span> <span class=o>:=</span> <span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// To be filled in later
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetrics</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=build-configyaml class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Conf workshop collector&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>v0.0.0-experimental</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/basicauthextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>splunk.conf/workshop/example/jenkinscireceiver v0.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./jenkinscireceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlphttpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This replace is a go directive that allows for redefine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># where to fetch the code to use since the default would be from a remote project.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replaces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=l>splunk.conf/workshop/example/jenkinscireceiver =&gt; ./jenkinscireceiver</span></span></span></code></pre></div></div></div><div data-tab-item=project-layout class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>‚îú‚îÄ‚îÄ build-config.yaml
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ jenkinscireceiver
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ go.mod
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ config.go
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ factory.go
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ scraper.go
</span></span><span class=line><span class=cl>    ‚îî‚îÄ‚îÄ internal
</span></span><span class=line><span class=cl>      ‚îî‚îÄ‚îÄ metadata</span></span></code></pre></div></div></div></div></div><p>Once you have written these files into the project with the expected contents run, <code>go mod tidy</code>, which will fetch all the remote dependencies and update <code>go.mod</code> and generate the <code>go.sum</code> files.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-business-logic>Building The Business Logic</h2><p>At this point, we have a custom component that currently does nothing so we need to add in the required
logic to capture this data from Jenkins.</p><p>From this point, the steps that we need to take are:</p><ol><li>Create a client that connect to Jenkins</li><li>Capture all the configured jobs</li><li>Report the status of the last build for the configured job</li><li>Calculate the time difference between commit timestamp and job completion.</li></ol><p>The changes will be made to <code>scraper.go</code>.</p><div class=tab-panel data-tab-group=76af468fb441b0b94e191182c046e380><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=add-jenkins-client class="tab-nav-button tab-panel-style cstyle initial active" onclick='switchTab("76af468fb441b0b94e191182c046e380","add-jenkins-client")'>
<span class=tab-nav-text><ol><li>Add Jenkins client</li></ol></span></button>
<button data-tab-item=capture-all-configured-jobs class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("76af468fb441b0b94e191182c046e380","capture-all-configured-jobs")'>
<span class=tab-nav-text><ol start=2><li>Capture all configured jobs</li></ol></span></button>
<button data-tab-item=report-the-status-of-each-job class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("76af468fb441b0b94e191182c046e380","report-the-status-of-each-job")'>
<span class=tab-nav-text><ol start=3><li>Report the status of each job</li></ol></span></button>
<button data-tab-item=report-the-delta class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("76af468fb441b0b94e191182c046e380","report-the-delta")'>
<span class=tab-nav-text><ol start=4><li>Report the delta</li></ol></span></button></div><div class=tab-content-container><div data-tab-item=add-jenkins-client class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>To be able to connect to the Jenkins server, we will be using the package,
<a href=https://pkg.go.dev/github.com/yosida95/golang-jenkins target=_blank>&ldquo;github.com/yosida95/golang-jenkins&rdquo;</a>,
which provides the functionality required to read data from the jenkins server.</p><p>Then we are going to utilise some of the helper functions from the,
<a href=https://pkg.go.dev/go.opentelemetry.io/collector/receiver/scraperhelper target=_blank>&ldquo;go.opentelemetry.io/collector/receiver/scraperhelper&rdquo;</a> ,
library to create a start function so that we can connect to the Jenkins server once component has finished starting.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jenkins</span> <span class=s>&#34;github.com/yosida95/golang-jenkins&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/pdata/pmetric&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mb</span>     <span class=o>*</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilder</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span> <span class=o>*</span><span class=nx>jenkins</span><span class=p>.</span><span class=nx>Jenkins</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>mb</span> <span class=p>:</span> <span class=nx>metadata</span><span class=p>.</span><span class=nf>NewMetricsBuilder</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span><span class=p>,</span> <span class=nx>set</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>WithStart</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>h</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Host</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.</span><span class=nf>ToClient</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>set</span><span class=p>.</span><span class=nx>TelemetrySettings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=c1>// The collector provides a means of injecting authentication
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// on our behalf, so this will ignore the libraries approach
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=c1>// and use the configured http client with authentication.
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span> <span class=p>=</span> <span class=nx>jenkins</span><span class=p>.</span><span class=nf>NewJenkins</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>SetHTTPClient</span><span class=p>(</span><span class=nx>client</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This finishes all the setup code that is required in order to initialise a Jenkins receiver.</p></div></div><div data-tab-item=capture-all-configured-jobs class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>From this point on, we will be focuses on the <code>scrape</code> method that has been waiting to be filled in.
This method will be run on each interval that is configured within the configuration (by default, every minute).</p><p>The reason we want to capture the number of jobs configured so we can see the growth of our Jenkins server,
and measure of many projects have onboarded. To do this we will call the jenkins client to list all jobs,
and if it reports an error, return that with no metrics, otherwise, emit the data from the metric builder.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=report-the-status-of-each-job class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>In the last step, we were able to capture all jobs ands report the number of jobs
there was. Within this step, we are going to examine each job and use the report values
to capture metrics.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This will check the result of the job, however,
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// since the only defined attributes are 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// `success`, `failure`, and `unknown`. 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// it is assume that anything did not finish 
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// with a success or failure to be an unknown status.
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=nx>build</span><span class=p>.</span><span class=nx>Result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;aborted&#34;</span><span class=p>,</span> <span class=s>&#34;not_built&#34;</span><span class=p>,</span> <span class=s>&#34;unstable&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;success&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusSuccess</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;failure&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusFailed</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobDurationDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span><span class=p>.</span><span class=nx>Duration</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div data-tab-item=report-the-delta class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The final step is to calculate how long it took from
commit to job completion to help infer our DORA metrics.</p><div class="wrap-code highlight"><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// all captured data points within this scrape have the same value. 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Previous step here
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure that the `ChangeSet` has values
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// set so there is a valid value for us to reference
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Making the assumption that the first changeset
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// item is the most recent change.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>change</span> <span class=o>:=</span> <span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Record the difference from the build time
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=c1>// compared against the change timestamp.
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobCommitDeltaDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>Timestamp</span><span class=o>-</span><span class=nx>change</span><span class=p>.</span><span class=nx>Timestamp</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Once all of these steps have been completed, you now have built a custom Jenkins CI receiver!</p><h2 id=whats-next>Whats next?</h2><p>There are more than likely features that would be desired from component that you can think of, like:</p><ul><li>Can I include the branch name that the job used?</li><li>Can I include the project name for the job?</li><li>How I calculate the collective job durations for project?</li><li>How do I validate the changes work?</li></ul><p>Please take this time to play around, break it, change things around, or even try to capture logs from the builds.</p><footer class=footline></footer></article></section></section></section><article class=default><header class=headline></header><h1 id=resources>Resources</h1><div class="children children-h3 children-sort-"><h3><a href=../en/resources/faq/index.html>Frequently Asked Questions</a></h3><p>A collection of the common questions and their answers associated with Observability, DevOps, Incident Response and Splunk On-Call.</p><h3><a href=../en/resources/dimensions_properties_tags/index.html>Dimension, Properties and Tags</a></h3><p>One conversation that frequently comes up is Dimensions vs Properties and when you should use one verus the other.</p><h3><a href=../en/resources/otel_tagging/index.html>Naming Conventions for Tagging with OpenTelemetry and Splunk</a></h3><p>When deploying OpenTelemetry in a large organization, it‚Äôs critical to define a standardized naming convention for tagging, and a governance process to ensure the convention is adhered to.</p></div><footer class=footline></footer></article><section><h1 class=a11y-only>Subsections of Resources</h1><article class=default><header class=headline></header><h1 id=frequently-asked-questions>Frequently Asked Questions</h1><p>A collection of the common questions and their answers associated with Observability, DevOps, Incident Response and Splunk On-Call.</p><h2 id=q-alerts-v-incident-response-v-incident-management>Q: Alerts v. Incident Response v. Incident Management</h2><p>A: Alerts, Incident Response and Incident Management are related functions. Together they comprise the incident response and resolution process.</p><p>Monitoring and Observability tools send alerts to incident response platforms. Those platforms take a collection of alerts and correlate them into incidents.</p><p>Those incidents are recorded into incident management (ITSM) platforms for record. Alerts are the trigger that something has happened, and provide context to an incident.</p><p>Incidents consist of the alert payload, all activity associated with the incident from the time it was created, and the on-call policies to be followed. ITSM is the system of record for incidents that are active and after they have been resolved.</p><p>All these components are necessary for successful incident response and management practices.</p><span class="btn cstyle transparent"><button type=button>
On-Call</button></span><h2 id=q-is-observability-monitoring>Q: Is Observability Monitoring</h2><p>A: The key difference between Monitoring and Observability is the difference between ‚Äúknown knowns‚Äù and ‚Äúunknown knowns‚Äù respectively.</p><p>In monitoring the operator generally has prior knowledge of the architecture and elements in their system. They can reliably predict the relationship between elements, and their associated metadata. Monitoring is good for stateful infrastructure that is not frequently changed.</p><p>Observability is for systems where the operators ability to predict and trace all elements in the system and their relationships is limited.</p><p>Observability is a set of practices and technology, which include traditional monitoring metrics.</p><p>These practices and technologies combined give the operator the ability to understand ephemeral and highly complex environments without prior knowledge of all elements of a system. Observability technology can also account for fluctuations in the environment, and variation in metadata (cardinality) better than traditional monitoring which is more static.</p><span class="btn cstyle transparent"><button type=button>
Observability</button></span><h2 id=q-what-are-traces-and-spans>Q: What are Traces and Spans</h2><p>A: Traces and spans, combined with metrics and logs, make up the core types of data that feed modern Observability tools. They all have specific elements and functions, but work well together.</p><p>Because microservices based architectures are distributed, transactions in the system touch multiple services before completing. This makes accurately pinpointing the location of an issue difficult. Traces are a method for tracking the full path of a request through all the services in a distributed system. Spans are the timed operations in each service. Traces are the connective tissue for the spans and together they give more detail on individual service processes. While metrics give a good snapshot of the health of a system, and logs give depth when investigating issues, traces and spans help navigate operators to the source of issues with greater context. This saves time when investigating incidents, and supports the increasing complexity of modern architectures.</p><span class="btn cstyle transparent"><button type=button>
APM</button></span><h2 id=q-what-is-the-sidecar-pattern>Q: What is the Sidecar Pattern?</h2><p>A: The sidecar pattern is a design pattern for having related services connected directly by infrastructure. Related services can be adding functionality or supporting the application logic they are connected to. It is used heavily as a method for deploying agents associated with the management plan along with the application service they support.</p><p>In Observability the sidecar services are the application logic, and the agent collecting data from that service. The setup requires two containers one with the application service, and one running the agent. The containers share a pod, and resources such as disk, network, and namespace. They are also deployed together and share the same lifecycle.</p><span class="btn cstyle transparent"><button type=button>
Observability</button></span><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=dimension-properties-and-tags>Dimension, Properties and Tags</h1><h2 id=applying-context-to-your-metrics>Applying context to your metrics</h2><p>One conversation that frequently comes up is Dimensions vs Properties and when you should use one verus the other. Instead of starting off with their descriptions it makes sense to understand how we use them and how they are similar, before diving into their differences and examples of why you would use one or the other.</p><h2 id=how-are-dimensions-and-properties-similar>How are Dimensions and Properties similar?</h2><p>The simplest answer is that they are both metadata <code>key:value</code> pairs that add context to our metrics. Metrics themselves are what we actually want to measure, whether it‚Äôs a standard infrastructure metric like‚Äã ‚Äã<code>cpu.utilization</code> or a custom metric like number of API calls received.</p><p>If we receive a value of 50% for th‚Äãe ‚Äã<code>cpu.utilization</code> metric without knowing where it came from or any other context it is just a number and not useful to us. We would need at least to know what host it comes from.</p><p>These days it is likely we care more about the performance or utilization of a cluster or data center as a whole then that of an individual host and therefore more interested in things like the average <code>cpu.utilization</code> across a cluster of hosts, when a‚Äã host‚Äôs <code>‚Äãcpu.utilization</code> is a outlier when compared to other hosts running the same service or maybe compare the ‚Äãaverage ‚Äã<code>cpu.utilization</code> of one environment to another.</p><p>To be able to slice, aggregate or g‚Äãroup our ‚Äã<code>cpu.utilization</code> metrics in this way we will need additional metad‚Äãata for the <code>‚Äãcpu.utilization</code> metrics we receive to include what cluster a host belongs to, what service is running on the host and what environment it is a part of. This metadata can be in the form of either dimension or property <code>key:value</code> pairs.</p><p>For example, if I go to apply a filter to a dashboard or use the Group by function when running analytics, I can use a property or a dimension.</p><h2 id=so-how-are-dimensions-and-properties-different>So how are Dimensions and Properties different?</h2><p>Dimensions are sent in with metrics at the time of ingest while properties are applied to metrics or dimensions after ingest. This means that any metadata you need to make a datapoint (‚Äãa single reported value of a metric) ‚Äãunique, like what host a value of <code>cpu.utilization</code> is coming from needs to be a dimension. Metric names + dimensions uniquely define an MTS (metric time series).</p><p>Example: the <code>‚Äãcpu.utilization</code> metric sent by a particular host (‚Äãserver1) with a dimension <code>‚Äãhost:server1</code> would be considered a unique time series. If you have 10 servers, each sending that metric, then you would have 10 time series, with each time series sharing the metric name <code>‚Äãcpu.utilization</code> and uniquely identified by the dimension key-value pair (‚Äãhost:server1, host:server2&mldr;host:server10).</p><p>However, if your server names are only unique within a datacenter vs your whole environment you would need to add a 2n‚Äãd‚Äã dimension <code>dc</code> for the datacenter location. You could now have double the number of possible MTSs. cpu.utilization metrics received would now be uniquely identified by 2 sets of dimension key-value pairs.</p><p>cpu.utilization plus ‚Äãdc:east &‚Äã host:server1 would create a different time series then ‚Äãcpu.utilization plus dc:west & ‚Äãhost:server1.</p><h2 id=dimensions-are-immutable-while-properties-are-mutable>Dimensions are immutable while properties are mutable</h2><p>As we mentioned above, Metric name + dimensions make a unique MTS. Therefore, if the dimension value changes we will have a new unique combination of metric name + dimension value and create a new MTS.</p><p>Properties on the other hand are applied to metrics (or dimensions) after they are ingested. If you apply a property to a metric, it propagates and applies to all MTS that the metric is a part of. Or if you apply a property to a dimension, say ‚Äãhost:server1 then all metrics from that host will have those properties attached. If you change the value of a property it will propagate and update the value of the property to all MTSs with that property attached. Why is this important? It means that if you care about the historical value of a property you need to make it a dimension.</p><p>Example: We are collecting custom metrics on our application. One metric is ‚Äãlatency which counts the latency of requests made to our application. We have a dimension ‚Äãcustomer, so we can sort and compare latency by customer. We decide we want to track the ‚Äãapplication version as well so we can sort and compare our application ‚Äãlatency by the version customers are using. We create a property ‚Äãversion that we attach to the customer dimension. Initially all customers are using application version 1, so ‚Äãversion:1.</p><p>We now have some customers using version 2 of our application, for those customers we update the property to ‚Äãversion:2. When we update the value of the ‚Äãversion property for those customers it will propagate down to all MTS for that customer. We lose the history that those customers at some point used ‚Äãversion 1, so if we wanted to compare ‚Äãlatency of ‚Äãversion 1 and ‚Äãversion 2 over a historical period we would not get accurate data. In this case even though we don‚Äôt need application ‚Äãversion to make out metric time series unique we need to make ‚Äãversion a dimension, because we care about the historical value.</p><h2 id=so-when-should-something-be-a-property-instead-of-a-dimension>So when should something be a Property instead of a dimension?</h2><p>The first reason would be if there is any metadata you want attached to metrics, but you don‚Äôt know it at the time of ingest.
The second reason is best practice is if it doesn‚Äôt need to be a dimension, make it a property. Why?
One reason is that today there is a limit of 5K MTSs per analytics job or chart rendering and the more dimensions you have the more MTS you will create. Properties are completely free-form and let you add as much information as you want or need to metrics or dimensions without adding to MTS counts.</p><p>As dimensions are sent in with every datapoint, the more dimensions you have the more data you send to us, which could mean higher costs to you if your cloud provider charges for data transfer.</p><p>A good example of some things that should be properties would be additional host information. You want to be able to see things like machine_type, processor, or os, but instead of making these things dimensions and sending them with every metric from a host you could make them properties and attach the properties to the host dimension.</p><p>Example where ‚Äãhost:server1 you would set properties ‚Äãmachine_type:ucs, processor:xeon-5560, os:rhel71. Anytime a metric comes in with the dimension ‚Äãhost:server1 all the above properties will be applied to it automatically.</p><p>Some other examples of use cases for properties would be if you want to know who is the escalation contact for each service or SLA level for every customer. You do not need these items to make metrics uniquely identifiable and you don‚Äôt care about the historical values, so they can be properties. The properties could be added to the service dimension and customer dimensions and would then apply to all metrics and MTSs with those dimensions.</p><h2 id=what-about-tags>What about Tags?</h2><p>Tags are the 3r‚Äãd‚Äã type of metadata that can be used to give context to or help organize your metrics. Unlike dimensions and properties, tags are NOT key:value pairs. ‚ÄãTags can be thought of as labels or keywords. Similar to Properties, Tags are applied to your data after ingest via the Catalog in the UI or programmatically via the API.‚Äã Tags can be applied to Metrics, Dimensions or other objects such as Detectors.</p><h2 id=where-would-i-use-tags>Where would I use Tags?</h2><p>Tags are used when there is a need for a many-to-one relationship of tags to an object or a one-to-many relationship between the tag and the objects you are applying them to. They are useful for grouping together metrics that may not be intrinsically associated.</p><p>One example is you have hosts that run multiple applications. You can create tags (labels) for each application and then apply multiple tags to each host to label the applications that are running on it.</p><p>Example: Server1 runs 3 applications. You create tags ‚Äãapp1, app2 and app3 and apply all 3 tags to the dimension ‚Äãhost:server1</p><p>To expand on the example above let us say you also collect metrics from your applications.‚Äã You could apply the tags you created to any metrics coming in from the applications themselves. You can filter based on a tag allowing you to filter based on an application, but get the full picture including both application and the relevant host metrics.</p><p>Example: App1 sends in metrics with the dimension ‚Äãservice:application1. You would apply tag ‚Äãapp1 to the dimension ‚Äãservice:application1. You can then filter on the tag ‚Äãapp1 in charts and dashboards.</p><p>Another use case for tags for binary states where there is just one possible value. An example is you do canary testing and when you do a canary deployment you want to be able to mark the hosts that received the new code, so you can easily identify their metrics and compare their performance to those hosts that did not receive the new code. There is no need for a key:value pair as there is just a single value ‚Äúcanary‚Äù.</p><p>Be aware that while you can filter on tags you cannot use the groupBy function on them. The groupBy function is run by supplying the key part of a key:value pair and the results are then grouped by values of that key pair.</p><h2 id=additional-information>Additional information</h2><p>For information on sending dimensions for custom metrics please review the ‚ÄãClient Libraries documentation for your library of choice.</p><p>For information on how to apply properties & tags to metrics or dimensions via the API please see the API documentation for ‚Äã/metric/:name‚Äã ‚Äã/dimension/:key/:value</p><p>For information on how to add or edit properties and tags via the Metadata Catalog in the UI please reference the section <strong>‚ÄãAdd or edit metadata</strong> in <a href=https://docs.splunk.com/Observability/metrics-and-metadata/metrics-finder-metadata-catalog.html#use-the-metadata-catalog target=_blank>Search the Metric Finder and Metadata catalog</a>.</p><footer class=footline></footer></article><article class=default><header class=headline></header><h1 id=naming-conventions-for-tagging-with-opentelemetry-and-splunk>Naming Conventions for Tagging with OpenTelemetry and Splunk</h1><h2 id=introduction>Introduction</h2><p>When deploying OpenTelemetry in a large organization, it‚Äôs critical to define a standardized naming convention for tagging, and a governance process to ensure the convention is adhered to.</p><p>This ensures that MELT data collected via OpenTelemetry can be efficiently utilized for alerting, dashboarding, and troubleshooting purposes. It also ensures that users of Splunk Observability Cloud can quickly find the data they‚Äôre looking for.</p><p>Naming conventions also ensure that data can be aggregated effectively. For example, if we wanted to count the number of unique hosts by environment, then we must use a standardized convention for capturing the host and environment names.</p><h2 id=attributes-vs-tags>Attributes vs. Tags</h2><p>Before we go further, let‚Äôs make a note regarding terminology. Tags in OpenTelemetry are called ‚Äúattributes‚Äù. Attributes can be attached to metrics, logs, and traces, either via manual instrumentation or automated instrumentation.</p><p>Attributes can also be attached to metrics, logs, and traces at the OpenTelemetry collector level, using various processors such as the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/resourcedetectionprocessor target=_blank>Resource Detection processor</a>.</p><p>Once traces with attributes are ingested into Splunk Observability Cloud, they are available as ‚Äútags‚Äù. Optionally, attributes collected as part of traces can be used to create <a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#troubleshooting-metricsets target=_blank>Troubleshooting Metric Sets</a>, which can in turn be used with various features such as <a href=https://docs.splunk.com/Observability/apm/span-tags/tag-spotlight.html target=_blank>Tag Spotlight</a>.</p><p>Alternatively, attributes can be used to create <a href=https://docs.splunk.com/Observability/apm/span-tags/metricsets.html#monitoring-metricsets target=_blank>Monitoring Metric Sets</a>, which can be used to drive alerting.</p><h2 id=resource-semantic-conventions>Resource Semantic Conventions</h2><p><a href=https://github.com/open-telemetry/opentelemetry-specification/tree/main/specification/resource/semantic_conventions#resource-semantic-conventions target=_blank>OpenTelemetry resource semantic conventions</a> should be used as a starting point when determining which attributes an organization should standardize on. In the following sections, we‚Äôll review some of the more commonly used attributes.</p><h3 id=service-attributes>Service Attributes</h3><p>A number of attributes are used to describe the service being monitored.</p><p><code>service.name</code> is a required attribute that defines the logical name of the service. It‚Äôs added automatically by the OpenTelemetry SDK but can be customized. It‚Äôs best to keep this simple (i.e. <code>inventoryservice</code> would be better than <code>inventoryservice-prod-hostxyz</code>, as other attributes can be utilized to capture other aspects of the service instead).</p><p>The following service attributes are recommended:</p><ul><li><code>service.namespace</code> this attribute could be utilized to identify the team that owns the service</li><li><code>service.instance.id</code> is used to identify a unique instance of the service</li><li><code>service.version</code> is used to identify the version of the service</li></ul><h3 id=telemetry-sdk>Telemetry SDK</h3><p>These attributes are set automatically by the SDK, to record information about the instrumentation libraries being used:</p><ul><li><code>telemetry.sdk.name</code> is typically set to <code>opentelemetry</code></li><li><code>telemetry.sdk.language</code> is the language of the SDK, such as <code>java</code></li><li><code>telemetry.sdk.version</code> identifies which version of the SDK is utilized</li></ul><h3 id=containers>Containers</h3><p>For services running in containers, there are numerous attributes used to describe the container runtime, such as <code>container.id</code>, <code>container.name</code>, and <code>container.image.name</code>. The full list can be found <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/container.md target=_blank>here</a>).</p><h3 id=hosts>Hosts</h3><p>These attributes describe the host where the service is running, and include attributes such as <code>host.id</code>, <code>host.name</code>, and <code>host.arch</code>. The full list can be found <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/host.md target=_blank>here</a>.</p><h3 id=deployment-environment>Deployment Environment</h3><p>The <code>deployment.environment</code> attribute is used to identify the environment where the service is deployed, such as <strong>staging</strong> or <strong>production</strong>.</p><p>Splunk Observability Cloud uses this attribute to enable related content (as described <a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html target=_blank>here</a>), so it‚Äôs important to include it.</p><h3 id=cloud>Cloud</h3><p>There are also attributes to capture information for services running in public cloud environments, such as AWS. Attributes include cloud.provider, <code>cloud.account.id</code>, and <code>cloud.region</code>.</p><p>The full list of attributes can be found <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/cloud.md target=_blank>here</a>.</p><p>Some cloud providers, such as <a href=https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/resource/semantic_conventions/cloud_provider/gcp/README.md target=_blank>GCP</a>, define semantic conventions specific to their offering.</p><h3 id=kubernetes>Kubernetes</h3><p>There are a number of standardized attributes for applications running in Kubernetes as well. Many of these are added automatically by Splunk‚Äôs distribution of the OpenTelemetry collector, as described <a href=https://docs.splunk.com/observability/metrics-and-metadata/enablerelatedcontent.html#splunk-infrastructure-monitoring target=_blank>here</a>.</p><p>These attributes include <code>k8s.cluster.name</code>, <code>k8s.node.name</code>, <code>k8s.pod.name</code>, <code>k8s.namespace.name</code>, and <code>kubernetes.workload.name</code>.</p><h2 id=best-practices-for-creating-custom-attributes>Best Practices for Creating Custom Attributes</h2><p>Many organizations require attributes that go beyond what‚Äôs defined in OpenTelemetry‚Äôs resource semantic conventions.</p><p>In this case, it‚Äôs important to avoid naming conflicts with attribute names already included in the semantic conventions. So it‚Äôs a good idea to check the semantic conventions before deciding on a particular attribute name for your naming convention.</p><p>In addition to a naming convention for attribute names, you also need to consider attribute values. For example, if you‚Äôd like to capture the particular business unit with which an application belongs, then you‚Äôll also want to have a standardized list of business unit values to choose from, to facilitate effective filtering.</p><p>The OpenTelemetry community provides guidelines that should be followed when naming attributes as well, which can be found <a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/ target=_blank>here</a>.</p><p>The <a href=https://opentelemetry.io/docs/specs/otel/common/attribute-naming/#recommendations-for-application-developers target=_blank>Recommendations for Application Developers</a> section is most relevant to our discussion.</p><p>They recommend:</p><ul><li>Prefixing the attribute name with your company‚Äôs domain name, e.g. <code>com.acme.shopname</code> (if the attribute may be used outside your company as well as inside).</li><li>Prefixing the attribute name with the application name, if the attribute is unique to a particular application and is only used within your organization.</li><li>Not using existing OpenTelemetry semantic convention names as a prefix for your attribute name.</li><li>Consider submitting a proposal to add your attribute name to the OpenTelemetry specification, if there‚Äôs a general need for it across different organizations and industries.</li><li>Avoid having attribute names start with <code>otel.*</code>, as this is reserved for OpenTelemetry specification usage.</li></ul><h2 id=metric-cardinality-considerations>Metric Cardinality Considerations</h2><p>One final thing to keep in mind when deciding on naming standards for attribute names and values is related to metric cardinality.</p><p>Metric cardinality is defined as **the number of unique metric time series (MTS) produced by a combination of metric <strong>names and their associated dimensions</strong>.</p><p>A metric has high cardinality when it has a high number of dimension keys and a high number of possible unique values for those dimension keys.</p><p>For example, suppose your application sends in data for a metric named <code>custom.metric</code>. In the absence of any attributes, <code>custom.metric</code> would generate a single metric time series (MTS).</p><p>On the other hand, if <code>custom.metric</code> includes an attribute named <code>customer.id</code>, and there are thousands of customer ID values, this would generate thousands of metric time series, which may impact costs and query performance.</p><p>Splunk Observability Cloud provides a <a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/metrics-usage-report.html target=_blank>report</a> that allows for the management of metrics usage. And <a href=https://docs.splunk.com/Observability/infrastructure/metrics-pipeline/use-metrics-pipeline.html target=_blank>rules</a> can be created to drop undesirable dimensions. However, the first line of defence is understanding how attribute name and value combinations can drive increased metric cardinality.</p><h2 id=summary>Summary</h2><p>In this document, we highlighted the importance of defining naming conventions for OpenTelemetry tags, preferably before starting a large rollout of OpenTelemetry instrumentation.</p><p>We discussed how OpenTelemetry‚Äôs resource semantic conventions define the naming conventions for several attributes, many of which are automatically collected via the OpenTelemetry SDKs, as well as processors that run within the OpenTelemetry collector.</p><p>Finally, we shared some best practices for creating your attribute names, for situations where the resource semantic conventions are not sufficient for your organization‚Äôs needs.</p><footer class=footline></footer></article></section></section></div></main></div><script src=../js/clipboard.min.js?1702058704 defer></script>
<script src=../js/perfect-scrollbar.min.js?1702058704 defer></script>
<script src=../js/d3/d3-color.min.js?1702058704 defer></script>
<script src=../js/d3/d3-dispatch.min.js?1702058704 defer></script>
<script src=../js/d3/d3-drag.min.js?1702058704 defer></script>
<script src=../js/d3/d3-ease.min.js?1702058704 defer></script>
<script src=../js/d3/d3-interpolate.min.js?1702058704 defer></script>
<script src=../js/d3/d3-selection.min.js?1702058704 defer></script>
<script src=../js/d3/d3-timer.min.js?1702058704 defer></script>
<script src=../js/d3/d3-transition.min.js?1702058704 defer></script>
<script src=../js/d3/d3-zoom.min.js?1702058704 defer></script>
<script src=../js/js-yaml.min.js?1702058704 defer></script>
<script src=../js/mermaid.min.js?1702058704 defer></script>
<script>window.themeUseMermaid=JSON.parse("{}")</script><script src=../js/theme.js?1702058704 defer></script></body></html>
<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.0.0+tip"><meta name=description content="Make sure you have your original (or similar) Trace & Span (1) selected in the APM Waterfall view and select Memory Stack Traces (2) from the right-hand pane:
The pane should show you the Memory Stack Trace Flame Graph (3), you can scroll down and/or make the pane for a better view by dragging the right side of the pane.
As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the Flame Graph."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Always-On Profiling in the Trace Waterfall :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Make sure you have your original (or similar) Trace & Span (1) selected in the APM Waterfall view and select Memory Stack Traces (2) from the right-hand pane:
The pane should show you the Memory Stack Trace Flame Graph (3), you can scroll down and/or make the pane for a better view by dragging the right side of the pane.
As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the Flame Graph."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.54/en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Always-On Profiling in the Trace Waterfall :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Make sure you have your original (or similar) Trace & Span (1) selected in the APM Waterfall view and select Memory Stack Traces (2) from the right-hand pane:
The pane should show you the Memory Stack Trace Flame Graph (3), you can scroll down and/or make the pane for a better view by dragging the right side of the pane.
As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the Flame Graph."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content=".conf24 Workshops"><meta property="article:modified_time" content="2024-04-22T12:55:50+01:00"><meta itemprop=name content="Always-On Profiling in the Trace Waterfall :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Make sure you have your original (or similar) Trace & Span (1) selected in the APM Waterfall view and select Memory Stack Traces (2) from the right-hand pane:
The pane should show you the Memory Stack Trace Flame Graph (3), you can scroll down and/or make the pane for a better view by dragging the right side of the pane.
As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the Flame Graph."><meta itemprop=dateModified content="2024-04-22T12:55:50+01:00"><meta itemprop=wordCount content="399"><title>Always-On Profiling in the Trace Waterfall :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.54/en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/index.html rel=canonical type=text/html title="Always-On Profiling in the Trace Waterfall :: Splunk Observability Cloud Workshops"><link href=../../../../../images/favicon.ico?1715858742 rel=icon type=image/x-icon sizes=any><link href=../../../../../css/fontawesome-all.min.css?1715858754 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/fontawesome-all.min.css?1715858754 rel=stylesheet></noscript><link href=../../../../../css/nucleus.css?1715858754 rel=stylesheet><link href=../../../../../css/auto-complete.css?1715858754 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/auto-complete.css?1715858754 rel=stylesheet></noscript><link href=../../../../../css/perfect-scrollbar.min.css?1715858754 rel=stylesheet><link href=../../../../../css/fonts.css?1715858754 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../../../css/fonts.css?1715858754 rel=stylesheet></noscript><link href=../../../../../css/theme.css?1715858754 rel=stylesheet><link href=../../../../../css/theme-splunk-light.css?1715858754 rel=stylesheet id=R-variant-style><link href=../../../../../css/chroma-relearn-light.css?1715858754 rel=stylesheet id=R-variant-chroma-style><link href=../../../../../css/variant.css?1715858754 rel=stylesheet><link href=../../../../../css/print.css?1715858754 rel=stylesheet media=print><link href=../../../../../css/format-print.css?1715858754 rel=stylesheet><script src=../../../../../js/variant.js?1715858754></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../..",window.relearn.relBaseUri="../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.54",window.index_js_url="../../../../../en/index.search.js",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:1000rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/conf24/index.html><span itemprop=name>.conf24 Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/conf24/1-zero-config-k8s/index.html><span itemprop=name>PetClinic Kubernetes Workshop</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/index.html><span itemprop=name>6. Advanced Features</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>2. Trace Waterfall</span><meta itemprop=position content="5"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/1-profiling/index.html title="Always-On Profiling & Metrics (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/3-dbquery/index.html title="Database Query Performance (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=always-on-profiling-in-the-trace-waterfall>Always-On Profiling in the Trace Waterfall</h1><p>Make sure you have your original (or similar) Trace & Span <strong>(1)</strong> selected in the APM Waterfall view and select <strong>Memory Stack Traces (2)</strong> from the right-hand pane:</p><p><a href=#R-image-26e5f2a38636b3be8a7061d4e8f37b2e class=lightbox-link><img alt="profiling from span" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/flamechart-in-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-26e5f2a38636b3be8a7061d4e8f37b2e><img alt="profiling from span" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/flamechart-in-waterfall.png></a></p><p>The pane should show you the Memory Stack Trace Flame Graph <strong>(3)</strong>, you can scroll down and/or make the pane for a better view by dragging the right side of the pane.</p><p>As AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code and reading through thousands of stack traces is not practical, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the <strong>Flame Graph</strong>. It represents a summary of all stack traces captured from your application. You can use the Flame Graph to discover which lines of code might be causing performance issues and to confirm whether the changes you make to the code have the intended effect.</p><p>To dive deeper into the Always-on Profiling, select Span <strong>(3)</strong> in the Profiling Pane under <strong>Memory Stack Traces</strong>
This will bring you to the Always-on Profiling main screen, with the Memory view pre-selected:</p><p><a href=#R-image-4de833b9b651ff40ce27e32010f2f0ae class=lightbox-link><img alt="Profiling main" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/profiling-memory.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4de833b9b651ff40ce27e32010f2f0ae><img alt="Profiling main" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/profiling-memory.png></a></p><ul><li>Java Memory Metric Charts <strong>(1)</strong>, Allow you to <code>Monitor Heap Memory, Application Activity</code> like <code>Memory Allocation Rate</code> and <code>Garbage Collecting</code> Metrics.</li><li>Ability to focus/see metrics and Stack Traces only related to the Span <strong>(2)</strong>, This will filter out background activities running in the Java application if required.</li><li>Java Function calls identified. <strong>(3)</strong>, allowing you to drill down into the Methods called from that function.</li><li>The Flame Graph <strong>(4)</strong>, with the visualization of hierarchy based on the stack traces of the profiled service.</li></ul><p>Once you have identified the relevant Function or Method you are interested in, <code>com.mysql.cj.protocol.a.NativePacketPayload.readBytes</code> in our example but yours may differ, so pick the top one <strong>(1)</strong> and find it at the e bottom of the Flame Graph <strong>(2)</strong>. Click on it in the Flame Graph, it will show a pane as shown in the image below, where you can see the Thread information <strong>(3)</strong> by clicking on the blue <em>Show Thread Info</em> link. If you click on the <em>Copy Stack Trace</em> <strong>(4)</strong> button, you grab the actual stack trace that you can use in your coding platform to go to the actual lines of code used at this point (depending of course on your preferred Coding platform)</p><p><a href=#R-image-e8963752faf96354196e5b2019ef805b class=lightbox-link><img alt="stack trace" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/grab-stack-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e8963752faf96354196e5b2019ef805b><img alt="stack trace" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../../../../en/conf24/1-zero-config-k8s/6-profiling-db-query/2-waterfall/../../images/grab-stack-trace.png></a></p><p>For more details on Profiling, check the the <strong>Debug Problems workshop</strong>, or check the documents <a href=https://docs.splunk.com/observability/en/apm/profiling/intro-profiling.html#introduction-to-alwayson-profiling-for-splunk-apm rel=external target=_blank>here</a></p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Apr 22, 2024</span></span></footer></article></div></main></div><script src=../../../../../js/clipboard.min.js?1715858754 defer></script><script src=../../../../../js/perfect-scrollbar.min.js?1715858754 defer></script><script src=../../../../../js/theme.js?1715858754 defer></script></body></html>
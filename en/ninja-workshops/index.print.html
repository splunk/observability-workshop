<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 8.2.0+9cac649a184a2967957ef9bbececf9402192846c"><meta name=description content="The following workshops require Ninja skills, wax on, wax off."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk4Ninjas Workshops :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="The following workshops require Ninja skills, wax on, wax off."><meta property="og:url" content="https://splunk.github.io/observability-workshop/en/ninja-workshops/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Splunk4Ninjas Workshops :: Splunk Observability Cloud Workshops"><meta property="og:description" content="The following workshops require Ninja skills, wax on, wax off."><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Splunk4Ninjas Workshops :: Splunk Observability Cloud Workshops"><meta itemprop=description content="The following workshops require Ninja skills, wax on, wax off."><meta itemprop=dateModified content="2025-09-29T09:41:12+01:00"><meta itemprop=wordCount content="376"><title>Splunk4Ninjas Workshops :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/en/ninja-workshops/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/en/ninja-workshops/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/ja/ninja-workshops/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/en/ninja-workshops/index.html rel=canonical type=text/html title="Splunk4Ninjas Workshops :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/images/favicon.ico?1763652610 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/css/auto-complete/auto-complete.min.css?1763652610 rel=stylesheet><script src=/observability-workshop/js/auto-complete/auto-complete.min.js?1763652610 defer></script><script src=/observability-workshop/js/search-lunr.min.js?1763652610 defer></script><script src=/observability-workshop/js/search.min.js?1763652610 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/observability-workshop/searchindex.en.js?1763652610"</script><script src=/observability-workshop/js/lunr/lunr.min.js?1763652610 defer></script><script src=/observability-workshop/js/lunr/lunr.stemmer.support.min.js?1763652610 defer></script><script src=/observability-workshop/js/lunr/lunr.multi.min.js?1763652610 defer></script><script src=/observability-workshop/js/lunr/lunr.en.min.js?1763652610 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["en"]</script><link href=/observability-workshop/fonts/fontawesome/css/fontawesome-all.min.css?1763652610 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/fonts/fontawesome/css/fontawesome-all.min.css?1763652610 rel=stylesheet></noscript><link href=/observability-workshop/css/perfect-scrollbar/perfect-scrollbar.min.css?1763652610 rel=stylesheet><link href=/observability-workshop/css/theme.min.css?1763652610 rel=stylesheet><link href=/observability-workshop/css/format-print.min.css?1763652610 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/ninja-workshops/index.html",window.relearn.relBasePath="../..",window.relearn.relBaseUri="../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!0,window.relearn.getItem=(e,t)=>e.getItem(t),window.relearn.setItem=(e,t,n)=>e.setItem(t,n),window.relearn.removeItem=(e,t)=>e.removeItem(t),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.relearn.getItem(window.localStorage,window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.relearn.setItem(window.localStorage,window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({appplicationName:"observability-workshop",realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",recorder:"splunk",features:{video:!0}})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}p{margin:.75rem 0}.highlight{max-height:500px;overflow-y:auto}pre:not(.mermaid){margin:0}</style></head><body class="mobile-support print" data-url=/observability-workshop/en/ninja-workshops/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Splunk4Ninjas Workshops</span><meta itemprop=position content="2"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=/observability-workshop/en/ninja-workshops/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span></div><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=/observability-workshop/en/splunk4rookies/financial-services-observability-cloud/7-wrap-up/key-takeaways/index.html title="Key Takeaways (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><a href=/observability-workshop/en/ninja-workshops/1-automatic-discovery/index.html title="Automatic Discovery Workshops (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable ninja-workshops" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=splunk4ninjas-workshops>Splunk4Ninjas Workshops</h1><div class="children children-type-card children-sort-"><ul class=card-container><li><article class="card card-popout" aria-labelledby=R-card-95314e4a2f2768a2f7c93765ac64f9a9><div class=card-content><div class=card-title id=R-card-95314e4a2f2768a2f7c93765ac64f9a9><a href=/observability-workshop/en/ninja-workshops/1-automatic-discovery/index.html>Automatic Discovery Workshops</a></div><div class=card-content-text>Learn how to leverage Splunk&rsquo;s automatic discovery and configuration capabilities for Java applications. These workshops demonstrate zero-code instrumentation to instantly generate metrics, traces, and logs for comprehensive observability across monolith and Kubernetes deployments.</div></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-47e3ed70e4fba51b69fa17244fefde04><div class=card-content><div class=card-title id=R-card-47e3ed70e4fba51b69fa17244fefde04><a href=/observability-workshop/en/ninja-workshops/2-hpa/index.html>Horizontal Pod Autoscaling</a></div><div class=card-content-text>Learn to monitor Kubernetes Horizontal Pod Autoscaling (HPA) with the Splunk OpenTelemetry Collector, exploring metrics, events, and auto-scaling behavior in real-time</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/2-hpa/images/heatmap-filter-down.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-13fad3e7c575dee356459d3e4b5a03b7><div class=card-content><div class=card-title id=R-card-13fad3e7c575dee356459d3e4b5a03b7><a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/index.html>OpenTelemetry Collector Workshops</a></div><div class=card-content-text>OpenTelemetry Collector Concepts
Learn the concepts of the OpenTelemetry Collector and how to use it to send data to Splunk Observability Cloud.
Advanced OpenTelemetry Collector
Practice setting up the OpenTelemetry Collector configuration from scratch and go though several advanced configuration scenariosâ€™s.</div></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-d72ad146045c0c52c915c6dd4a7cc145><div class=card-content><div class=card-title id=R-card-d72ad146045c0c52c915c6dd4a7cc145><a href=/observability-workshop/en/ninja-workshops/4-synthetics-scripting/index.html>Splunk Synthetic Scripting</a></div><div class=card-content-text>Proactively find and fix performance issues across user flows, business transactions and APIs to deliver better digital experiences.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/4-synthetics-scripting/img/add-new-test.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-877caa2447564e49c5301c37c602ac2b><div class=card-content><div class=card-title id=R-card-877caa2447564e49c5301c37c602ac2b><a href=/observability-workshop/en/ninja-workshops/6-lambda-kinesis/index.html>Lambda Tracing</a></div><div class=card-content-text>This workshop will enable you to build a distributed trace for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/6-lambda-kinesis/images/01-Architecture.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-d6e22c76e1b7b87c9863cc732e126789><div class=card-content><div class=card-title id=R-card-d6e22c76e1b7b87c9863cc732e126789><a href=/observability-workshop/en/ninja-workshops/7-dashboards-detectors/index.html>Dashboard Workshop</a></div><div class=card-content-text>Learn to build insightful visualizations and custom dashboards using Splunk Observability Cloud&rsquo;s charting capabilities, filters, analytical functions, and SignalFlow</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/7-dashboards-detectors/images/3-charts-and-note.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-55ce1f4d1e73fb8bce84c32244b9732f><div class=card-content><div class=card-title id=R-card-55ce1f4d1e73fb8bce84c32244b9732f><a href=/observability-workshop/en/ninja-workshops/8-docker-k8s-otel/index.html>Hands-On OpenTelemetry, Docker, and K8s</a></div><div class=card-content-text>This hands-on workshop guides you through instrumenting a .NET application with OpenTelemetry, containerizing it with Docker, and deploying it to Kubernetes. You&rsquo;ll learn to deploy and configure the OpenTelemetry collector using Helm and troubleshoot common configuration issues.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/8-docker-k8s-otel/images/NetInstrumentation.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-4530a0096edfb48a6bb7801e231ced20><div class=card-content><div class=card-title id=R-card-4530a0096edfb48a6bb7801e231ced20><a href=/observability-workshop/en/ninja-workshops/9-solving-problems-with-o11y-cloud/index.html>Solving Problems with O11y Cloud</a></div><div class=card-content-text>Learn how to deploy and configure the OpenTelemetry Collector, instrument applications with OpenTelemetry, and leverage Troubleshooting MetricSets and Tag Spotlight to identify and resolve performance issues in Splunk Observability Cloud.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/9-solving-problems-with-o11y-cloud/images/apm_overview.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-79fe4bed8ccaf0b7aa3f28e49d88c5c9><div class=card-content><div class=card-title id=R-card-79fe4bed8ccaf0b7aa3f28e49d88c5c9><a href=/observability-workshop/en/ninja-workshops/11-ingest-processor-for-observability-cloud/index.html>Ingest Processor for Observability Cloud</a></div><div class=card-content-text>Learn how to optimize observability costs and improve MTTD by transforming logs into metrics using Splunk Ingest Processor with hands-on exercises in Splunk Observability Cloud.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/11-ingest-processor-for-observability-cloud/images/IngestProcessor-architecture-diagram_release_updated2.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-f71bb9c0e876de75c05097d5d842cd7e><div class=card-content><div class=card-title id=R-card-f71bb9c0e876de75c05097d5d842cd7e><a href=/observability-workshop/en/ninja-workshops/14-cisco-ai-pods/index.html>Monitoring Cisco AI Pods with Splunk Observability Cloud</a></div><div class=card-content-text>This hands-on workshop demonstrates how to monitor Cisco AI Pods with Splunk Observability Cloud. Learn to deploy the OpenTelemetry Collector in Red Hat OpenShift, ingest infrastructure metrics using Prometheus receivers, and configure APM to monitor Python services that interact with Large Language Models (LLMs).</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/14-cisco-ai-pods/images/Cisco-AI-Pod-dashboard.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-cc7950bf5aace135e117f2592c842964><div class=card-content><div class=card-title id=R-card-cc7950bf5aace135e117f2592c842964><a href=/observability-workshop/en/ninja-workshops/15-appd-workshop/index.html>Splunk4Ninjas AppDynamics</a></div><div class=card-content-text>Learn how to use Splunk AppDynamics for full-stack application performance monitoring, from installing Java APM agents and monitoring application health to troubleshooting performance issues, tracking browser metrics with BRUM, analyzing database performance, and gaining business insights with Business IQ.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/15-appd-workshop/images/controller-vm.png></div></article></li></ul></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 29, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk4Ninjas Workshops</h1><article class=default><header class=headline></header><h1 id=automatic-discovery-workshops>Automatic Discovery Workshops</h1><div class="children children-type-card children-sort-"><ul class=card-container><li><article class="card card-popout" aria-labelledby=R-card-eefd0c02fb54f465fcddd7c5a1eb775f><div class=card-content><div class=card-title id=R-card-eefd0c02fb54f465fcddd7c5a1eb775f><a href=/observability-workshop/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/index.html>PetClinic Monolith Workshop</a></div><div class=card-content-text>Hands-on workshop demonstrating Splunk Observability Cloud&rsquo;s automatic discovery and configuration capabilities for Java applications using the Spring PetClinic sample application.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/images/log-observer.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-2c7f001ff2cea28b2bdf668b5a549c97><div class=card-content><div class=card-title id=R-card-2c7f001ff2cea28b2bdf668b5a549c97><a href=/observability-workshop/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/index.html>PetClinic Kubernetes Workshop</a></div><div class=card-content-text>Learn how to enable automatic discovery and configuration for your Java-based application running in Kubernetes. Experience real-time monitoring to help you maximize application behavior with end-to-end visibility.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/images/aa.png></div></article></li></ul></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Automatic Discovery Workshops</h1><article class=default><header class=headline></header><h1 id=petclinic-monolith-workshop>PetClinic Monolith Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>30 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>The goal is to walk through the basic steps to configure the following components of the <strong>Splunk Observability Cloud</strong> platform:</p><ul><li>Splunk Infrastructure Monitoring (IM)</li><li>Splunk Automatic Discovery for Java (APM)<ul><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Real User Monitoring (RUM)</li><li>RUM to APM Correlation</li><li>Splunk Log Observer (LO)</li></ul><p>We will also show the steps about how to clone (download) a sample Java application (Spring PetClinic), as well as how to compile, package and run the application.</p><p>Once the application is up and running, we will instantly start seeing metrics, traces and logs via the <strong>automatic discovery and configuration</strong> for Java 2.x that will be used by the <strong>Splunk APM</strong> product.</p><p>After that, we will instrument PetClinic&rsquo;s end user interface (HTML pages rendered by the application) with the <strong>Splunk OpenTelemetry Javascript Libraries (RUM)</strong> that will generate RUM traces around all the individual clicks and page loads executed by an end user.</p><p>Lastly, we will view the logs generated by the automatic injection of trace metadata into the PetClinic application logs.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info"></i>
Prerequisites</summary><div class=box-content><ul><li>Outbound SSH access to port <code>2222</code>.</li><li>Outbound HTTP access to port <code>8083</code>.</li><li>Familiarity with the <code>bash</code> shell and <code>vi/vim</code> editor.</li></ul></div></details><p><a href=#R-image-2f80ec1d4e9624da651358ca1b90eb65 class=lightbox-link><img alt="PetClinic Exercise" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/images/petclinic-exercise.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f80ec1d4e9624da651358ca1b90eb65><img alt="PetClinic Exercise" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/1-automatic-discovery/1-petclinic-monolith/images/petclinic-exercise.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 29, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of PetClinic Monolith Workshop</h1><article class=default><header class=headline></header><h1 id=installing-the-opentelemetry-collector>Installing the OpenTelemetry Collector</h1><p>The Splunk OpenTelemetry Collector is the core component of instrumenting infrastructure and applications. Its role is to collect and send:</p><ul><li>Infrastructure metrics (disk, CPU, memory, etc.)</li><li>Application Performance Monitoring (APM) traces</li><li>Profiling data</li><li>Host and application logs</li></ul><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Remove any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have completed the Splunk IM workshop, please ensure you have deleted the collector running in Kubernetes before continuing. This can be done by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div><p>The EC2 instance may already have an older version of the collector already installed. To uninstall the collector, run the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh
</span></span><span class=line><span class=cl>sudo sh /tmp/splunk-otel-collector.sh --uninstall</span></span></code></pre></div></div></details><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/check_env.sh</span></span></code></pre></div><p>In the output check that all the following environment variables are present and have values set. If any are missing, please contact your instructor:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>ACCESS_TOKEN
</span></span><span class=line><span class=cl>REALM
</span></span><span class=line><span class=cl>RUM_TOKEN
</span></span><span class=line><span class=cl>HEC_TOKEN
</span></span><span class=line><span class=cl>HEC_URL
</span></span><span class=line><span class=cl>INSTANCE</span></span></code></pre></div><p>We can then go ahead and install the Collector. Some additional parameters are passed to the installation script, they are:</p><ul><li><code>--with-instrumentation</code> - This will install the agent from the Splunk distribution of OpenTelemetry Java, which is then loaded automatically when the PetClinic Java application starts up. No configuration is required!</li><li><code>--deployment-environment</code> - Sets the resource attribute <code>deployment.environment</code> to the value passed. This is used to filter views in the UI.</li><li><code>--enable-profiler</code> - Enables the profiler for the Java application. This will generate CPU profiles for the application.</li><li><code>--enable-profiler-memory</code> - Enables the profiler for the Java application. This will generate memory profiles for the application.</li><li><code>--enable-metrics</code> - Enables the exporting of Micrometer metrics</li><li><code>--hec-token</code> - Sets the HEC token for the collector to use</li><li><code>--hec-url</code> - Sets the HEC URL for the collector to use</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>sudo sh /tmp/splunk-otel-collector.sh --realm <span class=nv>$REALM</span> -- <span class=nv>$ACCESS_TOKEN</span> --mode agent --without-fluentd --with-instrumentation --deployment-environment <span class=nv>$INSTANCE</span>-petclinic --enable-profiler --enable-profiler-memory --enable-metrics --hec-token <span class=nv>$HEC_TOKEN</span> --hec-url <span class=nv>$HEC_URL</span></span></span></code></pre></div><p>Next, we will patch the collector to expose the hostname of the instance and not the AWS instance ID. This will make it easier to filter data in the UI:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo sed -i <span class=s1>&#39;s/gcp, ecs, ec2, azure, system/system, gcp, ecs, ec2, azure/g&#39;</span> /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Once the <code>agent_config.yaml</code> has been patched, you will need to restart the collector:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div><p>Once the installation is completed, you can navigate to the <strong>Hosts with agent installed</strong> dashboard to see the data from your host, <strong>Dashboards â†’ Hosts with agent installed</strong>.</p><p>Use the dashboard filter and select <code>host.name</code> and type or select the hostname of your workshop instance (you can get this from the command prompt in your terminal session). Once you see data flowing for your host, we are then ready to get started with the APM component.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=building-the-spring-petclinic-application>Building the Spring PetClinic Application</h1><p>The first thing we need to set up APM is&mldr; well, an application. For this exercise, we will use the Spring PetClinic application. This is a very popular sample Java application built with the Spring framework (Springboot).</p><p>First, clone the PetClinic GitHub repository, and then we will compile, build, package and test the application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/spring-projects/spring-petclinic</span></span></code></pre></div><p>Change into the <code>spring-petclinic</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> spring-petclinic
</span></span><span class=line><span class=cl>git checkout b26f235250627a235a2974a22f2317dbef27338d</span></span></code></pre></div><p>Using Docker, start a MySQL database for PetClinic to use:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -d -e <span class=nv>MYSQL_USER</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_PASSWORD</span><span class=o>=</span>petclinic -e <span class=nv>MYSQL_ROOT_PASSWORD</span><span class=o>=</span>root -e <span class=nv>MYSQL_DATABASE</span><span class=o>=</span>petclinic -p 3306:3306 docker.io/biarms/mysql:5.7</span></span></code></pre></div><p>Next, we will start another container running Locust that will generate some simple traffic to the PetClinic application. Locust is a simple load-testing tool that can be used to generate traffic to a web application.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --network<span class=o>=</span><span class=s2>&#34;host&#34;</span> -d -p 8090:8090 -v ~/workshop/petclinic:/mnt/locust docker.io/locustio/locust -f /mnt/locust/locustfile.py --headless -u <span class=m>1</span> -r <span class=m>1</span> -H http://127.0.0.1:8083</span></span></code></pre></div><p>Next, compile, build and package PetClinic using <code>maven</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>This will take a few minutes the first time you run and will download a lot of dependencies before it compiles the application. Future builds will be a lot quicker.</p></div></details><p>Once the build completes, you need to obtain the public IP address of the instance you are running on. You can do this by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://ifconfig.me</span></span></code></pre></div><p>You will see an IP address returned, make a note of this as we will need it to validate that the application is running.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 7, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=automatic-discovery-and-configuration-for-java>Automatic discovery and configuration for Java</h1><p>You can now start the application with the following command. Notice that we are passing the <code>mysql</code> profile to the application, this will tell the application to use the MySQL database we started earlier. We are also setting the <code>otel.service.name</code> and <code>otel.resource.attributes</code> to a logical names using the instance name. These will also be used in the UI for filtering:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>You can validate the application is running by visiting <code>http://&lt;IP_ADDRESS>:8083</code> (replace <code>&lt;IP_ADDRESS></code> with the IP address you obtained earlier).</p><p>When we installed the collector we configured it to enable <strong>AlwaysOn Profiling</strong> and <strong>Metrics</strong>. This means that the collector will automatically generate CPU and Memory profiles for the application and send them to Splunk Observability Cloud.</p><p>When you start the PetClinic application you will see the collector automatically detect the application and instrument it for traces and profiling.</p><div class=tab-panel data-tab-group=R-tabs-4a4f2a7604cd49168bfba99cbcea4f9f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-b4c7357c9a08ea21ce1f802ec74f6e0d aria-expanded=true data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4a4f2a7604cd49168bfba99cbcea4f9f","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-b4c7357c9a08ea21ce1f802ec74f6e0d data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Picked up JAVA_TOOL_OPTIONS: -javaagent:/usr/lib/splunk-instrumentation/splunk-otel-javaagent.jar
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:58:970 +0000] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: splunk-2.6.0-otel-2.6.0
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - Profiler configuration:
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:730 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                  splunk.profiler.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                splunk.profiler.directory : /tmp
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -       splunk.profiler.recording.duration : 20s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:731 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -               splunk.profiler.keep-files : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -            splunk.profiler.logs-endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -              otel.exporter.otlp.endpoint : null
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -           splunk.profiler.memory.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -        splunk.profiler.memory.event.rate : 150/s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:732 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.call.stack.interval : PT10S
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -  splunk.profiler.include.internal.stacks : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.tracing.stacks.only : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-08-20 11:35:59:733 +0000] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.</span></span></code></pre></div></div></div></div></div><p>You can now visit the Splunk APM UI and examine the application components, traces, profiling, DB Query performance and metrics. From the left-hand menu click <strong>APM</strong> and then click the <strong>Environment</strong> dropdown and select your environment e.g. <code>&lt;INSTANCE>-petclinic</code> (where<code>&lt;INSTANCE></code> is replaced with the value you noted down earlier).</p><p>Once your validation is complete you can stop the application by pressing <code>Ctrl-c</code>.</p><p>Resource attributes can be added to every reported span. For example <code>version=0.314</code>. A comma-separated list of resource attributes can also be defined e.g. <code>key1=val1,key2=val2</code>.</p><p>Let&rsquo;s launch the PetClinic again using new resource attributes. Note, that adding resource attributes to the run command will override what was defined when we installed the collector. Let&rsquo;s add a new resource attribute <code>version=0.314</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env,version<span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Back in the Splunk APM UI we can drill down on a recent trace and see the new <code>version</code> attribute in a span.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-real-user-monitoring>3. Real User Monitoring</h1><p>For the Real User Monitoring (RUM) instrumentation, we will add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web rel=external><strong>https://github.com/signalfx/splunk-otel-js-web</strong></a> snippet in the pages, we will use the wizard again <strong>Data Management â†’ Add Integration â†’ RUM Instrumentation â†’ Browser Instrumentation</strong>.</p><p>Your instructor will inform you which token to use from the dropdown, click <strong>Next</strong>. Enter <strong>App name</strong> and <strong>Environment</strong> using the following syntax:</p><ul><li><code>&lt;INSTANCE>-petclinic-service</code> - replacing <code>&lt;INSTANCE></code> with the value you noted down earlier.</li><li><code>&lt;INSTANCE>-petclinic-env</code> - replacing <code>&lt;INSTANCE></code> with the value you noted down earlier.</li></ul><p>The wizard will then show a snippet of HTML code that needs to be placed at the top of the pages in the <code>&lt;head></code> section. The following is an example of the (do not use this snippet, use the one generated by the wizard):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>/*
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>IMPORTANT: Replace the <span class=p>&lt;</span><span class=nt>version</span><span class=p>&gt;</span> placeholder in the src URL with a
</span></span><span class=line><span class=cl>version from https://github.com/signalfx/splunk-otel-js-web/releases
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>*/
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>realm</span><span class=o>:</span> <span class=s2>&#34;eu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=s2>&#34;&lt;redacted&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>applicationName</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-env&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span></span></span></code></pre></div><p>The Spring PetClinic application uses a single HTML page as the &ldquo;layout&rdquo; page, that is reused across all pages of the application. This is the perfect location to insert the Splunk RUM Instrumentation Library as it will be loaded in all pages automatically.</p><p>Let&rsquo;s then edit the layout page:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi src/main/resources/templates/fragments/layout.html</span></span></code></pre></div><p>Next, insert the snippet we generated above in the <code>&lt;head></code> section of the page. Make sure you don&rsquo;t include the comment and replace <code>&lt;version></code> in the source URL to <code>latest</code> e.g.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;!doctype html&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>html</span> <span class=na>th:fragment</span><span class=o>=</span><span class=s>&#34;layout (template, menu)&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>head</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>        <span class=nx>realm</span><span class=o>:</span> <span class=s2>&#34;eu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=s2>&#34;&lt;redacted&gt;&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>applicationName</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-service&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=s2>&#34;petclinic-1be0-petclinic-env&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>...</span></span></code></pre></div><p>With the code changes complete, we need to rebuild the application and run it again. Run the <code>maven</code> command to compile/build/package PetClinic:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=nv>$INSTANCE</span>-petclinic-env,version<span class=o>=</span>0.314 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>Then let&rsquo;s visit the application using a browser to generate real-user traffic <code>http://&lt;IP_ADDRESS>:8083</code>.</p><p>In RUM, filter down into the environment as defined in the RUM snippet above and click through to the dashboard.</p><p>When you drill down into a RUM trace you will see a link to APM in the spans. Clicking on the trace ID will take you to the corresponding APM trace for the current RUM trace.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-log-observer>4. Log Observer</h1><p>For the Splunk Log Observer component, the Splunk OpenTelemetry Collector automatically collects logs from the Spring PetClinic application and sends them to Splunk Observability Cloud using the OTLP exporter, anotating the log events with <code>trace_id</code>, <code>span_id</code> and trace flags.</p><p>Log Observer provides a real-time view of logs from your applications and infrastructure. It allows you to search, filter, and analyze logs to troubleshoot issues and monitor your environment.</p><p>Go back to the PetClinic web application and click on the <strong>Error</strong> link several times. This will generate some log messages in the PetClinic application logs.</p><p><a href=#R-image-1395e1229b6d0bfac75208e2d0f6a08a class=lightbox-link><img alt="PetClinic Error" class="lazy lightbox figure-image" loading=lazy src=../images/petclinic-error.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1395e1229b6d0bfac75208e2d0f6a08a><img alt="PetClinic Error" class="lazy lightbox lightbox-image" loading=lazy src=../images/petclinic-error.png></a></p><p>From the left-hand menu click on <strong>Log Observer</strong> and ensure <strong>Index</strong> is set to <strong>splunk4rookies-workshop</strong>.</p><p>Next, click <strong>Add Filter</strong> search for the field <code>service.name</code> select the value <code>&lt;INSTANCE>-petclinic-service</code> and click <code>=</code> (include). You should now see only the log messages from your PetClinic application.</p><p>Select one of the log entries that were generated by clicking on the <strong>Error</strong> link in the PetClinic application. You will see the log message and the trace metadata that was automatically injected into the log message. Also, you will notice that Related Content is available for APM and Infrastructure.</p><p><a href=#R-image-4931d6ee8824b659b2375bf264b34f1a class=lightbox-link><img alt="Log Observer" class="lazy lightbox figure-image" loading=lazy src=../images/log-observer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4931d6ee8824b659b2375bf264b34f1a><img alt="Log Observer" class="lazy lightbox lightbox-image" loading=lazy src=../images/log-observer.png></a></p><p>This is the end of the workshop and we have certainly covered a lot of ground. At this point, you should have metrics, traces (APM & RUM), logs, database query performance and code profiling being reported into Splunk Observability Cloud and all without having to modify the PetClinic application code (well except for RUM).</p><p><strong>Congratulations!</strong></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=spring-petclinic-springboot-based-microservices-on-kubernetes>Spring PetClinic SpringBoot Based Microservices On Kubernetes</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>90 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Pieter Hagen</span></span><p>The goal of this workshop is to introduce the features of Splunk&rsquo;s <strong>automatic discovery and configuration</strong> for Java.</p><p>The workshop scenario will be created by installing a simple (<strong>un-instrumented</strong>) Java microservices application in Kubernetes.</p><p>Following simple steps to install the Splunk OpenTelemetry Collector with automatic discovery for existing Java based deployments, we will see how easy it is to send metrics, traces and logs to <strong>Splunk Observability Cloud</strong>.</p><details open class="box cstyle notices splunk"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-circle-info"></i>
Prerequisites</summary><div class=box-content><ul><li>Outbound SSH access to port <strong>2222</strong>.</li><li>Outbound HTTP access to port <strong>81</strong>.</li><li>Familiarity with the Linux command line.</li></ul></div></details><p>During this workshop we will cover the following components:</p><ul><li>Splunk Infrastructure Monitoring (<strong>IM</strong>)</li><li>Splunk automatic discovery and configuration for Java (<strong>APM</strong>)<ul><li>Database Query Performance</li><li>AlwaysOn Profiling</li></ul></li><li>Splunk Log Observer (<strong>LO</strong>)</li><li>Splunk Real User Monitoring (<strong>RUM</strong>)</li></ul><p><em>Splunk Synthetics is feeling a little left out here, but we cover that in other workshops</em> <i class="fa-fw fas fa-heart"></i></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of PetClinic Kubernetes Workshop</h1><article class=default><header class=headline></header><h1 id=architecture>Architecture</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>The Spring PetClinic Java application is a simple microservices application that consists of frontend and backend services. The frontend service is a Spring Boot application that serves a web interface to interact with backend services. The backend services are Spring Boot applications that serve RESTful API&rsquo;s to interact with a MySQL database.</p><p>By the end of this workshop, you will have a better understanding of how to enable <strong>automatic discovery and configuration</strong> for your Java-based applications running in Kubernetes.</p><p>The diagram below details the architecture of the Spring PetClinic Java application running in Kubernetes with the Splunk OpenTelemetry Operator and automatic discovery and configuration enabled.</p><p><a href=#R-image-0261672e7afaff259d194997cb386f4e class=lightbox-link><img alt="Splunk Otel Architecture" class="lazy lightbox figure-image" loading=lazy src=../images/auto-instrumentation-java-diagram.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0261672e7afaff259d194997cb386f4e><img alt="Splunk Otel Architecture" class="lazy lightbox lightbox-image" loading=lazy src=../images/auto-instrumentation-java-diagram.png></a></p><hr><p>Based on the <a href=https://github.com/signalfx/splunk-otel-collector-chart/blob/main/examples/enable-operator-and-auto-instrumentation/spring-petclinic-java.md rel=external><strong>example</strong></a> <strong>Josh Voravong</strong> created.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=preparation-of-the-workshop-instance>Preparation of the Workshop instance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>The instructor will provide you with the login information for the instance that we will be using during the workshop.</p><p>When you first log into your instance, you will be greeted by the Splunk Logo as shown below. If you have any issues connecting to your workshop instance, please reach out to your Instructor.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$ ssh -p 2222 splunk@&lt;IP-ADDRESS&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—  
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•    â•šâ–ˆâ–ˆâ•— 
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•      â•šâ–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—      â–ˆâ–ˆâ•”â•
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â• 
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•    â•šâ•â•  
</span></span><span class=line><span class=cl>Last login: Mon Feb  5 11:04:54 2024 from [Redacted]
</span></span><span class=line><span class=cl>splunk@show-no-config-i-0d1b29d967cb2e6ff ~ $</span></span></code></pre></div><p>To ensure your instance is configured correctly, we need to confirm that the required environment variables for this workshop are set correctly. In your terminal, run the following script and check that the environment variables are present and set with actual valid values:</p><div class=tab-panel data-tab-group=R-tabs-b8c2b2ec1353f1fc53be4e24c77034ff><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-c7a6b9a2a710b502b2b5ba6b3b2fbb4d aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b8c2b2ec1353f1fc53be4e24c77034ff","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-71cb84571bac8debc406a415eb1fdfe3 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b8c2b2ec1353f1fc53be4e24c77034ff","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-c7a6b9a2a710b502b2b5ba6b3b2fbb4d data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/check_env.sh</span></span></code></pre></div></div></div><div id=R-tab-id-71cb84571bac8debc406a415eb1fdfe3 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ACCESS_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>REALM</span> <span class=o>=</span> &lt;e.g. eu0, us1, us2, jp0, au0 etc.&gt;
</span></span><span class=line><span class=cl><span class=nv>RUM_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>HEC_TOKEN</span> <span class=o>=</span> &lt;redacted&gt;
</span></span><span class=line><span class=cl><span class=nv>HEC_URL</span> <span class=o>=</span> https://&lt;...&gt;/services/collector/event
</span></span><span class=line><span class=cl><span class=nv>INSTANCE</span> <span class=o>=</span> &lt;instance_name&gt;</span></span></code></pre></div></div></div></div></div><p>Please make a note of the <code>INSTANCE</code> environment variable value as this will be used later to filter data in <strong>Splunk Observability Cloud</strong>.</p><p>For this workshop, <strong>all</strong> the above environment variables are required. If any have values missing, please contact your Instructor.</p><details open class="box cstyle notices splunk"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-circle-info"></i>
Delete any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have previously completed a Splunk Observability workshop using this EC2 instance, you
need to ensure that any existing installation of the Splunk OpenTelemetry Collector is
deleted. This can be achieved by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Preparation</h1><article class=default><header class=headline></header><h1 id=deploy-the-splunk-opentelemetry-collector>Deploy the Splunk OpenTelemetry Collector</h1><p>To get Observability signals (<strong>metrics, traces</strong> and <strong>logs</strong>) into <strong>Splunk Observability Cloud</strong> we need to deploy the Splunk OpenTelemetry Collector into the Kubernetes cluster.</p><p>For this workshop, we will be using the Splunk OpenTelemetry Collector Helm Chart. First, we need to add the Helm chart repository to Helm and run <code>helm repo update</code> to ensure the latest version:</p><div class=tab-panel data-tab-group=R-tabs-959177c14685292e1fae1bbaacf0a464><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d26982970ad3299c0ed387623d16883b aria-expanded=true data-tab-item=R-tab-62904166d08e5d1c0cd759a707578288 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-959177c14685292e1fae1bbaacf0a464","R-tab-62904166d08e5d1c0cd759a707578288")'>
<span class=tab-nav-text>Install Helm Chart</span>
</button>
<button aria-controls=R-tab-id-2446a3f37a8cf69622f00e7c9d82cd90 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-959177c14685292e1fae1bbaacf0a464","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d26982970ad3299c0ed387623d16883b data-tab-item=R-tab-62904166d08e5d1c0cd759a707578288 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div id=R-tab-id-2446a3f37a8cf69622f00e7c9d82cd90 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>&#34;splunk-otel-collector-chart&#34; has been added to your repositories
</span></span><span class=line><span class=cl>Using ACCESS_TOKEN={REDACTED}
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>Hang tight while we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
</span></span><span class=line><span class=cl>Update Complete. âŽˆHappy Helming!âŽˆ</span></span></code></pre></div></div></div></div></div><p><strong>Splunk Observability Cloud</strong> offers wizards in the UI to walk you through the setup of the OpenTelemetry Collector on Kubernetes, but in the interest of time, we will use the Helm install command below. Additional parameters are set to enable the operator for automatic discovery and configuration and code profiling.</p><ul><li><code>--set="operator.enabled=true"</code> - this will install the OpenTelemetry operator that will be used to handle automatic discovery and configuration.</li><li><code>--set="splunkObservability.profilingEnabled=true"</code> - this enables Code Profiling via the operator.</li></ul><p>To install the collector run the following command. Do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=R-tabs-2ac4e7f8c3fe3bf0cc12985e686bdb5e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d305201cc14ec411cbd33bc298ee3540 aria-expanded=true data-tab-item=R-tab-5ade205167430c5bf55768631515900b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2ac4e7f8c3fe3bf0cc12985e686bdb5e","R-tab-5ade205167430c5bf55768631515900b")'>
<span class=tab-nav-text>Helm Install</span>
</button>
<button aria-controls=R-tab-id-c428f59bc9c1eb2d29716283edaf7f5d aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-2ac4e7f8c3fe3bf0cc12985e686bdb5e","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d305201cc14ec411cbd33bc298ee3540 data-tab-item=R-tab-5ade205167430c5bf55768631515900b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.136.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;operatorcrds.install=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;operator.enabled=true&#34;</span>, <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.profilingEnabled=true&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;agent.service.enabled=true&#34;</span>  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$INSTANCE</span><span class=s2>-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-c428f59bc9c1eb2d29716283edaf7f5d data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-plaintext data-lang=plaintext><span class=line><span class=cl>LAST DEPLOYED: Fri Apr 19 09:39:54 2024
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 1
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Platform endpoint &#34;https://http-inputs-o11y-workshop-eu0.splunkcloud.com:443/services/collector/event&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm eu0.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[INFO] You&#39;ve enabled the operator&#39;s auto-instrumentation feature (operator.enabled=true)! The operator can automatically instrument Kubernetes hosted applications.
</span></span><span class=line><span class=cl>  - Status: Instrumentation language maturity varies. See `operator.instrumentation.spec` and documentation for utilized instrumentation details.
</span></span><span class=line><span class=cl>  - Splunk Support: We offer full support for Splunk distributions and best-effort support for native OpenTelemetry distributions of auto-instrumentation libraries.</span></span></code></pre></div></div></div></div></div><p>Ensure the Pods are reported as <strong>Running</strong> before continuing (this typically takes around 30 seconds).</p><div class=tab-panel data-tab-group=R-tabs-102d91bcdfd71eab3cee42d831f59596><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1af0c1a0c4f2f3510ae26f496d184b3c aria-expanded=true data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-102d91bcdfd71eab3cee42d831f59596","R-tab-380f56daf2c41382fed5e183e4f1fbe1")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button aria-controls=R-tab-id-50c0fedc16602226592df086778e7038 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-102d91bcdfd71eab3cee42d831f59596","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-1af0c1a0c4f2f3510ae26f496d184b3c data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=p>|</span> grep splunk-otel </span></span></code></pre></div></div></div><div id=R-tab-id-50c0fedc16602226592df086778e7038 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-6bd5567d95-5f8cj     1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-tspd2                               1/1     Running   0          10m
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-69d476cb7-j7zwd                  2/2     Running   0          10m</span></span></code></pre></div></div></div></div></div><p>Ensure there are no errors reported by the Splunk OpenTelemetry Collector (press <code>ctrl + c</code> to exit) or use the installed <strong>awesome</strong> <code>k9s</code> terminal UI for bonus points!</p><div class=tab-panel data-tab-group=R-tabs-5d4b987adf0f10ebc52f5111b6fed0cc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-67401a51000c0615ab64eba51ee55add aria-expanded=true data-tab-item=R-tab-66b92e950fb2f856e1fdec23c736e201 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-5d4b987adf0f10ebc52f5111b6fed0cc","R-tab-66b92e950fb2f856e1fdec23c736e201")'>
<span class=tab-nav-text>kubectl logs</span>
</button>
<button aria-controls=R-tab-id-a2311f5e2ec256052dfdfd42abb5a086 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-5d4b987adf0f10ebc52f5111b6fed0cc","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-67401a51000c0615ab64eba51ee55add data-tab-item=R-tab-66b92e950fb2f856e1fdec23c736e201 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-a2311f5e2ec256052dfdfd42abb5a086 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    service/service.go:364  Starting receivers...
</span></span><span class=line><span class=cl>2021-03-21T16:11:10.900Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/watcher.go:195       Configured Kubernetes MetadataExporter  {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;, &#34;exporter_name&#34;: &#34;signalfx&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    healthcheck/handler.go:128      Health Check state change       {&#34;component_kind&#34;: &#34;extension&#34;, &#34;component_type&#34;: &#34;health_check&#34;, &#34;component_name&#34;: &#34;health_check&#34;, &#34;status&#34;: &#34;ready&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    service/service.go:267  Everything is ready. Begin running and processing data.
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:59       Starting shared informers and wait for initial cache sync.      {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
</span></span><span class=line><span class=cl>2021-03-21T16:11:11.281Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:75       Completed syncing shared informer caches.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Deleting a failed installation</summary><div class=box-content><p>If you make an error installing the OpenTelemetry Collector you can start over by deleting the
installation with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-petclinic-application>Deploy the PetClinic Application</h1><p>The first deployment of our application will be using prebuilt containers to give this base scenario: a regular Java microservices-based application running in Kubernetes that we want to start observing. So let&rsquo;s deploy the application:</p><div class=tab-panel data-tab-group=R-tabs-9a36737b5afa4b4f20e2af2271e8d600><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-b08aae5fa54a5d9804f11cd2aa13cc76 aria-expanded=true data-tab-item=R-tab-8666ad26e93cd530823e6e5a5c706f5a class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9a36737b5afa4b4f20e2af2271e8d600","R-tab-8666ad26e93cd530823e6e5a5c706f5a")'>
<span class=tab-nav-text>kubectl apply</span>
</button>
<button aria-controls=R-tab-id-e07d89460a31a750f11377355b26bf4a aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-9a36737b5afa4b4f20e2af2271e8d600","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-b08aae5fa54a5d9804f11cd2aa13cc76 data-tab-item=R-tab-8666ad26e93cd530823e6e5a5c706f5a class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/petclinic/deployment.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-e07d89460a31a750f11377355b26bf4a data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server created
</span></span><span class=line><span class=cl>service/config-server created
</span></span><span class=line><span class=cl>deployment.apps/discovery-server created
</span></span><span class=line><span class=cl>service/discovery-server created
</span></span><span class=line><span class=cl>deployment.apps/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway created
</span></span><span class=line><span class=cl>service/api-gateway-external created
</span></span><span class=line><span class=cl>deployment.apps/customers-service created
</span></span><span class=line><span class=cl>service/customers-service created
</span></span><span class=line><span class=cl>deployment.apps/vets-service created
</span></span><span class=line><span class=cl>service/vets-service created
</span></span><span class=line><span class=cl>deployment.apps/visits-service created
</span></span><span class=line><span class=cl>service/visits-service created
</span></span><span class=line><span class=cl>deployment.apps/admin-server created
</span></span><span class=line><span class=cl>service/admin-server created
</span></span><span class=line><span class=cl>service/petclinic-db created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-db created
</span></span><span class=line><span class=cl>configmap/petclinic-db-initdb-config created
</span></span><span class=line><span class=cl>deployment.apps/petclinic-loadgen-deployment created
</span></span><span class=line><span class=cl>configmap/scriptfile created</span></span></code></pre></div></div></div></div></div><p>At this point, we can verify the deployment by checking that the Pods are running. The containers need to be downloaded and started, so this may take a couple of minutes.</p><div class=tab-panel data-tab-group=R-tabs-cfcfbf637249a5d00c9452f1132efcc8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-775de6107f8761c9fc4752fb97b3d1ff aria-expanded=true data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-cfcfbf637249a5d00c9452f1132efcc8","R-tab-380f56daf2c41382fed5e183e4f1fbe1")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button aria-controls=R-tab-id-d1551256d90dd84328859056d4e9079d aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-cfcfbf637249a5d00c9452f1132efcc8","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-775de6107f8761c9fc4752fb97b3d1ff data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div id=R-tab-id-d1551256d90dd84328859056d4e9079d data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                            READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-655dcd9b6b-dcvkb     1/1     Running   <span class=m>0</span>          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-dg2vj                               1/1     Running   <span class=m>0</span>          114s
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-57cbb8d7b4-dk5wf                 2/2     Running   <span class=m>0</span>          114s
</span></span><span class=line><span class=cl>petclinic-db-64d998bb66-2vzpn                                   1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>api-gateway-d88bc765-jd5lg                                      1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>visits-service-7f97b6c579-bh9zj                                 1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>admin-server-76d8b956c5-mb2zv                                   1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>customers-service-847db99f79-mzlg2                              1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>vets-service-7bdcd7dd6d-2tcfd                                   1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>petclinic-loadgen-deployment-5d69d7f4dd-xxkn4                   1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>config-server-67f7876d48-qrsr5                                  1/1     Running   <span class=m>0</span>          58s
</span></span><span class=line><span class=cl>discovery-server-554b45cfb-bqhgt                                1/1     Running   <span class=m>0</span>          58s</span></span></code></pre></div></div></div></div></div><p>Make sure the output of <code>kubectl get pods</code> matches the output as shown in the above Output tab. Ensure all the services are shown as <strong>Running</strong> (or use <code>k9s</code> to continuously monitor the status).</p><p>To test the application, you need to obtain the public IP address of your instance. You can do this by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://ifconfig.me</span></span></code></pre></div><p>Validate if the application is running by visiting <strong>http://&lt;IP_ADDRESS>:81</strong> (replace <strong>&lt;IP_ADDRESS></strong> with the IP address you obtained above). You should see the PetClinic application running. The application is also running on ports <strong>80</strong> & <strong>443</strong> if you prefer to use those or port <strong>81</strong> is unreachable.</p><p><a href=#R-image-9efdfae72479341489dc4424455a1472 class=lightbox-link><img alt="Pet shop" class="lazy lightbox figure-image" loading=lazy src=../../images/petclinic.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9efdfae72479341489dc4424455a1472><img alt="Pet shop" class="lazy lightbox lightbox-image" loading=lazy src=../../images/petclinic.png></a></p><p>Make sure the application is working correctly by visiting the <strong>All Owners</strong> <strong>(1)</strong> and <strong>Veterinarians</strong> <strong>(2)</strong> tabs, confirming that you see a list of names on each page.</p><p><a href=#R-image-961ef72044b790a648ebf4d1297f9a60 class=lightbox-link><img alt=Owners class="lazy lightbox figure-image" loading=lazy src=../../images/petclinic-owners.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-961ef72044b790a648ebf4d1297f9a60><img alt=Owners class="lazy lightbox lightbox-image" loading=lazy src=../../images/petclinic-owners.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=verify-kubernetes-cluster-metrics>Verify Kubernetes Cluster metrics</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Once the installation has completed, you can log in to <strong>Splunk Observability Cloud</strong> and verify that the metrics are flowing in from your Kubernetes cluster.</p><p>From the left-hand menu, click on <strong>Infrastructure</strong> and select <strong>Kubernetes</strong>, then select the <strong>Kubernetes nodes</strong> tile.</p><p><a href=#R-image-836479a9ec2eadc9792ed4b60031b1a2 class=lightbox-link><img alt=NavigatorList class="lazy lightbox figure-image" loading=lazy src=../images/navigatorlist.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-836479a9ec2eadc9792ed4b60031b1a2><img alt=NavigatorList class="lazy lightbox lightbox-image" loading=lazy src=../images/navigatorlist.png></a></p><p>Once you are in the <strong>Kubernetes nodes</strong> overview, change the <strong>Time</strong> filter from <strong>-1h</strong> to the last 15 minutes <strong>(-15m)</strong> to focus on the latest data, then select <strong>Table</strong> to list all the nodes that are reporting metrics.</p><p>Next, in the <strong>Refine by:</strong> panel, select <strong>Cluster name</strong> and choose your cluster from the list.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>To identify your specific cluster, use the <code>INSTANCE</code> value from the shell script output you ran during setup. This unique identifier helps you locate your workshop cluster among other nodes in the list.</p></div></details><p>This will filter the list to show only the nodes from your cluster.</p><p><a href=#R-image-a6c739b4c49b6f11478b57e12c5dcb88 class=lightbox-link><img alt="K8s Nodes" class="lazy lightbox figure-image" loading=lazy src=../images/k8s-nodes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a6c739b4c49b6f11478b57e12c5dcb88><img alt="K8s Nodes" class="lazy lightbox lightbox-image" loading=lazy src=../images/k8s-nodes.png></a></p><p>Switch to the <strong>K8s node logs</strong> view to see the logs from your nodes.</p><p><a href=#R-image-86491925af092cfb2c999713cac32b5a class=lightbox-link><img alt=Logs class="lazy lightbox figure-image" loading=lazy src=../images/k8s-peek-at-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-86491925af092cfb2c999713cac32b5a><img alt=Logs class="lazy lightbox lightbox-image" loading=lazy src=../images/k8s-peek-at-logs.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 14, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=setting-up-automatic-discovery-and-configuration-for-apm>Setting up automatic discovery and configuration for APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, we will enable <strong>automatic discovery and configuration</strong> for the Java services running in Kubernetes. This means that the OpenTelemetry Collector will look for Pod annotations that indicate that the Java application should be instrumented with the Splunk OpenTelemetry Java agent. This will allow us to get traces, spans, and profiling data from Java services running on the cluster.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
automatic discovery and configuration</summary><div class=box-content><p>It is important to understand that automatic discovery and configuration is designed to get <strong>trace, span & profiling</strong> data out of your application <strong>without requiring code changes or recompilation</strong>.</p><p>This is a great way to get started with APM, but it is <strong>not</strong> a replacement for manual instrumentation. Manual instrumentation allows you to add custom spans, tags, and logs to your application, which can provide more context and detail to your traces.</p></div></details><p>For Java applications, the OpenTelemetry Collector will look for the annotation <code>instrumentation.opentelemetry.io/inject-java</code>.</p><p>The annotation can have the value set to <code>true</code> or to the <code>namespace/daemonset</code> of the OpenTelemetry Collector e.g. <code>default/splunk-otel-collector</code>. This allows working across namespaces and is what we will use in this workshop.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Using the deployment.yaml</summary><div class=box-content><p>If you want your Pods to send traces automatically, you can add the annotation to the <code>deployment.yaml</code> as shown below. This will add the instrumentation library during the initial deployment. To speed things up we have done that for the following Pods:</p><ul><li><strong>admin-server</strong></li><li><strong>config-server</strong></li><li><strong>discovery-server</strong></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app.kubernetes.io/part-of</span><span class=p>:</span><span class=w> </span><span class=l>spring-petclinic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>admin-server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instrumentation.opentelemetry.io/inject-java</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;default/splunk-otel-collector&#34;</span></span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Automatic discovery and configuration</h1><article class=default><header class=headline></header><h1 id=patching-the-deployment>Patching the Deployment</h1><p>To configure <strong>automatic discovery and configuration</strong>, the deployments need to be patched to add the instrumentation annotation. Once patched, the OpenTelemetry Collector will inject the automatic discovery and configuration library and the Pods will be restarted in order to start sending traces and profiling data. First, confirm that the <code>api-gateway</code> does not have the <code>splunk-otel-java</code> image by running the following:</p><div class=tab-panel data-tab-group=R-tabs-5e792b116dc6ef3a62032ed8dc0b26c5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e6126ff48badb3c561d55036117199b3 aria-expanded=true data-tab-item=R-tab-147de2e4d489d131e220c244ab59800a class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-5e792b116dc6ef3a62032ed8dc0b26c5","R-tab-147de2e4d489d131e220c244ab59800a")'>
<span class=tab-nav-text>Describe api-gateway</span>
</button>
<button aria-controls=R-tab-id-976f34b3d4239e0f624049f2f523a081 aria-expanded=false data-tab-item=R-tab-397382ef4cd20471e3d9c9fecb6c01a7 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-5e792b116dc6ef3a62032ed8dc0b26c5","R-tab-397382ef4cd20471e3d9c9fecb6c01a7")'>
<span class=tab-nav-text>Describe Output</span></button></div><div class=tab-content-container><div id=R-tab-id-e6126ff48badb3c561d55036117199b3 data-tab-item=R-tab-147de2e4d489d131e220c244ab59800a class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div></div></div><div id=R-tab-id-976f34b3d4239e0f624049f2f523a081 data-tab-item=R-tab-397382ef4cd20471e3d9c9fecb6c01a7 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Image:         quay.io/phagen/spring-petclinic-api-gateway:0.0.2</span></span></code></pre></div></div></div></div></div><p>Next, enable the Java automatic discovery and configuration for all the services by adding the annotation to the deployments. The following command will patch the all deployments. This will trigger the OpenTelemetry Operator to inject the <code>splunk-otel-java</code> image into the Pods:</p><div class=tab-panel data-tab-group=R-tabs-b9a0dbc581e342faae2f804a57dd6cd7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f006d8832f455938469ff22182e16dcf aria-expanded=true data-tab-item=R-tab-095a030c413da2306699957e31df046b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b9a0dbc581e342faae2f804a57dd6cd7","R-tab-095a030c413da2306699957e31df046b")'>
<span class=tab-nav-text>Patch all PetClinic services</span>
</button>
<button aria-controls=R-tab-id-b71c1ace50ca76714e415d49be56ee49 aria-expanded=false data-tab-item=R-tab-c7f3c9adf1663130bcb611eae74c77dc class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b9a0dbc581e342faae2f804a57dd6cd7","R-tab-c7f3c9adf1663130bcb611eae74c77dc")'>
<span class=tab-nav-text>Patch Output</span></button></div><div class=tab-content-container><div id=R-tab-id-f006d8832f455938469ff22182e16dcf data-tab-item=R-tab-095a030c413da2306699957e31df046b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get deployments -l app.kubernetes.io/part-of<span class=o>=</span>spring-petclinic -o name <span class=p>|</span> xargs -I % kubectl patch % -p <span class=s2>&#34;{\&#34;spec\&#34;: {\&#34;template\&#34;:{\&#34;metadata\&#34;:{\&#34;annotations\&#34;:{\&#34;instrumentation.opentelemetry.io/inject-java\&#34;:\&#34;default/splunk-otel-collector\&#34;}}}}}&#34;</span></span></span></code></pre></div></div></div><div id=R-tab-id-b71c1ace50ca76714e415d49be56ee49 data-tab-item=R-tab-c7f3c9adf1663130bcb611eae74c77dc class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>deployment.apps/config-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/admin-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/customers-service patched
</span></span><span class=line><span class=cl>deployment.apps/visits-service patched
</span></span><span class=line><span class=cl>deployment.apps/discovery-server patched (no change)
</span></span><span class=line><span class=cl>deployment.apps/vets-service patched
</span></span><span class=line><span class=cl>deployment.apps/api-gateway patched</span></span></code></pre></div></div></div></div></div><p>There will be no change for the <strong>config-server</strong>, <strong>discovery-server</strong> and <strong>admin-server</strong> as these have already been patched.</p><p>To check the container image(s) of the <code>api-gateway</code> pod again, run the following command:</p><div class=tab-panel data-tab-group=R-tabs-b8b88f57ebd8580e9ecc063128a42b5b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-fd01602cc4f7223b6cce5c1ef3e5931a aria-expanded=true data-tab-item=R-tab-147de2e4d489d131e220c244ab59800a class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b8b88f57ebd8580e9ecc063128a42b5b","R-tab-147de2e4d489d131e220c244ab59800a")'>
<span class=tab-nav-text>Describe api-gateway</span>
</button>
<button aria-controls=R-tab-id-8a40e5fbf7563c52291eab758a5822f1 aria-expanded=false data-tab-item=R-tab-397382ef4cd20471e3d9c9fecb6c01a7 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b8b88f57ebd8580e9ecc063128a42b5b","R-tab-397382ef4cd20471e3d9c9fecb6c01a7")'>
<span class=tab-nav-text>Describe Output</span></button></div><div class=tab-content-container><div id=R-tab-id-fd01602cc4f7223b6cce5c1ef3e5931a data-tab-item=R-tab-147de2e4d489d131e220c244ab59800a class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe pods api-gateway <span class=p>|</span> grep Image:</span></span></code></pre></div></div></div><div id=R-tab-id-8a40e5fbf7563c52291eab758a5822f1 data-tab-item=R-tab-397382ef4cd20471e3d9c9fecb6c01a7 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Image:         ghcr.io/signalfx/splunk-otel-java/splunk-otel-java:v1.30.0
</span></span><span class=line><span class=cl>Image:         quay.io/phagen/spring-petclinic-api-gateway:0.0.2</span></span></code></pre></div></div></div></div></div><p>A new image has been added to the <code>api-gateway</code> which will pull <code>splunk-otel-java</code> from <code>ghcr.io</code> (Note: if you see two <code>api-gateway</code> containers, the original one is probably still terminating, so give it a few seconds).</p><p>Navigate back to the Kubernetes Navigator in <strong>Splunk Observability Cloud</strong>. After a couple of minutes, you will see that the Pods are being restarted by the operator and the automatic discovery and configuration container will be added. This will look similar to the screenshot below:</p><p><a href=#R-image-406c12c649cdfe502945aa64be36005b class=lightbox-link><img alt=restart class="lazy lightbox figure-image" loading=lazy src=../../images/k8s-navigator-restarted-pods.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-406c12c649cdfe502945aa64be36005b><img alt=restart class="lazy lightbox lightbox-image" loading=lazy src=../../images/k8s-navigator-restarted-pods.png></a></p><p>Wait for the Pods to turn green in the Kubernetes Navigator, then go tho the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=viewing-the-data-in-splunk-apm>Viewing the data in Splunk APM</h1><p>In the left-hand menu click on <strong>APM</strong> to see the data generated by the traces from the newly instrumented services.</p><p>Change the <strong>Environment</strong> filter <strong>(1)</strong> to the name of your workshop instance in the dropdown box.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>This will be <strong><code>&lt;INSTANCE>-workshop</code></strong> where <strong><code>INSTANCE</code></strong> is the value from the shell script you ran earlier. Ensure it is the only one selected.</p></div></details><p><a href=#R-image-2955d1084d911a3b19ad08d38050390c class=lightbox-link><img alt=apm class="lazy lightbox figure-image" loading=lazy src=../../images/zero-config-first-services-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2955d1084d911a3b19ad08d38050390c><img alt=apm class="lazy lightbox lightbox-image" loading=lazy src=../../images/zero-config-first-services-overview.png></a></p><p>Click on the <strong>Service Map</strong> <strong>(2)</strong> pane to get ready for the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 29, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=apm-features>APM Features</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>As we have seen in the previous section, once you enable <strong>automatic discovery and configuration</strong> on your services, traces are sent to <strong>Splunk Observability Cloud</strong>.</p><p>With these traces, Splunk will automatically generate <strong>Service Maps</strong> and <strong>RED Metrics</strong>. These are the first steps in understanding the behavior of your services and how they interact with each other.</p><p>In this next section, we are going to examine the traces themselves and the information they provide to help you understand the behavior of your services &ndash; all without touching your code!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. APM Features</h1><article class=default><header class=headline></header><h1 id=apm-service-map>APM Service Map</h1><p><a href=#R-image-f9124c6b4b0e7be1340cbbe8286739ab class=lightbox-link><img alt="apm map" class="lazy lightbox figure-image" loading=lazy src=../../images/zero-config-first-services-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9124c6b4b0e7be1340cbbe8286739ab><img alt="apm map" class="lazy lightbox lightbox-image" loading=lazy src=../../images/zero-config-first-services-map.png></a></p><p>The above map shows all the interactions between all the services. The map may still be in an interim state as it will take the PetClinic Microservice application a few minutes to start up and fully synchronize. Reducing the time filter to a custom time of <strong>2 minutes</strong> by entering <strong>-2m</strong> will help. You can click on the <strong>Refresh</strong> button <strong>(1)</strong> in the top right-hand corner of the screen. The initial startup-related errors indicated by red circles will eventually disappear.</p><p>Next, let&rsquo;s examine the metrics that are available for each service that is instrumented by visiting the request, error, and duration (RED) metrics Dashboard.</p><p>For this exercise, we are going to use a common scenario you would use if your service operation was showing high latency or errors.</p><p>Click on <strong>customers-service</strong> in the Dependency map, then make sure the <code>customers-service</code> is selected in the <strong>Services</strong> dropdown box <strong>(1)</strong>. Next, select <code>GET /owners</code> from the Operations dropdown <strong>(2)</strong> adjacent to the Service name.</p><p>This should give you the workflow with a filter on <code>GET /owners</code> as shown below:</p><p><a href=#R-image-221ba70ca59523cea38f23c8c265d1d0 class=lightbox-link><img alt="select a trace" class="lazy lightbox figure-image" loading=lazy src=../../images/select-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-221ba70ca59523cea38f23c8c265d1d0><img alt="select a trace" class="lazy lightbox lightbox-image" loading=lazy src=../../images/select-workflow.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=apm-trace>APM Trace</h1><p>To pick a trace, select a line in the <code>Service Requests & Errors</code> chart <strong>(1)</strong>. A selection of related traces will appear.</p><p>Once you have the list of related traces, click on the blue <strong>(2)</strong> Trace ID Link, making sure the trace you select has the same three services mentioned in the Services Column.</p><p><a href=#R-image-87030c066295930f92ec6762c9664fd1 class=lightbox-link><img alt=workflow-trace-pick class="lazy lightbox figure-image" loading=lazy src=../../images/selecting-a-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-87030c066295930f92ec6762c9664fd1><img alt=workflow-trace-pick class="lazy lightbox lightbox-image" loading=lazy src=../../images/selecting-a-trace.png></a></p><p>This brings us to the selected Trace in the Waterfall view:</p><p>Here we find several sections:</p><ul><li>The Waterfall Pane <strong>(1)</strong>, where you see the trace and all the instrumented functions visible as spans, with their duration representation and order/relationship showing.</li><li>The Trace Info Pane <strong>(2)</strong>, which shows the selected Span information (highlighted with a box around the Span in the Waterfall Pane).</li><li>The Span Pane <strong>(3)</strong> where you can find all the Tags that have been sent in the selected Span. You can scroll down to see all of them.</li><li>The process Pane, with tags related to the process that created the Span (scroll down to see as it is not in the screenshot).</li><li>The Trace Properties, located at the top right-hand side of the pane is collapsed by default.</li></ul><p><a href=#R-image-1b0056362d9cf7ba985150c82cd66715 class=lightbox-link><img alt=waterfall class="lazy lightbox figure-image" loading=lazy src=../../images/waterfall-view.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b0056362d9cf7ba985150c82cd66715><img alt=waterfall class="lazy lightbox lightbox-image" loading=lazy src=../../images/waterfall-view.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=apm-span>APM Span</h1><p>While we examine our spans, let&rsquo;s look at several out-of-the-box features that you get <strong>without code modifications</strong> when using <strong>automatic discovery and configuration</strong> on top of tracing:</p><p>First, in the Waterfall Pane, make sure the <code>customers-service:SELECT petclinic</code> or similar span is selected as shown in the screenshot below:</p><p><a href=#R-image-808bae38e1e6782018e4c88412928f0e class=lightbox-link><img alt=DB-query class="lazy lightbox figure-image" loading=lazy src=../../images/db-query.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-808bae38e1e6782018e4c88412928f0e><img alt=DB-query class="lazy lightbox lightbox-image" loading=lazy src=../../images/db-query.png></a></p><ul><li>The basic latency information is shown as a bar for the instrumented function or call. In our example above, it took 17.8 Milliseconds.</li><li>Several similar Spans <strong>(1)</strong> are only visible if the span is repeated multiple times. In this case, there are 10 repeats in our example. You can show/hide them all by clicking on the <code>10x</code> and all spans will show in order.</li><li><strong>Inferred Services</strong>: Calls made to external systems that are not instrumented show up as a grey &lsquo;inferred&rsquo; span. The Inferred Service or span in our example is a call to the Mysql Database <code>mysql:petclinic SELECT petclinic</code> <strong>(2)</strong> as shown above.</li><li><strong>Span Tags</strong>: In the Tag Pane, we see standard tags produced by the automatic discovery and configuration. In this case, the span is calling a Database, so it includes the <code>db.statement</code> tag <strong>(3)</strong>. This tag will hold the DB query statement and is used by the Database call performed during this span. This will be used by the DB-Query Performance feature. We look at DB-Query Performance in the next section.</li><li><strong>Always-on Profiling</strong>: <strong>IF</strong> the system is configured to capture Profiling data during a Span life cycle. It will show the number of Call Stacks captured in the Spans timeline. In our example above, we see 18 Call Stacks for the <code>customer-service:GET /owners</code> Span. <strong>(4)</strong></li></ul><p>We will look at Profiling in the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=service-centric-view>Service Centric View</h1><p>Splunk APM provide <strong>Service Centric Views</strong> that provide engineers a deep understanding of service performance in one centralized view. Now, across every service, engineers can quickly identify errors or bottlenecks from a serviceâ€™s underlying infrastructure, pinpoint performance degradation from new deployments, and visualize the health of every third party dependency.</p><p>To see this dashboard for the <code>api-gateway</code>, click on <strong>APM</strong> from the left-hand menu and then click on the <code>api-gateway</code> service in the list. This will bring you to the Service Centric View dashboard:</p><p><a href=#R-image-637a1598db4b7b397c175b691231c7e3 class=lightbox-link><img alt=service_maps class="lazy lightbox figure-image" loading=lazy src=../../images/service-view.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-637a1598db4b7b397c175b691231c7e3><img alt=service_maps class="lazy lightbox lightbox-image" loading=lazy src=../../images/service-view.png></a></p><p>This view, which is available for each of your instrumented services, offers an overview of <strong>Service metrics</strong>, <strong>Error breakdown</strong>, <strong>Runtime metrics (Java)</strong> and <strong>Infrastructure metrics</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 7, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=always-on-profiling--db-query-performance>Always-On Profiling & DB Query Performance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>As we have seen in the previous chapter, you can trace your interactions between the various services using APM without touching your code, allowing you to identify issues faster.</p><p>In addition to tracing, <strong>automatic discovery and configuration</strong> offers additional features out of the box that can help you find issues even faster! In this section we are going to look at two of them:</p><ul><li><strong>Always-on Profiling and Java Metrics</strong></li><li><strong>Database Query Performance</strong></li></ul><p>If you want to dive deeper into Always-on Profiling or DB-Query performance, we have a separate Ninja Workshop called <a href=/en/scenarios/debug_problems/><strong>Debug Problems in Microservices</strong></a> that you can follow.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Advanced Features</h1><article class=default><header class=headline></header><h1 id=always-on-profiling--metrics>Always-On Profiling & Metrics</h1><p>When we installed the Splunk Distribution of the OpenTelemetry Collector using the Helm chart earlier, we configured it to enable <strong>AlwaysOn Profiling</strong> and <strong>Metrics</strong>. This means that OpenTelemetry Java will automatically generate CPU and Memory profiling for the application, sending them to Splunk Observability Cloud.</p><p>When you deploy the PetClinic application and set the annotation, the collector automatically detects the application and instruments it for traces and profiling. We can verify this by examining the startup logs of one of the Java containers we are instrumenting by running the following script:</p><p>The logs will show the flags that were picked up by the Java automatic discovery and configuration:</p><p><div class=tab-panel data-tab-group=R-tabs-7dcc9eee0e8f437392818160a63b4c6e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-97c1617cb98471d5d347c57f046e2f46 aria-expanded=true data-tab-item=R-tab-c3d2921cc9f4b101462512ad1f1676da class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7dcc9eee0e8f437392818160a63b4c6e","R-tab-c3d2921cc9f4b101462512ad1f1676da")'>
<span class=tab-nav-text>Run the script</span>
</button>
<button aria-controls=R-tab-id-ed6e2f8852a2aa60e2ee6c6c793afb2f aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7dcc9eee0e8f437392818160a63b4c6e","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-97c1617cb98471d5d347c57f046e2f46 data-tab-item=R-tab-c3d2921cc9f4b101462512ad1f1676da class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0><code class=language-logs data-lang=logs>.  ~/workshop/petclinic/scripts/get_logs.sh</code></pre></div></div></div><div id=R-tab-id-ed6e2f8852a2aa60e2ee6c6c793afb2f data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class=highlight dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2024/02/15 09:42:00 Problem with dial: dial tcp 10.43.104.25:8761: connect: connection refused. Sleeping 1s
</span></span><span class=line><span class=cl>2024/02/15 09:42:01 Problem with dial: dial tcp 10.43.104.25:8761: connect: connection refused. Sleeping 1s
</span></span><span class=line><span class=cl>2024/02/15 09:42:02 Connected to tcp://discovery-server:8761
</span></span><span class=line><span class=cl>Picked up JAVA_TOOL_OPTIONS:  -javaagent:/otel-auto-instrumentation-java/javaagent.jar
</span></span><span class=line><span class=cl>Picked up _JAVA_OPTIONS: -Dspring.profiles.active=docker,mysql -Dsplunk.profiler.call.stack.interval=150
</span></span><span class=line><span class=cl>OpenJDK 64-Bit Server VM warning: Sharing is only supported for boot loader classes because bootstrap classpath has been appended
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:03:056 +0000] [main] INFO io.opentelemetry.javaagent.tooling.VersionLogger - opentelemetry-javaagent - version: splunk-1.30.1-otel-1.32.1
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:03:768 +0000] [main] INFO com.splunk.javaagent.shaded.io.micrometer.core.instrument.push.PushMeterRegistry - publishing metrics for SignalFxMeterRegistry every 30s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:478 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:478 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - Profiler configuration:
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:480 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                  splunk.profiler.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:505 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -                splunk.profiler.directory : /tmp
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:505 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -       splunk.profiler.recording.duration : 20s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:506 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -               splunk.profiler.keep-files : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:510 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -            splunk.profiler.logs-endpoint : http://10.13.2.38:4317
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:513 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -              otel.exporter.otlp.endpoint : http://10.13.2.38:4317
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:513 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -           splunk.profiler.memory.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:515 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -             splunk.profiler.tlab.enabled : true
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:516 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -        splunk.profiler.memory.event.rate : 150/s
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:516 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.call.stack.interval : PT0.15S
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -  splunk.profiler.include.internal.stacks : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger -      splunk.profiler.tracing.stacks.only : false
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:517 +0000] [main] INFO com.splunk.opentelemetry.profiler.ConfigurationLogger - -----------------------
</span></span><span class=line><span class=cl>[otel.javaagent 2024-02-15 09:42:07:518 +0000] [main] INFO com.splunk.opentelemetry.profiler.JfrActivator - Profiler is active.</span></span></code></pre></div></div></div></div></div>We are interested in the section written by the <code>com.splunk.opentelemetry.profiler.ConfigurationLogger</code> or the <strong>Profiling Configuration</strong>.</p><p>We can see the various settings you can control, such as the <code>splunk.profiler.directory</code>, which is the location where the agent writes the call stacks before sending them to Splunk. (This may be different depending on how you configure your containers.)</p><p>Another parameter you may want to change is <code>splunk.profiler.call.stack.interval</code>. This is how often the system captures a CPU Stack trace. You may want to reduce this interval setting if you have short spans like the ones we have in our Pet Clinic application. For the demo application, we did not change the default interval value, so Spans may not always have a CPU Call Stack related to them.</p><p>You can find how to set these parameters <a href=https://help.splunk.com/en/splunk-observability-cloud/manage-data/available-data-sources/supported-integrations-in-splunk-observability-cloud/apm-instrumentation/instrument-a-java-application/configure-the-java-agent#profiling-configuration-java rel=external>here</a>. In the example below, we see how to set a higher collection rate for call stacks in the <code>deployment.yaml</code>, by setting this value in the JAVA_OPTIONS config section.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>env</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>JAVA_OPTIONS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;-Xdebug -Dsplunk.profiler.call.stack.interval=150&#34;</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=always-on-profiling-in-the-trace-waterfall>Always-On Profiling in the Trace Waterfall</h1><p>Make sure you have your original (or similar) Trace & Span <strong>(1)</strong> selected in the APM Waterfall view and select <strong>Memory Stack Traces (2)</strong> from the right-hand pane:</p><p><a href=#R-image-97c271e239fa70298e4102f3edac50c6 class=lightbox-link><img alt="profiling from span" class="lazy lightbox figure-image" loading=lazy src=../../images/flamechart-in-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-97c271e239fa70298e4102f3edac50c6><img alt="profiling from span" class="lazy lightbox lightbox-image" loading=lazy src=../../images/flamechart-in-waterfall.png></a></p><p>The pane should show you the Memory Stack Trace Flame Graph <strong>(3)</strong>. You can scroll down and/or expand by dragging the right side of the pane.</p><p>AlwaysOn Profiling is constantly taking snapshots, or stack traces, of your applicationâ€™s code. Imagine having to read through thousands of stack traces! It is simply not practical. To assist with this, AlwaysOn Profiling aggregates and summarizes profiling data, providing a convenient way to explore Call Stacks in a view called the <strong>Flame Graph</strong>. It represents a summary of all stack traces captured from your application. You can use the Flame Graph to discover which lines of code might be causing performance issues and to confirm whether changes you make to the code have the intended effect.</p><p>To dive deeper into Always-on Profiling, select Span <strong>(3)</strong> (as referenced in the above image) in the Profiling Pane under <strong>Memory Stack Traces</strong>. This will open the Always-on Profiling main screen, with the Memory view pre-selected:</p><p><a href=#R-image-37408943d0d8f14a2d9d781698136627 class=lightbox-link><img alt="Profiling main" class="lazy lightbox figure-image" loading=lazy src=../../images/profiling-memory.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37408943d0d8f14a2d9d781698136627><img alt="Profiling main" class="lazy lightbox lightbox-image" loading=lazy src=../../images/profiling-memory.png></a></p><ul><li>The Time filter will be set to the time frame of the span we selected <strong>(1)</strong></li><li>Java Memory Metric Charts <strong>(2)</strong> allow you to <code>Monitor Heap Memory, Application Activity</code> like <code>Memory Allocation Rate</code> and <code>Garbage Collecting</code> Metrics.</li><li>Ability to focus/see metrics and Stack Traces only related to the Span <strong>(3)</strong>, This will filter out background activities running in the Java application if required.</li><li>Java Function calls identified <strong>(4)</strong>, allowing you to drill down into the Methods called from that function.</li><li>The Flame Graph <strong>(5)</strong>, with the visualization of hierarchy based on the stack traces of the profiled service.</li><li>Ability to select the Service instance <strong>(6)</strong> in case the service spins up multiple version of itself.</li></ul><p>For further investigation, the UI allows you to click a stack trace so that you can see the called function and the relevant line from the flame chart that you can then use in your coding platform to view the actual lines of code (depending of course on your preferred Coding platform).</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=database-query-performance>Database Query Performance</h1><p>With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.</p><p>To look at the performance of your database queries, make sure you are on the APM <strong>Service Map</strong> page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the <strong>Service Map</strong> tile.</p><p>Select the inferred database service <code>mysql:petclinic</code> Inferred Database server in the Dependency map <strong>(1)</strong>, then scroll the right-hand pane to find the <strong>Database Query Performance</strong> Pane <strong>(2)</strong>.</p><p><a href=#R-image-c4b1f49f110b3605289ffdb97f5480e8 class=lightbox-link><img alt="DB-query from map" class="lazy lightbox figure-image" loading=lazy src=../../images/db-query-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c4b1f49f110b3605289ffdb97f5480e8><img alt="DB-query from map" class="lazy lightbox lightbox-image" loading=lazy src=../../images/db-query-map.png></a></p><p>If the service you have selected in the map is indeed an (inferred) database server, this pane will populate with the top 90% (P90) database calls based on duration. To dive deeper into the db-query performance function, click somewhere on the word <strong>Database Query Performance</strong> at the top of the pane.</p><p>This will bring us to the DB-query Performance overview screen:</p><p><a href=#R-image-59767e68d67f89bdaf6a8c13a6ec84c1 class=lightbox-link><img alt="DB-query full" class="lazy lightbox figure-image" loading=lazy src=../../images/db-query-full.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-59767e68d67f89bdaf6a8c13a6ec84c1><img alt="DB-query full" class="lazy lightbox lightbox-image" loading=lazy src=../../images/db-query-full.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Database Query Normalization</summary><div class=box-content><p>By default, Splunk APM instrumentation sanitizes database queries to remove or mask sensible data, such as secrets or personally identifiable information (PII) from the <code>db.statements</code>. You can find how to turn off database query normalization <a href=https://help.splunk.com/en/splunk-observability-cloud/monitor-application-performance/monitor-database-query-performance/troubleshoot-database-query-performance#turn-off-database-query-normalization rel=external>here</a>.</p></div></details><p>This screen will show us all the Database queries <strong>(1)</strong> done to our database from your application, based on the Traces & Spans sent to the Splunk Observability Cloud. Note that you can compare them across a time block or sort them on Total Time, P90 Latency & Requests <strong>(2)</strong>.</p><p>For each Database query in the list, we see the highest latency, the total number of calls during the time window and the number of requests per second <strong>(3)</strong>. This allows you to identify places where you might optimize your queries.</p><p>You can select traces containing Database Calls via the two charts in the right-hand pane <strong>(5)</strong>. Use the Tag Spotlight pane <strong>(6)</strong> to drill down to see which tags are related to the database calls, based on endpoints or tags.</p><p>If you need to see a detailed view of a query:</p><p><a href=#R-image-92165615376b4f69bc793322aed76203 class=lightbox-link><img alt=details class="lazy lightbox figure-image" loading=lazy src=../../images/query-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-92165615376b4f69bc793322aed76203><img alt=details class="lazy lightbox lightbox-image" loading=lazy src=../../images/query-details.png></a></p><p>Click on the specific Query <strong>(1)</strong>. This will open the Query Details pane <strong>(2)</strong>, which you can use for more detailed investigations.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=log-observer>Log Observer</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Up until this point, there have been <strong>no code changes</strong>, yet tracing, profiling and Database Query Performance data is being sent to Splunk Observability Cloud.</p><p>Next, we will work with <strong>Splunk Log Observer</strong> to obtain log data from the Spring PetClinic application.</p><p>The <strong>Splunk OpenTelemetry Collector</strong> automatically collects logs from the Spring PetClinic application and sends them to Splunk Observability Cloud using the OTLP exporter, annotating the log events with <code>trace_id</code>, <code>span_id</code> and trace flags.</p><p><strong>Splunk Log Observer</strong> is then used to view the logs, automatically correlating log information with services and traces.</p><p>This feature is called <a href=https://help.splunk.com/en/splunk-observability-cloud/data-tools/related-content rel=external><strong>Related Content</strong></a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 7. Log Observer</h1><article class=default><header class=headline></header><h1 id=viewing-the-logs>Viewing the Logs</h1><p>In order to see logs click on the <a href=#R-image-8cd48fb33a46b93aeeb641dd441fdec0 class=lightbox-link><img alt=Logo class="inline lazy lightbox figure-image" loading=lazy src="../images/logo-icon.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8cd48fb33a46b93aeeb641dd441fdec0><img alt=Logo class="inline lazy lightbox lightbox-image" loading=lazy src="../images/logo-icon.png?classes=inline&height=25px"></a> <strong>Log Observer</strong> in the left-hand menu. Once in Log Observer please ensure <strong>Index</strong> on the filter bar is set to <strong>splunk4rookies-workshop</strong>. <strong>(1)</strong></p><p>Next, click <strong>Add Filter</strong> and search, using the <em>Fields</em> <strong>(2)</strong> option for the field <code>deployment.environment</code> <strong>(3)</strong>. Then from the dropdown list, select your workshop instance, <strong>(4)</strong> and click <code>=</code> (to include). You will now see only the log messages from your PetClinic application.</p><p><a href=#R-image-b89ff38059db51905d07717e00726e4e class=lightbox-link><img alt="Log Observer sort" class="lazy lightbox figure-image" loading=lazy src=../../images/log-observer-sort.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b89ff38059db51905d07717e00726e4e><img alt="Log Observer sort" class="lazy lightbox lightbox-image" loading=lazy src=../../images/log-observer-sort.png></a></p><p>Next, search for the field <code>service.name</code>, selecting the value <code>customers-service</code> and click <code>=</code> (to include). This should now appear in the filter bar <strong>(1)</strong>. Next click on the Button <strong>Run Search</strong> <strong>(2)</strong>.</p><p><a href=#R-image-eb9a28ea4d34751f08b4ff8c2bd9d84d class=lightbox-link><img alt="Log Observer run" class="lazy lightbox figure-image" loading=lazy src=../../images/log-observer-run.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eb9a28ea4d34751f08b4ff8c2bd9d84d><img alt="Log Observer run" class="lazy lightbox lightbox-image" loading=lazy src=../../images/log-observer-run.png></a></p><p>This wil refresh the log entries and they will now be reduced to show the entries from your <code>customers-service</code> only.</p><p><a href=#R-image-3f594ad71e056163ac7e025b33fa2aa8 class=lightbox-link><img alt="Log Observer" class="lazy lightbox figure-image" loading=lazy src=../../images/log-observer-trace-info.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f594ad71e056163ac7e025b33fa2aa8><img alt="Log Observer" class="lazy lightbox lightbox-image" loading=lazy src=../../images/log-observer-trace-info.png></a></p><p>Click on an entry that starts with <em>&ldquo;Saving pet&rdquo;</em> <strong>(1)</strong>. A side pane will open where you can see the detailed information, including the relevant trace and span IDs <strong>(2)</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=related-content>Related Content</h1><p>The bottom pane is where any related content will be reported. In the screenshot below you can see that APM has found a trace that is related to this log line <strong>(1)</strong>:</p><p><a href=#R-image-d1af14c96d073e61df71d7412cacd15d class=lightbox-link><img alt=RC class="lazy lightbox figure-image" loading=lazy src=../../images/log-apm-rc.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d1af14c96d073e61df71d7412cacd15d><img alt=RC class="lazy lightbox lightbox-image" loading=lazy src=../../images/log-apm-rc.png></a></p><p>By clicking <strong>(2)</strong> on <strong>Trace for 960432ac9f16b98be84618778905af50</strong> we will be taken to the waterfall in APM for this specific trace, where this log line was generated:</p><p><a href=#R-image-c8ca54e8df3728c0ba8bd1c5ec93b3f3 class=lightbox-link><img alt="waterfall logs" class="lazy lightbox figure-image" loading=lazy src=../../images/waterfall-with-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c8ca54e8df3728c0ba8bd1c5ec93b3f3><img alt="waterfall logs" class="lazy lightbox lightbox-image" loading=lazy src=../../images/waterfall-with-logs.png></a></p><p>Note that you now have a <strong>Related Content</strong> pane for Logs appearing <strong>(1)</strong>. Clicking on this will take you back to Log Observer and will display all the log lines that are part of this trace.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=real-user-monitoring>Real User Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>To enable Real User Monitoring (RUM) instrumentation for an application, you need to add the Open Telemetry Javascript <a href=https://github.com/signalfx/splunk-otel-js-web rel=external><strong>https://github.com/signalfx/splunk-otel-js-web</strong></a> snippet to the code base.</p><p>The Spring PetClinic application uses a single <a href=https://github.com/spring-petclinic/spring-petclinic-microservices/blob/main/spring-petclinic-api-gateway/src/main/resources/static/index.html rel=external><strong>index</strong></a> HTML page, that is reused across all views of the application. This is the perfect location to insert the Splunk RUM instrumentation library as it will be loaded for all pages automatically.</p><p>The <code>api-gateway</code> service is already running the instrumentation and sending RUM traces to Splunk Observability Cloud and we will review the data in the next section.</p><p>If you&rsquo;d like to verify the snippet, you can view the page source in your browser by right-clicking on the page and selecting <strong>View Page Source</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;/env.js&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>  
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js&#34;</span> <span class=na>crossorigin</span><span class=o>=</span><span class=s>&#34;anonymous&#34;</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>realm</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_REALM</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s1>&#39;Realm:&#39;</span><span class=p>,</span> <span class=nx>realm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>auth</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_AUTH</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>appName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_APP_NAME</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=nx>environmentName</span> <span class=o>=</span> <span class=nx>env</span><span class=p>.</span><span class=nx>RUM_ENVIRONMENT</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nx>realm</span> <span class=o>&amp;&amp;</span> <span class=nx>auth</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>applicationName</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>deploymentEnvironment</span><span class=o>:</span> <span class=nx>environmentName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>version</span><span class=o>:</span> <span class=s1>&#39;1.0.0&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>            <span class=nx>SplunkSessionRecorder</span><span class=p>.</span><span class=nx>init</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nx>applicationName</span><span class=o>:</span> <span class=nx>appName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>realm</span><span class=o>:</span> <span class=nx>realm</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=nx>rumAccessToken</span><span class=o>:</span> <span class=nx>auth</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>recorder</span><span class=o>:</span> <span class=s2>&#34;splunk&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=nx>features</span><span class=o>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nx>video</span><span class=o>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>});</span>
</span></span><span class=line><span class=cl>            <span class=kr>const</span> <span class=nx>Provider</span> <span class=o>=</span> <span class=nx>SplunkRum</span><span class=p>.</span><span class=nx>provider</span><span class=p>;</span> 
</span></span><span class=line><span class=cl>            <span class=kd>var</span> <span class=nx>tracer</span><span class=o>=</span><span class=nx>Provider</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;appModuleLoader&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Realm or auth is empty, provide default values or skip initialization
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=s2>&#34;Realm or auth is empty. Skipping Splunk Rum initialization.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>     <span class=c>&lt;!-- Section added for  RUM --&gt;</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 1, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 8. Real User Monitoring</h1><article class=default><header class=headline></header><h1 id=select-the-rum-view-for-the-petclinic-app>Select the RUM view for the Petclinic App</h1><p>Lets start with a quick, high level tour of RUM by clicking <strong>RUM</strong> in the left-hand menu. Then change the <strong>Environment</strong> filter <strong>(1)</strong> to the name of your workshop instance from the dropdown box, selecting <strong><code>&lt;INSTANCE>-workshop</code></strong> <strong>(1)</strong> (where <strong><code>INSTANCE</code></strong> is the value from the shell script you ran earlier). Make sure it is the only one selected.</p><p>Then change the <strong>App</strong> <strong>(2)</strong> dropdown box to the name of your app, it will be <strong><code>&lt;INSTANCE>-store</code></strong></p><p><a href=#R-image-628ee06b18d721e68d869463fdd18be4 class=lightbox-link><img alt="rum select" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-env-select.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-628ee06b18d721e68d869463fdd18be4><img alt="rum select" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-env-select.png></a></p><p>Once you have selected your <strong>Environment</strong> and <strong>App</strong>, you will see an overview page showing the RUM status of your Application. (If your Summary Dashboard is just a single row of numbers, you are looking at the condensed view. You can expand it by clicking on the <strong>> (1)</strong> in front of the Application name). If any JavaScript errors occurred, they will show up as shown below:</p><p><a href=#R-image-f5cdc770a4b11e146abcf089d2382738 class=lightbox-link><img alt="rum overview" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5cdc770a4b11e146abcf089d2382738><img alt="rum overview" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-overview.png></a></p><p>To continue, click on the blue link (with your workshop name) to get to the details page. This will bring up a new dashboard view breaking down the interactions by UX Metrics, Front-end Health, Back-end Health and Custom Events and comparing them to historic metrics (1 hour by default).</p><p><a href=#R-image-eed20eab56bf9f91448e08d0b48deabe class=lightbox-link><img alt="rum  main" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-main.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eed20eab56bf9f91448e08d0b48deabe><img alt="rum  main" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-main.png></a>
Normally, you have only one line inside the first chart. Click on the link that relates to your Petclinic shop,
http://198.19.249.202:81 in our example:</p><p>This will bring us to the Tag Spotlight page.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>In the TAG Spotlight view, you are presented with all the tags associated with the RUM data. Tags are key-value pairs that are used to identify the data. In this case, the tags are automatically generated by the OpenTelemetry instrumentation. The tags are used to filter the data and to create the charts and tables. The Tag Spotlight view allows you detect trends in behavior and to drill down into a user session.</p><p><a href=#R-image-d741cbecb7168b10c98e5fcb4ff66d5a class=lightbox-link><img alt="RUM TAG" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d741cbecb7168b10c98e5fcb4ff66d5a><img alt="RUM TAG" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-tag-spotlight.png></a></p><p>Click on User Sessions <strong>(1)</strong>, this will show you the list of user session that occurred during the time window.</p><p>We want to look at one of the session, so click on <em>Duration</em> <strong>(2)</strong> to sort on duration, and make sure you click on the link of one of the longer ones <strong>(3)</strong>:</p><p><a href=#R-image-a8ebaaf9404899c871c8a2a1becb9c42 class=lightbox-link><img alt="User sessions" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-user-sessions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a8ebaaf9404899c871c8a2a1becb9c42><img alt="User sessions" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-user-sessions.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=rum-trace-waterfall-view--linking-to-apm>RUM trace Waterfall view & linking to APM</h1><p>We are now looking at the RUM Trace waterfall, this will tell you what happened during the session on the user device as they visited the page of our petclinic application.</p><p>If you scroll down the waterfall find click on the <strong>#!/owners/details</strong> segment on the right <strong>(1)</strong>, you see a list of actions that occurred during the handling of the Vets request. Note, that the HTTP request have a blue <strong>APM</strong> link before the return code. Pick one, and click on the APM link. This will show you the APM info for this backend service call hosted in Kubernetes.</p><p><a href=#R-image-d4c4b3d3693515d926234ef29852ff3c class=lightbox-link><img alt="rum apm link" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4c4b3d3693515d926234ef29852ff3c><img alt="rum apm link" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-trace.png></a></p><p>Note, if you want to drill down to verify what happened with the request, click on the Trace ID url.</p><p>This will show you the trace related to your request from RUM:</p><p><a href=#R-image-90a06b93d407c68b39dc4d5cd1949ac4 class=lightbox-link><img alt="RUm-apm linked" class="lazy lightbox figure-image" loading=lazy src=../../images/rum-apm-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90a06b93d407c68b39dc4d5cd1949ac4><img alt="RUm-apm linked" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rum-apm-waterfall.png></a></p><p>You can see that the entry point into your service now has a <strong>RUM (1)</strong> related content link added, allowing you to return back to your RUM session after you validated what happened in your backend service.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=workshop-wrap-up->Workshop Wrap-up ðŸŽ</h1><p>Congratulations, you have completed the <strong>Get the Most Out of Your Existing Kubernetes Java Applications Using Automatic Discovery and Configuration With OpenTelemetry</strong> workshop.</p><p>Today, you have learned how easy it is to add Tracing, Code Profiling and Database Query Performance to your existing Java application in Kubernetes.</p><p>You immediately improved the observability of the application and infrastructure without touching a line of code or configuration using <strong>Automatic Discovery and Configuration</strong>.</p><p>You also learned that with simple configuration changes, you can add even more observability (<strong>logging</strong> and <strong>RUM</strong>) to the application in order to provide end-to-end observability.</p><p><a href=#R-image-3f512e9a781cc3630fe007f26613d5f2 class=lightbox-link><img alt=Champagne class="lazy lightbox figure-image" loading=lazy src="/observability-workshop/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/9-wrap-up/images/champagne.png?width=45vw" style=height:auto;width:45vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f512e9a781cc3630fe007f26613d5f2><img alt=Champagne class="lazy lightbox lightbox-image" loading=lazy src="/observability-workshop/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/9-wrap-up/images/champagne.png?width=45vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 21, 2025</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=monitoring-horizontal-pod-autoscaling-in-kubernetes>Monitoring Horizontal Pod Autoscaling in Kubernetes</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>This hands-on workshop teaches you how to monitor Kubernetes Horizontal Pod Autoscaling (HPA) using the Splunk OpenTelemetry Collector. You&rsquo;ll deploy a PHP/Apache application with a load generator to trigger auto-scaling events and observe the complete scaling lifecycle.</p><p>Through practical exercises, you&rsquo;ll explore OpenTelemetry Receivers, Kubernetes Namespaces, ReplicaSets, and HPA mechanics while monitoring everything in Splunk Observability Cloud. You&rsquo;ll master the Kubernetes Navigator, build custom dashboards, analyze metrics and events, and configure detectors to alert on scaling activities.</p><p>For this workshop, Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you.</p><p>To get access to the instance that you will be using in the workshop, please visit the URL provided by the workshop leader.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Horizontal Pod Autoscaling</h1><article class=default><header class=headline></header><h1 id=deploying-the-opentelemetry-collector-in-kubernetes>Deploying the OpenTelemetry Collector in Kubernetes</h1><h2 id=1-connect-to-ec2-instance>1. Connect to EC2 instance</h2><p>You will be able to connect to the workshop instance by using SSH from your Mac, Linux or Windows device. Open the link to the sheet provided by your instructor. This sheet contains the IP addresses and the password for the workshop instances.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>Your workshop instance has been pre-configured with the correct <strong>Access Token</strong> and <strong>Realm</strong> for this workshop. There is no need for you to configure these.</p></div></details><h2 id=2-install-splunk-otel-using-helm>2. Install Splunk OTel using Helm</h2><p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository and update:</p><div class=tab-panel data-tab-group=R-tabs-1721b2a73fbdc4d3c62c0d6a7107ba7d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-126547f6b9e7efdb393ffbff522ac7a7 aria-expanded=true data-tab-item=R-tab-ffba54ebcbad31e9c6e41e5577fdfb33 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-1721b2a73fbdc4d3c62c0d6a7107ba7d","R-tab-ffba54ebcbad31e9c6e41e5577fdfb33")'>
<span class=tab-nav-text>helm repo add</span>
</button>
<button aria-controls=R-tab-id-0468bbbe3849e1627ea15cce4fd555a6 aria-expanded=false data-tab-item=R-tab-e905647b6f1267ab0ddf5da6628dd333 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-1721b2a73fbdc4d3c62c0d6a7107ba7d","R-tab-e905647b6f1267ab0ddf5da6628dd333")'>
<span class=tab-nav-text>helm repo add output</span></button></div><div class=tab-content-container><div id=R-tab-id-126547f6b9e7efdb393ffbff522ac7a7 data-tab-item=R-tab-ffba54ebcbad31e9c6e41e5577fdfb33 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span class=o>&amp;&amp;</span> helm repo update</span></span></code></pre></div></div></div><div id=R-tab-id-0468bbbe3849e1627ea15cce4fd555a6 data-tab-item=R-tab-e905647b6f1267ab0ddf5da6628dd333 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Using ACCESS_TOKEN=&lt;REDACTED&gt;
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>&#34;splunk-otel-collector-chart&#34; has been added to your repositories
</span></span><span class=line><span class=cl>Using ACCESS_TOKEN=&lt;REDACTED&gt;
</span></span><span class=line><span class=cl>Using REALM=eu0
</span></span><span class=line><span class=cl>Hang tight while we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
</span></span><span class=line><span class=cl>Update Complete. âŽˆHappy Helming!âŽˆ</span></span></code></pre></div></div></div></div></div><p>Install the OpenTelemetry Collector Helm with the following commands, do <strong>NOT</strong> edit this:</p><div class=tab-panel data-tab-group=R-tabs-25458b7372d3a363493e135912100689><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ad4189686f9aa5cccb2b7113a50e61a7 aria-expanded=true data-tab-item=R-tab-0562418e6d9a76d0dd22b2f186a2203d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-25458b7372d3a363493e135912100689","R-tab-0562418e6d9a76d0dd22b2f186a2203d")'>
<span class=tab-nav-text>helm install</span></button></div><div class=tab-content-container><div id=R-tab-id-ad4189686f9aa5cccb2b7113a50e61a7 data-tab-item=R-tab-0562418e6d9a76d0dd22b2f186a2203d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector --version 0.136.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml</span></span></code></pre></div></div></div></div></div><h2 id=3-verify-deployment>3. Verify Deployment</h2><p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report that the new pods are up and running after about 30 seconds.</p><p>Ensure the status is reported as <strong>Running</strong> before continuing.</p><div class=tab-panel data-tab-group=R-tabs-744a98418a0831f599d0596ade923096><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1a3aad03bdc3bd9131ad6861d319850a aria-expanded=true data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-744a98418a0831f599d0596ade923096","R-tab-380f56daf2c41382fed5e183e4f1fbe1")'>
<span class=tab-nav-text>kubectl get pods</span>
</button>
<button aria-controls=R-tab-id-e5aea7b01c979e6021687b7bf45fea6f aria-expanded=false data-tab-item=R-tab-01f08a36636a863c4f9cc981367f9ca4 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-744a98418a0831f599d0596ade923096","R-tab-01f08a36636a863c4f9cc981367f9ca4")'>
<span class=tab-nav-text>kubectl get pods Output</span></button></div><div class=tab-content-container><div id=R-tab-id-1a3aad03bdc3bd9131ad6861d319850a data-tab-item=R-tab-380f56daf2c41382fed5e183e4f1fbe1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div id=R-tab-id-e5aea7b01c979e6021687b7bf45fea6f data-tab-item=R-tab-01f08a36636a863c4f9cc981367f9ca4 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>NAME                                                         READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-ks9jn                            1/1     Running   0          27s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-lqs4j                            0/1     Running   0          27s
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-zsqbt                            1/1     Running   0          27s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-76bb6b555-7fhzj   0/1     Running   0          27s</span></span></code></pre></div></div></div></div></div><p>Use the label set by the <code>helm</code> install to tail logs (You will need to press <code>ctrl + c</code> to exit).</p><div class=tab-panel data-tab-group=R-tabs-79b18cd2f29dc8c18affe2d2c7721929><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-7d08f797936f62bcd259b53a4930ee53 aria-expanded=true data-tab-item=R-tab-66b92e950fb2f856e1fdec23c736e201 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-79b18cd2f29dc8c18affe2d2c7721929","R-tab-66b92e950fb2f856e1fdec23c736e201")'>
<span class=tab-nav-text>kubectl logs</span></button></div><div class=tab-content-container><div id=R-tab-id-7d08f797936f62bcd259b53a4930ee53 data-tab-item=R-tab-66b92e950fb2f856e1fdec23c736e201 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector -f --container otel-collector</span></span></code></pre></div></div></div></div></div><p>Or use the installed <code>k9s</code> terminal UI.</p><p><a href=#R-image-8eb6f20fd550b81a50373d5af04d3872 class=lightbox-link><img alt=k9s class="lazy lightbox figure-image" loading=lazy src=../images/k9s.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8eb6f20fd550b81a50373d5af04d3872><img alt=k9s class="lazy lightbox lightbox-image" loading=lazy src=../images/k9s.png></a></p><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Deleting a failed installation</summary><div class=box-content><p>If you make an error installing the Splunk OpenTelemetry Collector you can start over by deleting the installation using:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=k8s-namespaces-and-dns>K8s Namespaces and DNS</h1><h2 id=1-namespaces-in-kubernetes>1. Namespaces in Kubernetes</h2><p>Most of our customers will make use of some kind of private or public cloud service to run Kubernetes. They often choose to have only a few large Kubernetes clusters as it is easier to manage centrally.</p><p>Namespaces are a way to organize these large Kubernetes clusters into virtual sub-clusters. This can be helpful when different teams or projects share a Kubernetes cluster as this will give them the easy ability to just see and work with their resources.</p><p>Any number of namespaces are supported within a cluster, each logically separated from others but with the ability to communicate with each other. Components are only <strong>visible</strong> when selecting a namespace or when adding the <code>--all-namespaces</code> flag to <code>kubectl</code> instead of allowing you to view just the components relevant to your project by selecting your namespace.</p><p>Most customers will want to install the applications into a separate namespace. This workshop will follow that best practice.</p><h2 id=2--dns-and-services-in-kubernetes>2. DNS and Services in Kubernetes</h2><p>The Domain Name System (DNS) is a mechanism for linking various sorts of information with easy-to-remember names, such as IP addresses. Using a DNS system to translate request names into IP addresses makes it easy for end-users to reach their target domain name effortlessly.</p><p>Most Kubernetes clusters include an internal DNS service configured by default to offer a lightweight approach for service discovery. Even when Pods and Services are created, deleted, or shifted between nodes, built-in service discovery simplifies applications to identify and communicate with services on the Kubernetes clusters.</p><p>In short, the DNS system for Kubernetes will create a DNS entry for each Pod and Service. In general, a Pod has the following DNS resolution:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>pod-name.my-namespace.pod.cluster-domain.example</span></span></code></pre></div><p>For example, if a Pod in the <code>default</code> namespace has the Pod name <code>my_pod</code>, and the domain name for your cluster is <code>cluster.local</code>, then the Pod has a DNS name:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.default.pod.cluster.local</span></span></code></pre></div><p>Any Pods exposed by a Service have the following DNS resolution available:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>my_pod.service-name.my-namespace.svc.cluster-domain.example</span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/ rel=external><strong>DNS for Service and Pods</strong></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=apache-otel-receiver>Apache OTel Receiver</h1><h2 id=1-review-otel-receiver-for-phpapache>1. Review OTel receiver for PHP/Apache</h2><p>Inspect the YAML file <code>~/workshop/k3s/otel-apache.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the OpenTelemetry agent to monitor the PHP/Apache deployment.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>apache</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; pod.name matches &#34;apache&#34; &amp;&amp; port == 80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>http://php-apache-svc.apache.svc.cluster.local/server-status?auto</span></span></span></code></pre></div><h2 id=2--observation-rules-in-the-opentelemetry-config>2. Observation Rules in the OpenTelemetry config</h2><p>The above file contains an observation rule for Apache using the OTel <code>receiver_creator</code>. This receiver can instantiate other receivers at runtime based on whether observed endpoints match a configured rule.</p><p>The configured rules will be evaluated for each endpoint discovered. If the rule evaluates to true, then the receiver for that rule will be started as configured against the matched endpoint.</p><p>In the file above we tell the OpenTelemetry agent to look for Pods that match the name <code>apache</code> and have port <code>80</code> open. Once found, the agent will configure an Apache receiver to read Apache metrics from the configured URL. Note, the K8s DNS-based URL in the above YAML for the service.</p><p>To use the Apache configuration, you can upgrade the existing Splunk OpenTelemetry Collector Helm chart to use the <code>otel-apache.yaml</code> file with the following command:</p><div class=tab-panel data-tab-group=R-tabs-b978c598eea3d46083c58c76ff05f7b0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-52ee7ceb47e92fd48d6bcdd935f50259 aria-expanded=true data-tab-item=R-tab-db6a91a88fdf95e61921bfba57b611b2 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b978c598eea3d46083c58c76ff05f7b0","R-tab-db6a91a88fdf95e61921bfba57b611b2")'>
<span class=tab-nav-text>Helm Upgrade</span></button></div><div class=tab-content-container><div id=R-tab-id-52ee7ceb47e92fd48d6bcdd935f50259 data-tab-item=R-tab-db6a91a88fdf95e61921bfba57b611b2 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-collector.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f ~/workshop/k3s/otel-apache.yaml</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
NOTE</summary><div class=box-content><p>The <strong>REVISION</strong> number of the deployment has changed, which is a helpful way to keep track of your changes.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Release &#34;splunk-otel-collector&#34; has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Mon Nov  4 14:56:25 2024
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: 2
</span></span><span class=line><span class=cl>TEST SUITE: None
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Platform endpoint &#34;https://http-inputs-workshop.splunkcloud.com:443/services/collector/event&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm eu0.</span></span></code></pre></div></div></details><h2 id=3-kubernetes-configmaps>3. Kubernetes ConfigMaps</h2><p>A ConfigMap is an object in Kubernetes consisting of key-value pairs that can be injected into your application. With a ConfigMap, you can separate configuration from your Pods.</p><p>Using ConfigMap, you can prevent hardcoding configuration data. ConfigMaps are useful for storing and sharing non-sensitive, unencrypted configuration information.</p><p>The OpenTelemetry collector/agent uses ConfigMaps to store the configuration of the agent and the K8s Cluster receiver. You can/will always verify the current configuration of an agent after a change by running the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm</span></span></code></pre></div><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>How many ConfigMaps are used by the collector?</p></div></details><p>When you have a list of ConfigMaps from the namespace, select the one for the <code>otel-agent</code> and view it with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm splunk-otel-collector-otel-agent -o yaml</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
NOTE</summary><div class=box-content><p>The option <code>-o yaml</code> will output the content of the ConfigMap in a readable YAML format.</p></div></details><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Is the configuration from <code>otel-apache.yaml</code> visible in the ConfigMap for the collector agent?</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-apache>Deploy Apache</h1><h2 id=1-review-phpapache-deployment-yaml>1. Review PHP/Apache deployment YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/php-apache.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>This file contains the configuration for the PHP/Apache deployment and will create a new StatefulSet with a single replica of the PHP/Apache image.</p><p>A stateless application does not care which network it is using, and it does not need permanent storage. Examples of stateless apps may include web servers such as Apache, Nginx, or Tomcat.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>updateStrategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>RollingUpdate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>serviceName</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;php-apache-svc&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/splunk/php-apache:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache-svc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><h2 id=2-deploy-phpapache>2. Deploy PHP/Apache</h2><p>Create an <code>apache</code> namespace then deploy the PHP/Apache application to the cluster.</p><p>Create the <code>apache</code> namespace:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create namespace apache</span></span></code></pre></div><p>Deploy the PHP/Apache application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><p>Ensure the deployment has been created:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get statefulset -n apache</span></span></code></pre></div><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What metrics for your Apache instance are being reported in the <strong>Apache web servers (OTel) Navigator</strong>?</p></div></details><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Using Log Observer what is the issue with the PHP/Apache deployment?</p><p><strong>Tip:</strong> Adjust your filters to use: <code>k8s.namespace.name = apache</code> and <code>k8s.cluster.name = &lt;your_cluster></code>.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=fix-phpapache-issue>Fix PHP/Apache Issue</h1><h2 id=1-kubernetes-resources>1. Kubernetes Resources</h2><p>Especially in Production Kubernetes Clusters, CPU and Memory are considered precious resources. Cluster Operators will normally require you to specify the amount of CPU and Memory your Pod or Service will require in the deployment, so they can have the Cluster automatically manage on which Node(s) your solution will be placed.</p><p>You do this by placing a Resource section in the deployment of your application/Pod</p><p><strong>Example:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>         </span><span class=c># Maximum amount of CPU &amp; memory for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8&#34;</span><span class=w>      </span><span class=c># Maximum of 8 cores of CPU allowed at for peek use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w> </span><span class=c># Maximum allowed 8Mb of memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>       </span><span class=c># Request are the expected amount of CPU &amp; memory for normal use</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;6&#34;</span><span class=w>      </span><span class=c># Requesting 4 cores of a CPU</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span><span class=w> </span><span class=c># Requesting 4Mb of memory</span></span></span></code></pre></div><p>More information can be found here: <a href=https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/ rel=external><strong>Resource Management for Pods and Containers</strong></a></p><p>If your application or Pod will go over the limits set in your deployment, Kubernetes will kill and restart your Pod to protect the other applications on the Cluster.</p><p>Another scenario that you will run into is when there is not enough Memory or CPU on a Node. In that case, the Cluster will try to reschedule your Pod(s) on a different Node with more space.</p><p>If that fails, or if there is not enough space when you deploy your application, the Cluster will put your workload/deployment in schedule mode until there is enough room on any of the available Nodes to deploy the Pods according to their limits.</p><h2 id=2-fix-phpapache-deployment>2. Fix PHP/Apache Deployment</h2><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Before we start, let&rsquo;s check the current status of the PHP/Apache deployment. Under <strong>Alerts & Detectors</strong> which detector has fired? Where else can you find this information?</p></div></details><p>To fix the PHP/Apache StatefulSet, edit <code>~/workshop/k3s/php-apache.yaml</code> using the following commands to reduce the CPU resources:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim ~/workshop/k3s/php-apache.yaml</span></span></code></pre></div><p>Find the resources section and reduce the CPU limits to <strong>1</strong> and the CPU requests to <strong>0.5</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8Mi&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;4Mi&#34;</span></span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><p>Now, we must delete the existing StatefulSet and re-create it. StatefulSets are immutable, so we must delete the existing one and re-create it with the new changes.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete statefulset php-apache -n apache</span></span></code></pre></div><p>Now, deploy your changes:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/php-apache.yaml -n apache</span></span></code></pre></div><h2 id=3-validate-the-changes>3. Validate the changes</h2><p>You can validate the changes have been applied by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><p>Validate the Pod is now running in Splunk Observability Cloud.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Is the <strong>Apache Web Servers</strong> dashboard showing any data now?</p><p><strong>Tip:</strong> Don&rsquo;t forget to use filters and time frames to narrow down your data.</p></div></details><p>Monitor the Apache web servers Navigator dashboard for a few minutes.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What is happening with the # Hosts reporting chart?</p></div></details><h2 id=4-fix-the-memory-issue>4. Fix the memory issue</h2><p>If you navigate back to the Apache dashboard, you will notice that metrics are no longer coming in. We have another resource issue and this time we are Out of Memory. Let&rsquo;s edit the stateful set and increase the memory to what is shown in the image below:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit statefulset php-apache -n apache</span></span></code></pre></div><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>limits</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>16Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>500m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>12Mi</span></span></span></code></pre></div><p>Save the changes you have made.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation"></i>
Hint</summary><div class=box-content><p><code>kubectl edit</code> will open the contents in the <code>vi</code> editor, use <code>Esc</code> followed by <code>:wq!</code> to save your changes.</p></div></details><p>Because StatefulSets are immutable, we must delete the existing Pod and let the StatefulSet re-create it with the new changes.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete pod php-apache-0 -n apache</span></span></code></pre></div><p>Validate the changes have been applied by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe statefulset php-apache -n apache</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-load-generator>Deploy Load Generator</h1><p>Now let&rsquo;s apply some load against the <code>php-apache</code> pod. To do this, you will need to start a different Pod to act as a client. The container within the client Pod runs in an infinite loop, sending HTTP GETs to the <code>php-apache</code> service.</p><h2 id=1-review-loadgen-yaml>1. Review loadgen YAML</h2><p>Inspect the YAML file <code>~/workshop/k3s/loadgen.yaml</code> and validate the contents using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/loadgen.yaml</span></span></code></pre></div><p>This file contains the configuration for the load generator and will create a new ReplicaSet with two replicas of the load generator image.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>ReplicaSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>loadgen</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>infinite-calls</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>busybox</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>command</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>/bin/sh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- -<span class=l>c</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=s2>&#34;while true; do wget -q -O- http://php-apache-svc.apache.svc.cluster.local; done&#34;</span></span></span></code></pre></div><h2 id=2-create-a-new-namespace>2. Create a new namespace</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl create namespace loadgen</span></span></code></pre></div><h2 id=3-deploy-the-loadgen-yaml>3. Deploy the loadgen YAML</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/loadgen.yaml --namespace loadgen</span></span></code></pre></div><p>Once you have deployed the load generator, you can see the Pods running in the <code>loadgen</code> namespace. Use previous similar commands to check the status of the Pods from the command line.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Which metrics in the Apache Navigator have now significantly increased?</p></div></details><h2 id=4-scale-the-load-generator>4. Scale the load generator</h2><p>A ReplicaSet is a process that runs multiple instances of a Pod and keeps the specified number of Pods constant. Its purpose is to maintain the specified number of Pod instances running in a cluster at any given time to prevent users from losing access to their application when a Pod fails or is inaccessible.</p><p>ReplicaSet helps bring up a new instance of a Pod when the existing one fails, scale it up when the running instances are not up to the specified number, and scale down or delete Pods if another instance with the same label is created. A ReplicaSet ensures that a specified number of Pod replicas are running continuously and helps with load-balancing in case of an increase in resource usage.</p><p>Let&rsquo;s scale our ReplicaSet to 4 replicas using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl scale replicaset/loadgen --replicas 4 -n loadgen</span></span></code></pre></div><p>Validate the replicas are running from both the command line and Splunk Observability Cloud:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get replicaset loadgen -n loadgen</span></span></code></pre></div><p><a href=#R-image-d7e73ec161b513f2a64ee644a189367d class=lightbox-link><img alt=ReplicaSet class="lazy lightbox figure-image" loading=lazy src=../images/k8s-workload-replicaset.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d7e73ec161b513f2a64ee644a189367d><img alt=ReplicaSet class="lazy lightbox lightbox-image" loading=lazy src=../images/k8s-workload-replicaset.png></a></p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What impact can you see in the Apache Navigator?</p></div></details><p>Let the load generator run for around 2-3 minutes and keep observing the metrics in the Kubernetes Navigator and the Apache Navigator.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=setup-horizontal-pod-autoscaling-hpa>Setup Horizontal Pod Autoscaling (HPA)</h1><p>In Kubernetes, a HorizontalPodAutoscaler automatically updates a workload resource (such as a Deployment or StatefulSet), to automatically scale the workload to match demand.</p><p>Horizontal scaling means that the response to increased load is to deploy more Pods. This is different from vertical scaling, which for Kubernetes would mean assigning more resources (for example: memory or CPU) to the Pods that are already running for the workload.</p><p>If the load decreases, and the number of Pods is above the configured minimum, the HorizontalPodAutoscaler instructs the workload resource (the Deployment, StatefulSet, or other similar resource) to scale back down.</p><h2 id=1-setup-hpa>1. Setup HPA</h2><p>Inspect the <code>~/workshop/k3s/hpa.yaml</code> file and validate the contents using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><p>This file contains the configuration for the Horizontal Pod Autoscaler and will create a new HPA for the <code>php-apache</code> deployment.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>autoscaling/v2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>HorizontalPodAutoscaler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>maxReplicas</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>cpu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>50</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resource</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>memory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>target</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>averageUtilization</span><span class=p>:</span><span class=w> </span><span class=m>75</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>Utilization</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>minReplicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scaleTargetRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>StatefulSet</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>php-apache</span></span></span></code></pre></div><p>Once deployed, <code>php-apache</code> will autoscale when either the average CPU usage goes above 50% or the average memory usage for the deployment goes above 75%, with a minimum of 1 pod and a maximum of 4 pods.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl apply -f ~/workshop/k3s/hpa.yaml</span></span></code></pre></div><h2 id=2-validate-hpa>2. Validate HPA</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>kubectl get hpa -n apache</span></span></code></pre></div><p>Go to the <strong>Workloads</strong> or <strong>Node Detail</strong> tab in Kubernetes and check the HPA deployment.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Questions</summary><div class=box-content><ol><li>How many additional <code>php-apache-x</code> pods have been created?</li><li>Which metrics in the <strong>Apache web servers (OTel) Navigator</strong> have significantly increased again?</li></ol></div></details><h2 id=3-increase-the-hpa-replica-count>3. Increase the HPA replica count</h2><p>Increase the <code>maxReplicas</code> to 8</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl edit hpa php-apache -n apache</span></span></code></pre></div><p>Save the changes you have made. (Hint: Use <code>Esc</code> followed by <code>:wq!</code> to save your changes).</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Questions</summary><div class=box-content><ol><li><p>How many pods are now running?</p></li><li><p>How many are pending?</p></li><li><p>Why are they pending?</p></li></ol></div></details><p><strong>Congratulations!</strong> You have completed the workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 6, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-workshops>OpenTelemetry Collector Workshops</h1><div class="children children-type-card children-sort-"><ul class=card-container><li><article class="card card-popout" aria-labelledby=R-card-e65c7b709831a670577a7de19f50cb40><div class=card-content><div class=card-title id=R-card-e65c7b709831a670577a7de19f50cb40><a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/index.html>OpenTelemetry Collector Concepts</a></div><div class=card-content-text>Learn the concepts of the OpenTelemetry Collector and how to use it to send data to Splunk Observability Cloud.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/images/extensionz.png></div></article></li><li><article class="card card-popout" aria-labelledby=R-card-4def5072ecbdcbe60d20fc1d1eedf818><div class=card-content><div class=card-title id=R-card-4def5072ecbdcbe60d20fc1d1eedf818><a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html>Advanced OpenTelemetry Collector</a></div><div class=card-content-text>Practice setting up the OpenTelemetry Collector configuration from scratch and go though several advanced configuration scenarios&rsquo;s.</div></div><div class=card-image><img src=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/images/welldone.png></div></article></li></ul></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 29, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Workshops</h1><article class=default><header class=headline></header><h1 id=making-your-observability-cloud-native-with-opentelemetry>Making Your Observability Cloud Native With OpenTelemetry</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>1 hour</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><h2 id=abstract>Abstract</h2><p>Organizations getting started with OpenTelemetry may begin by sending data directly to an observability backend. While this works well for initial testing, using the OpenTelemetry collector as part of your observability architecture provides numerous benefits and is recommended for any production deployment.</p><p>In this workshop, we will be focusing on using the OpenTelemetry collector and starting with the fundamentals of configuring the receivers, processors, and exporters ready to use with Splunk Observability Cloud. The journey will take attendees from novices to being able to start adding custom components to help solve for their business observability needs for their distributed platform.</p><h3 id=ninja-sections>Ninja Sections</h3><p>Throughout the workshop there will be expandable <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong> Sections</span></span>, these will be more hands on and go into further technical detail that you can explore within the workshop or in your own time.</p><p>Please note that the content in these sections may go out of date due to the frequent development being made to the OpenTelemetry project. Links will be provided in the event details are out of sync, please let us know if you spot something that needs updating.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Test Me!</span></span></summary><div class=box-content><p><strong>By completing this workshop you will officially be an OpenTelemetry Collector Ninja!</strong></p></div></details><hr><h2 id=target-audience>Target Audience</h2><p>This interactive workshop is for developers and system administrators who are interested in learning more about architecture and deployment of the OpenTelemetry Collector.</p><h2 id=prerequisites>Prerequisites</h2><ul><li>Attendees should have a basic understanding of data collection</li><li>Command line and vim/vi experience.</li><li>A instance/host/VM running Ubuntu 20.04 LTS or 22.04 LTS.<ul><li>Minimum requirements are an AWS/EC2 t2.micro (1 CPU, 1GB RAM, 8GB Storage)</li></ul></li></ul><h2 id=learning-objectives>Learning Objectives</h2><p>By the end of this talk, attendees will be able to:</p><ul><li>Understand the components of OpenTelemetry</li><li>Use receivers, processors, and exporters to collect and analyze data</li><li>Identify the benefits of using OpenTelemetry</li><li>Build a custom component to solve their business needs</li></ul><h2 id=opentelemetry-architecture>OpenTelemetry Architecture</h2><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of OpenTelemetry Collector Concepts</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=download-the-opentelemetry-collector-contrib-distribution>Download the OpenTelemetry Collector Contrib distribution</h2><p>The first step in installing the Open Telemetry Collector is downloading it. For our lab, we will use the <code>wget</code> command to download the <code>.deb</code> package from the OpenTelemetry Github repository.</p><p>Obtain the <code>.deb</code> package for your platform from the <a href=https://github.com/open-telemetry/opentelemetry-collector-releases/releases rel=external><strong>OpenTelemetry Collector Contrib releases page</strong></a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v0.111.0/otelcol-contrib_0.111.0_linux_amd64.deb</span></span></code></pre></div><h2 id=install-the-opentelemetry-collector-contrib-distribution>Install the OpenTelemetry Collector Contrib distribution</h2><p>Install the <code>.deb</code> package using <code>dpkg</code>. Take a look at the <strong>dpkg Output</strong> tab below to see what the example output of a successful install will look like:</p><div class=tab-panel data-tab-group=R-tabs-7e61cde6a1fdf42a552834c13c1667ce><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-9df86df766d9411ff86064f683b28927 aria-expanded=true data-tab-item=R-tab-349838fb1d851d3e2014b9fe39203275 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7e61cde6a1fdf42a552834c13c1667ce","R-tab-349838fb1d851d3e2014b9fe39203275")'>
<span class=tab-nav-text>Install</span>
</button>
<button aria-controls=R-tab-id-573273e89cbf1fda5c1b822f6b473772 aria-expanded=false data-tab-item=R-tab-88b74acfc7be57ced2480fc5f7165e87 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7e61cde6a1fdf42a552834c13c1667ce","R-tab-88b74acfc7be57ced2480fc5f7165e87")'>
<span class=tab-nav-text>dpkg Output</span></button></div><div class=tab-content-container><div id=R-tab-id-9df86df766d9411ff86064f683b28927 data-tab-item=R-tab-349838fb1d851d3e2014b9fe39203275 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo dpkg -i otelcol-contrib_0.111.0_linux_amd64.deb</span></span></code></pre></div></div></div><div id=R-tab-id-573273e89cbf1fda5c1b822f6b473772 data-tab-item=R-tab-88b74acfc7be57ced2480fc5f7165e87 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Selecting previously unselected package otelcol-contrib.
</span></span><span class=line><span class=cl>(Reading database ... 89232 files and directories currently installed.)
</span></span><span class=line><span class=cl>Preparing to unpack otelcol-contrib_0.111.0_linux_amd64.deb ...
</span></span><span class=line><span class=cl>Unpacking otelcol-contrib (0.111.0) ...
</span></span><span class=line><span class=cl>Setting up otelcol-contrib (0.111.0) ...
</span></span><span class=line><span class=cl>Created symlink /etc/systemd/system/multi-user.target.wants/otelcol-contrib.service â†’ /lib/systemd/system/otelcol-contrib.service.</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Installation</h1><article class=default><header class=headline></header><h1 id=installing-opentelemetry-collector-contrib>Installing OpenTelemetry Collector Contrib</h1><h2 id=confirm-the-collector-is-running>Confirm the Collector is running</h2><p>The collector should now be running. We will verify this as root using <code>systemctl</code> command. To exit the status just press <code>q</code>.</p><div class=tab-panel data-tab-group=R-tabs-3db3c816e91146d01a73872b4bb97b91><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-88d199c8e12a3d37a6ac4ac7e59b6cd4 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-3db3c816e91146d01a73872b4bb97b91","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-bdfac0a1eccc9a055de7bf9b5c29e2c2 aria-expanded=false data-tab-item=R-tab-ea8cb5b4ea61afc69dea0097cb212fb6 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-3db3c816e91146d01a73872b4bb97b91","R-tab-ea8cb5b4ea61afc69dea0097cb212fb6")'>
<span class=tab-nav-text>Status Output</span></button></div><div class=tab-content-container><div id=R-tab-id-88d199c8e12a3d37a6ac4ac7e59b6cd4 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status otelcol-contrib</span></span></code></pre></div></div></div><div id=R-tab-id-bdfac0a1eccc9a055de7bf9b5c29e2c2 data-tab-item=R-tab-ea8cb5b4ea61afc69dea0097cb212fb6 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>â— otelcol-contrib.service - OpenTelemetry Collector Contrib
</span></span><span class=line><span class=cl>     Loaded: loaded (/lib/systemd/system/otelcol-contrib.service; enabled; vendor preset: enabled)
</span></span><span class=line><span class=cl>     Active: active (running) since Mon 2024-10-07 10:27:49 BST; 52s ago
</span></span><span class=line><span class=cl>   Main PID: 17113 (otelcol-contrib)
</span></span><span class=line><span class=cl>      Tasks: 13 (limit: 19238)
</span></span><span class=line><span class=cl>     Memory: 34.8M
</span></span><span class=line><span class=cl>        CPU: 155ms
</span></span><span class=line><span class=cl>     CGroup: /system.slice/otelcol-contrib.service
</span></span><span class=line><span class=cl>             â””â”€17113 /usr/bin/otelcol-contrib --config=/etc/otelcol-contrib/config.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Descriptor:
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Name: up
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Description: The scraping was successful
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; Unit:
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:      -&gt; DataType: Gauge
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: NumberDataPoints #0
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: StartTimestamp: 1970-01-01 00:00:00 +0000 UTC
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Timestamp: 2024-10-07 09:28:36.942 +0000 UTC
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]: Value: 1.000000
</span></span><span class=line><span class=cl>Oct 07 10:28:36 petclinic-rum-testing otelcol-contrib[17113]:         {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;metrics&#34;, &#34;name&#34;: &#34;debug&#34;}</span></span></code></pre></div></div></div></div></div><p>Because we will be making multiple configuration file changes, setting environment variables and restarting the collector, we need to stop the collector service and disable it from starting on boot.</p><div class=tab-panel data-tab-group=R-tabs-a0c9a98c56184512a87be5d5313cd8ce><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f7c0ffc8e4a184e3d2b63f9c43ef2d95 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a0c9a98c56184512a87be5d5313cd8ce","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-f7c0ffc8e4a184e3d2b63f9c43ef2d95 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl stop otelcol-contrib <span class=o>&amp;&amp;</span> sudo systemctl disable otelcol-contrib</span></span></code></pre></div></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Build your own collector using Open Telemetry Collector Builder (ocb)</span></span></summary><div class=box-content><p>For this part we will require the following installed on your system:</p><ul><li><p>Golang (latest version)</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /tmp
</span></span><span class=line><span class=cl>wget https://golang.org/dl/go1.20.linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo tar -C /usr/local -xzf go1.20.linux-amd64.tar.gz</span></span></code></pre></div><p>Edit <code>.profile</code> and add the following environment variables:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOROOT</span><span class=o>=</span>/usr/local/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>GOPATH</span><span class=o>=</span><span class=nv>$HOME</span>/go
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>PATH</span><span class=o>=</span><span class=nv>$GOPATH</span>/bin:<span class=nv>$GOROOT</span>/bin:<span class=nv>$PATH</span></span></span></code></pre></div><p>Renew your shell session:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.profile</span></span></code></pre></div><p>Check Go version:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go version</span></span></code></pre></div></li><li><p>ocb installed</p><ul><li><p>Download the ocb binary from the <a href=https://github.com/open-telemetry/opentelemetry-collector/releases/tag/cmd%2Fbuilder%2Fv0.80.0 rel=external>project releases</a>
and run the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mv ocb_0.80.0_darwin_arm64 /usr/bin/ocb
</span></span><span class=line><span class=cl>chmod <span class=m>755</span> /usr/bin/ocb</span></span></code></pre></div><p>An alternative approach would be to use the golang tool chain to build the binary locally by doing:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>go install go.opentelemetry.io/collector/cmd/builder@v0.80.0
</span></span><span class=line><span class=cl>mv <span class=k>$(</span>go env GOPATH<span class=k>)</span>/bin/builder /usr/bin/ocb</span></span></code></pre></div></li></ul></li><li><p>(Optional) Docker</p></li></ul><h2 id=why-build-your-own-collector>Why build your own collector?</h2><p>The default distribution of the collector (core and contrib) either contains too much or too little in what they have to offer.</p><p>It is also not advised to run the contrib collector in your production environments due to the amount of components installed which more than likely are not needed by your deployment.</p><h2 id=benefits-of-building-your-own-collector>Benefits of building your own collector?</h2><p>When creating your own collector binaries, (commonly referred to as distribution), means you build what you need.</p><p>The benefits of this are:</p><ol><li>Smaller sized binaries</li><li>Can use existing go scanners for vulnerabilities</li><li>Include internal components that can tie in with your organization</li></ol><h2 id=considerations-for-building-your-collector>Considerations for building your collector?</h2><p>Now, this would not be a ðŸ¥· Ninja zone if it didn&rsquo;t come with some drawbacks:</p><ol><li>Go experience is recommended if not required</li><li><strong>No</strong> Splunk support</li><li>Responsibility for distribution and lifecycle management</li></ol><p>It is important to note that the project is working towards stability but it does not mean changes made will not break your workflow. The team at Splunk provides increased support and a higher level of stability so they can provide a curated experience helping you with your deployment needs.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>Once you have all the required tools installed to get started, you will need to create a new file named <code>otelcol-builder.yaml</code> and we will follow this directory structure:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â””â”€â”€ otelcol-builder.yaml</span></span></code></pre></div><p>Once we have the file created, we need to add a list of components for it to install with some additional metadata.</p><p>For this example, we are going to create a builder manifest that will install only the components we need for the introduction config:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-ninja</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>A custom build of the Open Telemetry Collector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/ballastextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/extension/zpagesextension  v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/httpforwarder v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/splunkhecexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/exporter/signalfxexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/memorylimiterprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/hostmetricsreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/zipkinreceiver v0.80.0</span></span></span></code></pre></div><p>Once the yaml file has been updated for the <em>ocb</em>, then run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ocb --config<span class=o>=</span>otelcol-builder.yaml</span></span></code></pre></div><p>Which leave you with the following directory structure:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>â”œâ”€â”€ dist
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ components.go
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ components_test.go
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ go.mod
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ go.sum
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ main.go
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ main_others.go
</span></span><span class=line><span class=cl>â”‚Â Â  â”œâ”€â”€ main_windows.go
</span></span><span class=line><span class=cl>â”‚Â Â  â””â”€â”€ otelcol-ninja
</span></span><span class=line><span class=cl>â””â”€â”€ otelcol-builder.yaml</span></span></code></pre></div><h3 id=references>References</h3><ol><li><a href=https://opentelemetry.io/docs/collector/custom-collector/ rel=external>https://opentelemetry.io/docs/collector/custom-collector/</a></li></ol></div></details><hr><h2 id=default-configuration>Default configuration</h2><p>OpenTelemetry is configured through YAML files. These files have default configurations that we can modify to meet our needs. Let&rsquo;s look at the default configuration that is supplied:</p><div class=tab-panel data-tab-group=R-tabs-d876fd56791409c7fc039f44fe20f0db><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-b349d0b2c8bb2ade8ed4173dceb76e84 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d876fd56791409c7fc039f44fe20f0db","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-5759845cc02f81ee6749f822a364ec8d aria-expanded=false data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-d876fd56791409c7fc039f44fe20f0db","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-b349d0b2c8bb2ade8ed4173dceb76e84 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-5759845cc02f81ee6749f822a364ec8d data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div><p>Congratulations! You have successfully downloaded and installed the OpenTelemetry Collector. You are well on your way to becoming an OTel Ninja. But first let&rsquo;s walk through configuration files and different distributions of the OpenTelemetry Collector.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>Splunk does provide its own, fully supported, distribution of the OpenTelemetry Collector. This distribution is available to install from the <a href=https://github.com/signalfx/splunk-otel-collector rel=external><strong>Splunk GitHub Repository</strong></a> or via a wizard in Splunk Observability Cloud that will build out a simple installation script to copy and paste. This distribution includes many additional features and enhancements that are not available in the OpenTelemetry Collector Contrib distribution.</p><ul><li>The Splunk Distribution of the OpenTelemetry Collector is production-tested; it is in use by the majority of customers in their production environments.</li><li>Customers that use our distribution can receive direct help from official Splunk support within SLAs.</li><li>Customers can use or migrate to the Splunk Distribution of the OpenTelemetry Collector without worrying about future breaking changes to its core configuration experience for metrics and traces collection (OpenTelemetry logs collection configuration is in beta). There may be breaking changes to the Collector&rsquo;s metrics.</li></ul></div></details><p>We will now walk through each section of the configuration file and modify it to send host metrics to Splunk Observability Cloud.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><p>Now that we have the OpenTelemetry Collector installed, let&rsquo;s take a look at extensions for the OpenTelemetry Collector. Extensions are optional and available primarily for tasks that do not involve processing telemetry data. Examples of extensions include health monitoring, service discovery, and data forwarding.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;: &#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style E fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Extensions</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=health-check>Health Check</h2><p>Extensions are configured in the same <code>config.yaml</code> file that we referenced in the installation step. Let&rsquo;s edit the <code>config.yaml</code> file and configure the extensions. Note that the <strong>pprof</strong> and <strong>zpages</strong> extensions are already configured in the default <code>config.yaml</code> file. For the purpose of this workshop, we will only be updating the <strong>health_check</strong> extension to expose the port on all network interfaces on which we can access the health of the collector.</p><div class=tab-panel data-tab-group=R-tabs-b4799d4cc0ba3200ca44473cf3117bdc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d3fce54d146aa69796fe58ce205987cb aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b4799d4cc0ba3200ca44473cf3117bdc","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-d3fce54d146aa69796fe58ce205987cb data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=R-tabs-fc32259c8d5aed1f356e92f5fb109682><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ae3a5f67cd4ebcbb3ad53cdc18d9a994 aria-expanded=true data-tab-item=R-tab-152f0ce564aa5e1309a89e848db53185 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fc32259c8d5aed1f356e92f5fb109682","R-tab-152f0ce564aa5e1309a89e848db53185")'>
<span class=tab-nav-text>Extensions Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-ae3a5f67cd4ebcbb3ad53cdc18d9a994 data-tab-item=R-tab-152f0ce564aa5e1309a89e848db53185 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span></span></span></code></pre></div></div></div></div></div><p>Start the collector:</p><div class=tab-panel data-tab-group=R-tabs-9f1c90e8db857acceb771fad39c6628b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-480194ef169027b7a20f62ce69accd6f aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9f1c90e8db857acceb771fad39c6628b","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-480194ef169027b7a20f62ce69accd6f data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p>This extension enables an HTTP URL that can be probed to check the status of the OpenTelemetry Collector. This extension can be used as a liveness and/or readiness probe on Kubernetes. To learn more about the <code>curl</code> command, check out the <a href=https://curl.se/docs/manpage.html rel=external>curl man page</a>.</p><p>Open a new terminal session and SSH into your instance to run the following command:</p><div class=tab-panel data-tab-group=R-tabs-0f238f9aa9d92dc1608d7bc08a03dfc1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2787038f4f0353b7a5eb735ff86aeda4 aria-expanded=true data-tab-item=R-tab-e2d1c201ce0c8c47d452167742abc308 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-0f238f9aa9d92dc1608d7bc08a03dfc1","R-tab-e2d1c201ce0c8c47d452167742abc308")'>
<span class=tab-nav-text>curl Command</span>
</button>
<button aria-controls=R-tab-id-31eeb91bfea61ca696be30a4394d79da aria-expanded=false data-tab-item=R-tab-6e431ae9119cd9664129d3c3aafa7ce3 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-0f238f9aa9d92dc1608d7bc08a03dfc1","R-tab-6e431ae9119cd9664129d3c3aafa7ce3")'>
<span class=tab-nav-text>curl Output</span></button></div><div class=tab-content-container><div id=R-tab-id-2787038f4f0353b7a5eb735ff86aeda4 data-tab-item=R-tab-e2d1c201ce0c8c47d452167742abc308 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:13133</span></span></code></pre></div></div></div><div id=R-tab-id-31eeb91bfea61ca696be30a4394d79da data-tab-item=R-tab-6e431ae9119cd9664129d3c3aafa7ce3 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>{&#34;status&#34;:&#34;Server available&#34;,&#34;upSince&#34;:&#34;2024-10-07T11:00:08.004685295+01:00&#34;,&#34;uptime&#34;:&#34;12.56420005s&#34;}</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=performance-profiler>Performance Profiler</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/extension/pprofextension/README.md rel=external><strong>Performance Profiler</strong></a> extension enables the golang net/http/pprof endpoint. This is typically used by developers to collect performance profiles and investigate issues with the service. <strong>We will not be covering this in this workshop</strong>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-extensions>OpenTelemetry Collector Extensions</h1><h2 id=zpages>zPages</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/extension/zpagesextension/README.md rel=external><strong>zPages</strong></a> are an in-process alternative to external exporters. When included, they collect and aggregate tracing and metrics information in the background; this data is served on web pages when requested. zPages are an extremely useful diagnostic feature to ensure the collector is running as expected.</p><div class=tab-panel data-tab-group=R-tabs-474095490d02f32c3c1f41b93f63f8da><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-56241431f68da17ff51ae13d0b95cb4a aria-expanded=true data-tab-item=R-tab-552e9e5a9146ffc544b495bfe6a66c36 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-474095490d02f32c3c1f41b93f63f8da","R-tab-552e9e5a9146ffc544b495bfe6a66c36")'>
<span class=tab-nav-text>ServiceZ</span>
</button>
<button aria-controls=R-tab-id-73ec641e1efe2592e66aa361a8139c44 aria-expanded=false data-tab-item=R-tab-41646adfc5c13ab129b70c2240c1db3d class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-474095490d02f32c3c1f41b93f63f8da","R-tab-41646adfc5c13ab129b70c2240c1db3d")'>
<span class=tab-nav-text>PipelineZ</span>
</button>
<button aria-controls=R-tab-id-b0f4ddf7245f641aa74913f14db33b87 aria-expanded=false data-tab-item=R-tab-3fbf781f7e065ca41160f534cc231df0 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-474095490d02f32c3c1f41b93f63f8da","R-tab-3fbf781f7e065ca41160f534cc231df0")'>
<span class=tab-nav-text>ExtensionZ</span></button></div><div class=tab-content-container><div id=R-tab-id-56241431f68da17ff51ae13d0b95cb4a data-tab-item=R-tab-552e9e5a9146ffc544b495bfe6a66c36 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>ServiceZ</strong> gives an overview of the collector services and quick access to the pipelinez, extensionz, and featurez zPages. The page also provides build and runtime information.</p><p>Example URL: <a href=http://localhost:55679/debug/servicez rel=external><strong>http://localhost:55679/debug/servicez</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-c687b6fb2175acb88a362f96c00a0ad1 class=lightbox-link><img alt=ServiceZ class="lazy lightbox figure-image" loading=lazy src=../../images/servicez.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c687b6fb2175acb88a362f96c00a0ad1><img alt=ServiceZ class="lazy lightbox lightbox-image" loading=lazy src=../../images/servicez.png></a></p></div></div><div id=R-tab-id-73ec641e1efe2592e66aa361a8139c44 data-tab-item=R-tab-41646adfc5c13ab129b70c2240c1db3d class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>PipelineZ</strong> provides insights on the running pipelines running in the collector. You can find information on type, if data is mutated, and you can also see information on the receivers, processors and exporters that are used for each pipeline.</p><p>Example URL: <a href=http://localhost:55679/debug/pipelinez rel=external><strong>http://localhost:55679/debug/pipelinez</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-68750405a3cdaa1fce049b9215975b9d class=lightbox-link><img alt=PipelineZ class="lazy lightbox figure-image" loading=lazy src=../../images/pipelinez.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68750405a3cdaa1fce049b9215975b9d><img alt=PipelineZ class="lazy lightbox lightbox-image" loading=lazy src=../../images/pipelinez.png></a></p></div></div><div id=R-tab-id-b0f4ddf7245f641aa74913f14db33b87 data-tab-item=R-tab-3fbf781f7e065ca41160f534cc231df0 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>ExtensionZ</strong> shows the extensions that are active in the collector.</p><p>Example URL: <a href=http://localhost:55679/debug/extensionz rel=external><strong>http://localhost:55679/debug/extensionz</strong></a> (change <code>localhost</code> to reflect your own environment).</p><p><a href=#R-image-fa751692c5d8b05930961da10b986c30 class=lightbox-link><img alt=ExtensionZ class="lazy lightbox figure-image" loading=lazy src=../../images/extensionz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa751692c5d8b05930961da10b986c30><img alt=ExtensionZ class="lazy lightbox lightbox-image" loading=lazy src=../../images/extensionz.png></a></p></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Improve data durability with storage extension</span></span></summary><div class=box-content><p>For this, we will need to validate that our distribution has the <code>file_storage</code> extension installed. This can be done by running the command <code>otelcol-contrib components</code> which should show results like:</p><div class=tab-panel data-tab-group=R-tabs-66b98472ca00073f921f28f59b4492a9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-79ad820031ff5358dffd3f1c1f75b372 aria-expanded=true data-tab-item=R-tab-293717097f4a71a9db50f219169437b8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-66b98472ca00073f921f28f59b4492a9","R-tab-293717097f4a71a9db50f219169437b8")'>
<span class=tab-nav-text>Truncated Output</span>
</button>
<button aria-controls=R-tab-id-e6e7c99957396e42d9a93e22f2bb77ac aria-expanded=false data-tab-item=R-tab-6d20673ef09b9c1f8566526724ee50d7 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-66b98472ca00073f921f28f59b4492a9","R-tab-6d20673ef09b9c1f8566526724ee50d7")'>
<span class=tab-nav-text>Full Output</span></button></div><div class=tab-content-container><div id=R-tab-id-79ad820031ff5358dffd3f1c1f75b372 data-tab-item=R-tab-293717097f4a71a9db50f219169437b8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage</span></span></span></code></pre></div></div></div><div id=R-tab-id-e6e7c99957396e42d9a93e22f2bb77ac data-tab-item=R-tab-6d20673ef09b9c1f8566526724ee50d7 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>buildinfo</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=l>otelcol-contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>OpenTelemetry Collector Contrib</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=m>0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus_simple</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>apache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>purefb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>receiver_creator</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodbatlas</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>vcenter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>snmp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>expvar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jmx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>udplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafkametrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memcached</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowseventlog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zookeeper</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsecscontainermetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>iis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nsxt</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>aerospike</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>httpcheck</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sobjects</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mongodb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>hostmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>statsd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudfoundry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>collectd</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>couchdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kubeletstats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>journald</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>riak</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>active_directory_ds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlquery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>windowsperfcounters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>flinkmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>podman_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>wavefront</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_events</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>postgresql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>rabbitmq</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sqlserver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>solace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tcplog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscontainerinsightreceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsfirehose</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bigip</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filelog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudspanner</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cloudflare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>docker_stats</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_cluster</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azureeventhub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>fluentforward</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlpjsonfile</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>syslog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>cumulativetodelta</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbyattrs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>groupbytrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>experimental_metricsgeneration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>metricstransform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>deltatorate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>spanmetrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>span</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>redaction</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>servicegraph</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>transform</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>filter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>probabilistic_sampler</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tail_sampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>carbon</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>datadog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>f5cloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>kafka</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>mezmo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>skywalking</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsxray</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>dynatrace</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loki</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logging</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuredataexplorer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>azuremonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>instana</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>loadbalancing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sentry</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>splunk_hec</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tanzuobservability</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zipkin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>alibabacloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>clickhouse</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloud</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>prometheusremotewrite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awscloudwatchlogs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlecloudpubsub</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaeger_thrift</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logzio</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sapm</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sumologic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>googlemanagedprometheus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>opencensus</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awskinesis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>coralogix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>influxdb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>logicmonitor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>tencentcloud_logservice</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsemf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>elasticsearch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pulsar</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>zpages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>bearertokenauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oidc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>host_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>sigv4auth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>file_storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>memory_ballast</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>oauth2client</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>awsproxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>http_forwarder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>jaegerremotesampling</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>k8s_observer</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>pprof</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>asapclient</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>basicauth</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>headers_setter</span></span></span></code></pre></div></div></div></div></div><p>This extension provides exporters the ability to queue data to disk in the event that exporter is unable to send data to the configured endpoint.</p><p>In order to configure the extension, you will need to update your config to include the information below. First, be sure to create a /tmp/otel-data directory and give it read/write permissions:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=l>/tmp/otel-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_rebound</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_needed_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>5</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rebound_trigger_threshold_mib</span><span class=p>:</span><span class=w> </span><span class=m>3</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ... truncated for clarity</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages, file_storage]</span></span></span></code></pre></div><h2 id=why-queue-data-to-disk>Why queue data to disk?</h2><p>This allows the collector to weather network interruptions (and even collector restarts) to ensure data is sent to the upstream provider.</p><h2 id=considerations-for-queuing-data-to-disk>Considerations for queuing data to disk?</h2><p>There is a potential that this could impact data throughput performance due to disk performance.</p><h3 id=references>References</h3><ol><li><a href=https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583 rel=external>https://community.splunk.com/t5/Community-Blog/Data-Persistence-in-the-OpenTelemetry-Collector/ba-p/624583</a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage rel=external>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/storage/filestorage</a></li></ol></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered extensions, let&rsquo;s check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-dc0b0c8e113b65d5ceaaa579aad4a7f1><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-be6832a64bcdd49cf86fd95c3e6887ec aria-expanded=true data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-dc0b0c8e113b65d5ceaaa579aad4a7f1","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-be6832a64bcdd49cf86fd95c3e6887ec data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=hl><span class=lnt> 5
</span></span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Now that we have reviewed extensions, let&rsquo;s dive into the data pipeline portion of the workshop. A pipeline defines a path the data follows in the Collector starting from reception, moving to further processing or modification, and finally exiting the Collector via exporters.</p><p>The data pipeline in the OpenTelemetry Collector is made up of <strong>receivers</strong>, <strong>processors</strong>, and <strong>exporters</strong>. We will first start with receivers.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><p>Welcome to the receiver portion of the workshop! This is the starting point of the data pipeline of the OpenTelemetry Collector. Let&rsquo;s dive in.</p><p>A receiver, which can be push or pull based, is how data gets into the Collector. Receivers may support one or more data sources. Generally, a receiver accepts data in a specified format, translates it into the internal format and passes it to processors and exporters defined in the applicable pipelines.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style M fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Receivers</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=host-metrics-receiver>Host Metrics Receiver</h2><p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/receiver/hostmetricsreceiver/README.md rel=external><strong>The Host Metrics Receiver</strong></a> generates metrics about the host system scraped from various sources. This is intended to be used when the collector is deployed as an agent which is what we will be doing in this workshop.</p><p>Let&rsquo;s update the <code>/etc/otel-contrib/config.yaml</code> file and configure the <strong>hostmetrics</strong> receiver. Insert the following YAML under the <strong>receivers</strong> section, taking care to indent by two spaces.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otelcol-contrib/config.yaml</span></span></code></pre></div><div class=tab-panel data-tab-group=R-tabs-d3448ecec3d8c388991804ac10e84cfd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e077641997d236d77b10ce2b7a1e1e44 aria-expanded=true data-tab-item=R-tab-d4d9df34006b2c5d7545d2f1f4e741e2 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d3448ecec3d8c388991804ac10e84cfd","R-tab-d4d9df34006b2c5d7545d2f1f4e741e2")'>
<span class=tab-nav-text>Host Metrics Receiver Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-e077641997d236d77b10ce2b7a1e1e44 data-tab-item=R-tab-d4d9df34006b2c5d7545d2f1f4e741e2 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=prometheus-receiver>Prometheus Receiver</h2><p>You will also notice another receiver called <strong>prometheus</strong>. <a href=https://prometheus.io/docs/introduction/overview/ rel=external><strong>Prometheus</strong></a> is an open-source toolkit used by the OpenTelemetry Collector. This receiver is used to scrape metrics from the OpenTelemetry Collector itself. These metrics can then be used to monitor the health of the collector.</p><p>Let&rsquo;s modify the <code>prometheus</code> receiver to clearly show that it is for collecting metrics from the collector itself. By changing the name of the receiver from <code>prometheus</code> to <code>prometheus/internal</code>, it is now much clearer as to what that receiver is doing. Update the configuration file to look like this:</p><div class=tab-panel data-tab-group=R-tabs-c5e65e56ed18b031298501402d8821d0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6162bb3ecaaa88be0de945e0d4dce5d2 aria-expanded=true data-tab-item=R-tab-9f44d03ea283a5e0ba757b4cfcb8e9c2 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c5e65e56ed18b031298501402d8821d0","R-tab-9f44d03ea283a5e0ba757b4cfcb8e9c2")'>
<span class=tab-nav-text>Prometheus Receiver Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-6162bb3ecaaa88be0de945e0d4dce5d2 data-tab-item=R-tab-9f44d03ea283a5e0ba757b4cfcb8e9c2 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class="line hl"><span class=cl><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span></span></span></code></pre></div></div></div></div></div><h2 id=example-dashboard---prometheus-metrics>Example Dashboard - Prometheus metrics</h2><p>The following screenshot shows an example dashboard of some of the metrics the Prometheus internal receiver collects from the OpenTelemetry Collector. Here, we can see accepted and sent spans, metrics and log records.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The following screenshot is an out-of-the-box (OOTB) dashboard from Splunk Observability Cloud that allows you to easily monitor your Splunk OpenTelemetry Collector install base.</p></div></details><p><a href=#R-image-803c6f0a4debad6555b6e5cb4cc5b9cf class=lightbox-link><img alt=otel-charts class="lazy lightbox figure-image" loading=lazy src=../../images/otel-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-803c6f0a4debad6555b6e5cb4cc5b9cf><img alt=otel-charts class="lazy lightbox lightbox-image" loading=lazy src=../../images/otel-charts.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-receivers>OpenTelemetry Collector Receivers</h1><h2 id=other-receivers>Other Receivers</h2><p>You will notice in the default configuration there are other receivers: <strong>otlp</strong>, <strong>opencensus</strong>, <strong>jaeger</strong> and <strong>zipkin</strong>. These are used to receive telemetry data from other sources. We will not be covering these receivers in this workshop and they can be left as they are.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Create receivers dynamically</span></span></summary><div class=box-content><p>To help observe short lived tasks like docker containers, kubernetes pods, or ssh sessions, we can use the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator rel=external>receiver creator</a> with <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/extension/observer rel=external>observer extensions</a> to create a new receiver as these services start up.</p><h2 id=what-do-we-need>What do we need?</h2><p>In order to start using the receiver creator and its associated observer extensions, they will need to be part of your collector build manifest.</p><p>See <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/1-installation/index.html>installation</a> for the details.</p><h2 id=things-to-consider>Things to consider?</h2><p>Some short lived tasks may require additional configuration such as <em>username</em>, and <em>password</em>.
These values can be referenced via <a href=https://opentelemetry.io/docs/collector/configuration/#configuration-environment-variables rel=external>environment variables</a>,
or use a scheme expand syntax such as <code>${file:./path/to/database/password}</code>.
Please adhere to your organisation&rsquo;s secret practices when taking this route.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>There are only two things needed for this ninja zone:</p><ol><li>Make sure you have added receiver creater and observer extensions to the builder manifest.</li><li>Create the config that can be used to match against discovered endpoints.</li></ol><p>To create the templated configurations, you can do the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receiver_creator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>host_observer]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;port&#34; &amp;&amp; port == 6379</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>password</span><span class=p>:</span><span class=w> </span><span class=l>${env:HOST_REDIS_PASSWORD}</span></span></span></code></pre></div><p>For more examples, refer to these <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/receivercreator#examples rel=external>receiver creator&rsquo;s examples</a>.</p></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>We&rsquo;ve now covered receivers, so let&rsquo;s now check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-59c97df7bc28ae1ff3ed4caadb12298f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-fcdb08179ecf468b2bbdc93d628cc001 aria-expanded=true data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-59c97df7bc28ae1ff3ed4caadb12298f","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-fcdb08179ecf468b2bbdc93d628cc001 data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=hl><span class=lnt>13
</span></span><span class=hl><span class=lnt>14
</span></span><span class=hl><span class=lnt>15
</span></span><span class=hl><span class=lnt>16
</span></span><span class=hl><span class=lnt>17
</span></span><span class=hl><span class=lnt>18
</span></span><span class=hl><span class=lnt>19
</span></span><span class=hl><span class=lnt>20
</span></span><span class=hl><span class=lnt>21
</span></span><span class=hl><span class=lnt>22
</span></span><span class=hl><span class=lnt>23
</span></span><span class=hl><span class=lnt>24
</span></span><span class=hl><span class=lnt>25
</span></span><span class=hl><span class=lnt>26
</span></span><span class=hl><span class=lnt>27
</span></span><span class=hl><span class=lnt>28
</span></span><span class=hl><span class=lnt>29
</span></span><span class=hl><span class=lnt>30
</span></span><span class=hl><span class=lnt>31
</span></span><span class=hl><span class=lnt>32
</span></span><span class=hl><span class=lnt>33
</span></span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=hl><span class=lnt>45
</span></span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Now that we have reviewed how data gets into the OpenTelemetry Collector through receivers, let&rsquo;s now take a look at how the Collector processes the received data.</p><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>As the <code>/etc/otelcol-contrib/config.yaml</code> is not complete, please <strong>do not</strong> attempt to restart the collector at this point.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><p><a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/README.md rel=external><strong>Processors</strong></a> are run on data between being received and being exported. Processors are optional though some are recommended. There are <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor rel=external><strong>a large number of processors</strong></a> included in the OpenTelemetry contrib Collector.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Processors fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Processors</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=batch-processor>Batch Processor</h2><p>By default, only the <strong>batch</strong> processor is enabled. This processor is used to batch up data before it is exported. This is useful for reducing the number of network calls made to exporters. For this workshop, we will inherit the following defaults which are hard-coded into the Collector:</p><ul><li><code>send_batch_size</code> (default = 8192): Number of spans, metric data points, or log records after which a batch will be sent regardless of the timeout. send_batch_size acts as a trigger and does not affect the size of the batch. If you need to enforce batch size limits sent to the next component in the pipeline see send_batch_max_size.</li><li><code>timeout</code> (default = 200ms): Time duration after which a batch will be sent regardless of size. If set to zero, send_batch_size is ignored as data will be sent immediately, subject to only send_batch_max_size.</li><li><code>send_batch_max_size</code> (default = 0): The upper limit of the batch size. 0 means no upper limit on the batch size. This property ensures that larger batches are split into smaller units. It must be greater than or equal to send_batch_size.</li></ul><p>For more information on the Batch processor, see the <a href=https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/batchprocessor/README.md rel=external><strong>Batch Processor documentation</strong></a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>The <strong>resourcedetection</strong> processor can be used to detect resource information from the host and append or override the resource value in telemetry data with this information.</p><p>By default, the hostname is set to the FQDN if possible, otherwise, the hostname provided by the OS is used as a fallback. This logic can be changed from using using the <code>hostname_sources</code> configuration option. To avoid getting the FQDN and use the hostname provided by the OS, we will set the <code>hostname_sources</code> to <code>os</code>.</p><div class=tab-panel data-tab-group=R-tabs-9d64d18461170d1cbbf8b077a96cf6cc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-fcd124944aacc461dd6325f0b4957dfa aria-expanded=true data-tab-item=R-tab-b892811c417d9a038325e7378a05c132 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9d64d18461170d1cbbf8b077a96cf6cc","R-tab-b892811c417d9a038325e7378a05c132")'>
<span class=tab-nav-text>System Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-fcd124944aacc461dd6325f0b4957dfa data-tab-item=R-tab-b892811c417d9a038325e7378a05c132 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span></span></span></code></pre></div></div></div></div></div><p>If the workshop instance is running on an AWS/EC2 instance we can gather the following tags from the EC2 metadata API (this is not available on other platforms).</p><ul><li><code>cloud.provider ("aws")</code></li><li><code>cloud.platform ("aws_ec2")</code></li><li><code>cloud.account.id</code></li><li><code>cloud.region</code></li><li><code>cloud.availability_zone</code></li><li><code>host.id</code></li><li><code>host.image.id</code></li><li><code>host.name</code></li><li><code>host.type</code></li></ul><p>We will create another processor to append these tags to our metrics.</p><div class=tab-panel data-tab-group=R-tabs-fa82cbe9a0d61655062e41759b1ea157><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-9fcb9d3c1e96e6baac312e952183ed5c aria-expanded=true data-tab-item=R-tab-cfb68818ad6985dd73e8c42294095dee class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fa82cbe9a0d61655062e41759b1ea157","R-tab-cfb68818ad6985dd73e8c42294095dee")'>
<span class=tab-nav-text>EC2 Resource Detection Processor Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-9fcb9d3c1e96e6baac312e952183ed5c data-tab-item=R-tab-cfb68818ad6985dd73e8c42294095dee class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-processors>OpenTelemetry Collector Processors</h1><h2 id=attributes-processor>Attributes Processor</h2><p>The attributes processor modifies attributes of a span, log, or metric. This processor also supports the ability to filter and match input data to determine if they should be included or excluded for specified actions.</p><p>It takes a list of actions that are performed in the order specified in the config. The supported actions are:</p><ul><li><code>insert</code>: Inserts a new attribute in input data where the key does not already exist.</li><li><code>update</code>: Updates an attribute in input data where the key does exist.</li><li><code>upsert</code>: Performs insert or update. Inserts a new attribute in input data where the key does not already exist and updates an attribute in input data where the key does exist.</li><li><code>delete</code>: Deletes an attribute from the input data.</li><li><code>hash</code>: Hashes (SHA1) an existing attribute value.</li><li><code>extract</code>: Extracts values using a regular expression rule from the input key to target keys specified in the rule. If a target key already exists, it will be overridden.</li></ul><p>We are going to create an attributes processor to <code>insert</code> a new attribute to all our host metrics called <code>participant.name</code> with a value of your name e.g. <code>marge_simpson</code>.</p><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>Ensure you replace <code>INSERT_YOUR_NAME_HERE</code> with your name and also ensure you <strong>do not</strong> use spaces in your name.</p></div></details><p>Later on in the workshop, we will use this attribute to filter our metrics in Splunk Observability Cloud.</p><div class=tab-panel data-tab-group=R-tabs-f17469645c978cceb0ba8bd9a672267c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3ea353b50bbea69c930ecef017d705a9 aria-expanded=true data-tab-item=R-tab-99b4d39895514cfa032ce15a26ea7099 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f17469645c978cceb0ba8bd9a672267c","R-tab-99b4d39895514cfa032ce15a26ea7099")'>
<span class=tab-nav-text>Attributes Processor Configuration</span></button></div><div class=tab-content-container><div id=R-tab-id-3ea353b50bbea69c930ecef017d705a9 data-tab-item=R-tab-99b4d39895514cfa032ce15a26ea7099 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span></span></span></code></pre></div></div></div></div></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Using connectors to gain internal insights</span></span></summary><div class=box-content><p>One of the most recent additions to the collector was the notion of a <a href=https://opentelemetry.io/docs/collector/configuration/#connectors rel=external><strong>connector</strong></a>, which allows you to join the output of one pipeline to the input of another pipeline.</p><p>An example of how this is beneficial is that some services emit metrics based on the amount of datapoints being exported, the number of logs containing an error status,
or the amount of data being sent from one deployment environment. The count connector helps address this for you out of the box.</p><h2 id=why-a-connector-instead-of-a-processor>Why a connector instead of a processor?</h2><p>A processor is limited in what additional data it can produce considering it has to pass on the data it has processed making it hard to expose additional information. Connectors do not have to emit the data they receive which means they provide an opportunity to create the insights we are after.</p><p>For example, a connector could be made to count the number of logs, metrics, and traces that do not have the deployment environment attribute.</p><p>A very simple example with the output of being able to break down data usage by deployment environment.</p><h2 id=considerations-with-connectors>Considerations with connectors</h2><p>A connector only accepts data exported from one pipeline and receiver by another pipeline, this means you may have to consider how you construct your collector config to take advantage of it.</p><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#connectors rel=external><strong>https://opentelemetry.io/docs/collector/configuration/#connectors</strong></a></li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector rel=external><strong>https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector</strong></a></li></ol></div></details><hr><h2 id=configuration-check-in>Configuration Check-in</h2><p>That&rsquo;s processors covered, let&rsquo;s check our configuration changes.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-b682d0b9625ab1520026ae529b66dc2e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d375022cb4f05dec84c7050bc390bb8c aria-expanded=true data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b682d0b9625ab1520026ae529b66dc2e","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-d375022cb4f05dec84c7050bc390bb8c data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=hl><span class=lnt> 69
</span></span><span class=hl><span class=lnt> 70
</span></span><span class=hl><span class=lnt> 71
</span></span><span class=hl><span class=lnt> 72
</span></span><span class=hl><span class=lnt> 73
</span></span><span class=hl><span class=lnt> 74
</span></span><span class=hl><span class=lnt> 75
</span></span><span class=hl><span class=lnt> 76
</span></span><span class=hl><span class=lnt> 77
</span></span><span class=hl><span class=lnt> 78
</span></span><span class=hl><span class=lnt> 79
</span></span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><p>An exporter, which can be push or pull-based, is how you send data to one or more backends/destinations. Exporters may support one or more data sources.</p><p>For this workshop, we will be using the <a href=https://opentelemetry.io/docs/specs/otel/protocol/exporter/ rel=external><strong>otlphttp</strong></a> exporter. The OpenTelemetry Protocol (OTLP) is a vendor-neutral, standardised protocol for transmitting telemetry data. The OTLP exporter sends data to a server that implements the OTLP protocol. The OTLP exporter supports both <a href=https://grpc.io/ rel=external><strong>gRPC</strong></a> and <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Overview rel=external><strong>HTTP</strong></a>/<a href=https://www.json.org/json-en.html rel=external><strong>JSON</strong></a> protocols.</p><pre class="mermaid align-center">
%%{
  init:{
    &#34;theme&#34;:&#34;base&#34;,
    &#34;themeVariables&#34;: {
      &#34;primaryColor&#34;: &#34;#ffffff&#34;,
      &#34;clusterBkg&#34;: &#34;#eff2fb&#34;,
      &#34;defaultLinkColor&#34;: &#34;#333333&#34;
    }
  }
}%%

flowchart LR;
    style Exporters fill:#e20082,stroke:#333,stroke-width:4px,color:#fff
    subgraph Collector
    A[OTLP] --&gt; M(Receivers)
    B[JAEGER] --&gt; M(Receivers)
    C[Prometheus] --&gt; M(Receivers)
    end
    subgraph Processors
    M(Receivers) --&gt; H(Filters, Attributes, etc)
    E(Extensions)
    end
    subgraph Exporters
    H(Filters, Attributes, etc) --&gt; S(OTLP)
    H(Filters, Attributes, etc) --&gt; T(JAEGER)
    H(Filters, Attributes, etc) --&gt; U(Prometheus)
    end
</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Exporters</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-exporters>OpenTelemetry Collector Exporters</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>To send metrics over HTTP to Splunk Observability Cloud, we will need to configure the <strong>otlphttp</strong> exporter.</p><p>Let&rsquo;s edit our <code>/etc/otelcol-contrib/config.yaml</code> file and configure the <strong>otlphttp</strong> exporter. Insert the following YAML under the <strong>exporters</strong> section, taking care to indent by two spaces e.g.</p><p>We will also change the verbosity of the logging exporter to prevent the disk from filling up. The default of <code>detailed</code> is very noisy.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=l>otlphttp/splunk:</span></span></span></code></pre></div><p>Next, we need to define the <code>metrics_endpoint</code> and configure the target URL.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with a Realm environment variable. We will reference that environment variable in our configuration file. Otherwise, you will need to create a new environment variable and set the Realm e.g.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>REALM</span><span class=o>=</span><span class=s2>&#34;us1&#34;</span></span></span></code></pre></div></div></details><p>The URL to use is <code>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</code>. (Splunk has Realms in key geographical locations around the world for data residency).</p><p>The <strong>otlphttp</strong> exporter can also be configured to send traces and logs by defining a target URL for <code>traces_endpoint</code> and <code>logs_endpoint</code> respectively. Configuring these is outside the scope of this workshop.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span></span></span></code></pre></div><p>By default, <code>gzip</code> compression is enabled for all endpoints. This can be disabled by setting <code>compression: none</code> in the exporter configuration. We will leave compression enabled for this workshop and accept the default as this is the most efficient way to send data.</p><p>To send metrics to Splunk Observability Cloud, we need to use an Access Token. This can be done by creating a new token in the Splunk Observability Cloud UI. For more information on how to create a token, see <a href=https://docs.splunk.com/Observability/admin/authentication-tokens/org-tokens.html rel=external>Create a token</a>. The token needs to be of type <strong>INGEST</strong>.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>If you are an attendee at a Splunk-hosted workshop, the instance you are using has already been configured with an Access Token (which has been set as an environment variable). We will reference that environment variable in our configuration file. Otherwise, you will need to create a new token and set it as an environment variable e.g.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ACCESS_TOKEN</span><span class=o>=</span>&lt;replace-with-your-token&gt;</span></span></code></pre></div></div></details><p>The token is defined in the configuration file by inserting <code>X-SF-TOKEN: ${env:ACCESS_TOKEN}</code> under a <code>headers:</code> section:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-TOKEN</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span></span></span></code></pre></div><h2 id=configuration-check-in>Configuration Check-in</h2><p>Now that we&rsquo;ve covered exporters, let&rsquo;s check our configuration changes:</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-34122797fd8a2d3df0206c213120e5ca><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1eae760e9e138bc1bda318803d0a1cdb aria-expanded=true data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-34122797fd8a2d3df0206c213120e5ca","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-1eae760e9e138bc1bda318803d0a1cdb data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=hl><span class=lnt> 83
</span></span><span class=hl><span class=lnt> 84
</span></span><span class=hl><span class=lnt> 85
</span></span><span class=hl><span class=lnt> 86
</span></span><span class=hl><span class=lnt> 87
</span></span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>X-SF-Token</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><p>Of course, you can easily configure the <code>metrics_endpoint</code> to point to any other solution that supports the <strong>OTLP</strong> protocol.</p><p>Next, we need to enable the receivers, processors and exporters we have just configured in the service section of the <code>config.yaml</code>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><p>The <strong>Service</strong> section is used to configure what components are enabled in the Collector based on the configuration found in the receivers, processors, exporters, and extensions sections.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>If a component is configured, but not defined within the <strong>Service</strong> section then it is <strong>not</strong> enabled.</p></div></details><p>The service section consists of three sub-sections:</p><ul><li>extensions</li><li>pipelines</li><li>telemetry</li></ul><p>In the default configuration, the extension section has been configured to enable <code>health_check</code>, <code>pprof</code> and <code>zpages</code>, which we configured in the Extensions module earlier.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></div><p>So lets configure our Metric Pipeline!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Service</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=hostmetrics-receiver>Hostmetrics Receiver</h2><p>If you recall from the Receivers portion of the workshop, we defined the <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/3-receivers/index.html#host-metrics-receiver><strong>Host Metrics Receiver</strong></a> to generate metrics about the host system, which are scraped from various sources. To enable the receiver, we must include the <code>hostmetrics</code> receiver in the metrics pipeline.</p><p>In the <code>metrics</code> pipeline, add <code>hostmetrics</code> to the metrics <code>receivers</code> section.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=prometheus-internal-receiver>Prometheus Internal Receiver</h2><p>Earlier in the workshop, we also renamed the <code>prometheus</code> receiver to reflect that is was collecting metrics internal to the collector, renaming it to <code>prometheus/internal</code>.</p><p>We now need to enable the <code>prometheus/internal</code> receiver under the metrics pipeline. Update the <code>receivers</code> section to include <code>prometheus/internal</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=resource-detection-processor>Resource Detection Processor</h2><p>We also added <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> processors so that the collector can capture the instance hostname and AWS/EC2 metadata. We now need to enable these two processors under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>resourcedetection/system</code> and <code>resourcedetection/ec2</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=attributes-processor>Attributes Processor</h2><p>Also in the Processors section of this workshop, we added the <code>attributes/conf</code> processor so that the collector will insert a new attribute called <code>participant.name</code> to all the metrics. We now need to enable this under the metrics pipeline.</p><p>Update the <code>processors</code> section to include <code>attributes/conf</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-service>OpenTelemetry Collector Service</h1><h2 id=otlp-http-exporter>OTLP HTTP Exporter</h2><p>In the Exporters section of the workshop, we configured the <code>otlphttp</code> exporter to send metrics to Splunk Observability Cloud. We now need to enable this under the metrics pipeline.</p><p>Update the <code>exporters</code> section to include <code>otlphttp/splunk</code> under the <code>metrics</code> pipeline:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class="line hl"><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug, otlphttp/splunk]</span></span></span></code></pre></div><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Observing the collector internals</span></span></summary><div class=box-content><p>The collector captures internal signals about its behavior this also includes additional signals from running components.
The reason for this is that components that make decisions about the flow of data need a way to surface that information
as metrics or traces.</p><h2 id=why-monitor-the-collector>Why monitor the collector?</h2><p>This is somewhat of a chicken and egg problem of, &ldquo;Who is watching the watcher?&rdquo;, but it is important that we can surface this information. Another interesting part of the collector&rsquo;s history is that it existed before the Go metrics&rsquo; SDK was considered stable so the collector exposes a Prometheus endpoint to provide this functionality for the time being.</p><h2 id=considerations>Considerations</h2><p>Monitoring the internal usage of each running collector in your organization can contribute a significant amount of new Metric Time Series (MTS). The Splunk distribution has curated these metrics for you and would be able to help forecast the expected increases.</p><h2 id=the-ninja-zone>The Ninja Zone</h2><p>To expose the internal observability of the collector, some additional settings can be adjusted:</p><div class=tab-panel data-tab-group=R-tabs-7ea576b3322eeb5b8924e9d74fd5a779><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-482696172e98bb385a6e67eab60018ff aria-expanded=true data-tab-item=R-tab-b7b7f11d9c9c56d1979ca775dec8b62b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7ea576b3322eeb5b8924e9d74fd5a779","R-tab-b7b7f11d9c9c56d1979ca775dec8b62b")'>
<span class=tab-nav-text>telemetry schema</span>
</button>
<button aria-controls=R-tab-id-2ccebeccca17f18454b43ccfcdc46157 aria-expanded=false data-tab-item=R-tab-55b005c9d9b0488c209e03663dcdc6fa class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7ea576b3322eeb5b8924e9d74fd5a779","R-tab-55b005c9d9b0488c209e03663dcdc6fa")'>
<span class=tab-nav-text>example-config.yml</span></button></div><div class=tab-content-container><div id=R-tab-id-482696172e98bb385a6e67eab60018ff data-tab-item=R-tab-b7b7f11d9c9c56d1979ca775dec8b62b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;info|warn|error&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>&lt;console|json&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_caller</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=l>&lt;true|false&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>error_output_paths</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>&lt;stdout|stderr&gt;, paths...]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>&lt;none|basic|normal|detailed&gt;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Address binds the promethues endpoint to scrape</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>&lt;hostname:port&gt;</span></span></span></code></pre></div></div></div><div id=R-tab-id-2ccebeccca17f18454b43ccfcdc46157 data-tab-item=R-tab-55b005c9d9b0488c209e03663dcdc6fa class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>telemetry</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>level</span><span class=p>:</span><span class=w> </span><span class=l>info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>encoding</span><span class=p>:</span><span class=w> </span><span class=l>json</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disable_stacktrace</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>initial_fields</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>instance.name</span><span class=p>:</span><span class=w> </span><span class=l>${env:INSTANCE}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>address</span><span class=p>:</span><span class=w> </span><span class=l>localhost:8888 </span></span></span></code></pre></div></div></div></div></div><h2 id=references>References</h2><ol><li><a href=https://opentelemetry.io/docs/collector/configuration/#service rel=external>https://opentelemetry.io/docs/collector/configuration/#service</a></li></ol></div></details><hr><h2 id=final-configuration>Final configuration</h2><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your final configuration</span></span></summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-954979d1719d5941e5b77a96d1224605><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2bb74009e8215b819571d3ef9e2eb1e4 aria-expanded=true data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-954979d1719d5941e5b77a96d1224605","R-tab-259fe82e12a866f01123927480c7851b")'>
<span class=tab-nav-text>config.yaml</span></button></div><div class=tab-content-container><div id=R-tab-id-2bb74009e8215b819571d3ef9e2eb1e4 data-tab-item=R-tab-259fe82e12a866f01123927480c7851b class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># To limit exposure to denial of service attacks, change the host in endpoints below from 0.0.0.0 to a specific network interface.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># See https://github.com/open-telemetry/opentelemetry-collector/blob/main/docs/security-best-practices.md#safeguards-against-denial-of-service-attacks</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>health_check</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>13133</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pprof</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>1777</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>cpu</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Disk I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>disk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># File System utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Memory utilization metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>memory</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Network interface I/O metrics &amp; TCP connection metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>network</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># CPU load metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>load</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Paging/Swap space utilization and I/O metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>paging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Process count metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Per process CPU, Memory and Disk I/O metrics. Disabled by default.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># process:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4317</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>4318</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>opencensus</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55678</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c># Collect own metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>prometheus/internal</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;otel-collector&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>targets</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s1>&#39;0.0.0.0:8888&#39;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jaeger</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>grpc</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_binary</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6832</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_compact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>6831</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>thrift_http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>14268</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>zipkin</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>9411</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>batch</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>system]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>system</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostname_sources</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>os]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resourcedetection/ec2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>detectors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>ec2]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/conf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>participant.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;INSERT_YOUR_NAME_HERE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>normal</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp/splunk</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics_endpoint</span><span class=p>:</span><span class=w> </span><span class=l>https://ingest.${env:REALM}.signalfx.com/v2/datapoint/otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>headers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>X-SF-Token</span><span class=p>:</span><span class=w> </span><span class=l>${env:ACCESS_TOKEN}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp, opencensus, jaeger, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>hostmetrics, otlp, opencensus, prometheus/internal]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch, resourcedetection/system, resourcedetection/ec2, attributes/conf]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug, otlphttp/splunk]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlp]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>batch]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>debug]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, pprof, zpages]</span></span></span></code></pre></td></tr></table></div></div></div></div></div></div></div></details><hr><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>It is recommended that you validate your configuration file before restarting the collector. You can do this by pasting the contents of your <code>config.yaml</code> file into <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>.</p><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><strong>Screenshot</strong></span><span class=badge-content style=background-color:green>OTelBin</span></span></summary><div class=box-content><p><a href=#R-image-b685092270758bdc6806b3c2ccd932ad class=lightbox-link><img alt=otelbin-validator class="lazy lightbox figure-image" loading=lazy src=../../images/otelbin.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b685092270758bdc6806b3c2ccd932ad><img alt=otelbin-validator class="lazy lightbox lightbox-image" loading=lazy src=../../images/otelbin.png></a></p></div></details></div></details><p>Now that we have a working configuration, let&rsquo;s start the collector and then check to see what <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/2-extensions/index.html#zpages>zPages</a> is reporting.</p><div class=tab-panel data-tab-group=R-tabs-f18f33a2d3251b6afb9aa00193b21c5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-160d529586e10e336a7dd22e309af2c9 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f18f33a2d3251b6afb9aa00193b21c5d","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-160d529586e10e336a7dd22e309af2c9 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>otelcol-contrib --config<span class=o>=</span>file:/etc/otelcol-contrib/config.yaml</span></span></code></pre></div></div></div></div></div><p>Open up zPages in your browser: <a href=http://localhost:55679/debug/pipelinez rel=external><strong>http://localhost:55679/debug/pipelinez</strong></a> (change <code>localhost</code> to reflect your own environment).
<a href=#R-image-5a9bf4723dd56102356e8bf615d73076 class=lightbox-link><img alt=pipelinez-full-config class="lazy lightbox figure-image" loading=lazy src=../../images/pipelinez-full-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5a9bf4723dd56102356e8bf615d73076><img alt=pipelinez-full-config class="lazy lightbox lightbox-image" loading=lazy src=../../images/pipelinez-full-config.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=data-visualisations>Data Visualisations</h1><h2 id=splunk-observability-cloud>Splunk Observability Cloud</h2><p>Now that we have configured the OpenTelemetry Collector to send metrics to Splunk Observability Cloud, let&rsquo;s take a look at the data in Splunk Observability Cloud. If you have not received an invite to Splunk Observability Cloud, your instructor will provide you with login credentials.</p><p>Before that, let&rsquo;s make things a little more interesting and run a stress test on the instance. This in turn will light up the dashboards.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install stress
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span> stress -c <span class=m>2</span> -t 40<span class=p>;</span> stress -d <span class=m>5</span> -t 40<span class=p>;</span> stress -m <span class=m>20</span> -t 40<span class=p>;</span> <span class=k>done</span></span></span></code></pre></div><p>Once you are logged into Splunk Observability Cloud, using the left-hand navigation, navigate to <strong>Dashboards</strong> from the main menu. This will take you to the Teams view. At the top of this view click on <strong>All Dashboards</strong> :</p><p><a href=#R-image-6ecf7bba189f2707f834ab8695c58b6b class=lightbox-link><img alt=menu-dashboards class="lazy lightbox figure-image" loading=lazy src=../images/menu-dashboards.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ecf7bba189f2707f834ab8695c58b6b><img alt=menu-dashboards class="lazy lightbox lightbox-image" loading=lazy src=../images/menu-dashboards.png></a></p><p>In the search box, search for <strong>OTel Contrib</strong>:</p><p><a href=#R-image-c1580bc1bb2091aa652093d41d8bc578 class=lightbox-link><img alt=search-dashboards class="lazy lightbox figure-image" loading=lazy src=../images/search-dashboards.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c1580bc1bb2091aa652093d41d8bc578><img alt=search-dashboards class="lazy lightbox lightbox-image" loading=lazy src=../images/search-dashboards.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>If the dashboard does not exist, then your instructor will be able to quickly add it. If you are not attending a Splunk hosted version of this workshop then the Dashboard Group to import can be found at the bottom of this page.</p></div></details><p>Click on the <strong>OTel Contrib Dashboard</strong> dashboard to open it, next click in the <strong>Participant Name</strong> box, at the top of the dashboard, and select the name you configured for <code>participant.name</code> in the <code>config.yaml</code> in the drop-down list or start typing the name to search for it:</p><p><a href=#R-image-696e156bc5b4bd465c59da049af5ddfe class=lightbox-link><img alt=select-conf-attendee-name class="lazy lightbox figure-image" loading=lazy src=../images/select-participant-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-696e156bc5b4bd465c59da049af5ddfe><img alt=select-conf-attendee-name class="lazy lightbox lightbox-image" loading=lazy src=../images/select-participant-name.png></a></p><p>You can now see the host metrics for the host upon which you configured the OpenTelemetry Collector.</p><p><a href=#R-image-89ca019451a9ba59c9436c0589ccd794 class=lightbox-link><img alt=participant-dashboard class="lazy lightbox figure-image" loading=lazy src=../images/participant-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-89ca019451a9ba59c9436c0589ccd794><img alt=participant-dashboard class="lazy lightbox lightbox-image" loading=lazy src=../images/participant-dashboard.png></a></p><details open class="box cstyle attachments info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Download Dashboard Group JSON for importing</summary><div class=box-content><ul><li><a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/7-visualisation/OpenTelemetry-Contrib-Dashboard-Group.json>OpenTelemetry-Contrib-Dashboard-Group.json</a> (40 KB)</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=developing-a-custom-component>Developing a custom component</h2><p>Building a component for the Open Telemetry Collector requires three key parts:</p><ol><li>The Configuration - <em>What values are exposed to the user to configure</em></li><li>The Factory - <em>Make the component using the provided values</em></li><li>The Business Logic - <em>What the component needs to do</em></li></ol><p>For this, we will use the example of building a component that works with Jenkins so that we can track important DevOps metrics of our project(s).</p><p>The metrics we are looking to measure are:</p><ol><li>Lead time for changes - <em>&ldquo;How long it takes for a commit to get into production&rdquo;</em></li><li>Change failure rate - <em>&ldquo;The percentage of deployments causing a failure in production&rdquo;</em></li><li>Deployment frequency - <em>&ldquo;How often a [team] successfully releases to production&rdquo;</em></li><li>Mean time to recover - <em>&ldquo;How long does it take for a [team] to recover from a failure in production&rdquo;</em></li></ol><p>These indicators were identified Google&rsquo;s DevOps Research and Assesment (DORA)[^1] team to help
show performance of a software development team. The reason for choosing <em>Jenkins CI</em> is that we remain in the same Open Source Software ecosystem which we can serve as the example for the vendor managed CI tools to adopt in future.</p><h2 id=instrument-vs-component>Instrument Vs Component</h2><p>There is something to consider when improving level of Observability within your organisation
since there are some trade offs that get made.</p><table><thead><tr><th></th><th>Pros</th><th>Cons</th></tr></thead><tbody><tr><td><strong>(Auto) Instrumented</strong></td><td>Does not require an external API to be monitored in order to observe the system.</td><td>Changing instrumentation requires changes to the project.</td></tr><tr><td></td><td>Gives system owners/developers to make changes in their observability.</td><td>Requires additional runtime dependancies.</td></tr><tr><td></td><td>Understands system context and can corrolate captured data with <em>Exemplars</em>.</td><td>Can impact performance of the system.</td></tr><tr><td><strong>Component</strong></td><td>- Changes to data names or semantics can be rolled out independently of the system&rsquo;s release cycle.</td><td>Breaking API changes require a coordinated release between system and collector.</td></tr><tr><td></td><td>Updating/extending data collected is a seemless user facing change.</td><td>Captured data semantics can unexpectedly break that does not align with a new system release.</td></tr><tr><td></td><td>Does not require the supporting teams to have a deep understanding of observability practice.</td><td>Strictly external / exposed information can be surfaced from the system.</td></tr></tbody></table><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 8. Develop</h1><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=project-setup-hahahugoshortcode188s0hbhb>Project Setup <span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja</strong></span></span></h2><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The time to finish this section of the workshop can vary depending on experience.</p><p>A complete solution can be found <a href=https://github.com/splunk/collector-workshop-example rel=external><strong>here</strong></a> in case you&rsquo;re stuck or want to follow
along with the instructor.</p></div></details><p>To get started developing the new <em>Jenkins CI</em> receiver, we first need to set up a Golang project.
The steps to create your new Golang project is:</p><ol><li>Create a new directory named <code>${HOME}/go/src/jenkinscireceiver</code> and change into it<ol><li>The actual directory name or location is not strict, you can choose your own development directory to make it in.</li></ol></li><li>Initialize the golang module by going <code>go mod init splunk.conf/workshop/example/jenkinscireceiver</code><ol><li>This will create a file named <code>go.mod</code> which is used to track our direct and indirect dependencies</li><li>Eventually, there will be a <code>go.sum</code> which is the checksum value of the dependencies being imported.</li></ol></li></ol><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<span class="badge cstyle default badge-with-title"><span class=badge-title><i class="fa-fw fas fa-check"></i> <strong>Check-in</strong></span><span class=badge-content style=background-color:green>Review your go.mod</span></span></summary><div class=box-content><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>module splunk.conf/workshop/example/jenkinscireceiver
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>go 1.20</span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-configuration>Building The Configuration</h2><p>The configuration portion of the component is how the user is able to have their inputs over the component,
so the values that is used for the configuration need to be:</p><ol><li>Intuitive for users to understand what that field controls</li><li>Be explicit in what is required and what is optional</li><li>Reuse common names and fields</li><li>Keep the options simple</li></ol><div class=tab-panel data-tab-group=R-tabs-21ab0a098e6c19520fd0bee1ff7ac300><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-0006519630ae9f520741f7b66d416319 aria-expanded=true data-tab-item=R-tab-ea614e7854d52692156e1a019727d7ea class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-21ab0a098e6c19520fd0bee1ff7ac300","R-tab-ea614e7854d52692156e1a019727d7ea")'>
<span class=tab-nav-text>bad config</span>
</button>
<button aria-controls=R-tab-id-32773c1fbe54e826e4643417f388523a aria-expanded=false data-tab-item=R-tab-c4230d82955d70d5d9d9c8cd4bb074a6 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-21ab0a098e6c19520fd0bee1ff7ac300","R-tab-c4230d82955d70d5d9d9c8cd4bb074a6")'>
<span class=tab-nav-text>good config</span></button></div><div class=tab-content-container><div id=R-tab-id-0006519630ae9f520741f7b66d416319 data-tab-item=R-tab-ea614e7854d52692156e1a019727d7ea class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_addr</span><span class=p>:</span><span class=w> </span><span class=l>hostname</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>jenkins_server_api_port</span><span class=p>:</span><span class=w> </span><span class=m>8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>filter_builds_by</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>my-awesome-build</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>status</span><span class=p>:</span><span class=w> </span><span class=l>amber</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>track</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>values</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w> </span><span class=kc>yes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w> </span><span class=kc>no</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w> </span><span class=kc>no</span></span></span></code></pre></div></div></div><div id=R-tab-id-32773c1fbe54e826e4643417f388523a data-tab-item=R-tab-c4230d82955d70d5d9d9c8cd4bb074a6 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Required Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>http://my-jenkins-server:8089</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>authenticator</span><span class=p>:</span><span class=w> </span><span class=l>basicauth/jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Optional Values</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.1</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.2</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.3</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>example.metric.4</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div></div></div></div></div><p>The bad configuration highlights how doing the opposite of the recommendations of configuration practices impacts the usability
of the component. It doesn&rsquo;t make it clear what field values should be, it includes features that can be pushed to existing processors,
and the field naming is not consistent with other components that exist in the collector.</p><p>The good configuration keeps the required values simple, reuses field names from other components, and ensures the component focuses on
just the interaction between Jenkins and the collector.</p><p>The code tab shows how much is required to be added by us and what is already provided for us by shared libraries within the collector.
These will be explained in more detail once we get to the business logic. The configuration should start off small and will change
once the business logic has started to include additional features that is needed.</p><h2 id=write-the-code>Write the code</h2><p>In order to implement the code needed for the configuration, we are going to create a new file named <code>config.go</code> with the following content:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values</span>
</span></span><span class=line><span class=cl>    <span class=c1>// that are commonly shared across all HTTP interactions</span>
</span></span><span class=line><span class=cl>    <span class=c1>// performed by the collector.</span>
</span></span><span class=line><span class=cl>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule </span>
</span></span><span class=line><span class=cl>    <span class=c1>// how often to check for updates to builds.</span>
</span></span><span class=line><span class=cl>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics</span>
</span></span><span class=line><span class=cl>    <span class=c1>// that can be configured.</span>
</span></span><span class=line><span class=cl>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=component-review>Component Review</h2><p>To recap the type of component we will need to capture metrics from Jenkins:</p><div class=tab-panel data-tab-group=R-tabs-4a570a06d94d28251e4e09e761faf164><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-b84d5637fa4f4bb5766ffe2a4d748f8e aria-expanded=true data-tab-item=R-tab-63e4e92bb7d207ca577b11c07f827279 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4a570a06d94d28251e4e09e761faf164","R-tab-63e4e92bb7d207ca577b11c07f827279")'>
<span class=tab-nav-text>Extension</span>
</button>
<button aria-controls=R-tab-id-f72483a93525cdfa622ea80605e0fa80 aria-expanded=false data-tab-item=R-tab-a9d093d11bc6e98b0c8e586ffa545c85 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4a570a06d94d28251e4e09e761faf164","R-tab-a9d093d11bc6e98b0c8e586ffa545c85")'>
<span class=tab-nav-text>Receiver</span>
</button>
<button aria-controls=R-tab-id-27a53ff6a550d109a2d98e8780117c93 aria-expanded=false data-tab-item=R-tab-e22b6495595f2c4ad67a830d1be05c6e class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4a570a06d94d28251e4e09e761faf164","R-tab-e22b6495595f2c4ad67a830d1be05c6e")'>
<span class=tab-nav-text>Processor</span>
</button>
<button aria-controls=R-tab-id-5a4505fa4e04511e7f34a23beb91052e aria-expanded=false data-tab-item=R-tab-d353b8720fcbebe4385ef7a23a43aa22 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4a570a06d94d28251e4e09e761faf164","R-tab-d353b8720fcbebe4385ef7a23a43aa22")'>
<span class=tab-nav-text>Exporter</span>
</button>
<button aria-controls=R-tab-id-358f95914e83fe42568a44c73a640338 aria-expanded=false data-tab-item=R-tab-654b8c5e6c23b010e809ba5bb38a47cf class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4a570a06d94d28251e4e09e761faf164","R-tab-654b8c5e6c23b010e809ba5bb38a47cf")'>
<span class=tab-nav-text><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-user-ninja"></i></span><span class=badge-content><strong>Ninja:</strong> Connectors</span></span></span></button></div><div class=tab-content-container><div id=R-tab-id-b84d5637fa4f4bb5766ffe2a4d748f8e data-tab-item=R-tab-63e4e92bb7d207ca577b11c07f827279 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>The business use case an extension helps solves for are:</p><ol><li>Having shared functionality that requires runtime configuration</li><li>Indirectly helps with observing the runtime of the collector</li></ol><p>See <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/2-extensions/index.html><strong>Extensions Overview</strong></a> for more details.</p></div></div><div id=R-tab-id-f72483a93525cdfa622ea80605e0fa80 data-tab-item=R-tab-a9d093d11bc6e98b0c8e586ffa545c85 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a receiver solves for:</p><ul><li>Fetching data from a remote source</li><li>Receiving data from remote source(s)</li></ul><p>This is commonly referred to <em>pull</em> vs <em>push</em> based data collection, and you read more about the details in the <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/3-receivers/index.html>Receiver Overview</a>.</p></div></div><div id=R-tab-id-27a53ff6a550d109a2d98e8780117c93 data-tab-item=R-tab-e22b6495595f2c4ad67a830d1be05c6e class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case a processor solves for is:</p><ul><li>Adding or removing data, fields, or values</li><li>Observing and making decisions on the data</li><li>Buffering, queueing, and reordering</li></ul><p>The thing to keep in mind is the data type flowing through a processor needs to forward
the same data type to its downstream components. Read through <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/4-processors/index.html>Processor Overview</a> for the details.</p></div></div><div id=R-tab-id-5a4505fa4e04511e7f34a23beb91052e data-tab-item=R-tab-d353b8720fcbebe4385ef7a23a43aa22 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The business use case an exporter solves for:</p><ul><li>Send the data to a tool, service, or storage</li></ul><p>The OpenTelemetry collector does not want to be &ldquo;backend&rdquo;, an all-in-one observability suite, but rather
keep to the principles that founded OpenTelemetry to begin with; A vendor agnostic Observability for all.
To help revisit the details, please read through <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/5-exporters/index.html><strong>Exporter Overview</strong></a>.</p></div></div><div id=R-tab-id-358f95914e83fe42568a44c73a640338 data-tab-item=R-tab-654b8c5e6c23b010e809ba5bb38a47cf class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>This is a component type that was missed in the workshop since it is a relatively new addition to the collector, but the best way to think about a connector is that it is like a processor that allows it to be used across different telemetry types and pipelines. Meaning that a connector can accept data as logs, and output metrics, or accept metrics from one pipeline and provide metrics on the data it has observed.</p><p>The business case that a connector solves for:</p><ul><li>Converting from different telemetry types<ul><li>logs to metrics</li><li>traces to metrics</li><li>metrics to logs</li></ul></li><li>Observing incoming data and producing its own data<ul><li>Accepting metrics and generating analytical metrics of the data.</li></ul></li></ul><p>There was a brief overview within the <strong>Ninja</strong> section as part of the <a href=/observability-workshop/en/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/4-processors/index.html>Processor Overview</a>,
and be sure what the project for updates for new connector components.</p></div></div></div></div><p>From the component overviews, it is clear that developing a pull-based receiver for Jenkins.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h3 id=designing-the-metrics>Designing The Metrics</h3><p>To help define and export the metrics captured by our receiver, we will be using, <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/cmd/mdatagen rel=external><strong>mdatagen</strong></a>, a tool developed for the collector that turns YAML defined metrics into code.</p><div class=tab-panel data-tab-group=R-tabs-7f5f83e996ad24b16527a610950e3f05><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1743be2a97a96da7b8a879a90e2f8041 aria-expanded=true data-tab-item=R-tab-b1d90847e9ac9d08a6205ad8f09fd5a9 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7f5f83e996ad24b16527a610950e3f05","R-tab-b1d90847e9ac9d08a6205ad8f09fd5a9")'>
<span class=tab-nav-text>metadata.yaml</span>
</button>
<button aria-controls=R-tab-id-186f4b7179d607fb9222736ece3fb920 aria-expanded=false data-tab-item=R-tab-fa95711d3528c54a10a4bd5a3303bf8c class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7f5f83e996ad24b16527a610950e3f05","R-tab-fa95711d3528c54a10a4bd5a3303bf8c")'>
<span class=tab-nav-text>gen.go</span></button></div><div class=tab-content-container><div id=R-tab-id-1743be2a97a96da7b8a879a90e2f8041 data-tab-item=R-tab-b1d90847e9ac9d08a6205ad8f09fd5a9 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Type defines the name to reference the component</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># in the configuration file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>jenkins</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Status defines the component type and the stability level</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>class</span><span class=p>:</span><span class=w> </span><span class=l>receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>development</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>metrics]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Attributes are the expected fields reported</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># with the exported values.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.name</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The name of the associated Jenkins job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>job.status</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Shows if the job had passed, or failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>string</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>success</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>unknown</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Metrics defines all the pontentially exported values from this receiver. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.jobs.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Provides a count of the total number of configured jobs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;{Count}&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.duration</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>Show the duration of the job</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>jenkins.job.commit_delta</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=l>The calculation difference of the time job was finished minus commit timestamp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>unit</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;s&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>gauge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value_type</span><span class=p>:</span><span class=w> </span><span class=l>int</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>job.status</span></span></span></code></pre></div></div></div><div id=R-tab-id-186f4b7179d607fb9222736ece3fb920 data-tab-item=R-tab-fa95711d3528c54a10a4bd5a3303bf8c class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// To generate the additional code needed to capture metrics, </span>
</span></span><span class=line><span class=cl><span class=c1>// the following command to be run from the shell:</span>
</span></span><span class=line><span class=cl><span class=c1>//  go generate -x ./...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//go:generate go run github.com/open-telemetry/opentelemetry-collector-contrib/cmd/mdatagen@v0.80.0 metadata.yaml</span>
</span></span><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// There is no code defined within this file.</span></span></span></code></pre></div></div></div></div></div><p>Create these files within the project folder before continuing onto the next section.</p><h2 id=building-the-factory>Building The Factory</h2><p>The Factory is a software design pattern that effectively allows for an object, in this case a <code>jenkinscireceiver</code>, to be created dynamically with the provided configuration. To use a more real-world example, it would be going to a phone store, asking for a phone
that matches your exact description, and then providing it to you.</p><p>Run the following command <code>go generate -x ./...</code> , it will create a new folder, <code>jenkinscireceiver/internal/metadata</code>, that contains all code required to export the defined metrics. The required code is:</p><div class=tab-panel data-tab-group=R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a2afaa25ba9b8f10927cd44c8f5a6007 aria-expanded=true data-tab-item=R-tab-5aa589ba734396f6c25f293ea24fc1d0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22","R-tab-5aa589ba734396f6c25f293ea24fc1d0")'>
<span class=tab-nav-text>factory.go</span>
</button>
<button aria-controls=R-tab-id-d563960aa1a792cee9cdf5eb77f1d56f aria-expanded=false data-tab-item=R-tab-b4bda758a2aef091432646c354b4dc59 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22","R-tab-b4bda758a2aef091432646c354b4dc59")'>
<span class=tab-nav-text>config.go</span>
</button>
<button aria-controls=R-tab-id-ac6589d0108b8fc5c96581472e1c4c52 aria-expanded=false data-tab-item=R-tab-aafe740d5e6d08f015cd912160286b41 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22","R-tab-aafe740d5e6d08f015cd912160286b41")'>
<span class=tab-nav-text>scraper.go</span>
</button>
<button aria-controls=R-tab-id-1150e9e32914b7b03820324c038af25e aria-expanded=false data-tab-item=R-tab-6f5be00aa7a4344a722aa8fc34d13ab9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22","R-tab-6f5be00aa7a4344a722aa8fc34d13ab9")'>
<span class=tab-nav-text>build-config.yaml</span>
</button>
<button aria-controls=R-tab-id-a663a3045020b5dfe2325279ef1d4ed0 aria-expanded=false data-tab-item=R-tab-5d31a174f263a0433738ed5261095688 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-694d0f75508b4bdd5cb6c4d8b7116b22","R-tab-5d31a174f263a0433738ed5261095688")'>
<span class=tab-nav-text>project layout</span></button></div><div class=tab-content-container><div id=R-tab-id-a2afaa25ba9b8f10927cd44c8f5a6007 data-tab-item=R-tab-5aa589ba734396f6c25f293ea24fc1d0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>NewFactory</span><span class=p>()</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>Factory</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>receiver</span><span class=p>.</span><span class=nf>NewFactory</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>newDefaultConfig</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>receiver</span><span class=p>.</span><span class=nf>WithMetrics</span><span class=p>(</span><span class=nx>newMetricsReceiver</span><span class=p>,</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsStability</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newMetricsReceiver</span><span class=p>(</span><span class=nx>_</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>,</span> <span class=nx>cfg</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>consumer</span> <span class=nx>consumer</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>)</span> <span class=p>(</span><span class=nx>receiver</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Convert the configuration into the expected type</span>
</span></span><span class=line><span class=cl>    <span class=nx>conf</span><span class=p>,</span> <span class=nx>ok</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.(</span><span class=o>*</span><span class=nx>Config</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>!</span><span class=nx>ok</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;can not convert config&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nx>sc</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>conf</span><span class=p>,</span> <span class=nx>set</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>nil</span><span class=p>,</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraperControllerReceiver</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=o>&amp;</span><span class=nx>conf</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>set</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>consumer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>AddScraper</span><span class=p>(</span><span class=nx>sc</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div id=R-tab-id-d563960aa1a792cee9cdf5eb77f1d56f data-tab-item=R-tab-b4bda758a2aef091432646c354b4dc59 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/config/confighttp&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>Config</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// HTTPClientSettings contains all the values</span>
</span></span><span class=line><span class=cl>    <span class=c1>// that are commonly shared across all HTTP interactions</span>
</span></span><span class=line><span class=cl>    <span class=c1>// performed by the collector.</span>
</span></span><span class=line><span class=cl>    <span class=nx>confighttp</span><span class=p>.</span><span class=nx>HTTPClientSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ScraperControllerSettings will allow us to schedule </span>
</span></span><span class=line><span class=cl>    <span class=c1>// how often to check for updates to builds.</span>
</span></span><span class=line><span class=cl>    <span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>ScraperControllerSettings</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl>    <span class=c1>// MetricsBuilderConfig contains all the metrics</span>
</span></span><span class=line><span class=cl>    <span class=c1>// that can be configured.</span>
</span></span><span class=line><span class=cl>    <span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span> <span class=s>`mapstructure:&#34;,squash&#34;`</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newDefaultConfig</span><span class=p>()</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Config</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>&amp;</span><span class=nx>Config</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>ScraperControllerSettings</span><span class=p>:</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewDefaultScraperControllerSettings</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=nx>HTTPClientSettings</span><span class=p>:</span>        <span class=nx>confighttp</span><span class=p>.</span><span class=nf>NewDefaultHTTPClientSettings</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=nx>MetricsBuilderConfig</span><span class=p>:</span>      <span class=nx>metadata</span><span class=p>.</span><span class=nf>DefaultMetricsBuilderConfig</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div id=R-tab-id-ac6589d0108b8fc5c96581472e1c4c52 data-tab-item=R-tab-aafe740d5e6d08f015cd912160286b41 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a our scraper with our values </span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// To be filled in later</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span> <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>pmetrics</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div id=R-tab-id-1150e9e32914b7b03820324c038af25e data-tab-item=R-tab-6f5be00aa7a4344a722aa8fc34d13ab9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nn>---</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>dist</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>otelcol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Conf workshop collector&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>output_path</span><span class=p>:</span><span class=w> </span><span class=l>./dist</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class=l>v0.0.0-experimental</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/basicauthextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/extension/healthcheckextension v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/receiver/otlpreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/jaegerreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>github.com/open-telemetry/opentelemetry-collector-contrib/receiver/prometheusreceiver v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>splunk.conf/workshop/example/jenkinscireceiver v0.0.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>./jenkinscireceiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/processor/batchprocessor v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/loggingexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>gomod</span><span class=p>:</span><span class=w> </span><span class=l>go.opentelemetry.io/collector/exporter/otlphttpexporter v0.80.0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This replace is a go directive that allows for redefine</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># where to fetch the code to use since the default would be from a remote project.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>replaces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span>- <span class=l>splunk.conf/workshop/example/jenkinscireceiver =&gt; ./jenkinscireceiver</span></span></span></code></pre></div></div></div><div id=R-tab-id-a663a3045020b5dfe2325279ef1d4ed0 data-tab-item=R-tab-5d31a174f263a0433738ed5261095688 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>â”œâ”€â”€ build-config.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ jenkinscireceiver
</span></span><span class=line><span class=cl>    â”œâ”€â”€ go.mod
</span></span><span class=line><span class=cl>    â”œâ”€â”€ config.go
</span></span><span class=line><span class=cl>    â”œâ”€â”€ factory.go
</span></span><span class=line><span class=cl>    â”œâ”€â”€ scraper.go
</span></span><span class=line><span class=cl>    â””â”€â”€ internal
</span></span><span class=line><span class=cl>      â””â”€â”€ metadata</span></span></code></pre></div></div></div></div></div><p>Once you have written these files into the project with the expected contents run, <code>go mod tidy</code>, which will fetch all the remote dependencies and update <code>go.mod</code> and generate the <code>go.sum</code> files.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=opentelemetry-collector-development>OpenTelemetry Collector Development</h1><h2 id=building-the-business-logic>Building The Business Logic</h2><p>At this point, we have a custom component that currently does nothing so we need to add in the required
logic to capture this data from Jenkins.</p><p>From this point, the steps that we need to take are:</p><ol><li>Create a client that connect to Jenkins</li><li>Capture all the configured jobs</li><li>Report the status of the last build for the configured job</li><li>Calculate the time difference between commit timestamp and job completion.</li></ol><p>The changes will be made to <code>scraper.go</code>.</p><div class=tab-panel data-tab-group=R-tabs-6d90183ab52fda6549a54d876fa77aba><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-613fe4051ab135915b69bf280fe116c4 aria-expanded=true data-tab-item=R-tab-e6caaeba69313021097a6d23f5219e15 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6d90183ab52fda6549a54d876fa77aba","R-tab-e6caaeba69313021097a6d23f5219e15")'>
<span class=tab-nav-text><ol><li>Add Jenkins client</li></ol></span></button>
<button aria-controls=R-tab-id-fb18b0ab55006ddc8037be17cf67cd46 aria-expanded=false data-tab-item=R-tab-577ba80910e4dfcb4e3e9abe5506eace class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-6d90183ab52fda6549a54d876fa77aba","R-tab-577ba80910e4dfcb4e3e9abe5506eace")'>
<span class=tab-nav-text><ol start=2><li>Capture all configured jobs</li></ol></span></button>
<button aria-controls=R-tab-id-a8ae4129ed65ad1bcaf26dc7843f05ac aria-expanded=false data-tab-item=R-tab-244ea624a2547544c8f517690b672fd5 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-6d90183ab52fda6549a54d876fa77aba","R-tab-244ea624a2547544c8f517690b672fd5")'>
<span class=tab-nav-text><ol start=3><li>Report the status of each job</li></ol></span></button>
<button aria-controls=R-tab-id-49fda1740c8367a808e234e988eff74f aria-expanded=false data-tab-item=R-tab-938c78fab74f4685403ec8d68561f6d1 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-6d90183ab52fda6549a54d876fa77aba","R-tab-938c78fab74f4685403ec8d68561f6d1")'>
<span class=tab-nav-text><ol start=4><li>Report the delta</li></ol></span></button></div><div class=tab-content-container><div id=R-tab-id-613fe4051ab135915b69bf280fe116c4 data-tab-item=R-tab-e6caaeba69313021097a6d23f5219e15 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>To be able to connect to the Jenkins server, we will be using the package,
<a href=https://pkg.go.dev/github.com/yosida95/golang-jenkins rel=external>&ldquo;github.com/yosida95/golang-jenkins&rdquo;</a>,
which provides the functionality required to read data from the jenkins server.</p><p>Then we are going to utilise some of the helper functions from the,
<a href=https://pkg.go.dev/go.opentelemetry.io/collector/receiver/scraperhelper rel=external>&ldquo;go.opentelemetry.io/collector/receiver/scraperhelper&rdquo;</a> ,
library to create a start function so that we can connect to the Jenkins server once component has finished starting.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kn>package</span> <span class=nx>jenkinscireceiver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;context&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nx>jenkins</span> <span class=s>&#34;github.com/yosida95/golang-jenkins&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/component&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/pdata/pmetric&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s>&#34;go.opentelemetry.io/collector/receiver/scraperhelper&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s>&#34;splunk.conf/workshop/example/jenkinscireceiver/internal/metadata&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>type</span> <span class=nx>scraper</span> <span class=kd>struct</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>mb</span>     <span class=o>*</span><span class=nx>metadata</span><span class=p>.</span><span class=nx>MetricsBuilder</span>
</span></span><span class=line><span class=cl>    <span class=nx>client</span> <span class=o>*</span><span class=nx>jenkins</span><span class=p>.</span><span class=nx>Jenkins</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=nf>newScraper</span><span class=p>(</span><span class=nx>cfg</span> <span class=o>*</span><span class=nx>Config</span><span class=p>,</span> <span class=nx>set</span> <span class=nx>receiver</span><span class=p>.</span><span class=nx>CreateSettings</span><span class=p>)</span> <span class=p>(</span><span class=nx>scraperhelper</span><span class=p>.</span><span class=nx>Scraper</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>scraper</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>mb</span> <span class=p>:</span> <span class=nx>metadata</span><span class=p>.</span><span class=nf>NewMetricsBuilder</span><span class=p>(</span><span class=nx>cfg</span><span class=p>.</span><span class=nx>MetricsBuilderConfig</span><span class=p>,</span> <span class=nx>set</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>NewScraper</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=nx>metadata</span><span class=p>.</span><span class=nx>Type</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>scrape</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=nx>scraperhelper</span><span class=p>.</span><span class=nf>WithStart</span><span class=p>(</span><span class=kd>func</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>,</span> <span class=nx>h</span> <span class=nx>component</span><span class=p>.</span><span class=nx>Host</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nx>client</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>cfg</span><span class=p>.</span><span class=nf>ToClient</span><span class=p>(</span><span class=nx>h</span><span class=p>,</span> <span class=nx>set</span><span class=p>.</span><span class=nx>TelemetrySettings</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=c1>// The collector provides a means of injecting authentication</span>
</span></span><span class=line><span class=cl>            <span class=c1>// on our behalf, so this will ignore the libraries approach</span>
</span></span><span class=line><span class=cl>            <span class=c1>// and use the configured http client with authentication.</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span> <span class=p>=</span> <span class=nx>jenkins</span><span class=p>.</span><span class=nf>NewJenkins</span><span class=p>(</span><span class=kc>nil</span><span class=p>,</span> <span class=nx>cfg</span><span class=p>.</span><span class=nx>Endpoint</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>SetHTTPClient</span><span class=p>(</span><span class=nx>client</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nf>NewMetrics</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><p>This finishes all the setup code that is required in order to initialise a Jenkins receiver.</p></div></div><div id=R-tab-id-fb18b0ab55006ddc8037be17cf67cd46 data-tab-item=R-tab-577ba80910e4dfcb4e3e9abe5506eace class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>From this point on, we will be focuses on the <code>scrape</code> method that has been waiting to be filled in.
This method will be run on each interval that is configured within the configuration (by default, every minute).</p><p>The reason we want to capture the number of jobs configured so we can see the growth of our Jenkins server,
and measure of many projects have onboarded. To do this we will call the jenkins client to list all jobs,
and if it reports an error, return that with no metrics, otherwise, emit the data from the metric builder.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure</span>
</span></span><span class=line><span class=cl>    <span class=c1>// all captured data points within this scrape have the same value. </span>
</span></span><span class=line><span class=cl>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// To be filled in</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div id=R-tab-id-a8ae4129ed65ad1bcaf26dc7843f05ac data-tab-item=R-tab-244ea624a2547544c8f517690b672fd5 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>In the last step, we were able to capture all jobs ands report the number of jobs
there was. Within this step, we are going to examine each job and use the report values
to capture metrics.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure</span>
</span></span><span class=line><span class=cl>    <span class=c1>// all captured data points within this scrape have the same value. </span>
</span></span><span class=line><span class=cl>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// This will check the result of the job, however,</span>
</span></span><span class=line><span class=cl>        <span class=c1>// since the only defined attributes are </span>
</span></span><span class=line><span class=cl>        <span class=c1>// `success`, `failure`, and `unknown`. </span>
</span></span><span class=line><span class=cl>        <span class=c1>// it is assume that anything did not finish </span>
</span></span><span class=line><span class=cl>        <span class=c1>// with a success or failure to be an unknown status.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=nx>build</span><span class=p>.</span><span class=nx>Result</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;aborted&#34;</span><span class=p>,</span> <span class=s>&#34;not_built&#34;</span><span class=p>,</span> <span class=s>&#34;unstable&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;success&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusSuccess</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=s>&#34;failure&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusFailed</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobDurationDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span><span class=p>.</span><span class=nx>Duration</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div><div id=R-tab-id-49fda1740c8367a808e234e988eff74f data-tab-item=R-tab-938c78fab74f4685403ec8d68561f6d1 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The final step is to calculate how long it took from
commit to job completion to help infer our DORA metrics.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=kd>func</span> <span class=p>(</span><span class=nx>s</span> <span class=nx>scraper</span><span class=p>)</span> <span class=nf>scrape</span><span class=p>(</span><span class=nx>ctx</span> <span class=nx>context</span><span class=p>.</span><span class=nx>Context</span><span class=p>)</span> <span class=p>(</span><span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>,</span> <span class=kt>error</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nx>jobs</span><span class=p>,</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>s</span><span class=p>.</span><span class=nx>client</span><span class=p>.</span><span class=nf>GetJobs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nx>pmetric</span><span class=p>.</span><span class=nx>Metrics</span><span class=p>{},</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Recording the timestamp to ensure</span>
</span></span><span class=line><span class=cl>    <span class=c1>// all captured data points within this scrape have the same value. </span>
</span></span><span class=line><span class=cl>    <span class=nx>now</span> <span class=o>:=</span> <span class=nx>pcommon</span><span class=p>.</span><span class=nf>NewTimestampFromTime</span><span class=p>(</span><span class=nx>time</span><span class=p>.</span><span class=nf>Now</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// Casting to an int64 to match the expected type</span>
</span></span><span class=line><span class=cl>    <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobsCountDataPoint</span><span class=p>(</span><span class=nx>now</span><span class=p>,</span> <span class=nb>int64</span><span class=p>(</span><span class=nb>len</span><span class=p>(</span><span class=nx>jobs</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=nx>_</span><span class=p>,</span> <span class=nx>job</span> <span class=o>:=</span> <span class=k>range</span> <span class=nx>jobs</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure we have valid results to start off with</span>
</span></span><span class=line><span class=cl>        <span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>build</span>  <span class=p>=</span> <span class=nx>job</span><span class=p>.</span><span class=nx>LastCompletedBuild</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span> <span class=p>=</span> <span class=nx>metadata</span><span class=p>.</span><span class=nx>AttributeJobStatusUnknown</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Previous step here</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Ensure that the `ChangeSet` has values</span>
</span></span><span class=line><span class=cl>        <span class=c1>// set so there is a valid value for us to reference</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Making the assumption that the first changeset</span>
</span></span><span class=line><span class=cl>        <span class=c1>// item is the most recent change.</span>
</span></span><span class=line><span class=cl>        <span class=nx>change</span> <span class=o>:=</span> <span class=nx>build</span><span class=p>.</span><span class=nx>ChangeSet</span><span class=p>.</span><span class=nx>Items</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Record the difference from the build time</span>
</span></span><span class=line><span class=cl>        <span class=c1>// compared against the change timestamp.</span>
</span></span><span class=line><span class=cl>        <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>RecordJenkinsJobCommitDeltaDataPoint</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=nx>now</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>int64</span><span class=p>(</span><span class=nx>build</span><span class=p>.</span><span class=nx>Timestamp</span><span class=o>-</span><span class=nx>change</span><span class=p>.</span><span class=nx>Timestamp</span><span class=p>),</span>
</span></span><span class=line><span class=cl>            <span class=nx>job</span><span class=p>.</span><span class=nx>Name</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nx>status</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>s</span><span class=p>.</span><span class=nx>mb</span><span class=p>.</span><span class=nf>Emit</span><span class=p>(),</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>Once all of these steps have been completed, you now have built a custom Jenkins CI receiver!</p><h2 id=whats-next>Whats next?</h2><p>There are more than likely features that would be desired from component that you can think of, like:</p><ul><li>Can I include the branch name that the job used?</li><li>Can I include the project name for the job?</li><li>How I calculate the collective job durations for project?</li><li>How do I validate the changes work?</li></ul><p>Please take this time to play around, break it, change things around, or even try to capture logs from the builds.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Mar 3, 2025</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=advanced-opentelemetry-collector>Advanced OpenTelemetry Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>75 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Authors
</span><span class=badge-content>Robert Castley,
Charity Anderson,
Pieter Hagen
&
Geoff Higginbottom</span></span><p>The goal of this workshop is to help you gain confidence in creating and modifying OpenTelemetry Collector configuration files. Youâ€™ll start with a minimal <code>agent.yaml</code> and <code>gateway.yaml</code> file and progressively build them out to handle several advanced, real-world scenarios.</p><p>A key focus of this workshop is learning how to configure the OpenTelemetry Collector to store telemetry data locally, rather than sending it to a third-party vendor backend. This approach not only simplifies debugging and troubleshooting but is also ideal for testing and development environments where you want to avoid sending data to production systems.</p><p>To make the most of this workshop, you should have:</p><ul><li>A basic understanding of the OpenTelemetry Collector and its configuration file structure.</li><li>Proficiency in editing YAML files.</li></ul><p>Everything in this workshop is designed to run locally, ensuring a hands-on and accessible learning experience. Letâ€™s dive in and start building!</p><h3 id=workshop-overview>Workshop Overview</h3><p>During this workshop, we will cover the following topics:</p><ul><li><strong>Setting up the agent and gateway locally</strong>: Test that metrics, traces, and logs go via the agent to the gateway.</li><li><strong>Enhancing agent resilience</strong>: Basic configurations for fault tolerance.</li><li><strong>Configuring processors</strong>:<ul><li>Filter out noise by dropping specific spans (e.g., health checks).</li><li>Remove unnecessary tags, and handle sensitive data.</li><li>Transform data using OTTL (OpenTelemetry Transformation Language) in the pipeline before exporting.</li></ul></li><li><strong>Configuring Connectors</strong>:<ul><li>Route data to different endpoints based on the values received.</li></ul></li></ul><p>By the end of this workshop, you&rsquo;ll be familiar with configuring the OpenTelemetry Collector for a variety of real-world use cases.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Advanced OpenTelemetry Collector</h1><article class=default><header class=headline></header><h1 id=pre-requisites>Pre-requisites</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h3 id=prerequisites>Prerequisites</h3><ul><li>Proficiency in editing YAML files using <code>vi</code>, <code>vim</code>, <code>nano</code>, or your preferred text editor.</li><li>Supported Environments:<ul><li>A provided Splunk Workshop Instance (preferred). Outbound access to port <code>2222</code> is required for <code>ssh</code> access.</li><li>Apple Mac (Apple Silicon). Installation of <code>jq</code> is required - <a href=https://jqlang.org/download/ rel=external><strong>https://jqlang.org/download/</strong></a></li></ul></li></ul><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Create a directory</strong>: In your environment create a new directory and change into it:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir advanced-otel-workshop <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=nb>cd</span> advanced-otel-workshop</span></span></code></pre></div><p>We will refer to this directory as <code>[WORKSHOP]</code> for the remainder of the workshop.</p><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Remove any existing OpenTelemetry Collectors</summary><div class=box-content><p>If you have completed the Splunk IM workshop, please ensure you have deleted the collector running in Kubernetes before continuing. This can be done by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div><p>The EC2 instance in that case may also run some services that can interfere with this workshop , so run the following command to make sure they are stopped if present:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete ~/workshop/apm/deployment.yaml</span></span></code></pre></div></div></details><p><strong>Download workshop binaries</strong>: Change into your <code>[WORKSHOP]</code> directory and download the OpenTelemetry Collector, Load Generator binaries and setup script:</p><div class=tab-panel data-tab-group=R-tabs-32b874725a120d497a5377b9610f6250><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-63df5b0674cf8c134bf7c7ae5482f190 aria-expanded=true data-tab-item=R-tab-82857c7966640c0cfd614ba8cc6f34f0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-32b874725a120d497a5377b9610f6250","R-tab-82857c7966640c0cfd614ba8cc6f34f0")'>
<span class=tab-nav-text>Splunk Workshop Instance</span>
</button>
<button aria-controls=R-tab-id-e108393e08ebee20e7def085f8ed4916 aria-expanded=false data-tab-item=R-tab-720c44a46151d66d4db2d011603e7e1f class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-32b874725a120d497a5377b9610f6250","R-tab-720c44a46151d66d4db2d011603e7e1f")'>
<span class=tab-nav-text>Apple Silicon</span></button></div><div class=tab-content-container><div id=R-tab-id-63df5b0674cf8c134bf7c7ae5482f190 data-tab-item=R-tab-82857c7966640c0cfd614ba8cc6f34f0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -L https://github.com/signalfx/splunk-otel-collector/releases/download/v0.136.0/otelcol_linux_amd64 -o otelcol <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/loadgen/build/loadgen-linux-amd64 -o loadgen <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/setup-workshop.sh -o setup-workshop.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>chmod +x setup-workshop.sh</span></span></code></pre></div></div></div><div id=R-tab-id-e108393e08ebee20e7def085f8ed4916 data-tab-item=R-tab-720c44a46151d66d4db2d011603e7e1f class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -L https://github.com/signalfx/splunk-otel-collector/releases/download/v0.136.0/otelcol_darwin_arm64 -o otelcol <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/loadgen/build/loadgen-darwin-arm64 -o loadgen <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/setup-workshop.sh -o setup-workshop.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>chmod +x setup-workshop.sh</span></span></code></pre></div></div></div></div></div><p>Run the <code>setup-workshop.sh</code> script which will configure the correct permissions and also create the initial configurations for the <strong>Agent</strong> and the <strong>Gateway</strong>:</p><div class=tab-panel data-tab-group=R-tabs-40c877098c86b9e161021de50131d951><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a4572329c5bfa550787d5f733c466c28 aria-expanded=true data-tab-item=R-tab-ed1ba283b4cfb63aa90843a7e81a1de7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-40c877098c86b9e161021de50131d951","R-tab-ed1ba283b4cfb63aa90843a7e81a1de7")'>
<span class=tab-nav-text>Setup Workshop</span>
</button>
<button aria-controls=R-tab-id-a6efb8a08d99173a23fa294942bb1f21 aria-expanded=false data-tab-item=R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-40c877098c86b9e161021de50131d951","R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24")'>
<span class=tab-nav-text>Verify Setup</span></button></div><div class=tab-content-container><div id=R-tab-id-a4572329c5bfa550787d5f733c466c28 data-tab-item=R-tab-ed1ba283b4cfb63aa90843a7e81a1de7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./setup-workshop.sh</span></span></code></pre></div></div></div><div id=R-tab-id-a6efb8a08d99173a23fa294942bb1f21 data-tab-item=R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•    â•šâ–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•      â•šâ–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—      â–ˆâ–ˆâ•”â•
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•    â•šâ•â•
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Welcome to the Splunk Advanced OpenTelemetry Workshop!
</span></span><span class=line><span class=cl>======================================================
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>macOS detected. Removing quarantine attributes...
</span></span><span class=line><span class=cl>otelcol version v0.126.0
</span></span><span class=line><span class=cl>Usage: loadgen [OPTIONS]
</span></span><span class=line><span class=cl>Options:
</span></span><span class=line><span class=cl>  -base       Send base traces (enabled by default)
</span></span><span class=line><span class=cl>  -health     Send health traces
</span></span><span class=line><span class=cl>  -security   Send security traces
</span></span><span class=line><span class=cl>  -logs       Enable logging of random quotes to quotes.log
</span></span><span class=line><span class=cl>  -json       Output logs in JSON format (only applicable with -logs)
</span></span><span class=line><span class=cl>  -count      Number of traces or logs to send (default: infinite)
</span></span><span class=line><span class=cl>  -h, --help  Display this help message
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Example:
</span></span><span class=line><span class=cl>  loadgen -health -security -count 10   Send 10 health and security traces
</span></span><span class=line><span class=cl>  loadgen -logs -json -count 5          Write 5 random quotes in JSON format to quotes.log
</span></span><span class=line><span class=cl>Creating workshop directories...
</span></span><span class=line><span class=cl>âœ“ Created subdirectories:
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 1-agent-gateway
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 2-building-resilience
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 3-dropping-spans
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 4-sensitive-data
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 5-transform-data
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 6-routing-data
</span></span><span class=line><span class=cl>  â””â”€â”€ 7-sum-count
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating configuration files for 1-agent-gateway...
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector agent configuration file: 1-agent-gateway/agent.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 1-agent-gateway/agent.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     4355 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector gateway configuration file: 1-agent-gateway/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 1-agent-gateway/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     3376 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>âœ“ Completed configuration files for 1-agent-gateway
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating configuration files for 2-building-resilience...
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector agent configuration file: 2-building-resilience/agent.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 2-building-resilience/agent.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     4355 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector gateway configuration file: 2-building-resilience/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 2-building-resilience/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     3376 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>âœ“ Completed configuration files for 2-building-resilience
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Workshop environment setup complete!
</span></span><span class=line><span class=cl>Configuration files created in the following directories:
</span></span><span class=line><span class=cl>  1-agent-gateway/
</span></span><span class=line><span class=cl>    â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>    â””â”€â”€ gateway.yaml
</span></span><span class=line><span class=cl>  2-building-resilience/
</span></span><span class=line><span class=cl>    â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>    â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=R-tabs-84d10aff91aa1040953657f9e62ae4fe><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1fc419cf779cae47bdb00c58a7fce784 aria-expanded=true data-tab-item=R-tab-b40a1b49bd294b76ac2b8778c756092f class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-84d10aff91aa1040953657f9e62ae4fe","R-tab-b40a1b49bd294b76ac2b8778c756092f")'>
<span class=tab-nav-text>Initial Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-1fc419cf779cae47bdb00c58a7fce784 data-tab-item=R-tab-b40a1b49bd294b76ac2b8778c756092f class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[WORKSHOP]
</span></span><span class=line><span class=cl>â”œâ”€â”€ 1-agent-gateway
</span></span><span class=line><span class=cl>â”œâ”€â”€ 2-building-resilience
</span></span><span class=line><span class=cl>â”œâ”€â”€ 3-dropping-spans
</span></span><span class=line><span class=cl>â”œâ”€â”€ 4-sensitive-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 5-transform-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 6-routing-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 7-sum-count
</span></span><span class=line><span class=cl>â”œâ”€â”€ loadgen
</span></span><span class=line><span class=cl>â”œâ”€â”€ otelcol
</span></span><span class=line><span class=cl>â””â”€â”€ setup-workshop.sh</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=1-verify-agent-configuration>1. Verify Agent Configuration</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Welcome! In this section, weâ€™ll begin with a fully functional OpenTelemetry setup that includes both an <strong>Agent</strong> and a <strong>Gateway</strong>.</p><p>Weâ€™ll start by quickly reviewing their configuration files to get familiar with the overall structure and to highlight key sections that control the telemetry pipeline.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Throughout the workshop, youâ€™ll work with multiple terminal windows. To keep things organized, give each terminal a unique name or color. This will help you easily recognize and switch between them during the exercises.</p><p>We will refer to these terminals as: <strong>Agent</strong>, <strong>Gateway</strong>, <strong>Loadgen</strong>, and <strong>Test</strong>.</p></div></details><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ol><li><p>Create your first terminal window and name it <strong>Agent</strong>. Navigate to the directory for the first exercise <code>[WORKSHOP]/1-agent-gateway</code> and verify that the required files have been generated:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> 1-agent-gateway
</span></span><span class=line><span class=cl>ls -l</span></span></code></pre></div></li><li><p>You should see the following files in the directory. If not, re-run the <code>setup-workshop.sh</code> script as described in the <strong>Pre-requisites</strong> section:</p><div class=tab-panel data-tab-group=R-tabs-dde63e31ef01fb54baa20047048bd9bb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e2034a0996b426adda730055e749c138 aria-expanded=true data-tab-item=R-tab-3ea4b283eb322e1c6373d63f91d032be class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-dde63e31ef01fb54baa20047048bd9bb","R-tab-3ea4b283eb322e1c6373d63f91d032be")'>
<span class=tab-nav-text>Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-e2034a0996b426adda730055e749c138 data-tab-item=R-tab-3ea4b283eb322e1c6373d63f91d032be class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></li></ol></div></details><h3 id=understanding-the-agent-configuration>Understanding the Agent configuration</h3><p>Letâ€™s review the key components of the <code>agent.yaml</code> file used in this workshop. Weâ€™ve made some important additions to support metrics, traces, and logs.</p><h4 id=receivers>Receivers</h4><p>The <code>receivers</code> section defines how the <strong>Agent</strong> ingests telemetry data. In this setup, three types of receivers have been configured:</p><ul><li><p><strong>Host Metrics Receiver</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>                         </span><span class=c># Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>3600s        </span><span class=w> </span><span class=c># Collection Interval (1hr)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w>                             </span><span class=c># CPU Scraper</span></span></span></code></pre></div><p>Collects CPU usage from the local system every hour. Weâ€™ll use this to generate example metric data.</p></li><li><p><strong>OTLP Receiver (HTTP protocol)</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otlp</span><span class=p>:</span><span class=w>                                </span><span class=c># OTLP Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>http</span><span class=p>:</span><span class=w>                            </span><span class=c># Configure HTTP protocol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0:4318&#34;</span><span class=w>       </span><span class=c># Endpoint to bind to</span></span></span></code></pre></div><p>Enables the agent to receive metrics, traces, and logs over HTTP on port <code>4318</code>. This is used to send data to the collector in future exercises.</p></li><li><p><strong>FileLog Receiver</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>filelog/quotes</span><span class=p>:</span><span class=w>                      </span><span class=c># Receiver Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>./quotes.log             </span><span class=w> </span><span class=c># The file to read log data from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include_file_path</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>            </span><span class=c># Include file path in the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include_file_name</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>           </span><span class=c># Exclude file name from the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resource</span><span class=p>:</span><span class=w>                          </span><span class=c># Add custom resource attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>com.splunk.source</span><span class=p>:</span><span class=w> </span><span class=l>./quotes.log </span><span class=w> </span><span class=c># Source of the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>com.splunk.sourcetype</span><span class=p>:</span><span class=w> </span><span class=l>quotes   </span><span class=w> </span><span class=c># Source type of the log data</span></span></span></code></pre></div><p>Enables the agent to tail a local log file (<code>quotes.log</code>) and convert it to structured log events, enriched with metadata such as <code>source</code> and <code>sourceType</code>.</p></li></ul><h4 id=exporters>Exporters</h4><ul><li><p><strong>Debug Exporter</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>                               </span><span class=c># Exporter Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed               </span><span class=w> </span><span class=c># Enabled detailed debug output</span></span></span></code></pre></div></li><li><p><strong>OTLPHTTP Exporter</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp</span><span class=p>:</span><span class=w>                            </span><span class=c># Exporter Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://localhost:5318&#34;</span><span class=w>  </span><span class=c># Gateway OTLP endpoint  </span></span></span></code></pre></div><p>The <code>debug</code> exporter sends data to the console for visibility and debugging during the workshop while the <code>otlphttp</code> exporter forwards all telemetry to the local <strong>Gateway</strong> instance.</p><p><strong>This dual-export strategy ensures you can see the raw data locally while also sending it downstream for further processing and export.</strong></p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Agent Configuration</h1><article class=default><header class=headline></header><h1 id=11-verify-gateway-configuration>1.1 Verify Gateway Configuration</h1><p>The <strong>OpenTelemetry Gateway</strong> serves as a central hub for receiving, processing, and exporting telemetry data. It sits between your telemetry sources (such as applications and services) and your observability backends like Splunk Observability Cloud.</p><p>By centralizing telemetry traffic, the gateway enables advanced features such as data filtering, enrichment, transformation, and routing to one or more destinations. It helps reduce the burden on individual services by offloading telemetry processing and ensures consistent, standardized data across distributed systems.</p><p>This makes your observability pipeline easier to manage, scale, and analyzeâ€”especially in complex, multi-service environments.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Open or create your second terminal window and name it <strong>Gateway</strong>. Navigate to the first exercise directory <code>[WORKSHOP]/1-agent-gateway</code>
then check the contents of the <code>gateway.yaml</code> file.</p><p>This file outlines the core structure of the OpenTelemetry Collector as deployed in <strong>Gateway</strong> mode.</p></div></details><h3 id=understanding-the-gateway-configuration>Understanding the Gateway Configuration</h3><p>Letâ€™s explore the <code>gateway.yaml</code> file that defines how the OpenTelemetry Collector is configured in <strong>Gateway</strong> mode during this workshop. This <strong>Gateway</strong> is responsible for receiving telemetry from the <strong>Agent</strong>, then processing and exporting it for inspection or forwarding.</p><ul><li><p><strong>OTLP Receiver (Custom Port)</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0:5318&#34;</span></span></span></code></pre></div><p>The port <code>5318</code> matches the <code>otlphttp</code> exporter in the <strong>Agent</strong> configuration, ensuring that all telemetry data sent by the <strong>Agent</strong> is accepted by the <strong>Gateway</strong>.</p></li></ul><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>This separation of ports avoids conflicts and keeps responsibilities clear between agent and gateway roles.</p></div></details><ul><li><p><strong>File Exporters</strong></p><p>The <strong>Gateway</strong> uses three file exporters to output telemetry data to local files. These exporters are defined as:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>                        </span><span class=c># List of exporters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>                          </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed          </span><span class=w> </span><span class=c># Enable detailed debug output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces</span><span class=p>:</span><span class=w>                    </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces.out&#34;</span><span class=w>  </span><span class=c># Path for OTLP JSON output for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/metrics</span><span class=p>:</span><span class=w>                   </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-metrics.out&#34;</span><span class=w> </span><span class=c># Path for OTLP JSON output for metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/logs</span><span class=p>:</span><span class=w>                      </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-logs.out&#34;</span><span class=w>    </span><span class=c># Path for OTLP JSON output for logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span></span></span></code></pre></div><p>Each exporter writes a specific signal type to its corresponding file.</p><p>These files are created once the gateway is started and will be populated with real telemetry as the agent sends data. You can monitor these files in real time to observe the flow of telemetry through your pipeline.</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=12-validate--test-configuration>1.2 Validate & Test Configuration</h1><p>Now, we can start the <strong>Gateway</strong> and the <strong>Agent</strong>, which is configured to automatically send <strong>Host Metrics</strong> at startup. We do this to verify that data is properly routed from the <strong>Agent</strong> to the <strong>Gateway</strong>.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway</strong>: In the <strong>Gateway terminal</strong> window, run the following command to start the <strong>Gateway</strong>:</p><div class=tab-panel data-tab-group=R-tabs-f1cb64dbef3c93078a0ab7113dbd8dec><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1b79327955dff608f71d9db8afa72de5 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f1cb64dbef3c93078a0ab7113dbd8dec","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-1b79327955dff608f71d9db8afa72de5 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p>If everything is configured correctly, the collector will start and state <code>Everything is ready. Begin running and processing data.</code> in the output, similar to the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-06-09T09:22:11.944+0100    info    service@v0.126.0/service.go:289 Everything is ready. Begin running and processing data. {&#34;resource&#34;: {}}</span></span></code></pre></div><p>Once the <strong>Gateway</strong> is running, it will listen for incoming data on port <code>5318</code> and export the received data to the following files:</p><ul><li><code>gateway-traces.out</code></li><li><code>gateway-metrics.out</code></li><li><code>gateway-logs.out</code></li></ul><p><strong>Start the Agent</strong>: In the <strong>Agent terminal</strong> window start the agent with the agent configuration:</p><div class=tab-panel data-tab-group=R-tabs-94cf235d166e507fd22755f5168aec86><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-7e2a05e247814fa97bf62bb2268c3974 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-94cf235d166e507fd22755f5168aec86","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-7e2a05e247814fa97bf62bb2268c3974 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Verify CPU Metrics</strong>:</p><ol><li>Check that when the <strong>Agent</strong> starts, it immediately starts sending <strong>CPU</strong> metrics.</li><li>Both the <strong>Agent</strong> and the <strong>Gateway</strong> will display this activity in their debug output. The output should resemble the following snippet:</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>NumberDataPoints #31
</span></span><span class=line><span class=cl>Data point attributes:
</span></span><span class=line><span class=cl>     -&gt; cpu: Str(cpu3)
</span></span><span class=line><span class=cl>     -&gt; state: Str(wait)
</span></span><span class=line><span class=cl>StartTimestamp: 2025-07-07 16:49:42 +0000 UTC
</span></span><span class=line><span class=cl>Timestamp: 2025-07-09 09:36:21.190226459 +0000 UTC
</span></span><span class=line><span class=cl>Value: 77.380000
</span></span><span class=line><span class=cl>        {&#34;resource&#34;: {}, &#34;otelcol.component.id&#34;: &#34;debug&#34;, &#34;otelcol.component.kind&#34;: &#34;exporter&#34;, &#34;otelcol.signal&#34;: &#34;metrics&#34;}</span></span></code></pre></div><p>At this stage, the <strong>Agent</strong> continues to collect <strong>CPU</strong> metrics once per hour or upon each restart and sends them to the gateway. The <strong>Gateway</strong> processes these metrics and exports them to a file named <code>gateway-metrics.out</code>. This file stores the exported metrics as part of the pipeline service.</p><p><strong>Verify Data arrived at Gateway</strong>: To confirm that CPU metrics, specifically for <code>cpu0</code>, have successfully reached the gateway, weâ€™ll inspect the <code>gateway-metrics.out</code> file using the <code>jq</code> command.</p><p>The following command filters and extracts the <code>system.cpu.time</code> metric, focusing on <code>cpu0</code>. It displays the metricâ€™s state (e.g., <code>user</code>, <code>system</code>, <code>idle</code>, <code>interrupt</code>) along with the corresponding values.</p><p>Open or create your third terminal window and name it <strong>Tests</strong>. Run the command below in the <strong>Tests terminal</strong> to check the <code>system.cpu.time</code> metric:</p><div class=tab-panel data-tab-group=R-tabs-97d4644444c0de509ad4e5fb04bb8835><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a6212a75affcba6defd5e88069b98167 aria-expanded=true data-tab-item=R-tab-fe622e84764bc6f08467fa0eea9b5ec6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-97d4644444c0de509ad4e5fb04bb8835","R-tab-fe622e84764bc6f08467fa0eea9b5ec6")'>
<span class=tab-nav-text>Check CPU Metrics</span>
</button>
<button aria-controls=R-tab-id-7a2605776ab8e404e20a185ab3ab4e3a aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-97d4644444c0de509ad4e5fb04bb8835","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-a6212a75affcba6defd5e88069b98167 data-tab-item=R-tab-fe622e84764bc6f08467fa0eea9b5ec6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[] | select(.name == &#34;system.cpu.time&#34;) | .sum.dataPoints[] | select(.attributes[0].value.stringValue == &#34;cpu0&#34;) | {cpu: .attributes[0].value.stringValue, state: .attributes[1].value.stringValue, value: .asDouble}&#39;</span> gateway-metrics.out</span></span></code></pre></div></div></div><div id=R-tab-id-7a2605776ab8e404e20a185ab3ab4e3a data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>123407.02</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>64866.6</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;idle&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>216427.87</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;interrupt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=2-building-in-resilience>2. Building In Resilience</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>The OpenTelemetry Collectorâ€™s <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/19bc7d6ee854c0c1b5c97d8d348e5b9d1199e8aa/extension/storage/filestorage/README.md rel=external><strong>FileStorage Extension</strong></a> is a critical component for building a more resilient telemetry pipeline. It enables the Collector to reliably checkpoint in-flight data, manage retries efficiently, and gracefully handle temporary failures without losing valuable telemetry.</p><p>With FileStorage enabled, the Collector can persist intermediate states to disk, ensuring that your traces, metrics, and logs are not lost during network disruptions, backend outages, or Collector restarts. This means that even if your network connection drops or your backend becomes temporarily unavailable, the Collector will continue to receive and buffer telemetry, resuming delivery seamlessly once connectivity is restored.</p><p>By integrating the FileStorage Extension into your pipeline, you can strengthen the durability of your observability stack and maintain high-quality telemetry ingestion, even in environments where connectivity may be unreliable.<details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>This solution will work for metrics as long as the connection downtime is brief, up to 15 minutes. If the downtime exceeds this, Splunk Observability Cloud might drop data to make sure no data-point is out of order.</p><p>For logs, there are plans to implement a full enterprise-ready solution in one of the upcoming Splunk OpenTelemetry Collector releases.</p></div></details></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. Building Resilience</h1><article class=default><header class=headline></header><h1 id=21-file-storage-configuration>2.1 File Storage Configuration</h1><p>In this exercise, we will update the <code>extensions:</code> section of the <code>agent.yaml</code> file. This section is part of the OpenTelemetry configuration YAML and defines optional components that enhance or modify the OpenTelemetry Collectorâ€™s behavior.</p><p>While these components do not process telemetry data directly, they provide valuable capabilities and services to improve the Collectorâ€™s functionality.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>2-building-resilience</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Your directory structure will look like this:</p><div class=tab-panel data-tab-group=R-tabs-3e1341f9b7bf81827158d6788cf64835><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ed8c5c8fb24f715e31ec49c5b714257b aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-3e1341f9b7bf81827158d6788cf64835","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-ed8c5c8fb24f715e31ec49c5b714257b data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Update the <code>agent.yaml</code></strong>: In the <strong>Agent terminal</strong> window, add the <code>file_storage</code> extension under the existing <code>health_check</code> extension:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage/checkpoint</span><span class=p>:</span><span class=w>             </span><span class=c># Extension Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./checkpoint-dir&#34;</span><span class=w>      </span><span class=c># Define directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>create_directory</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>             </span><span class=c># Create directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s                       </span><span class=w> </span><span class=c># Timeout for file operations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>                        </span><span class=c># Compaction settings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                   </span><span class=c># Start compaction at Collector startup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Define compaction directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./checkpoint-dir/tmp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>max_transaction_size</span><span class=p>:</span><span class=w> </span><span class=m>65536</span><span class=w>      </span><span class=c># Max. size limit before compaction occurs</span></span></span></code></pre></div><p><strong>Add <code>file_storage</code> to the exporter</strong>: Modify the <code>otlphttp</code> exporter to configure retry and queuing mechanisms, ensuring data is retained and resent if failures occur. Add the following under the <code>endpoint: "http://localhost:5318"</code> and make sure the indentation matches <code>endpoint</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>retry_on_failure</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                    </span><span class=c># Enable retry on failure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sending_queue</span><span class=p>:</span><span class=w>                     </span><span class=c># </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                    </span><span class=c># Enable sending queue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>num_consumers</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>                </span><span class=c># No. of consumers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>queue_size</span><span class=p>:</span><span class=w> </span><span class=m>10000</span><span class=w>                </span><span class=c># Max. queue size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>file_storage/checkpoint</span><span class=w> </span><span class=c># File storage extension</span></span></span></code></pre></div><p><strong>Update the <code>services</code> section</strong>: Add the <code>file_storage/checkpoint</code> extension to the existing <code>extensions:</code> section and the configuration needs to look like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage/checkpoint           </span><span class=w> </span><span class=c># Enabled extensions for this collector</span></span></span></code></pre></div><p><strong>Update the <code>metrics</code> pipeline</strong>: For this exercise we are going to comment out the <code>hostmetrics</code> receiver from the Metric pipeline to reduce debug and log noise, again the configuration needs to look like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># - hostmetrics                    # Hostmetric reciever (cpu only)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span></span></span></code></pre></div></div></details><p>Validate the <strong>Agent</strong> configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>metrics:</code> section of your pipelines will look similar to this:</p><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO2(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      EXP1(&amp;ensp;debug&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(otlphttp&lt;br&gt;fa:fa-upload):::exporter
      EXP3(&amp;ensp;file&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    %% Links
    subID1:::sub-metrics
    subgraph &#34; &#34;
      subgraph subID1[**Metrics**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO2
      PRO2 --&gt; PRO3
      PRO3 --&gt; EXP1
      PRO3 --&gt; EXP3
      PRO3 --&gt; EXP2
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 7, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=22-setup-environment-for-resilience-testing>2.2 Setup environment for Resilience Testing</h1><p>Next, we will configure our environment to be ready for testing the <strong>File Storage</strong> configuration.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>: In the <strong>Gateway terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-2a337bf5b8b691b45e2f0c8fa7f41e2f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-7c4ed230a1a7c5701647c23c16b98774 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2a337bf5b8b691b45e2f0c8fa7f41e2f","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-7c4ed230a1a7c5701647c23c16b98774 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Agent</strong>: In the <strong>Agent terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-f0898664a37b72ec9b9c93f546ee5028><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6978caea78657796f261d6a0c76eb8d7 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f0898664a37b72ec9b9c93f546ee5028","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-6978caea78657796f261d6a0c76eb8d7 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Send five test spans</strong>: In the <strong>Loadgen terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-d0fad6fe5b8dafe9f7742dcb4c3838fb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-24b13f1a73d9d92d32453c14cbd690c1 aria-expanded=true data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d0fad6fe5b8dafe9f7742dcb4c3838fb","R-tab-5386e98c2a18696103b86ab3f8520915")'>
<span class=tab-nav-text>Start Load Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-24b13f1a73d9d92d32453c14cbd690c1 data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p>Both the <strong>Agent</strong> and <strong>Gateway</strong> should display debug logs, and the <strong>Gateway</strong> should create a <code>./gateway-traces.out</code> file.</p><p>If everything functions correctly, we can proceed with testing system resilience.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=23-simulate-failure>2.3 Simulate Failure</h1><p>To assess the <strong>Agent&rsquo;s</strong> resilience, we&rsquo;ll simulate a temporary <strong>Gateway</strong> outage and observe how the <strong>Agent</strong> handles it:</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Simulate a network failure</strong>: In the <strong>Gateway terminal</strong> stop the <strong>Gateway</strong> with <code>Ctrl-C</code> and wait until the gateway console shows that it has stopped. The <strong>Agent</strong> will continue running, but it will not be able to send data to the gateway. The output in the <strong>Gateway terminal</strong> should look similar to this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-09T10:22:37.941Z        info    service@v0.126.0/service.go:345 Shutdown complete.      {&#34;resource&#34;: {}}</span></span></code></pre></div><p><strong>Send traces</strong>: In the <strong>Loadgen terminal</strong> window send five more traces using the <code>loadgen</code>.</p><div class=tab-panel data-tab-group=R-tabs-17ad8acb80664fa9bd09d8f0927819a3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f810d3d4456368d2385689b4c98c2320 aria-expanded=true data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-17ad8acb80664fa9bd09d8f0927819a3","R-tab-5386e98c2a18696103b86ab3f8520915")'>
<span class=tab-nav-text>Start Load Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-f810d3d4456368d2385689b4c98c2320 data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p>Notice that the agentâ€™s retry mechanism is activated as it continuously attempts to resend the data. In the agentâ€™s console output, you will see repeated messages similar to the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-01-28T14:22:47.020+0100  info  internal/retry_sender.go:126  Exporting failed. Will retry the request after interval.  {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;traces&#34;, &#34;name&#34;: &#34;otlphttp&#34;, &#34;error&#34;: &#34;failed to make an HTTP request: Post \&#34;http://localhost:5318/v1/traces\&#34;: dial tcp 127.0.0.1:5318: connect: connection refused&#34;, &#34;interval&#34;: &#34;9.471474933s&#34;}</span></span></code></pre></div><p><strong>Stop the Agent</strong>: In the <strong>Agent terminal</strong> window, use <code>Ctrl-C</code> to stop the agent. Wait until the agentâ€™s console confirms it has stopped:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-09T10:25:59.344Z        info    service@v0.126.0/service.go:345 Shutdown complete.      {&#34;resource&#34;: {}}</span></span></code></pre></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>When you stop the agent, any metrics, traces, or logs held in memory for retry will be lost. However, because we have configured the FileStorage Extension, all telemetry that has not yet been accepted by the target endpoint are safely checkpointed on disk.</p><p>Stopping the agent is a crucial step to clearly demonstrate how the system recovers when the agent is restarted.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=24-recovery>2.4 Recovery</h1><p>In this exercise, weâ€™ll test how the <strong>OpenTelemetry Collector</strong> recovers from a network outage by restarting the <strong>Gateway</strong> collector. When the <strong>Gateway</strong> becomes available again, the <strong>Agent</strong> will resume sending data from its last check-pointed state, ensuring no data loss.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Restart the Gateway</strong>: In the <strong>Gateway terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-9a4e20a579c11aeff05435f3bd27dcb2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-0a5e8bfd89f6655a334e524df6f8519c aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9a4e20a579c11aeff05435f3bd27dcb2","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-0a5e8bfd89f6655a334e524df6f8519c data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Restart the Agent</strong>: In the <strong>Agent terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-2b814309b0e65e030028b711d593b60d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e2d7e6ca595e5116bf493bde95013e95 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2b814309b0e65e030028b711d593b60d","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-e2d7e6ca595e5116bf493bde95013e95 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><blockquote><p>After the <strong>Agent</strong> is up and running, the <strong>File_Storage</strong> extension will detect buffered data in the checkpoint folder. It will start to dequeue the stored spans from the last checkpoint folder, ensuring no data is lost.</p></blockquote><p><strong>Verify the Agent Debug output:</strong> Note that the <strong>Agent</strong> debug output does <strong>NOT</strong> change and still shows the following line indicating no new data is being exported:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-11T08:31:58.176Z        info    service@v0.126.0/service.go:289 Everything is ready. Begin running and processing data.   {&#34;resource&#34;: {}}</span></span></code></pre></div><p><strong>Watch the Gateway Debug output</strong><br>You should see from the <strong>Gateway</strong> debug screen, it has started receiving the previously missed traces without requiring any additional action on your part e.g.:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>   -&gt; user.name: Str(Luke Skywalker)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>   -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(75.75)
</span></span><span class=line><span class=cl>      {&#34;resource&#34;: {}, &#34;otelcol.component.id&#34;: &#34;debug&#34;, &#34;otelcol.component.kind&#34;: &#34;exporter&#34;, &#34;otelcol.signal&#34;: &#34;traces&#34;}</span></span></code></pre></div><p><strong>Check the <code>gateway-traces.out</code> file:</strong> Using <code>jq</code>, count the number of traces in the recreated <code>gateway-traces.out</code>. It should match the number you send when the <strong>Gateway</strong> was down.</p><div class=tab-panel data-tab-group=R-tabs-3611b7abe80944e17ab9060147080cfb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-303f08600b7315b225be45d728adca01 aria-expanded=true data-tab-item=R-tab-4e2ba08c3a1a44c321b4ef1ba3812149 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-3611b7abe80944e17ab9060147080cfb","R-tab-4e2ba08c3a1a44c321b4ef1ba3812149")'>
<span class=tab-nav-text>Check Gateway Traces Out File</span>
</button>
<button aria-controls=R-tab-id-546d7f2fcbb4eec1162f917149e0569c aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-3611b7abe80944e17ab9060147080cfb","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-303f08600b7315b225be45d728adca01 data-tab-item=R-tab-4e2ba08c3a1a44c321b4ef1ba3812149 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans | length | &#34;\(.) resourceSpans found&#34;&#39;</span> gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-546d7f2fcbb4eec1162f917149e0569c data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;5 resourceSpans found&#34;</span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details><h3 id=conclusion>Conclusion</h3><p>This exercise demonstrated how to enhance the resilience of the OpenTelemetry Collector by configuring the <code>file_storage</code> extension, enabling retry mechanisms for the <code>otlp</code> exporter, and using a file-backed queue for temporary data storage.</p><p>By implementing file-based check-pointing and queue persistence, you ensure the telemetry pipeline can gracefully recover from temporary interruptions, making it a more robust and reliable for production environments.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=3-dropping-spans>3. Dropping Spans</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>In this section, we will explore how to use the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/filterprocessor/README.md rel=external><strong>Filter Processor</strong></a> to selectively drop spans based on certain conditions.</p><p>Specifically, we will drop traces based on the span name, which is commonly used to filter out unwanted spans such as health checks or internal communication traces. In this case, we will be filtering out spans that contain <code>"/_healthz"</code>, typically associated with health check requests and usually are quite &ldquo;<strong>noisy</strong>&rdquo;.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>3-dropping-spans</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Copy <code>*.yaml</code> from the <code>2-building-resilience</code> directory into <code>3-dropping-spans</code>. Your updated directory structure will now look like this:</p><div class=tab-panel data-tab-group=R-tabs-ee0753f346b122330f2de5c809709f9f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-189541926d2405661334b2ea8d68797e aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-ee0753f346b122330f2de5c809709f9f","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-189541926d2405661334b2ea8d68797e data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><p>Next, we will configure the <strong>filter processor</strong> and the respective pipelines.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Dropping Spans</h1><article class=default><header class=headline></header><h1 id=31-configuration>3.1 Configuration</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Switch to your <strong>Gateway terminal</strong> window and open the <code>gateway.yaml</code> file. Update the <code>processors</code> section with the following configuration:</p><ol><li><p><strong>Add a <code>filter</code> processor</strong>:<br>Configure the gateway to exclude spans with the name <code>/_healthz</code>. The <code>error_mode: ignore</code> directive ensures that any errors encountered during filtering are ignored, allowing the pipeline to continue running smoothly. The <code>traces</code> section defines the filtering rules, specifically targeting spans named <code>/_healthz</code> for exclusion.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>filter/health</span><span class=p>:</span><span class=w>                       </span><span class=c># Defines a filter processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>error_mode</span><span class=p>:</span><span class=w> </span><span class=l>ignore                </span><span class=w> </span><span class=c># Ignore errors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>                            </span><span class=c># Filtering rules for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>span</span><span class=p>:</span><span class=w>                            </span><span class=c># Exclude spans named &#34;/_healthz&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span>- <span class=s1>&#39;name == &#34;/_healthz&#34;&#39;</span></span></span></code></pre></div></li><li><p><strong>Add the <code>filter</code> processor to the <code>traces</code> pipeline</strong>:<br>Include the <code>filter/health</code> processor in the <code>traces</code> pipeline. For optimal performance, place the filter as early as possibleâ€”right after the <code>memory_limiter</code> and before the <code>batch</code> processor. Hereâ€™s how the configuration should look:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filter/health            </span><span class=w> </span><span class=c># Filters data based on rules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces</span></span></span></code></pre></div></li></ol><p>This setup ensures that health check related spans (<code>/_healthz</code>) are filtered out early in the pipeline, reducing unnecessary noise in your telemetry data.</p></div></details><p>Validate the agent configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>traces:</code> section of your pipelines will look similar to this:</p><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(filter&lt;br&gt;fa:fa-microchip&lt;br&gt;health):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(&amp;ensp;debug&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;ensp;&amp;ensp;file&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
    %% Links
    subID1:::sub-traces
    subgraph &#34; &#34;
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO4
      PRO4 --&gt; PRO3
      PRO3 --&gt; PRO5
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=32-test-filter-processor>3.2 Test Filter Processor</h1><p>To test your configuration, you&rsquo;ll need to generate some trace data that includes a span named <code>"/_healthz"</code>.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>: In your <strong>Gateway terminal</strong> window start the <strong>Gateway</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config ./gateway.yaml</span></span></code></pre></div><p><strong>Start the Agent</strong>: In your <strong>Agent terminal</strong> window start the <strong>Agent</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config ./agent.yaml</span></span></code></pre></div><p><strong>Start the Loadgen</strong>: In the <strong>Loadgen terminal</strong> window, execute the following command to start the load generator with health check spans enabled:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -health -count <span class=m>5</span></span></span></code></pre></div><p>The debug output in the <strong>Agent terminal</strong> will show <code>_healthz</code> spans:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>InstrumentationScope healthz 1.0.0
</span></span><span class=line><span class=cl>Span #0
</span></span><span class=line><span class=cl>   Trace ID       : 0cce8759b5921c8f40b346b2f6e2f4b6
</span></span><span class=line><span class=cl>   Parent ID      :
</span></span><span class=line><span class=cl>   ID             : bc32bd0e4ddcb174
</span></span><span class=line><span class=cl>   Name           : /_healthz
</span></span><span class=line><span class=cl>   Kind           : Server
</span></span><span class=line><span class=cl>   Start time     : 2025-07-11 08:47:50.938703979 +0000 UTC
</span></span><span class=line><span class=cl>   End time       : 2025-07-11 08:47:51.938704091 +0000 UTC
</span></span><span class=line><span class=cl>   Status code    : Ok
</span></span><span class=line><span class=cl>   Status message : Success</span></span></code></pre></div><p>They will not be present in the <strong>Gateway</strong> debug as they are dropped by the filter processor that was configured earlier.</p><p><strong>Verify <code>agent.out</code></strong>: Using <code>jq</code>, in the <strong>Test terminal</strong>, confirm the name of the spans received by the <strong>Agent</strong>:</p><div class=tab-panel data-tab-group=R-tabs-6cf6d07aa9369d88227b8b5db579d284><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3b1c5cabbc41c1dedf94967cbdf36f05 aria-expanded=true data-tab-item=R-tab-acf06dfba3409686305aa9022a3341eb class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6cf6d07aa9369d88227b8b5db579d284","R-tab-acf06dfba3409686305aa9022a3341eb")'>
<span class=tab-nav-text>Check spans in agent.out</span>
</button>
<button aria-controls=R-tab-id-85cea1acc5b1a7dfe7962d28f071a1ac aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-6cf6d07aa9369d88227b8b5db579d284","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-3b1c5cabbc41c1dedf94967cbdf36f05 data-tab-item=R-tab-acf06dfba3409686305aa9022a3341eb class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[] | &#34;Span \(input_line_number) found with name \(.name)&#34;&#39;</span> ./agent.out</span></span></code></pre></div></div></div><div id=R-tab-id-85cea1acc5b1a7dfe7962d28f071a1ac data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;Span 1 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 2 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 3 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 4 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 5 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 6 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 7 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 8 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 9 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 10 found with name /_healthz&#34;</span></span></code></pre></div></div></div></div></div><p><strong>Check the Gateway Debug output</strong>: Using <code>jq</code> confirm the name of the spans received by the <strong>Gateway</strong>:</p><div class=tab-panel data-tab-group=R-tabs-debdbba38d2a993757bf63a916ab1832><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-86c6a40da536d39567fb047c8b36172b aria-expanded=true data-tab-item=R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-debdbba38d2a993757bf63a916ab1832","R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3")'>
<span class=tab-nav-text>Check spans in gateway-traces.out</span>
</button>
<button aria-controls=R-tab-id-28dd3596f764fa76db7e28e49a64ab46 aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-debdbba38d2a993757bf63a916ab1832","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-86c6a40da536d39567fb047c8b36172b data-tab-item=R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[] | &#34;Span \(input_line_number) found with name \(.name)&#34;&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-28dd3596f764fa76db7e28e49a64ab46 data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>The <code>gateway-metrics.out</code> file will not contain any spans named <code>/_healthz</code>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;Span 1 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 2 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 3 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 4 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 5 found with name /movie-validator&#34;</span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>To ensure optimal performance with the Filter processor, thoroughly understand your incoming data format and rigorously test your configuration. <strong>Use the most specific filtering criteria possible</strong> to minimize the risk of inadvertently dropping important data.</p><p>This configuration can be extended to filter spans based on various attributes, tags, or custom criteria, enhancing the OpenTelemetry Collector&rsquo;s flexibility and efficiency for your specific observability requirements.</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=4-redacting-sensitive-data>4. Redacting Sensitive Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, you&rsquo;ll learn how to configure the OpenTelemetry Collector to remove specific tags and redact sensitive data from telemetry spans. This is crucial for protecting sensitive information such as credit card numbers, personal data, or other security-related details that must be anonymized before being processed or exported.</p><p>We&rsquo;ll walk through configuring key processors in the OpenTelemetry Collector, including:</p><ul><li><strong><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/attributesprocessor/README.md rel=external>Attributes Processor</a></strong>: Modifies or removes specific span attributes.</li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/redactionprocessor/README.md rel=external><strong>Redaction Processor</strong></a>: Ensures sensitive data is sanitized before being stored or transmitted.</li></ul><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>4-sensitive-data</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Copy <code>*.yaml</code> from the <code>3-dropping-spans</code> directory into <code>4-sensitive-data</code>. Your updated directory structure will now look like this:</p><div class=tab-panel data-tab-group=R-tabs-6f04267f11362c07386efc8aa3d28a3f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-84f537c74d988f84c937455cd4b45383 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6f04267f11362c07386efc8aa3d28a3f","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-84f537c74d988f84c937455cd4b45383 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Sensitive Data</h1><article class=default><header class=headline></header><h1 id=41-configuration>4.1 Configuration</h1><p>In this step, we&rsquo;ll modify <code>agent.yaml</code> to include the <code>attributes</code> and <code>redaction</code> processors. These processors will help ensure that sensitive data within span attributes is properly handled before being logged or exported.</p><p>Previously, you may have noticed that some span attributes displayed in the console contained personal and sensitive data. We&rsquo;ll now configure the necessary processors to filter out and redact this information effectively.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>     -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>     -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>     -&gt; user.account_password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>     -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>     -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>     -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>  {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;traces&#34;, &#34;name&#34;: &#34;debug&#34;}</span></span></code></pre></div><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Switch to your <strong>Agent terminal</strong> window and open the <code>agent.yaml</code> file in your editor. Weâ€™ll add two processors to enhance the security and privacy of your telemetry data.</p><p><strong>1. Add an <code>attributes</code> Processor</strong>: The <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/attributesprocessor rel=external><strong>Attributes Processor</strong></a> allows you to modify span attributes (tags) by updating, deleting, or hashing their values. This is particularly useful for obfuscating sensitive information before it is exported.</p><p>In this step, weâ€™ll:</p><ol><li><strong>Update</strong> the <code>user.phone_number</code> attribute to a static value <code>("UNKNOWN NUMBER")</code>.</li><li><strong>Hash</strong> the <code>user.email</code> attribute to ensure the original email is not exposed.</li><li><strong>Delete</strong> the <code>user.password</code> attribute to remove it entirely from the span.</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>                           </span><span class=c># Actions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.phone_number        </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>update                </span><span class=w> </span><span class=c># Update action</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;UNKNOWN NUMBER&#34;</span><span class=w>        </span><span class=c># New value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.email               </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>hash                  </span><span class=w> </span><span class=c># Hash the email value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.password            </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete                </span><span class=w> </span><span class=c># Delete the password</span></span></span></code></pre></div><p><strong>2. Add a <code>redaction</code> Processor</strong>: The <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/redactionprocessor rel=external><strong>Redaction Processor</strong></a> detects and redacts sensitive data in span attributes based on predefined patterns, such as credit card numbers or other personally identifiable information (PII).</p><p>In this step:</p><ul><li><p>We set <code>allow_all_keys: true</code> to ensure all attributes are processed (if set to <code>false</code>, only explicitly allowed keys are retained).</p></li><li><p>We define <code>blocked_values</code> with regular expressions to detect and redact <strong>Visa</strong> and <strong>MasterCard</strong> credit card numbers.</p></li><li><p>The <code>summary: debug</code> option logs detailed information about the redaction process for debugging purposes.</p></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>redaction/redact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>allow_all_keys</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>               </span><span class=c># If false, only allowed keys will be retained</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>blocked_values</span><span class=p>:</span><span class=w>                    </span><span class=c># List of regex patterns to block</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;\b4[0-9]{3}[\s-]?[0-9]{4}[\s-]?[0-9]{4}[\s-]?[0-9]{4}\b&#39;</span><span class=w>       </span><span class=c># Visa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;\b5[1-5][0-9]{2}[\s-]?[0-9]{4}[\s-]?[0-9]{4}[\s-]?[0-9]{4}\b&#39;</span><span class=w>  </span><span class=c># MasterCard</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=l>debug                    </span><span class=w> </span><span class=c># Show debug details about redaction</span></span></span></code></pre></div><p><strong>Update the <code>traces</code> Pipeline</strong>: Integrate both processors into the <code>traces</code> pipeline. Make sure that you comment out the redaction processor at first (we will enable it later in a separate exercise). Your configuration should look like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- redaction/redact               # Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div></div></details><p>Validate the agent configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>traces:</code> section of your pipelines will look similar to this:</p><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRML(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRRD(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
      PRRS(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRUP(attributes&lt;br&gt;fa:fa-microchip&lt;br&gt;update):::processor
      EXP1(otlphttp&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;ensp;&amp;ensp;debug&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP3(file&lt;br&gt;fa:fa-upload):::exporter

    %% Links
    subID1:::sub-traces
    subgraph &#34; &#34;
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRML
      PRML --&gt; PRUP
      PRUP --&gt; PRRD
      PRRD --&gt; PRRS
      PRRS --&gt; EXP2
      PRRS --&gt; EXP3
      PRRS --&gt; EXP1
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=42-test-attribute-processor>4.2 Test Attribute Processor</h1><p>In this exercise, we will <strong>delete</strong> the <code>user.account_password</code>, <strong>update</strong> the <code>user.phone_number</code> <strong>attribute</strong> and <strong>hash</strong> the <code>user.email</code> in the span data before it is exported by the <strong>Agent</strong>.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>: In your <strong>Gateway terminal</strong> window start the <strong>Gateway</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div><p><strong>Start the Agent</strong>: In your <strong>Agent terminal</strong> window start the <strong>Agent</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div><p><strong>Start the Load Generator</strong>: In the <strong>Loadgen terminal</strong> window start the <code>loadgen</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p><strong>Check the debug output</strong>: For both the <strong>Agent</strong> and <strong>Gateway</strong> confirm that <code>user.account_password</code> has been removed, and both <code>user.phone_number</code> & <code>user.email</code> have been updated:</p><div class=tab-panel data-tab-group=R-tabs-030e139b2385c099b06b4ef3902e412b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a06a0a7cdf0293156af7ecbc7e0168c5 aria-expanded=true data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-030e139b2385c099b06b4ef3902e412b","R-tab-544b1806b43b802fec2d6ad565a4b9ad")'>
<span class=tab-nav-text>New Debug Output</span>
</button>
<button aria-controls=R-tab-id-298599ae96991a413e1a486adbc1f091 aria-expanded=false data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-030e139b2385c099b06b4ef3902e412b","R-tab-8269dab52767aefab4c11aaa5d8bb8c8")'>
<span class=tab-nav-text>Original Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-a06a0a7cdf0293156af7ecbc7e0168c5 data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>   -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(UNKNOWN NUMBER)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(51.71)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(5555 5555 5555 4444)</span></span></code></pre></div></div></div><div id=R-tab-id-298599ae96991a413e1a486adbc1f091 data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>    -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>    -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>    -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>    -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>    -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>    -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>    -&gt; payment.amount: Double(95.22)</span></span></code></pre></div></div></div></div></div><p><strong>Check file output</strong>: Using <code>jq</code> validate that <code>user.account_password</code> has been removed, and <code>user.phone_number</code> & <code>user.email</code> have been updated in <code>gateway-taces.out</code>:</p><div class=tab-panel data-tab-group=R-tabs-fe8c561a2b4b8168a7409e965dad3bcd><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6c44ea6f91ab83a00b4cee982d56e166 aria-expanded=true data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fe8c561a2b4b8168a7409e965dad3bcd","R-tab-a1f23743b82743728073a9be5706f4e0")'>
<span class=tab-nav-text>Validate attribute changes</span>
</button>
<button aria-controls=R-tab-id-63494b6a9629a4bc627ba50f55f56cf8 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-fe8c561a2b4b8168a7409e965dad3bcd","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-6c44ea6f91ab83a00b4cee982d56e166 data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[].attributes[] | select(.key == &#34;user.password&#34; or .key == &#34;user.phone_number&#34; or .key == &#34;user.email&#34;) | {key: .key, value: .value.stringValue}&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-63494b6a9629a4bc627ba50f55f56cf8 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Notice that the <code>user.account_password</code> has been removed, and the <code>user.phone_number</code> & <code>user.email</code> have been updated:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.phone_number&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;UNKNOWN NUMBER&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.email&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=43-test-redaction-processor>4.3 Test Redaction Processor</h1><p>The <code>redaction</code> processor gives precise control over which attributes and values are <strong>permitted</strong> or <strong>removed</strong> from telemetry data.</p><p>In this exercise, we will <strong>redact</strong> the <code>user.visa</code> & <code>user.mastercard</code> values in the span data before it is exported by the <strong>Agent</strong>.<details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>: In your <strong>Gateway terminal</strong> window start the <strong>Gateway</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div><p><strong>Enable the <code>redaction/redact</code> processor</strong>: In the <strong>Agent terminal</strong> window, edit <code>agent.yaml</code> and remove the <code>#</code> we inserted in the previous exercise.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div><p><strong>Start the Agent</strong>: In your <strong>Agent terminal</strong> window start the <strong>Agent</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div><p><strong>Start the Load Generator</strong>: In the <strong>Loadgen terminal</strong> window start the <code>loadgen</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p><strong>Check the debug output</strong>: For both the <strong>Agent</strong> and <strong>Gateway</strong> confirm the values for <code>user.visa</code> & <code>user.mastercard</code> have been updated. Notice <code>user.amex</code> attribute value was <strong>NOT</strong> redacted because a matching regex pattern was not added to <code>blocked_values</code></p><div class=tab-panel data-tab-group=R-tabs-accac165973ee555d33267891d3a3579><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d98b02d8b6ea9d2e40fd05597581564a aria-expanded=true data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-accac165973ee555d33267891d3a3579","R-tab-544b1806b43b802fec2d6ad565a4b9ad")'>
<span class=tab-nav-text>New Debug Output</span>
</button>
<button aria-controls=R-tab-id-1c6966c7913328b6dd04c668b130153c aria-expanded=false data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-accac165973ee555d33267891d3a3579","R-tab-8269dab52767aefab4c11aaa5d8bb8c8")'>
<span class=tab-nav-text>Original Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d98b02d8b6ea9d2e40fd05597581564a data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>   -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(UNKNOWN NUMBER)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(69.71)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(****)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(****)
</span></span><span class=line><span class=cl>   -&gt; redaction.masked.keys: Str(user.mastercard,user.visa)
</span></span><span class=line><span class=cl>   -&gt; redaction.masked.count: Int(2)</span></span></code></pre></div></div></div><div id=R-tab-id-1c6966c7913328b6dd04c668b130153c data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>    -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>    -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>    -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>    -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>    -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>    -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>    -&gt; payment.amount: Double(65.54)</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>By including <code>summary:debug</code> in the redaction processor, the debug output will include summary information about which matching key values were redacted, along with the count of values that were masked.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>     -&gt; redaction.masked.keys: Str(user.mastercard,user.visa)
</span></span><span class=line><span class=cl>     -&gt; redaction.masked.count: Int(2)</span></span></code></pre></div></div></details><p><strong>Check file output</strong>: Using <code>jq</code> verify that <code>user.visa</code> & <code>user.mastercard</code> have been updated in the <code>gateway-traces.out</code>.</p><div class=tab-panel data-tab-group=R-tabs-c32a7b2d9d5a15259743ff32dffa49e6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-65726d7cb5df01814b79ad88d7afedbd aria-expanded=true data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c32a7b2d9d5a15259743ff32dffa49e6","R-tab-a1f23743b82743728073a9be5706f4e0")'>
<span class=tab-nav-text>Validate attribute changes</span>
</button>
<button aria-controls=R-tab-id-731c265d089a9eced99bcdee905a64fb aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-c32a7b2d9d5a15259743ff32dffa49e6","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-65726d7cb5df01814b79ad88d7afedbd data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[].attributes[] | select(.key == &#34;user.visa&#34; or .key == &#34;user.mastercard&#34; or .key == &#34;user.amex&#34;) | {key: .key, value: .value.stringValue}&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-731c265d089a9eced99bcdee905a64fb data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Notice that <code>user.amex</code> has not been redacted because a matching regex pattern was not added to <code>blocked_values</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.visa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;****&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.amex&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;3782 822463 10005&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.mastercard&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;****&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>These are just a couple of examples of how <code>attributes</code> and <code>redaction</code> processors can be configured to protect sensitive data.</p></div></details></p><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=5-transform-data>5. Transform Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>The <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/transformprocessor/README.md rel=external><strong>Transform Processor</strong></a> lets you modify telemetry dataâ€”logs, metrics, and tracesâ€”as it flows through the pipeline. Using the <strong>OpenTelemetry Transformation Language (OTTL)</strong>, you can filter, enrich, and transform data on the fly without touching your application code.</p><p>In this exercise weâ€™ll update <code>gateway.yaml</code> to include a <strong>Transform Processor</strong> that will:</p><ul><li><strong>Filter</strong> log resource attributes.</li><li><strong>Parse</strong> JSON structured log data into attributes.</li><li><strong>Set</strong> log severity levels based on the log message body.</li></ul><p>You may have noticed that in previous logs, fields like <code>SeverityText</code> and <code>SeverityNumber</code> were undefined. This is typical of the <code>filelog</code> receiver. However, the severity is embedded within the log body e.g.:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>SeverityText: 
</span></span><span class=line><span class=cl>SeverityNumber: Unspecified(0)
</span></span><span class=line><span class=cl>Body: Str(2025-01-31 15:49:29 [WARN] - Do or do not, there is no try.)</span></span></code></pre></div><p>Logs often contain structured data encoded as JSON within the log body. Extracting these fields into attributes allows for better indexing, filtering, and querying. Instead of manually parsing JSON in downstream systems, OTTL enables automatic transformation at the telemetry pipeline level.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>5-transform-data</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Copy <code>*.yaml</code> from the <code>4-sensitve-data</code> directory into <code>5-transform-data</code>. Your updated directory structure will now look like this:</p><div class=tab-panel data-tab-group=R-tabs-5a10fe7d1ad8b4c4e4c8504dba3ecbc7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1a67faab4930d08baaba475f0c513c24 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-5a10fe7d1ad8b4c4e4c8504dba3ecbc7","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-1a67faab4930d08baaba475f0c513c24 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 5. Transform Data</h1><article class=default><header class=headline></header><h1 id=51-configuration>5.1 Configuration</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Add a <code>transform</code> processor</strong>: Switch to your <strong>Gateway terminal</strong> window and edit the <code>gateway.yaml</code> and add the following <code>transform</code> processor:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>transform/logs</span><span class=p>:</span><span class=w>                      </span><span class=c># Processor Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>log_statements</span><span class=p>:</span><span class=w>                    </span><span class=c># Log Processing Statements</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>context</span><span class=p>:</span><span class=w> </span><span class=l>resource             </span><span class=w> </span><span class=c># Log Context</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>statements</span><span class=p>:</span><span class=w>                    </span><span class=c># List of attribute keys to keep</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>keep_keys(attributes, [&#34;com.splunk.sourcetype&#34;, &#34;host.name&#34;, &#34;otelcol.service.mode&#34;])</span></span></span></code></pre></div><p>By using the <code>-context: resource</code> key we are targeting the <code>resourceLog</code> attributes of logs.</p><p>This configuration ensures that only the relevant resource attributes (<code>com.splunk.sourcetype</code>, <code>host.name</code>, <code>otelcol.service.mode</code>) are retained, improving log efficiency and reducing unnecessary metadata.</p><p><strong>Adding a Context Block for Log Severity Mapping</strong>: To properly set the <code>severity_text</code> and <code>severity_number</code> fields of a log record, we add a <code>log</code> context block within <code>log_statements</code>. This configuration extracts the <code>level</code> value from the log body, maps it to <code>severity_text</code>, and assigns the corresponding <code>severity_number</code> based on the log level:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span>- <span class=nt>context</span><span class=p>:</span><span class=w> </span><span class=l>log                  </span><span class=w> </span><span class=c># Log Context</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>statements</span><span class=p>:</span><span class=w>                    </span><span class=c># Transform Statements Array</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(cache, ParseJSON(body)) where IsMatch(body, &#34;^\\{&#34;) </span><span class=w> </span><span class=c># Parse JSON log body into a cache object</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>flatten(cache, &#34;&#34;)                                       </span><span class=w> </span><span class=c># Flatten nested JSON structure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>merge_maps(attributes, cache, &#34;upsert&#34;)                  </span><span class=w> </span><span class=c># Merge cache into attributes, updating existing keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_text, attributes[&#34;level&#34;])                  </span><span class=w> </span><span class=c># Set severity_text from the &#34;level&#34; attribute</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 1) where severity_text == &#34;TRACE&#34;   </span><span class=w> </span><span class=c># Map severity_text to severity_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 5) where severity_text == &#34;DEBUG&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 9) where severity_text == &#34;INFO&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 13) where severity_text == &#34;WARN&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 17) where severity_text == &#34;ERROR&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 21) where severity_text == &#34;FATAL&#34;</span></span></span></code></pre></div><p>The <code>merge_maps</code> function is used to combine two maps (dictionaries) into one. In this case, it merges the <code>cache</code> object (containing parsed JSON data from the log body) into the <code>attributes</code> map.</p><ul><li><strong>Parameters</strong>:<ul><li><code>attributes</code>: The target map where the data will be merged.</li><li><code>cache</code>: The source map containing the parsed JSON data.</li><li><code>"upsert"</code>: This mode ensures that if a key already exists in the <code>attributes</code> map, its value will be updated with the value from <code>cache</code>. If the key does not exist, it will be inserted.</li></ul></li></ul><p>This step is crucial because it ensures that all relevant fields from the log body (e.g., <code>level</code>, <code>message</code>, etc.) are added to the <code>attributes</code> map, making them available for further processing or exporting.</p><p><strong>Summary of Key Transformations</strong>:</p><ul><li><strong>Parse JSON</strong>: Extracts structured data from the log body.</li><li><strong>Flatten JSON</strong>: Converts nested JSON objects into a flat structure.</li><li><strong>Merge Attributes</strong>: Integrates extracted data into log attributes.</li><li><strong>Map Severity Text</strong>: Assigns severity_text from the logâ€™s level attribute.</li><li><strong>Assign Severity Numbers</strong>: Converts severity levels into standardized numerical values.</li></ul><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>You should have a <strong>single</strong> <code>transform</code> processor containing two context blocks: one whose context is for <code>resource</code> and one whose context is for <code>log</code>.</p></div></details><p>This configuration ensures that log severity is correctly extracted, standardized, and structured for efficient processing.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>This method of mapping all JSON fields to top-level attributes should only be used for <strong>testing and debugging OTTL</strong>. It will result in high cardinality in a production scenario.</p></div></details><p><strong>Update the <code>logs</code> pipeline</strong>: Add the <code>transform/logs:</code> processor into the <code>logs:</code> pipeline so your configuration looks like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>                         </span><span class=c># Logs pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp                     </span><span class=w> </span><span class=c># OTLP receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>                 </span><span class=c># Processors for logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                    </span><span class=w> </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/logs</span></span></span></code></pre></div></div></details><p>Validate the agent configuration using <a href=https://otelbin.io/ rel=external><strong>https://otelbin.io</strong></a>. For reference, the <code>logs:</code> section of your pipelines will look similar to this:</p><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(transform&lt;br&gt;fa:fa-microchip&lt;br&gt;logs):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(file&lt;br&gt;fa:fa-upload&lt;br&gt;logs):::exporter
      EXP2(&amp;ensp;&amp;ensp;debug&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    %% Links
    subID1:::sub-logs
    subgraph &#34; &#34;
      subgraph subID1[**Logs**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO3
      PRO3 --&gt; PRO4
      PRO4 --&gt; PRO5
      PRO5 --&gt; EXP2
      PRO5 --&gt; EXP1
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=52-setup-environment>5.2 Setup Environment</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>: In the <strong>Gateway terminal</strong> run:</p><div class=tab-panel data-tab-group=R-tabs-f58ac44228d6c41d0b2dd03c1c94241b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a308b381d9b988c08b7988bd86a840c9 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f58ac44228d6c41d0b2dd03c1c94241b","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-a308b381d9b988c08b7988bd86a840c9 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Agent</strong>: In the <strong>Agent terminal</strong> run:</p><div class=tab-panel data-tab-group=R-tabs-730fb197785be311edd38ab375bcd023><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-fff810c8acc2fdf824017aa94caecd82 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-730fb197785be311edd38ab375bcd023","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-fff810c8acc2fdf824017aa94caecd82 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Load Generator</strong>: In the <strong>Loadgen terminal</strong> window, execute the following command to start the load generator with <strong>JSON enabled</strong>:</p><div class=tab-panel data-tab-group=R-tabs-655ce737402057d64b9c1a6dfdd3be65><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-35772ae579e479ec89ee032ece4b18c2 aria-expanded=true data-tab-item=R-tab-f39d270d077420f218253d70fb4d013a class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-655ce737402057d64b9c1a6dfdd3be65","R-tab-f39d270d077420f218253d70fb4d013a")'>
<span class=tab-nav-text>Log Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-35772ae579e479ec89ee032ece4b18c2 data-tab-item=R-tab-f39d270d077420f218253d70fb4d013a class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -logs -json -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p>The <code>loadgen</code> will write 5 log lines to <code>./quotes.log</code> in JSON format.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=53-test-transform-processor>5.3 Test Transform Processor</h1><p>This test verifies that the <code>com.splunk/source</code> and <code>os.type</code> metadata have been <strong>removed</strong> from the log resource attributes before being exported by the <strong>Agent</strong>. Additionally, the test ensures that:</p><ol><li>The log body is parsed to extract severity information.<ul><li><code>SeverityText</code> and <code>SeverityNumber</code> are set on the <code>LogRecord</code>.</li></ul></li><li>JSON fields from the log body are promoted to log <code>attributes</code>.</li></ol><p>This ensures proper metadata filtering, severity mapping, and structured log enrichment before exporting.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Check the debug output</strong>: For both the <strong>Agent</strong> and <strong>Gateway</strong> confirm that <code>com.splunk/source</code> and <code>os.type</code> have been removed:</p><div class=tab-panel data-tab-group=R-tabs-2015a8b0c2b55b23dd9240c4e7c6fd70><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-74716105a1cb53a3edd12d4499633f28 aria-expanded=true data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2015a8b0c2b55b23dd9240c4e7c6fd70","R-tab-e35301d59bcd0f79d44c5c0a86f077c6")'>
<span class=tab-nav-text>Gateway Debug Output</span>
</button>
<button aria-controls=R-tab-id-a43e4ec6ecf37069e3320f661ded3bbc aria-expanded=false data-tab-item=R-tab-42538fea3c4f3a8e2d3b752dbdb349e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-2015a8b0c2b55b23dd9240c4e7c6fd70","R-tab-42538fea3c4f3a8e2d3b752dbdb349e9")'>
<span class=tab-nav-text>Agent Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-74716105a1cb53a3edd12d4499633f28 data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Resource attributes:
</span></span><span class=line><span class=cl>   -&gt; com.splunk.sourcetype: Str(quotes)
</span></span><span class=line><span class=cl>   -&gt; host.name: Str(workshop-instance)
</span></span><span class=line><span class=cl>   -&gt; otelcol.service.mode: Str(agent)</span></span></code></pre></div></div></div><div id=R-tab-id-a43e4ec6ecf37069e3320f661ded3bbc data-tab-item=R-tab-42538fea3c4f3a8e2d3b752dbdb349e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Resource attributes:
</span></span><span class=line><span class=cl>   -&gt; com.splunk.source: Str(./quotes.log)
</span></span><span class=line><span class=cl>   -&gt; com.splunk.sourcetype: Str(quotes)
</span></span><span class=line><span class=cl>   -&gt; host.name: Str(workshop-instance)
</span></span><span class=line><span class=cl>   -&gt; os.type: Str(linux)
</span></span><span class=line><span class=cl>   -&gt; otelcol.service.mode: Str(agent)</span></span></code></pre></div></div></div></div></div><p>For both the <strong>Agent</strong> and <strong>Gateway</strong> confirm that <code>SeverityText</code> and <code>SeverityNumber</code> in the <code>LogRecord</code> is now defined with the severity <code>level</code> from the log body. Confirm that the JSON fields from the body can be accessed as top-level log <code>Attributes</code>:</p><div class=tab-panel data-tab-group=R-tabs-5fe7f756f1b6952b629ddd8c18e106c4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-38b36cb94fa7d8db5e2532f3aa8a661c aria-expanded=true data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-5fe7f756f1b6952b629ddd8c18e106c4","R-tab-e35301d59bcd0f79d44c5c0a86f077c6")'>
<span class=tab-nav-text>Gateway Debug Output</span>
</button>
<button aria-controls=R-tab-id-3d9fa8f29fd445306c4546236f48fb3b aria-expanded=false data-tab-item=R-tab-ead80b063f3a982e1fec2398ed5eb0e3 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-5fe7f756f1b6952b629ddd8c18e106c4","R-tab-ead80b063f3a982e1fec2398ed5eb0e3")'>
<span class=tab-nav-text>Agemt Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-38b36cb94fa7d8db5e2532f3aa8a661c data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>SeverityText: WARN
</span></span><span class=line><span class=cl>SeverityNumber: Warn(13)
</span></span><span class=line><span class=cl>Body: Str({&#34;level&#34;:&#34;WARN&#34;,&#34;message&#34;:&#34;Your focus determines your reality.&#34;,&#34;movie&#34;:&#34;SW&#34;,&#34;timestamp&#34;:&#34;2025-03-07 11:17:26&#34;})
</span></span><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; log.file.path: Str(quotes.log)
</span></span><span class=line><span class=cl>     -&gt; level: Str(WARN)
</span></span><span class=line><span class=cl>     -&gt; message: Str(Your focus determines your reality.)
</span></span><span class=line><span class=cl>     -&gt; movie: Str(SW)
</span></span><span class=line><span class=cl>     -&gt; timestamp: Str(2025-03-07 11:17:26)
</span></span><span class=line><span class=cl>&lt;/snip&gt;</span></span></code></pre></div></div></div><div id=R-tab-id-3d9fa8f29fd445306c4546236f48fb3b data-tab-item=R-tab-ead80b063f3a982e1fec2398ed5eb0e3 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>SeverityText:
</span></span><span class=line><span class=cl>SeverityNumber: Unspecified(0)
</span></span><span class=line><span class=cl>Body: Str({&#34;level&#34;:&#34;WARN&#34;,&#34;message&#34;:&#34;Your focus determines your reality.&#34;,&#34;movie&#34;:&#34;SW&#34;,&#34;timestamp&#34;:&#34;2025-03-07 11:17:26&#34;})
</span></span><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; log.file.path: Str(quotes.log)
</span></span><span class=line><span class=cl>&lt;/snip&gt;</span></span></code></pre></div></div></div></div></div><p><strong>Check file output</strong>: In the new <code>gateway-logs.out</code> file verify the data has been transformed:</p><div class=tab-panel data-tab-group=R-tabs-b7201b0388b727690cd5843a680be399><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-928de8f7cd8aca5b1b12b43a1303f7f5 aria-expanded=true data-tab-item=R-tab-58659ac8bbb7a3ec80b7df1029812298 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b7201b0388b727690cd5843a680be399","R-tab-58659ac8bbb7a3ec80b7df1029812298")'>
<span class=tab-nav-text>jq Query</span>
</button>
<button aria-controls=R-tab-id-77abb3465b8b689c95335f377025a7fb aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b7201b0388b727690cd5843a680be399","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-928de8f7cd8aca5b1b12b43a1303f7f5 data-tab-item=R-tab-58659ac8bbb7a3ec80b7df1029812298 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;[.resourceLogs[].scopeLogs[].logRecords[] | {severityText, severityNumber, body: .body.stringValue}]&#39;</span> gateway-logs.out</span></span></code></pre></div></div></div><div id=R-tab-id-77abb3465b8b689c95335f377025a7fb data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;DEBUG&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;DEBUG\&#34;,\&#34;message\&#34;:\&#34;All we have to decide is what to do with the time that is given us.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;WARN&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>13</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;WARN\&#34;,\&#34;message\&#34;:\&#34;The Force will be with you. Always.\&#34;,\&#34;movie\&#34;:\&#34;SW\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;ERROR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>17</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;ERROR\&#34;,\&#34;message\&#34;:\&#34;One does not simply walk into Mordor.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;DEBUG&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;DEBUG\&#34;,\&#34;message\&#34;:\&#34;Do or do not, there is no try.\&#34;,\&#34;movie\&#34;:\&#34;SW\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;ERROR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>17</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;ERROR\&#34;,\&#34;message\&#34;:\&#34;There is some good in this world, and it&#39;s worth fighting for.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=6-routing-data>6. Routing Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>The <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/routingconnector rel=external><strong>Routing Connector</strong></a> in OpenTelemetry is a powerful feature that allows you to direct data (<code>traces</code>, <code>metrics</code>, or <code>logs</code>) to different pipelines/destinations based on specific criteria. This is especially useful in scenarios where you want to apply different processing or exporting logic to subsets of your telemetry data.</p><p>For example, you might want to send <em>production</em> data to one exporter while directing <em>test</em> or <em>development</em> data to another. Similarly, you could route certain spans based on their attributes, such as service name, environment, or span name, to apply custom processing or storage logic.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>6-routing-data</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Copy <code>*.yaml</code> from the <code>5-transform-data</code> directory into <code>6-routing-data</code>. Your updated directory structure will now look like this:</p><div class=tab-panel data-tab-group=R-tabs-72dc38de6320d25fa87905f521e60ddb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-778475c2a501b5bc2493758a9b47b43e aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-72dc38de6320d25fa87905f521e60ddb","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-778475c2a501b5bc2493758a9b47b43e data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><p>Next, we will configure the routing connector and the respective pipelines.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 6. Routing Data</h1><article class=default><header class=headline></header><h1 id=61-configure-the-routing-connector>6.1 Configure the Routing Connector</h1><p>In this exercise, you will configure the <strong>Routing Connector</strong> in the <code>gateway.yaml</code>. The Routing Connector can route metrics, traces, and logs based on any attributes, we will focus exclusively on trace routing based on the <code>deployment.environment</code> attribute (though any span/log/metirc attribute can be used).</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Add new <code>file</code> exporters</strong>: The <code>routing</code> connector requires different targets for routing. In the <strong>Gateway terminal</strong> create two new file exporters, <code>file/traces/route1-regular</code> and <code>file/traces/route2-security</code>, to ensure data is directed correctly in the <code>exporters</code> section of the <code>gateway.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces/route1-regular</span><span class=p>:</span><span class=w>                     </span><span class=c># Exporter for regular traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces-route1-regular.out&#34;</span><span class=w>   </span><span class=c># Path for saving trace data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces/route2-security</span><span class=p>:</span><span class=w>                    </span><span class=c># Exporter for security traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces-route2-security.out&#34;</span><span class=w>  </span><span class=c># Path for saving trace data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                                 </span><span class=c># Overwrite the file each time </span></span></span></code></pre></div><p><strong>Enable Routing</strong> by adding the <code>routing</code> connector. In OpenTelemetry configuration files, <code>connectors</code> have their own dedicated section, similar to receivers and processors.</p><p>Find and uncomment the <code>#connectors:</code> section. Then, add the following below the <code>connectors:</code> section:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>routing</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>default_pipelines</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>traces/route1-regular] </span><span class=w> </span><span class=c># Default pipeline if no rule matches</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>error_mode</span><span class=p>:</span><span class=w> </span><span class=l>ignore                         </span><span class=w> </span><span class=c># Ignore errors in routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>table</span><span class=p>:</span><span class=w>                                      </span><span class=c># Define routing rules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Routes spans to a target pipeline if the resourceSpan attribute matches the rule</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>statement</span><span class=p>:</span><span class=w> </span><span class=l>route() where attributes[&#34;deployment.environment&#34;] == &#34;security-applications&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>pipelines</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>traces/route2-security]    </span><span class=w> </span><span class=c># Security target pipeline </span></span></span></code></pre></div></div></details><p>The default pipeline in the configuration file works at a Catch all. It will be the routing target for any data (spans in our case) that do not match a rule in the routing rules table, In this table you find the pipeline that is the target for any span that matches the following rule: <code>["deployment.environment"] == "security-applications"</code></p><p>With the <code>routing</code> configuration complete, the next step is to configure the <code>pipelines</code> to apply these routing rules.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=62-configuring-the-pipelines>6.2 Configuring the Pipelines</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Update the original <code>traces</code> pipeline to use routing</strong>:</p><ol><li><p>To enable <code>routing</code>, update the original <code>traces</code> pipeline to use <code>routing</code> as the only exporter. This ensures all span data is sent through the <strong>Routing Connector</strong> for evaluation and then onwards to connected pipelines. Also, remove <strong>all</strong> processors and replace it with an empty array (<code>[]</code>) as this will now behandeld in the <code>traces/route1-regular</code> and <code>traces/route2-security</code> pipelines, allowing for custom behaviour for each route. Your <code>traces:</code> configuration should look like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>traces</span><span class=p>:</span><span class=w>                       </span><span class=c># Traces pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>otlp                     </span><span class=w> </span><span class=c># OTLP receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=w>              </span><span class=c># Processors for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>routing</span></span></span></code></pre></div></li></ol><p><strong>Add both the <code>route1-regular</code> and <code>route2-security</code> traces pipelines</strong> below the existing <code>traces</code> pipeline:</p><ol><li><p><strong>Configure Route1-regular pipeline</strong>: This pipeline will handle all spans that have <strong>no match</strong> in the routing table in the connector.
Notice this uses <code>routing</code> as its only receiver and will recieve data thought its <code>connection</code> from the original traces pipeline.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces/route1-regular</span><span class=p>:</span><span class=w>         </span><span class=c># Default pipeline for unmatched spans</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>routing                   </span><span class=w> </span><span class=c># Receive data from the routing connector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter            </span><span class=w> </span><span class=c># Memory Limiter Processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode         </span><span class=w> </span><span class=c># Adds collector mode metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                     </span><span class=w> </span><span class=c># Debug Exporter </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces/route1-regular</span><span class=w> </span><span class=c># File Exporter for unmatched spans </span></span></span></code></pre></div></li><li><p><strong>Add the route2-security pipeline</strong>: This pipeline processes all spans that do match our rule <code>"[deployment.environment"] == "security-applications"</code> in the the routing rule. This pipeline is also using <code>routing</code> as its receiver. Add this pipline below the <code>traces/route1-regular</code> one.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces/route2-security</span><span class=p>:</span><span class=w>         </span><span class=c># Default pipeline for unmatched spans</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>routing                    </span><span class=w> </span><span class=c># Receive data from the routing connector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter             </span><span class=w> </span><span class=c># Memory Limiter Processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode          </span><span class=w> </span><span class=c># Adds collector mode metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                      </span><span class=w> </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces/route2-security</span><span class=w> </span><span class=c># File exporter for unmatched spans</span></span></span></code></pre></div></li></ol></div></details><p>Validate the agent configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>traces:</code> section of your pipelines will look similar to this:</p><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO2(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      PRO6(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
      EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP4(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
      ROUTE1(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-export
      ROUTE2(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive
      ROUTE3(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive
    %% Links
    subID1:::sub-traces
    subID2:::sub-traces
    subID3:::sub-traces
    subgraph &#34; &#34;
    direction LR
      subgraph subID1[**Traces**]
      REC1 --&gt; ROUTE1
      end
      subgraph subID2[**Traces/route2-security**]
      ROUTE1 --&gt; ROUTE2
      ROUTE2 --&gt; PRO1
      PRO1 --&gt; PRO3
      PRO3 --&gt; PRO5
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end
      subgraph subID3[**Traces/route1-regular**]
      ROUTE1 --&gt; ROUTE3
      ROUTE3 --&gt; PRO2
      PRO2 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=63-test-routing-connector>6.3 Test Routing Connector</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>In this section, we will test the <code>routing</code> rule configured for the <strong>Gateway</strong>. The expected result is that a <code>span</code> generated by the <code>loadgen</code> that match the <code>"[deployment.environment"] == "security-applications"</code> rule will be sent to the <code>gateway-traces-route2-security.out</code> file.</p><p><strong>Start the Gateway</strong>: In your <strong>Gateway terminal</strong> window start the <strong>Gateway</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config gateway.yaml</span></span></code></pre></div><p><strong>Start the Agent</strong>: In your <strong>Agent terminal</strong> window start the <strong>Agent</strong>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config agent.yaml</span></span></code></pre></div><p><strong>Send a Regular Span</strong>: In the <strong>Loadgen terminal</strong> window send a regular span using the <code>loadgen</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p>Both the <strong>Agent</strong> and <strong>Gateway</strong> will display debug information. The gateway will also generate a new <code>gateway-traces-route1-regular.out</code> file, as this is now the designated destination for regular spans.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you check <code>gateway-traces-route1-regular.out</code>, it will contain the <code>span</code> sent by <code>loadgen</code>. You will also see an empty <code>gateway-traces-route2-security..out</code> file, as the routing configuration creates output files immediately, even if no matching spans have been processed yet.</p></div></details><p><strong>Send a Security Span</strong>: In the <strong>Loadgen terminal</strong> window send a security span using the <code>security</code> flag:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -security -count <span class=m>1</span></span></span></code></pre></div><p>Again, both the <strong>Agent</strong> and <strong>Gateway</strong> should display debug information, including the span you just sent. This time, the <strong>Gateway</strong> will write a line to the <code>gateway-traces-route2-security.out</code> file, which is designated for spans where the <code>deployment.environment</code> resource attribute matches <code>"security-applications"</code>.</p><div class=tab-panel data-tab-group=R-tabs-fcb1d6517bd66f3366d9ca2cae8a2022><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-86500b425f9d80889bbb9ed3615ae6a5 aria-expanded=true data-tab-item=R-tab-ad0c2b09920ec6396d478d255cb39b4d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fcb1d6517bd66f3366d9ca2cae8a2022","R-tab-ad0c2b09920ec6396d478d255cb39b4d")'>
<span class=tab-nav-text>Validate resource attribute matches</span>
</button>
<button aria-controls=R-tab-id-f92a22fe0e3b6fc29c5b5c31a00c811a aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-fcb1d6517bd66f3366d9ca2cae8a2022","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-86500b425f9d80889bbb9ed3615ae6a5 data-tab-item=R-tab-ad0c2b09920ec6396d478d255cb39b4d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[] as $resource | $resource.scopeSpans[].spans[] | {spanId: .spanId, deploymentEnvironment: ($resource.resource.attributes[] | select(.key == &#34;deployment.environment&#34;) | .value.stringValue)}&#39;</span> gateway-traces-route2-security.out</span></span></code></pre></div></div></div><div id=R-tab-id-f92a22fe0e3b6fc29c5b5c31a00c811a data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;spanId&#34;</span><span class=p>:</span><span class=s2>&#34;cb799e92e26d5782&#34;</span><span class=p>,</span><span class=nt>&#34;deploymentEnvironment&#34;</span><span class=p>:</span><span class=s2>&#34;security-applications&#34;</span><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>You can repeat this scenario multiple times, and each trace will be written to its corresponding output file.</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details><h2 id=conclusion>Conclusion</h2><p>In this section, we successfully tested the routing connector in the gateway by sending different spans and verifying their destinations.</p><ul><li><p><strong>Regular spans</strong> were correctly routed to <code>gateway-traces-route1-regular.out</code>, confirming that spans without a matching <code>deployment.environment</code> attribute follow the default pipeline.</p></li><li><p><strong>Security-related spans</strong> were routed to <code>gateway-traces-route2-security.out</code>, demonstrating that the routing rule based on <code>"deployment.environment": "security-applications"</code> works as expected.</p></li></ul><p>By inspecting the output files, we confirmed that the OpenTelemetry Collector <em>correctly evaluates span attributes and routes them to the appropriate destinations</em>. This validates that routing rules can effectively separate and direct telemetry data for different use cases.</p><p>You can now extend this approach by defining additional routing rules to further categorize spans, metrics, and logs based on different attributes.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=7-create-metrics-with-count-connector>7. Create metrics with Count Connector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, we&rsquo;ll explore how to use the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector rel=external><strong>Count Connector</strong></a> to extract attribute values from logs and convert them into meaningful metrics.</p><p>Specifically, we&rsquo;ll use the Count Connector to track the number of &ldquo;Star Wars&rdquo; and &ldquo;Lord of the Rings&rdquo; quotes appearing in our logs, turning them into measurable data points.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Change <em>ALL</em> terminal windows to the <code>7-sum-count</code> directory and run the <code>clear</code> command.</strong></p></div></details><p>Copy <code>*.yaml</code> from the <code>6-routing-data</code> directory into <code>7-sum-count</code>. Your updated directory structure will now look like this:</p><div class=tab-panel data-tab-group=R-tabs-d3c83fd19badfa792bd5bd7759c3a361><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-44a80f2495a7e36fd3a58df1353e80d9 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d3c83fd19badfa792bd5bd7759c3a361","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-44a80f2495a7e36fd3a58df1353e80d9 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><ul><li><strong>Update the agent.yaml</strong> to change the frequency that we read logs.
Find the <code>filelog/quotes</code> receiver in the <code>agent.yaml</code> and add a <code>poll_interval</code> attribute:</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>filelog/quotes</span><span class=p>:</span><span class=w>                      </span><span class=c># Receiver Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>poll_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s                </span><span class=w> </span><span class=c># Only read every ten seconds </span></span></span></code></pre></div></div></details><p>The reason for the delay is that the Count Connector in the OpenTelemetry Collector counts logs only within each processing interval. This means that every time the data is read, the count resets to zero for the next interval. With the default <code>Filelog reciever</code> interval of 200ms, it reads every line the loadgen writes, giving us counts of 1. With this interval we make sure we have multiple entries to count.</p><p>The Collector can maintain a running count for each read interval by omitting conditions, as shown below. However, itâ€™s best practice to let your backend handle running counts since it can track them over a longer time period.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong>Add the Count Connector</strong></li></ul><p>Include the Count Connector in the connector&rsquo;s section of your configuration and define the metrics counters we want to use:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>connectors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.full.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Running count of all logs read in interval&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.sw.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;StarWarsCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;movie&#34;] == &#34;SW&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.lotr.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LOTRCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;movie&#34;] == &#34;LOTR&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.error.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;ErrorCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;level&#34;] == &#34;ERROR&#34;</span></span></span></code></pre></div><ul><li><p><strong>Explanation of the Metrics Counters</strong></p><ul><li><code>logs.full.count</code>: Tracks the total number of logs processed during each read interval.<br>Since this metric has no filtering conditions, every log that passes through the system is included in the count.</li><li><code>logs.sw.count</code> Counts logs that contain a quote from a Star Wars movie.</li><li><code>logs.lotr.count</code>: Counts logs that contain a quote from a Lord of the Rings movie.</li><li><code>logs.error.count</code>: Represents a real-world scenario by counting logs with a severity level of ERROR for the read interval.</li></ul></li><li><p><strong>Configure the Count Connector in the pipelines</strong><br>In the pipeline configuration below, the connector exporter is added to the <code>logs</code> section, while the connector receiver is added to the <code>metrics</code> section.</p></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                          </span><span class=w> </span><span class=c># Count Connector that receives count metric from logs count exporter in logs pipeline. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- hostmetrics                    # Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filelog/quotes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs                </span><span class=w> </span><span class=c># Transform logs processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Count Connector that exports count as a metric to metrics pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div></div></details><p>We count logs based on their attributes. If your log data is stored in the log body instead of attributes, youâ€™ll need to use a <code>Transform</code> processor in your pipeline to extract key/value pairs and add them as attributes.</p><p>In this workshop, weâ€™ve already added <code>merge_maps(attributes, cache, "upsert")</code> in the <code>05-transform-data</code> section. This ensures that all relevant data is included in the log attributes for processing.</p><p>When selecting fields to create attributes from, be mindfulâ€”adding all fields indiscriminately is generally not ideal for production environments. Instead, choose only the fields that are truly necessary to avoid unnecessary data clutter.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong>Validate</strong> the agent configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>logs</code> and <code>metrics:</code> sections of your pipelines will look like this:</li></ul><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
    REC1(otlp&lt;br&gt;fa:fa-download):::receiver
    REC2(filelog&lt;br&gt;fa:fa-download&lt;br&gt;quotes):::receiver
    REC3(otlp&lt;br&gt;fa:fa-download):::receiver
    PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
    PRO2(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
    PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
    PRO6(batch&lt;br&gt;fa:fa-microchip):::processor
    PRO7(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
    PRO8(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
    PRO9(transfrom&lt;br&gt;fa:fa-microchip&lt;br&gt;logs):::processor
    EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    EXP2(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload):::exporter
    EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    EXP4(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload):::exporter
    ROUTE1(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route):::con-export
    ROUTE2(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive

    %% Links
    subID1:::sub-logs
    subID2:::sub-metrics
    subgraph &#34; &#34; 
      direction LR
      subgraph subID1[**Logs**]
      direction LR
      REC1 --&gt; PRO1
      REC2 --&gt; PRO1
      PRO1 --&gt; PRO7
      PRO7 --&gt; PRO3
      PRO3 --&gt; PRO9
      PRO9 --&gt; PRO5
      PRO5 --&gt; ROUTE1
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end
      
      subgraph subID2[**Metrics**]
      direction LR
      ROUTE1 --&gt; ROUTE2       
      ROUTE2 --&gt; PRO2
      REC3 --&gt; PRO2
      PRO2 --&gt; PRO8
      PRO8 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 7. Count & Sum Connector</h1><article class=default><header class=headline></header><h1 id=71-testing-the-count-connector>7.1 Testing the Count Connector</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>:<br>In the <strong>Gateway terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-a38df6e333ddbec499954ad094be653d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a8d7e1606d2f2301aa90f941e0f660f7 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a38df6e333ddbec499954ad094be653d","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-a8d7e1606d2f2301aa90f941e0f660f7 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Agent</strong>:<br>In the <strong>Agent terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-8bd29a4bda89912770a2fcb7ecd2c636><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-61a00d824cffbd311331e6ad706e95d1 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-8bd29a4bda89912770a2fcb7ecd2c636","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-61a00d824cffbd311331e6ad706e95d1 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Send 12 Logs lines with the Loadgen</strong>:<br>In the <strong>Spans terminal</strong> window send 12 log lines, they should be read in two intervals. Do this with the following <code>loadgen</code> command:</p><div class=tab-panel data-tab-group=R-tabs-0704fcff49b82650dcc5afc06fcee094><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-732b658e3adedab5bdeeb49f3718dc43 aria-expanded=true data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-0704fcff49b82650dcc5afc06fcee094","R-tab-c04840259ee1732c29330a07b53ce556")'>
<span class=tab-nav-text>Loadgen</span></button></div><div class=tab-content-container><div id=R-tab-id-732b658e3adedab5bdeeb49f3718dc43 data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -logs -json -count <span class=m>12</span></span></span></code></pre></div></div></div></div></div><p>Both the <strong>Agent</strong> and <strong>Gateway</strong> will display debug information, showing they are processing data. Wait until the <code>loadgen</code> completes.</p><p><strong>Verify metrics have been generated</strong><br>As the logs are processed, the <strong>Agent</strong> generates metrics and forwards them to the <strong>Gateway</strong>, which then writes them to <code>gateway-metrics.out</code>.</p><p>To check if the metrics <code>logs.full.count</code>, <code>logs.sw.count</code>, <code>logs.lotr.count</code>, and <code>logs.error.count</code> are present in the output, run the following <strong>jq</strong> query:</p><div class=tab-panel data-tab-group=R-tabs-a58350f76469d5dd0abe38b3e15367db><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-84ab605df0e7268e1174c3a5e9d68d21 aria-expanded=true data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a58350f76469d5dd0abe38b3e15367db","R-tab-5bcdc0d6fffb60ccb3e52026507edd53")'>
<span class=tab-nav-text>jq query command</span>
</button>
<button aria-controls=R-tab-id-f4084ca67933cd546b8a7cf00346731d aria-expanded=false data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-a58350f76469d5dd0abe38b3e15367db","R-tab-845b9df504b40e63fe9060457ddcf4e9")'>
<span class=tab-nav-text>jq example output</span></button></div><div class=tab-content-container><div id=R-tab-id-84ab605df0e7268e1174c3a5e9d68d21 data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[]
</span></span></span><span class=line><span class=cl><span class=s1>    | select(.name == &#34;logs.full.count&#34; or .name == &#34;logs.sw.count&#34; or .name == &#34;logs.lotr.count&#34; or .name == &#34;logs.error.count&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    | {name: .name, value: (.sum.dataPoints[0].asInt // &#34;-&#34;)}&#39;</span> gateway-metrics.out</span></span></code></pre></div></div></div><div id=R-tab-id-f4084ca67933cd546b8a7cf00346731d data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.sw.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.lotr.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.full.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.error.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.error.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.sw.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.lotr.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;6&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.full.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;8&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Note: the <code>logs.full.count</code> normally is equal to <code>logs.sw.count</code> + <code>logs.lotr.count</code>, while the <code>logs.error.count</code> will be a random number.</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=72-create-metrics-with-sum-connector>7.2 Create metrics with Sum Connector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this section, weâ€™ll explore how the <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/sumconnector rel=external><strong>Sum Connector</strong></a> can extract values from spans and convert them into metrics.</p><p>Weâ€™ll specifically use the credit card charges from our base spans and leverage the Sum Connector to retrieve the total charges as a metric.</p><p>The connector can be used to collect (<strong>sum</strong>) attribute values from spans, span events, metrics, data points, and log records. It captures each individual value, transforms it into a metric, and passes it along. However, itâ€™s the <strong>backendâ€™s</strong> job to use these metrics and their attributes for calculations and further processing.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>Switch to your <strong>Agent terminal</strong> window and open the <code>agent.yaml</code> file in your editor.</p><ul><li><strong>Add the Sum Connector</strong><br>Include the Sum Connector in the connectors section of your configuration and define the metrics counters:</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>sum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spans</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nt>user.card-charge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>source_attribute</span><span class=p>:</span><span class=w> </span><span class=l>payment.amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>attributes[&#34;payment.amount&#34;] != &#34;NULL&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span></span></span></code></pre></div></div></details><p>In the example above, we check for the <code>payment.amount</code> attribute in spans. If it has a valid value, the <strong>Sum</strong> connector generates a metric called <code>user.card-charge</code> and includes the <code>user.name</code> as an attribute. This enables the backend to track and display a userâ€™s total charges over an extended period, such as a billing cycle.</p><p>In the pipeline configuration below, the connector exporter is added to the traces section, while the connector receiver is added to the metrics section.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong>Configure the Count Connector in the pipelines</strong></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>sum                           </span><span class=w> </span><span class=c># Sum connector which aggregates payment.amount from spans and sends to metrics pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>sum                           </span><span class=w> </span><span class=c># Receives metrics from the sum exporter in the traces pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Receives count metric from logs count exporter in logs pipeline. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- hostmetrics                   # Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filelog/quotes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs                </span><span class=w> </span><span class=c># Transform logs processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Count Connector that exports count as a metric to metrics pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div><ul><li><strong>Validate</strong> the agent configuration using <strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong>. For reference, the <code>traces</code> and <code>metrics:</code> sections of your pipelines will look like this:</li></ul><pre class="mermaid align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
    REC1(otlp&lt;br&gt;fa:fa-download&lt;br&gt; ):::receiver
    REC3(otlp&lt;br&gt;fa:fa-download&lt;br&gt; ):::receiver
    PRO1(memory_limiter&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO2(memory_limiter&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO5(batch&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO6(batch&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO7(resourcedetection&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO8(resourcedetection&lt;br&gt;fa:fa-microchip&lt;br&gt;):::processor

    PROA(attributes&lt;br&gt;fa:fa-microchip&lt;br&gt;redact):::processor
    PROB(redaction&lt;br&gt;fa:fa-microchip&lt;br&gt;update):::processor
    EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP2(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP4(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP5(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    ROUTE1(&amp;nbsp;sum&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-export
    ROUTE2(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-receive
    ROUTE3(&amp;nbsp;sum&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-receive

    %% Links
    subID1:::sub-traces
    subID2:::sub-metrics
    subgraph &#34; &#34; 
      direction LR
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PROA
      PROA --&gt; PROB
      PROB --&gt; PRO7
      PRO7 --&gt; PRO3
      PRO3 --&gt; PRO5 
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      PRO5 --&gt; EXP5
      PRO5 --&gt; ROUTE1
      end
      
      subgraph subID2[**Metrics**]
      direction LR
      ROUTE1 --&gt; ROUTE3
      ROUTE3 --&gt; PRO2       
      ROUTE2 --&gt; PRO2
      REC3 --&gt; PRO2
      PRO2 --&gt; PRO8
      PRO8 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=73-testing-the-count-connector>7.3 Testing the Count Connector</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Start the Gateway</strong>:<br>In the <strong>Gateway terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-7e795c8ef5b7c7b15910ff10d7fee1a7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-06ab97e6b658c34ad4a330c738ab7e58 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7e795c8ef5b7c7b15910ff10d7fee1a7","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-06ab97e6b658c34ad4a330c738ab7e58 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Agent</strong>:<br>In the <strong>Agent terminal</strong> window run:</p><div class=tab-panel data-tab-group=R-tabs-74e255e11b0b004c08d5f7f5c5cd7d5a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-7af05932c7289e2a5c2ec79ea53213f3 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-74e255e11b0b004c08d5f7f5c5cd7d5a","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-7af05932c7289e2a5c2ec79ea53213f3 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Start the Loadgen</strong>:<br>In the <strong>Spans terminal</strong> window send 8 spans with the following <code>loadgen</code> command:</p><div class=tab-panel data-tab-group=R-tabs-d28a4cf782d71fec26c50fc1c2960a72><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8d86f7fe9ca6098fd87ec91f12313b35 aria-expanded=true data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d28a4cf782d71fec26c50fc1c2960a72","R-tab-c04840259ee1732c29330a07b53ce556")'>
<span class=tab-nav-text>Loadgen</span></button></div><div class=tab-content-container><div id=R-tab-id-8d86f7fe9ca6098fd87ec91f12313b35 data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>8</span></span></span></code></pre></div></div></div></div></div><p>Both the <strong>Agent</strong> and <strong>Gateway</strong> will display debug information, showing they are processing data. Wait until the loadgen completes.</p><p><strong>Verify the metrics</strong>:<br>While processing the span, the <strong>Agent</strong>, has generated metrics and passed them on to the <strong>Gateway</strong>. The <strong>Gateway</strong> has written them into <code>gateway-metrics.out</code>.</p><p>To confirm the presence of <code>user.card-charge</code>and verify each one has an attribute <code>user.name</code> in the metrics output, run the following jq query:</p><div class=tab-panel data-tab-group=R-tabs-7896d953cffb85205c46c91eef8f281f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-512d77e77dd29633fa599c64d08d98df aria-expanded=true data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7896d953cffb85205c46c91eef8f281f","R-tab-5bcdc0d6fffb60ccb3e52026507edd53")'>
<span class=tab-nav-text>jq query command</span>
</button>
<button aria-controls=R-tab-id-39dec4602656419ef281b76b3fdae149 aria-expanded=false data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7896d953cffb85205c46c91eef8f281f","R-tab-845b9df504b40e63fe9060457ddcf4e9")'>
<span class=tab-nav-text>jq example output</span></button></div><div class=tab-content-container><div id=R-tab-id-512d77e77dd29633fa599c64d08d98df data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -r <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[] | select(.name == &#34;user.card-charge&#34;) | .sum.dataPoints[] | &#34;\(.attributes[] | select(.key == &#34;user.name&#34;).value.stringValue)\t\(.asDouble)&#34;&#39;</span> gateway-metrics.out <span class=p>|</span> <span class=k>while</span> <span class=nv>IFS</span><span class=o>=</span><span class=s1>$&#39;\t&#39;</span> <span class=nb>read</span> -r name charge<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>printf</span> <span class=s2>&#34;%-20s %s\n&#34;</span> <span class=s2>&#34;</span><span class=nv>$name</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$charge</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>    </span></span></code></pre></div></div></div><div id=R-tab-id-39dec4602656419ef281b76b3fdae149 data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>George Lucas         67.49
</span></span><span class=line><span class=cl>Frodo Baggins        87.14
</span></span><span class=line><span class=cl>Thorin Oakenshield   90.98
</span></span><span class=line><span class=cl>Luke Skywalker       51.37
</span></span><span class=line><span class=cl>Luke Skywalker       65.56
</span></span><span class=line><span class=cl>Thorin Oakenshield   67.5
</span></span><span class=line><span class=cl>Thorin Oakenshield   66.66
</span></span><span class=line><span class=cl>Peter Jackson        94.39</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Stop the <strong>Agent</strong> and the <strong>Gateway</strong> processes by pressing <code>Ctrl-C</code> in their respective terminals.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=8-wrap-up>8. Wrap-up</h1><p><a href=#R-image-6ef3bbfcafb99a3e0776a6cbdc587225 class=lightbox-link><img alt="Well done" class="lazy lightbox figure-image" loading=lazy src=../images/welldone.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ef3bbfcafb99a3e0776a6cbdc587225><img alt="Well done" class="lazy lightbox lightbox-image" loading=lazy src=../images/welldone.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2025</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=splunk-synthetic-scripting>Splunk Synthetic Scripting</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Robert Castley</span></span><p>Proactively monitor the performance of your web app before problems affect your users. With <strong>Splunk Synthetic Monitoring</strong>, technical and business teams create detailed tests to proactively monitor the speed and reliability of websites, web apps, and resources over time, at any stage in the development cycle.</p><p><strong>Splunk Synthetic Monitoring</strong> offers the most comprehensive and in-depth capabilities for uptime and web performance optimization as part of the only complete observability suite, Splunk Observability Cloud.</p><p>Easily set up monitoring for APIs, service endpoints and end-user experience. With <strong>Splunk Synthetic Monitoring</strong>, go beyond basic uptime and performance monitoring and focus on proactively finding and fixing issues, optimizing web performance, and ensuring customers get the best user experience.</p><p>With <strong>Splunk Synthetic Monitoring</strong> you can:</p><ul><li>Detect and resolve issues fast across critical user flows, business transactions and API endpoints</li><li>Prevent web performance issues from affecting customers with an intelligent web optimization engine</li><li>And improve the performance of all page resources and third-party dependencies</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk Synthetic Scripting</h1><article class=default><header class=headline></header><h1 id=1-real-browser-test>1. Real Browser Test</h1><h2 id=introduction>Introduction</h2><p>This workshop walks you through using the <a href=https://developer.chrome.com/docs/devtools/recorder/ rel=external>Chrome DevTools Recorder</a> to create a synthetic transaction against a Splunk demonstration instance.</p><p>The exported JSON from the Chrome DevTools Recorder will then be used to create a Splunk Synthetic Monitoring Real Browser Test.</p><p>In addition, you will also get to learn other Splunk Synthetic Monitoring checks like <a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html rel=external>API Test</a> and <a href=https://docs.splunk.com/Observability/synthetics/uptime-test/uptime-test.html rel=external>Uptime Test</a>.</p><h2 id=pre-requisites>Pre-requisites</h2><ul><li>Google Chrome Browser installed</li><li>Access to Splunk Observability Cloud</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Real Browser Test</h1><article class=default><header class=headline></header><h1 id=11-recording-a-test>1.1 Recording a test</h1><h2 id=open-the-starting-url>Open the starting URL</h2><p>Open the starting URL for the workshop in Chrome. Click on the appropriate link below to open the site in a new tab.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The starting URL for the workshop is different for <strong>EMEA</strong> and <strong>AMER/APAC</strong>. Please use the correct URL for your region.</p><div class=tab-panel data-tab-group=R-tabs-702c85718b21c93e6bf329d8a6ac3f09><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d93c1515847a22fc4210b10a0ddacc02 aria-expanded=true data-tab-item=R-tab-5b8e181ae4ed60064b941335c8f8d52d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-702c85718b21c93e6bf329d8a6ac3f09","R-tab-5b8e181ae4ed60064b941335c8f8d52d")'>
<span class=tab-nav-text>EMEA Workshop URL</span>
</button>
<button aria-controls=R-tab-id-8eab7a1316a75beb3c4b59af9cb811e4 aria-expanded=false data-tab-item=R-tab-150c518dae317cc990820080b7da7358 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-702c85718b21c93e6bf329d8a6ac3f09","R-tab-150c518dae317cc990820080b7da7358")'>
<span class=tab-nav-text>AMER/APAC Workshop URL</span></button></div><div class=tab-content-container><div id=R-tab-id-d93c1515847a22fc4210b10a0ddacc02 data-tab-item=R-tab-5b8e181ae4ed60064b941335c8f8d52d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><a href=https://online-boutique-eu.splunko11y.com/ rel=external>https://online-boutique-eu.splunko11y.com/</a></p></div></div><div id=R-tab-id-8eab7a1316a75beb3c4b59af9cb811e4 data-tab-item=R-tab-150c518dae317cc990820080b7da7358 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><a href=https://online-boutique-us.splunko11y.com/ rel=external>https://online-boutique-us.splunko11y.com/</a></p></div></div></div></div></div></details><h2 id=open-the-chrome-devtools-recorder>Open the Chrome DevTools Recorder</h2><p>Next, open the Developer Tools (in the new tab that was opened above) by pressing <code>Ctrl + Shift + I</code> on Windows or <code>Cmd + Option + I</code> on a Mac, then select <strong>Recorder</strong> from the top-level menu or the <strong>More tools</strong> flyout menu.</p><p><a href=#R-image-ca338e57582dad6f20fce778840763fc class=lightbox-link><img alt="Open Recorder" class="lazy lightbox figure-image" loading=lazy src=../../img/open-recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca338e57582dad6f20fce778840763fc><img alt="Open Recorder" class="lazy lightbox lightbox-image" loading=lazy src=../../img/open-recorder.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Site elements might change depending on viewport width. Before recording, set your browser window to the correct width for the test you want to create (Desktop, Tablet, or Mobile). Change the DevTools &ldquo;dock side&rdquo; to pop out as a separate window if it helps.</p></div></details><h2 id=create-a-new-recording>Create a new recording</h2><p>With the Recorder panel open in the DevTools window. Click on the <span class="btn cstyle blue"><span><span class=title>Create a new recording</span></span></span> button to start.</p><p><a href=#R-image-1c5308652f8c4d053102d0b7ed495e2d class=lightbox-link><img alt=Recorder class="lazy lightbox figure-image" loading=lazy src=../../img/recorder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1c5308652f8c4d053102d0b7ed495e2d><img alt=Recorder class="lazy lightbox lightbox-image" loading=lazy src=../../img/recorder.png></a></p><p>For the <strong>Recording Name</strong> use your initials to prefix the name of the recording e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>. Click on <strong>Start Recording</strong> to start recording your actions.</p><p><a href=#R-image-8b2b87c98e919748da01dcb9876bf006 class=lightbox-link><img alt="Recording Name" class="lazy lightbox figure-image" loading=lazy src=../../img/recording-name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b2b87c98e919748da01dcb9876bf006><img alt="Recording Name" class="lazy lightbox lightbox-image" loading=lazy src=../../img/recording-name.png></a></p><p>Now that we are recording, complete the following actions on the site:</p><ul><li>Click on <strong>Vintage Camera Lens</strong></li><li>Click on <strong>Add to Cart</strong></li><li>Click on <strong>Place Order</strong></li><li>Click on <strong>End recording</strong> in the Recorder panel.</li></ul><p><a href=#R-image-0caf0e3c6baeb7dd5ac599111898fecd class=lightbox-link><img alt="End Recording" class="lazy lightbox figure-image" loading=lazy src=../../img/end-recording.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0caf0e3c6baeb7dd5ac599111898fecd><img alt="End Recording" class="lazy lightbox lightbox-image" loading=lazy src=../../img/end-recording.png></a></p><h2 id=exporting-the-recording>Exporting the recording</h2><p>Click on the <strong>Export</strong> button:</p><p><a href=#R-image-7bb4b4f175782c178c18b408e5aa5373 class=lightbox-link><img alt="Export button" class="lazy lightbox figure-image" loading=lazy src=../../img/export-button.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7bb4b4f175782c178c18b408e5aa5373><img alt="Export button" class="lazy lightbox lightbox-image" loading=lazy src=../../img/export-button.png></a></p><p>Select <strong>JSON</strong> as the format, then click on <strong>Save</strong></p><p><a href=#R-image-571fd14e10afe310e1dc46e8f26503a9 class=lightbox-link><img alt="Export JSON" class="lazy lightbox figure-image" loading=lazy src=../../img/export-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-571fd14e10afe310e1dc46e8f26503a9><img alt="Export JSON" class="lazy lightbox lightbox-image" loading=lazy src=../../img/export-json.png></a></p><p><a href=#R-image-ad68e177d901cd09d26f10644402ddc5 class=lightbox-link><img alt="Save JSON" class="lazy lightbox figure-image" loading=lazy src=../../img/save-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ad68e177d901cd09d26f10644402ddc5><img alt="Save JSON" class="lazy lightbox lightbox-image" loading=lazy src=../../img/save-json.png></a></p><p><strong>Congratulations!</strong> You have successfully created a recording using the Chrome DevTools Recorder. Next, we will use this recording to create a Real Browser Test in Splunk Synthetic Monitoring.</p><hr><details class="box cstyle notices transparent expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
Click here to view the JSON file</summary><div class=box-content><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;RWC - Online Boutique&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;steps&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;setViewport&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;width&#34;</span><span class=p>:</span> <span class=mi>1430</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;height&#34;</span><span class=p>:</span> <span class=mi>1016</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;deviceScaleFactor&#34;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isMobile&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;hasTouch&#34;</span><span class=p>:</span> <span class=kc>false</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;isLandscape&#34;</span><span class=p>:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigate&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Online Boutique&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[2]/div[2]/div/a/div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div:nth-of-type(2) &gt; div:nth-of-type(2) a &gt; div&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mi>170</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mi>180</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/product/66VCHSJNUP&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/ADD TO CART&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div[1]/div/div[2]/div/form/div/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Add to Cart&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>35.0078125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>46.4140625</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;click&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;target&#34;</span><span class=p>:</span> <span class=s2>&#34;main&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;selectors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;aria/PLACE ORDER&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;xpath//html/body/main/div/div/div[4]/div/form/div[4]/button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;pierce/div &gt; div &gt; div.py-3 button&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>],</span>
</span></span><span class=line><span class=cl>                <span class=p>[</span>
</span></span><span class=line><span class=cl>                    <span class=s2>&#34;text/Place order&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>]</span>
</span></span><span class=line><span class=cl>            <span class=p>],</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetY&#34;</span><span class=p>:</span> <span class=mf>29.8125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;offsetX&#34;</span><span class=p>:</span> <span class=mf>66.8203125</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nt>&#34;assertedEvents&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;type&#34;</span><span class=p>:</span> <span class=s2>&#34;navigation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;url&#34;</span><span class=p>:</span> <span class=s2>&#34;https://online-boutique-eu.splunko11y.com/cart/checkout&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=12-create-real-browser-test>1.2 Create Real Browser Test</h1><p>In Splunk Observability Cloud, navigate to <strong>Synthetics</strong> and click on <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span>.</p><p>From the dropdown select <strong>Browser test</strong>.</p><p><a href=#R-image-2234a4ac739f376fa60ef4cdaf52b3d1 class=lightbox-link><img alt="Add new test" class="lazy lightbox figure-image" loading=lazy src=../../img/add-new-test.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2234a4ac739f376fa60ef4cdaf52b3d1><img alt="Add new test" class="lazy lightbox lightbox-image" loading=lazy src=../../img/add-new-test.png></a></p><p>You will then be presented with the <strong>Browser test content</strong> configuration page.</p><p><a href=#R-image-9c0b36a1640d14403ef13f9dd97bdf44 class=lightbox-link><img alt="New Test" class="lazy lightbox figure-image" loading=lazy src=../../img/new-test.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9c0b36a1640d14403ef13f9dd97bdf44><img alt="New Test" class="lazy lightbox lightbox-image" loading=lazy src=../../img/new-test.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=13-import-json>1.3 Import JSON</h1><p>To begin configuring our test, we need to import the JSON that we exported from the Chrome DevTools Recorder. To enable the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button, we must first give our test a name e.g. <strong><code>&lt;your initials></code> - Online Boutique</strong>.</p><p><a href=#R-image-4b43202161732cca00f570b9d96d49f3 class=lightbox-link><img alt=Import class="lazy lightbox figure-image" loading=lazy src=../../img/import.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4b43202161732cca00f570b9d96d49f3><img alt=Import class="lazy lightbox lightbox-image" loading=lazy src=../../img/import.png></a></p><p>Once the <span class="btn cstyle transparent"><span><span class=title><strong>Import</strong></span></span></span> button is enabled, click on it and either drop the JSON file that you exported from the Chrome DevTools Recorder or upload the file.</p><p><a href=#R-image-a82d9fabac1580fafc91812690eb4e3d class=lightbox-link><img alt="Import JSON" class="lazy lightbox figure-image" loading=lazy src=../../img/import-json.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a82d9fabac1580fafc91812690eb4e3d><img alt="Import JSON" class="lazy lightbox lightbox-image" loading=lazy src=../../img/import-json.png></a></p><p>Once the JSON file has been uploaded, click on <span class="btn cstyle blue"><span><span class=title>Continue to edit steps</span></span></span></p><p><a href=#R-image-37b58a37cdfa984b0739af92daa22716 class=lightbox-link><img alt="Import Complete" class="lazy lightbox figure-image" loading=lazy src=../../img/import-complete.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37b58a37cdfa984b0739af92daa22716><img alt="Import Complete" class="lazy lightbox lightbox-image" loading=lazy src=../../img/import-complete.png></a></p><p><a href=#R-image-2424091c7be499e07010d9970014397d class=lightbox-link><img alt="Edit Steps" class="lazy lightbox figure-image" loading=lazy src=../../img/edit-steps.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2424091c7be499e07010d9970014397d><img alt="Edit Steps" class="lazy lightbox lightbox-image" loading=lazy src=../../img/edit-steps.png></a></p><p>Before we make any edits to the test, let&rsquo;s first configure the settings, click on <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=14-settings>1.4 Settings</h1><p>The simple settings allow you to configure the basics of the test:</p><ul><li><strong>Name</strong>: The name of the test (e.g. RWC - Online Boutique).</li><li><strong>Details</strong>:<ul><li><strong>Locations</strong>: The locations where the test will run from.</li><li><strong>Device</strong>: Emulate different devices and connection speeds. Also, the viewport will be adjusted to match the chosen device.</li><li><strong>Frequency</strong>: How often the test will run.</li><li><strong>Round-robin</strong>: If multiple locations are selected, the test will run from one location at a time, rather than all locations at once.</li><li><strong>Active</strong>: Set the test to active or inactive.</li></ul></li></ul><p>![Return to Test]For this workshop, we will configure the locations that we wish to monitor from. Click in the <strong>Locations</strong> field and you will be presented with a list of global locations (over 50 in total).</p><p><a href=#R-image-9e66ca5a193abf42a345bba148a9f9ca class=lightbox-link><img alt="Global Locations" class="lazy lightbox figure-image" loading=lazy src=../../img/global-locations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9e66ca5a193abf42a345bba148a9f9ca><img alt="Global Locations" class="lazy lightbox lightbox-image" loading=lazy src=../../img/global-locations.png></a></p><p>Select the following locations:</p><ul><li><strong>AWS - N. Virginia</strong></li><li><strong>AWS - London</strong></li><li><strong>AWS - Melbourne</strong></li></ul><p>Once complete, scroll down and click on Click on <span class="btn cstyle blue"><span><span class=title>Submit</span></span></span> to save the test.</p><p>The test will now be scheduled to run every 5 minutes from the 3 locations that we have selected. This does take a few minutes for the schedule to be created.</p><p>So whilst we wait for the test to be scheduled, click on <span class="btn cstyle transparent"><span><span class=title>Edit test</span></span></span> so we can go through the Advanced settings.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=15-advanced-settings>1.5 Advanced Settings</h1><p>Click on <strong>Advanced</strong>, these settings are optional and can be used to further configure the test.</p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>In the case of this workshop, we will <strong>not</strong> be using any of these settings as this is for informational purposes only.</p></div></details><p><a href=#R-image-96c4fc48a9f1ca3590ef41d9204daf9f class=lightbox-link><img alt="Advanced Settings" class="lazy lightbox figure-image" loading=lazy src=../../img/advanced-settings.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-96c4fc48a9f1ca3590ef41d9204daf9f><img alt="Advanced Settings" class="lazy lightbox lightbox-image" loading=lazy src=../../img/advanced-settings.png></a></p><ul><li><strong>Security</strong>:<ul><li><strong>TLS/SSL validation</strong>: When activated, this feature is used to enforce the validation of expired, invalid hostname, or untrusted issuer on SSL/TLS certificates.</li><li><strong>Authentication</strong>: Add credentials to authenticate with sites that require additional security protocols, for example from within a corporate network. By using <a href=https://docs.splunk.com/Observability/synthetics/test-config/global-variables.html rel=external>concealed global variables</a> in the Authentication field, you create an additional layer of security for your credentials and simplify the ability to share credentials across checks.</li></ul></li><li><strong>Custom Content</strong>:<ul><li><strong>Custom headers</strong>: Specify custom headers to send with each request. For example, you can add a header in your request to filter out requests from analytics on the back end by sending a specific header in the requests. You can also use custom headers to set cookies.</li><li><strong>Cookies</strong>: Set cookies in the browser before the test starts. For example, to prevent a popup modal from randomly appearing and interfering with your test, you can set cookies. Any cookies that are set will apply to the domain of the starting URL of the check. Splunk Synthetics Monitoring uses the public suffix list to determine the domain.</li><li><strong>Host overrides</strong>: Add host override rules to reroute requests from one host to another. For example, you can create a host override to test an existing production site against page resources loaded from a development site or a specific CDN edge node.</li></ul></li></ul><p>Next, we will edit the test steps to provide more meaningful names for each step.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=16-edit-test-steps>1.6 Edit test steps</h1><p>To edit the steps click on the <span class="btn cstyle transparent"><span><span class=title>+ Edit steps or synthetic transactions</span></span></span> button. From here, we are going to give meaningful names to each step.</p><p><a href=#R-image-794e83acbc951fbd4e7c790955e5d8b0 class=lightbox-link><img alt="Edit steps" class="lazy lightbox figure-image" loading=lazy src=../../img/edit-steps.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-794e83acbc951fbd4e7c790955e5d8b0><img alt="Edit steps" class="lazy lightbox lightbox-image" loading=lazy src=../../img/edit-steps.png></a></p><p>For each of the four steps, we are going to give them a meaningful name.</p><ul><li><strong>Step 1</strong> replace the text <strong>Go to URL</strong> with <strong>HomePage - Online Boutique</strong></li><li><strong>Step 2</strong> enter the text <strong>Select Vintage Camera Lens</strong>.</li><li><strong>Step 3</strong> enter <strong>Add to Cart</strong>.</li><li><strong>Step 4</strong> enter <strong>Place Order</strong>.</li></ul><p><a href=#R-image-a5ef6a79aef4415ab7f7c3da2c7efe73 class=lightbox-link><img alt="Step names" class="lazy lightbox figure-image" loading=lazy src=../../img/step-names.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a5ef6a79aef4415ab7f7c3da2c7efe73><img alt="Step names" class="lazy lightbox lightbox-image" loading=lazy src=../../img/step-names.png></a></p><p>Click <span class="btn cstyle blue"><span><span class=title>&lt; Return to test</span></span></span> to return to the test configuration page and click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the test.</p><p>You will be returned to the test dashboard where you will see test results start to appear.</p><p><a href=#R-image-e388435f831b90c8646be9ecccbf3370 class=lightbox-link><img alt=Scatterplot class="lazy lightbox figure-image" loading=lazy src=../../img/scatterplot.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e388435f831b90c8646be9ecccbf3370><img alt=Scatterplot class="lazy lightbox lightbox-image" loading=lazy src=../../img/scatterplot.png></a></p><p><strong>Congratulations!</strong> You have successfully created a Real Browser Test in Splunk Synthetic Monitoring. Next, we will look into a test result in more detail.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=17-view-test-results>1.7 View test results</h1><p>In the Scatterplot from the previous step, click on one of the dots to drill into the test run data. Preferably, select the most recent test run (farthest to the right).</p><p><a href=#R-image-a254935eeebd278a74ca2c3de34781b4 class=lightbox-link><img alt=Drilldown class="lazy lightbox figure-image" loading=lazy src=../../img/drilldown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a254935eeebd278a74ca2c3de34781b4><img alt=Drilldown class="lazy lightbox lightbox-image" loading=lazy src=../../img/drilldown.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=api-test>API Test</h1><p>The API Test provides a flexible way to check the functionality and performance of API endpoints. The shift toward API-first development has magnified the necessity to monitor the back-end services that provide your core front-end functionality.</p><p>Whether you&rsquo;re interested in testing the multi-step API interactions or you want to gain visibility into the performance of your endpoints, the API Test can help you accomplish your goals.</p><p><a href=#R-image-e7066dfef6e8093fa33a6a91f7995f91 class=lightbox-link><img alt="API test result" class="lazy lightbox figure-image" loading=lazy src=../img/api-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e7066dfef6e8093fa33a6a91f7995f91><img alt="API test result" class="lazy lightbox lightbox-image" loading=lazy src=../img/api-test-result.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of 2. API Test</h1><article class=default><header class=headline></header><h1 id=global-variables>Global Variables</h1><h2 id=global-variables>Global Variables</h2><p>View the global variable that we&rsquo;ll use to perform our API test. Click on <strong>Global Variables</strong> under the cog. The global variable named <code>env.encoded_auth</code> will be the one that we&rsquo;ll use to build the spotify API transaction.</p><p><a href=#R-image-02cabd413a141e4b29920457c662d696 class=lightbox-link><img alt=placeholder class="lazy lightbox figure-image" loading=lazy src=../../img/global-variables.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-02cabd413a141e4b29920457c662d696><img alt=placeholder class="lazy lightbox lightbox-image" loading=lazy src=../../img/global-variables.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-new-api-test>Create new API test</h1><h2 id=create-a-new-api-test>Create a new API test</h2><p>Create a new API test by clicking on the <span class="btn cstyle blue"><span><span class=title>Add new test</span></span></span> button and select <strong>API test</strong> from the dropdown. Name the test using <strong>your initials</strong> followed by <strong>Spotify API</strong> e.g. <strong>RWC - Spotify API</strong></p><p><a href=#R-image-5ce8c12499974036769e0d6a91d15cb0 class=lightbox-link><img alt=placeholder class="lazy lightbox figure-image" loading=lazy src=../../img/new-api-check.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ce8c12499974036769e0d6a91d15cb0><img alt=placeholder class="lazy lightbox lightbox-image" loading=lazy src=../../img/new-api-check.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=authentication-request>Authentication Request</h1><h2 id=add-authentication-request>Add Authentication Request</h2><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add requests</span></span></span> and enter the request step name e.g. <strong>Authenticate with Spotify API</strong>.</p><p><a href=#R-image-c81978f6542ff34fbf9561d02fdb8f4f class=lightbox-link><img alt=placeholder class="lazy lightbox figure-image" loading=lazy src=../../img/add-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c81978f6542ff34fbf9561d02fdb8f4f><img alt=placeholder class="lazy lightbox lightbox-image" loading=lazy src=../../img/add-request.png></a></p><p>Expand the Request section, from the drop-down change the request method to <strong>POST</strong> and enter the following URL:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://accounts.spotify.com/api/token</span></span></code></pre></div><p>In the <strong>Payload body</strong> section enter the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>grant_type=client_credentials</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/x-www-form-urlencoded</strong></li><li><strong>AUTHORIZATION: Basic {{env.encoded_auth}}</strong></li></ul><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.access_token</strong> <strong>as</strong> <strong>access_token</strong>.</li></ul><p>This will parse the JSON payload that is received from the Spotify API, extract the access token and store it as a custom variable.</p><p><a href=#R-image-fd5a63eb2b0c9ce827f36cd6050c81b8 class=lightbox-link><img alt="Add payload token" class="lazy lightbox figure-image" loading=lazy src=../../img/add-payload-token.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd5a63eb2b0c9ce827f36cd6050c81b8><img alt="Add payload token" class="lazy lightbox lightbox-image" loading=lazy src=../../img/add-payload-token.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=search-request>Search Request</h1><h2 id=add-search-request>Add Search Request</h2><p>Click on <span class="btn cstyle transparent"><span><span class=title>+ Add Request</span></span></span> to add the next step. Name the step <strong>Search for Tracks named &ldquo;Up around the bend&rdquo;</strong>.</p><p>Expand the <strong>Request</strong> section and change the request method to <strong>GET</strong> and enter the following URL:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>https://api.spotify.com/v1/search?q=Up%20around%20the%20bend&amp;type=track&amp;offset=0&amp;limit=5</span></span></code></pre></div><p>Next, add two request headers with the following key/value pairings:</p><ul><li><strong>CONTENT-TYPE: application/json</strong></li><li><strong>AUTHORIZATION: Bearer {{custom.access_token}}</strong></li></ul><p><a href=#R-image-61662b0b844264d31902dcb24c2068f7 class=lightbox-link><img alt="Add search request" class="lazy lightbox figure-image" loading=lazy src=../../img/add-search-request.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61662b0b844264d31902dcb24c2068f7><img alt="Add search request" class="lazy lightbox lightbox-image" loading=lazy src=../../img/add-search-request.png></a></p><p>Expand the <strong>Validation</strong> section and add the following extraction:</p><ul><li><strong>Extract</strong> from <strong>Response body</strong> <strong>JSON</strong> <strong>$.tracks.items[0].id</strong> <strong>as</strong> <strong>track.id</strong>.</li></ul><p><a href=#R-image-e19a1bbf3fb91978ccd87671736e2cbe class=lightbox-link><img alt="Add search payload" class="lazy lightbox figure-image" loading=lazy src=../../img/add-search-payload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e19a1bbf3fb91978ccd87671736e2cbe><img alt="Add search payload" class="lazy lightbox lightbox-image" loading=lazy src=../../img/add-search-payload.png></a></p><p>Click on <span class="btn cstyle blue"><span><span class=title>< Return to test</span></span></span> to return to the test configuration page. And then click <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> to save the API test.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=view-results>View results</h1><h2 id=view-results>View results</h2><p>Wait for a few minutes for the test to provision and run. Once you see the test has run successfully, click on the run to view the test results:</p><p><a href=#R-image-256ad848313c683a0735c0bb7365ea5e class=lightbox-link><img alt="API test result" class="lazy lightbox figure-image" loading=lazy src=../../img/api-test-result.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-256ad848313c683a0735c0bb7365ea5e><img alt="API test result" class="lazy lightbox lightbox-image" loading=lazy src=../../img/api-test-result.png></a></p><h2 id=6-resources>6. Resources</h2><ul><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/set-up-api-test.html rel=external>How to Create an API Test</a></p></li><li><p><a href=https://docs.splunk.com/Observability/synthetics/api-test/api-test.html rel=external>API Test Overview</a></p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=distributed-tracing-for-aws-lambda-functions>Distributed Tracing for AWS Lambda Functions</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Guy-Francis Kono</span></span><p>This workshop will equip you to build a distributed trace for a small serverless application that runs on AWS Lambda, producing and consuming a message via AWS Kinesis.</p><p>First, we will see how OpenTelemetry&rsquo;s auto-instrumentation captures traces and exports them to your target of choice.</p><p>Then, we will see how we can enable context propagation with manual instrumentation.</p><p>For this workshop Splunk has prepared an Ubuntu Linux instance in AWS/EC2 all pre-configured for you. To get access to that instance, please visit the URL provided by the workshop leader.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 16, 2024</span></span></footer></article><section><h1 class=a11y-only>Subsections of Lambda Tracing</h1><article class=default><header class=headline></header><h1 id=setup>Setup</h1><p><a href=#R-image-80c31d96a4a2cb05be0062eeeddf0d3d class=lightbox-link><img alt="Lambda application, not yet manually instrumented" class="lazy lightbox figure-image" loading=lazy src=../images/01-Architecture.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-80c31d96a4a2cb05be0062eeeddf0d3d><img alt="Lambda application, not yet manually instrumented" class="lazy lightbox lightbox-image" loading=lazy src=../images/01-Architecture.png></a></p><h2 id=prerequisites>Prerequisites</h2><h3 id=observability-workshop-instance>Observability Workshop Instance</h3><p>The Observability Workshop uses the <code>Splunk4Ninjas - Observability</code> workshop template in Splunk Show,
which provides a pre-configured EC2 instance running Ubuntu.</p><p>Your workshop instructor will provide you with the credentials to your assigned workshop instance.</p><p>Your instance should have the following environment variables already set:</p><ul><li><strong>ACCESS_TOKEN</strong></li><li><strong>REALM</strong><ul><li><em>These are the Splunk Observability Cloud <strong>Access Token</strong> and <strong>Realm</strong> for your workshop.</em></li><li><em>They will be used by the OpenTelemetry Collector to forward your data to the correct Splunk Observability Cloud organization.</em></li></ul></li></ul><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p><em>Alternatively, you can deploy a local observability workshop instance using Multipass.</em></p></div></details><h3 id=aws-command-line-interface-awscli>AWS Command Line Interface (awscli)</h3><p>The AWS Command Line Interface, or <code>awscli</code>, is an API used to interact with AWS resources. In this workshop, it is used by certain scripts to interact with the resource you&rsquo;ll deploy.</p><p>Your Splunk-issued workshop instance should already have the <strong>awscli</strong> installed.</p><ul><li><p>Check if the <strong>aws</strong> command is installed on your instance with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>which aws</span></span></code></pre></div><ul><li><em>The expected output would be <strong>/usr/local/bin/aws</strong></em></li></ul></li><li><p>If the <strong>aws</strong> command is not installed on your instance, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt install awscli</span></span></code></pre></div></li></ul><h3 id=terraform>Terraform</h3><p>Terraform is an Infrastructure as Code (IaC) platform, used to deploy, manage and destroy resource by defining them in configuration files. Terraform employs HCL to define those resources, and supports multiple providers for various platforms and technologies.</p><p>We will be using Terraform at the command line in this workshop to deploy the following resources:</p><ol><li>AWS API Gateway</li><li>Lambda Functions</li><li>Kinesis Stream</li><li>CloudWatch Log Groups</li><li>S3 Bucket<ul><li><em>and other supporting resources</em></li></ul></li></ol><p>Your Splunk-issued workshop instance should already have <strong>terraform</strong> installed.</p><ul><li><p>Check if the <strong>terraform</strong> command is installed on your instance:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>which terraform</span></span></code></pre></div><ul><li><em>The expected output would be <strong>/usr/local/bin/terraform</strong></em></li></ul></li><li><p>If the <strong>terraform</strong> command is not installed on your instance, follow Terraform&rsquo;s recommended installation commands listed below:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget -O- https://apt.releases.hashicorp.com/gpg <span class=p>|</span> sudo gpg --dearmor -o /usr/share/keyrings/hashicorp-archive-keyring.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com </span><span class=k>$(</span>lsb_release -cs<span class=k>)</span><span class=s2> main&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/hashicorp.list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo apt update <span class=o>&amp;&amp;</span> sudo apt install terraform</span></span></code></pre></div></li></ul><h3 id=workshop-directory-lambda>Workshop Directory (lambda)</h3><p>The Workshop Directory <code>lambda</code> is a repository that contains all the configuration files and scripts to complete both the auto-instrumentation and manual instrumentation of the example Lambda-based application we will be using today.</p><ul><li>Confirm you have the workshop directory in your home directory:<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop <span class=o>&amp;&amp;</span> ls</span></span></code></pre></div><ul><li><em>The expected output would include <strong>lambda</strong></em></li></ul></li></ul><h3 id=aws--terraform-variables>AWS & Terraform Variables</h3><h4 id=aws>AWS</h4><blockquote><p>Note to the workshop instructor: create a new user in the target AWS account called <code>lambda-workshop-user</code>.
Ensure it has full permissions to perform the required actions via Terraform. Create an access token for the <code>lambda-workshop-user</code>
user and share the Access Key ID and Secret Access Key with the workshop participants. Delete the user
when the workshop is complete.</p></blockquote><p>The AWS CLI requires that you have credentials to be able to access and manage resources deployed by their services. Both Terraform and the Python scripts in this workshop require these variables to perform their tasks.</p><ul><li><p>Configure the <strong>awscli</strong> with the <em><strong>access key ID</strong></em>, <em><strong>secret access key</strong></em> and <em><strong>region</strong></em> for this workshop:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws configure</span></span></code></pre></div><ul><li><em>This command should provide a prompt similar to the one below:</em><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>AWS Access Key ID <span class=o>[</span>None<span class=o>]</span>: XXXXXXXXXXXXXXXX
</span></span><span class=line><span class=cl>AWS Secret Access Key <span class=o>[</span>None<span class=o>]</span>: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
</span></span><span class=line><span class=cl>Default region name <span class=o>[</span>None<span class=o>]</span>: us-east-1
</span></span><span class=line><span class=cl>Default outoput format <span class=o>[</span>None<span class=o>]</span>:</span></span></code></pre></div></li></ul></li><li><p>If the <strong>awscli</strong> is not configured on your instance, run the following command and provide the values your instructor would provide you with.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws configure</span></span></code></pre></div></li></ul><h4 id=create-an-iam-role-workshop-instructor-only>Create an IAM Role (Workshop Instructor Only)</h4><blockquote><p>Note to the workshop instructor: This step only needs to be completed once, as the IAM role created
in this step will be shared by all workshop participants:</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/iam_role
</span></span><span class=line><span class=cl>terraform init
</span></span><span class=line><span class=cl>terraform plan
</span></span><span class=line><span class=cl>terraform apply </span></span></code></pre></div><blockquote><p>Note to the workshop instructor: After the workshop is complete, cleanup the role as follows:</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/iam_role
</span></span><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><h4 id=terraform-1>Terraform</h4><p>Terraform supports the passing of variables to ensure sensitive or dynamic data is not hard-coded in your .tf configuration files, as well as to make those values reusable throughout your resource definitions.</p><p>In our workshop, Terraform requires variables necessary for deploying the Lambda functions with the right values for the OpenTelemetry Lambda layer; For the ingest values for Splunk Observability Cloud; And to make your environment and resources unique and immediatley recognizable.</p><p>Terraform variables are defined in the following manner:</p><ul><li>Define the variables in your <em><strong>main.tf</strong></em> file or a <em><strong>variables.tf</strong></em></li><li>Set the values for those variables in either of the following ways:<ul><li>setting environment variables at the host level, with the same variable names as in their definition, and with <em><strong>TF_VAR</strong></em>_ as a prefix</li><li>setting the values for your variables in a <em><strong>terraform.tfvars</strong></em> file</li><li>passing the values as arguments when running terraform apply</li></ul></li></ul><p>We will be using a combination of <em><strong>variables.tf</strong></em> and <em><strong>terraform.tfvars</strong></em> files to set our variables in this workshop.</p><ul><li>Using either <strong>vi</strong> or <strong>nano</strong>, open the <em><strong>terraform.tfvars</strong></em> file in either the <strong>auto</strong> or <strong>manual</strong> directory<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi ~/workshop/lambda/auto/terraform.tfvars</span></span></code></pre></div></li><li>Set the variables with their values. Replace the <strong>CHANGEME</strong> placeholders with those provided by your instructor.<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>o11y_access_token</span> <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>o11y_realm</span>        <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>otel_lambda_layer</span> <span class=o>=</span> <span class=o>[</span><span class=s2>&#34;CHANGEME&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>prefix</span>            <span class=o>=</span> <span class=s2>&#34;CHANGEME&#34;</span></span></span></code></pre></div><ul><li><em>Ensure you change only the placeholders, leaving the quotes and brackets intact, where applicable.</em></li><li>_For the <strong>otel_lambda_layer</strong>, use the value for <strong>us-east-1</strong> found <a href=https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md rel=external>here</a></li><li><em>The <em><strong>prefix</strong></em> is a unique identifier you can choose for yourself, to make your resources distinct from other participants&rsquo; resources. We suggest using a short form of your name, for example.</em></li><li><em>Also, please only lowercase letters for the <strong>prefix</strong>. Certain resources in AWS, such as S3, would through an error if you use uppercase letters.</em></li></ul></li><li>Save your file and exit the editor.</li><li>Finally, copy the <em><strong>terraform.tfvars</strong></em> file you just edited to the other directory.<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp ~/workshop/lambda/auto/terraform.tfvars ~/workshop/lambda/manual</span></span></code></pre></div><ul><li><em>We do this as we will be using the same values for both the autoinstrumentation and manual instrumentation protions of the workshop</em></li></ul></li></ul><h3 id=file-permissions>File Permissions</h3><p>While all other files are fine as they are, the <strong>send_message.py</strong> script in both the <code>auto</code> and <code>manual</code> will have to be executed as part of our workshop. As a result, it needs to have the appropriate permissions to run as expected. Follow these instructions to set them.</p><ul><li><p>First, ensure you are in the <code>lambda</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda</span></span></code></pre></div></li><li><p>Next, run the following command to set executable permissions on the <code>send_message.py</code> script:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chmod <span class=m>755</span> auto/send_message.py manual/send_message.py</span></span></code></pre></div></li></ul><p>Now that we&rsquo;ve squared off the prerequisites, we can get started with the workshop!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=auto-instrumentation>Auto-Instrumentation</h1><p>The first part of our workshop will demonstrate how auto-instrumentation with OpenTelemetry allows the OpenTelemetry Collector to auto-detect what language your function is written in, and start capturing traces for those functions.</p><h3 id=the-auto-instrumentation-workshop-directory--contents>The Auto-Instrumentation Workshop Directory & Contents</h3><p>First, let us take a look at the <code>workshop/lambda/auto</code> directory, and some of its files. This is where all the content for the auto-instrumentation portion of our workshop resides.</p><h4 id=the-auto-directory>The <code>auto</code> Directory</h4><ul><li><p>Run the following command to get into the <strong>workshop/lambda/auto</strong> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/auto</span></span></code></pre></div></li><li><p>Inspect the contents of this directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls</span></span></code></pre></div><ul><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>handler             outputs.tf          terraform.tf        variables.tf
</span></span><span class=line><span class=cl>main.tf             send_message.py     terraform.tfvars</span></span></code></pre></div></li><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>get_logs.py    main.tf       send_message.py
</span></span><span class=line><span class=cl>handler        outputs.tf    terraform.tf</span></span></code></pre></div></li></ul></li></ul><h4 id=the-maintf-file>The <code>main.tf</code> file</h4><ul><li>Take a closer look at the <code>main.tf</code> file:<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat main.tf</span></span></code></pre></div></li></ul><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Questions</summary><div class=box-content><ul><li>Can you identify which AWS resources are being created by this template?</li><li>Can you identify where OpenTelemetry instrumentation is being set up?<ul><li><em>Hint: study the lambda function definitions</em></li></ul></li><li>Can you determine which instrumentation information is being provided by the environment variables we set earlier?</li></ul></div></details><p>You should see a section where the environment variables for each lambda function are being set.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>environment <span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=nv>variables</span> <span class=o>=</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_access_token
</span></span><span class=line><span class=cl>    <span class=nv>SPLUNK_REALM</span> <span class=o>=</span> var.o11y_realm
</span></span><span class=line><span class=cl>    <span class=nv>OTEL_SERVICE_NAME</span> <span class=o>=</span> <span class=s2>&#34;producer-lambda&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span> <span class=o>=</span> <span class=s2>&#34;deployment.environment=</span><span class=si>${</span><span class=nv>var</span><span class=p>.prefix</span><span class=si>}</span><span class=s2>-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>AWS_LAMBDA_EXEC_WRAPPER</span> <span class=o>=</span> <span class=s2>&#34;/opt/nodejs-otel-handler&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>KINESIS_STREAM</span> <span class=o>=</span> aws_kinesis_stream.lambda_streamer.name
</span></span><span class=line><span class=cl>  <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>By using these environment variables, we are configuring our auto-instrumentation in a few ways:</p><ul><li><p>We are setting environment variables to inform the OpenTelemetry collector of which Splunk Observability Cloud organization we would like to have our data exported to.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_access_token
</span></span><span class=line><span class=cl><span class=nv>SPLUNK_ACCESS_TOKEN</span> <span class=o>=</span> var.o11y_realm</span></span></code></pre></div></li><li><p>We are also setting variables that help OpenTelemetry identify our function/service, as well as the environment/application it is a part of.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>OTEL_SERVICE_NAME</span> <span class=o>=</span> <span class=s2>&#34;producer-lambda&#34;</span> <span class=c1># consumer-lambda in the case of the consumer function</span>
</span></span><span class=line><span class=cl><span class=nv>OTEL_RESOURCE_ATTRIBUTES</span> <span class=o>=</span> <span class=s2>&#34;deployment.environment=</span><span class=si>${</span><span class=nv>var</span><span class=p>.prefix</span><span class=si>}</span><span class=s2>-lambda-shop&#34;</span></span></span></code></pre></div></li><li><p>We are setting an environment variable that lets OpenTelemetry know what wrappers it needs to apply to our function&rsquo;s handler so as to capture trace data automatically, based on our code language.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>AWS_LAMBDA_EXEC_WRAPPER - <span class=s2>&#34;/opt/nodejs-otel-handler&#34;</span></span></span></code></pre></div></li><li><p>In the case of the <code>producer-lambda</code> function, we are setting an environment variable to let the function know what Kinesis Stream to put our record to.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>KINESIS_STREAM</span> <span class=o>=</span> aws_kinesis_stream.lambda_streamer.name</span></span></code></pre></div></li><li><p>These values are sourced from the environment variables we set in the Prerequisites section, as well as resources that will be deployed as a part of this Terraform configuration file.</p></li></ul><p>You should also see an argument for setting the Splunk OpenTelemetry Lambda layer on each function</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>layers</span> <span class=o>=</span> var.otel_lambda_layer</span></span></code></pre></div><ul><li><p>The OpenTelemetry Lambda layer is a package that contains the libraries and dependencies necessary to collector, process and export telemetry data for Lambda functions at the moment of invocation.</p></li><li><p>While there is a general OTel Lambda layer that has all the libraries and dependencies for all OpenTelemetry-supported languages, there are also language-specific Lambda layers, to help make your function even more lightweight.</p><ul><li><em>You can see the relevant Splunk OpenTelemetry Lambda layer ARNs (Amazon Resource Name) and latest versions for each AWS region <a href=https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md rel=external>HERE</a></em></li></ul></li></ul><h4 id=the-producermjs-file>The <code>producer.mjs</code> file</h4><p>Next, let&rsquo;s take a look at the <code>producer-lambda</code> function code:</p><ul><li>Run the following command to view the contents of the <code>producer.mjs</code> file:<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/lambda/auto/handler/producer.mjs</span></span></code></pre></div><ul><li>This NodeJS module contains the code for the producer function.</li><li>Essentially, this function receives a message, and puts that message as a record to the targeted Kinesis Stream</li></ul></li></ul><h3 id=deploying-the-lambda-functions--generating-trace-data>Deploying the Lambda Functions & Generating Trace Data</h3><p>Now that we are familiar with the contents of our <code>auto</code> directory, we can deploy the resources for our workshop, and generate some trace data from our Lambda functions.</p><h4 id=initialize-terraform-in-the-auto-directory>Initialize Terraform in the <code>auto</code> directory</h4><p>In order to deploy the resources defined in the <code>main.tf</code> file, you first need to make sure that Terraform is initialized in the same folder as that file.</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/auto</span></span></code></pre></div></li><li><p>Run the following command to initialize Terraform in this directory</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init</span></span></code></pre></div><ul><li>This command will create a number of elements in the same folder:<ul><li><code>.terraform.lock.hcl</code> file: to record the providers it will use to provide resources</li><li><code>.terraform</code> directory: to store the provider configurations</li></ul></li><li>In addition to the above files, when terraform is run using the <code>apply</code> subcommand, the <code>terraform.tfstate</code> file will be created to track the state of your deployed resources.</li><li>These enable Terraform to manage the creation, state and destruction of resources, as defined within the <code>main.tf</code> file of the <code>auto</code> directory</li></ul></li></ul><h4 id=deploy-the-lambda-functions-and-other-aws-resources>Deploy the Lambda functions and other AWS resources</h4><p>Once we&rsquo;ve initialized Terraform in this directory, we can go ahead and deploy our resources.</p><ul><li><p>First, run the <strong>terraform plan</strong> command to ensure that Terraform will be able to create your resources without encountering any issues.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan</span></span></code></pre></div><ul><li><em>This will result in a plan to deploy resources and output some data, which you can review to ensure everything will work as intended.</em></li><li><em>Do note that a number of the values shown in the plan will be known post-creation, or are masked for security purposes.</em></li></ul></li><li><p>Next, run the <strong>terraform apply</strong> command to deploy the Lambda functions and other supporting resources from the <strong>main.tf</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply</span></span></code></pre></div><ul><li><p><em>Respond <strong>yes</strong> when you see the <strong>Enter a value:</strong> prompt</em></p></li><li><p>This will result in the following outputs:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Outputs:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>base_url</span> <span class=o>=</span> <span class=s2>&#34;https://______.amazonaws.com/serverless_stage/producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_function_name</span> <span class=o>=</span> <span class=s2>&#34;_____-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>environment</span> <span class=o>=</span> <span class=s2>&#34;______-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>lambda_bucket_name</span> <span class=o>=</span> <span class=s2>&#34;lambda-shop-______-______&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_function_name</span> <span class=o>=</span> <span class=s2>&#34;______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-producer&#34;</span></span></span></code></pre></div><ul><li><em>Terraform outputs are defined in the <strong>outputs.tf</strong> file.</em></li><li><em>These outputs will be used programmatically in other parts of our workshop, as well.</em></li></ul></li></ul></li></ul><h4 id=send-some-traffic-to-the-producer-lambda-url-base_url>Send some traffic to the <code>producer-lambda</code> URL (<code>base_url</code>)</h4><p>To start getting some traces from our deployed Lambda functions, we would need to generate some traffic. We will send a message to our <code>producer-lambda</code> function&rsquo;s endpoint, which should be put as a record into our Kinesis Stream, and then pulled from the Stream by the <code>consumer-lambda</code> function.</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/auto</span></span></code></pre></div></li></ul><p>The <code>send_message.py</code> script is a Python script that will take input at the command line, add it to a JSON dictionary, and send it to your <code>producer-lambda</code> function&rsquo;s endpoint repeatedly, as part of a while loop.</p><ul><li><p>Run the <code>send_message.py</code> script as a background process</p><ul><li><em>It requires the <code>--name</code> and <code>--superpower</code> arguments</em></li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup ./send_message.py --name CHANGEME --superpower CHANGEME <span class=p>&amp;</span></span></span></code></pre></div><ul><li>You should see an output similar to the following if your message is successful<div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>1<span class=o>]</span> <span class=m>79829</span>
</span></span><span class=line><span class=cl>user@host manual % appending output to nohup.out</span></span></code></pre></div><ul><li><em>The two most import bits of information here are:</em><ul><li><em>The process ID on the first line (<code>79829</code> in the case of my example), and</em></li><li><em>The <code>appending output to nohup.out</code> message</em></li></ul></li><li><em>The <code>nohup</code> command ensures the script will not hang up when sent to the background. It also captures the curl output from our command in a nohup.out file in the same folder as the one you&rsquo;re currently in.</em></li><li><em>The <code>&</code> tells our shell process to run this process in the background, thus freeing our shell to run other commands.</em></li></ul></li></ul></li><li><p>Next, check the contents of the <code>response.logs</code> file, to ensure your output confirms your requests to your <code>producer-lambda</code> endpoint are successful:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat response.logs</span></span></code></pre></div><ul><li>You should see the following output among the lines printed to your screen if your message is successful:</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Message placed in the Event Stream: {prefix}-lambda_stream&#34;</span><span class=o>}</span></span></span></code></pre></div><ul><li>If unsuccessful, you will see:</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Internal server error&#34;</span><span class=o>}</span></span></span></code></pre></div></li></ul><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>If this occurs, ask one of the workshop facilitators for assistance.</p></div></details><h4 id=view-the-lambda-function-logs>View the Lambda Function Logs</h4><p>Next, let&rsquo;s take a look at the logs for our Lambda functions.</p><ul><li><p>To view your <strong>producer-lambda</strong> logs, check the <strong>producer.logs</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat producer.logs</span></span></code></pre></div></li><li><p>To view your <strong>consumer-lambda</strong> logs, check the <strong>consumer.logs</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat consumer.logs</span></span></code></pre></div></li></ul><p>Examine the logs carefully.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><ul><li>Do you see OpenTelemetry being loaded? Look out for the lines with <code>splunk-extension-wrapper</code><ul><li><ul><li><em>Consider running <code>head -n 50 producer.logs</code> or <code>head -n 50 consumer.logs</code> to see the <strong>splunk-extension-wrapper</strong> being loaded.</em></li></ul></li></ul></li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=splunk-apm-lambda-functions--traces>Splunk APM, Lambda Functions & Traces</h1><p>The Lambda functions should be generating a sizeable amount of trace data, which we would need to take a look at. Through the combination of environment variables and the OpenTelemetry Lambda layer configured in the resource definition for our Lambda functions, we should now be ready to view our functions and traces in Splunk APM.</p><h4 id=view-your-environment-name-in-the-splunk-apm-overview>View your Environment name in the Splunk APM Overview</h4><p>Let&rsquo;s start by making sure that Splunk APM is aware of our <code>Environment</code> from the trace data it is receiving. This is the <code>deployment.name</code> we set as part of the <code>OTEL_RESOURCE_ATTRIBUTES</code> variable we set on our Lambda function definitions in <code>main.tf</code>. It was also one of the outputs from the <code>terraform apply</code> command we ran earlier.</p><p>In Splunk Observability Cloud:</p><ul><li><p>Click on the <code>APM</code> Button from the Main Menu on the left. This will take you to the Splunk APM Overview.</p></li><li><p>Select your APM Environment from the <code>Environment:</code> dropdown.</p><ul><li><em>Your APM environment should be in the <code>PREFIX-lambda-shop</code> format, where the <code>PREFIX</code> is obtained from the environment variable you set in the Prerequisites section</em></li></ul></li></ul><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>It may take a few minutes for your traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environment name in the list of environments.</p></div></details><p><a href=#R-image-507b404739bee2154df825271aa1d350 class=lightbox-link><img alt="Splunk APM, Environment Name" class="lazy lightbox figure-image" loading=lazy src=../images/02-Auto-APM-EnvironmentName.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-507b404739bee2154df825271aa1d350><img alt="Splunk APM, Environment Name" class="lazy lightbox lightbox-image" loading=lazy src=../images/02-Auto-APM-EnvironmentName.png></a></p><h4 id=view-your-environments-service-map>View your Environment&rsquo;s Service Map</h4><p>Once you&rsquo;ve selected your Environment name from the Environment drop down, you can take a look at the Service Map for your Lambda functions.</p><ul><li>Click the <code>Service Map</code> Button on the right side of the APM Overview page. This will take you to your Service Map view.</li></ul><p><a href=#R-image-517c8047447ac2003c4d230fce7fa9dd class=lightbox-link><img alt="Splunk APM, Service Map Button" class="lazy lightbox figure-image" loading=lazy src=../images/03-Auto-ServiceMapButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-517c8047447ac2003c4d230fce7fa9dd><img alt="Splunk APM, Service Map Button" class="lazy lightbox lightbox-image" loading=lazy src=../images/03-Auto-ServiceMapButton.png></a></p><p>You should be able to see the <code>producer-lambda</code> function and the call it is making to the Kinesis Stream to put your record.</p><p><a href=#R-image-1badfcd4ed903fa4561dd69bcbe2583f class=lightbox-link><img alt="Splunk APM, Service Map" class="lazy lightbox figure-image" loading=lazy src=../images/04-Auto-ServiceMap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1badfcd4ed903fa4561dd69bcbe2583f><img alt="Splunk APM, Service Map" class="lazy lightbox lightbox-image" loading=lazy src=../images/04-Auto-ServiceMap.png></a></p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>What about your <code>consumer-lambda</code> function?</p></div></details><h4 id=explore-the-traces-from-your-lambda-functions>Explore the Traces from your Lambda Functions</h4><ul><li>Click the <code>Traces</code> button to view the Trace Analyzer.</li></ul><p><a href=#R-image-6a2541983e2c67b9845875965c436a8e class=lightbox-link><img alt="Splunk APM, Trace Button" class="lazy lightbox figure-image" loading=lazy src=../images/05-Auto-TraceButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a2541983e2c67b9845875965c436a8e><img alt="Splunk APM, Trace Button" class="lazy lightbox lightbox-image" loading=lazy src=../images/05-Auto-TraceButton.png></a></p><p>On this page, we can see the traces that have been ingested from the OpenTelemetry Lambda layer of your <code>producer-lambda</code> function.</p><p><a href=#R-image-df479db21e81ba0f86ef62c383b6c5d0 class=lightbox-link><img alt="Splunk APM, Trace Analyzer" class="lazy lightbox figure-image" loading=lazy src=../images/06-Auto-TraceAnalyzer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df479db21e81ba0f86ef62c383b6c5d0><img alt="Splunk APM, Trace Analyzer" class="lazy lightbox lightbox-image" loading=lazy src=../images/06-Auto-TraceAnalyzer.png></a></p><ul><li>Select a trace from the list to examine by clicking on its hyperlinked <code>Trace ID</code>.</li></ul><p><a href=#R-image-bdd568af8897767303d1f4e01fa838ba class=lightbox-link><img alt="Splunk APM, Trace and Spans" class="lazy lightbox figure-image" loading=lazy src=../images/07-Auto-TraceNSpans.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bdd568af8897767303d1f4e01fa838ba><img alt="Splunk APM, Trace and Spans" class="lazy lightbox lightbox-image" loading=lazy src=../images/07-Auto-TraceNSpans.png></a></p><p>We can see that the <code>producer-lambda</code> function is putting a record into the Kinesis Stream. But the action of the <code>consumer-lambda</code> function is missing!</p><p>This is because the trace context is not being propagated. Trace context propagation is not supported out-of-the-box by Kinesis service at the time of this workshop. Our distributed trace stops at the Kinesis service, and because its context isn&rsquo;t automatically propagated through the stream, we can&rsquo;t see any further.</p><p>Not yet, at least&mldr;</p><p>Let&rsquo;s see how we work around this in the next section of this workshop. But before that, let&rsquo;s clean up after ourselves!</p><h3 id=clean-up>Clean Up</h3><p>The resources we deployed as part of this auto-instrumenation exercise need to be cleaned. Likewise, the script that was generating traffice against our <code>producer-lambda</code> endpoint needs to be stopped, if it&rsquo;s still running. Follow the below steps to clean up.</p><h4 id=kill-the-send_message>Kill the <code>send_message</code></h4><ul><li><p>If the <code>send_message.py</code> script is still running, stop it with the follwing commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fg</span></span></code></pre></div><ul><li>This brings your background process to the foreground.</li><li>Next you can hit <code>[CONTROL-C]</code> to kill the process.</li></ul></li></ul><h4 id=destroy-all-aws-resources>Destroy all AWS resources</h4><p>Terraform is great at managing the state of our resources individually, and as a deployment. It can even update deployed resources with any changes to their definitions. But to start afresh, we will destroy the resources and redeploy them as part of the manual instrumentation portion of this workshop.</p><p>Please follow these steps to destroy your resources:</p><ul><li><p>Ensure you are in the <code>auto</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/auto</strong></em></li></ul></li><li><p>If you are not in the <code>auto</code> directory, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/auto</span></span></code></pre></div></li><li><p>Destroy the Lambda functions and other AWS resources you deployed earlier:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><ul><li>respond <code>yes</code> when you see the <code>Enter a value:</code> prompt</li><li>This will result in the resources being destroyed, leaving you with a clean environment</li></ul></li></ul><p>This process will leave you with the files and directories created as a result of our activity. Do not worry about those.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=manual-instrumentation>Manual Instrumentation</h1><p>The second part of our workshop will focus on demonstrating how manual instrumentation with OpenTelemetry empowers us to enhance telemetry collection. More specifically, in our case, it will enable us to propagate trace context data from the <code>producer-lambda</code> function to the <code>consumer-lambda</code> function, thus enabling us to see the relationship between the two functions, even across Kinesis Stream, which currently does not support automatic context propagation.</p><h3 id=the-manual-instrumentation-workshop-directory--contents>The Manual Instrumentation Workshop Directory & Contents</h3><p>Once again, we will first start by taking a look at our operating directory, and some of its files. This time, it will be <code>workshop/lambda/manual</code> directory. This is where all the content for the manual instrumentation portion of our workshop resides.</p><h4 id=the-manual-directory>The <code>manual</code> directory</h4><ul><li><p>Run the following command to get into the <code>workshop/lambda/manual</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/manual</span></span></code></pre></div></li><li><p>Inspect the contents of this directory with the <code>ls</code> command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ls</span></span></code></pre></div><ul><li><p><em>The output should include the following files and directories:</em></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>handler             outputs.tf          terraform.tf        variables.tf
</span></span><span class=line><span class=cl>main.tf             send_message.py     terraform.tfvars</span></span></code></pre></div></li></ul></li></ul><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Do you see any difference between this directory and the auto directory when you first started?</p></div></details><h4 id=compare-auto-and-manual-files>Compare <code>auto</code> and <code>manual</code> files</h4><p>Let&rsquo;s make sure that all these files that LOOK the same, are actually the same.</p><ul><li><p>Compare the <code>main.tf</code> files in the <code>auto</code> and <code>manual</code> directories:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/workshop/lambda/auto/main.tf ~/workshop/lambda/manual/main.tf</span></span></code></pre></div><ul><li>There is no difference! <em>(Well, there shouldn&rsquo;t be. Ask your workshop facilitator to assist you if there is)</em></li></ul></li><li><p>Now, let&rsquo;s compare the <code>producer.mjs</code> files:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/workshop/lambda/auto/handler/producer.mjs ~/workshop/lambda/manual/handler/producer.mjs</span></span></code></pre></div><ul><li>There&rsquo;s quite a few differences here!</li></ul></li><li><p>You may wish to view the entire file and examine its content</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat ~/workshop/lambda/manual/handler/producer.mjs</span></span></code></pre></div><ul><li>Notice how we are now importing some OpenTelemetry objects directly into our function to handle some of the manual instrumentation tasks we require.</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span></span></span></code></pre></div><ul><li>We are importing the following objects from <a href=https://www.npmjs.com/package/@opentelemetry/api rel=external>@opentelemetry/api</a> to propagate our context in our producer function:<ul><li>context</li><li>propagation</li><li>trace</li></ul></li></ul></li><li><p>Finally, compare the <code>consumer.mjs</code> files:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>diff ~/workshop/lambda/auto/handler/consumer.mjs ~/workshop/lambda/manual/handler/consumer.mjs</span></span></code></pre></div><ul><li><p>Here also, there are a few differences of note. Let&rsquo;s take a closer look</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat handler/consumer.mjs</span></span></code></pre></div><ul><li>In this file, we are importing the following <a href=https://www.npmjs.com/package/@opentelemetry/api rel=external>@opentelemetry/api</a> objects:<ul><li>propagation</li><li>trace</li><li>ROOT_CONTEXT</li></ul></li><li>We use these to extract the trace context that was propagated from the producer function</li><li>Then to add new span attributes based on our <code>name</code> and <code>superpower</code> to the extracted trace context</li></ul></li></ul></li></ul><h4 id=propagating-the-trace-context-from-the-producer-function>Propagating the Trace Context from the Producer Function</h4><p>The below code executes the following steps inside the producer function:</p><ol><li>Get the tracer for this trace</li><li>Initialize a context carrier object</li><li>Inject the context of the active span into the carrier object</li><li>Modify the record we are about to pu on our Kinesis stream to include the carrier that will carry the active span&rsquo;s context to the consumer</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>context</span><span class=p>,</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=s1>&#39;lambda-app&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startActiveSpan</span><span class=p>(</span><span class=s1>&#39;put-record&#39;</span><span class=p>,</span> <span class=kr>async</span><span class=p>(</span><span class=nx>span</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>let</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=p>{};</span>
</span></span><span class=line><span class=cl>    <span class=nx>propagation</span><span class=p>.</span><span class=nx>inject</span><span class=p>(</span><span class=nx>context</span><span class=p>.</span><span class=nx>active</span><span class=p>(),</span> <span class=nx>carrier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>eventBody</span> <span class=o>=</span> <span class=nx>Buffer</span><span class=p>.</span><span class=nx>from</span><span class=p>(</span><span class=nx>event</span><span class=p>.</span><span class=nx>body</span><span class=p>,</span> <span class=s1>&#39;base64&#39;</span><span class=p>).</span><span class=nx>toString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=s2>&#34;{\&#34;tracecontext\&#34;: &#34;</span> <span class=o>+</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>carrier</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;, \&#34;record\&#34;: &#34;</span> <span class=o>+</span> <span class=nx>eventBody</span> <span class=o>+</span> <span class=s2>&#34;}&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span>
</span></span><span class=line><span class=cl>      <span class=sb>`Record with Trace Context added:
</span></span></span><span class=line><span class=cl><span class=sb>      </span><span class=si>${</span><span class=nx>data</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>    <span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kr>await</span> <span class=nx>kinesis</span><span class=p>.</span><span class=nx>send</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=nx>PutRecordCommand</span><span class=p>({</span>
</span></span><span class=line><span class=cl>          <span class=nx>StreamName</span><span class=o>:</span> <span class=nx>streamName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>PartitionKey</span><span class=o>:</span> <span class=s2>&#34;1234&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>          <span class=nx>Data</span><span class=o>:</span> <span class=nx>data</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>}),</span>
</span></span><span class=line><span class=cl>        <span class=nx>message</span> <span class=o>=</span> <span class=sb>`Message placed in the Event Stream: </span><span class=si>${</span><span class=nx>streamName</span><span class=si>}</span><span class=sb>`</span>
</span></span><span class=line><span class=cl>      <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>    <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span></span></span></code></pre></div><h4 id=extracting-trace-context-in-the-consumer-function>Extracting Trace Context in the Consumer Function</h4><p>The below code executes the following steps inside the consumer function:</p><ol><li>Extract the context that we obtained from <code>producer-lambda</code> into a carrier object.</li><li>Extract the tracer from current context.</li><li>Start a new span with the tracer within the extracted context.</li><li>Bonus: Add extra attributes to your span, including custom ones with the values from your message!</li><li>Once completed, end the span.</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=kr>import</span> <span class=p>{</span> <span class=nx>propagation</span><span class=p>,</span> <span class=nx>trace</span><span class=p>,</span> <span class=nx>ROOT_CONTEXT</span> <span class=p>}</span> <span class=nx>from</span> <span class=s2>&#34;@opentelemetry/api&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>carrier</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>tracecontext</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>parentContext</span> <span class=o>=</span> <span class=nx>propagation</span><span class=p>.</span><span class=nx>extract</span><span class=p>(</span><span class=nx>ROOT_CONTEXT</span><span class=p>,</span> <span class=nx>carrier</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>tracer</span> <span class=o>=</span> <span class=nx>trace</span><span class=p>.</span><span class=nx>getTracer</span><span class=p>(</span><span class=nx>process</span><span class=p>.</span><span class=nx>env</span><span class=p>.</span><span class=nx>OTEL_SERVICE_NAME</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>span</span> <span class=o>=</span> <span class=nx>tracer</span><span class=p>.</span><span class=nx>startSpan</span><span class=p>(</span><span class=s2>&#34;Kinesis.getRecord&#34;</span><span class=p>,</span> <span class=kc>undefined</span><span class=p>,</span> <span class=nx>parentContext</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;span.kind&#34;</span><span class=p>,</span> <span class=s2>&#34;server&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>parse</span><span class=p>(</span> <span class=nx>message</span> <span class=p>).</span><span class=nx>record</span><span class=p>;</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.name&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nx>span</span><span class=p>.</span><span class=nx>setAttribute</span><span class=p>(</span><span class=s2>&#34;custom.tag.superpower&#34;</span><span class=p>,</span> <span class=nx>body</span><span class=p>.</span><span class=nx>superpower</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>...</span>
</span></span><span class=line><span class=cl>      <span class=nx>span</span><span class=p>.</span><span class=nx>end</span><span class=p>();</span></span></span></code></pre></div><p>Now let&rsquo;s see the different this makes!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploying-lambda-functions--generating-trace-data>Deploying Lambda Functions & Generating Trace Data</h1><p>Now that we know how to apply manual instrumentation to the functions and services we wish to capture trace data for, let&rsquo;s go about deploying our Lambda functions again, and generating traffic against our <code>producer-lambda</code> endpoint.</p><h4 id=initialize-terraform-in-the-manual-directory>Initialize Terraform in the <code>manual</code> directory</h4><p>Seeing as we&rsquo;re in a new directory, we will need to initialize Terraform here once again.</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/manual</span></span></code></pre></div></li><li><p>Run the following command to initialize Terraform in this directory</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform init</span></span></code></pre></div></li></ul><h4 id=deploy-the-lambda-functions-and-other-aws-resources>Deploy the Lambda functions and other AWS resources</h4><p>Let&rsquo;s go ahead and deploy those resources again as well!</p><ul><li><p>Run the <strong>terraform plan</strong> command, ensuring there are no issues.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform plan</span></span></code></pre></div></li><li><p>Follow up with the <strong>terraform apply</strong> command to deploy the Lambda functions and other supporting resources from the <strong>main.tf</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform apply</span></span></code></pre></div><ul><li><p><em>Respond <strong>yes</strong> when you see the <strong>Enter a value:</strong> prompt</em></p></li><li><p>This will result in the following outputs:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Outputs:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>base_url</span> <span class=o>=</span> <span class=s2>&#34;https://______.amazonaws.com/serverless_stage/producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_function_name</span> <span class=o>=</span> <span class=s2>&#34;_____-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>consumer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-consumer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>environment</span> <span class=o>=</span> <span class=s2>&#34;______-lambda-shop&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>lambda_bucket_name</span> <span class=o>=</span> <span class=s2>&#34;lambda-shop-______-______&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_function_name</span> <span class=o>=</span> <span class=s2>&#34;______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_arn</span> <span class=o>=</span> <span class=s2>&#34;arn:aws:logs:us-east-1:############:log-group:/aws/lambda/______-producer&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>producer_log_group_name</span> <span class=o>=</span> <span class=s2>&#34;/aws/lambda/______-producer&#34;</span></span></span></code></pre></div></li></ul></li></ul><p>As you can tell, aside from the first portion of the base_url and the log gropu ARNs, the output should be largely the same as when you ran the auto-instrumentation portion of this workshop up to this same point.</p><h4 id=send-some-traffic-to-the-producer-lambda-endpoint-base_url>Send some traffic to the <code>producer-lambda</code> endpoint (base_url)</h4><p>Once more, we will send our <code>name</code> and <code>superpower</code> as a message to our endpoint. This will then be added to a record in our Kinesis Stream, along with our trace context.</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/manual</span></span></code></pre></div></li><li><p>Run the <code>send_message.py</code> script as a background process:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nohup ./send_message.py --name CHANGEME --superpower CHANGEME <span class=p>&amp;</span></span></span></code></pre></div></li><li><p>Next, check the contents of the response.logs file for successful calls to our<strong>producer-lambda</strong> endpoint:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat response.logs</span></span></code></pre></div><ul><li><p>You should see the following output among the lines printed to your screen if your message is successful:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Message placed in the Event Stream: hostname-eventStream&#34;</span><span class=o>}</span></span></span></code></pre></div></li><li><p>If unsuccessful, you will see:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;message&#34;</span>: <span class=s2>&#34;Internal server error&#34;</span><span class=o>}</span></span></span></code></pre></div></li></ul></li></ul><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>If this occurs, ask one of the workshop facilitators for assistance.</p></div></details><h4 id=view-the-lambda-function-logs>View the Lambda Function Logs</h4><p>Let&rsquo;s see what our logs look like now.</p><ul><li><p>Check the <strong>producer.logs</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat producer.logs</span></span></code></pre></div></li><li><p>And the <strong>consumer.logs</strong> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat consumer.logs</span></span></code></pre></div></li></ul><p>Examine the logs carefully.</p><h5 id=workshop-question><em>Workshop Question</em></h5><blockquote><p>Do you notice the difference?</p></blockquote><h4 id=copy-the-trace-id-from-the-consumerlogs-file>Copy the Trace ID from the <code>consumer.logs</code> file</h4><p>This time around, we can see that the consumer-lambda log group is logging our message as a <code>record</code> together with the <code>tracecontext</code> that we propagated.</p><p>To copy the Trace ID:</p><ul><li>Take a look at one of the <code>Kinesis Message</code> logs. Within it, there is a <code>data</code> dictionary</li><li>Take a closer look at <code>data</code> to see the nested <code>tracecontext</code> dictionary</li><li>Within the <code>tracecontext</code> dictionary, there is a <code>traceparent</code> key-value pair</li><li>The <code>traceparent</code> key-value pair holds the Trace ID we seek<ul><li>There are 4 groups of values, separated by <code>-</code>. The Trace ID is the 2nd group of characters</li></ul></li><li><strong>Copy the Trace ID, and save it.</strong> We will need it for a later step in this workshop</li></ul><p><a href=#R-image-afa56826146421c15d8770153b55ba6c class=lightbox-link><img alt="Lambda Consumer Logs, Manual Instruamentation" class="lazy lightbox figure-image" loading=lazy src=../images/08-Manual-ConsumerLogs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-afa56826146421c15d8770153b55ba6c><img alt="Lambda Consumer Logs, Manual Instruamentation" class="lazy lightbox lightbox-image" loading=lazy src=../images/08-Manual-ConsumerLogs.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=splunk-apm-lambda-functions-and-traces-again>Splunk APM, Lambda Functions and Traces, Again!</h1><p>In order to see the result of our context propagation outside of the logs, we&rsquo;ll once again consult the <a href=https://app.us1.signalfx.com/#/apm rel=external>Splunk APM UI</a>.</p><h4 id=view-your-lambda-functions-in-the-splunk-apm-service-map>View your Lambda Functions in the Splunk APM Service Map</h4><p>Let&rsquo;s take a look at the Service Map for our environment in APM once again.</p><p>In Splunk Observability Cloud:</p><ul><li><p>Click on the <code>APM</code> Button in the Main Menu.</p></li><li><p>Select your APM Environment from the <code>Environment:</code> dropdown.</p></li><li><p>Click the <code>Service Map</code> Button on the right side of the APM Overview page. This will take you to your Service Map view.</p></li></ul><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p><em>Reminder: It may take a few minutes for your traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environment name in the list of environments.</em></p></div></details><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Notice the difference?</p></div></details><ul><li>You should be able to see the <code>producer-lambda</code> and <code>consumer-lambda</code> functions linked by the propagated context this time!</li></ul><p><a href=#R-image-f02b4661d9d66a58960813a4b08df6d5 class=lightbox-link><img alt="Splunk APM, Service Map" class="lazy lightbox figure-image" loading=lazy src=../images/09-Manual-ServiceMap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f02b4661d9d66a58960813a4b08df6d5><img alt="Splunk APM, Service Map" class="lazy lightbox lightbox-image" loading=lazy src=../images/09-Manual-ServiceMap.png></a></p><h4 id=explore-a-lambda-trace-by-trace-id>Explore a Lambda Trace by Trace ID</h4><p>Next, we will take another look at a trace related to our Environment.</p><ul><li>Paste the Trace ID you copied from the consumer function&rsquo;s logs into the <code>View Trace ID</code> search box under Traces and click <code>Go</code></li></ul><p><a href=#R-image-7ffa6116d51b196994947c7dc6e3c985 class=lightbox-link><img alt="Splunk APM, Trace Button" class="lazy lightbox figure-image" loading=lazy src=../images/10-Manual-TraceButton.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7ffa6116d51b196994947c7dc6e3c985><img alt="Splunk APM, Trace Button" class="lazy lightbox lightbox-image" loading=lazy src=../images/10-Manual-TraceButton.png></a></p><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
Note</summary><div class=box-content><p>The Trace ID was a part of the trace context that we propagated.</p></div></details><p>You can read up on two of the most common propagation standards:</p><ol><li><a href=https:///www.w3.org/TR/trace-context/#traceparent-header rel=external>W3C</a></li><li><a href=https://github.com/openzipkin/b3-propagation#overall-process rel=external>B3</a></li></ol><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Which one are we using?</p><ul><li><em>The Splunk Distribution of Opentelemetry JS, which supports our NodeJS functions, <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/nodejs/splunk-nodejs-otel-distribution.html#defaults-of-the-splunk-distribution-of-opentelemetry-js rel=external>defaults</a> to the <code>W3C</code> standard</em></li></ul></div></details><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Bonus Question: What happens if we mix and match the W3C and B3 headers?</p></div></details><p><a href=#R-image-e3ba3f42cc9f4254b2cb41e385dbebc1 class=lightbox-link><img alt="Splunk APM, Trace by ID" class="lazy lightbox figure-image" loading=lazy src=../images/11-Manual-TraceByID.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3ba3f42cc9f4254b2cb41e385dbebc1><img alt="Splunk APM, Trace by ID" class="lazy lightbox lightbox-image" loading=lazy src=../images/11-Manual-TraceByID.png></a></p><p>Click on the <code>consumer-lambda</code> span.</p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-question"></i>
Workshop Question</summary><div class=box-content><p>Can you find the attributes from your message?</p></div></details><p><a href=#R-image-85f6e07b42080e70e5486fb09e3f2c2f class=lightbox-link><img alt="Splunk APM, Span Tags" class="lazy lightbox figure-image" loading=lazy src=../images/12-Manual-SpanTags.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85f6e07b42080e70e5486fb09e3f2c2f><img alt="Splunk APM, Span Tags" class="lazy lightbox lightbox-image" loading=lazy src=../images/12-Manual-SpanTags.png></a></p><h3 id=clean-up>Clean Up</h3><p>We are finally at the end of our workshop. Kindly clean up after yourself!</p><h4 id=kill-the-send_message>Kill the <code>send_message</code></h4><ul><li><p>If the <code>send_message.py</code> script is still running, stop it with the follwing commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fg</span></span></code></pre></div><ul><li>This brings your background process to the foreground.</li><li>Next you can hit <code>[CONTROL-C]</code> to kill the process.</li></ul></li></ul><h4 id=destroy-all-aws-resources>Destroy all AWS resources</h4><p>Terraform is great at managing the state of our resources individually, and as a deployment. It can even update deployed resources with any changes to their definitions. But to start afresh, we will destroy the resources and redeploy them as part of the manual instrumentation portion of this workshop.</p><p>Please follow these steps to destroy your resources:</p><ul><li><p>Ensure you are in the <code>manual</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pwd</span></span></code></pre></div><ul><li><em>The expected output would be <strong>~/workshop/lambda/manual</strong></em></li></ul></li><li><p>If you are not in the <code>manual</code> directory, run the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/lambda/manual</span></span></code></pre></div></li><li><p>Destroy the Lambda functions and other AWS resources you deployed earlier:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>terraform destroy</span></span></code></pre></div><ul><li>respond <code>yes</code> when you see the <code>Enter a value:</code> prompt</li><li>This will result in the resources being destroyed, leaving you with a clean environment</li></ul></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=conclusion>Conclusion</h1><p>Congratulations on finishing the Lambda Tracing Workshop! You have seen how we can complement auto-instrumentation with manual steps to have the <code>producer-lambda</code> function&rsquo;s context be sent to the <code>consumer-lambda</code> function via a record in a Kinesis stream. This allowed us to build the expected Distributed Trace, and to contextualize the relationship between both functions in Splunk APM.</p><p><a href=#R-image-affd8ef7f18d079e57e25346e5d9a876 class=lightbox-link><img alt="Lambda application, fully instrumented" class="lazy lightbox figure-image" loading=lazy src=../images/13-Architecture_Instrumented.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-affd8ef7f18d079e57e25346e5d9a876><img alt="Lambda application, fully instrumented" class="lazy lightbox lightbox-image" loading=lazy src=../images/13-Architecture_Instrumented.png></a></p><p>You can now build out a trace manually by linking two different functions together. This comes in handy when your auto-instrumentation, or 3rd-party systems, do not support context propagation out of the box, or when you wish to add custom attributes to a trace for more relevant trace analaysis.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 16, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=dashboard-workshop>Dashboard Workshop</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>45 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Pieter Hagen</span></span><p>Welcome to the workshop on <strong>Dashboards</strong> in the Splunk Observability Cloud. This session is designed to help you get hands-on experience with building insightful visualizations.</p><p>Weâ€™ll be working with existing demo data available in the Splunk Observability Suite. You can follow along using any <strong>trial</strong> or <strong>production</strong> Splunk Observability organization that you have access to.</p><h3 id=what-youll-learn>What Youâ€™ll Learn</h3><h3 id=dashboards>Dashboards</h3><p>In the first part of the workshop, weâ€™ll focus on dashboards and charts:</p><ul><li>Understanding dashboards and the role of charts</li><li>Editing existing charts and creating new ones</li><li>Applying filters and using analytical functions</li><li>Building and customizing formulas</li><li>Saving charts into a dashboard for reuse</li><li>An introduction to SignalFlow for advanced charting</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Dashboard Workshop</h1><article class=default><header class=headline></header><h1 id=intro-to-dashboards>Intro to Dashboards</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=1-dashboards>1. Dashboards</h2><p>Dashboards are collections of charts and visualizations that display key metrics in one place. A well-designed dashboard gives you quick, actionable insights into the health and performance of your system. They can be as simple or as detailed as neededâ€”ranging from a few focused charts to complex views across multiple services.</p><p>In this module, youâ€™ll build several charts and bring them together into the following custom dashboard.</p><p><a href=#R-image-43ec2e169ee2d5e3b1e0f0b04c79b228 class=lightbox-link><img alt="Example Dashboard" class="lazy lightbox figure-image" loading=lazy src=../images/example-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-43ec2e169ee2d5e3b1e0f0b04c79b228><img alt="Example Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../images/example-dashboard.png></a></p><hr><h2 id=2-accessing-dashboards>2. Accessing Dashboards</h2><p>To begin, letâ€™s locate the dashboards in Splunk Observability suite.</p><p>Click the <strong>Dashboards (1)</strong> button in the left-hand navigation menu. If the menu is collapsed, you can expand it by clicking the hamburger icon in the top-left corner of the screen.</p><p>This will take you to the main Dashboard view, where youâ€™ll see all available dashboardsâ€”including the pre-built ones provided by Splunk Observability.</p><p>If your organization is already ingesting data from a Cloud API integration or through the Splunk OpenTelemetry Agent, you may also see additional dashboards relevant to those services.</p><p><a href=#R-image-dddae5a8b8d4bcb3454c9c8e7274ce9b class=lightbox-link><img alt="Sample Data" class="lazy lightbox figure-image" loading=lazy src=../images/sample-data.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dddae5a8b8d4bcb3454c9c8e7274ce9b><img alt="Sample Data" class="lazy lightbox lightbox-image" loading=lazy src=../images/sample-data.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 9, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Dashboards</h1><article class=default><header class=headline></header><h1 id=locating-our-sample-data>Locating our Sample Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=1-exploring-the-sample-data>1. Exploring the Sample Data</h2><p>In the list of available dashboards, look for a group called <strong>Sample Data (2)</strong>.</p><p>This group contains dashboards that showcase visualizations built from sample metrics. These will give you a sense of how different data can be represented using charts and dashboards in Splunk Observability.</p><p><a href=#R-image-27681ba2e36b8d5b0441db7be152109c class=lightbox-link><img alt="Sample Data" class="lazy lightbox figure-image" loading=lazy src=../../images/sample-data.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-27681ba2e36b8d5b0441db7be152109c><img alt="Sample Data" class="lazy lightbox lightbox-image" loading=lazy src=../../images/sample-data.png></a></p><hr><p>Expand the <strong>Sample Data</strong> dashboard group by clicking on it, then select the <strong>Sample Charts (3)</strong> dashboard.</p><p>This dashboard showcases a variety of chart types, styles, and formatting options available in Splunk Observability. Itâ€™s a great way to get a feel for how flexible and customizable your dashboards can be.</p><p>The sample data runs on a 10-minute cycle, generating different patterns and behaviors over time.<br>To see these changes in action, adjust the time range in the top-right corner of the dashboard to <strong>Last 15 minutes</strong> or, for a better overview, select <strong>Last 1 hour</strong>. This will help you observe how the data updates and cycles through different conditions.</p><p>Take a moment to explore the charts in this dashboard, each one provides a different perspective on how sample data can be visualized.</p><p><a href=#R-image-7aeb4c5245ffd8c49c32bbfa879eb563 class=lightbox-link><img alt="Sample Charts" class="lazy lightbox figure-image" loading=lazy src=../../images/sample-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7aeb4c5245ffd8c49c32bbfa879eb563><img alt="Sample Charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/sample-charts.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=exploring-charts>Exploring Charts</h1><p>In this section, weâ€™ll start by exploring how charts are built and displayed in Splunk Observability. By examining and interacting with an existing chart, youâ€™ll get a feel for how the chart editor worksâ€”how data sources are selected, how visual options are configured, and how different settings shape what you see.</p><h2 id=1-select-a-chart>1. Select a chart</h2><p>To get started, make sure you have the <strong>SAMPLE CHARTS</strong> dashboard open and adjust the time range in the top-right corner of the dashboard back to <strong>-5M</strong> for Last 5 Minutes or select <strong>reset to default</strong></p><p>Find the <strong>Latency histogram</strong> chart, then click on the <strong>three dots</strong> (&mldr;) <strong>(1)</strong> in the upper-right corner of the chart. From the menu, select <strong>Open (3)</strong>. You can also simply click on the chart title (<strong>Latency histogram</strong>) <strong>(2)</strong> to open it directly.</p><p><a href=#R-image-5e2343e4116fe92d4b0d1caf4a98acb2 class=lightbox-link><img alt="Sample Charts" class="lazy lightbox figure-image" loading=lazy src=../../images/latency-histogram-open.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e2343e4116fe92d4b0d1caf4a98acb2><img alt="Sample Charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/latency-histogram-open.png></a></p><hr><p>Once the chart editor opens, youâ€™ll see the configuration settings for the Latency histogram chart.</p><p>The chart editor is where you can control how your data is visualized. You can change the chart type, apply transformation functions, adjust time settings, and customize other visual and data-related options to match your specific needs.</p><p><a href=#R-image-385615c88a8330df7467e605b5021c94 class=lightbox-link><img alt="Latency Histogram" class="lazy lightbox figure-image" loading=lazy src=../../images/latency-histogram.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-385615c88a8330df7467e605b5021c94><img alt="Latency Histogram" class="lazy lightbox lightbox-image" loading=lazy src=../../images/latency-histogram.png></a></p><hr><p>In the <strong>Plot Editor (1)</strong> tab, under the <strong>Signal (2)</strong> section, youâ€™ll find the metric currently being used: <code>demo.trans.latency</code> <strong>(3)</strong>. This signal represents the latency data that the chart is plotting. You can use this area to edit or add additional signals to compare or enrich the visualization.</p><p>Youâ€™ll notice several <strong>Line</strong> plots displayed in the chart. The label <code>18 ts</code> <strong>(4)</strong> indicates that the chart is currently plotting <strong>18 individual metric time series</strong>.
<a href=#R-image-5540cc1011c52fbd38a47f8e84d44711 class=lightbox-link><img alt="Plot Editor" class="lazy lightbox figure-image" loading=lazy src=../../images/plot-editor.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5540cc1011c52fbd38a47f8e84d44711><img alt="Plot Editor" class="lazy lightbox lightbox-image" loading=lazy src=../../images/plot-editor.png></a></p><p>To explore different visualization styles, try clicking on the various chart type icons in the editor. As you hover over each icon, its name will appearâ€”helping you understand what each type represents.</p><p><a href=#R-image-2f52f6cf3cbb5754cf3e1112e750cfa7 class=lightbox-link><img alt="Chart Types" class="lazy lightbox figure-image" loading=lazy src=../../images/chartbartypes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2f52f6cf3cbb5754cf3e1112e750cfa7><img alt="Chart Types" class="lazy lightbox lightbox-image" loading=lazy src=../../images/chartbartypes.png></a></p><p>For example, click on the <strong>Heat Map</strong> icon to see how the same data is represented in a different format.</p><p><a href=#R-image-0a3d53990fef5e5e218cfd59badc7e63 class=lightbox-link><img alt="Change to Heatmap" class="lazy lightbox figure-image" loading=lazy src=../../images/change-to-heatmap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a3d53990fef5e5e218cfd59badc7e63><img alt="Change to Heatmap" class="lazy lightbox lightbox-image" loading=lazy src=../../images/change-to-heatmap.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>You can visualize your metrics using a variety of chart typesâ€”choose the one that best represents the insights you want to highlight.</p><p>For a detailed overview of available chart types and when to use them, check out <a href=https://docs.splunk.com/Observability/data-visualization/charts/chart-types.html#chart-types rel=external>Choosing a chart type.</a></p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 18, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=editing-charts>Editing Charts</h1><p>In this section, weâ€™ll start exploring how charts are structured by editing an existing one. This is a great way to get hands-on experience with the chart editor and understand how chart settings, data sources, and visualization options all come together.</p><hr><p>With the <strong>Latency histogram</strong> chart open in the chart editor, letâ€™s begin configuring it for our workshop.</p><p>Click on the <strong>Line chart</strong> type icon <strong>(1)</strong> in the <strong>visualization</strong> pane to change the chart type. The data will now be displayed as a line plot.</p><p><a href=#R-image-e87bf95089c919df74a8f9349e6ed5c6 class=lightbox-link><img alt="Line Chart" class="lazy lightbox figure-image" loading=lazy src=../../images/change-to-line.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e87bf95089c919df74a8f9349e6ed5c6><img alt="Line Chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/change-to-line.png></a></p><h2 id=2-changing-the-charts-time-window>2. Changing the Chartâ€™s Time Window</h2><p>You can adjust the time range for the chart to view more historical data. To do this, click on the <strong>Time (1)</strong> dropdown in the top-right corner of the chart editor and select <strong>Past 15 minutes (2)</strong>.</p><p>This will expand the time window and allow you to see more of the metric trends over a longer period.</p><p><a href=#R-image-a3a3ef29dd6b1b78310b0643e8a60252 class=lightbox-link><img alt="Line Chart" class="lazy lightbox figure-image" loading=lazy src=../../images/time_window.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a3a3ef29dd6b1b78310b0643e8a60252><img alt="Line Chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/time_window.png></a></p><h2 id=3--exploring-the-data-table>3. Exploring the Data Table</h2><p>Click on the <strong>Data Table (1)</strong> tab in the chart editor.</p><p>The <strong>Data Table</strong> gives you a behind-the-scenes look at the metric time series powering the chart.</p><p><a href=#R-image-3fdf13a7ab4742f33d32e518e95f19e1 class=lightbox-link><img alt="Data Table" class="lazy lightbox figure-image" loading=lazy src=../../images/data-table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3fdf13a7ab4742f33d32e518e95f19e1><img alt="Data Table" class="lazy lightbox lightbox-image" loading=lazy src=../../images/data-table.png></a></p><p>Each row in the table represents a single time series, and each column shows a dimension associated with that series. For the metric <code>demo.trans.latency</code>, youâ€™ll see the following dimensions:</p><ul><li><code>demo_datacenter</code> <strong>(2)</strong></li><li><code>demo_customer</code> <strong>(3)</strong></li><li><code>demo_host</code> <strong>(4)</strong></li></ul><p>In the <strong><code>demo_datacenter</code></strong> column, youâ€™ll notice there are two data centers: <strong>Paris (5)</strong> and <strong>Tokyo (6)</strong><br>Each has multiple associated time series.</p><p>As you move your cursor across the chart (horizontally through time), the <strong>Data Table</strong> updates in real time to reflect the values at the current time point. If you click on a specific line in the chart, it will pin that time series in the table, showing a fixed valueâ€”this is indicated with a <strong>pinned value (7)</strong>.</p><hr><p>When youâ€™re ready, click back on the <strong>Plot editor (8)</strong> tab to close the data table.</p><p>Next, letâ€™s save this chart to a dashboard, so we can reuse it later!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=saving-charts-and-dashboards>Saving Charts and Dashboards</h1><p>Once youâ€™ve customized a chart to fit your needs, the next step is to save it as part of a dashboard. Saving your work lets you reuse, share, and monitor key visualizations over time. In this section, youâ€™ll learn how to name and describe your chart, and how to add it to a dashboard for easy access later.</p><h2 id=1-saving-a-chart>1. Saving a Chart</h2><p>To begin saving your chart, letâ€™s give it a clear name and description.</p><p>Click on the chart title, currently labeled <strong>Copy of Latency Histogram</strong>, and rename it to <strong>â€œActive Latencyâ€ (1)</strong>.</p><p>Next, update the chart description. Click on the existing text, <strong>Spread of latency values across time</strong>, and change it to:
<strong>Overview of latency values in real-time</strong>. <strong>(2)</strong></p><p>These updates help make the chart easier to identify and understand when itâ€™s part of a larger dashboard or shared with others.</p><p><a href=#R-image-819a0fafb2166926bd10c2cae6ff44b4 class=lightbox-link><img alt="Save Chart" class="lazy lightbox figure-image" loading=lazy src=../../images/save-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-819a0fafb2166926bd10c2cae6ff44b4><img alt="Save Chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/save-chart.png></a></p><p>Click the <span class="btn cstyle blue"><span><span class=title>Save As</span></span></span> <strong>(3</strong>) button to begin the saving process. The chart will use the name <strong>Active Latency</strong> that you set earlier, but you can update the name here if needed.</p><p>Once youâ€™re ready, click the <span class="btn cstyle blue"><span><span class=title>Ok</span></span></span> <strong>(1)</strong>
button to confirm and continue.</p><p><a href=#R-image-2cfa63379b23e28f9a07fbfcd17c1cec class=lightbox-link><img alt="Name Chart" class="lazy lightbox figure-image" loading=lazy src=../../images/name-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2cfa63379b23e28f9a07fbfcd17c1cec><img alt="Name Chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/name-chart.png></a></p><h2 id=2-creating-a-dashboard>2. Creating a dashboard</h2><p>Now that weâ€™re saving the chart, we need somewhere to store itâ€”<strong>a dashboard</strong>.</p><p>Dashboards help organize and group related charts together, making it easier to monitor key metrics in one view. For this workshop, weâ€™ll create a <strong>new dashboard</strong> to hold the charts we are building.</p><p>In the <strong>Choose dashboard</strong> dialog, click the <span class="btn cstyle blue"><span><span class=title>New Dashboard</span></span></span> <strong>(1)</strong> button.</p><p><strong>Important</strong>: Do not select an existing dashboardâ€”make sure to create a new one for this exercise.</p><p><a href=#R-image-1eb8900d03d6583c440fcece06ef7d61 class=lightbox-link><img alt="Create Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/create-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1eb8900d03d6583c440fcece06ef7d61><img alt="Create Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/create-dashboard.png></a></p><p>Youâ€™ll now see the <strong>New Dashboard</strong> dialog, where you can configure the details of your new dashboard.</p><p>Start by giving your dashboard a name. For this workshop, use the following format: <strong>YOUR_NAME-Dashboard</strong>
Replace <strong>YOUR_NAME</strong> with your actual name to make your dashboard easy to identify.</p><p>Next, update the <strong>permissions</strong>. Set them to <strong>Restricted Read and Write access</strong>, to ensure that only you (or specific users) can view and modify the dashboard. Make sure your user account is included and has both read and write access.</p><p><a href=#R-image-930cd6839ee08479c9e481b9e925f329 class=lightbox-link><img alt="Secure Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/secure-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-930cd6839ee08479c9e481b9e925f329><img alt="Secure Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/secure-dashboard.png></a></p><p>You should now see your own user account listed in the permissions, which means <strong>you are currently the only one who can edit this dashboard</strong>.</p><p>If needed, you can add additional users or teams by selecting them from the dropdown below.</p><p>For the purposes of this workshop, letâ€™s remove the restrictions. Change the permissions setting to <em><strong>Everyone can Read and Write</strong></em> so that access isnâ€™t limited during the session.</p><p><a href=#R-image-fe94bfe95be9b8fba23f3231abe69622 class=lightbox-link><img alt="Name Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/name-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fe94bfe95be9b8fba23f3231abe69622><img alt="Name Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/name-dashboard.png></a></p><p>Now, click the <span class="btn cstyle blue"><span><span class=title>Save</span></span></span> button to continue.
Your new dashboard will be created and automatically selected, allowing you to save your chart directly into it</p><p><a href=#R-image-855b8d5f0689fdf27f147a28d59a0f98 class=lightbox-link><img alt="Choose Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/choose-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-855b8d5f0689fdf27f147a28d59a0f98><img alt="Choose Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/choose-dashboard.png></a></p><p>Make sure your newly created dashboard is selected <strong>(1)</strong>, then click the <span class="btn cstyle blue"><span><span class=title>Ok</span></span></span> button <strong>(2)</strong> to proceed.</p><p>Youâ€™ll now be taken to your dashboard. In the top-left corner, youâ€™ll see that <strong>YOUR_NAME-DASHBOARD</strong> is part of a Dashboard Group is part of a dashboard group with the same name. You can add additional dashboards to this dashboard group to organize charts around different use cases, systems, or projects.</p><p><a href=#R-image-1bd2eef33cf62f0e0965b216d2d41f99 class=lightbox-link><img alt="New Dashboard Group" class="lazy lightbox figure-image" loading=lazy src=../../images/new-dashboard-group.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1bd2eef33cf62f0e0965b216d2d41f99><img alt="New Dashboard Group" class="lazy lightbox lightbox-image" loading=lazy src=../../images/new-dashboard-group.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-new-chart>Create New Chart</h1><h3 id=1-creating-a-new-chart>1 Creating a New Chart</h3><p>Now letâ€™s create a new chart and add it to the dashboard weâ€™ve been working on!</p><p>To get started, click the plus icon <strong>(1)</strong> in the top-middle part of the interface. From the dropdown, select <strong>Chart (2)</strong>.
Alternatively, you can click the <span class="btn cstyle blue"><span><span class=title>+ New Chart</span></span></span> Button <strong>(3)</strong> button to create a new chart directly.</p><p><a href=#R-image-da6b92be5f9f509528fca7b1985d880e class=lightbox-link><img alt="Create new chart" class="lazy lightbox figure-image" loading=lazy src=../../images/new-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-da6b92be5f9f509528fca7b1985d880e><img alt="Create new chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/new-chart.png></a></p><p>Youâ€™ll now see a blank chart template, ready for configuration:</p><p><a href=#R-image-a52b2184c189c4a249679202dba748b5 class=lightbox-link><img alt="Empty Chart" class="lazy lightbox figure-image" loading=lazy src=../../images/empty-new-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a52b2184c189c4a249679202dba748b5><img alt="Empty Chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/empty-new-chart.png></a></p><p>Letâ€™s begin by adding a metric to visualize. For this example, weâ€™ll continue working with <strong><code>demo.trans.latency</code></strong>, the same metric we used earlier.</p><p>In the <strong>Plot Editor (1)</strong>, go to the <strong>Signal (2)</strong> section, and enter <strong><code>demo.trans.latency</code>(3)</strong> into the input field. This will load the latency time series data into the chart, so we can start building and customizing our visualization.</p><p><a href=#R-image-37da7acdb341dfd6692da7916537fc60 class=lightbox-link><img alt=Signal class="lazy lightbox figure-image" loading=lazy src=../../images/plot-editor.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37da7acdb341dfd6692da7916537fc60><img alt=Signal class="lazy lightbox lightbox-image" loading=lazy src=../../images/plot-editor.png></a></p><p>You should now see a familiar line chart displaying <strong>18 time series (4)</strong>. To view recent activity, change the time range to <strong>Past 15 minutes</strong> by selecting it from the <strong>Time dropdown (1)</strong></p><p><a href=#R-image-24ceb4bf98373b53d8cd62f5be3ac0f0 class=lightbox-link><img alt=Signal class="lazy lightbox figure-image" loading=lazy src=../../images/line-chart-15-mins.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-24ceb4bf98373b53d8cd62f5be3ac0f0><img alt=Signal class="lazy lightbox lightbox-image" loading=lazy src=../../images/line-chart-15-mins.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=using-filters--analytics>Using Filters & Analytics</h1><h3 id=1-filtering-and-analytics>1. Filtering and Analytics</h3><p><strong>Splunk Observability</strong> makes it easy to explore large volumes of metric data by using <strong>filters</strong> and <strong>analytics functions</strong>. Filters help you focus on specific segments of your dataâ€”such as a particular service, host, or locationâ€”while analytics functions let you transform and analyze that data for deeper insights.</p><p>Now letâ€™s narrow down our data to focus on the <strong>Paris data center</strong>, which will allow us to apply more targeted analytics. Weâ€™ll do this by using a <strong>Filter</strong>.</p><p>Start by returning to the <strong>Plot Editor</strong> tab. Click the <span class="btn cstyle blue"><span><span class=title>Add Filter</span></span></span> button <strong>(2)</strong> as shown in the screenshot below.</p><p>Wait a moment for the available dimensions to populate. Then:</p><ul><li>Select <strong>demo_datacenter (1)</strong> as the filter dimension.</li><li>Choose <strong>Paris (2)</strong> as the value to filter on.</li></ul><p>This filter will limit the chart to show only the time series coming from the Paris data center, making your analysis more focused and meaningful.</p><p><a href=#R-image-28ace17b22d94ae710aa3b85928f600c class=lightbox-link><img alt=Filter class="lazy lightbox figure-image" loading=lazy src=../../images/select-filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-28ace17b22d94ae710aa3b85928f600c><img alt=Filter class="lazy lightbox lightbox-image" loading=lazy src=../../images/select-filter.png></a></p><hr><p>In the <strong>F(x) (1)</strong> column of the chart editor, click the <span class="btn cstyle blue"><span><span class=title>Add Analytics</span></span></span> button o apply an analytic function.
From the dropdown list, select <strong><code>Percentile</code> (2)</strong>, and then choose the <strong><code>Percentile:Aggregation</code> (3)</strong> option.
In the follow-up panel, leave the percentile value set to 90, which tells the chart to display the 90th percentile of the selected time series.</p><p>In this context, the 90th percentile represents the value below which 90% of the latency measurements fall, in other words, only <strong>the highest 10%</strong> of values exceed this point. This is a useful way to understand â€œworst-case normalâ€ performanceâ€”filtering out occasional spikes while still showing when latency is approaching unacceptable levels.</p><p>To apply the function, simply click anywhere outside the panel to confirm your selection <strong>(4)</strong>.</p><p><a href=#R-image-af0e9b57a80e5bd4af63cd5b6a942341 class=lightbox-link><img alt=Analytics class="lazy lightbox figure-image" loading=lazy src=../../images/prepare_filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af0e9b57a80e5bd4af63cd5b6a942341><img alt=Analytics class="lazy lightbox lightbox-image" loading=lazy src=../../images/prepare_filter.png></a></p><p>For info on the <strong>Percentile</strong> function and the other functions see <a href=https://docs.splunk.com/Observability/data-visualization/charts/gain-insights-through-chart-analytics.html#gain-insights-through-chart-analytics rel=external>Chart Analytics</a>.</p><hr><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 18, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=using-timeshift--formulas>Using TimeShift & Formula's</h1><h3 id=1-using-timeshift-analytical-function>1. Using Timeshift Analytical Function</h3><p>In many cases, itâ€™s useful to compare current performance against historical dataâ€”for example, to identify trends, regressions, or improvements over time. The <strong>Timeshift</strong> function makes this easy by shifting a time series backward in time, letting you see past values side by side with the present.</p><p>To get started, clone <strong>Signal A</strong> by clicking the <strong><code>...</code></strong> menu <strong>(1)</strong> next to it and selecting <strong>Clone (2)</strong> from the dropdown.</p><p><strong>Cloning</strong> a signal creates an identical copy with the same metric, filters, and settings. This duplicateâ€”<strong>Signal B</strong>â€”can then be used for further calculations or comparisons, such as applying a <strong>Timeshif</strong>t to visualize what the metric looked like one week ago, without altering the original signal.
<a href=#R-image-10535f81e256b21df88671e194e152f6 class=lightbox-link><img alt="Clone Signal" class="lazy lightbox figure-image" loading=lazy src=../../images/timeshift-filter.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-10535f81e256b21df88671e194e152f6><img alt="Clone Signal" class="lazy lightbox lightbox-image" loading=lazy src=../../images/timeshift-filter.png></a></p><hr><p>After cloning, youâ€™ll see a new signal labeled <strong>Signal B (1)</strong>. Since itâ€™s an exact copy of <strong>Signal A</strong>, both signals display the same data over the same time range. As a result, they appear to <strong>overlap completely</strong> on the chart, making it look like thereâ€™s only one line.</p><p>To make the comparison meaningful, weâ€™ll apply a <strong>Timeshift</strong> to <strong>Signal B</strong>, shifting its data one week into the past. This allows us to see how current latency trends compare to those from the same time last week.</p><p>In the <strong>F(x)</strong> column next to Signal B, click the <span class="btn cstyle blue"><span><span class=title><strong>+</strong></span></span></span> <strong>(2)</strong>, then choose the <strong>Timeshift (3)</strong> function from the list.
<a href=#R-image-03fb46d4dc468c72f79f78db8f48b80f class=lightbox-link><img alt="Plot Editor" class="lazy lightbox figure-image" loading=lazy src=../../images/ab-plot-full.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-03fb46d4dc468c72f79f78db8f48b80f><img alt="Plot Editor" class="lazy lightbox lightbox-image" loading=lazy src=../../images/ab-plot-full.png></a></p><hr><p>When prompted, enter <strong>1w</strong> (or <strong>7d</strong> for 7 days) <strong>(4)</strong> as the time shift value. Click anywhere outside the panel <strong>(5)</strong> to confirm the change.</p><p>This will shift <strong>Signal B</strong>â€™s data one week into the past, allowing you to visually compare current latency trends with those from the same time last week.<br><a href=#R-image-c03d64077838d2f039d60d5556da2349 class=lightbox-link><img alt=Timeshift class="lazy lightbox figure-image" loading=lazy src=../../images/b-shifted.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c03d64077838d2f039d60d5556da2349><img alt=Timeshift class="lazy lightbox lightbox-image" loading=lazy src=../../images/b-shifted.png></a></p><hr><p>To change the color of <strong>Signal B</strong>, click the âš™ï¸ settings icon <strong>(1)</strong> on the far right of its row to open the settings menu. Then, select a <strong>Plot Color</strong>, such as pink <strong>(2)</strong>, to visually distinguish <strong>Signal B</strong> from the original signal on the chart.
When you are done, click on the<span class="btn cstyle" style=--VARIABLE-BOX-color:gray><span><span class=title>Close</span></span></span> <strong>(3)</strong>
<a href=#R-image-c7a30d443b9acddf9d4da8a4c252c105 class=lightbox-link><img alt="Change Plot Color" class="lazy lightbox figure-image" loading=lazy src=../../images/b-pink.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c7a30d443b9acddf9d4da8a4c252c105><img alt="Change Plot Color" class="lazy lightbox lightbox-image" loading=lazy src=../../images/b-pink.png></a></p><hr><p>You should now see two plots on the chart: the <em>p90</em> of current latency (<strong>Signal A</strong>) shown in blue, and the <em>p90</em> from one week ago (<strong>Signal B</strong>) shown in pink.</p><p>To make the difference between them easier to interpret, click the <strong>Area chart</strong> icon <strong>(1)</strong> to change the visualization style. This highlights the areas under the curves, making it easier to spot when last weekâ€™s latency was higher than the current values.</p><p>Next, update the time range by clicking the field next to <strong>Time (2)</strong> in the Override bar and selecting <strong>Past Hour (3)</strong> from the dropdown.
<a href=#R-image-dba74d4b0928628142cc44df495088c7 class=lightbox-link><img alt=Timeframe class="lazy lightbox figure-image" loading=lazy src=../../images/a-b-area.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dba74d4b0928628142cc44df495088c7><img alt=Timeframe class="lazy lightbox lightbox-image" loading=lazy src=../../images/a-b-area.png></a></p><hr><h3 id=2-using-formulas>2. Using Formulas</h3><p>Now letâ€™s take it a step further by calculating the difference between two time-shifted metric valuesâ€”for example, comparing todayâ€™s data with data from exactly one week ago.</p><p>Click the <span class="btn cstyle blue"><span><span class=title>Enter Formula</span></span></span> button one line <strong>C (1)</strong>, then type in <strong>A - B</strong> <strong>(2)</strong> to subtract <strong>Signal B</strong> from <strong>Signal A</strong>. This creates a new calculated signal, labeled <strong>C</strong>.</p><p>To focus only on the result of this formula, hide the other signals by clicking the eye icon next to <strong>A (3)</strong> and <strong>B (4)</strong>, leaving only <strong>C</strong> visible.</p><p><a href=#R-image-fa7aeff3cf73d2d4366ac5b037ccaf44 class=lightbox-link><img alt="C only" class="lazy lightbox figure-image" loading=lazy src=../../images/c-only.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fa7aeff3cf73d2d4366ac5b037ccaf44><img alt="C only" class="lazy lightbox lightbox-image" loading=lazy src=../../images/c-only.png></a></p><p>You should now see a single line that represents the difference between the current metric values (<strong>A</strong>) and those from a week ago (<strong>B</strong>). In the chart, some values may appear negativeâ€”this happens when the older metric (<strong>B</strong>) was higher than the current one (<strong>A</strong>) at that point in time.</p><p>Now that weâ€™ve explored visual chart analytics, letâ€™s take a look under the hood at the SignalFlow powering our charts and detectors in the next section!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=using-signalflow>Using SignalFlow</h1><h2 id=1-introduction-to-signalflow>1. Introduction to SignalFlow</h2><p>Now letâ€™s take a closer look at <strong>SignalFlow</strong>, the powerful analytics language behind Splunk Observability Cloud. SignalFlow enables you to define monitoring logic as code, offering a flexible and real-time way to work with metrics and automate alerting.</p><p>At the core of <strong>Splunk Infrastructure Monitoring</strong> is the <strong>SignalFlow analytics engine</strong>, which processes streaming metric data in real time. SignalFlow is written in a Python-like syntax and allows you to build computations that take in <strong>metric time series (MTS)</strong>, perform transformations or calculations, and output new MTS.</p><p>Some common use cases for SignalFlow include:</p><ul><li>Comparing current values with historical trends, such as week-over-week comparisons</li><li>Creating population-level insights using distributed percentile charts</li><li>Monitoring rates of change or thresholds, such as detecting when a Service Level Objective (SLO) is breached</li><li>Identifying correlated dimensions, like pinpointing which service is linked to an increase in low disk space alerts</li></ul><p>You can create SignalFlow based computations directly in the <strong>Chart Builder</strong> interface by selecting metrics and applying analytical functions visually. For more advanced use cases, you can also write and execute SignalFlow programs directly using the <strong>SignalFlow API</strong>.</p><p>SignalFlow includes a robust set of built-in functions that operate on time series dataâ€”making it ideal for dynamic, real-time monitoring across complex systems.</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>For more information on SignalFlow see <a href=https://docs.splunk.com/Observability/infrastructure/analytics/signalflow.html rel=external>Analyze incoming data using SignalFlow</a>.</p></div></details><h2 id=2-view-signalflow>2. View SignalFlow</h2><p>In the Chart Builder, click on <strong>View SignalFlow</strong>, to open the underlying code that powers your chart.</p><p><a href=#R-image-5aae6e33e21c65722daae734cce75bee class=lightbox-link><img alt=SignalFlow class="lazy lightbox figure-image" loading=lazy src=../../images/view-signalflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5aae6e33e21c65722daae734cce75bee><img alt=SignalFlow class="lazy lightbox lightbox-image" loading=lazy src=../../images/view-signalflow.png></a></p><p>When you click <strong>View SignalFlow</strong>, youâ€™ll see the <strong>SignalFlow program (1)</strong> that defines the logic and transformations behind your chart. This view gives you direct access to the code powering your visualization, allowing you to fine-tune or extend it beyond whatâ€™s possible in the visual editor.</p><p>Below is an example of the SignalFlow code for the chart we just created. This snippet shows how we defined the two percentile signals (current and one week ago), applied a timeshift, and calculated the difference between them. Reviewing the code helps clarify how each step contributes to the final chart.</p><div class=tab-panel data-tab-group=R-tabs-714a5be11c4fe465fe0f7742bd9c0e81><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ecb79377220536a6116005628479e822 aria-expanded=true data-tab-item=R-tab-965ae68a9cd5ddbb6af8e4d6db1e87e6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-714a5be11c4fe465fe0f7742bd9c0e81","R-tab-965ae68a9cd5ddbb6af8e4d6db1e87e6")'>
<span class=tab-nav-text>SignalFlow</span></button></div><div class=tab-content-container><div id=R-tab-id-ecb79377220536a6116005628479e822 data-tab-item=R-tab-965ae68a9cd5ddbb6af8e4d6db1e87e6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;A&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>B</span> <span class=o>=</span> <span class=n>data</span><span class=p>(</span><span class=s1>&#39;demo.trans.latency&#39;</span><span class=p>,</span> <span class=nb>filter</span><span class=o>=</span><span class=nb>filter</span><span class=p>(</span><span class=s1>&#39;demo_datacenter&#39;</span><span class=p>,</span> <span class=s1>&#39;Paris&#39;</span><span class=p>))</span><span class=o>.</span><span class=n>percentile</span><span class=p>(</span><span class=n>pct</span><span class=o>=</span><span class=mi>95</span><span class=p>)</span><span class=o>.</span><span class=n>timeshift</span><span class=p>(</span><span class=s1>&#39;1w&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;B&#39;</span><span class=p>,</span> <span class=n>enable</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>C</span> <span class=o>=</span> <span class=p>(</span><span class=n>A</span><span class=o>-</span><span class=n>B</span><span class=p>)</span><span class=o>.</span><span class=n>publish</span><span class=p>(</span><span class=n>label</span><span class=o>=</span><span class=s1>&#39;C&#39;</span><span class=p>)</span></span></span></code></pre></div></div></div></div></div><p>Click on <strong>View Builder (2)</strong> to go back to the Chart <strong>Builder</strong> UI.</p><p><a href=#R-image-51acd23b91d3ed0869daf38b5a8b9b27 class=lightbox-link><img alt="View Builder" class="lazy lightbox figure-image" loading=lazy src=../../images/show-signalflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-51acd23b91d3ed0869daf38b5a8b9b27><img alt="View Builder" class="lazy lightbox lightbox-image" loading=lazy src=../../images/show-signalflow.png></a></p><p>Let&rsquo;s save this new chart to our Dashboard!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Apr 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-charts-to-dashboards>Adding charts to dashboards</h1><h2 id=1-saving-to-an-existing-dashboard>1. Saving to an Existing Dashboard</h2><p>Before saving your chart, check the top-left corner to confirm that <strong>YOUR_NAME-Dashboard: YOUR_NAME-Dashboard (1)</strong> is selected. This ensures that your chart will be saved to the correct dashboard.</p><p>Next, give your chart a name. Enter <strong>Latency History</strong> <strong>(2)</strong>, and if youâ€™d like, add a brief description in the <strong>Chart Description (3)</strong> if you wish like in our example.
<a href=#R-image-1a24db565fb397a028f0b36ac12714b5 class=lightbox-link><img alt="Save Chart 1" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1a24db565fb397a028f0b36ac12714b5><img alt="Save Chart 1" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-1.png></a></p><hr><p>When youâ€™re ready, click the <span class="btn cstyle blue"><span><span class=title>Save And Close</span></span></span> button <strong>(4)</strong>. Youâ€™ll be returned to your dashboard, which now contains two charts.
<a href=#R-image-a99833d9864d16d578995934ebbd6708 class=lightbox-link><img alt="Save Chart 2" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a99833d9864d16d578995934ebbd6708><img alt="Save Chart 2" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-2.png></a></p><hr><h2 id=2-copy-and-paste-a-chart>2. Copy and Paste a chart</h2><p>Now letâ€™s quickly add another chart by duplicating the one we just created.</p><p>In your dashboard, locate the <strong>Latency History</strong> chart and click the three dots <strong><code>...</code></strong> <strong>(1)</strong> in the upper-right corner of the chart. From the menu, select <strong>Copy (2)</strong>.</p><p>After copying, youâ€™ll notice a small white <strong>1</strong> appear in front of the <strong>+</strong> icon <strong>(3)</strong> at the top of the page. This indicates that one chart is ready to be pasted.
<a href=#R-image-d8036b73da2614f889249c2634c9a23f class=lightbox-link><img alt="Copy chart" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-3.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d8036b73da2614f889249c2634c9a23f><img alt="Copy chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-3.png></a></p><hr><p>Click the <strong>+</strong> icon <strong>()1</strong> at the top of the page, and in the dropdown menu, select <strong>(2)</strong>.<br>You should also see a <strong>1</strong> at the end of that line, confirming that the copied chart is ready to be added.
<a href=#R-image-86e5a3dc95598af753cca54287e34bdb class=lightbox-link><img alt="Past charts" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-86e5a3dc95598af753cca54287e34bdb><img alt="Past charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-4.png></a></p><p>This will place a copy of the previous chart in your dashboard.
<a href=#R-image-9f456f1ce75cd52d9657bb4a8b583c45 class=lightbox-link><img alt="Three Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f456f1ce75cd52d9657bb4a8b583c45><img alt="Three Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-5.png></a></p><hr><h2 id=3-edit-the-pasted-chart>3. Edit the pasted chart</h2><p>To edit the duplicated chart, click the three dots <strong><code>...</code></strong> on one of the <strong>Latency History</strong> charts in your dashboard and then select <strong>Open</strong>. Alternatively, you can click directly on the chartâ€™s title, <strong>Latency History</strong>, to open it in the editor.</p><p>This will bring you to the editor environment again.</p><p>Start by adjusting the time range in the top-right corner of the chart. Set it to <strong>Past 1 Hour (1)</strong> to give you a broader view of recent data.</p><p>Next, letâ€™s customize the chart to make it unique. Click the eye icon next to <strong>Signal A (2)</strong> to make it visible again.<br>Then hide <strong>Signal C (3)</strong> by clicking its eye icon.</p><p>Update the chart title from <em>Latency history</em> to <strong>Latency vs Load (4)</strong>, and optionally add or edit the chart description to reflect the updated focus <strong>(5)</strong>.
<a href=#R-image-b586ec23991dd8c1589fc7e37b2216df class=lightbox-link><img alt="Set Visibility" class="lazy lightbox figure-image" loading=lazy src=../../images/morecharts-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b586ec23991dd8c1589fc7e37b2216df><img alt="Set Visibility" class="lazy lightbox lightbox-image" loading=lazy src=../../images/morecharts-6.png></a></p><hr><p>Click on the <span class="btn cstyle blue"><span><span class=title>Add Metric Or Event</span></span></span> button to create a new signal. In the input field that appears, type and select <code>demo.trans.count</code> <strong>(1)</strong> to add it as <strong>Signal D</strong>.</p><p>This adds a new signal, <strong>Signal D</strong>, to your chart. It represents the number of active requests being processed.</p><p>To focus on the <strong>Paris data center</strong>, add a filter for <strong>demo_datacenter: Paris (2)</strong>. Then, click the Configure Plot âš™ï¸ <strong>(3)</strong> button to adjust how the data is displayed. Change the <strong>rollup</strong> type from <strong>Auto (Delta)</strong> to <strong>Rate/sec (4)</strong> to show the rate of incoming requests per second.</p><p>Finally, rename the signal from <code>demo.trans.count</code> to <code>Latency vs Load</code> <strong>(5)</strong> to reflect its role in the chart more clearly.</p><p><a href=#R-image-cf7d5a2224b42351b4bdbbca0d45cbfc class=lightbox-link><img alt="rollup change" class="lazy lightbox figure-image" loading=lazy src=../../images/rollout-change.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf7d5a2224b42351b4bdbbca0d45cbfc><img alt="rollup change" class="lazy lightbox lightbox-image" loading=lazy src=../../images/rollout-change.png></a></p><p>Finally press the <span class="btn cstyle transparent"><span><span class=title>Save And Close</span></span></span> button. This returns you to your dashboard that now has three different charts!</p><p><a href=#R-image-1773582ab78696343eb17589cb0f775e class=lightbox-link><img alt="three charts" class="lazy lightbox figure-image" loading=lazy src=../../images/3-charts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1773582ab78696343eb17589cb0f775e><img alt="three charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/3-charts.png></a></p><p>Let&rsquo;s add an &ldquo;instruction&rdquo; note and arrange the charts!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jun 19, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=adding-notes-and-dashboard-layout>Adding Notes and Dashboard Layout</h1><h2 id=1-adding-notes>1. Adding Notes</h2><p>Often on dashboards it makes sense to place a short &ldquo;instruction&rdquo; pane that helps users of a dashboard. Lets add one now by clicking on the <span class="btn cstyle transparent"><span><span class=title><strong>New Text Note</strong></span></span></span>
Button.</p><p><a href=#R-image-61ea9f1a26484ba81b0f99e87a9fe951 class=lightbox-link><img alt="three charts" class="lazy lightbox figure-image" loading=lazy src=../../images/add-notes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-61ea9f1a26484ba81b0f99e87a9fe951><img alt="three charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/add-notes.png></a></p><p>This will open the notes editor.</p><p><a href=#R-image-0671e77adb5a3467cd125c1ebc662ffc class=lightbox-link><img alt="Notes 1" class="lazy lightbox figure-image" loading=lazy src=../../images/notes-editor.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0671e77adb5a3467cd125c1ebc662ffc><img alt="Notes 1" class="lazy lightbox lightbox-image" loading=lazy src=../../images/notes-editor.png></a></p><p>To allow you to add more then just text to you notes, Splunk is allowing you to use Markdown in these notes/panes.
Markdown is a lightweight markup language for creating formatted text using plain-text often used in Webpages.</p><p>This includes (but not limited to):</p><ul><li>Headers. (in various sizes)</li><li>Emphasis styles.</li><li>Lists and Tables.</li><li>Links. These can be external webpages (for documentation for example) or directly to other Splunk IM Dashboards</li></ul><p>Below is an example of above Markdown options you can use in your note.</p><div class=tab-panel data-tab-group=R-tabs-1bca6cfdc6b52d7d0ac440b1ac39784d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3da3e483cc4e8955537e7e275fc46f5b aria-expanded=true data-tab-item=R-tab-a704b0867831f74a891c7b2fbe8fa296 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-1bca6cfdc6b52d7d0ac440b1ac39784d","R-tab-a704b0867831f74a891c7b2fbe8fa296")'>
<span class=tab-nav-text>Sample Markdown text</span></button></div><div class=tab-content-container><div id=R-tab-id-3da3e483cc4e8955537e7e275fc46f5b data-tab-item=R-tab-a704b0867831f74a891c7b2fbe8fa296 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl><span class=gh># h1 Big headings
</span></span></span><span class=line><span class=cl><span class=gh></span>
</span></span><span class=line><span class=cl><span class=gu>###### h6 To small headings
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gu>##### Emphasis
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl><span class=gs>**This is bold text**</span>, <span class=ge>*This is italic text*</span> , <span class=gd>~~Strikethrough~~</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Lists
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>Unordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>+ Create a list by starting a line with <span class=sb>`+`</span>, <span class=sb>`-`</span>, or <span class=sb>`*`</span>
</span></span><span class=line><span class=cl><span class=k>-</span> Sub-lists are made by indenting 2 spaces:
</span></span><span class=line><span class=cl><span class=k>-</span> Marker character change forces new list start:
</span></span><span class=line><span class=cl>    <span class=k>*</span> Ac tristique libero volutpat at
</span></span><span class=line><span class=cl>    + Facilisis in pretium nisl aliquet
</span></span><span class=line><span class=cl><span class=k>*</span> Very easy!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ordered
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Lorem ipsum dolor sit amet
</span></span><span class=line><span class=cl><span class=k>2.</span> Consectetur adipiscing elit
</span></span><span class=line><span class=cl><span class=k>3.</span> Integer molestie lorem at massa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>##### Tables
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>| Option | Description |
</span></span><span class=line><span class=cl>| ------ | ----------- |
</span></span><span class=line><span class=cl>| chart  | path to data files to supply the data that will be passed into templates. |
</span></span><span class=line><span class=cl>| engine | engine to be used for processing templates. Handlebars is the default. |
</span></span><span class=line><span class=cl>| ext    | extension to be used for dest files. |
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>#### Links
</span></span></span><span class=line><span class=cl><span class=gu></span>
</span></span><span class=line><span class=cl>[<span class=nt>link to webpage</span>](<span class=na>https://www.splunk.com</span>)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[<span class=nt>link to dashboard with title</span>](<span class=na>https://app.eu0.signalfx.com/#/dashboard/EaJHrbPAEAA?groupId=EaJHgrsAIAA&amp;configId=EaJHsHzAEAA &#34;Link to the Sample chart Dashboard!&#34;</span>)</span></span></code></pre></div></div></div></div></div><p>Copy the above by using the copy button and paste it in the <em>Edit</em> box.
the preview will show you how it will look.</p><hr><h2 id=2-saving-our-chart>2. Saving our chart</h2><p>Give the Note chart a name, in our example we used <em>Example text chart</em>, then press the <span class="btn cstyle blue"><span><span class=title>Save And Close</span></span></span> Button.</p><p><a href=#R-image-3b9d65ba73703299368121b7b54a5919 class=lightbox-link><img alt="saving note" class="lazy lightbox figure-image" loading=lazy src=../../images/notes-with-example.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b9d65ba73703299368121b7b54a5919><img alt="saving note" class="lazy lightbox lightbox-image" loading=lazy src=../../images/notes-with-example.png></a></p><p>This will bring you back to you Dashboard, that now includes the note.</p><p><a href=#R-image-36735f9732ee479a28a68cc38d3c4562 class=lightbox-link><img alt="three charts and note" class="lazy lightbox figure-image" loading=lazy src=../../images/3-charts-and-note.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-36735f9732ee479a28a68cc38d3c4562><img alt="three charts and note" class="lazy lightbox lightbox-image" loading=lazy src=../../images/3-charts-and-note.png></a></p><hr><h2 id=3-ordering--sizing-of-charts>3. Ordering & sizing of charts</h2><p>If you do not like the default order and sizes of your charts you can simply use window dragging technique to move and size them to the desired location.</p><p>Grab the <strong>top</strong> border of a chart and you should see the mouse pointer change to a drag icon (see picture below).</p><p><a href=#R-image-7c21f2ec973f93c2453418cf48244b60 class=lightbox-link><img alt="dragging charts" class="lazy lightbox figure-image" loading=lazy src=../../images/M-Notes-4.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c21f2ec973f93c2453418cf48244b60><img alt="dragging charts" class="lazy lightbox lightbox-image" loading=lazy src=../../images/M-Notes-4.png></a></p><p>Now drag the <strong>Latency vs Load</strong> chart to sit between the <strong>Latency History</strong> Chart and the <strong>Example text chart</strong>.</p><p><a href=#R-image-e984aba02dbe5283634888244690d1b6 class=lightbox-link><img alt=sizing class="lazy lightbox figure-image" loading=lazy src=../../images/M-Notes-5.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e984aba02dbe5283634888244690d1b6><img alt=sizing class="lazy lightbox lightbox-image" loading=lazy src=../../images/M-Notes-5.png></a></p><p>You can also resize windows by dragging from the left, right and bottom edges.</p><p>As a last exercise reduce the width of the note chart to about a third of the other charts. The chart will automatically snap to one of the sizes it supports. Widen the 3 other charts to about a third of the Dashboard. Drag the notes to the right of the others and resize it to match it to the 3 others. Set the <strong>Time</strong> to <strong>-1h</strong> and you should have the following dashboard!</p><p><a href=#R-image-685b0f1f0d7f28347dab91366ba564c1 class=lightbox-link><img alt=TaDA! class="lazy lightbox figure-image" loading=lazy src=../../images/M-Notes-6.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-685b0f1f0d7f28347dab91366ba564c1><img alt=TaDA! class="lazy lightbox lightbox-image" loading=lazy src=../../images/M-Notes-6.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 1, 2025</span></span></footer></article></section></section><article class=default><header class=headline></header><h1 id=hands-on-opentelemetry-docker-and-k8s>Hands-On OpenTelemetry, Docker, and K8s</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Derek Mitchell</span></span><p>In this workshop, you&rsquo;ll get hands-on experience with the following:</p><ul><li>Practice deploying the collector and instrumenting a .NET application with the Splunk distribution of OpenTelemetry .NET in Linux and Kubernetes environments.</li><li>Practice â€œdockerizingâ€ a .NET application, running it in Docker, and then adding Splunk OpenTelemetry instrumentation.</li><li>Practice deploying the Splunk distro of the collector in a K8s environment using Helm. Then customize the collector config and troubleshoot an issue.</li></ul><p>The workshop uses a simple .NET application to illustrate these concepts. Let&rsquo;s get started!</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Hands-On OpenTelemetry, Docker, and K8s</h1><article class=default><header class=headline></header><h1 id=connect-to-ec2-instance>Connect to EC2 Instance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=connect-to-your-ec2-instance>Connect to your EC2 Instance</h2><p>Weâ€™ve prepared an Ubuntu Linux instance in AWS/EC2 for each attendee.</p><p>Using the IP address and password provided by your instructor, connect to your EC2 instance
using one of the methods below:</p><ul><li>Mac OS / Linux<ul><li>ssh splunk@IP address</li></ul></li><li>Windows 10+<ul><li>Use the OpenSSH client</li></ul></li><li>Earlier versions of Windows<ul><li>Use Putty</li></ul></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 19, 2024</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-opentelemetry-collector>Deploy the OpenTelemetry Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=uninstall-the-opentelemetry-collector>Uninstall the OpenTelemetry Collector</h2><p>Our EC2 instance may already have an older version the Splunk Distribution of the OpenTelemetry Collector
installed. Before proceeding further, let&rsquo;s uninstall it using the following command:</p><div class=tab-panel data-tab-group=R-tabs-7e72f51dd6d01fa3c1694ee39f87c39e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-724b1e31b17dac0d70a3e04264ef573a aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7e72f51dd6d01fa3c1694ee39f87c39e","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-f1b51d65bad81969b87d00b48c60479d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7e72f51dd6d01fa3c1694ee39f87c39e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-724b1e31b17dac0d70a3e04264ef573a data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh<span class=p>;</span>
</span></span><span class=line><span class=cl>sudo sh /tmp/splunk-otel-collector.sh --uninstall</span></span></code></pre></div></div></div><div id=R-tab-id-f1b51d65bad81969b87d00b48c60479d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Building dependency tree... Done
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>The following packages will be REMOVED:
</span></span><span class=line><span class=cl>  splunk-otel-collector*
</span></span><span class=line><span class=cl><span class=m>0</span> upgraded, <span class=m>0</span> newly installed, <span class=m>1</span> to remove and <span class=m>167</span> not upgraded.
</span></span><span class=line><span class=cl>After this operation, <span class=m>766</span> MB disk space will be freed.
</span></span><span class=line><span class=cl><span class=o>(</span>Reading database ... <span class=m>157441</span> files and directories currently installed.<span class=o>)</span>
</span></span><span class=line><span class=cl>Removing splunk-otel-collector <span class=o>(</span>0.92.0<span class=o>)</span> ...
</span></span><span class=line><span class=cl><span class=o>(</span>Reading database ... <span class=m>147373</span> files and directories currently installed.<span class=o>)</span>
</span></span><span class=line><span class=cl>Purging configuration files <span class=k>for</span> splunk-otel-collector <span class=o>(</span>0.92.0<span class=o>)</span> ...
</span></span><span class=line><span class=cl>Scanning processes...                                                                                                                                                                                              
</span></span><span class=line><span class=cl>Scanning candidates...                                                                                                                                                                                             
</span></span><span class=line><span class=cl>Scanning linux images...                                                                                                                                                                                           
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Running kernel seems to be up-to-date.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Restarting services...
</span></span><span class=line><span class=cl> systemctl restart fail2ban.service falcon-sensor.service
</span></span><span class=line><span class=cl>Service restarts being deferred:
</span></span><span class=line><span class=cl> systemctl restart networkd-dispatcher.service
</span></span><span class=line><span class=cl> systemctl restart unattended-upgrades.service
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>No containers need to be restarted.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>No user sessions are running outdated binaries.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>No VM guests are running outdated hypervisor <span class=o>(</span>qemu<span class=o>)</span> binaries on this host.
</span></span><span class=line><span class=cl>Successfully removed the splunk-otel-collector package</span></span></code></pre></div></div></div></div></div><h2 id=deploy-the-opentelemetry-collector>Deploy the OpenTelemetry Collector</h2><p>Letâ€™s deploy the latest version of the Splunk Distribution of the OpenTelemetry Collector on our Linux EC2 instance.</p><p>We can do this by downloading the collector binary using <code>curl</code>, and then running it<br>with specific arguments that tell the collector which realm to report data into, which access
token to use, and which deployment environment to report into.</p><blockquote><p>A deployment environment in Splunk Observability Cloud is a distinct deployment of your system
or application that allows you to set up configurations that donâ€™t overlap with configurations
in other deployments of the same application.</p></blockquote><div class=tab-panel data-tab-group=R-tabs-f18bdd53b32f93dd5cf54dc6f3d795eb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2534d75f8dffb52a26742427c66c7c72 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f18bdd53b32f93dd5cf54dc6f3d795eb","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-5169c062e381142e39c70850eee05012 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-f18bdd53b32f93dd5cf54dc6f3d795eb","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-2534d75f8dffb52a26742427c66c7c72 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh<span class=p>;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>sudo sh /tmp/splunk-otel-collector.sh <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--realm <span class=nv>$REALM</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--mode agent <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--without-instrumentation <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--deployment-environment otel-<span class=nv>$INSTANCE</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-- <span class=nv>$ACCESS_TOKEN</span></span></span></code></pre></div></div></div><div id=R-tab-id-5169c062e381142e39c70850eee05012 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Splunk OpenTelemetry Collector Version: latest
</span></span><span class=line><span class=cl>Memory Size in MIB: <span class=m>512</span>
</span></span><span class=line><span class=cl>Realm: us1
</span></span><span class=line><span class=cl>Ingest Endpoint: https://ingest.us1.signalfx.com
</span></span><span class=line><span class=cl>API Endpoint: https://api.us1.signalfx.com
</span></span><span class=line><span class=cl>HEC Endpoint: https://ingest.us1.signalfx.com/v1/log
</span></span><span class=line><span class=cl>etc. </span></span></code></pre></div></div></div></div></div><p>Refer to <a href=https://docs.splunk.com/observability/en/gdi/opentelemetry/collector-linux/install-linux.html#otel-install-linux rel=external>Install the Collector for Linux with the installer script</a>
for further details on how to install the collector.</p><h2 id=confirm-the-collector-is-running>Confirm the Collector is Running</h2><p>Let&rsquo;s confirm that the collector is running successfully on our instance.</p><blockquote><p>Press Ctrl + C to exit out of the status command.</p></blockquote><div class=tab-panel data-tab-group=R-tabs-863589d8f70db4ed0309efded53c677a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-25038b61882b2d8a19af7d293c0b3685 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-863589d8f70db4ed0309efded53c677a","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-a232bfbce0886b3356180522ad4d7502 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-863589d8f70db4ed0309efded53c677a","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-25038b61882b2d8a19af7d293c0b3685 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl status splunk-otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-a232bfbce0886b3356180522ad4d7502 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>â— splunk-otel-collector.service - Splunk OpenTelemetry Collector
</span></span><span class=line><span class=cl>     Loaded: loaded <span class=o>(</span>/lib/systemd/system/splunk-otel-collector.service<span class=p>;</span> enabled<span class=p>;</span> vendor preset: enabled<span class=o>)</span>
</span></span><span class=line><span class=cl>    Drop-In: /etc/systemd/system/splunk-otel-collector.service.d
</span></span><span class=line><span class=cl>             â””â”€service-owner.conf
</span></span><span class=line><span class=cl>     Active: active <span class=o>(</span>running<span class=o>)</span> since Fri 2024-12-20 00:13:14 UTC<span class=p>;</span> 45s ago
</span></span><span class=line><span class=cl>   Main PID: <span class=m>14465</span> <span class=o>(</span>otelcol<span class=o>)</span>
</span></span><span class=line><span class=cl>      Tasks: <span class=m>9</span> <span class=o>(</span>limit: 19170<span class=o>)</span>
</span></span><span class=line><span class=cl>     Memory: 117.4M
</span></span><span class=line><span class=cl>        CPU: 681ms
</span></span><span class=line><span class=cl>     CGroup: /system.slice/splunk-otel-collector.service
</span></span><span class=line><span class=cl>             â””â”€14465 /usr/bin/otelcol</span></span></code></pre></div></div></div></div></div><h2 id=how-do-we-view-the-collector-logs>How do we view the collector logs?</h2><p>We can view the collector logs using <code>journalctl</code>:</p><blockquote><p>Press Ctrl + C to exit out of tailing the log.</p></blockquote><div class=tab-panel data-tab-group=R-tabs-4973ecbbfa9d8886a1bfa83eec266ba8><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d59c160447a246286754c7bb21eb9493 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4973ecbbfa9d8886a1bfa83eec266ba8","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-5e6e4eb2171eb20cbdb2dc451a23705d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4973ecbbfa9d8886a1bfa83eec266ba8","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d59c160447a246286754c7bb21eb9493 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo journalctl -u splunk-otel-collector -f -n <span class=m>100</span></span></span></code></pre></div></div></div><div id=R-tab-id-5e6e4eb2171eb20cbdb2dc451a23705d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 systemd<span class=o>[</span>1<span class=o>]</span>: Started Splunk OpenTelemetry Collector.
</span></span><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 otelcol<span class=o>[</span>14465<span class=o>]</span>: 2024/12/20 00:13:14 settings.go:483: Set config to /etc/otel/collector/agent_config.yaml
</span></span><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 otelcol<span class=o>[</span>14465<span class=o>]</span>: 2024/12/20 00:13:14 settings.go:539: Set memory limit to <span class=m>460</span> MiB
</span></span><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 otelcol<span class=o>[</span>14465<span class=o>]</span>: 2024/12/20 00:13:14 settings.go:524: Set soft memory limit <span class=nb>set</span> to <span class=m>460</span> MiB
</span></span><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 otelcol<span class=o>[</span>14465<span class=o>]</span>: 2024/12/20 00:13:14 settings.go:373: Set garbage collection target percentage <span class=o>(</span>GOGC<span class=o>)</span> to <span class=m>400</span>
</span></span><span class=line><span class=cl>Dec <span class=m>20</span> 00:13:14 derek-1 otelcol<span class=o>[</span>14465<span class=o>]</span>: 2024/12/20 00:13:14 settings.go:414: <span class=nb>set</span> <span class=s2>&#34;SPLUNK_LISTEN_INTERFACE&#34;</span> to <span class=s2>&#34;127.0.0.1&#34;</span>
</span></span><span class=line><span class=cl>etc. </span></span></code></pre></div></div></div></div></div><h2 id=collector-configuration>Collector Configuration</h2><p>Where do we find the configuration that is used by this collector?</p><p>It&rsquo;s available in the <code>/etc/otel/collector</code> directory. Since we installed the
collector in <code>agent</code> mode, the collector configuration can be found in the
<code>agent_config.yaml</code> file.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-a-net-application>Deploy a .NET Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=prerequisites>Prerequisites</h2><p>Before deploying the application, we&rsquo;ll need to install the .NET 8 SDK on our instance.</p><div class=tab-panel data-tab-group=R-tabs-dd0acb81b77977e6c9a169eb51fe1a55><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ac3c620b904fc619b27b87db82806a2a aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-dd0acb81b77977e6c9a169eb51fe1a55","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-13b1f1be7f812e9db6b66fc585952409 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-dd0acb81b77977e6c9a169eb51fe1a55","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-ac3c620b904fc619b27b87db82806a2a data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  sudo apt-get install -y dotnet-sdk-8.0</span></span></code></pre></div></div></div><div id=R-tab-id-13b1f1be7f812e9db6b66fc585952409 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hit:1 http://us-west-1.ec2.archive.ubuntu.com/ubuntu jammy InRelease
</span></span><span class=line><span class=cl>Hit:2 http://us-west-1.ec2.archive.ubuntu.com/ubuntu jammy-updates InRelease                                               
</span></span><span class=line><span class=cl>Hit:3 http://us-west-1.ec2.archive.ubuntu.com/ubuntu jammy-backports InRelease                                             
</span></span><span class=line><span class=cl>Hit:4 http://security.ubuntu.com/ubuntu jammy-security InRelease                                                           
</span></span><span class=line><span class=cl>Ign:5 https://splunk.jfrog.io/splunk/otel-collector-deb release InRelease
</span></span><span class=line><span class=cl>Hit:6 https://splunk.jfrog.io/splunk/otel-collector-deb release Release
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Reading package lists... Done
</span></span><span class=line><span class=cl>Building dependency tree... Done
</span></span><span class=line><span class=cl>Reading state information... Done
</span></span><span class=line><span class=cl>The following additional packages will be installed:
</span></span><span class=line><span class=cl>  aspnetcore-runtime-8.0 aspnetcore-targeting-pack-8.0 dotnet-apphost-pack-8.0 dotnet-host-8.0 dotnet-hostfxr-8.0 dotnet-runtime-8.0 dotnet-targeting-pack-8.0 dotnet-templates-8.0 liblttng-ust-common1
</span></span><span class=line><span class=cl>  liblttng-ust-ctl5 liblttng-ust1 netstandard-targeting-pack-2.1-8.0
</span></span><span class=line><span class=cl>The following NEW packages will be installed:
</span></span><span class=line><span class=cl>  aspnetcore-runtime-8.0 aspnetcore-targeting-pack-8.0 dotnet-apphost-pack-8.0 dotnet-host-8.0 dotnet-hostfxr-8.0 dotnet-runtime-8.0 dotnet-sdk-8.0 dotnet-targeting-pack-8.0 dotnet-templates-8.0
</span></span><span class=line><span class=cl>  liblttng-ust-common1 liblttng-ust-ctl5 liblttng-ust1 netstandard-targeting-pack-2.1-8.0
</span></span><span class=line><span class=cl><span class=m>0</span> upgraded, <span class=m>13</span> newly installed, <span class=m>0</span> to remove and <span class=m>0</span> not upgraded.
</span></span><span class=line><span class=cl>Need to get <span class=m>138</span> MB of archives.
</span></span><span class=line><span class=cl>After this operation, <span class=m>495</span> MB of additional disk space will be used.
</span></span><span class=line><span class=cl>etc. </span></span></code></pre></div></div></div></div></div><p>Refer to <a href="https://learn.microsoft.com/en-us/dotnet/core/install/linux-ubuntu-install?tabs=dotnet8&pivots=os-linux-ubuntu-2404" rel=external>Install .NET SDK or .NET Runtime on Ubuntu</a>
for further details.</p><h2 id=review-the-net-application>Review the .NET Application</h2><p>In the terminal, navigate to the application directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/docker-k8s-otel/helloworld</span></span></code></pre></div><p>We&rsquo;ll use a simple &ldquo;Hello World&rdquo; .NET application for this workshop. The main logic is found
in the HelloWorldController.cs file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=kd>public</span> <span class=k>class</span> <span class=nc>HelloWorldController</span> <span class=p>:</span> <span class=n>ControllerBase</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>private</span> <span class=n>ILogger</span><span class=p>&lt;</span><span class=n>HelloWorldController</span><span class=p>&gt;</span> <span class=n>logger</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=n>HelloWorldController</span><span class=p>(</span><span class=n>ILogger</span><span class=p>&lt;</span><span class=n>HelloWorldController</span><span class=p>&gt;</span> <span class=n>logger</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>this</span><span class=p>.</span><span class=n>logger</span> <span class=p>=</span> <span class=n>logger</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=na>
</span></span></span><span class=line><span class=cl><span class=na>    [HttpGet(&#34;/hello/{name?}&#34;)]</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>string</span> <span class=n>Hello</span><span class=p>(</span><span class=kt>string</span> <span class=n>name</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=kt>string</span><span class=p>.</span><span class=n>IsNullOrEmpty</span><span class=p>(</span><span class=n>name</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>           <span class=n>logger</span><span class=p>.</span><span class=n>LogInformation</span><span class=p>(</span><span class=s>&#34;/hello endpoint invoked anonymously&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>           <span class=k>return</span> <span class=s>&#34;Hello, World!&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>logger</span><span class=p>.</span><span class=n>LogInformation</span><span class=p>(</span><span class=s>&#34;/hello endpoint invoked by {name}&#34;</span><span class=p>,</span> <span class=n>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>String</span><span class=p>.</span><span class=n>Format</span><span class=p>(</span><span class=s>&#34;Hello, {0}!&#34;</span><span class=p>,</span> <span class=n>name</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div><h2 id=build-and-run-the-net-application>Build and Run the .NET Application</h2><p>We can build the application using the following command:</p><div class=tab-panel data-tab-group=R-tabs-3e966a06c9e3942961208341c74b0b24><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-abfaf57d3b0ad7769898324cbcc545ec aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-3e966a06c9e3942961208341c74b0b24","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-e4e651e040fe04514e89c8c22e29e9fc aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-3e966a06c9e3942961208341c74b0b24","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-abfaf57d3b0ad7769898324cbcc545ec data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotnet build</span></span></code></pre></div></div></div><div id=R-tab-id-e4e651e040fe04514e89c8c22e29e9fc data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>MSBuild version 17.8.5+b5265ef37 <span class=k>for</span> .NET
</span></span><span class=line><span class=cl>  Determining projects to restore...
</span></span><span class=line><span class=cl>  All projects are up-to-date <span class=k>for</span> restore.
</span></span><span class=line><span class=cl>  helloworld -&gt; /home/splunk/workshop/docker-k8s-otel/helloworld/bin/Debug/net8.0/helloworld.dll
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Build succeeded.
</span></span><span class=line><span class=cl>    <span class=m>0</span> Warning<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=m>0</span> Error<span class=o>(</span>s<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Time Elapsed 00:00:02.04</span></span></code></pre></div></div></div></div></div><p>If that&rsquo;s successful, we can run it as follows:</p><div class=tab-panel data-tab-group=R-tabs-fe2339fdbeeb6eccddee5661a7fc5e36><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3ad26c485a9f7e6cfefb48d99a424d88 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fe2339fdbeeb6eccddee5661a7fc5e36","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-c28b4e79d24e7fe64ed0015671f616c5 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-fe2339fdbeeb6eccddee5661a7fc5e36","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-3ad26c485a9f7e6cfefb48d99a424d88 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dotnet run</span></span></code></pre></div></div></div><div id=R-tab-id-c28b4e79d24e7fe64ed0015671f616c5 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Building...
</span></span><span class=line><span class=cl>info: Microsoft.Hosting.Lifetime<span class=o>[</span>14<span class=o>]</span>
</span></span><span class=line><span class=cl>      Now listening on: http://localhost:8080
</span></span><span class=line><span class=cl>info: Microsoft.Hosting.Lifetime<span class=o>[</span>0<span class=o>]</span>
</span></span><span class=line><span class=cl>      Application started. Press Ctrl+C to shut down.
</span></span><span class=line><span class=cl>info: Microsoft.Hosting.Lifetime<span class=o>[</span>0<span class=o>]</span>
</span></span><span class=line><span class=cl>      Hosting environment: Development
</span></span><span class=line><span class=cl>info: Microsoft.Hosting.Lifetime<span class=o>[</span>0<span class=o>]</span>
</span></span><span class=line><span class=cl>      Content root path: /home/splunk/workshop/docker-k8s-otel/helloworld</span></span></code></pre></div></div></div></div></div><p>Once it&rsquo;s running, open a second SSH terminal to your Ubuntu instance and access the application using curl:</p><div class=tab-panel data-tab-group=R-tabs-45eb1265d6485d7a88ab9f60585f359f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6ce71f2073617ffdeff9d5819232fddf aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-45eb1265d6485d7a88ab9f60585f359f","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-1a11f8595bccb449ec944d1b160e68f3 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-45eb1265d6485d7a88ab9f60585f359f","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-6ce71f2073617ffdeff9d5819232fddf data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8080/hello</span></span></code></pre></div></div></div><div id=R-tab-id-1a11f8595bccb449ec944d1b160e68f3 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hello, World! </span></span></code></pre></div></div></div></div></div><p>You can also pass in your name:</p><div class=tab-panel data-tab-group=R-tabs-4c7d29da1793248f4549beb9c709198e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-384ada0ff8d632a8dec1b3c421e891ff aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4c7d29da1793248f4549beb9c709198e","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-ffbd774f03bb33143330431bc0bae633 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4c7d29da1793248f4549beb9c709198e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-384ada0ff8d632a8dec1b3c421e891ff data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8080/hello/Tom</span></span></code></pre></div></div></div><div id=R-tab-id-ffbd774f03bb33143330431bc0bae633 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hello, Tom! </span></span></code></pre></div></div></div></div></div><blockquote><p>Press Ctrl + C to quit your Helloworld app before moving to the next step.</p></blockquote><h2 id=next-steps>Next Steps</h2><p>What are the three methods that we can use to instrument our application with OpenTelemetry?</p><p><a href=#R-image-405b5de8303fa35da10f63e66c5707ca class=lightbox-link><img alt=Traces class="lazy lightbox figure-image" loading=lazy src=../images/NetInstrumentation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-405b5de8303fa35da10f63e66c5707ca><img alt=Traces class="lazy lightbox lightbox-image" loading=lazy src=../images/NetInstrumentation.png></a></p><p>See: <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/otel-dotnet/instrumentation/instrument-dotnet-application.html rel=external>Instrument your .NET application for Splunk Observability Cloud</a>
for a discussion of the options.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Feb 4, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=instrument-a-net-application-with-opentelemetry>Instrument a .NET Application with OpenTelemetry</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<h2 id=download-the-splunk-distribution-of-opentelemetry>Download the Splunk Distribution of OpenTelemetry</h2><p>For this workshop, we&rsquo;ll install the Splunk Distribution of OpenTelemetry manually rather than
using the NuGet packages.</p><p>We&rsquo;ll start by downloading the latest <code>splunk-otel-dotnet-install.sh</code> file,
which we&rsquo;ll use to instrument our .NET application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/workshop/docker-k8s-otel/helloworld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>curl -sSfL https://github.com/signalfx/splunk-otel-dotnet/releases/latest/download/splunk-otel-dotnet-install.sh -O</span></span></code></pre></div><p>Refer to <a href=https://docs.splunk.com/observability/en/gdi/get-data-in/application/otel-dotnet/instrumentation/instrument-dotnet-application.html#install-the-splunk-distribution-of-opentelemetry-net-manually rel=external>Install the Splunk Distribution of OpenTelemetry .NET manually</a>
for further details on the installation process.</p><h2 id=install-the-distribution>Install the Distribution</h2><p>In the terminal, install the distribution as follows</p><div class=tab-panel data-tab-group=R-tabs-732732a9417c175ac360f8f51a1f6115><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a42a056e6852045367304feb99b96dea aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-732732a9417c175ac360f8f51a1f6115","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-2e74db8f754663fc5b75f995993bb1eb aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-732732a9417c175ac360f8f51a1f6115","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-a42a056e6852045367304feb99b96dea data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sh ./splunk-otel-dotnet-install.sh</span></span></code></pre></div></div></div><div id=R-tab-id-2e74db8f754663fc5b75f995993bb1eb data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Downloading v1.8.0 <span class=k>for</span> linux-glibc <span class=o>(</span>/tmp/tmp.m3tSdtbmge/splunk-opentelemetry-dotnet-linux-glibc-x64.zip<span class=o>)</span>...</span></span></code></pre></div></div></div></div></div><blockquote><p>Note: we may need to include the ARCHITECTURE environment when running the command above:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>ARCHITECTURE</span><span class=o>=</span>x64 sh ./splunk-otel-dotnet-install.sh</span></span></code></pre></div></blockquote><h2 id=activate-the-instrumentation>Activate the Instrumentation</h2><p>Next, we can activate the OpenTelemetry instrumentation:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. <span class=nv>$HOME</span>/.splunk-otel-dotnet/instrument.sh</span></span></code></pre></div><h2 id=set-the-deployment-environment>Set the Deployment Environment</h2><p>Let&rsquo;s set the deployment environment, to ensure our data flows into its own
environment within Splunk Observability Cloud:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span><span class=o>=</span>deployment.environment<span class=o>=</span>otel-<span class=nv>$INSTANCE</span></span></span></code></pre></div><h2 id=run-the-application-with-instrumentation>Run the Application with Instrumentation</h2><p>We can run the application as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>dotnet run</code></pre></div><h2 id=a-challenge-for-you>A Challenge For You</h2><p>How can we see what traces are being exported by the .NET application from our Linux instance?</p><details><summary><b>Click here to see the answer</b></summary><p>There are two ways we can do this:</p><ol><li>We could add <code>OTEL_TRACES_EXPORTER=otlp,console</code> at the start of the <code>dotnet run</code> command, which ensures that traces are both written to collector via OTLP as well as the console.</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>OTEL_TRACES_EXPORTER</span><span class=o>=</span>otlp,console dotnet run </span></span></code></pre></div><ol start=2><li>Alternatively, we could add the debug exporter to the collector configuration, and add it to the traces pipeline, which ensures the traces are written to the collector logs.</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>jaeger, otlp, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlphttp, signalfx, debug]</span></span></span></code></pre></div></details><h2 id=access-the-application>Access the Application</h2><p>Once the application is running, use a second SSH terminal and access it using curl:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8080/hello</span></span></code></pre></div><p>As before, it should return <code>Hello, World!</code>.</p><p>If you enabled trace logging, you should see a trace written the console or collector logs such as the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>info: Program[0]
      /hello endpoint invoked anonymously
Activity.TraceId:            c7bbf57314e4856447508cd8addd49b0
Activity.SpanId:             1c92ac653c3ece27
Activity.TraceFlags:         Recorded
Activity.ActivitySourceName: Microsoft.AspNetCore
Activity.DisplayName:        GET /hello/{name?}
Activity.Kind:               Server
Activity.StartTime:          2024-12-20T00:45:25.6551267Z
Activity.Duration:           00:00:00.0006464
Activity.Tags:
    server.address: localhost
    server.port: 8080
    http.request.method: GET
    url.scheme: http
    url.path: /hello
    network.protocol.version: 1.1
    user_agent.original: curl/7.81.0
    http.route: /hello/{name?}
    http.response.status_code: 200
Resource associated with Activity:
    splunk.distro.version: 1.8.0
    telemetry.distro.name: splunk-otel-dotnet
    telemetry.distro.version: 1.8.0
    service.name: helloworld
    os.type: linux
    os.description: Ubuntu 22.04.5 LTS
    os.build_id: 6.8.0-1021-aws
    os.name: Ubuntu
    os.version: 22.04
    host.name: derek-1
    host.id: 20cf15fcc7054b468647b73b8f87c556
    process.owner: splunk
    process.pid: 16997
    process.runtime.description: .NET 8.0.11
    process.runtime.name: .NET
    process.runtime.version: 8.0.11
    container.id: 2
    telemetry.sdk.name: opentelemetry
    telemetry.sdk.language: dotnet
    telemetry.sdk.version: 1.9.0
    deployment.environment: otel-derek-1</code></pre></div><h2 id=view-your-application-in-splunk-observability-cloud>View your application in Splunk Observability Cloud</h2><p>Now that the setup is complete, let&rsquo;s confirm that traces are sent to <strong>Splunk Observability Cloud</strong>. Note that when the application is deployed for the first time, it may take a few minutes for the data to appear.</p><p>Navigate to APM, then use the Environment dropdown to select your environment (i.e. <code>otel-instancename</code>).</p><p>If everything was deployed correctly, you should see <code>helloworld</code> displayed in the list of services:</p><p><a href=#R-image-d15214b00cfe55d0df09f60d1b67739a class=lightbox-link><img alt="APM Overview" class="lazy lightbox figure-image" loading=lazy src=../images/apm_overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d15214b00cfe55d0df09f60d1b67739a><img alt="APM Overview" class="lazy lightbox lightbox-image" loading=lazy src=../images/apm_overview.png></a></p><p>Click on <strong>Service Map</strong> on the right-hand side to view the service map.</p><p><a href=#R-image-42b854c5c3d5d13029a215eeefc88753 class=lightbox-link><img alt="Service Map" class="lazy lightbox figure-image" loading=lazy src=../images/service_map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-42b854c5c3d5d13029a215eeefc88753><img alt="Service Map" class="lazy lightbox lightbox-image" loading=lazy src=../images/service_map.png></a></p><p>Next, click on <strong>Traces</strong> on the right-hand side to see the traces captured for this application.</p><p><a href=#R-image-21d6c6c671c4f66a7c1bb90aaee98004 class=lightbox-link><img alt=Traces class="lazy lightbox figure-image" loading=lazy src=../images/traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-21d6c6c671c4f66a7c1bb90aaee98004><img alt=Traces class="lazy lightbox lightbox-image" loading=lazy src=../images/traces.png></a></p><p>An individual trace should look like the following:</p><p><a href=#R-image-7a5c21a7f0849686dffb0ebec9d14965 class=lightbox-link><img alt=Traces class="lazy lightbox figure-image" loading=lazy src=../images/trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a5c21a7f0849686dffb0ebec9d14965><img alt=Traces class="lazy lightbox lightbox-image" loading=lazy src=../images/trace.png></a></p><blockquote><p>Press Ctrl + C to quit your Helloworld app before moving to the next step.</p></blockquote><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=dockerize-the-application>Dockerize the Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>Later on in this workshop, we&rsquo;re going to deploy our .NET application into a Kubernetes cluster.</p><p>But how do we do that?</p><p>The first step is to create a Docker image for our application. This is known as
&ldquo;dockerizing&rdquo; and application, and the process begins with the creation of a <code>Dockerfile</code>.</p><p>But first, let&rsquo;s define some key terms.</p><h2 id=key-terms>Key Terms</h2><h3 id=what-is-docker>What is Docker?</h3><p><em>&ldquo;Docker provides the ability to package and run an application in a loosely isolated environment
called a container. The isolation and security lets you run many containers simultaneously on
a given host. Containers are lightweight and contain everything needed to run the application,
so you don&rsquo;t need to rely on what&rsquo;s installed on the host.&rdquo;</em></p><p>Source: <a href=https://docs.docker.com/get-started/docker-overview/ rel=external>https://docs.docker.com/get-started/docker-overview/</a></p><h3 id=what-is-a-container>What is a container?</h3><p><em>&ldquo;Containers are isolated processes for each of your app&rsquo;s components. Each component
&mldr;runs in its own isolated environment,
completely isolated from everything else on your machine.&rdquo;</em></p><p>Source: <a href=https://docs.docker.com/get-started/docker-concepts/the-basics/what-is-a-container/ rel=external>https://docs.docker.com/get-started/docker-concepts/the-basics/what-is-a-container/</a></p><h3 id=what-is-a-container-image>What is a container image?</h3><p><em>&ldquo;A container image is a standardized package that includes all of the files, binaries,
libraries, and configurations to run a container.&rdquo;</em></p><h3 id=dockerfile>Dockerfile</h3><p><em>&ldquo;A Dockerfile is a text-based document that&rsquo;s used to create a container image. It provides
instructions to the image builder on the commands to run, files to copy, startup command, and more.&rdquo;</em></p><h2 id=create-a-dockerfile>Create a Dockerfile</h2><p>Let&rsquo;s create a file named <code>Dockerfile</code> in the <code>/home/splunk/workshop/docker-k8s-otel/helloworld</code> directory.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/workshop/docker-k8s-otel/helloworld</span></span></code></pre></div><p>You can use vi or nano to create the file. We will show an example using vi:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi Dockerfile</span></span></code></pre></div><p>Copy and paste the following content into the newly opened file:</p><blockquote><p>Press &lsquo;i&rsquo; to enter into insert mode in vi before pasting the text below.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/aspnet:8.0 AS base</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/sdk:8.0 AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>WORKDIR</span><span class=s> /src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> <span class=o>[</span><span class=s2>&#34;helloworld.csproj&#34;</span>, <span class=s2>&#34;helloworld/&#34;</span><span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet restore <span class=s2>&#34;./helloworld/./helloworld.csproj&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;/src/helloworld&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet build <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> build AS publish</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>RUN</span> dotnet publish <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/publish /p:UseAppHost<span class=o>=</span>false<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> base AS final</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>publish /app/publish .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;dotnet&#34;</span><span class=p>,</span> <span class=s2>&#34;helloworld.dll&#34;</span><span class=p>]</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><p>What does all this mean? Let&rsquo;s break it down.</p><h2 id=walking-through-the-dockerfile>Walking through the Dockerfile</h2><p>We&rsquo;ve used a multi-stage Dockerfile for this example, which separates the Docker image creation process into the following stages:</p><ul><li>Base</li><li>Build</li><li>Publish</li><li>Final</li></ul><p>While a multi-stage approach is more complex, it allows us to create a
lighter-weight runtime image for deployment. We&rsquo;ll explain the purpose of
each of these stages below.</p><h3 id=the-base-stage>The Base Stage</h3><p>The base stage defines the user that will
be running the app, the working directory, and exposes
the port that will be used to access the app.
It&rsquo;s based off of Microsoft&rsquo;s <code>mcr.microsoft.com/dotnet/aspnet:8.0</code> image:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/aspnet:8.0 AS base</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span></span></span></code></pre></div><p>Note that the <code>mcr.microsoft.com/dotnet/aspnet:8.0</code> image includes the .NET runtime only,
rather than the SDK, so is relatively lightweight. It&rsquo;s based off of the Debian 12 Linux
distribution. You can find more information about the ASP.NET Core Runtime Docker images
in <a href=https://github.com/dotnet/dotnet-docker/blob/main/README.aspnet.md rel=external>GitHub</a>.</p><h3 id=the-build-stage>The Build Stage</h3><p>The next stage of the Dockerfile is the build stage. For this stage, the
<code>mcr.microsoft.com/dotnet/sdk:8.0</code> image is used, which is also based off of
Debian 12 but includes the full <a href=https://github.com/dotnet/dotnet-docker/blob/main/README.sdk.md rel=external>.NET SDK</a> rather than just the runtime.</p><p>This stage copies the <code>.csproj</code> file to the build image, and then uses <code>dotnet restore</code> to
download any dependencies used by the application.</p><p>It then copies the application code to the build image and
uses <code>dotnet build</code> to build the project and its dependencies into a
set of <code>.dll</code> binaries:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/sdk:8.0 AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>WORKDIR</span><span class=s> /src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> <span class=o>[</span><span class=s2>&#34;helloworld.csproj&#34;</span>, <span class=s2>&#34;helloworld/&#34;</span><span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet restore <span class=s2>&#34;./helloworld/./helloworld.csproj&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;/src/helloworld&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet build <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/build</span></span></code></pre></div><h3 id=the-publish-stage>The Publish Stage</h3><p>The third stage is publish, which is based on build stage image rather than a Microsoft image. In this stage, <code>dotnet publish</code> is used to
package the application and its dependencies for deployment:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> build AS publish</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>RUN</span> dotnet publish <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/publish /p:UseAppHost<span class=o>=</span>false</span></span></code></pre></div><h3 id=the-final-stage>The Final Stage</h3><p>The fourth stage is our final stage, which is based on the base
stage image (which is lighter-weight than the build and publish stages). It copies the output from the publish stage image and
defines the entry point for our application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> base AS final</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>publish /app/publish .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;dotnet&#34;</span><span class=p>,</span> <span class=s2>&#34;helloworld.dll&#34;</span><span class=p>]</span></span></span></code></pre></div><h2 id=build-a-docker-image>Build a Docker Image</h2><p>Now that we have the <code>Dockerfile</code>, we can use it to build a Docker image containing
our application:</p><div class=tab-panel data-tab-group=R-tabs-06849956fba012fa390d6354aef0aa14><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8763fe7cd623c57da35ca9ff6ac97212 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-06849956fba012fa390d6354aef0aa14","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-b26b11a375557b1c8cb1148d42beb200 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-06849956fba012fa390d6354aef0aa14","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-8763fe7cd623c57da35ca9ff6ac97212 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -t helloworld:1.0 .</span></span></code></pre></div></div></div><div id=R-tab-id-b26b11a375557b1c8cb1148d42beb200 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>DEPRECATED: The legacy builder is deprecated and will be removed in a future release.
</span></span><span class=line><span class=cl>            Install the buildx component to build images with BuildKit:
</span></span><span class=line><span class=cl>            https://docs.docker.com/go/buildx/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Sending build context to Docker daemon  281.1kB
</span></span><span class=line><span class=cl>Step 1/19 : FROM mcr.microsoft.com/dotnet/aspnet:8.0 AS base
</span></span><span class=line><span class=cl>8.0: Pulling from dotnet/aspnet
</span></span><span class=line><span class=cl>af302e5c37e9: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>91ab5e0aabf0: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>1c1e4530721e: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>1f39ca6dcc3a: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>ea20083aa801: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>64c242a4f561: Pull <span class=nb>complete</span> 
</span></span><span class=line><span class=cl>Digest: sha256:587c1dd115e4d6707ff656d30ace5da9f49cec48e627a40bbe5d5b249adc3549
</span></span><span class=line><span class=cl>Status: Downloaded newer image <span class=k>for</span> mcr.microsoft.com/dotnet/aspnet:8.0
</span></span><span class=line><span class=cl> ---&gt; 0ee5d7ddbc3b
</span></span><span class=line><span class=cl>Step 2/19 : USER app
</span></span><span class=line><span class=cl>etc,</span></span></code></pre></div></div></div></div></div><p>This tells Docker to build an image using a tag of <code>helloworld:1.0</code> using the <code>Dockerfile</code> in the current directory.</p><p>We can confirm it was created successfully with the following command:</p><div class=tab-panel data-tab-group=R-tabs-b5932190d708aa44a31a107078ea094e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6f416f98552433db1d007bae1427633d aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b5932190d708aa44a31a107078ea094e","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-540d05aea52e3ca07accdfbdf42ecd06 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b5932190d708aa44a31a107078ea094e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-6f416f98552433db1d007bae1427633d data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker images</span></span></code></pre></div></div></div><div id=R-tab-id-540d05aea52e3ca07accdfbdf42ecd06 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>REPOSITORY   TAG       IMAGE ID       CREATED          SIZE
</span></span><span class=line><span class=cl>helloworld   1.0       db19077b9445   <span class=m>20</span> seconds ago   217MB</span></span></code></pre></div></div></div></div></div><h2 id=test-the-docker-image>Test the Docker Image</h2><blockquote><p>Before proceeding, ensure the application we started before is no longer running on your instance.</p></blockquote><p>We can run our application using the Docker image as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --name helloworld <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--detach <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--expose <span class=m>8080</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--network<span class=o>=</span>host <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>helloworld:1.0</span></span></code></pre></div><blockquote><p>Note: we&rsquo;ve included the <code>--network=host</code> parameter to ensure our Docker container
is able to access resources on our instance, which is important later on when we need
our application to send data to the collector running on localhost.</p></blockquote><p>Let&rsquo;s ensure that our Docker container is running:</p><div class=tab-panel data-tab-group=R-tabs-531e23a175f9cfe425e3d117ed283d28><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-4adebca6d511d158856b118456a9c0d0 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-531e23a175f9cfe425e3d117ed283d28","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-2aa69081b64f987d1e3ed7f51538ef96 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-531e23a175f9cfe425e3d117ed283d28","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-4adebca6d511d158856b118456a9c0d0 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker ps</span></span></code></pre></div></div></div><div id=R-tab-id-2aa69081b64f987d1e3ed7f51538ef96 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ docker ps
</span></span><span class=line><span class=cl>CONTAINER ID   IMAGE            COMMAND                  CREATED       STATUS       PORTS     NAMES
</span></span><span class=line><span class=cl>5f5b9cd56ac5   helloworld:1.0   <span class=s2>&#34;dotnet helloworld.dâ€¦&#34;</span>   <span class=m>2</span> mins ago    Up <span class=m>2</span> mins              helloworld</span></span></code></pre></div></div></div></div></div><p>We can access our application as before:</p><div class=tab-panel data-tab-group=R-tabs-7f3fe3f4f9dd81498fa028db0cb8d285><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e8eefe2576851f5caeb0cdb3818b59e0 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7f3fe3f4f9dd81498fa028db0cb8d285","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-606851a295fa54a12a75719b4b55c7fd aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7f3fe3f4f9dd81498fa028db0cb8d285","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-e8eefe2576851f5caeb0cdb3818b59e0 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8080/hello/Docker</span></span></code></pre></div></div></div><div id=R-tab-id-606851a295fa54a12a75719b4b55c7fd data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Hello, Docker! </span></span></code></pre></div></div></div></div></div><p>Congratulations, if you&rsquo;ve made it this far, you&rsquo;ve successfully Dockerized a .NET application.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Feb 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=add-instrumentation-to-dockerfile>Add Instrumentation to Dockerfile</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Now that we&rsquo;ve successfully Dockerized our application, let&rsquo;s add in OpenTelemetry instrumentation.</p><p>This is similar to the steps we took when instrumenting the application running on Linux, but there
are some key differences to be aware of.</p><h2 id=update-the-dockerfile>Update the Dockerfile</h2><p>Let&rsquo;s update the <code>Dockerfile</code> in the <code>/home/splunk/workshop/docker-k8s-otel/helloworld</code> directory.</p><p>After the .NET application is built in the Dockerfile, we want to:</p><ul><li>Add dependencies needed to download and execute <code>splunk-otel-dotnet-install.sh</code></li><li>Download the Splunk OTel .NET installer</li><li>Install the distribution</li></ul><p>We can add the following to the build stage of the Dockerfile. Let&rsquo;s open the Dockerfile in vi:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/workshop/docker-k8s-otel/helloworld/Dockerfile</span></span></code></pre></div><blockquote><p>Press the i key to enter edit mode in vi</p></blockquote><blockquote><p>Paste the lines marked with &lsquo;NEW CODE&rsquo; into your Dockerfile in the build stage section:</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># CODE ALREADY IN YOUR DOCKERFILE:</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/sdk:8.0 AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>WORKDIR</span><span class=s> /src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> <span class=o>[</span><span class=s2>&#34;helloworld.csproj&#34;</span>, <span class=s2>&#34;helloworld/&#34;</span><span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet restore <span class=s2>&#34;./helloworld/./helloworld.csproj&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;/src/helloworld&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet build <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: add dependencies for splunk-otel-dotnet-install.sh</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	apt-get install -y unzip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: download Splunk OTel .NET installer</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> curl -sSfL https://github.com/signalfx/splunk-otel-dotnet/releases/latest/download/splunk-otel-dotnet-install.sh -O<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: install the distribution</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sh ./splunk-otel-dotnet-install.sh</span></span></code></pre></div><p>Next, we&rsquo;ll update the final stage of the Dockerfile with the following changes:</p><ul><li>Copy the /root/.splunk-otel-dotnet/ from the build image to the final image</li><li>Copy the entrypoint.sh file as well</li><li>Set the <code>OTEL_SERVICE_NAME</code> and <code>OTEL_RESOURCE_ATTRIBUTES</code> environment variables</li><li>Set the <code>ENTRYPOINT</code> to <code>entrypoint.sh</code></li></ul><p>It&rsquo;s easiest to simply replace the entire final stage with the following:</p><blockquote><p><strong>IMPORTANT</strong> replace <code>$INSTANCE</code> in your Dockerfile with your instance name,
which can be determined by running <code>echo $INSTANCE</code>.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># CODE ALREADY IN YOUR DOCKERFILE</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> base AS final</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: Copy instrumentation file tree</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;//home/app/.splunk-otel-dotnet&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /root/.splunk-otel-dotnet/ .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># CODE ALREADY IN YOUR DOCKERFILE</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>publish /app/publish .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: copy the entrypoint.sh script</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> entrypoint.sh .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: set OpenTelemetry environment variables</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>OTEL_SERVICE_NAME</span><span class=o>=</span>helloworld
</span></span><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span><span class=o>=</span><span class=s1>&#39;deployment.environment=otel-$INSTANCE&#39;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: replace the prior ENTRYPOINT command with the following two lines </span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;sh&#34;</span><span class=p>,</span> <span class=s2>&#34;entrypoint.sh&#34;</span><span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;dotnet&#34;</span><span class=p>,</span> <span class=s2>&#34;helloworld.dll&#34;</span><span class=p>]</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><p>After all of these changes, the Dockerfile should look like the following:</p><blockquote><p><strong>IMPORTANT</strong> if you&rsquo;re going to copy and paste this content into your own Dockerfile,
replace <code>$INSTANCE</code> in your Dockerfile with your instance name,
which can be determined by running <code>echo $INSTANCE</code>.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/aspnet:8.0 AS base</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>USER</span><span class=s> app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>EXPOSE</span><span class=s> 8080</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> mcr.microsoft.com/dotnet/sdk:8.0 AS build</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>WORKDIR</span><span class=s> /src</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> <span class=o>[</span><span class=s2>&#34;helloworld.csproj&#34;</span>, <span class=s2>&#34;helloworld/&#34;</span><span class=o>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet restore <span class=s2>&#34;./helloworld/./helloworld.csproj&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;/src/helloworld&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> . .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> dotnet build <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/build<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: add dependencies for splunk-otel-dotnet-install.sh</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>	apt-get install -y unzip<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: download Splunk OTel .NET installer</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> curl -sSfL https://github.com/signalfx/splunk-otel-dotnet/releases/latest/download/splunk-otel-dotnet-install.sh -O<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: install the distribution</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sh ./splunk-otel-dotnet-install.sh<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> build AS publish</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ARG</span> <span class=nv>BUILD_CONFIGURATION</span><span class=o>=</span>Release
</span></span><span class=line><span class=cl><span class=k>RUN</span> dotnet publish <span class=s2>&#34;./helloworld.csproj&#34;</span> -c <span class=nv>$BUILD_CONFIGURATION</span> -o /app/publish /p:UseAppHost<span class=o>=</span>false<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>FROM</span><span class=s> base AS final</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: Copy instrumentation file tree</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> &#34;//home/app/.splunk-otel-dotnet&#34;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>build /root/.splunk-otel-dotnet/ .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> --from<span class=o>=</span>publish /app/publish .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: copy the entrypoint.sh script</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> entrypoint.sh .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: set OpenTelemetry environment variables</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>OTEL_SERVICE_NAME</span><span class=o>=</span>helloworld
</span></span><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span><span class=o>=</span><span class=s1>&#39;deployment.environment=otel-$INSTANCE&#39;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># NEW CODE: replace the prior ENTRYPOINT command with the following two lines </span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;sh&#34;</span><span class=p>,</span> <span class=s2>&#34;entrypoint.sh&#34;</span><span class=p>]</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;dotnet&#34;</span><span class=p>,</span> <span class=s2>&#34;helloworld.dll&#34;</span><span class=p>]</span></span></span></code></pre></div><h2 id=create-the-entrypointsh-file>Create the entrypoint.sh file</h2><p>We also need to create a file named <code>entrypoint.sh</code> in the <code>/home/splunk/workshop/docker-k8s-otel/helloworld</code> folder
with the following content:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/workshop/docker-k8s-otel/helloworld/entrypoint.sh</span></span></code></pre></div><p>Then paste the following code into the newly created file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/sh
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Read in the file of environment settings</span>
</span></span><span class=line><span class=cl>. /<span class=nv>$HOME</span>/.splunk-otel-dotnet/instrument.sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Then run the CMD</span>
</span></span><span class=line><span class=cl><span class=nb>exec</span> <span class=s2>&#34;</span><span class=nv>$@</span><span class=s2>&#34;</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><p>The <code>entrypoint.sh</code> script is required for sourcing environment variables from the instrument.sh script,
which is included with the instrumentation. This ensures the correct setup of environment variables
for each platform.</p><blockquote><p>You may be wondering, why can&rsquo;t we just include the following command in the Dockerfile to do this,
like we did when activating OpenTelemetry .NET instrumentation on our Linux host?</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>RUN</span> . <span class=nv>$HOME</span>/.splunk-otel-dotnet/instrument.sh</span></span></code></pre></div><p>The problem with this approach is that each Dockerfile RUN step runs a new container and a new shell.
If you try to set an environment variable in one shell, it will not be visible later on.
This problem is resolved by using an entry point script, as we&rsquo;ve done here.
Refer to this <a href=https://stackoverflow.com/questions/55921914/how-to-source-a-script-with-environment-variables-in-a-docker-build-process rel=external>Stack Overflow post</a>
for further details on this issue.</p></blockquote><h2 id=build-the-docker-image>Build the Docker Image</h2><p>Let&rsquo;s build a new Docker image that includes the OpenTelemetry .NET instrumentation:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build -t helloworld:1.1 .</span></span></code></pre></div><blockquote><p>Note: we&rsquo;ve used a different version (1.1) to distinguish the image from our earlier version.
To clean up the older versions, run the following command to get the container id:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker ps -a</span></span></code></pre></div><p>Then run the following command to delete the container:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker rm &lt;old container id&gt; --force</span></span></code></pre></div><p>Now we can get the container image id:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker images <span class=p>|</span> grep 1.0</span></span></code></pre></div><p>Finally, we can run the following command to delete the old image:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker image rm &lt;old image id&gt;</span></span></code></pre></div></blockquote><h2 id=run-the-application>Run the Application</h2><p>Let&rsquo;s run the new Docker image:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run --name helloworld <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--detach <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--expose <span class=m>8080</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--network<span class=o>=</span>host <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>helloworld:1.1</span></span></code></pre></div><p>We can access the application using:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://localhost:8080/hello</span></span></code></pre></div><p>Execute the above command a few times to generate some traffic.</p><p>After a minute or so, confirm that you see new traces in Splunk Observability Cloud.</p><blockquote><p>Remember to look for traces in your particular Environment.</p></blockquote><h2 id=troubleshooting>Troubleshooting</h2><p>If you don&rsquo;t see traces appear in Splunk Observability Cloud, here&rsquo;s how you can troubleshoot.</p><p>First, open the collector config file for editing:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo vi /etc/otel/collector/agent_config.yaml</span></span></code></pre></div><p>Next, add the debug exporter to the traces pipeline, which ensures the traces are written to the collector logs:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>health_check, http_forwarder, zpages, smartagent]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>jaeger, otlp, zipkin]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># NEW CODE: add the debug exporter here</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>otlphttp, signalfx, debug]</span></span></span></code></pre></div><p>Then, restart the collector to apply the configuration changes:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart splunk-otel-collector</span></span></code></pre></div><p>We can then view the collector logs using <code>journalctl</code>:</p><blockquote><p>Press Ctrl + C to exit out of tailing the log.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo journalctl -u splunk-otel-collector -f -n <span class=m>100</span></span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>May 20, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=install-the-opentelemetry-collector-in-k8s>Install the OpenTelemetry Collector in K8s</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<h2 id=recap-of-part-1-of-the-workshop>Recap of Part 1 of the Workshop</h2><p>At this point in the workshop, we&rsquo;ve successfully:</p><ul><li>Deployed the Splunk distribution of the OpenTelemetry Collector on our Linux Host</li><li>Configured it to send traces and metrics to Splunk Observability Cloud</li><li>Deployed a .NET application and instrumented it with OpenTelemetry</li><li>Dockerized the .NET application and ensured traces are flowing to o11y cloud</li></ul><p>If you <strong>haven&rsquo;t</strong> completed the steps listed above, please execute the following commands before proceeding with
the remainder of the workshop:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp /home/splunk/workshop/docker-k8s-otel/docker/Dockerfile /home/splunk/workshop/docker-k8s-otel/helloworld/
</span></span><span class=line><span class=cl>cp /home/splunk/workshop/docker-k8s-otel/docker/entrypoint.sh /home/splunk/workshop/docker-k8s-otel/helloworld/</span></span></code></pre></div><blockquote><p><strong>IMPORTANT</strong> once these files are copied, open <code>/home/splunk/workshop/docker-k8s-otel/helloworld/Dockerfile</code><br>with an editor and replace <code>$INSTANCE</code> in your Dockerfile with your instance name,
which can be determined by running <code>echo $INSTANCE</code>.</p></blockquote><h2 id=introduction-to-part-2-of-the-workshop>Introduction to Part 2 of the Workshop</h2><p>In the next part of the workshop, we want to run the application in Kubernetes,
so we&rsquo;ll need to deploy the Splunk distribution of the OpenTelemetry Collector
in our Kubernetes cluster.</p><p>Let&rsquo;s define some key terms first.</p><h3 id=key-terms>Key Terms</h3><h4 id=what-is-kubernetes>What is Kubernetes?</h4><p><em>&ldquo;Kubernetes is a portable, extensible, open source platform for managing containerized
workloads and services, that facilitates both declarative configuration and automation.&rdquo;</em></p><p>Source: <a href=https://kubernetes.io/docs/concepts/overview/ rel=external>https://kubernetes.io/docs/concepts/overview/</a></p><p>We&rsquo;ll deploy the Docker image we built earlier for our application into our Kubernetes cluster, after making
a small modification to the Dockerfile.</p><h4 id=what-is-helm>What is Helm?</h4><p>Helm is a package manager for Kubernetes.</p><p><em>â€œIt helps you define, install, and upgrade even the most complex Kubernetes application.â€</em></p><p>Source: <a href=https://helm.sh/ rel=external>https://helm.sh/</a></p><p>We&rsquo;ll use Helm to deploy the OpenTelemetry collector in our K8s cluster.</p><h4 id=benefits-of-helm>Benefits of Helm</h4><ul><li>Manage Complexity<ul><li>deal with a single values.yaml file rather than dozens of manifest files</li></ul></li><li>Easy Updates<ul><li>in-place upgrades</li></ul></li><li>Rollback support<ul><li>Just use helm rollback to roll back to an older version of a release</li></ul></li></ul><h2 id=uninstall-the-host-collector>Uninstall the Host Collector</h2><p>Before moving forward, letâ€™s remove the collector we installed earlier on the Linux host:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -sSL https://dl.signalfx.com/splunk-otel-collector.sh &gt; /tmp/splunk-otel-collector.sh<span class=p>;</span>
</span></span><span class=line><span class=cl>sudo sh /tmp/splunk-otel-collector.sh --uninstall</span></span></code></pre></div><h2 id=install-the-collector-using-helm>Install the Collector using Helm</h2><p>Letâ€™s use the command line rather than the in-product wizard to create our own
<code>helm</code> command to install the collector.</p><p>We first need to add the helm repo:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart</span></span></code></pre></div><p>And ensure the repo is up-to-date:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo update</span></span></code></pre></div><p>To configure the helm chart deployment, let&rsquo;s create a new file named <code>values.yaml</code> in
the <code>/home/splunk</code> directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># swith to the /home/splunk dir</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /home/splunk
</span></span><span class=line><span class=cl><span class=c1># create a values.yaml file in vi</span>
</span></span><span class=line><span class=cl>vi values.yaml</span></span></code></pre></div><blockquote><p>Press â€˜iâ€™ to enter into insert mode in vi before pasting the text below.</p></blockquote><p>Then paste the following contents:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>logsEngine</span><span class=p>:</span><span class=w> </span><span class=l>otel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>root_path</span><span class=p>:</span><span class=w> </span><span class=l>/hostfs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>disk</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>filesystem</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>exclude_mount_points</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>match_type</span><span class=p>:</span><span class=w> </span><span class=l>regexp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>mount_points</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/var/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/snap/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/boot/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/boot</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/opt/orbstack/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/mnt/machines/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>/Users/*</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>load</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>network</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>paging</span><span class=p>:</span><span class=w> </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>processes</span><span class=p>:</span><span class=w> </span><span class=kc>null</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><p>Now we can use the following command to install the collector:</p><div class=tab-panel data-tab-group=R-tabs-678612c218a9c66ffd3d1c03fe420003><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ac36c9c171f6301ed2e69e1f09d5724a aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-678612c218a9c66ffd3d1c03fe420003","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-37a2c696dba00cd9d2441fbfb336af87 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-678612c218a9c66ffd3d1c03fe420003","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-ac36c9c171f6301ed2e69e1f09d5724a data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  helm install splunk-otel-collector --version 0.136.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=otel-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  splunk-otel-collector-chart/splunk-otel-collector </span></span></code></pre></div></div></div><div id=R-tab-id-37a2c696dba00cd9d2441fbfb336af87 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Fri Dec <span class=m>20</span> 01:01:43 <span class=m>2024</span>
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: <span class=m>1</span>
</span></span><span class=line><span class=cl>TEST SUITE: None
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm us1.</span></span></code></pre></div></div></div></div></div><h2 id=confirm-the-collector-is-running>Confirm the Collector is Running</h2><p>We can confirm whether the collector is running with the following command:</p><div class=tab-panel data-tab-group=R-tabs-a0b09bf7c8501aa1bd131e8d502c3b8d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-c1606700bf75f2f063c6bdb9d9d76527 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a0b09bf7c8501aa1bd131e8d502c3b8d","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-3172da9fc58a4756f2ca5fe873bccdb0 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-a0b09bf7c8501aa1bd131e8d502c3b8d","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-c1606700bf75f2f063c6bdb9d9d76527 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div id=R-tab-id-3172da9fc58a4756f2ca5fe873bccdb0 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                         READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-8xvk8                            1/1     Running   <span class=m>0</span>          49s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-d54857c89-tx7qr   1/1     Running   <span class=m>0</span>          49s</span></span></code></pre></div></div></div></div></div><h2 id=confirm-your-k8s-cluster-is-in-o11y-cloud>Confirm your K8s Cluster is in O11y Cloud</h2><p>In Splunk Observability Cloud, navigate to <strong>Infrastructure</strong> -> <strong>Kubernetes</strong> -> <strong>Kubernetes Clusters</strong>,
and then search for your cluster name (which is <code>$INSTANCE-cluster</code>):</p><p><a href=#R-image-b3d9aa276213e4a4d08f44a2e1924dcd class=lightbox-link><img alt="Kubernetes node" class="lazy lightbox figure-image" loading=lazy src=../images/k8snode.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b3d9aa276213e4a4d08f44a2e1924dcd><img alt="Kubernetes node" class="lazy lightbox lightbox-image" loading=lazy src=../images/k8snode.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 8, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-application-to-k8s>Deploy Application to K8s</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<h2 id=update-the-dockerfile>Update the Dockerfile</h2><p>With Kubernetes, environment variables are typically managed in the <code>.yaml</code> manifest files rather
than baking them into the Docker image. So let&rsquo;s remove the following two environment variables from the Dockerfile:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/workshop/docker-k8s-otel/helloworld/Dockerfile</span></span></code></pre></div><p>Then remove the following two environment variables:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>OTEL_SERVICE_NAME</span><span class=o>=</span>helloworld
</span></span><span class=line><span class=cl><span class=k>ENV</span> <span class=nv>OTEL_RESOURCE_ATTRIBUTES</span><span class=o>=</span><span class=s1>&#39;deployment.environment=otel-$INSTANCE&#39;</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><h2 id=build-a-new-docker-image>Build a new Docker Image</h2><p>Let&rsquo;s build a new Docker image that excludes the environment variables:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/workshop/docker-k8s-otel/helloworld 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker build -t helloworld:1.2 .</span></span></code></pre></div><blockquote><p>Note: we&rsquo;ve used a different version (1.2) to distinguish the image from our earlier version.
To clean up the older versions, run the following command to get the container id:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker ps -a</span></span></code></pre></div><p>Then run the following command to delete the container:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker rm &lt;old container id&gt; --force</span></span></code></pre></div><p>Now we can get the container image id:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker images <span class=p>|</span> grep 1.1</span></span></code></pre></div><p>Finally, we can run the following command to delete the old image:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker image rm &lt;old image id&gt;</span></span></code></pre></div></blockquote><h2 id=import-the-docker-image-to-kubernetes>Import the Docker Image to Kubernetes</h2><p>Normally weâ€™d push our Docker image to a repository such as Docker Hub.
But for this session, weâ€™ll use a workaround to import it to k3s directly.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Import the image into k3d</span>
</span></span><span class=line><span class=cl>sudo k3d image import helloworld:1.2 --cluster <span class=nv>$INSTANCE</span>-cluster</span></span></code></pre></div><h2 id=deploy-the-net-application>Deploy the .NET Application</h2><blockquote><p>Hint: To enter edit mode in vi, press the &lsquo;i&rsquo; key. To save changes, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the <code>enter/return</code> key.</p></blockquote><p>To deploy our .NET application to K8s, let&rsquo;s create a file named <code>deployment.yaml</code> in <code>/home/splunk</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/deployment.yaml</span></span></code></pre></div><p>And paste in the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/library/helloworld:1.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8080&#34;</span></span></span></code></pre></div><details class="box cstyle notices tip expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<i class="fa-fw fas fa-lightbulb"></i>
What is a Deployment in Kubernetes?</summary><div class=box-content><p>The deployment.yaml file is a kubernetes config file that is used to define a deployment resource. This file is the cornerstone of managing applications in Kubernetes! The deployment config defines the deploymentâ€™s <em><strong>desired state</strong></em> and Kubernetes then ensures the <em><strong>actual</strong></em> state matches it. This allows application pods to self-heal and also allows for easy updates or roll backs to applications.</p></div></details><p>Then, create a second file in the same directory named <code>service.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/service.yaml</span></span></code></pre></div><p>And paste in the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Service</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ClusterIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>protocol</span><span class=p>:</span><span class=w> </span><span class=l>TCP</span></span></span></code></pre></div><details class="box cstyle notices tip expand"><summary class=box-label><i class="expander-icon fa-fw fas fa-chevron-right"></i>
<i class="fa-fw fas fa-lightbulb"></i>
What is a Service in Kubernetes?</summary><div class=box-content><p>A Service in Kubernetes is an abstraction layer, working like a middleman, giving you a fixed IP address or DNS name to access your Pods, which stays the same, even if Pods are added, removed, or replaced over time.</p></div></details><p>Then, create a second file in the same directory named <code>service.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/ingress.yaml</span></span></code></pre></div><p>And paste in the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>networking.k8s.io/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld-ingress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>annotations</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traefik.ingress.kubernetes.io/router.entrypoints</span><span class=p>:</span><span class=w> </span><span class=l>web</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>ingressClassName</span><span class=p>:</span><span class=w> </span><span class=l>traefik</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>rules</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=l>helloworld.localhost</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>paths</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=l>/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>pathType</span><span class=p>:</span><span class=w> </span><span class=l>Prefix</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>backend</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>port</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>number</span><span class=p>:</span><span class=w> </span><span class=m>8080</span></span></span></code></pre></div><p>We can then use these manifest files to deploy our application:</p><div class=tab-panel data-tab-group=R-tabs-6487982f7ca320429f10f86702cca558><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-9062a3a7deb551e7acaf26b40c168d91 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6487982f7ca320429f10f86702cca558","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-a12ac6effa288aa59120103b537f7f01 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-6487982f7ca320429f10f86702cca558","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-9062a3a7deb551e7acaf26b40c168d91 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># create the deployment</span>
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># create the service</span>
</span></span><span class=line><span class=cl>kubectl apply -f service.yaml
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># create the ingress</span>
</span></span><span class=line><span class=cl>kubectl apply -f ingress.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-a12ac6effa288aa59120103b537f7f01 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/helloworld created
</span></span><span class=line><span class=cl>service/helloworld created</span></span></code></pre></div></div></div></div></div><h2 id=test-the-application>Test the Application</h2><p>Use the following command to access the application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://helloworld.localhost/hello/Kubernetes</span></span></code></pre></div><h2 id=configure-opentelemetry>Configure OpenTelemetry</h2><p>The .NET OpenTelemetry instrumentation was already baked into the Docker image. But we need to set a few
environment variables to tell it where to send the data.</p><p>Add the following to <code>deployment.yaml</code> file you created earlier:</p><blockquote><p><strong>IMPORTANT</strong> replace <code>$INSTANCE</code> in the YAML below with your instance name,
which can be determined by running <code>echo $INSTANCE</code>.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>NODE_IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(NODE_IP):4318&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;helloworld&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=otel-$INSTANCE&#34;</span><span class=w> </span></span></span></code></pre></div><p>The complete <code>deployment.yaml</code> file should be as follows (with <strong>your</strong> instance name rather than <code>$INSTANCE</code>):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/library/helloworld:1.2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class=l>Never</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>8080</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>NODE_IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(NODE_IP):4318&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;helloworld&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=otel-$INSTANCE&#34;</span><span class=w> </span></span></span></code></pre></div><p>Apply the changes with:</p><div class=tab-panel data-tab-group=R-tabs-44045d7f9eb095a771bd5e5a0d1b323a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2c8fa18cf59aa1a0db1641f7388bbb14 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-44045d7f9eb095a771bd5e5a0d1b323a","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-be81934e9ec39576c914df8ec40e8f68 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-44045d7f9eb095a771bd5e5a0d1b323a","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-2c8fa18cf59aa1a0db1641f7388bbb14 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-be81934e9ec39576c914df8ec40e8f68 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/helloworld configured</span></span></code></pre></div></div></div></div></div><p>Then use the following command to generate some traffic:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl http://helloworld.localhost/hello/Kubernetes</span></span></code></pre></div><p>After a minute or so, you should see traces flowing in the o11y cloud. But, if you want to see your trace sooner, we have &mldr;</p><h2 id=a-challenge-for-you>A Challenge For You</h2><p>If you are a developer and just want to quickly grab the trace id or see console feedback, what environment variable could you add to the deployment.yaml file?</p><details><summary><b>Click here to see the answer</b></summary><p>If you recall in our challenge from Section 4, <em>Instrument a .NET Application with OpenTelemetry</em>, we showed you a trick to write traces to the console using the <code>OTEL_TRACES_EXPORTER</code> environment variable. We can add this variable to our deployment.yaml, redeploy our application, and tail the logs from our helloworld app so that we can grab the trace id to then find the trace in Splunk Observability Cloud. (In the next section of our workshop, we will also walk through using the debug exporter, which is how you would typically debug your application in a K8s environment.)</p><p>First, open the deployment.yaml file in vi:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi deployment.yaml</span></span></code></pre></div><p>Then, add the <code>OTEL_TRACES_EXPORTER</code> environment variable:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>NODE_IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(NODE_IP):4318&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;helloworld&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=YOURINSTANCE&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=c># NEW VALUE HERE:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_TRACES_EXPORTER</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;otlp,console&#34;</span><span class=w> </span></span></span></code></pre></div><p>Save your changes then redeploy the application:</p><div class=tab-panel data-tab-group=R-tabs-1f25d9590d923f309867a0104a7f330c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-82bacf2691c4cff78b6ec3d6d30d7ee0 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-1f25d9590d923f309867a0104a7f330c","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-5f7e85acdf571c7a6f5bb5f760340e80 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-1f25d9590d923f309867a0104a7f330c","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-82bacf2691c4cff78b6ec3d6d30d7ee0 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-5f7e85acdf571c7a6f5bb5f760340e80 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/helloworld configured</span></span></code></pre></div></div></div></div></div><p>Tail the helloworld logs:</p><div class=tab-panel data-tab-group=R-tabs-dcab05fcca265541eb380394f6d5ab48><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-5376533aed133e8614330f12dc405bdd aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-dcab05fcca265541eb380394f6d5ab48","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-4080371699c973d16b236b46cc0745f5 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-dcab05fcca265541eb380394f6d5ab48","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-5376533aed133e8614330f12dc405bdd data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>app</span><span class=o>=</span>helloworld -f</span></span></code></pre></div></div></div><div id=R-tab-id-4080371699c973d16b236b46cc0745f5 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>info: HelloWorldController<span class=o>[</span>0<span class=o>]</span>
</span></span><span class=line><span class=cl>      /hello endpoint invoked by K8s9
</span></span><span class=line><span class=cl>Activity.TraceId:            5bceb747cc7b79a77cfbde285f0f09cb
</span></span><span class=line><span class=cl>Activity.SpanId:             ac67afe500e7ad12
</span></span><span class=line><span class=cl>Activity.TraceFlags:         Recorded
</span></span><span class=line><span class=cl>Activity.ActivitySourceName: Microsoft.AspNetCore
</span></span><span class=line><span class=cl>Activity.DisplayName:        GET hello/<span class=o>{</span>name?<span class=o>}</span>
</span></span><span class=line><span class=cl>Activity.Kind:               Server
</span></span><span class=line><span class=cl>Activity.StartTime:          2025-02-04T15:22:48.2381736Z
</span></span><span class=line><span class=cl>Activity.Duration:           00:00:00.0027334
</span></span><span class=line><span class=cl>Activity.Tags:
</span></span><span class=line><span class=cl>    server.address: 10.43.226.224
</span></span><span class=line><span class=cl>    server.port: <span class=m>8080</span>
</span></span><span class=line><span class=cl>    http.request.method: GET
</span></span><span class=line><span class=cl>    url.scheme: http
</span></span><span class=line><span class=cl>    url.path: /hello/K8s9
</span></span><span class=line><span class=cl>    network.protocol.version: 1.1
</span></span><span class=line><span class=cl>    user_agent.original: curl/7.81.0
</span></span><span class=line><span class=cl>    http.route: hello/<span class=o>{</span>name?<span class=o>}</span>
</span></span><span class=line><span class=cl>    http.response.status_code: <span class=m>200</span>
</span></span><span class=line><span class=cl>Resource associated with Activity:
</span></span><span class=line><span class=cl>    splunk.distro.version: 1.8.0
</span></span><span class=line><span class=cl>    telemetry.distro.name: splunk-otel-dotnet
</span></span><span class=line><span class=cl>    telemetry.distro.version: 1.8.0
</span></span><span class=line><span class=cl>    os.type: linux
</span></span><span class=line><span class=cl>    os.description: Debian GNU/Linux <span class=m>12</span> <span class=o>(</span>bookworm<span class=o>)</span>
</span></span><span class=line><span class=cl>    os.build_id: 6.2.0-1018-aws
</span></span><span class=line><span class=cl>    os.name: Debian GNU/Linux
</span></span><span class=line><span class=cl>    os.version: <span class=m>12</span>
</span></span><span class=line><span class=cl>    host.name: helloworld-69f5c7988b-dxkwh
</span></span><span class=line><span class=cl>    process.owner: app
</span></span><span class=line><span class=cl>    process.pid: <span class=m>1</span>
</span></span><span class=line><span class=cl>    process.runtime.description: .NET 8.0.12
</span></span><span class=line><span class=cl>    process.runtime.name: .NET
</span></span><span class=line><span class=cl>    process.runtime.version: 8.0.12
</span></span><span class=line><span class=cl>    container.id: 39c2061d7605d8c390b4fe5f8054719f2fe91391a5c32df5684605202ca39ae9
</span></span><span class=line><span class=cl>    telemetry.sdk.name: opentelemetry
</span></span><span class=line><span class=cl>    telemetry.sdk.language: dotnet
</span></span><span class=line><span class=cl>    telemetry.sdk.version: 1.9.0
</span></span><span class=line><span class=cl>    service.name: helloworld
</span></span><span class=line><span class=cl>    deployment.environment: otel-jen-tko-1b75</span></span></code></pre></div></div></div></div></div><p>Then, in your other terminal window, generate a trace with your curl command. You will see the trace id in the console in which you are tailing the logs. Copy the <code>Activity.TraceId:</code> value and paste it into the Trace search field in APM.</p></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 27, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=customize-the-opentelemetry-collector-configuration>Customize the OpenTelemetry Collector Configuration</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>We deployed the Splunk Distribution of the OpenTelemetry Collector in our K8s cluster
using the default configuration. In this section, we&rsquo;ll walk through several examples
showing how to customize the collector config.</p><h2 id=get-the-collector-configuration>Get the Collector Configuration</h2><p>Before we customize the collector config, how do we determine what the current configuration
looks like?</p><p>In a Kubernetes environment, the collector configuration is stored using a Config Map.</p><p>We can see which config maps exist in our cluster with the following command:</p><div class=tab-panel data-tab-group=R-tabs-a48d6388f099786bd3a0766954cb5bc6><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bd401e7da96eb82c75c97e37b76f1123 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a48d6388f099786bd3a0766954cb5bc6","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-71e899c01149065bc8e7d52dc4a26bb8 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-a48d6388f099786bd3a0766954cb5bc6","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-bd401e7da96eb82c75c97e37b76f1123 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-71e899c01149065bc8e7d52dc4a26bb8 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                 DATA   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-otel-k8s-cluster-receiver   <span class=m>1</span>      3h37m
</span></span><span class=line><span class=cl>splunk-otel-collector-otel-agent                  <span class=m>1</span>      3h37m</span></span></code></pre></div></div></div></div></div><blockquote><p>Why are there two config maps?</p></blockquote><p>We can then view the config map of the collector agent as follows:</p><div class=tab-panel data-tab-group=R-tabs-2186458b5468065cbcf146aababc1129><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-52e705f4a391e938965c085337abf032 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2186458b5468065cbcf146aababc1129","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-0293b6d183ded12ae5e85ce03fa1a2df aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-2186458b5468065cbcf146aababc1129","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-52e705f4a391e938965c085337abf032 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-agent</span></span></code></pre></div></div></div><div id=R-tab-id-0293b6d183ded12ae5e85ce03fa1a2df data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Name:         splunk-otel-collector-otel-agent
</span></span><span class=line><span class=cl>Namespace:    default
</span></span><span class=line><span class=cl>Labels:       <span class=nv>app</span><span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/instance<span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/managed-by<span class=o>=</span>Helm
</span></span><span class=line><span class=cl>              app.kubernetes.io/name<span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/version<span class=o>=</span>0.113.0
</span></span><span class=line><span class=cl>              <span class=nv>chart</span><span class=o>=</span>splunk-otel-collector-0.113.0
</span></span><span class=line><span class=cl>              helm.sh/chart<span class=o>=</span>splunk-otel-collector-0.113.0
</span></span><span class=line><span class=cl>              <span class=nv>heritage</span><span class=o>=</span>Helm
</span></span><span class=line><span class=cl>              <span class=nv>release</span><span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>Annotations:  meta.helm.sh/release-name: splunk-otel-collector
</span></span><span class=line><span class=cl>              meta.helm.sh/release-namespace: default
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>Data</span>
</span></span><span class=line><span class=cl><span class=o>====</span>
</span></span><span class=line><span class=cl>relay:
</span></span><span class=line><span class=cl>----
</span></span><span class=line><span class=cl>exporters:
</span></span><span class=line><span class=cl>  otlphttp:
</span></span><span class=line><span class=cl>    headers:
</span></span><span class=line><span class=cl>      X-SF-Token: <span class=si>${</span><span class=nv>SPLUNK_OBSERVABILITY_ACCESS_TOKEN</span><span class=si>}</span>
</span></span><span class=line><span class=cl>    metrics_endpoint: https://ingest.us1.signalfx.com/v2/datapoint/otlp
</span></span><span class=line><span class=cl>    traces_endpoint: https://ingest.us1.signalfx.com/v2/trace/otlp
</span></span><span class=line><span class=cl>    <span class=o>(</span>followed by the rest of the collector config in yaml format<span class=o>)</span> </span></span></code></pre></div></div></div></div></div><h2 id=how-to-update-the-collector-configuration-in-k8s>How to Update the Collector Configuration in K8s</h2><p>In our earlier example running the collector on a Linux instance,
the collector configuration was available in the <code>/etc/otel/collector/agent_config.yaml</code> file. If we
needed to make changes to the collector config in that case, we&rsquo;d simply edit this file,
save the changes, and then restart the collector.</p><p>In K8s, things work a bit differently. Instead of modifying the <code>agent_config.yaml</code> directly, we&rsquo;ll
instead customize the collector configuration by making changes to the <code>values.yaml</code> file used to deploy
the helm chart.</p><p>The values.yaml file in <a href=https://github.com/signalfx/splunk-otel-collector-chart/blob/main/helm-charts/splunk-otel-collector/values.yaml rel=external>GitHub</a>
describes the customization options that are available to us.</p><p>Let&rsquo;s look at an example.</p><h2 id=add-infrastructure-events-monitoring>Add Infrastructure Events Monitoring</h2><p>For our first example, let&rsquo;s enable infrastructure events monitoring for our K8s cluster.</p><blockquote><p>This will allow us to see Kubernetes events as part of the Events Feed section in charts.
The cluster receiver will be configured with a Smart Agent receiver using the kubernetes-events
monitor to send custom events. See <a href=https://docs.splunk.com/observability/en/gdi/opentelemetry/collector-kubernetes/kubernetes-config-logs.html#collect-kubernetes-events rel=external>Collect Kubernetes events</a>
for further details.</p></blockquote><p>This is done by adding the following line to the <code>values.yaml</code> file:</p><blockquote><p>Hint: steps to open and save in vi are in previous steps.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>logsEngine</span><span class=p>:</span><span class=w> </span><span class=l>otel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>splunkObservability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>infrastructureMonitoringEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nn>...</span></span></span></code></pre></div><p>Once the file is saved, we can apply the changes with:</p><div class=tab-panel data-tab-group=R-tabs-f41a3e25995009060cbf886fccbdecfc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-85e141abdd1bdea727c373bbbeeca68d aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f41a3e25995009060cbf886fccbdecfc","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-9f2592138cd93247b4eeec0616b17cbb aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-f41a3e25995009060cbf886fccbdecfc","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-85e141abdd1bdea727c373bbbeeca68d data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=otel-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-9f2592138cd93247b4eeec0616b17cbb data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Release <span class=s2>&#34;splunk-otel-collector&#34;</span> has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Fri Dec <span class=m>20</span> 01:17:03 <span class=m>2024</span>
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: <span class=m>2</span>
</span></span><span class=line><span class=cl>TEST SUITE: None
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm us1.</span></span></code></pre></div></div></div></div></div><p>We can then view the config map and ensure the changes were applied:</p><div class=tab-panel data-tab-group=R-tabs-7fdbdbc8bdf8e5702e2525d0601af4a7><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8ce0f14fb0b0770cf98b1111ee19b0f1 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7fdbdbc8bdf8e5702e2525d0601af4a7","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-cc27b40d0f15ad0fa717b22c8d58ffb9 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7fdbdbc8bdf8e5702e2525d0601af4a7","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-8ce0f14fb0b0770cf98b1111ee19b0f1 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-k8s-cluster-receiver</span></span></code></pre></div></div></div><div id=R-tab-id-cc27b40d0f15ad0fa717b22c8d58ffb9 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p>Ensure <code>smartagent/kubernetes-events</code> is included in the agent config now:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  smartagent/kubernetes-events:
</span></span><span class=line><span class=cl>    alwaysClusterReporter: <span class=nb>true</span>
</span></span><span class=line><span class=cl>    type: kubernetes-events
</span></span><span class=line><span class=cl>    whitelistedEvents:
</span></span><span class=line><span class=cl>    - involvedObjectKind: Pod
</span></span><span class=line><span class=cl>      reason: Created
</span></span><span class=line><span class=cl>    - involvedObjectKind: Pod
</span></span><span class=line><span class=cl>      reason: Unhealthy
</span></span><span class=line><span class=cl>    - involvedObjectKind: Pod
</span></span><span class=line><span class=cl>      reason: Failed
</span></span><span class=line><span class=cl>    - involvedObjectKind: Job
</span></span><span class=line><span class=cl>      reason: FailedCreate</span></span></code></pre></div></div></div></div></div><blockquote><p>Note that we specified the cluster receiver config map since that&rsquo;s
where these particular changes get applied.</p></blockquote><h2 id=add-the-debug-exporter>Add the Debug Exporter</h2><p>Suppose we want to see the traces and logs that are sent to the collector, so we can
inspect them before sending them to Splunk. We can use the debug exporter for this purpose, which
can be helpful for troubleshooting OpenTelemetry-related issues.</p><p>Let&rsquo;s add the debug exporter to the bottom of the values.yaml file as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>logsEngine</span><span class=p>:</span><span class=w> </span><span class=l>otel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>splunkObservability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>infrastructureMonitoringEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span></span></span></code></pre></div><p>Once the file is saved, we can apply the changes with:</p><div class=tab-panel data-tab-group=R-tabs-74b268bb10f3d780f8e8b76a32cbef56><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ce1062b5a175839ba4d48de87e97d8c7 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-74b268bb10f3d780f8e8b76a32cbef56","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-b9db4936148798ea9e7bcf5dc322ce7c aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-74b268bb10f3d780f8e8b76a32cbef56","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-ce1062b5a175839ba4d48de87e97d8c7 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=otel-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-b9db4936148798ea9e7bcf5dc322ce7c data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Release <span class=s2>&#34;splunk-otel-collector&#34;</span> has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Fri Dec <span class=m>20</span> 01:32:03 <span class=m>2024</span>
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: <span class=m>3</span>
</span></span><span class=line><span class=cl>TEST SUITE: None
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm us1.</span></span></code></pre></div></div></div></div></div><p>Exercise the application a few times using curl, then tail the agent collector logs with the
following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>component</span><span class=o>=</span>otel-collector-agent -f</span></span></code></pre></div><p>You should see traces written to the agent collector logs such as the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>2024-12-20T01:43:52.929Z	info	Traces	{&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;traces&#34;, &#34;name&#34;: &#34;debug&#34;, &#34;resource spans&#34;: 1, &#34;spans&#34;: 2}
2024-12-20T01:43:52.929Z	info	ResourceSpans #0
Resource SchemaURL: https://opentelemetry.io/schemas/1.6.1
Resource attributes:
     -&gt; splunk.distro.version: Str(1.8.0)
     -&gt; telemetry.distro.name: Str(splunk-otel-dotnet)
     -&gt; telemetry.distro.version: Str(1.8.0)
     -&gt; os.type: Str(linux)
     -&gt; os.description: Str(Debian GNU/Linux 12 (bookworm))
     -&gt; os.build_id: Str(6.8.0-1021-aws)
     -&gt; os.name: Str(Debian GNU/Linux)
     -&gt; os.version: Str(12)
     -&gt; host.name: Str(derek-1)
     -&gt; process.owner: Str(app)
     -&gt; process.pid: Int(1)
     -&gt; process.runtime.description: Str(.NET 8.0.11)
     -&gt; process.runtime.name: Str(.NET)
     -&gt; process.runtime.version: Str(8.0.11)
     -&gt; container.id: Str(78b452a43bbaa3354a3cb474010efd6ae2367165a1356f4b4000be031b10c5aa)
     -&gt; telemetry.sdk.name: Str(opentelemetry)
     -&gt; telemetry.sdk.language: Str(dotnet)
     -&gt; telemetry.sdk.version: Str(1.9.0)
     -&gt; service.name: Str(helloworld)
     -&gt; deployment.environment: Str(otel-derek-1)
     -&gt; k8s.pod.ip: Str(10.42.0.15)
     -&gt; k8s.pod.labels.app: Str(helloworld)
     -&gt; k8s.pod.name: Str(helloworld-84865965d9-nkqsx)
     -&gt; k8s.namespace.name: Str(default)
     -&gt; k8s.pod.uid: Str(38d39bc6-1309-4022-a569-8acceef50942)
     -&gt; k8s.node.name: Str(derek-1)
     -&gt; k8s.cluster.name: Str(derek-1-cluster)</code></pre></div><p>And log entries such as:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>2024-12-20T01:43:53.215Z	info	Logs	{&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;logs&#34;, &#34;name&#34;: &#34;debug&#34;, &#34;resource logs&#34;: 1, &#34;log records&#34;: 2}
2024-12-20T01:43:53.215Z	info	ResourceLog #0
Resource SchemaURL: https://opentelemetry.io/schemas/1.6.1
Resource attributes:
     -&gt; splunk.distro.version: Str(1.8.0)
     -&gt; telemetry.distro.name: Str(splunk-otel-dotnet)
     -&gt; telemetry.distro.version: Str(1.8.0)
     -&gt; os.type: Str(linux)
     -&gt; os.description: Str(Debian GNU/Linux 12 (bookworm))
     -&gt; os.build_id: Str(6.8.0-1021-aws)
     -&gt; os.name: Str(Debian GNU/Linux)
     -&gt; os.version: Str(12)
     -&gt; host.name: Str(derek-1)
     -&gt; process.owner: Str(app)
     -&gt; process.pid: Int(1)
     -&gt; process.runtime.description: Str(.NET 8.0.11)
     -&gt; process.runtime.name: Str(.NET)
     -&gt; process.runtime.version: Str(8.0.11)
     -&gt; container.id: Str(78b452a43bbaa3354a3cb474010efd6ae2367165a1356f4b4000be031b10c5aa)
     -&gt; telemetry.sdk.name: Str(opentelemetry)
     -&gt; telemetry.sdk.language: Str(dotnet)
     -&gt; telemetry.sdk.version: Str(1.9.0)
     -&gt; service.name: Str(helloworld)
     -&gt; deployment.environment: Str(otel-derek-1)
     -&gt; k8s.node.name: Str(derek-1)
     -&gt; k8s.cluster.name: Str(derek-1-cluster)</code></pre></div><p>If you return to Splunk Observability Cloud though, you&rsquo;ll notice that traces and logs are
no longer being sent there by the application.</p><p>Why do you think that is? We&rsquo;ll explore it in the next section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=troubleshoot-opentelemetry-collector-issues>Troubleshoot OpenTelemetry Collector Issues</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>In the previous section, we added the debug exporter to the collector configuration,
and made it part of the pipeline for traces and logs. We see the debug output
written to the agent collector logs as expected.</p><p>However, traces are no longer sent to o11y cloud. Let&rsquo;s figure out why and fix it.</p><h2 id=review-the-collector-config>Review the Collector Config</h2><p>Whenever a change to the collector config is made via a <code>values.yaml</code> file, it&rsquo;s helpful
to review the actual configuration applied to the collector by looking at the config map:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-agent</span></span></code></pre></div><p>Let&rsquo;s review the pipelines for logs and traces in the agent collector config. They should look
like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filter/logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filelog</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>fluentforward</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>k8sattributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_environment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>jaeger</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>smartagent/signalfx-forwarder</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>zipkin</span></span></span></code></pre></div><p>Do you see the problem? Only the debug exporter is included in the traces and logs pipelines.
The <code>otlphttp</code> and <code>signalfx</code> exporters that were present in the traces pipeline configuration previously are gone.
This is why we no longer see traces in o11y cloud. And for the logs pipeline, the <code>splunk_hec/platform_logs</code>
exporter has been removed.</p><blockquote><p>How did we know what specific exporters were included before? To find out,
we could have reverted our earlier customizations and then checked the config
map to see what was in the traces pipeline originally. Alternatively, we can refer
to the examples in the <a href=https://github.com/signalfx/splunk-otel-collector-chart/blob/main/examples/default/rendered_manifests/configmap-agent.yaml rel=external>GitHub repo for splunk-otel-collector-chart</a>
which shows us what default agent config is used by the Helm chart.</p></blockquote><h2 id=how-did-these-exporters-get-removed>How did these exporters get removed?</h2><p>Let&rsquo;s review the customizations we added to the <code>values.yaml</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>logsEngine</span><span class=p>:</span><span class=w> </span><span class=l>otel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>splunkObservability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>infrastructureMonitoringEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span></span></span></code></pre></div><p>When we applied the <code>values.yaml</code> file to the collector using <code>helm upgrade</code>, the
custom configuration got merged with the previous collector configuration.
When this happens, the sections of the <code>yaml</code> configuration that contain lists,
such as the list of exporters in the pipeline section, get replaced with what we
included in the <code>values.yaml</code> file (which was only the debug exporter).</p><h2 id=lets-fix-the-issue>Let&rsquo;s Fix the Issue</h2><p>So when customizing an existing pipeline, we need to fully redefine that part of the configuration.
Our <code>values.yaml</code> file should thus be updated as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>logsEngine</span><span class=p>:</span><span class=w> </span><span class=l>otel</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>splunkObservability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>infrastructureMonitoringEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>splunk_hec/platform_logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span></span></span></code></pre></div><p>Let&rsquo;s apply the changes:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=otel-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=splunk4rookies-workshop&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><p>And then check the agent config map:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-agent</span></span></code></pre></div><p>This time, we should see a fully defined exporters pipeline for both logs and traces:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  pipelines:
</span></span><span class=line><span class=cl>    logs:
</span></span><span class=line><span class=cl>      exporters:
</span></span><span class=line><span class=cl>      - splunk_hec/platform_logs
</span></span><span class=line><span class=cl>      - debug
</span></span><span class=line><span class=cl>      processors:
</span></span><span class=line><span class=cl>      ...
</span></span><span class=line><span class=cl>    traces:
</span></span><span class=line><span class=cl>      exporters:
</span></span><span class=line><span class=cl>      - otlphttp
</span></span><span class=line><span class=cl>      - signalfx
</span></span><span class=line><span class=cl>      - debug
</span></span><span class=line><span class=cl>      processors:
</span></span><span class=line><span class=cl>      ...</span></span></code></pre></div><h2 id=reviewing-the-log-output>Reviewing the Log Output</h2><p>The <strong>Splunk Distribution of OpenTelemetry .NET</strong> automatically exports logs enriched with tracing context
from applications that use <code>Microsoft.Extensions.Logging</code> for logging (which our sample app does).</p><p>Application logs are enriched with tracing metadata and then exported to a local instance of
the OpenTelemetry Collector in OTLP format.</p><p>Let&rsquo;s take a closer look at the logs that were captured by the debug exporter to see if that&rsquo;s happening.<br>To tail the collector logs, we can use the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>component</span><span class=o>=</span>otel-collector-agent -f</span></span></code></pre></div><p>Once we&rsquo;re tailing the logs, we can use curl to generate some more traffic. Then we should see
something like the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>2024-12-20T21:56:30.858Z	info	Logs	{&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;logs&#34;, &#34;name&#34;: &#34;debug&#34;, &#34;resource logs&#34;: 1, &#34;log records&#34;: 1}
2024-12-20T21:56:30.858Z	info	ResourceLog #0
Resource SchemaURL: https://opentelemetry.io/schemas/1.6.1
Resource attributes:
     -&gt; splunk.distro.version: Str(1.8.0)
     -&gt; telemetry.distro.name: Str(splunk-otel-dotnet)
     -&gt; telemetry.distro.version: Str(1.8.0)
     -&gt; os.type: Str(linux)
     -&gt; os.description: Str(Debian GNU/Linux 12 (bookworm))
     -&gt; os.build_id: Str(6.8.0-1021-aws)
     -&gt; os.name: Str(Debian GNU/Linux)
     -&gt; os.version: Str(12)
     -&gt; host.name: Str(derek-1)
     -&gt; process.owner: Str(app)
     -&gt; process.pid: Int(1)
     -&gt; process.runtime.description: Str(.NET 8.0.11)
     -&gt; process.runtime.name: Str(.NET)
     -&gt; process.runtime.version: Str(8.0.11)
     -&gt; container.id: Str(5bee5b8f56f4b29f230ffdd183d0367c050872fefd9049822c1ab2aa662ba242)
     -&gt; telemetry.sdk.name: Str(opentelemetry)
     -&gt; telemetry.sdk.language: Str(dotnet)
     -&gt; telemetry.sdk.version: Str(1.9.0)
     -&gt; service.name: Str(helloworld)
     -&gt; deployment.environment: Str(otel-derek-1)
     -&gt; k8s.node.name: Str(derek-1)
     -&gt; k8s.cluster.name: Str(derek-1-cluster)
ScopeLogs #0
ScopeLogs SchemaURL: 
InstrumentationScope HelloWorldController 
LogRecord #0
ObservedTimestamp: 2024-12-20 21:56:28.486804 +0000 UTC
Timestamp: 2024-12-20 21:56:28.486804 +0000 UTC
SeverityText: Information
SeverityNumber: Info(9)
Body: Str(/hello endpoint invoked by {name})
Attributes:
     -&gt; name: Str(Kubernetes)
Trace ID: 78db97a12b942c0252d7438d6b045447
Span ID: 5e9158aa42f96db3
Flags: 1
	{&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;logs&#34;, &#34;name&#34;: &#34;debug&#34;}</code></pre></div><p>In this example, we can see that the Trace ID and Span ID were automatically written to the log output
by the OpenTelemetry .NET instrumentation. This allows us to correlate logs with traces in
Splunk Observability Cloud.</p><p>You might remember though that if we deploy the OpenTelemetry collector in a K8s cluster using Helm,
and we include the log collection option, then the OpenTelemetry collector will use the File Log receiver
to automatically capture any container logs.</p><p>This would result in duplicate logs being captured for our application. For example, in the following screenshot we
can see two log entries for each request made to our service:</p><p><a href=#R-image-8b25affde132d4449f90a10451a58bea class=lightbox-link><img alt="Duplicate Log Entries" class="lazy lightbox figure-image" loading=lazy src=../images/duplicate_logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8b25affde132d4449f90a10451a58bea><img alt="Duplicate Log Entries" class="lazy lightbox lightbox-image" loading=lazy src=../images/duplicate_logs.png></a></p><p>How do we avoid this?</p><h2 id=avoiding-duplicate-logs-in-k8s>Avoiding Duplicate Logs in K8s</h2><p>To avoid capturing duplicate logs, we can set the <code>OTEL_LOGS_EXPORTER</code> environment variable to <code>none</code>,
to tell the Splunk Distribution of OpenTelemetry .NET to avoid exporting logs to the collector using OTLP.
We can do this by adding the <code>OTEL_LOGS_EXPORTER</code> environment variabl to the <code>deployment.yaml</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>          </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8080&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>NODE_IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(NODE_IP):4318&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;helloworld&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_RESOURCE_ATTRIBUTES </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;deployment.environment=otel-$INSTANCE&#34;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_LOGS_EXPORTER </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;none&#34;</span><span class=w> </span></span></span></code></pre></div><p>And then running:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># update the deployment</span>
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div><p>Setting the <code>OTEL_LOGS_EXPORTER</code> environment variable to <code>none</code> is straightforward. However, the Trace ID
and Span ID are not written to the stdout logs generated by the application,
which would prevent us from correlating logs with traces.</p><p>To resolve this, we will need to define a custom logger, such as the example defined in<br><code>/home/splunk/workshop/docker-k8s-otel/helloworld/SplunkTelemetryConfigurator.cs</code>.</p><p>We could include this in our application by updating the <code>Program.cs</code> file as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-cs data-lang=cs><span class=line><span class=cl><span class=k>using</span> <span class=nn>SplunkTelemetry</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>Microsoft.Extensions.Logging.Console</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>builder</span> <span class=p>=</span> <span class=n>WebApplication</span><span class=p>.</span><span class=n>CreateBuilder</span><span class=p>(</span><span class=n>args</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>builder</span><span class=p>.</span><span class=n>Services</span><span class=p>.</span><span class=n>AddControllers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>SplunkTelemetryConfigurator</span><span class=p>.</span><span class=n>ConfigureLogger</span><span class=p>(</span><span class=n>builder</span><span class=p>.</span><span class=n>Logging</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>app</span> <span class=p>=</span> <span class=n>builder</span><span class=p>.</span><span class=n>Build</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=p>.</span><span class=n>MapControllers</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>app</span><span class=p>.</span><span class=n>Run</span><span class=p>();</span></span></span></code></pre></div><p>Then we&rsquo;ll build a new Docker image that includes the custom logging configuration:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/workshop/docker-k8s-otel/helloworld 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker build -t helloworld:1.3 .</span></span></code></pre></div><p>And then we&rsquo;ll import the updated image into Kubernetes:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Import the image into k3d</span>
</span></span><span class=line><span class=cl>sudo k3d image import helloworld:1.3 --cluster <span class=nv>$INSTANCE</span>-cluster</span></span></code></pre></div><p>Finally, we&rsquo;ll need to update the `deployment.yaml&rsquo; file to use the 1.3 version
of the container image:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>helloworld</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/library/helloworld:1.3</span></span></span></code></pre></div><p>And then apply the changes:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># update the deployment</span>
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml</span></span></code></pre></div><p>Now we can see that the duplicate log entries have been eliminated. And the
remaining log entries have been formatted as JSON, and include the span and trace IDs:</p><p><a href=#R-image-f2d8df5b382542785a9c89dac2d0f58d class=lightbox-link><img alt="JSON Format Logs" class="lazy lightbox figure-image" loading=lazy src=../images/logs_json_format.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f2d8df5b382542785a9c89dac2d0f58d><img alt="JSON Format Logs" class="lazy lightbox lightbox-image" loading=lazy src=../images/logs_json_format.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 27, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=summary>Summary</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>This workshop provided hands-on experience with the following concepts:</p><ul><li>How to deploy the <strong>Splunk Distribution of the OpenTelemetry Collector</strong> on a Linux host.</li><li>How to instrument a .NET application with the <strong>Splunk Distribution of OpenTelemetry .NET</strong>.</li><li>How to &ldquo;dockerize&rdquo; a .NET application and instrument it with the <strong>Splunk Distribution of OpenTelemetry .NET</strong>.</li><li>How to deploy the <strong>Splunk Distribution of the OpenTelemetry Collector</strong> in a Kubernetes cluster using Helm.</li><li>How to customize the collector configuration and troubleshoot an issue.</li></ul><p>To see how other languages and environments are instrumented with OpenTelemetry,
explore the <a href=https://github.com/signalfx/splunk-opentelemetry-examples rel=external>Splunk OpenTelemetry Examples GitHub repository</a>.</p><p>To run this workshop on your own in the future, refer back to these instructions and use the <strong>Splunk4Rookies - Observability</strong>
workshop template in Splunk Show to provision an EC2 instance.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 10, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=solving-problems-with-o11y-cloud>Solving Problems with O11y Cloud</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Derek Mitchell</span></span><p>In this workshop, you&rsquo;ll get hands-on experience with the following:</p><ul><li>Deploy the <strong>OpenTelemetry Collector</strong> and customize the collector config</li><li>Deploy an application and instrument it with <strong>OpenTelemetry</strong></li><li>See how tags are captured using an <strong>OpenTelemetry SDK</strong></li><li>Create a <strong>Troubleshooting MetricSet</strong></li><li>Troubleshoot a problem and determine root cause using <strong>Tag Spotlight</strong></li></ul><p>Let&rsquo;s get started!</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Solving Problems with O11y Cloud</h1><article class=default><header class=headline></header><h1 id=connect-to-ec2-instance>Connect to EC2 Instance</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=connect-to-your-ec2-instance>Connect to your EC2 Instance</h2><p>Weâ€™ve prepared an Ubuntu Linux instance in AWS/EC2 for each attendee. Using the IP address and password provided by your instructor, connect to your EC2 instance using one of the methods below:</p><ul><li>macOS / Linux<ul><li><code>ssh splunk@IP address</code></li></ul></li><li>Windows 10+<ul><li>Use the OpenSSH client</li></ul></li><li>Earlier versions of Windows<ul><li>Use Putty</li></ul></li></ul><h2 id=editing-files>Editing Files</h2><p>We&rsquo;ll use <code>vi</code> to edit files during the workshop. Here&rsquo;s a quick primer.</p><p>To open a file for editing:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi &lt;filename&gt; </span></span></code></pre></div><ul><li>To edit the file, click <code>i</code> to switch to <strong>Insert mode</strong> and begin entering text as normal. Use <code>Esc</code> to return to <strong>Command mode</strong>.</li><li>To save your changes without exiting the editor, enter <code>Esc</code> to return to command mode then enter <code>:w</code>.</li><li>To exit the editor without saving changes, enter <code>Esc</code> to return to command mode then enter <code>:q!</code>.</li><li>To save your changes and exist the editor, enter <code>Esc</code> to return to command mode then enter <code>:wq</code>.</li></ul><p>See <a href=https://www.redhat.com/en/blog/introduction-vi-editor rel=external><strong>An introduction to the vi editor</strong></a> for a comprehensive introduction to <code>vi</code>.</p><p>If you&rsquo;d prefer using another editor, you can use <code>nano</code> instead:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano &lt;filename&gt; </span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Feb 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-opentelemetry-collector-and-customize-config>Deploy the OpenTelemetry Collector and Customize Config</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>The first step to &ldquo;getting data in&rdquo; is to deploy an OpenTelemetry collector, which receives and processes telemetry data in our environment before exporting it to Splunk Observability Cloud.</p><p>We&rsquo;ll be using Kubernetes for this workshop, and will deploy the collector in our K8s cluster using Helm.</p><h2 id=what-is-helm>What is Helm?</h2><p>Helm is a package manager for Kubernetes which provides the following benefits:</p><ul><li>Manage Complexity<ul><li>deal with a single values.yaml file rather than dozens of manifest files</li></ul></li><li>Easy Updates<ul><li>in-place upgrades</li></ul></li><li>Rollback support<ul><li>Just use helm rollback to roll back to an older version of a release</li></ul></li></ul><h2 id=install-the-collector-using-helm>Install the Collector using Helm</h2><p>Let&rsquo;s change into the correct directory and run a script to install the collector:</p><div class=tab-panel data-tab-group=R-tabs-b62703afacc7f6bba8fe8ef4e5e09794><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bc06d5a11c7e7ad7b0fd260a6dca11cc aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b62703afacc7f6bba8fe8ef4e5e09794","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-afbd0cdcc0f74cd98ebc6088e9dd8751 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b62703afacc7f6bba8fe8ef4e5e09794","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-bc06d5a11c7e7ad7b0fd260a6dca11cc data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/workshop/tagging
</span></span><span class=line><span class=cl>./1-deploy-otel-collector.sh</span></span></code></pre></div></div></div><div id=R-tab-id-afbd0cdcc0f74cd98ebc6088e9dd8751 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=s2>&#34;splunk-otel-collector-chart&#34;</span> has been added to your repositories
</span></span><span class=line><span class=cl>Hang tight <span class=k>while</span> we grab the latest from your chart repositories...
</span></span><span class=line><span class=cl>...Successfully got an update from the <span class=s2>&#34;splunk-otel-collector-chart&#34;</span> chart repository
</span></span><span class=line><span class=cl>Update Complete. âŽˆHappy Helming!âŽˆ
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Mon Dec <span class=m>23</span> 18:47:38 <span class=m>2024</span>
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: <span class=m>1</span>
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm us1.</span></span></code></pre></div></div></div></div></div><blockquote><p>Note that the script may take a minute or so to run.</p></blockquote><p>How did this script install the collector? It first ensured that the environment variables set in the <code>~./profile</code> file are read:</p><blockquote><p>Important: There is no need to run the following commands, as they were already run
by the <code>1-deploy-otel-collector.sh</code> script.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.profile</span></span></code></pre></div><p>It then installed the <code>splunk-otel-collector-chart</code> Helm chart and ensured it&rsquo;s up-to-date:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart
</span></span><span class=line><span class=cl>  helm repo update</span></span></code></pre></div><p>And finally, it used <code>helm install</code> to install the collector:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  helm install splunk-otel-collector --version 0.136.0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=tagging-workshop-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f otel/values.yaml</span></span></code></pre></div><blockquote><p>Note that the <code>helm install</code> command references a <code>values.yaml</code> file, which is used
to customize the collector configuration. We&rsquo;ll explore this is more detail below.</p></blockquote><h2 id=confirm-the-collector-is-running>Confirm the Collector is Running</h2><p>We can confirm whether the collector is running with the following command:</p><div class=tab-panel data-tab-group=R-tabs-f023da502252a589c2b18a74c421928f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2933497d9bdd587b85e93089adfaf7fa aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f023da502252a589c2b18a74c421928f","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-ad2d03bb00f4710088cff7177928d0b8 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-f023da502252a589c2b18a74c421928f","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-2933497d9bdd587b85e93089adfaf7fa data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods</span></span></code></pre></div></div></div><div id=R-tab-id-ad2d03bb00f4710088cff7177928d0b8 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                            READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-agent-kfvjb                               1/1     Running   <span class=m>0</span>          2m33s
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-7d89558bc9-2fqnx              1/1     Running   <span class=m>0</span>          2m33s
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-cainjector-796cc6bd76-hz4sp   1/1     Running   <span class=m>0</span>          2m33s
</span></span><span class=line><span class=cl>splunk-otel-collector-certmanager-webhook-6959cd5f8-qd5b6       1/1     Running   <span class=m>0</span>          2m33s
</span></span><span class=line><span class=cl>splunk-otel-collector-k8s-cluster-receiver-57569b58c8-8ghds     1/1     Running   <span class=m>0</span>          2m33s
</span></span><span class=line><span class=cl>splunk-otel-collector-operator-6fd9f9d569-wd5mn                 2/2     Running   <span class=m>0</span>          2m33s</span></span></code></pre></div></div></div></div></div><h2 id=confirm-your-k8s-cluster-is-in-o11y-cloud>Confirm your K8s Cluster is in O11y Cloud</h2><p>In Splunk Observability Cloud, navigate to <strong>Infrastructure</strong> â†’ <strong>Kubernetes</strong> â†’ <strong>Kubernetes Clusters</strong>,
and then search for your Cluster Name (which is <code>$INSTANCE-k3s-cluster</code>):</p><p><a href=#R-image-a4afbe9aab2135a94d6df4d3be266ce9 class=lightbox-link><img alt="Kubernetes node" class="lazy lightbox figure-image" loading=lazy src=../images/k8snode.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4afbe9aab2135a94d6df4d3be266ce9><img alt="Kubernetes node" class="lazy lightbox lightbox-image" loading=lazy src=../images/k8snode.png></a></p><h2 id=get-the-collector-configuration>Get the Collector Configuration</h2><p>Before we customize the collector config, how do we determine what the current configuration
looks like?</p><p>In a Kubernetes environment, the collector configuration is stored using a Config Map.</p><p>We can see which config maps exist in our cluster with the following command:</p><div class=tab-panel data-tab-group=R-tabs-9d1a6d1f260cb680f59fa4a6b6d5d375><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a72f9a6baab83d2eb5df342f9d38cd06 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9d1a6d1f260cb680f59fa4a6b6d5d375","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-c8e4b7fc977c1169834565f22893d726 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-9d1a6d1f260cb680f59fa4a6b6d5d375","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-a72f9a6baab83d2eb5df342f9d38cd06 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get cm -l <span class=nv>app</span><span class=o>=</span>splunk-otel-collector</span></span></code></pre></div></div></div><div id=R-tab-id-c8e4b7fc977c1169834565f22893d726 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                 DATA   AGE
</span></span><span class=line><span class=cl>splunk-otel-collector-otel-k8s-cluster-receiver   <span class=m>1</span>      3h37m
</span></span><span class=line><span class=cl>splunk-otel-collector-otel-agent                  <span class=m>1</span>      3h37m</span></span></code></pre></div></div></div></div></div><p>We can then view the config map of the collector agent as follows:</p><div class=tab-panel data-tab-group=R-tabs-d2a66a6c0a723f381f32956b6685ab73><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d5a8d8e7bba241b80382b494c2fa61a0 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-d2a66a6c0a723f381f32956b6685ab73","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-c5a3cb821239a59fe1184ef69fd5dddd aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-d2a66a6c0a723f381f32956b6685ab73","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d5a8d8e7bba241b80382b494c2fa61a0 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-agent</span></span></code></pre></div></div></div><div id=R-tab-id-c5a3cb821239a59fe1184ef69fd5dddd data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Name:         splunk-otel-collector-otel-agent
</span></span><span class=line><span class=cl>Namespace:    default
</span></span><span class=line><span class=cl>Labels:       <span class=nv>app</span><span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/instance<span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/managed-by<span class=o>=</span>Helm
</span></span><span class=line><span class=cl>              app.kubernetes.io/name<span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>              app.kubernetes.io/version<span class=o>=</span>0.113.0
</span></span><span class=line><span class=cl>              <span class=nv>chart</span><span class=o>=</span>splunk-otel-collector-0.113.0
</span></span><span class=line><span class=cl>              helm.sh/chart<span class=o>=</span>splunk-otel-collector-0.113.0
</span></span><span class=line><span class=cl>              <span class=nv>heritage</span><span class=o>=</span>Helm
</span></span><span class=line><span class=cl>              <span class=nv>release</span><span class=o>=</span>splunk-otel-collector
</span></span><span class=line><span class=cl>Annotations:  meta.helm.sh/release-name: splunk-otel-collector
</span></span><span class=line><span class=cl>              meta.helm.sh/release-namespace: default
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>Data</span>
</span></span><span class=line><span class=cl><span class=o>====</span>
</span></span><span class=line><span class=cl>relay:
</span></span><span class=line><span class=cl>----
</span></span><span class=line><span class=cl>exporters:
</span></span><span class=line><span class=cl>  otlphttp:
</span></span><span class=line><span class=cl>    headers:
</span></span><span class=line><span class=cl>      X-SF-Token: <span class=si>${</span><span class=nv>SPLUNK_OBSERVABILITY_ACCESS_TOKEN</span><span class=si>}</span>
</span></span><span class=line><span class=cl>    metrics_endpoint: https://ingest.us1.signalfx.com/v2/datapoint/otlp
</span></span><span class=line><span class=cl>    traces_endpoint: https://ingest.us1.signalfx.com/v2/trace/otlp
</span></span><span class=line><span class=cl>    <span class=o>(</span>followed by the rest of the collector config in yaml format<span class=o>)</span> </span></span></code></pre></div></div></div></div></div><h2 id=how-to-update-the-collector-configuration-in-k8s>How to Update the Collector Configuration in K8s</h2><p>We can customize the collector configuration in K8s using the <code>values.yaml</code> file.</p><blockquote><p>See <a href=https://github.com/signalfx/splunk-otel-collector-chart/blob/main/helm-charts/splunk-otel-collector/values.yaml rel=external>this file</a>
for a comprehensive list of customization options that are available in the <code>values.yaml</code> file.</p></blockquote><p>Let&rsquo;s look at an example.</p><h3 id=add-the-debug-exporter>Add the Debug Exporter</h3><p>Suppose we want to see the traces that are sent to the collector. We can use the debug exporter for this purpose, which can be helpful for troubleshooting OpenTelemetry related issues.</p><p>You can use <code>vi</code> or <code>nano</code> to edit the <code>values.yaml</code> file. We will show an example using vi:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /home/splunk/workshop/tagging/otel/values.yaml</span></span></code></pre></div><p>Add the debug exporter by copying and pasting the following text to the bottom of the <code>values.yaml</code> file:</p><blockquote><p>Press &lsquo;i&rsquo; to enter into insert mode in vi before adding the text below.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=c># NEW CONTENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span></span></span></code></pre></div><p>After these changes, the <code>values.yaml</code> file should include the following contents:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>splunkObservability</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>profilingEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>infrastructureMonitoringEventsEnabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>certmanager</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>operator</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>operatorcrds</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>install</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>agent</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>kubeletstats</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>insecure_skip_verify</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>auth_type</span><span class=p>:</span><span class=w> </span><span class=l>serviceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=l>${K8S_NODE_IP}:10250</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metric_groups</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>container</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>node</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>volume</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>k8s_api_config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>auth_type</span><span class=p>:</span><span class=w> </span><span class=l>serviceAccount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>extra_metadata_labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>container.id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>k8s.volume.type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>zpages</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=m>0.0.0.0</span><span class=p>:</span><span class=m>55679</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># NEW CONTENT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>debug</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>debug</span></span></span></code></pre></div><blockquote><p>To save your changes in vi, press the <code>esc</code> key to enter command mode, then type <code>:wq!</code> followed by pressing the
<code>enter/return</code> key.</p></blockquote><p>Once the file is saved, we can apply the changes with:</p><div class=tab-panel data-tab-group=R-tabs-bfbceae2f34a75c4a887858f5cc59718><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-67aa0ed3dffee71d531e4fc6a5f02ebc aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-bfbceae2f34a75c4a887858f5cc59718","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-08929a159faec9040c18a65de707a78d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-bfbceae2f34a75c4a887858f5cc59718","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-67aa0ed3dffee71d531e4fc6a5f02ebc data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/splunk/workshop/tagging
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>helm upgrade splunk-otel-collector  <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$INSTANCE</span><span class=s2>-k3s-cluster&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>--set<span class=o>=</span><span class=s2>&#34;environment=tagging-workshop-</span><span class=nv>$INSTANCE</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>splunk-otel-collector-chart/splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-f otel/values.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-08929a159faec9040c18a65de707a78d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Release <span class=s2>&#34;splunk-otel-collector&#34;</span> has been upgraded. Happy Helming!
</span></span><span class=line><span class=cl>NAME: splunk-otel-collector
</span></span><span class=line><span class=cl>LAST DEPLOYED: Mon Dec <span class=m>23</span> 19:08:08 <span class=m>2024</span>
</span></span><span class=line><span class=cl>NAMESPACE: default
</span></span><span class=line><span class=cl>STATUS: deployed
</span></span><span class=line><span class=cl>REVISION: <span class=m>2</span>
</span></span><span class=line><span class=cl>NOTES:
</span></span><span class=line><span class=cl>Splunk OpenTelemetry Collector is installed and configured to send data to Splunk Observability realm us1.</span></span></code></pre></div></div></div></div></div><p>Whenever a change to the collector config is made via a <code>values.yaml</code> file, it&rsquo;s helpful
to review the actual configuration applied to the collector by looking at the config map:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe cm splunk-otel-collector-otel-agent</span></span></code></pre></div><p>We can see that the debug exporter was added to the traces pipeline, as desired:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>debug</span></span></span></code></pre></div><p>We&rsquo;ll explore the output of the debug exporter once we deploy an application
in our cluster and start capturing traces.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 21, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-sample-application-and-instrument-with-opentelemetry>Deploy the Sample Application and Instrument with OpenTelemetry</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>At this point, we&rsquo;ve deployed an OpenTelemetry collector in our K8s cluster, and it&rsquo;s
successfully collecting infrastructure metrics.</p><p>The next step is to deploy a sample application and instrument
with OpenTelemetry to capture traces.</p><p>We&rsquo;ll use a microservices-based application written in Python. To keep the workshop simple,
we&rsquo;ll focus on two services: a credit check service and a credit processor service.</p><h2 id=deploy-the-application>Deploy the Application</h2><p>To save time, we&rsquo;ve built Docker images for both of these services already which are available in Docker Hub.
We can deploy the credit check service in our K8s cluster with the following command:</p><div class=tab-panel data-tab-group=R-tabs-9772dad9f51267a8185ca76de4d61d77><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-62bcf194eddc63046fdfd85671145d3f aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9772dad9f51267a8185ca76de4d61d77","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-2b374cda4cafb89d7e163db5d48c7ad5 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-9772dad9f51267a8185ca76de4d61d77","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-62bcf194eddc63046fdfd85671145d3f data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f /home/splunk/workshop/tagging/creditcheckservice-py-with-tags/creditcheckservice-dockerhub.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-2b374cda4cafb89d7e163db5d48c7ad5 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/creditcheckservice created
</span></span><span class=line><span class=cl>service/creditcheckservice created</span></span></code></pre></div></div></div></div></div><p>Next, let&rsquo;s deploy the credit processor service:</p><div class=tab-panel data-tab-group=R-tabs-0e2c532ebc182e709fddefd610ca9fae><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-89edd33bb296c47a4db2f57bf5e4f0bc aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-0e2c532ebc182e709fddefd610ca9fae","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-977c85837a0d5d834aaf9122ca7af4c2 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-0e2c532ebc182e709fddefd610ca9fae","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-89edd33bb296c47a4db2f57bf5e4f0bc data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f /home/splunk/workshop/tagging/creditprocessorservice/creditprocessorservice-dockerhub.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-977c85837a0d5d834aaf9122ca7af4c2 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/creditprocessorservice created
</span></span><span class=line><span class=cl>service/creditprocessorservice created</span></span></code></pre></div></div></div></div></div><p>Finally, let&rsquo;s deploy a load generator to generate traffic:</p><div class=tab-panel data-tab-group=R-tabs-156a3dc0d08bdf1d1be51bff23d49b1d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f73dcc90021c8bd445ba0affa6b1d3bc aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-156a3dc0d08bdf1d1be51bff23d49b1d","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-397f52ea9013986a4ffdcd3b35a08431 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-156a3dc0d08bdf1d1be51bff23d49b1d","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-f73dcc90021c8bd445ba0affa6b1d3bc data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f /home/splunk/workshop/tagging/loadgenerator/loadgenerator-dockerhub.yaml</span></span></code></pre></div></div></div><div id=R-tab-id-397f52ea9013986a4ffdcd3b35a08431 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>deployment.apps/loadgenerator created</span></span></code></pre></div></div></div></div></div><h2 id=explore-the-application>Explore the Application</h2><p>We&rsquo;ll provide an overview of the application in this section. If you&rsquo;d like to see the complete source
code for the application, refer to the <a href=https://github.com/splunk/observability-workshop/tree/main/workshop/tagging rel=external>Observability Workshop repository in GitHub</a></p><h3 id=opentelemetry-instrumentation>OpenTelemetry Instrumentation</h3><p>If we look at the Dockerfile&rsquo;s used to build the credit check and credit processor services, we
can see that they&rsquo;ve already been instrumented with OpenTelemetry. For example, let&rsquo;s look at
<code>/home/splunk/workshop/tagging/creditcheckservice-py-with-tags/Dockerfile</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> python:3.11-slim</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Set working directory</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>WORKDIR</span><span class=s> /app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy requirements over</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> requirements.txt .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> apt-get update <span class=o>&amp;&amp;</span> apt-get install --yes gcc python3-dev<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENV</span> <span class=nv>PIP_ROOT_USER_ACTION</span><span class=o>=</span>ignore
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Install Python dependencies</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> pip install --no-cache-dir -r requirements.txt<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Copy main app</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> main.py .<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Bootstrap OTel</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> splunk-py-trace-bootstrap<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># Set the entrypoint command to run the application</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>CMD</span> <span class=p>[</span><span class=s2>&#34;splunk-py-trace&#34;</span><span class=p>,</span> <span class=s2>&#34;python3&#34;</span><span class=p>,</span> <span class=s2>&#34;main.py&#34;</span><span class=p>]</span></span></span></code></pre></div><p>We can see that <code>splunk-py-trace-bootstrap</code> was included, which installs OpenTelemetry instrumentation
for supported packages used by our applications. We can also see that <code>splunk-py-trace</code> is used as part
of the command to start the application.</p><p>And if we review the <code>/home/splunk/workshop/tagging/creditcheckservice-py-with-tags/requirements.txt</code> file,
we can see that <code>splunk-opentelemetry[all]</code> was included in the list of packages.</p><p>Finally, if we review the Kubernetes manifest that we used to deploy this service (<code>/home/splunk/workshop/tagging/creditcheckservice-py-with-tags/creditcheckservice-dockerhub.yaml</code>),
we can see that environment variables were set in the container to tell OpenTelemetry
where to export OTLP data to:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>env</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>PORT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;8888&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>NODE_IP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>valueFrom</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>fieldRef</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>fieldPath</span><span class=p>:</span><span class=w> </span><span class=l>status.hostIP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_EXPORTER_OTLP_ENDPOINT</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://$(NODE_IP):4317&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_SERVICE_NAME</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;creditcheckservice&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>OTEL_PROPAGATORS</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;tracecontext,baggage&#34;</span></span></span></code></pre></div><p>This is all that&rsquo;s needed to instrument the service with OpenTelemetry!</p><h3 id=explore-the-application-1>Explore the Application</h3><p>We&rsquo;ve captured several custom tags with our application, which we&rsquo;ll explore shortly. Before we do that, let&rsquo;s
introduce the concept of tags and why they&rsquo;re important.</p><h3 id=what-are-tags>What are tags?</h3><p>Tags are key-value pairs that provide additional metadata about spans in a trace, allowing you to enrich the context of the spans you send to <strong>Splunk APM</strong>.</p><p>For example, a payment processing application would find it helpful to track:</p><ul><li>The payment type used (i.e. credit card, gift card, etc.)</li><li>The ID of the customer that requested the payment</li></ul><p>This way, if errors or performance issues occur while processing the payment, we have the context we need for troubleshooting.</p><p>While some tags can be added with the OpenTelemetry collector, the ones weâ€™ll be working with in this workshop are more granular, and are added by application developers using the OpenTelemetry SDK.</p><h3 id=why-are-tags-so-important>Why are tags so important?</h3><p>Tags are essential for an application to be truly observable. They add the context to the traces to help us
understand why some users get a great experience and others don&rsquo;t. And powerful features in
<strong>Splunk Observability Cloud</strong> utilize tags to help you jump quickly to root cause.</p><blockquote><p>A note about terminology before we proceed. While we discuss <strong>tags</strong> in this workshop,
and this is the terminology we use in <strong>Splunk Observability Cloud</strong>, OpenTelemetry
uses the term <strong>attributes</strong> instead. So when you see tags mentioned throughout this
workshop, you can treat them as synonymous with attributes.</p></blockquote><h3 id=how-are-tags-captured>How are tags captured?</h3><p>To capture tags in a Python application, we start by importing the trace module by adding an
import statement to the top of the <code>/home/splunk/workshop/tagging/creditcheckservice-py-with-tags/main.py</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>flask</span> <span class=kn>import</span> <span class=n>Flask</span><span class=p>,</span> <span class=n>request</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>waitress</span> <span class=kn>import</span> <span class=n>serve</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>opentelemetry</span> <span class=kn>import</span> <span class=n>trace</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl><span class=o>...</span></span></span></code></pre></div><p>Next, we need to get a reference to the current span so we can add an attribute (aka tag) to it:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>credit_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_current_span</span><span class=p>()</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>    <span class=n>customerNum</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;customernum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;customer.num&#34;</span><span class=p>,</span> <span class=n>customerNum</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl><span class=o>...</span></span></span></code></pre></div><p>That was pretty easy, right? We&rsquo;ve captured a total of four tags in the credit check service, with the final result looking like this:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>credit_check</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span> <span class=o>=</span> <span class=n>trace</span><span class=o>.</span><span class=n>get_current_span</span><span class=p>()</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>    <span class=n>customerNum</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>args</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;customernum&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;customer.num&#34;</span><span class=p>,</span> <span class=n>customerNum</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get Credit Score</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/getScore?customernum=&#34;</span> <span class=o>+</span> <span class=n>customerNum</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>creditScore</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>creditScoreReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.score&#34;</span><span class=p>,</span> <span class=n>creditScore</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>creditScoreCategory</span> <span class=o>=</span> <span class=n>getCreditCategoryFromScore</span><span class=p>(</span><span class=n>creditScore</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.score.category&#34;</span><span class=p>,</span> <span class=n>creditScoreCategory</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Run Credit Check</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&#34;http://creditprocessorservice:8899/runCreditCheck?customernum=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>customerNum</span><span class=p>)</span> <span class=o>+</span> <span class=s2>&#34;&amp;score=&#34;</span> <span class=o>+</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditScore</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>creditCheckReq</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>checkResult</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>creditCheckReq</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>current_span</span><span class=o>.</span><span class=n>set_attribute</span><span class=p>(</span><span class=s2>&#34;credit.check.result&#34;</span><span class=p>,</span> <span class=n>checkResult</span><span class=p>)</span>  <span class=c1># &lt;--- ADDED BY WORKSHOP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>checkResult</span></span></span></code></pre></div><h2 id=review-trace-data>Review Trace Data</h2><p>Before looking at the trace data in Splunk Observability Cloud,
let&rsquo;s review what the debug exporter has captured by tailing the agent collector logs with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=nv>component</span><span class=o>=</span>otel-collector-agent -f</span></span></code></pre></div><p>Hint: use <code>CTRL+C</code> to stop tailing the logs.</p><p>You should see traces written to the agent collector logs such as the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>InstrumentationScope opentelemetry.instrumentation.flask 0.44b0
Span #0
    Trace ID       : 9f9fc109903f25ba57bea9b075aa4833
    Parent ID      : 
    ID             : 6d71519f454f6059
    Name           : /check
    Kind           : Server
    Start time     : 2024-12-23 19:55:25.815891965 +0000 UTC
    End time       : 2024-12-23 19:55:27.824664949 +0000 UTC
    Status code    : Unset
    Status message : 
Attributes:
     -&gt; http.method: Str(GET)
     -&gt; http.server_name: Str(waitress.invalid)
     -&gt; http.scheme: Str(http)
     -&gt; net.host.port: Int(8888)
     -&gt; http.host: Str(creditcheckservice:8888)
     -&gt; http.target: Str(/check?customernum=30134241)
     -&gt; net.peer.ip: Str(10.42.0.19)
     -&gt; http.user_agent: Str(python-requests/2.31.0)
     -&gt; net.peer.port: Str(47248)
     -&gt; http.flavor: Str(1.1)
     -&gt; http.route: Str(/check)
     -&gt; customer.num: Str(30134241)
     -&gt; credit.score: Int(443)
     -&gt; credit.score.category: Str(poor)
     -&gt; credit.check.result: Str(OK)
     -&gt; http.status_code: Int(200)</code></pre></div><p>Notice how the trace includes the tags (aka attributes) that we captured in the code, such as
<code>credit.score</code> and <code>credit.score.category</code>. We&rsquo;ll use these in the next section, when
we analyze the traces in Splunk Observability Cloud to find the root cause of a performance issue.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 16, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-a-troubleshooting-metricset>Create a Troubleshooting MetricSet</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=index-tags>Index Tags</h2><p>To use advanced features in <strong>Splunk Observability Cloud</strong> such as <strong>Tag Spotlight</strong>, we&rsquo;ll need to first index one or more tags.</p><p>To do this, navigate to <strong>Settings</strong> -> <strong>MetricSets</strong> and ensure the <strong>APM</strong> tab is selected. Then click the <strong>+ Add Custom MetricSet</strong> button.</p><p>Let&rsquo;s index the <code>credit.score.category</code> tag by entering the following details (<strong>note</strong>: since everyone in the workshop is using the same organization, the instructor will do this step on your behalf):</p><p><a href=#R-image-56bd49144562292e96378586cbb1d7b6 class=lightbox-link><img alt="Create Troubleshooting MetricSet" class="lazy lightbox figure-image" loading=lazy src=../images/create_troubleshooting_metric_set.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-56bd49144562292e96378586cbb1d7b6><img alt="Create Troubleshooting MetricSet" class="lazy lightbox lightbox-image" loading=lazy src=../images/create_troubleshooting_metric_set.png></a></p><p>Click <strong>Start Analysis</strong> to proceed.</p><p>The tag will appear in the list of <strong>Pending MetricSets</strong> while analysis is performed.</p><p><a href=#R-image-e31ac4d9837bc6892cc52837b917b2c3 class=lightbox-link><img alt="Pending MetricSets" class="lazy lightbox figure-image" loading=lazy src=../images/pending_metric_set.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e31ac4d9837bc6892cc52837b917b2c3><img alt="Pending MetricSets" class="lazy lightbox lightbox-image" loading=lazy src=../images/pending_metric_set.png></a></p><p>Once analysis is complete, click on the checkmark in the <strong>Actions</strong> column.</p><h2 id=troubleshooting-vs-monitoring-metricsets>Troubleshooting vs. Monitoring MetricSets</h2><p>You may have noticed that, to index this tag, we created something called a <strong>Troubleshooting MetricSet</strong>. It&rsquo;s named this way because a Troubleshooting MetricSet, or TMS, allows us to troubleshoot issues with this tag using features such as <strong>Tag Spotlight</strong>.</p><p>You may have also noticed that there&rsquo;s another option which we didn&rsquo;t choose called a <strong>Monitoring MetricSet</strong> (or MMS). Monitoring MetricSets go beyond troubleshooting and allow us to use tags for alerting and dashboards. While we won&rsquo;t be
exploring this capability as part of this workshop, it&rsquo;s a powerful feature that I encourage you to explore on your own.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 10, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=troubleshoot-a-problem-using-tag-spotlight>Troubleshoot a Problem Using Tag Spotlight</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<h2 id=explore-apm-data>Explore APM Data</h2><p>Let&rsquo;s explore some of the APM data we&rsquo;ve captured to see how our application is performing.</p><p>Navigate to <strong>APM</strong>, then use the <strong>Environment</strong> dropdown to select your environment (i.e. <code>tagging-workshop-instancename</code>).</p><p>You should see <code>creditprocessorservice</code> and <code>creditcheckservice</code> displayed in the list of services:</p><p><a href=#R-image-815beedbb2de841b20fe76204d277c4d class=lightbox-link><img alt="APM Overview" class="lazy lightbox figure-image" loading=lazy src=../images/apm_overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-815beedbb2de841b20fe76204d277c4d><img alt="APM Overview" class="lazy lightbox lightbox-image" loading=lazy src=../images/apm_overview.png></a></p><p>Click on <strong>Service Map</strong> on the right-hand side to view the service map. We can see that the <code>creditcheckservice</code> makes calls to the <code>creditprocessorservice</code>, with an average response time of at least 3 seconds:</p><p><a href=#R-image-b82c694b8f1f1d0992437db9441510e3 class=lightbox-link><img alt="Service Map" class="lazy lightbox figure-image" loading=lazy src=../images/service_map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b82c694b8f1f1d0992437db9441510e3><img alt="Service Map" class="lazy lightbox lightbox-image" loading=lazy src=../images/service_map.png></a></p><p>Next, click on <strong>Traces</strong> on the right-hand side to see the traces captured for this application. You&rsquo;ll see that some traces run relatively fast (i.e. just a few milliseconds), whereas others take a few seconds.</p><p><a href=#R-image-d9dc0932956509d906c63ea0daa27c9c class=lightbox-link><img alt=Traces class="lazy lightbox figure-image" loading=lazy src=../images/traces.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d9dc0932956509d906c63ea0daa27c9c><img alt=Traces class="lazy lightbox lightbox-image" loading=lazy src=../images/traces.png></a></p><p>Click on one of the longer running traces. In this example, the trace took five seconds, and we can see that most of the time was spent calling the <code>/runCreditCheck</code> operation, which is part of the <code>creditprocessorservice</code>:</p><p><a href=#R-image-426443f53c89a0d5d50886fa4d7889aa class=lightbox-link><img alt="Long Running Trace" class="lazy lightbox figure-image" loading=lazy src=../images/long_running_trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-426443f53c89a0d5d50886fa4d7889aa><img alt="Long Running Trace" class="lazy lightbox lightbox-image" loading=lazy src=../images/long_running_trace.png></a></p><p>But why are some traces slow, and others are relatively quick?</p><p>Close the trace and return to the Trace Analyzer. If you toggle <strong>Errors only</strong> to <code>on</code>, you&rsquo;ll also notice that some traces have errors:</p><p><a href=#R-image-7e2137d40aa756866c86e7dd9e9f87ca class=lightbox-link><img alt=Traces class="lazy lightbox figure-image" loading=lazy src=../images/traces_with_errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7e2137d40aa756866c86e7dd9e9f87ca><img alt=Traces class="lazy lightbox lightbox-image" loading=lazy src=../images/traces_with_errors.png></a></p><p>If we look at one of the error traces, we can see that the error occurs when the <code>creditprocessorservice</code> attempts to call another service named <code>otherservice</code>. But why do some requests result in a call to <code>otherservice</code>, and others don&rsquo;t?</p><p><a href=#R-image-34c51e6e519f76ff155c6c64ec8940a8 class=lightbox-link><img alt="Trace with Errors" class="lazy lightbox figure-image" loading=lazy src=../images/error_trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-34c51e6e519f76ff155c6c64ec8940a8><img alt="Trace with Errors" class="lazy lightbox lightbox-image" loading=lazy src=../images/error_trace.png></a></p><p>To determine why some requests perform slowly, and why some requests result in errors, we could look through the
traces one by one and try to find a pattern behind the issues.</p><p><strong>Splunk Observability Cloud</strong> provides a better way to find the root cause of an issue. We&rsquo;ll explore this next.</p><h2 id=using-tag-spotlight>Using Tag Spotlight</h2><p>Since we indexed the <code>credit.score.category</code> tag, we can use it with <strong>Tag Spotlight</strong> to troubleshoot our application.</p><p>Navigate to <strong>APM</strong> then click on <strong>Tag Spotlight</strong> on the right-hand side. Ensure the <code>creditcheckservice</code> service is selected from the <strong>Service</strong> drop-down (if not already selected).</p><p>With <strong>Tag Spotlight</strong>, we can see 100% of credit score requests that result in a score of <code>impossible</code> have an error, yet requests for all other credit score types have no errors at all!</p><p><strong><a href=#R-image-eff0299194dd5bd364bf478e586a3231 class=lightbox-link><img alt="Tag Spotlight with Errors" class="lazy lightbox figure-image" loading=lazy src=../images/tag_spotlight_errors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eff0299194dd5bd364bf478e586a3231><img alt="Tag Spotlight with Errors" class="lazy lightbox lightbox-image" loading=lazy src=../images/tag_spotlight_errors.png></a></strong></p><p>This illustrates the power of <strong>Tag Spotlight</strong>! Finding this pattern would be time-consuming without it, as we&rsquo;d have to manually look through hundreds of traces to identify the pattern (and even then, there&rsquo;s no guarantee we&rsquo;d find it).</p><p>We&rsquo;ve looked at errors, but what about latency? Let&rsquo;s click on the <strong>Requests & errors distribution</strong> dropdown and change it to <strong>Latency distribution</strong>.</p><blockquote><p>IMPORTANT: Click on the settings icon beside <strong>Cards display</strong> to add the P50 and P99 metrics.</p></blockquote><p>Here, we can see that the requests with a <code>poor</code> credit score request are running slowly, with P50, P90, and P99 times of around 3 seconds, which is too long for our users to wait, and much slower than other requests.</p><p>We can also see that some requests with an <code>exceptional</code> credit score request are running slowly, with P99 times of around 5 seconds, though the P50 response time is relatively quick.</p><p><strong><a href=#R-image-f8083a07c78234ea0f15019e85e50cf1 class=lightbox-link><img alt="Tag Spotlight with Latency" class="lazy lightbox figure-image" loading=lazy src=../images/tag_spotlight_latency.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f8083a07c78234ea0f15019e85e50cf1><img alt="Tag Spotlight with Latency" class="lazy lightbox lightbox-image" loading=lazy src=../images/tag_spotlight_latency.png></a></strong></p><h2 id=using-dynamic-service-maps>Using Dynamic Service Maps</h2><p>Now that we know the credit score category associated with the request can impact performance and error rates, let&rsquo;s explore another feature that utilizes indexed tags: <strong>Dynamic Service Maps</strong>.</p><p>With Dynamic Service Maps, we can breakdown a particular service by a tag. For example, let&rsquo;s click on <strong>APM</strong>, then click <strong>Service Map</strong> to view the service map.</p><p>Click on <code>creditcheckservice</code>. Then, on the right-hand menu, click on the drop-down that says <strong>Breakdown</strong>, and select the <code>credit.score.category</code> tag.</p><p>At this point, the service map is updated dynamically, and we can see the performance of requests hitting <code>creditcheckservice</code> broken down by the credit score category:</p><p><strong><a href=#R-image-f71750bea571904ada2069544401f502 class=lightbox-link><img alt="Service Map Breakdown" class="lazy lightbox figure-image" loading=lazy src=../images/service_map_breakdown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f71750bea571904ada2069544401f502><img alt="Service Map Breakdown" class="lazy lightbox lightbox-image" loading=lazy src=../images/service_map_breakdown.png></a></strong></p><p>This view makes it clear that performance for <code>good</code> and <code>fair</code> credit scores is excellent, while <code>poor</code> and <code>exceptional</code> scores are much slower, and <code>impossible</code> scores result in errors.</p><h2 id=our-findings>Our Findings</h2><p><strong>Tag Spotlight</strong> has uncovered several interesting patterns for the engineers that own this service to explore further:</p><ul><li>Why are all the <code>impossible</code> credit score requests resulting in error?</li><li>Why are all the <code>poor</code> credit score requests running slowly?</li><li>Why do some of the <code>exceptional</code> requests run slowly?</li></ul><p>As an SRE, passing this context to the engineering team would be extremely helpful for their investigation, as it would allow them to track down the issue much more quickly than if we simply told them that the service was &ldquo;sometimes slow&rdquo;.</p><p>If you&rsquo;re curious, have a look at the source code for the <code>creditprocessorservice</code>. You&rsquo;ll see that requests with impossible, poor, and exceptional credit scores are handled differently, thus resulting in the differences in error rates and latency that we uncovered.</p><p>The behavior we saw with our application is typical for modern cloud-native applications, where different inputs passed to a service lead to different code paths, some of which result in slower performance or errors. For example, in a real credit check service, requests resulting in low credit scores may be sent to another downstream service to further evaluate risk, and may perform more slowly than requests resulting in higher scores, or encounter higher error rates.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Feb 5, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=summary>Summary</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>This workshop provided hands-on experience with the following concepts:</p><ul><li>How to deploy the <strong>Splunk Distribution of the OpenTelemetry Collector</strong> using Helm.</li><li>How instrument an application with <a href=https://opentelemetry.io rel=external><strong>OpenTelemetry</strong></a>.</li><li>How to capture tags of interest from your application using an OpenTelemetry SDK.</li><li>How to index tags in <strong>Splunk Observability Cloud</strong> using <strong>Troubleshooting MetricSets</strong>.</li><li>How to utilize tags in <strong>Splunk Observability Cloud</strong> to find â€œunknown unknownsâ€ using the <strong>Tag Spotlight</strong> and <strong>Dynamic Service Map</strong> features.</li></ul><p>Collecting tags aligned with the best practices shared in this workshop will let you get even more value from the data youâ€™re sending to <strong>Splunk Observability Cloud</strong>. Now that youâ€™ve completed this workshop, you have the knowledge you need to start collecting tags from your own applications!</p><p>To get started with capturing tags today, check out <a href=https://docs.splunk.com/observability/en/apm/span-tags/add-context-trace-span.html#instrument-your-application-code-to-add-tags-to-spans rel=external>how to add tags in various supported languages</a>, and then <a href=https://docs.splunk.com/observability/en/apm/span-tags/index-span-tags.html#apm-index-span-tags rel=external>how to use them to create Troubleshooting MetricSets</a> so they can be analyzed in Tag Spotlight. For more help, feel free to <a href=https://www.splunk.com/en_us/about-splunk/contact-us.html rel=external>ask a Splunk Expert</a>.</p><p>And to see how other languages and environments are instrumented with OpenTelemetry,
explore the <a href=https://github.com/signalfx/splunk-opentelemetry-examples rel=external>Splunk OpenTelemetry Examples GitHub repository</a>.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip for Workshop Facilitator(s)</summary><div class=box-content><p>Once the workshop is complete, remember to delete the APM MetricSet you created earlier for the <code>credit.score.category</code> tag.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Dec 23, 2024</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=ingest-processor-for-observability-cloud>Ingest Processor for Observability Cloud</h1><span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Tim Hard</span></span><p>As infrastructure and application environments become exceedingly complex, the volume of data they generate continues to grow significantly. This increase in data volume and variety makes it challenging to gain actionable insights and can impact problem identification and troubleshooting efficiencies. Additionally, the cost of storing and accessing this data can skyrocket. Many data sources, particularly logs and events, provide critical visibility into system operations. However, in most cases, only a few details from these extensive logs are actually needed for effective monitoring and alerting.</p><p><strong>Common Challenges:</strong></p><ul><li>Increasing complexity of infrastructure and application environments.</li><li>Significant growth in data volume generated by these environments.</li><li>Challenges in gaining actionable insights from large volumes of data.</li><li>High costs associated with storing and accessing extensive data.</li><li>Logs and events provide critical visibility but often contain only a few essential details.</li></ul><p>To address these challenges, Splunk Ingest Processor provides a powerful new feature: the ability to convert log events into metrics. Metrics are more efficient to store and process, allowing for faster identification of issues, thereby reducing Mean Time to Detection (MTTD). When retaining the original log or event is necessary, they can be stored in cheaper storage solutions such as S3, reducing the overall cost of data ingestion and computation required for searching them.</p><p><strong>Solution:</strong></p><ul><li>Convert log events into metrics where possible.</li><li>Retain original logs or events in cheaper storage solutions if needed.</li><li>Utilize federated search for accessing and analyzing retained logs.</li></ul><p><strong>Outcomes:</strong></p><ul><li>Metrics are more efficient to store and process.</li><li>Faster identification of problems, reducing Mean Time to Detection (MTTD).</li><li>Lower overall data ingestion and computation costs.</li><li>Enhanced monitoring efficiency and resource optimization.</li><li>Maintain high visibility into system operations with reduced operational costs.</li></ul><p>In this workshop you&rsquo;ll have the opportunity to get hands on with Ingest Processor and Splunk Observability Cloud to see how it can be used to address the challenges outlined above.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Ingest Processor for Observability Cloud</h1><article class=default><header class=headline></header><h1 id=getting-started>Getting Started</h1><p>During this <em><strong>technical</strong></em> Ingest Processor<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> for Splunk Observability Cloud workshop you will have the opportunity to get hands-on with Ingest Processor in Splunk Enterprise Cloud.</p><p>To simplify the workshop modules, a pre-configured Splunk Enterprise Cloud instance is provided.</p><p>The instance is pre-configured with all the requirements for creating an Ingest Processor pipeline.</p><p>This workshop will introduce you to the benefits of using Ingest Processor to convert robust logs to metrics and send those metrics to Splunk Observability Cloud. By the end of these technical workshops, you will have a good understanding of some key features and capabilities of Ingest Processor in Splunk Enterprise Cloud and the value of using Splunk Observability Cloud as a destination within an Ingest Processor pipeline.</p><p>Here are the instructions on how to access your pre-configured <a href=/observability-workshop/en/ninja-workshops/11-ingest-processor-for-observability-cloud/1-getting-started/1-access-cloud-instances/index.html>Splunk Enterprise Cloud</a> instance.</p><p><a href=#R-image-04aac2513193358120ee237ceff2c1f3 class=lightbox-link><img alt="Splunk Ingest Processor Architecture" class="lazy lightbox figure-image" loading=lazy src=../images/IngestProcessor-architecture-diagram_release_updated2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-04aac2513193358120ee237ceff2c1f3><img alt="Splunk Ingest Processor Architecture" class="lazy lightbox lightbox-image" loading=lazy src=../images/IngestProcessor-architecture-diagram_release_updated2.png></a></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://docs.splunk.com/Documentation/SplunkCloud/9.3.2408/IngestProcessor/AboutIngestProcessorSolution rel=external><strong>Ingest Processor</strong></a> is a data processing capability that works within your Splunk Cloud Platform deployment. Use the Ingest Processor to configure data flows, control data format, apply transformation rules prior to indexing, and route to destinations.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 1. Getting Started</h1><article class=default><header class=headline></header><h1 id=how-to-connect-to-your-workshop-environment>How to connect to your workshop environment</h1><ol><li>How to retrieve the URL for your Splunk Enterprise Cloud instances.</li><li>How to access the Splunk Observability Cloud workshop organization.</li></ol><hr><h2 id=1-splunk-cloud-instances>1. Splunk Cloud Instances</h2><p>There are three instances that will be used throughout this workshop which have already been provisioned for you:</p><ol><li>Splunk Enterprise Cloud</li><li>Splunk Ingest Processor (SCS Tenant)</li><li>Splunk Observability Cloud</li></ol><p>The Splunk Enterprise Cloud and Ingest Processor instances are hosted in <a href=https://show.splunk.com rel=external>Splunk Show</a>. If you were invited to the workshop, you should have received an email with an invite to the event in <a href=https://show.splunk.com rel=external>Splunk Show</a> or a link to the event will have been provided at the beginning of the workshop.</p><p>Login to Splunk Show using your <a href=https://login.splunk.com/ rel=external>splunk.com</a> credentials. You should see the event for this workshop. Open the event to see the instance details for your Splunk Cloud and Ingest Processor instances.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p>Take note of the <code>User Id</code> provided in your Splunk Show event details. This number will be included in the <code>sourcetype</code> that you will use for searching and filtering the Kubernetes data. Because this is a shared environment only use the participant number provided so that other participants data is not effected.</p></div></details><p><a href=#R-image-adae56c71ef61c79478609d0f9d4f61a class=lightbox-link><img alt="Splunk Show Instance Information" class="lazy lightbox figure-image" loading=lazy src=../../images/show_instance_information.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-adae56c71ef61c79478609d0f9d4f61a><img alt="Splunk Show Instance Information" class="lazy lightbox lightbox-image" loading=lazy src=../../images/show_instance_information.png></a></p><h2 id=2-splunk-observability-cloud-instances>2. Splunk Observability Cloud Instances</h2><p>You should have also received an email to access the Splunk Observability Cloud workshop organization (You may need to check your spam folder). If you have not received an email, let your workshop instructor know. To access the environment click the <strong>Join Now</strong> button.</p><p><a href=#R-image-68c580a47f70f952261ebdee4588344f class=lightbox-link><img alt="Splunk Observability Cloud Invitation" class="lazy lightbox figure-image" loading=lazy src=../../images/workshop_invitation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-68c580a47f70f952261ebdee4588344f><img alt="Splunk Observability Cloud Invitation" class="lazy lightbox lightbox-image" loading=lazy src=../../images/workshop_invitation.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Important</summary><div class=box-content><p>If you access the event before the workshop start time, your instances may not be available yet. Don&rsquo;t worry, they will be provided once the workshop begins.</p></div></details><p>Additionally, you have been invited to a Splunk Observability Cloud workshop organization. The invitation includes a link to the environment. If you don&rsquo;t have a Splunk Observability Cloud account already, you will be asked to create one. If you already have one, you can log in to the instance and, you will see the workshop organization in your available organizations.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=how-ingest-processor-works>How Ingest Processor Works</h1><h6 id=system-architecture>System architecture</h6><p>The primary components of the Ingest Processor service include the Ingest Processor service and SPL2 pipelines that support data processing. The following diagram provides an overview of how the components of the Ingest Processor solution work together:</p><p><a href=#R-image-898b87870e4ffd3d5d103d6f21a9c53f class=lightbox-link><img alt="Splunk Ingest Processor Architecture" class="lazy lightbox figure-image" loading=lazy src=../images/IngestProcessor-architecture-diagram_release_updated2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-898b87870e4ffd3d5d103d6f21a9c53f><img alt="Splunk Ingest Processor Architecture" class="lazy lightbox lightbox-image" loading=lazy src=../images/IngestProcessor-architecture-diagram_release_updated2.png></a></p><h6 id=ingest-processor-service>Ingest Processor service</h6><p>The Ingest Processor service is a cloud service hosted by Splunk. It is part of the data management experience, which is a set of services that fulfill a variety of data ingest and processing use cases.</p><p>You can use the Ingest Processor service to do the following:</p><ul><li>Create and apply SPL2 pipelines that determine how each Ingest Processor processes and routes the data that it receives.</li><li>Define source types to identify the kind of data that you want to process and determine how the Ingest Processor breaks and merges that data into distinct events.</li><li>Create connections to the destinations that you want your Ingest Processor to send processed data to.</li></ul><h6 id=pipelines>Pipelines</h6><p>A pipeline is a set of data processing instructions written in SPL2. When you create a pipeline, you write a specialized SPL2 statement that specifies which data to process, how to process it, and where to send the results. When you apply a pipeline, the Ingest Processor uses those instructions to process all the data that it receives from data sources such as Splunk forwarders, HTTP clients, and logging agents.</p><p>Each pipeline selects and works with a subset of all the data that the Ingest Processor receives. For example, you can create a pipeline that selects events with the source type <code>cisco_syslog</code> from the incoming data, and then sends them to a specified index in Splunk Cloud Platform. This subset of selected data is called a partition. For more information, see <a href=http://docs.splunk.com/Documentation/SplunkCloud/latest/IngestProcessor/Architecture#Partitions rel=external>Partitions</a>.</p><p>The Ingest Processor solution supports only the commands and functions that are part of the <code>IngestProcessor</code> profile. For information about the specific SPL2 commands and functions that you can use to write pipelines for Ingest Processor, see <a href=http://docs.splunk.com/Documentation/SplunkCloud/latest/IngestProcessor/PipelinesOverview rel=external>Ingest Processor pipeline syntax</a>. For a summary of how the <code>IngestProcessor</code> profile supports different commands and functions compared to other SPL2 profiles, see the following pages in the <em>SPL2 Search Reference</em>:</p><ul><li><a href=http://docs.splunk.com/Documentation/SCS/current/SearchReference/CompatibilityQuickReferenceforSPL2commands rel=external>Compatibility Quick Reference for SPL2 commands</a></li><li><a href=http://docs.splunk.com/Documentation/SCS/current/SearchReference/CompatibilityQuickReferenceforSPL2evaluationfunctions rel=external>Compatibility Quick Reference for SPL2 evaluation functions</a></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-an-ingest-pipeline>Create an Ingest Pipeline</h1><h2 id=scenario-overview>Scenario Overview</h2><p>In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.</p><p>The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:</p><ul><li>Pod logs (application logs)</li><li>Kubernetes Events</li><li>Kubernetes Cluster Logs<ul><li>Control Plane Node logs</li><li>Worker Node logs</li><li>Audit Logs</li></ul></li></ul><p>As a Splunk Admin you want to ensure that the data you are collecting is optimized, so it can be analyzed in the most efficient way possible. Taking this approach accelerates troubleshooting and ensures efficient license utilization.</p><p>One way to accomplish this is by using Ingest Processor to convert robust logs to metrics and use Splunk Observability Cloud as the destination for those metrics. Not only does this make collecting the logs more efficient, you have the added ability of using the newly created metrics in Splunk Observability which can then be correlated with Splunk APM data (traces) and Splunk Infrastructure Monitoring data providing additional troubleshooting context. Because Splunk Observability Cloud uses a streaming metrics pipeline, the metrics can be alerted on in real-time speeding up problem identification. Additionally, you can use the Metrics Pipeline Management functionality to further optimize the data by aggregating, dropping unnecessary fields, and archiving less important or unneeded metrics.</p><p>In the next step you&rsquo;ll create an Ingest Processor Pipeline which will convert Kubernetes Audit Logs to metrics that will be sent to Observability Cloud.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Create an Ingest Pipeline</h1><article class=default><header class=headline></header><h1 id=login-to-splunk-cloud>Login to Splunk Cloud</h1><p>In this section you will create an Ingest Pipeline which will convert Kubernetes Audit Logs to metrics which are sent to the Splunk Observability Cloud workshop organization. Before getting started you will need to access the Splunk Cloud and Ingest Processor SCS Tenant environments provided in the Splunk Show event details.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Pre-requisite: Login to Splunk Enterprise Cloud</summary><div class=box-content><p><strong>1.</strong> Open the <strong>Ingest Processor Cloud Stack</strong> URL provided in the Splunk Show event details.</p><p><a href=#R-image-aabb340ff557f0e5e5282447521d7bb2 class=lightbox-link><img alt="Splunk Cloud Instance Details" class="lazy lightbox figure-image" loading=lazy src=../../images/show_instances_sec.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aabb340ff557f0e5e5282447521d7bb2><img alt="Splunk Cloud Instance Details" class="lazy lightbox lightbox-image" loading=lazy src=../../images/show_instances_sec.png></a></p><p><strong>2.</strong> In the Connection info click on the <strong>Stack URL</strong> link to open your Splunk Cloud stack.</p><p><a href=#R-image-10a85b296fb42c1203512cc9ce44a64f class=lightbox-link><img alt="Splunk Cloud Connection Details" class="lazy lightbox figure-image" loading=lazy src=../../images/sec_connection_details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-10a85b296fb42c1203512cc9ce44a64f><img alt="Splunk Cloud Connection Details" class="lazy lightbox lightbox-image" loading=lazy src=../../images/sec_connection_details.png></a></p><p><strong>3.</strong> Use the <code>admin</code> username and password to login to Splunk Cloud.</p><p><a href=#R-image-ed22cd00989aa2d2a76b117c2205b45c class=lightbox-link><img alt="Splunk Cloud Login" class="lazy lightbox figure-image" loading=lazy src=../../images/sec_login.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed22cd00989aa2d2a76b117c2205b45c><img alt="Splunk Cloud Login" class="lazy lightbox lightbox-image" loading=lazy src=../../images/sec_login.png></a></p><p><strong>4.</strong> After logging in, if prompted, accept the Terms of Service and click <strong>OK</strong></p><p><a href=#R-image-4a837a1e86a8925156c2c3ba6feb56b6 class=lightbox-link><img alt="Splunk Cloud Login" class="lazy lightbox figure-image" loading=lazy src=../../images/sec_terms.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4a837a1e86a8925156c2c3ba6feb56b6><img alt="Splunk Cloud Login" class="lazy lightbox lightbox-image" loading=lazy src=../../images/sec_terms.png></a></p><p><strong>5.</strong> Navigate back to the Splunk Show event details and select the Ingest Processor SCS Tenant</p><p><a href=#R-image-6a3c35c418290b8a2df6ab63b6f4b9c7 class=lightbox-link><img alt="Ingest Processor Connection Details" class="lazy lightbox figure-image" loading=lazy src=../../images/show_instances_scs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a3c35c418290b8a2df6ab63b6f4b9c7><img alt="Ingest Processor Connection Details" class="lazy lightbox lightbox-image" loading=lazy src=../../images/show_instances_scs.png></a></p><p><strong>6.</strong> Click on the <strong>Console URL</strong> to access the <strong>Ingest Processor SCS Tenant</strong></p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p><strong>Single Sign-On (SSO)</strong>
Single Sign-on (SSO) is configured between the Splunk Data Management service (â€˜SCS Tenantâ€™) and Splunk Cloud environments, so if you already logged in to your Splunk Cloud stack you should automatically be logged in to Splunk Data Management service. If you are prompted for credentials, use the credentials provided in the Splunk Cloud Stack on Splunk Show event (listed under the â€˜Splunk Cloud Stackâ€™ section.)</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=review-kubernetes-audit-logs>Review Kubernetes Audit Logs</h1><p>In this section you will review the Kubernetes Audit Logs that are being collected. You can see that the events are quite robust, which can make charting them inefficient. To address this, you will create an Ingest Pipeline in Ingest Processor that will convert these events to metrics that will be sent to Splunk Observability Cloud. This will allow you to chart the events much more efficiently and take advantage of the real-time streaming metrics in Splunk Observability Cloud.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Create Ingest Pipeline</summary><div class=box-content><p><strong>1.</strong> Open your <strong>Ingest Processor Cloud Stack</strong> instance using the URL provided in the Splunk Show workshop details.</p><p><strong>2.</strong> Navigate to <strong>Apps</strong> â†’ <strong>Search and Reporting</strong></p><p><a href=#R-image-e3e37f416af3986113915090289f042c class=lightbox-link><img alt="Search and Reporting" class="lazy lightbox figure-image" loading=lazy src="../../images/search_and_reporting.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3e37f416af3986113915090289f042c><img alt="Search and Reporting" class="lazy lightbox lightbox-image" loading=lazy src="../../images/search_and_reporting.png?width=20vw"></a></p><p><strong>3.</strong> In the search bar, enter the following SPL search string.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p>Make sure to replace <code>USER_ID</code> with the User ID provided in your Splunk Show instance information.</p></div></details><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl><span class=c1>### Replace USER_ID with the User ID provided in your Splunk Show instance information</span>
</span></span><span class=line><span class=cl><span class=nv>index</span><span class=o>=</span>main <span class=nv>sourcetype</span><span class=o>=</span><span class=s2>&#34;kube:apiserver:audit:USER_ID&#34;</span></span></span></code></pre></div><p><strong>4.</strong> Press <strong>Enter</strong> or click the green magnifying glass to run the search.</p><p><a href=#R-image-70510a8453dde2e34ed9d341e6103b30 class=lightbox-link><img alt="Kubernetes Audit Log" class="lazy lightbox figure-image" loading=lazy src=../../images/k8s_audit_log.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-70510a8453dde2e34ed9d341e6103b30><img alt="Kubernetes Audit Log" class="lazy lightbox lightbox-image" loading=lazy src=../../images/k8s_audit_log.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>You should now see the Kubernetes Audit Logs for your environment. Notice that the events are fairly robust. Explore the available fields and start to think about what information would be good candidates for metrics and dimensions. Ask yourself: What fields would I like to chart, and how would I like to be able to filter, group, or split those fields?</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-an-ingest-pipeline>Create an Ingest Pipeline</h1><p>In this section you will create an Ingest Pipeline which will convert Kubernetes Audit Logs to metrics which are sent to the Splunk Observability Cloud workshop organization.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Create Ingest Pipeline</summary><div class=box-content><p><strong>1.</strong> Open the <strong>Ingest Processor SCS Tenant</strong> using the connection details provided in the Splunk Show event.</p><p><a href=#R-image-958b6b742afb800d4a152c13441220f7 class=lightbox-link><img alt="Launch Splunk Cloud Platform" class="lazy lightbox figure-image" loading=lazy src="../../images/data_management_home.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-958b6b742afb800d4a152c13441220f7><img alt="Launch Splunk Cloud Platform" class="lazy lightbox lightbox-image" loading=lazy src="../../images/data_management_home.png?width=40vw"></a></p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p>When you open the <strong>Ingest Processor SCS Tenant</strong>, if you are taken to a welcome page, click on <strong>Launch</strong> under <strong>Splunk Cloud Platform</strong> to be taken to the Data Management page where you will configure the Ingest Pipeline.</p><p><a href=#R-image-8f0cf9cb2d3a47ec50c0894da54641ed class=lightbox-link><img alt="Launch Splunk Cloud Platform" class="lazy lightbox figure-image" loading=lazy src=../../images/launch_scp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8f0cf9cb2d3a47ec50c0894da54641ed><img alt="Launch Splunk Cloud Platform" class="lazy lightbox lightbox-image" loading=lazy src=../../images/launch_scp.png></a></p></div></details><p><strong>2.</strong> From the Splunk Data Management console select <strong>Pipelines</strong> â†’ <strong>New pipeline</strong> â†’ <strong>Ingest Processor pipeline</strong>.</p><p><a href=#R-image-73bec41399d9a1e3edba89f62e604e2c class=lightbox-link><img alt="New Ingest Processor Pipeline" class="lazy lightbox figure-image" loading=lazy src="../../images/new_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73bec41399d9a1e3edba89f62e604e2c><img alt="New Ingest Processor Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../../images/new_pipeline.png?width=40vw"></a></p><p><strong>3.</strong> In the <strong>Get started</strong> step of the Ingest Processor configuration page select <strong>Blank Pipeline</strong> and click <strong>Next</strong>.</p><p><a href=#R-image-d29afda6d4bc5902381437430a2d409f class=lightbox-link><img alt="Blank Ingest Processor Pipeline" class="lazy lightbox figure-image" loading=lazy src="../../images/blank_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d29afda6d4bc5902381437430a2d409f><img alt="Blank Ingest Processor Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../../images/blank_pipeline.png?width=40vw"></a></p><p><strong>4.</strong> In the <strong>Define your pipelineâ€™s partition</strong> step of the Ingest Processor configuration page select <strong>Partition by sourcetype</strong>. Select the <strong>= equals</strong> Operator and enter <code>kube:apiserver:audit:USER_ID</code> (Be sure to replace USER_ID with the User ID you were assigned) for the value. Click <strong>Apply</strong>.</p><p><a href=#R-image-d1d9bf1d7018938a09b5994e187fc196 class=lightbox-link><img alt="Add Partition" class="lazy lightbox figure-image" loading=lazy src="../../images/add_partition.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d1d9bf1d7018938a09b5994e187fc196><img alt="Add Partition" class="lazy lightbox lightbox-image" loading=lazy src="../../images/add_partition.png?width=40vw"></a></p><p><strong>5.</strong> Click <strong>Next</strong></p><p><strong>6.</strong> In the <strong>Add sample data</strong> step of the Ingest Processor configuration page select <strong>Capture new snapshot</strong>. Enter <code>k8s_audit_USER_ID</code> (Be sure to replace USER_ID with the User ID you were assigned) for the Snapshot name and click <strong>Capture</strong>.</p><p><a href=#R-image-b77c2d2645e0e73406bbc1bc368b2957 class=lightbox-link><img alt="Capture Snapshot" class="lazy lightbox figure-image" loading=lazy src="../../images/capture_snapshot.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b77c2d2645e0e73406bbc1bc368b2957><img alt="Capture Snapshot" class="lazy lightbox lightbox-image" loading=lazy src="../../images/capture_snapshot.png?width=40vw"></a></p><p><strong>7.</strong> Make sure your newly created snapshot (<code>k8s_audit_USER_ID</code>) is selected and then click <strong>Next</strong>.</p><p><a href=#R-image-884a023e920640bc69d140a3f5d441c0 class=lightbox-link><img alt="Configure Snapshot Sourcetype" class="lazy lightbox figure-image" loading=lazy src="../../images/capture_snapshot_sourcetype.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-884a023e920640bc69d140a3f5d441c0><img alt="Configure Snapshot Sourcetype" class="lazy lightbox lightbox-image" loading=lazy src="../../images/capture_snapshot_sourcetype.png?width=20vw"></a></p><p><strong>8.</strong> In the <strong>Select a metrics destination</strong> step of the Ingest Processor configuration page select <strong>show_o11y_org</strong>. Click <strong>Next</strong>.</p><p><a href=#R-image-b4f164dbdd3867291985113fc30a9e50 class=lightbox-link><img alt="Metrics Destination" class="lazy lightbox figure-image" loading=lazy src="../../images/metrics_destination.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b4f164dbdd3867291985113fc30a9e50><img alt="Metrics Destination" class="lazy lightbox lightbox-image" loading=lazy src="../../images/metrics_destination.png?width=20vw"></a></p><p><strong>9.</strong> In the <strong>Select a data destination</strong> step of the Ingest Processor configuration page select <strong>splunk_indexer</strong>. Under <strong>Specify how you want your events to be routed to an index</strong> select <strong>Default</strong>. Click <strong>Done</strong>.</p><p><a href=#R-image-cde821144ae26499d418f229cc594ce9 class=lightbox-link><img alt="Event Routing" class="lazy lightbox figure-image" loading=lazy src="../../images/event_routing.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cde821144ae26499d418f229cc594ce9><img alt="Event Routing" class="lazy lightbox lightbox-image" loading=lazy src="../../images/event_routing.png?width=20vw"></a></p><p><strong>10.</strong> In the <strong>Pipeline search field</strong> replace the default search with the following.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p><strong>Replace <code>UNIQUE_FIELD</code> in the metric name with a unique value (such as your initials) which will be used to identify your metric in Observability Cloud.</strong></p></div></details><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/*A valid SPL2 statement for a pipeline must start with &#34;$pipeline&#34;, and include &#34;from $source&#34; and &#34;into $destination&#34;.*/
</span></span><span class=line><span class=cl>/* Import logs_to_metrics */
</span></span><span class=line><span class=cl>import logs_to_metrics from /splunk/ingest/commands
</span></span><span class=line><span class=cl>$pipeline =
</span></span><span class=line><span class=cl>| from $source
</span></span><span class=line><span class=cl>| thru [
</span></span><span class=line><span class=cl>        //define the metric name, type, and value for the Kubernetes Events
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        // REPLACE UNIQUE_FIELD WITH YOUR INITIALS
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        | logs_to_metrics name=&#34;k8s_audit_UNIQUE_FIELD&#34; metrictype=&#34;counter&#34; value=1 time=_time
</span></span><span class=line><span class=cl>        | into $metrics_destination
</span></span><span class=line><span class=cl>    ]
</span></span><span class=line><span class=cl>| eval index = &#34;kube_logs&#34;
</span></span><span class=line><span class=cl>| into $destination;</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
New to SPL2?</summary><div class=box-content><p>Here is a breakdown of what the SPL2 query is doing:</p><ul><li>First, you are importing the built-in <code>logs_to_metrics</code> command which will be used to convert the kubernetes events to metrics.</li><li>You&rsquo;re using the source data, which you can see on the right is any event from the <code>kube:apiserver:audit</code> sourcetype.</li><li>Now, you use the <code>thru</code> command which writes the source dataset to the following command, in this case <code>logs_to_metrics</code>.</li><li>You can see that the metric name (<code>k8s_audit</code>), metric type (<code>counter</code>), value, and timestamp are all provided for the metric. Youâ€™re using a value of 1 for this metric because we want to count the number of times the event occurs.</li><li>Next, you choose the destination for the metric using the into <code>$metrics_destintation</code> command, which is our Splunk Observability Cloud organization</li><li>Finally, you can send the raw log events to another destination, in this case another index, so they are retained if we ever need to access them.</li></ul></div></details><p><strong>11.</strong> In the upper-right corner click the <strong>Preview</strong> button <a href=#R-image-423f4c4c5206bc34ef1f027c479cf03a class=lightbox-link><img alt="Preview Button" class="inline lazy lightbox figure-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-423f4c4c5206bc34ef1f027c479cf03a><img alt="Preview Button" class="inline lazy lightbox lightbox-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline"></a> or press CTRL+Enter (CMD+Enter on Mac). From the <strong>Previewing $pipeline</strong> dropdown select <strong>$metrics_destination</strong>. Confirm you are seeing a preview of the metrics that will be sent to Splunk Observability Cloud.</p><p><a href=#R-image-9baf4a4e5acdeb15f2b8e56f87bba7c1 class=lightbox-link><img alt="Preview Pipeline" class="lazy lightbox figure-image" loading=lazy src="../../images/preview_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9baf4a4e5acdeb15f2b8e56f87bba7c1><img alt="Preview Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../../images/preview_pipeline.png?width=40vw"></a></p><p><strong>12.</strong> In the upper-right corner click the <strong>Save pipeline</strong> button <a href=#R-image-ca115a23daf40ae704630d67ea5a8bc0 class=lightbox-link><img alt="Save Pipeline Button" class="inline lazy lightbox figure-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca115a23daf40ae704630d67ea5a8bc0><img alt="Save Pipeline Button" class="inline lazy lightbox lightbox-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline"></a>. Enter <code>Kubernetes Audit Logs2Metrics USER_ID</code> for your pipeline name and click <strong>Save</strong>.</p><p><a href=#R-image-0e33f878d0ce2826baf166b9f39b504c class=lightbox-link><img alt="Save Pipeline Dialog" class="lazy lightbox figure-image" loading=lazy src="../../images/save_pipeline_dialog.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e33f878d0ce2826baf166b9f39b504c><img alt="Save Pipeline Dialog" class="lazy lightbox lightbox-image" loading=lazy src="../../images/save_pipeline_dialog.png?width=40vw"></a></p><p><strong>13.</strong> After clicking save you will be asked if you would like to apply the newly created pipeline. Click <strong>Yes, apply</strong>.</p><p><a href=#R-image-6e439ab9d7cc2b026e6357de946a266b class=lightbox-link><img alt="Apply Pipeline Dialog" class="lazy lightbox figure-image" loading=lazy src="../../images/apply_pipeline_dialog.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e439ab9d7cc2b026e6357de946a266b><img alt="Apply Pipeline Dialog" class="lazy lightbox lightbox-image" loading=lazy src="../../images/apply_pipeline_dialog.png?width=40vw"></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>The Ingest Pipeline should now be sending metrics to Splunk Observability Cloud. Keep this tab open as it will be used it again in the next section.</p><p>In the next step you&rsquo;ll confirm the pipeline is working by viewing the metrics you just created in Splunk Observability Cloud.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=confirm-metrics-in-observability-cloud>Confirm Metrics in Observability Cloud</h1><p>Now that an Ingest Pipeline has been configured to convert Kubernetes Audit Logs into metrics and send them to Splunk Observability Cloud the metrics should be available. To confirm the metrics are being collected complete the following steps:</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Confirm Metrics in Splunk Observability Cloud</summary><div class=box-content><p><strong>1.</strong> Login to the <strong>Splunk Observability Cloud</strong> organization you were invited for the workshop. In the upper-right corner, click the <strong>+</strong> Icon â†’ <strong>Chart</strong> to create a new chart.</p><p><a href=#R-image-26f270db9ae9c9f148a8525a9c38f4a5 class=lightbox-link><img alt="Create New Chart" class="lazy lightbox figure-image" loading=lazy src="../../images/create_new_chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-26f270db9ae9c9f148a8525a9c38f4a5><img alt="Create New Chart" class="lazy lightbox lightbox-image" loading=lazy src="../../images/create_new_chart.png?width=40vw"></a></p><p><strong>2.</strong> In the <strong>Plot Editor</strong> of the newly created chart enter the metric name you used while configuring the <strong>Ingest Pipeline</strong>.</p><p><a href=#R-image-eeb04a4c6418f6c86727195d03cc29b2 class=lightbox-link><img alt="Review Metric" class="lazy lightbox figure-image" loading=lazy src="../../images/review_metric.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eeb04a4c6418f6c86727195d03cc29b2><img alt="Review Metric" class="lazy lightbox lightbox-image" loading=lazy src="../../images/review_metric.png?width=40vw"></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Info</summary><div class=box-content><p>You should see the metric you created in the Ingest Pipeline. Keep this tab open as it will be used again in the next section.</p><p>In the next step you will update the ingest pipeline to add dimensions to the metric, so you have additional context for alerting and troubleshooting.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=update-pipeline-and-visualize-metrics>Update Pipeline and Visualize Metrics</h1><h2 id=context-matters>Context Matters</h2><p>In the previous section, you reviewed the raw Kubernetes audit logs and created an Ingest Processor Pipeline to convert them to metrics and send those metrics to Splunk Observability Cloud.</p><p>Now that this pipeline is defined we are collecting the new metrics in Splunk Observability Cloud. This is a great start; however, you will only see a single metric showing the total number of Kubernetes audit events for a given time period. It would be much more valuable to add dimensions so that you can split the metric by the event type, user, response status, and so on.</p><p>In this section you will update the Ingest Processor Pipeline to include additional dimensions from the Kubernetes audit logs to the metrics that are being collected. This will allow you to further filter, group, visualize, and alert on specific aspects of the audit logs. After updating the metric, you will create a new dashboard showing the status of the different types of actions associated with the logs.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 4. Update Pipeline and Visualize Metrics</h1><article class=default><header class=headline></header><h1 id=update-ingest-pipeline>Update Ingest Pipeline</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Update Ingest Pipeline</summary><div class=box-content><p><strong>1.</strong> Navigate back to the configuration page for the Ingest Pipeline you created in the previous step.</p><p><a href=#R-image-60e60e94f9af5c4f3e0a93fba5454cdf class=lightbox-link><img alt="Ingest Pipeline" class="lazy lightbox figure-image" loading=lazy src="../../images/ingest_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-60e60e94f9af5c4f3e0a93fba5454cdf><img alt="Ingest Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../../images/ingest_pipeline.png?width=40vw"></a></p><p><strong>2.</strong> To add dimensions to the metric from the raw Kubernetes audit logs update the SPL2 query you created for the pipeline by replacing the <code>logs_to_metrics</code> portion of the query with the following:</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p><strong>Be sure to update the metric name field (<code>name="k8s_audit_UNIQUE_FIELD"</code>) to the name you provided in the original pipeline</strong></p></div></details><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>| logs_to_metrics name=&#34;k8s_audit_UNIQUE_FIELD&#34; metrictype=&#34;counter&#34; value=1 time=_time dimensions={&#34;level&#34;: _raw.level, &#34;response_status&#34;: _raw.responseStatus.code, &#34;namespace&#34;: _raw.objectRef.namespace, &#34;resource&#34;: _raw.objectRef.resource, &#34;user&#34;: _raw.user.username, &#34;action&#34;: _raw.verb}</span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info"></i>
Note</summary><div class=box-content><p>Using the <code>dimensions</code> field in the SPL2 query you can add dimensions from the raw events to the metrics that will be sent to Splunk Observability Cloud. In this case you are adding the event response status, namespace, Kubernetes resource, user, and verb (action that was performed). These dimensions can be used to create more granular dashboards and alerts.</p><p>You should consider adding any common tags across your services so that you can take advantage of context propagation and related content in Splunk Observability Cloud.</p></div></details><p>The updated pipeline should now be the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/*A valid SPL2 statement for a pipeline must start with &#34;$pipeline&#34;, and include &#34;from $source&#34; and &#34;into $destination&#34;.*/
</span></span><span class=line><span class=cl>/* Import logs_to_metrics */
</span></span><span class=line><span class=cl>import logs_to_metrics from /splunk/ingest/commands
</span></span><span class=line><span class=cl>$pipeline =
</span></span><span class=line><span class=cl>| from $source
</span></span><span class=line><span class=cl>| thru [
</span></span><span class=line><span class=cl>        //define the metric name, type, and value for the Kubernetes Events
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        // REPLACE UNIQUE_FIELD WITH YOUR INITIALS
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        | logs_to_metrics name=&#34;k8s_audit_UNIQUE_FIELD&#34; metrictype=&#34;counter&#34; value=1 time=_time dimensions={&#34;level&#34;: _raw.level, &#34;response_status&#34;: _raw.responseStatus.code, &#34;namespace&#34;: _raw.objectRef.namespace, &#34;resource&#34;: _raw.objectRef.resource, &#34;user&#34;: _raw.user.username, &#34;action&#34;: _raw.verb}
</span></span><span class=line><span class=cl>        | into $metrics_destination
</span></span><span class=line><span class=cl>    ]
</span></span><span class=line><span class=cl>| eval index = &#34;kube_logs&#34;
</span></span><span class=line><span class=cl>| into $destination;</span></span></code></pre></div><p><strong>3.</strong> In the upper-right corner click the <strong>Preview</strong> button <a href=#R-image-78e02b64a081c13f6d8f0b1e1acf89d2 class=lightbox-link><img alt="Preview Button" class="inline lazy lightbox figure-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-78e02b64a081c13f6d8f0b1e1acf89d2><img alt="Preview Button" class="inline lazy lightbox lightbox-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline"></a> or press CTRL+Enter (CMD+Enter on Mac). From the <strong>Previewing $pipeline</strong> dropdown select <strong>$metrics_destination</strong>. Confirm you are seeing a preview of the metrics that will be sent to Splunk Observability Cloud.</p><p><a href=#R-image-1d2e05ebd3ebaa8ba6650a76a96d3c66 class=lightbox-link><img alt="Ingest Pipeline Dimensions" class="lazy lightbox figure-image" loading=lazy src="../../images/ingest_pipeline_dimensions.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1d2e05ebd3ebaa8ba6650a76a96d3c66><img alt="Ingest Pipeline Dimensions" class="lazy lightbox lightbox-image" loading=lazy src="../../images/ingest_pipeline_dimensions.png?width=40vw"></a></p><p><strong>4.</strong> Confirm you are seeing the dimensions in the dimensions column of the preview table. You can view the entire dimensions object by clicking into the table.</p><p><a href=#R-image-507b32ba43f6ac70c8d21ec55ace35f1 class=lightbox-link><img alt="Ingest Pipeline Dimensions Review" class="lazy lightbox figure-image" loading=lazy src="../../images/ingest_pipeline_dimensions_field.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-507b32ba43f6ac70c8d21ec55ace35f1><img alt="Ingest Pipeline Dimensions Review" class="lazy lightbox lightbox-image" loading=lazy src="../../images/ingest_pipeline_dimensions_field.png?width=40vw"></a></p><p><strong>5.</strong> In the upper-right corner click the <strong>Save pipeline</strong> button <a href=#R-image-4076f26670df983686447d6d21696962 class=lightbox-link><img alt="Save Pipeline Button" class="inline lazy lightbox figure-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4076f26670df983686447d6d21696962><img alt="Save Pipeline Button" class="inline lazy lightbox lightbox-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline"></a>. On the â€œYou are editing an active pipeline modalâ€ click <strong>Save</strong>.</p><p><a href=#R-image-7ede3dbaf7a2021610b8c115942e2aca class=lightbox-link><img alt="Save Updated Pipeline" class="lazy lightbox figure-image" loading=lazy src="../../images/save_updated_pipeline.png?width=30vw" style=height:auto;width:30vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7ede3dbaf7a2021610b8c115942e2aca><img alt="Save Updated Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../../images/save_updated_pipeline.png?width=30vw"></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Note</summary><div class=box-content><p>Because this pipeline is already active, the changes you made will take effect immediately. Your metric should now be split into multiple metric timeseries using the dimensions you added.</p><p>In the next step you will create a visualization using different dimensions from the Kubernetes audit events.</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=visualize-kubernetes-audit-event-metrics>Visualize Kubernetes Audit Event Metrics</h1><p>Now that your metric has dimensions you will create a chart showing the health of different Kubernetes actions using the <code>verb</code> dimension from the events.</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Visualize Kubernetes Audit Event Metrics</summary><div class=box-content><p><strong>1.</strong> If you closed the chart you created in the previous section, in the upper-right corner, click the <strong>+</strong> Icon â†’ <strong>Chart</strong> to create a new chart.</p><p><a href=#R-image-7433e5d3feb335bc051ed822cdb18a77 class=lightbox-link><img alt="Create New Chart" class="lazy lightbox figure-image" loading=lazy src="../../images/create_new_chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7433e5d3feb335bc051ed822cdb18a77><img alt="Create New Chart" class="lazy lightbox lightbox-image" loading=lazy src="../../images/create_new_chart.png?width=40vw"></a></p><p><strong>2.</strong> In the <strong>Plot Editor</strong> of the newly created chart enter <code>k8s_audit*</code> in the metric name field. You will use a wildcard here so that you can see all the metrics that are being ingested.</p><p><a href=#R-image-5f3b336f3e1ab55d18fc205a38a123ab class=lightbox-link><img alt="Review Metric" class="lazy lightbox figure-image" loading=lazy src="../../images/review_metric.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5f3b336f3e1ab55d18fc205a38a123ab><img alt="Review Metric" class="lazy lightbox lightbox-image" loading=lazy src="../../images/review_metric.png?width=40vw"></a></p><p><strong>3.</strong> Notice the change from one to many metrics, which is when you updated the pipeline to include the dimensions. Now that we have this metric available, let&rsquo;s adjust the chart to show us if any of our actions have errors associated with them.</p><p><a href=#R-image-ae89b665c49e70e4457beea1bdaacadf class=lightbox-link><img alt="Metric Timeseries" class="lazy lightbox figure-image" loading=lazy src="../../images/metric_timeseries.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ae89b665c49e70e4457beea1bdaacadf><img alt="Metric Timeseries" class="lazy lightbox lightbox-image" loading=lazy src="../../images/metric_timeseries.png?width=40vw"></a></p><p>First you&rsquo;ll filter the Kubernetes events to only those that were not successful using the HTTP response code which is available in the <strong>response_status</strong> field. We only want events that have a response code of <strong>409</strong>, which indicates that there was a conflict (for example a trying to create a resource that already exists) or <strong>503</strong>, which indicates that the API was unresponsive for the request.</p><p><strong>4.</strong> In the plot editor of your chart click the <strong>Add filter</strong>, use <strong>response_status</strong> for the field and select <strong>409.0</strong> and <strong>503.0</strong> for the values.</p><p>Next, youâ€™ll add a function to the chart which will calculate the total number of events grouped by the <strong>resource</strong>, <strong>action</strong>, and <strong>response status</strong>. This will allow us to see exactly which actions and the associated resources had errors. Now we are only looking at Kubernetes events that were not successful.</p><p><strong>5.</strong> Click <strong>Add analytics</strong> â†’ <strong>Sum</strong> â†’ <strong>Sum:Aggregation</strong> and add <strong>resource</strong>, <strong>action</strong>, and <strong>response_status</strong> in the <strong>Group by</strong> field.</p><p><a href=#R-image-90aa5f9f8bcf4fe83d64c95336535b19 class=lightbox-link><img alt="Add Metric Filters" class="lazy lightbox figure-image" loading=lazy src="../../images/add_metric_filters.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-90aa5f9f8bcf4fe83d64c95336535b19><img alt="Add Metric Filters" class="lazy lightbox lightbox-image" loading=lazy src="../../images/add_metric_filters.png?width=40vw"></a></p><p><strong>6.</strong> Using the chart type along the top buttons, change the chart to a <strong>heatmap</strong>. Next to the <strong>Plot editor</strong>, click <strong>Chart options</strong>. In the <strong>Group by</strong> section select <strong>response_status</strong> then <strong>action</strong>. Change the <strong>Color threshold</strong> from <strong>Auto</strong> to <strong>Fixed</strong>. Click the blue <strong>+ button</strong> to add another threshold. Change the <strong>Down arrow to Yellow</strong>, the <strong>Middle to orange</strong>. Leave the <strong>Up arrow as red</strong>. Enter <strong>5 for the middle threshold</strong> and <strong>20 for the upper threshold</strong>.</p><p><a href=#R-image-87e47943729ebe593aa6264def6a4251 class=lightbox-link><img alt="Configure Thresholds" class="lazy lightbox figure-image" loading=lazy src="../../images/configure_thresholds.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-87e47943729ebe593aa6264def6a4251><img alt="Configure Thresholds" class="lazy lightbox lightbox-image" loading=lazy src="../../images/configure_thresholds.png?width=40vw"></a></p><p><strong>7.</strong> In the upper right corner of the chart click the blue <strong>Save as&mldr;</strong> <a href=#R-image-63d7415344eb141aa7449f98b44c3d8c class=lightbox-link><img alt="Preview Button" class="inline lazy lightbox figure-image" loading=lazy src="../../images/save_as_btn.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-63d7415344eb141aa7449f98b44c3d8c><img alt="Preview Button" class="inline lazy lightbox lightbox-image" loading=lazy src="../../images/save_as_btn.png?height=20px&classes=inline"></a> button. Enter a name for your chart (For Example: Kubernetes Audit Logs - Conflicts and Failures).</p><p><a href=#R-image-3a5d2fc8d6de20eace7fd57d8d606132 class=lightbox-link><img alt="Chart Name" class="lazy lightbox figure-image" loading=lazy src=../../images/chart_name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3a5d2fc8d6de20eace7fd57d8d606132><img alt="Chart Name" class="lazy lightbox lightbox-image" loading=lazy src=../../images/chart_name.png></a></p><p><strong>8.</strong> On the <strong>Choose a dashboard</strong> select <strong>New dashboard</strong>.</p><p><a href=#R-image-bfde1a17833ee1e2d8455dd5fe368eba class=lightbox-link><img alt="New Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/new_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bfde1a17833ee1e2d8455dd5fe368eba><img alt="New Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/new_dashboard.png></a></p><p><strong>9.</strong> Enter a name for your dashboard that includes your initials, so you can easily find it later. Click <strong>Save</strong>.</p><p><a href=#R-image-27141e30bac99f34ef4dc71e1b30be7b class=lightbox-link><img alt="New Dashboard Name" class="lazy lightbox figure-image" loading=lazy src=../../images/dashboard_name.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-27141e30bac99f34ef4dc71e1b30be7b><img alt="New Dashboard Name" class="lazy lightbox lightbox-image" loading=lazy src=../../images/dashboard_name.png></a></p><p><strong>10.</strong> Make sure the new dashboard you just created is selected and click <strong>Ok</strong>.</p><p><a href=#R-image-11a404842ca646b4db5f9b1220f91c39 class=lightbox-link><img alt="Save New Dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/save_new_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11a404842ca646b4db5f9b1220f91c39><img alt="Save New Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/save_new_dashboard.png></a></p><p>You should now be taken to your new Kubernetes Audit Events dashboard with the chart you created. You can add new charts from other metrics in your environment, such as application errors and response times from the applications running in the Kubernetes cluster, or other Kubernetes metrics such as pod phase, pod memory utilization, etc. giving you a correlated view of your Kubernetes environment from cluster events to application health.</p><p><a href=#R-image-fab88520150f5c29e7306d48c65c616a class=lightbox-link><img alt="Audit Dashboard" class="lazy lightbox figure-image" loading=lazy src="../../images/audit_dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fab88520150f5c29e7306d48c65c616a><img alt="Audit Dashboard" class="lazy lightbox lightbox-image" loading=lazy src="../../images/audit_dashboard.png?width=40vw"></a></p><p>Make a copy of this chart using the three dots <code>...</code> in the top right of your chart&rsquo;s visualization box</p><p><a href=#R-image-651235e6a59bd1d8889986755f93a1c7 class=lightbox-link><img alt="Copy chart button" class="lazy lightbox figure-image" loading=lazy src="../../images/copy_chart_button.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-651235e6a59bd1d8889986755f93a1c7><img alt="Copy chart button" class="lazy lightbox lightbox-image" loading=lazy src="../../images/copy_chart_button.png?width=40vw"></a></p><p>Paste into the same dashboard you&rsquo;ve been working in using the <code>+</code> icon in the top right of the UI</p><p><a href=#R-image-3f46ae8f244d6540ff6035d16631add4 class=lightbox-link><img alt="Paste chart into dashboard" class="lazy lightbox figure-image" loading=lazy src="../../images/paste_chart_into_dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f46ae8f244d6540ff6035d16631add4><img alt="Paste chart into dashboard" class="lazy lightbox lightbox-image" loading=lazy src="../../images/paste_chart_into_dashboard.png?width=40vw"></a></p><p>Click into your pasted chart and change the visualization to a <strong>Column</strong> chart.</p><p><a href=#R-image-7c89245653c4a87e0be9d679d1398d36 class=lightbox-link><img alt="Change to column chart visualization" class="lazy lightbox figure-image" loading=lazy src="../../images/change_to_column_chart_visualization.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c89245653c4a87e0be9d679d1398d36><img alt="Change to column chart visualization" class="lazy lightbox lightbox-image" loading=lazy src="../../images/change_to_column_chart_visualization.png?width=40vw"></a></p><p>Change SUM to just <code>resource</code>, <code>namespace</code> (our filters filter down to just problem codes)</p><p><a href=#R-image-fe98a9ac2fd3d7e2f7cca16f7e3cac43 class=lightbox-link><img alt="Group chart by resource and namespace" class="lazy lightbox figure-image" loading=lazy src="../../images/group_chart_by_resource_and_namespace.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fe98a9ac2fd3d7e2f7cca16f7e3cac43><img alt="Group chart by resource and namespace" class="lazy lightbox lightbox-image" loading=lazy src="../../images/group_chart_by_resource_and_namespace.png?width=40vw"></a></p><p>In Chart options change title to <code>Kubernetes Audit Logs - Conflicts by Namespace</code></p><p><a href=#R-image-6f0d9d97f88a754b2b36518d7f7bd8f6 class=lightbox-link><img alt="Change chart title" class="lazy lightbox figure-image" loading=lazy src="../../images/change_chart_title.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6f0d9d97f88a754b2b36518d7f7bd8f6><img alt="Change chart title" class="lazy lightbox lightbox-image" loading=lazy src="../../images/change_chart_title.png?width=40vw"></a></p><p>Click <strong>Save</strong> and close</p><p><a href=#R-image-e9da3853bae244022be41d019288bba5 class=lightbox-link><img alt="Save and close chart" class="lazy lightbox figure-image" loading=lazy src=../../images/save_and_close_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9da3853bae244022be41d019288bba5><img alt="Save and close chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/save_and_close_chart.png></a></p></div></details><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Create a detector based on Kubernetes Audit Logs</summary><div class=box-content><p>On your Conflicts by Namespace chart click the little bell icon and New detector from chart</p><p><a href=#R-image-7c490a3228bc074f5e12aca39ed1678e class=lightbox-link><img alt="Bell icon to create detector" class="lazy lightbox figure-image" loading=lazy src="../../images/bell_icon_create_detector.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c490a3228bc074f5e12aca39ed1678e><img alt="Bell icon to create detector" class="lazy lightbox lightbox-image" loading=lazy src="../../images/bell_icon_create_detector.png?width=40vw"></a></p><p>Choose a name and click <strong>Create alert rule</strong></p><p><a href=#R-image-ea318ea5df3718f0e5e1a3cb077c9087 class=lightbox-link><img alt="Enter name for alert rule" class="lazy lightbox figure-image" loading=lazy src="../../images/enter_name_alert_rule.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ea318ea5df3718f0e5e1a3cb077c9087><img alt="Enter name for alert rule" class="lazy lightbox lightbox-image" loading=lazy src="../../images/enter_name_alert_rule.png?width=40vw"></a></p><p>For Alert condition click <strong>Static Threshold</strong> and click Proceed to <strong>Alert Settings</strong></p><p><a href=#R-image-0c22124cd742e150f41ebdd3c9d7fead class=lightbox-link><img alt="Select static threshold condition" class="lazy lightbox figure-image" loading=lazy src="../../images/select_static_threshold_condition.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0c22124cd742e150f41ebdd3c9d7fead><img alt="Select static threshold condition" class="lazy lightbox lightbox-image" loading=lazy src="../../images/select_static_threshold_condition.png?width=40vw"></a></p><p>Enter a <strong>Threshold</strong> of <code>20</code></p><p><a href=#R-image-3862022d32e9d947df2c8d604043f955 class=lightbox-link><img alt="Enter threshold value" class="lazy lightbox figure-image" loading=lazy src="../../images/enter_threshold_value.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3862022d32e9d947df2c8d604043f955><img alt="Enter threshold value" class="lazy lightbox lightbox-image" loading=lazy src="../../images/enter_threshold_value.png?width=40vw"></a></p><p>We wont choose any recipients for this alert so click into <strong>Activate</strong> and choose <strong>Activate Alert Rule</strong> and <strong>Save</strong></p><p><a href=#R-image-923098237eb9523439bdfa4aa9aeddf6 class=lightbox-link><img alt="Activate alert rule and save" class="lazy lightbox figure-image" loading=lazy src="../../images/activate_alert_rule_and_save.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-923098237eb9523439bdfa4aa9aeddf6><img alt="Activate alert rule and save" class="lazy lightbox lightbox-image" loading=lazy src="../../images/activate_alert_rule_and_save.png?width=40vw"></a></p><p>Click <strong>Save</strong> one final time in the top right to save your detector</p><p><a href=#R-image-1798a4b13978168b792a426c0abe6a91 class=lightbox-link><img alt="Final save for detector" class="lazy lightbox figure-image" loading=lazy src="../../images/final_save_detector.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1798a4b13978168b792a426c0abe6a91><img alt="Final save for detector" class="lazy lightbox lightbox-image" loading=lazy src="../../images/final_save_detector.png?width=40vw"></a></p><p>Navigate back to your dashboard and you will see a detector associated with the chart denoted by a lit up bell icon on the chart</p><p><a href=#R-image-fdccef1907a54a182824bf5e8d6a1e16 class=lightbox-link><img alt="Detector bell icon on chart" class="lazy lightbox figure-image" loading=lazy src="../../images/detector_bell_icon_on_chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fdccef1907a54a182824bf5e8d6a1e16><img alt="Detector bell icon on chart" class="lazy lightbox lightbox-image" loading=lazy src="../../images/detector_bell_icon_on_chart.png?width=40vw"></a></p></div></details><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise: Visualize your time series data in Splunk Cloud - Dashboard Studio</summary><div class=box-content><p>Now that we have our time series metrics ingested to the Splunk Observability Cloud data store we can easily visualize these time series metrics in Splunk Cloud!</p><p>In your Splunk Cloud instance browse to <strong>Dashboards</strong> and select <strong>Create New Dashboard</strong></p><p><a href=#R-image-70431fc2f38e1e2522e0993c16f1894f class=lightbox-link><img alt="Create new dashboard in Splunk Cloud" class="lazy lightbox figure-image" loading=lazy src=../../images/create_new_dashboard_splunk_cloud.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-70431fc2f38e1e2522e0993c16f1894f><img alt="Create new dashboard in Splunk Cloud" class="lazy lightbox lightbox-image" loading=lazy src=../../images/create_new_dashboard_splunk_cloud.png></a></p><p>Choose a Dashboard title, permissions and <strong>Dashboard Studio</strong> along with any Layout Mode.
Click <strong>Create</strong>.</p><p><a href=#R-image-e25903c28dd30e9c0cf74952bd46b08b class=lightbox-link><img alt="Dashboard title and layout options" class="lazy lightbox figure-image" loading=lazy src=../../images/dashboard_title_layout_options.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e25903c28dd30e9c0cf74952bd46b08b><img alt="Dashboard title and layout options" class="lazy lightbox lightbox-image" loading=lazy src=../../images/dashboard_title_layout_options.png></a></p><p>In Dashboard Studio click the chart icon and choose <strong>Column</strong></p><p><a href=#R-image-daf5688f43eeb95f5c5453eb28e49e37 class=lightbox-link><img alt="Select column chart in Dashboard Studio" class="lazy lightbox figure-image" loading=lazy src=../../images/select_column_chart_dashboard_studio.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-daf5688f43eeb95f5c5453eb28e49e37><img alt="Select column chart in Dashboard Studio" class="lazy lightbox lightbox-image" loading=lazy src=../../images/select_column_chart_dashboard_studio.png></a></p><p>In <strong>Select data source</strong> choose <strong>Create splunk observability cloud metric search</strong></p><p><a href=#R-image-37ce2f9c64907a7c0e59d4302a3c69b8 class=lightbox-link><img alt="Choose observability cloud metric search as data source" class="lazy lightbox figure-image" loading=lazy src=../../images/choose_observability_cloud_metric_search.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-37ce2f9c64907a7c0e59d4302a3c69b8><img alt="Choose observability cloud metric search as data source" class="lazy lightbox lightbox-image" loading=lazy src=../../images/choose_observability_cloud_metric_search.png></a></p><p>Choose a name for your new datasource and click the <strong>Content Import</strong> link under <strong>Search for metric or metadata</strong></p><p>Copy and paste the URL for your chart into the <strong>Content URL</strong> field</p><p><a href=#R-image-fb885817253d4b4c6f93adc507d75c69 class=lightbox-link><img alt="Paste chart URL and import" class="lazy lightbox figure-image" loading=lazy src="../../images/paste_chart_url_and_import.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fb885817253d4b4c6f93adc507d75c69><img alt="Paste chart URL and import" class="lazy lightbox lightbox-image" loading=lazy src="../../images/paste_chart_url_and_import.png?width=40vw"></a></p><p>Click <strong>Import</strong></p><p><a href=#R-image-1c00a757eb3abcff7ed16fb15bdf1130 class=lightbox-link><img alt="Chart imported to dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/chart_imported_to_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1c00a757eb3abcff7ed16fb15bdf1130><img alt="Chart imported to dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/chart_imported_to_dashboard.png></a></p><p><a href=#R-image-2a0cdf38550d898b63623e17faae2ca3 class=lightbox-link><img alt="Chart visible in dashboard" class="lazy lightbox figure-image" loading=lazy src=../../images/chart_visible_in_dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2a0cdf38550d898b63623e17faae2ca3><img alt="Chart visible in dashboard" class="lazy lightbox lightbox-image" loading=lazy src=../../images/chart_visible_in_dashboard.png></a></p><p>Size your chart to your dashboard</p><p><a href=#R-image-4024cfa5f87239bf75e0507fa96f6db6 class=lightbox-link><img alt="Resize chart in dashboard" class="lazy lightbox figure-image" loading=lazy src="../../images/resize_chart_in_dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4024cfa5f87239bf75e0507fa96f6db6><img alt="Resize chart in dashboard" class="lazy lightbox lightbox-image" loading=lazy src="../../images/resize_chart_in_dashboard.png?width=40vw"></a></p><p>Expand <strong>Interactions</strong> in the right side of your charts <strong>Configuration</strong> and click <strong>Add Interaction</strong></p><p><a href=#R-image-6a0bdb44ac8bd66216ffb744dec3b54f class=lightbox-link><img alt="Expand interactions and add interaction" class="lazy lightbox figure-image" loading=lazy src=../../images/expand_interactions_add_interaction.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a0bdb44ac8bd66216ffb744dec3b54f><img alt="Expand interactions and add interaction" class="lazy lightbox lightbox-image" loading=lazy src=../../images/expand_interactions_add_interaction.png></a></p><p>Copy the URL from your dashboard in Splunk Observability</p><p><a href=#R-image-bbe96bfa8338f017f74f39ffdb97925a class=lightbox-link><img alt="Apply interaction settings" class="lazy lightbox figure-image" loading=lazy src="../../images/apply_interaction_settings.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bbe96bfa8338f017f74f39ffdb97925a><img alt="Apply interaction settings" class="lazy lightbox lightbox-image" loading=lazy src="../../images/apply_interaction_settings.png?width=40vw"></a></p><p>In <strong>On click</strong> choose <strong>Link to custom URL</strong> and add the URL for your dashboard in Splunk Observability Cloud for easy navigation back to the source data.
Also choose <strong>Open in new tab</strong> for friendly navigation.</p><p><a href=#R-image-ab1e2d46aeac267fa5e915bd5aa7003e class=lightbox-link><img alt="Interaction added" class="lazy lightbox figure-image" loading=lazy src=../../images/interaction_added.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ab1e2d46aeac267fa5e915bd5aa7003e><img alt="Interaction added" class="lazy lightbox lightbox-image" loading=lazy src=../../images/interaction_added.png></a></p><p>Click <strong>Save</strong> in the top right to save your Dashboard.</p><p><a href=#R-image-8d108b848db99b9a6a89970d42d03921 class=lightbox-link><img alt="Save dashboard in Splunk Cloud" class="lazy lightbox figure-image" loading=lazy src=../../images/save_dashboard_splunk_cloud.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d108b848db99b9a6a89970d42d03921><img alt="Save dashboard in Splunk Cloud" class="lazy lightbox lightbox-image" loading=lazy src=../../images/save_dashboard_splunk_cloud.png></a></p><p>Highlight and click a Column or name in your chart</p><p><a href=#R-image-05d0b206f43cd4f65c09a1f05e205959 class=lightbox-link><img alt="Click column or name in chart" class="lazy lightbox figure-image" loading=lazy src=../../images/click_column_or_name_in_chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-05d0b206f43cd4f65c09a1f05e205959><img alt="Click column or name in chart" class="lazy lightbox lightbox-image" loading=lazy src=../../images/click_column_or_name_in_chart.png></a></p><p>You will be told you are navigating back to Splunk Observability. Click <strong>Continue</strong></p><p><a href=#R-image-a9be243cc9ebc0af5890ce2aac542c27 class=lightbox-link><img alt="Continue navigation to Splunk Observability" class="lazy lightbox figure-image" loading=lazy src=../../images/continue_navigation_splunk_observability.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a9be243cc9ebc0af5890ce2aac542c27><img alt="Continue navigation to Splunk Observability" class="lazy lightbox lightbox-image" loading=lazy src=../../images/continue_navigation_splunk_observability.png></a></p><p>You&rsquo;ve now navigated back to your corresponding Splunk Observability dashboard from Splunk Cloud.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Aug 6, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=conclusion>Conclusion</h1><p>In this workshop, you walked through the entire process of optimizing Kubernetes log management by converting detailed log events into actionable metrics using <strong>Splunk Ingest Pipelines</strong>. You started by defining a pipeline that efficiently converts Kubernetes audit logs into metrics, drastically reducing the data volume while retaining critical information. You then ensured the raw log events were securely stored in S3 for long-term retention and deeper analysis.</p><p><a href=#R-image-9f27af65195267af5f9ce4f3b7467326 class=lightbox-link><img alt="Kubernetes Audit Event" class="lazy lightbox figure-image" loading=lazy src="../images/audit_event.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9f27af65195267af5f9ce4f3b7467326><img alt="Kubernetes Audit Event" class="lazy lightbox lightbox-image" loading=lazy src="../images/audit_event.png?width=40vw"></a></p><p>Next, you demonstrated how to enhance these metrics by adding key dimensions from the raw events, enabling us to drill down into specific actions and resources. you created a chart that filtered the metrics to focus on errors, breaking them out by resource and action. This allowed us to pinpoint exactly where issues were occurring in real-time.</p><p><a href=#R-image-610cd34d06b91910a3b981a74c567675 class=lightbox-link><img alt="Ingest Pipeline" class="lazy lightbox figure-image" loading=lazy src="../images/ingest_pipeline_dimensions.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-610cd34d06b91910a3b981a74c567675><img alt="Ingest Pipeline" class="lazy lightbox lightbox-image" loading=lazy src="../images/ingest_pipeline_dimensions.png?width=40vw"></a></p><p>The real-time architecture of <strong>Splunk Observability Cloud</strong> means that these metrics can trigger alerts the moment an issue is detected, significantly reducing the Mean Time to Detection (MTTD). Additionally, you showed how this chart can be easily saved to new or existing dashboards, ensuring ongoing visibility and monitoring of critical metrics.</p><p><a href=#R-image-daa0947a038d6cf53bc8244b99edb28f class=lightbox-link><img alt="Audit Dashboard" class="lazy lightbox figure-image" loading=lazy src="../images/audit_dashboard.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-daa0947a038d6cf53bc8244b99edb28f><img alt="Audit Dashboard" class="lazy lightbox lightbox-image" loading=lazy src="../images/audit_dashboard.png?width=40vw"></a></p><p>The value behind this approach is clear: by converting logs to metrics using <strong>Ingest Processor</strong>, you not only streamline data processing and reduce storage costs but also gain the ability to monitor and respond to issues in real-time using <strong>Splunk Observability Cloud</strong>. This results in faster problem resolution, improved system reliability, and more efficient resource utilization, all while maintaining the ability to retain and access the original logs for compliance or deeper analysis.</p><center><h1>Happy Splunking!</h1></center><p><a href=#R-image-43c7d4a418ae45831a3995e090e5f94c class=lightbox-link><img alt="Dancing Buttercup" class="lazy lightbox figure-image" loading=lazy src="../images/Splunk-dancing-buttercup-GIF-103.gif?width=30vw" style=height:auto;width:30vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-43c7d4a418ae45831a3995e090e5f94c><img alt="Dancing Buttercup" class="lazy lightbox lightbox-image" loading=lazy src="../images/Splunk-dancing-buttercup-GIF-103.gif?width=30vw"></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jul 23, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=monitoring-cisco-ai-pods-with-splunk-observability-cloud>Monitoring Cisco AI Pods with Splunk Observability Cloud</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Author
</span><span class=badge-content>Derek Mitchell</span></span><p><strong>Ciscoâ€™s AI-ready PODs</strong> combine the best of hardware and software technologies to create a robust, scalable, and efficient AI-ready infrastructure tailored to diverse needs.</p><p><strong>Splunk Observability Cloud</strong> provides comprehensive visibility into all of this infrastructure along with all the application components that are running on this stack.</p><p>The steps to configure Splunk Observability Cloud for a Cisco AI POD environment are fully documented (see <a href=https://github.com/signalfx/splunk-opentelemetry-examples/tree/main/collector/cisco-ai-ready-pods rel=external>here</a> for details).</p><p>However, it&rsquo;s not always possible to get access to a Cisco AI POD environment to practice the installation steps.</p><p>This workshop provides hands-on experience deploying and working with several of the technologies that are used to monitor Cisco AI PODs with Splunk Observability Cloud, without requiring access to an actual Cisco AI POD. This includes:</p><ul><li>Practice deploying a <strong>RedHat OpenShift</strong> cluster with GPU-based worker nodes.</li><li>Practice deploying the <strong>NVIDIA NIM Operator</strong> and <strong>NVIDIA GPU Operator</strong>.</li><li>Practice deploying <strong>Large Language Models (LLMs)</strong> using NVIDIA NIM to the cluster.</li><li>Practice deploying the <strong>OpenTelemetry Collector</strong> in the Red Hat OpenShift cluster.</li><li>Practice adding <strong>Prometheus</strong> receivers to the collector to ingest infrastructure metrics.</li><li>Practice deploying the <strong>Weaviate</strong> vector database to the cluster.</li><li>Practice instrumenting Python services that interact with Large Language Models (LLMs) with <strong>OpenTelemetry</strong>.</li><li>Understanding which details which OpenTelemetry captures in the trace from applications that interact with LLMs.</li></ul><blockquote><p>Please note: Red Hat OpenShift and NVIDIA AI Enterprise components
are typically pre-installed with an actual AI POD. However, because weâ€™re using AWS for this workshop,
itâ€™s necessary to perform these setup steps manually.</p></blockquote><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 12, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Monitoring Cisco AI Pods with Splunk Observability Cloud</h1><article class=default><header class=headline></header><h1 id=aws-setup>AWS Setup</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=enable-the-red-hat-openshift-service-in-aws>Enable the Red Hat OpenShift Service in AWS</h2><p>To deploy OpenShift in your AWS account, we&rsquo;ll need to first enable the
Red Hat OpenShift service using the <a href="https://us-east-1.console.aws.amazon.com/rosa/home?region=us-east-1#/" rel=external>AWS console</a>.</p><p>Next, follow the instructions to connect your AWS account with your Red Hat account.</p><h2 id=provision-an-ec2-instance>Provision an EC2 Instance</h2><p>Let&rsquo;s provision an EC2 instance that we&rsquo;ll use to deploy the Red Hat cluster. This avoids
the limitations running the ROSA command-line interface on Mac OS.</p><p>We used a t3.xlarge instance type using Ubuntu 24.04 LTS while creating the workshop,
but a smaller instance type can also be used.</p><p>ssh into the instance once it&rsquo;s up and running.</p><h2 id=clone-the-github-repository>Clone the GitHub Repository</h2><p>Clone the GitHub repository to your EC2 instance:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone https://github.com/splunk/observability-workshop.git
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> observability-workshop/workshop/cisco-ai-pods </span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 26, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=openshift-prerequisites>OpenShift Prerequisites</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>The steps below are required before deploying the OpenShift cluster in AWS.</p><h2 id=create-a-red-hat-login>Create a Red Hat Login</h2><p>The first thing we&rsquo;ll need to do is create an account with Red Hat, which we can do by
filling out the form
<a href="https://www.redhat.com/wapps/ugc/register.html?_flowId=register-flow&_flowExecutionKey=e1s1" rel=external>here</a>.</p><h2 id=install-the-aws-cli>Install the AWS CLI</h2><p>To install the AWS CLI on the EC2 instance provisioned previously, run the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl <span class=s2>&#34;https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip&#34;</span> -o <span class=s2>&#34;awscliv2.zip&#34;</span>
</span></span><span class=line><span class=cl>sudo apt install unzip
</span></span><span class=line><span class=cl>unzip awscliv2.zip
</span></span><span class=line><span class=cl>sudo ./aws/install</span></span></code></pre></div><p>Use the following command to ensure it was installed successfully:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws --version</span></span></code></pre></div><p>It should return something like the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>aws-cli/2.30.5 Python/3.13.7 Linux/6.14.0-1011-aws exe/x86_64.ubuntu.24</code></pre></div><p>Login to your AWS account using your preferred method. Refer to the
<a href=https://docs.aws.amazon.com/signin/latest/userguide/command-line-sign-in.html rel=external>documentation</a>
for guidance. For example, you can login by running the <code>aws configure</code> command.</p><p>Confirm you&rsquo;re logged in successfully by running a command such as <code>aws ec2 describe-instances</code>.</p><p>Then, verify your account identity with:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws sts get-caller-identity</span></span></code></pre></div><p>Check whether the service role for ELB (Elastic Load Balancing) exists:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws iam get-role --role-name <span class=s2>&#34;AWSServiceRoleForElasticLoadBalancing&#34;</span></span></span></code></pre></div><p>If the role does not exist, create it by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws iam create-service-linked-role --aws-service-name <span class=s2>&#34;elasticloadbalancing.amazonaws.com&#34;</span></span></span></code></pre></div><h2 id=install-the-rosa-cli>Install the ROSA CLI</h2><p>We&rsquo;ll use the ROSA command-line interface (CLI) for the deployment. The instructions are
based on <a href=https://docs.redhat.com/en/documentation/red_hat_openshift_service_on_aws_classic_architecture/4/html-single/install_rosa_classic_clusters/index#rosa-installing-and-configuring-the-rosa-cli_rosa-installing-cli rel=external>Red Hat documentation</a>.</p><p>You can download the latest release of the ROSA CLI for your operating system
<a href=https://console.redhat.com/openshift/downloads rel=external>here</a>.</p><p>Alternatively, we can use the following command to download the CLI binary directly
to our EC2 instance:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>curl -L -O https://mirror.openshift.com/pub/cgw/rosa/latest/rosa-linux.tar.gz</code></pre></div><p>Extract the contents:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>tar -xvzf rosa-linux.tar.gz</code></pre></div><p>Move the resulting file (<code>rosa</code>) to a location that&rsquo;s included as part of your path. For example:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mv rosa /usr/local/bin/rosa</span></span></code></pre></div><p>Log in to your Red Hat account by running the command below, then follow the instructions
in the command output:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>rosa login --use-device-code</code></pre></div><h2 id=install-the-openshift-cli-oc>Install the OpenShift CLI (oc)</h2><p>We can use the following command to download the OpenShift CLI binary directly
to our EC2 instance:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>curl -L -O https://mirror.openshift.com/pub/openshift-v4/x86_64/clients/ocp/stable/openshift-client-linux.tar.gz</code></pre></div><p>Extract the contents:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>tar -xvzf openshift-client-linux.tar.gz</code></pre></div><p>Move the resulting files (<code>oc</code> and <code>kubectl</code>) to a location that&rsquo;s included as part of your path. For example:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo mv oc /usr/local/bin/oc
</span></span><span class=line><span class=cl>sudo mv kubectl /usr/local/bin/kubectl</span></span></code></pre></div><h2 id=create-account-wide-roles-and-policies>Create Account-Wide Roles and Policies</h2><p>Use the following command to create the necessary account-wide roles and policies:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa create account-roles --mode auto</span></span></code></pre></div><h2 id=create-an-aws-vpc-for-rosa-hcp>Create an AWS VPC for ROSA HCP</h2><p>We&rsquo;re going to use the Hosted Control Plane (HCP) deployment option to
deploy our OpenShift cluster. To do this, we&rsquo;ll need to
create a new VPC in our AWS account using the following command:</p><blockquote><p>Note: update the region as appropriate for your environment.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa create network network-template --param <span class=nv>Region</span><span class=o>=</span>us-east-2 --template-dir<span class=o>=</span><span class=s1>&#39;.&#39;</span></span></span></code></pre></div><blockquote><p>Important: make note of the subnet ids created as a result of this command
as you&rsquo;ll need them when creating the cluster. Make a note of the CloudFormation
stack name as well, which will be needed later if you want to delete the network.</p></blockquote><blockquote><p>Note: by default, each AWS region is limited to 5 elastic IP addresses.<br>If you receive the following error:
&ldquo;The maximum number of addresses has been reached.&rdquo;
then you&rsquo;ll need to contact AWS to request an increase to this limit,
or choose another AWS region to create the VPC for ROSA.</p></blockquote><h2 id=create-an-openid-connect-configuration>Create an OpenID Connect configuration</h2><p>Before creating a Red Hat OpenShift Service on AWS cluster, let&rsquo;s create the OpenID Connect (OIDC)
configuration with the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa create oidc-config --mode<span class=o>=</span>auto --yes</span></span></code></pre></div><blockquote><p>Important: make note of the oidc-provider id that is created.</p></blockquote><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 30, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-openshift-cluster-in-aws>Deploy OpenShift Cluster in AWS</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>25 minutes</span>
</span>&nbsp;<h2 id=deploy-an-openshift-cluster>Deploy an OpenShift Cluster</h2><p>We&rsquo;ll use the ROSA CLI to deploy an OpenShift Cluster.</p><p>First, we&rsquo;ll need to set a few environment variables:</p><blockquote><p>Note: be sure to fill in the Subnet IDs and OIDC ID before running the EXPORT commands</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>CLUSTER_NAME</span><span class=o>=</span>rosa-test
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>AWS_REGION</span><span class=o>=</span>us-east-2
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>AWS_INSTANCE_TYPE</span><span class=o>=</span>g5.2xlarge
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SUBNET_IDS</span><span class=o>=</span>&lt;comma separated list of subnet IDs from earlier rosa create network command&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>OIDC_ID</span><span class=o>=</span>&lt;the oidc-provider id returned from the rosa create oidc-config command&gt; 
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>OPERATOR_ROLES_PREFIX</span><span class=o>=</span>rosa-test-a6x9</span></span></code></pre></div><p>Create operator roles for the OIDC configuration using the following command:</p><blockquote><p>Note: just accept the default values when prompted.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa create operator-roles --hosted-cp --prefix <span class=nv>$OPERATOR_ROLES_PREFIX</span> --oidc-config-id <span class=nv>$OIDC_ID</span></span></span></code></pre></div><p>Then we can create the cluster as follows:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa create cluster <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --cluster-name <span class=nv>$CLUSTER_NAME</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --mode auto <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --hosted-cp <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --sts <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --create-admin-user <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --operator-roles-prefix <span class=nv>$OPERATOR_ROLES_PREFIX</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --oidc-config-id <span class=nv>$OIDC_ID</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --subnet-ids <span class=nv>$SUBNET_IDS</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --compute-machine-type <span class=nv>$AWS_INSTANCE_TYPE</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --replicas <span class=m>2</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --region <span class=nv>$AWS_REGION</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --tags <span class=s2>&#34;splunkit_environment_type:non-prd,splunkit_data_classification:private&#34;</span></span></span></code></pre></div><blockquote><p>Note that we&rsquo;ve specified the <code>g5.2xlarge</code> instance type, which includes NVIDIA
GPUs that we&rsquo;ll be using later in the workshop. This instance type is relatively expensive,
about $1.21 per hour at the time of writing, and we&rsquo;ve requested 2 replicas,
so be mindful of how long your cluster is running for, as costs will accumulate quickly.</p></blockquote><p>To determine when your cluster is Ready, run:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa describe cluster -c <span class=nv>$CLUSTER_NAME</span></span></span></code></pre></div><p>To watch your cluster installation logs, run:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa logs install -c <span class=nv>$CLUSTER_NAME</span> --watch</span></span></code></pre></div><h2 id=connect-to-the-openshift-cluster>Connect to the OpenShift Cluster</h2><p>Use the command below to connect the oc CLI to your OpenShift cluster:</p><blockquote><p>Note: Run the <code>rosa describe cluster -c $CLUSTER_NAME</code> command and substitute the
resulting API Server URL into the command below before running it. For example,
the server name might be something like <code>https://api.rosa-test.aaa.bb.openshiftapps.com:443</code>.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl> oc login &lt;API Server URL&gt; -u cluster-admin</span></span></code></pre></div><p>Once connected to your cluster, confirm that the nodes are up and running:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get nodes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                       STATUS   ROLES    AGE   VERSION
</span></span><span class=line><span class=cl>ip-10-0-1-184.us-east-2.compute.internal   Ready    worker   14m   v1.31.11
</span></span><span class=line><span class=cl>ip-10-0-1-50.us-east-2.compute.internal    Ready    worker   20m   v1.31.11</span></span></code></pre></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 30, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-opentelemetry-collector>Deploy the OpenTelemetry Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Now that our OpenShift cluster is up and running, let&rsquo;s deploy the
OpenTelemetry Collector, which gathers metrics, logs, and traces
from the infrastructure and applications running in the cluster, and
sends the resulting data to Splunk Observability Cloud.</p><h2 id=deploy-the-opentelemetry-collector>Deploy the OpenTelemetry Collector</h2><p>First, we&rsquo;ll create a new project for the collector and switch to that project:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc new-project otel </span></span></code></pre></div><p>Ensure Helm is installed:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get install curl gpg apt-transport-https --yes
</span></span><span class=line><span class=cl>curl -fsSL https://packages.buildkite.com/helm-linux/helm-debian/gpgkey <span class=p>|</span> gpg --dearmor <span class=p>|</span> sudo tee /usr/share/keyrings/helm.gpg &gt; /dev/null
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [signed-by=/usr/share/keyrings/helm.gpg] https://packages.buildkite.com/helm-linux/helm-debian/any/ any main&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/helm-stable-debian.list
</span></span><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install helm</span></span></code></pre></div><p>Add the Splunk OpenTelemetry Collector for Kubernetes&rsquo; Helm chart repository:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart</span></span></code></pre></div><p>Ensure the repository is up-to-date:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo update</span></span></code></pre></div><p>Review the file named <code>./otel-collector/otel-collector-values.yaml</code> as we&rsquo;ll be using it
to install the OpenTelemetry collector.</p><p>Set environment variables to configure the Splunk environment you&rsquo;d like
the collector to send data to:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ENVIRONMENT_NAME</span><span class=o>=</span>&lt;which environment to send data to <span class=k>for</span> Splunk Observability Cloud&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SPLUNK_ACCESS_TOKEN</span><span class=o>=</span>&lt;your access token <span class=k>for</span> Splunk Observability Cloud&gt; 
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SPLUNK_REALM</span><span class=o>=</span>&lt;your realm <span class=k>for</span> Splunk Observability Cloud i.e. us0, us1, eu0, etc.&gt;
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SPLUNK_HEC_URL</span><span class=o>=</span>&lt;HEC endpoint to send logs to Splunk platform i.e. https://&lt;hostname&gt;:443/services/collector/event&gt; 
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SPLUNK_HEC_TOKEN</span><span class=o>=</span>&lt;HEC token to send logs to Splunk platform&gt; 
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>SPLUNK_INDEX</span><span class=o>=</span>&lt;name of index to send logs to in Splunk platform&gt;</span></span></code></pre></div><p>Then install the collector using the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm install splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$CLUSTER_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$ENVIRONMENT_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$SPLUNK_ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$SPLUNK_REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$SPLUNK_HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$SPLUNK_HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=</span><span class=nv>$SPLUNK_INDEX</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f ./otel-collector/otel-collector-values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n otel <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><p>Run the following command to confirm that all of the collector pods are running:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>oc get pods

NAME                                                          READY   STATUS    RESTARTS   AGE
splunk-otel-collector-agent-58rwm                             1/1     Running   0          6m40s
splunk-otel-collector-agent-8dndr                             1/1     Running   0          6m40s
splunk-otel-collector-k8s-cluster-receiver-7b7f5cdc5b-rhxsj   1/1     Running   0          6m40s</code></pre></div><p>Confirm that you can see the cluster in Splunk Observability Cloud by navigating to
Infrastructure Monitoring -> Kubernetes -> Kubernetes Pods and then filtering on your
cluster name:</p><p><a href=#R-image-aff408e75bb59729973c13abe4136f9d class=lightbox-link><img alt="Kubernetes Pods" class="lazy lightbox figure-image" loading=lazy src=../images/KubernetesPods.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aff408e75bb59729973c13abe4136f9d><img alt="Kubernetes Pods" class="lazy lightbox lightbox-image" loading=lazy src=../images/KubernetesPods.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-nvidia-nim-operator>Deploy the NVIDIA NIM Operator</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>The <strong>NVIDIA GPU Operator</strong> is a Kubernetes Operator that automates the deployment, configuration,
and management of all necessary NVIDIA software components to provision GPUs within a Kubernetes cluster.</p><p>The <strong>NVIDIA NIM Operator</strong> is used to deploy LLMs in Kubernetes environments, such
as the OpenShift cluster we created earlier in this workshop.</p><p>This section of the workshop walks through the steps necessary to deploy both the
NVIDIA GPU and NIM operators in our OpenShift cluster.</p><h2 id=create-a-nvidia-ngc-account>Create a NVIDIA NGC Account</h2><p>An NVIDIA GPU CLOUD (NGC) account is required to download LLMs and deploy them
using the NVIDIA NIM operator. You can register <a href=https://ngc.nvidia.com/signin rel=external>here</a>
to create an account.</p><h2 id=register-with-the-nvidia-developer-program>Register with the NVIDIA Developer Program</h2><p>Registering with the <a href=https://developer.nvidia.com/ rel=external>NVIDIA Developer Program</a> allows us
to get access to NVIDIA NIM, which we&rsquo;ll use later in the workshop to deploy LLMs.</p><p>Ensure that <code>NVIDIA Developer Program</code> appears on your list of NVIDIA subscriptions in NGC:</p><p><a href=#R-image-7c5de91c468ad593624694cbff57c588 class=lightbox-link><img alt="NVIDIA Subscriptions" class="lazy lightbox figure-image" loading=lazy src=../images/NVIDIA-Subscriptions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c5de91c468ad593624694cbff57c588><img alt="NVIDIA Subscriptions" class="lazy lightbox lightbox-image" loading=lazy src=../images/NVIDIA-Subscriptions.png></a></p><h2 id=generate-an-ngc-api-key>Generate an NGC API Key</h2><p>Once you&rsquo;re logged in to the NGC website, click on your user account icon on the
top-right corner of the screen and select <strong>Setup</strong>.</p><p>Then click <strong>Generate API Key</strong> and follow the instructions. Ensure the key is associated
with the <strong>NGC Catalog</strong> and <strong>Secrets Manager</strong> services.</p><p>Save the generated key in a safe place as we&rsquo;ll use it later in the workshop.</p><p>Refer to <a href=https://docs.nvidia.com/ngc/gpu-cloud/ngc-user-guide/index.html#generating-api-key rel=external>NVIDIA Documentation</a>
for further details on generating an NGC API key.</p><h2 id=install-the-node-feature-discovery-operator>Install the Node Feature Discovery Operator</h2><p>The steps in this section are based on <a href=https://docs.redhat.com/en/documentation/openshift_container_platform/4.18/html/specialized_hardware_and_driver_enablement/psap-node-feature-discovery-operator#install-operator-cli_psap-node-feature-discovery-operator rel=external>Installing the NFD Operator using the CLI </a>.</p><p>Run the following script to install the Node Feature Discovery Operator:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> nvidia
</span></span><span class=line><span class=cl>./install-nfd-operator.sh</span></span></code></pre></div><p>To verify that the Operator deployment is successful, run:</p><div class=tab-panel data-tab-group=R-tabs-9be4ea7f9f74d1319a497e1343248b1e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e46a90314b2b5421eb47cfdffb59a962 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9be4ea7f9f74d1319a497e1343248b1e","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-d502fed6611048add8f544a6afeea123 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-9be4ea7f9f74d1319a497e1343248b1e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-e46a90314b2b5421eb47cfdffb59a962 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get pods</span></span></code></pre></div></div></div><div id=R-tab-id-d502fed6611048add8f544a6afeea123 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                      READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>nfd-controller-manager-7f86ccfb58-vgr4x   2/2     Running   <span class=m>0</span>          10m</span></span></code></pre></div></div></div></div></div><h2 id=create-a-nodefeaturediscovery-cr>Create a NodeFeatureDiscovery CR</h2><p>The steps in this section are based on <a href=https://docs.redhat.com/en/documentation/openshift_container_platform/4.18/html/specialized_hardware_and_driver_enablement/psap-node-feature-discovery-operator#creating-nfd-cr-cli_psap-node-feature-discovery-operator rel=external>Creating a NodeFeatureDiscovery CR by using the CLI </a>.</p><p>Run the following script to create the Node Feature Discovery CR:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./create-nfd-cr.sh</span></span></code></pre></div><h2 id=install-the-nvidia-gpu-operator>Install the NVIDIA GPU Operator</h2><p>The steps in this section are based on <a href=https://docs.nvidia.com/datacenter/cloud-native/openshift/latest/install-gpu-ocp.html#installing-the-nvidia-gpu-operator-on-openshift rel=external>Installing the NVIDIA GPU Operator on OpenShift</a>.</p><p>Run the following script to install the NVIDIA GPU Operator:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./install-nvidia-gpu-operator.sh</span></span></code></pre></div><p>Wait until the install plan has been created:</p><div class=tab-panel data-tab-group=R-tabs-b57539685866798912d8c77d45864a29><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-516e0a1d04f5f95d644aa114f9bbf4b4 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b57539685866798912d8c77d45864a29","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-fb0bacf524993c121bff80ad683b0dcb aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b57539685866798912d8c77d45864a29","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-516e0a1d04f5f95d644aa114f9bbf4b4 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get installplan -n nvidia-gpu-operator</span></span></code></pre></div></div></div><div id=R-tab-id-fb0bacf524993c121bff80ad683b0dcb data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME            CSV                              APPROVAL   APPROVED
</span></span><span class=line><span class=cl>install-mmlxq   gpu-operator-certified.v25.3.4   Manual     false</span></span></code></pre></div></div></div></div></div><p>Approve the install plan with the following commands:</p><div class=tab-panel data-tab-group=R-tabs-cdf58b3e81d9605f3aeef9847451ec24><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f6880a399583d88a95c5093e1042e52d aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-cdf58b3e81d9605f3aeef9847451ec24","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-3e4432543de88545bdfb11007e5bea1c aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-cdf58b3e81d9605f3aeef9847451ec24","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-f6880a399583d88a95c5093e1042e52d data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>INSTALL_PLAN</span><span class=o>=</span><span class=k>$(</span>oc get installplan -n nvidia-gpu-operator -oname<span class=k>)</span>
</span></span><span class=line><span class=cl>oc patch <span class=nv>$INSTALL_PLAN</span> -n nvidia-gpu-operator --type merge --patch <span class=s1>&#39;{&#34;spec&#34;:{&#34;approved&#34;:true }}&#39;</span></span></span></code></pre></div></div></div><div id=R-tab-id-3e4432543de88545bdfb11007e5bea1c data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>installplan.operators.coreos.com/install-rc9xq patched</span></span></code></pre></div></div></div></div></div><h2 id=create-the-cluster-policy>Create the Cluster Policy</h2><p>The steps in this section are based on <a href=https://docs.nvidia.com/datacenter/cloud-native/openshift/latest/install-gpu-ocp.html#create-the-cluster-policy-using-the-cli rel=external>Create the cluster policy using the CLI</a>.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./create-cluster-policy.sh</span></span></code></pre></div><h2 id=verify-the-nvidia-gpu-operator-installation>Verify the NVIDIA GPU Operator Installation</h2><p>Verify the successful installation of the NVIDIA GPU Operator using the following command:</p><div class=tab-panel data-tab-group=R-tabs-c595cc92df04d82a8ced4c376e148a11><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-416d11b3ad55c08a3a03bf6b74c9cd2d aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c595cc92df04d82a8ced4c376e148a11","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-ad83cd0ae767a8dbbcd06fd006bfdf9d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-c595cc92df04d82a8ced4c376e148a11","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-416d11b3ad55c08a3a03bf6b74c9cd2d data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get pods,daemonset -n nvidia-gpu-operator</span></span></code></pre></div></div></div><div id=R-tab-id-ad83cd0ae767a8dbbcd06fd006bfdf9d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                      READY   STATUS      RESTARTS      AGE
</span></span><span class=line><span class=cl>pod/gpu-feature-discovery-sblkn                           1/1     Running     <span class=m>0</span>             5m5s
</span></span><span class=line><span class=cl>pod/gpu-feature-discovery-zpt94                           1/1     Running     <span class=m>0</span>             4m58s
</span></span><span class=line><span class=cl>pod/gpu-operator-6579bc6fdc-cp28l                         1/1     Running     <span class=m>0</span>             23m
</span></span><span class=line><span class=cl>pod/nvidia-container-toolkit-daemonset-qfcl9              1/1     Running     <span class=m>0</span>             5m5s
</span></span><span class=line><span class=cl>pod/nvidia-container-toolkit-daemonset-zbwb6              1/1     Running     <span class=m>0</span>             4m59s
</span></span><span class=line><span class=cl>pod/nvidia-cuda-validator-f7tl2                           0/1     Completed   <span class=m>0</span>             78s
</span></span><span class=line><span class=cl>pod/nvidia-cuda-validator-t7n9g                           0/1     Completed   <span class=m>0</span>             71s
</span></span><span class=line><span class=cl>pod/nvidia-dcgm-exporter-gk66x                            1/1     Running     <span class=m>0</span>             4m59s
</span></span><span class=line><span class=cl>pod/nvidia-dcgm-exporter-w8kr8                            1/1     Running     <span class=m>2</span> <span class=o>(</span>52s ago<span class=o>)</span>   5m5s
</span></span><span class=line><span class=cl>pod/nvidia-dcgm-lrnzr                                     1/1     Running     <span class=m>0</span>             4m58s
</span></span><span class=line><span class=cl>pod/nvidia-dcgm-tvrdm                                     1/1     Running     <span class=m>0</span>             5m5s
</span></span><span class=line><span class=cl>pod/nvidia-device-plugin-daemonset-d62nk                  1/1     Running     <span class=m>0</span>             5m5s
</span></span><span class=line><span class=cl>pod/nvidia-device-plugin-daemonset-fnv4j                  1/1     Running     <span class=m>0</span>             4m59s
</span></span><span class=line><span class=cl>pod/nvidia-driver-daemonset-418.94.202509100653-0-5xbvq   2/2     Running     <span class=m>0</span>             5m48s
</span></span><span class=line><span class=cl>pod/nvidia-driver-daemonset-418.94.202509100653-0-hmkdl   2/2     Running     <span class=m>0</span>             5m48s
</span></span><span class=line><span class=cl>pod/nvidia-node-status-exporter-2kqwr                     1/1     Running     <span class=m>0</span>             5m44s
</span></span><span class=line><span class=cl>pod/nvidia-node-status-exporter-n8d9s                     1/1     Running     <span class=m>0</span>             5m44s
</span></span><span class=line><span class=cl>pod/nvidia-operator-validator-r2nm2                       1/1     Running     <span class=m>0</span>             5m5s
</span></span><span class=line><span class=cl>pod/nvidia-operator-validator-w2fpn                       1/1     Running     <span class=m>0</span>             4m59s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                           DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR                                                                                                         AGE
</span></span><span class=line><span class=cl>daemonset.apps/gpu-feature-discovery                           <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.gpu-feature-discovery<span class=o>=</span><span class=nb>true</span>                                                                      5m45s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-container-toolkit-daemonset              <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.container-toolkit<span class=o>=</span><span class=nb>true</span>                                                                          5m48s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-dcgm                                     <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.dcgm<span class=o>=</span><span class=nb>true</span>                                                                                       5m46s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-dcgm-exporter                            <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.dcgm-exporter<span class=o>=</span><span class=nb>true</span>                                                                              5m46s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-device-plugin-daemonset                  <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.device-plugin<span class=o>=</span><span class=nb>true</span>                                                                              5m47s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-device-plugin-mps-control-daemon         <span class=m>0</span>         <span class=m>0</span>         <span class=m>0</span>       <span class=m>0</span>            <span class=m>0</span>           nvidia.com/gpu.deploy.device-plugin<span class=o>=</span>true,nvidia.com/mps.capable<span class=o>=</span><span class=nb>true</span>                                                  5m47s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-driver-daemonset-418.94.202509100653-0   <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           feature.node.kubernetes.io/system-os_release.OSTREE_VERSION<span class=o>=</span>418.94.202509100653-0,nvidia.com/gpu.deploy.driver<span class=o>=</span><span class=nb>true</span>   5m48s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-mig-manager                              <span class=m>0</span>         <span class=m>0</span>         <span class=m>0</span>       <span class=m>0</span>            <span class=m>0</span>           nvidia.com/gpu.deploy.mig-manager<span class=o>=</span><span class=nb>true</span>                                                                                5m45s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-node-status-exporter                     <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.node-status-exporter<span class=o>=</span><span class=nb>true</span>                                                                       5m44s
</span></span><span class=line><span class=cl>daemonset.apps/nvidia-operator-validator                       <span class=m>2</span>         <span class=m>2</span>         <span class=m>2</span>       <span class=m>2</span>            <span class=m>2</span>           nvidia.com/gpu.deploy.operator-validator<span class=o>=</span><span class=nb>true</span>                                                                         5m48s</span></span></code></pre></div></div></div></div></div><h2 id=install-the-operator-sdk>Install the Operator SDK</h2><p>The steps in this section are based on <a href=https://sdk.operatorframework.io/docs/installation/#install-from-github-release rel=external>Install from GitHub release</a>.</p><h3 id=download-the-release-binary>Download the release binary</h3><p>Set platform information:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>ARCH</span><span class=o>=</span><span class=k>$(case</span> <span class=k>$(</span>uname -m<span class=k>)</span> in x86_64<span class=k>)</span> <span class=nb>echo</span> -n amd64 <span class=p>;;</span> aarch64<span class=o>)</span> <span class=nb>echo</span> -n arm64 <span class=p>;;</span> *<span class=o>)</span> <span class=nb>echo</span> -n <span class=k>$(</span>uname -m<span class=k>)</span> <span class=p>;;</span> <span class=k>esac</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nb>export</span> <span class=nv>OS</span><span class=o>=</span><span class=k>$(</span>uname <span class=p>|</span> awk <span class=s1>&#39;{print tolower($0)}&#39;</span><span class=k>)</span></span></span></code></pre></div><p>Download the binary for your platform:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>OPERATOR_SDK_DL_URL</span><span class=o>=</span>https://github.com/operator-framework/operator-sdk/releases/download/v1.41.1
</span></span><span class=line><span class=cl>curl -LO <span class=si>${</span><span class=nv>OPERATOR_SDK_DL_URL</span><span class=si>}</span>/operator-sdk_<span class=si>${</span><span class=nv>OS</span><span class=si>}</span>_<span class=si>${</span><span class=nv>ARCH</span><span class=si>}</span></span></span></code></pre></div><h3 id=verify-the-downloaded-binary>Verify the downloaded binary</h3><p>Import the operator-sdk release GPG key from keyserver.ubuntu.com:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg --keyserver keyserver.ubuntu.com --recv-keys 052996E2A20B5C7E</span></span></code></pre></div><p>Download the checksums file and its signature, then verify the signature:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -LO <span class=si>${</span><span class=nv>OPERATOR_SDK_DL_URL</span><span class=si>}</span>/checksums.txt
</span></span><span class=line><span class=cl>curl -LO <span class=si>${</span><span class=nv>OPERATOR_SDK_DL_URL</span><span class=si>}</span>/checksums.txt.asc
</span></span><span class=line><span class=cl>gpg -u <span class=s2>&#34;Operator SDK (release) &lt;cncf-operator-sdk@cncf.io&gt;&#34;</span> --verify checksums.txt.asc</span></span></code></pre></div><p>You should see something similar to the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gpg: assuming signed data in <span class=s1>&#39;checksums.txt&#39;</span>
</span></span><span class=line><span class=cl>gpg: Signature made Fri <span class=m>30</span> Oct <span class=m>2020</span> 12:15:15 PM PDT
</span></span><span class=line><span class=cl>gpg:                using RSA key ADE83605E945FA5A1BD8639C59E5B47624962185
</span></span><span class=line><span class=cl>gpg: Good signature from <span class=s2>&#34;Operator SDK (release) &lt;cncf-operator-sdk@cncf.io&gt;&#34;</span> <span class=o>[</span>ultimate<span class=o>]</span></span></span></code></pre></div><p>Make sure the checksums match:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>grep operator-sdk_<span class=si>${</span><span class=nv>OS</span><span class=si>}</span>_<span class=si>${</span><span class=nv>ARCH</span><span class=si>}</span> checksums.txt <span class=p>|</span> sha256sum -c -</span></span></code></pre></div><p>You should see something similar to the following:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>operator-sdk_linux_amd64: OK</span></span></code></pre></div><h3 id=install-the-release-binary-in-your-path>Install the release binary in your PATH</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x operator-sdk_<span class=si>${</span><span class=nv>OS</span><span class=si>}</span>_<span class=si>${</span><span class=nv>ARCH</span><span class=si>}</span> <span class=o>&amp;&amp;</span> sudo mv operator-sdk_<span class=si>${</span><span class=nv>OS</span><span class=si>}</span>_<span class=si>${</span><span class=nv>ARCH</span><span class=si>}</span> /usr/local/bin/operator-sdk</span></span></code></pre></div><h2 id=install-the-ngc-cli>Install the NGC CLI</h2><p>The steps in this section are based on <a href=https://org.ngc.nvidia.com/setup/installers/cli rel=external>NGC CLI Install</a>.</p><p>Click Download CLI to download the zip file that contains the binary, then transfer the zip file to a directory where you have permissions and then unzip and execute the binary. You can also download, unzip, and install from the command line by moving to a directory where you have execute permissions and then running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>wget --content-disposition https://api.ngc.nvidia.com/v2/resources/nvidia/ngc-apps/ngc_cli/versions/4.3.0/files/ngccli_linux.zip -O ngccli_linux.zip <span class=o>&amp;&amp;</span> unzip ngccli_linux.zip</span></span></code></pre></div><p>Check the binary&rsquo;s md5 hash to ensure the file wasn&rsquo;t corrupted during download:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>find ngc-cli/ -type f -exec md5sum <span class=o>{}</span> + <span class=p>|</span> <span class=nv>LC_ALL</span><span class=o>=</span>C sort <span class=p>|</span> md5sum -c ngc-cli.md5</span></span></code></pre></div><p>Check the binary&rsquo;s SHA256 hash to ensure the file wasn&rsquo;t corrupted during download. Run the following command</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sha256sum ngccli_linux.zip</span></span></code></pre></div><p>Compare with the following value, which can also be found in the Release Notes of the Resource:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>5f01eff85a66c895002f3c87db2933c462f3b86e461e60d515370f647b4ffc21</span></span></code></pre></div><p>After verifying value, make the NGC CLI binary executable and add your current directory to path:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod u+x ngc-cli/ngc
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;export PATH=\&#34;\$PATH:</span><span class=k>$(</span><span class=nb>pwd</span><span class=k>)</span><span class=s2>/ngc-cli\&#34;&#34;</span> &gt;&gt; ~/.bash_profile <span class=o>&amp;&amp;</span> <span class=nb>source</span> ~/.bash_profile</span></span></code></pre></div><p>You must configure NGC CLI for your use so that you can run the commands.</p><p>Enter the following command, including your API key when prompted:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ngc config set</span></span></code></pre></div><p>Define an environment variable with your NGC API key:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>NGC_API_KEY</span><span class=o>=</span>&lt;your NGC API key&gt; </span></span></code></pre></div><h2 id=install-the-nvidia-nim-operator>Install the NVIDIA NIM Operator</h2><p>The steps in this section are based on <a href=https://docs.nvidia.com/nim-operator/latest/install.html#installing-nim-operator-on-red-hat-openshift-using-operator-sdk-for-development-only rel=external>Installing NIM Operator on Red Hat OpenShift Using operator-sdk (for Development-Only)</a>.</p><p>Run the following script to install the NIM operator:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./install-nim-operator.sh</span></span></code></pre></div><p>Confirm the controller pod is running:</p><div class=tab-panel data-tab-group=R-tabs-cb299b796b9dcc7f9a8a0a375a1bca9f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-5e3a136a99cc1f7382d1a9d46c15213f aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-cb299b796b9dcc7f9a8a0a375a1bca9f","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-ff46410e90fca78aa96a04020f0f9403 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-cb299b796b9dcc7f9a8a0a375a1bca9f","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-5e3a136a99cc1f7382d1a9d46c15213f data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get pods -n nvidia-nim-operator</span></span></code></pre></div></div></div><div id=R-tab-id-ff46410e90fca78aa96a04020f0f9403 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                              READY   STATUS      RESTARTS   AGE
</span></span><span class=line><span class=cl>ec60a4439c710b89fc2582f5384382b4241f9aee62bb3182b8d128e69dx54dc   0/1     Completed   <span class=m>0</span>          61s
</span></span><span class=line><span class=cl>ghcr-io-nvidia-k8s-nim-operator-bundle-latest-main                1/1     Running     <span class=m>0</span>          71s
</span></span><span class=line><span class=cl>k8s-nim-operator-86d478b55c-w5cf5                                 1/1     Running     <span class=m>0</span>          50s</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-an-llm>Deploy an LLM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<p>In this section, we&rsquo;ll use the NVIDIA NIM Operator to deploy two Large Language Models
to our OpenShift Cluster.</p><h2 id=create-a-namespace>Create a Namespace</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc create namespace nim-service</span></span></code></pre></div><h2 id=add-secrets-with-ngc-api-key>Add Secrets with NGC API Key</h2><p>Add a Docker registry secret for downloading container images from NVIDIA NGC:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc create secret -n nim-service docker-registry ngc-secret <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker-server<span class=o>=</span>nvcr.io <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker-username<span class=o>=</span><span class=s1>&#39;$oauthtoken&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --docker-password<span class=o>=</span><span class=nv>$NGC_API_KEY</span></span></span></code></pre></div><p>Add a generic secret that model puller containers use to download the model from NVIDIA NGC:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc create secret -n nim-service generic ngc-api-secret <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --from-literal<span class=o>=</span><span class=nv>NGC_API_KEY</span><span class=o>=</span><span class=nv>$NGC_API_KEY</span></span></span></code></pre></div><h2 id=deploy-an-llm>Deploy an LLM</h2><p>Run the following command to create the NIMCache and NIMService:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc apply -n nim-service -f nvidia-llm.yaml</span></span></code></pre></div><p>Confirm that the Persistent Volume was created and the Persistent Volume Claim
was bound to is successfully:</p><blockquote><p>Note: this can take several minutes to occur</p></blockquote><div class=tab-panel data-tab-group=R-tabs-be83bf1c7e7ba432c57d80377bbf0e0e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-276ee7389e67e16d2f40e99c5d2e46d8 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-be83bf1c7e7ba432c57d80377bbf0e0e","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-97e71675a1d362b8b61abecba441699d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-be83bf1c7e7ba432c57d80377bbf0e0e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-276ee7389e67e16d2f40e99c5d2e46d8 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get pv,pvc -n nim-service</span></span></code></pre></div></div></div><div id=R-tab-id-97e71675a1d362b8b61abecba441699d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                                                        CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                                                   STORAGECLASS   VOLUMEATTRIBUTESCLASS   REASON   AGE
</span></span><span class=line><span class=cl>persistentvolume/pvc-1af12c04-29ad-497f-b018-7d9a3aea3019   100Gi      RWO            Delete           Bound    openshift-monitoring/prometheus-data-prometheus-k8s-1   gp3-csi        &lt;unset&gt;                          4h15m
</span></span><span class=line><span class=cl>persistentvolume/pvc-9c389d79-13fb-4169-9d99-a77efd6e7919   100Gi      RWO            Delete           Bound    openshift-monitoring/prometheus-data-prometheus-k8s-0   gp3-csi        &lt;unset&gt;                          4h15m
</span></span><span class=line><span class=cl>persistentvolume/pvc-a603b8a7-1445-4b03-945a-3ed68338834c   50Gi       RWO            Delete           Bound    nim-service/meta-llama-3-2-1b-instruct-pvc              gp3-csi        &lt;unset&gt;                          114s
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NAME                                                   STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   VOLUMEATTRIBUTESCLASS   AGE
</span></span><span class=line><span class=cl>persistentvolumeclaim/meta-llama-3-2-1b-instruct-pvc   Bound    pvc-a603b8a7-1445-4b03-945a-3ed68338834c   50Gi       RWO            gp3-csi        &lt;unset&gt;                 7m8s</span></span></code></pre></div></div></div></div></div><p>Confirm that the NIMCache is Ready:</p><div class=tab-panel data-tab-group=R-tabs-c3a90f35f3f32cbab01aa3aec7724618><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-62dc4aa94dfe0d0a34461fcb7a667f59 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c3a90f35f3f32cbab01aa3aec7724618","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-673b51f027cffeda81bba8e95a0875e9 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-c3a90f35f3f32cbab01aa3aec7724618","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-62dc4aa94dfe0d0a34461fcb7a667f59 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get nimcache.apps.nvidia.com -n nim-service</span></span></code></pre></div></div></div><div id=R-tab-id-673b51f027cffeda81bba8e95a0875e9 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                         STATUS   PVC                              AGE
</span></span><span class=line><span class=cl>meta-llama-3-2-1b-instruct   Ready    meta-llama-3-2-1b-instruct-pvc   9m50s</span></span></code></pre></div></div></div></div></div><p>Confirm that the NIMService is Ready:</p><div class=tab-panel data-tab-group=R-tabs-8c162b3fc2c68ce73ba434ea22f90501><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-25bac1696350d267cc4668ef443f4480 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-8c162b3fc2c68ce73ba434ea22f90501","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-9e7a6cf21fa6c9aef42a686c2e029aad aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-8c162b3fc2c68ce73ba434ea22f90501","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-25bac1696350d267cc4668ef443f4480 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get nimservices.apps.nvidia.com -n nim-service</span></span></code></pre></div></div></div><div id=R-tab-id-9e7a6cf21fa6c9aef42a686c2e029aad data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                         STATUS   AGE
</span></span><span class=line><span class=cl>meta-llama-3-2-1b-instruct   Ready    11m</span></span></code></pre></div></div></div></div></div><h2 id=test-the-llm>Test the LLM</h2><p>Let&rsquo;s ensure the LLM is working as expected.</p><p>Start a pod that has access to the curl command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc run --rm -it -n default curl --image<span class=o>=</span>curlimages/curl:latest -- sh</span></span></code></pre></div><p>Then run the following command to send a prompt to the LLM:</p><div class=tab-panel data-tab-group=R-tabs-912e0e1c226e1f68c4de67dfeeea9c94><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-96ee774f3e4e2251fb57f1c219cfbd27 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-912e0e1c226e1f68c4de67dfeeea9c94","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-a1bff46a5f5dfd7be54a9b3f63247fe8 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-912e0e1c226e1f68c4de67dfeeea9c94","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-96ee774f3e4e2251fb57f1c219cfbd27 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X <span class=s2>&#34;POST&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> <span class=s1>&#39;http://meta-llama-3-2-1b-instruct.nim-service:8000/v1/chat/completions&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s1>&#39;Accept: application/json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s1>&#39;Content-Type: application/json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;model&#34;: &#34;meta/llama-3.2-1b-instruct&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;messages&#34;: [
</span></span></span><span class=line><span class=cl><span class=s1>        {
</span></span></span><span class=line><span class=cl><span class=s1>          &#34;content&#34;:&#34;What is the capital of Canada?&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>          &#34;role&#34;: &#34;user&#34;
</span></span></span><span class=line><span class=cl><span class=s1>        }],
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;top_p&#34;: 1,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;n&#34;: 1,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;max_tokens&#34;: 1024,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;stream&#34;: false,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;frequency_penalty&#34;: 0.0,
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;stop&#34;: [&#34;STOP&#34;]
</span></span></span><span class=line><span class=cl><span class=s1>      }&#39;</span></span></span></code></pre></div></div></div><div id=R-tab-id-a1bff46a5f5dfd7be54a9b3f63247fe8 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;id&#34;</span>: <span class=s2>&#34;chatcmpl-2ccfcd75a0214518aab0ef0375f8ca21&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;object&#34;</span>: <span class=s2>&#34;chat.completion&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;created&#34;</span>: 1758919002,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;model&#34;</span>: <span class=s2>&#34;meta/llama-3.2-1b-instruct&#34;</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;choices&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>    <span class=o>{</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;index&#34;</span>: 0,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;message&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;role&#34;</span>: <span class=s2>&#34;assistant&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;reasoning_content&#34;</span>: null,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;content&#34;</span>: <span class=s2>&#34;The capital of Canada is Ottawa.&#34;</span>,
</span></span><span class=line><span class=cl>        <span class=s2>&#34;tool_calls&#34;</span>: <span class=o>[]</span>
</span></span><span class=line><span class=cl>      <span class=o>}</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;logprobs&#34;</span>: null,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;finish_reason&#34;</span>: <span class=s2>&#34;stop&#34;</span>,
</span></span><span class=line><span class=cl>      <span class=s2>&#34;stop_reason&#34;</span>: null
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>  <span class=o>]</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;usage&#34;</span>: <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;prompt_tokens&#34;</span>: 42,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;total_tokens&#34;</span>: 50,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;completion_tokens&#34;</span>: 8,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;prompt_tokens_details&#34;</span>: null
</span></span><span class=line><span class=cl>  <span class=o>}</span>,
</span></span><span class=line><span class=cl>  <span class=s2>&#34;prompt_logprobs&#34;</span>: null
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div></div></div></div></div><h2 id=deploy-an-embeddings-model>Deploy an Embeddings Model</h2><p>We&rsquo;re also going to deploy an <a href=https://build.nvidia.com/nvidia/llama-3_2-nv-embedqa-1b-v2/deploy rel=external>embeddings model</a>
in our cluster, which will be used later in the workshop to implement Retrieval Augmented Generation (RAG).</p><p>Run the following command to deploy the embeddings model:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc apply -n nim-service -f nvidia-embeddings.yaml</span></span></code></pre></div><p>Confirm that the NIMService is Ready:</p><div class=tab-panel data-tab-group=R-tabs-10627278465e9cf0a8d323b8e2167369><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-be46d4a7f07a02717b3aba71f5ba5e3e aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-10627278465e9cf0a8d323b8e2167369","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-6d6bd63279e245f54b236d45207494c2 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-10627278465e9cf0a8d323b8e2167369","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-be46d4a7f07a02717b3aba71f5ba5e3e data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc get nimservices.apps.nvidia.com llama-32-nv-embedqa-1b-v2 -n nim-service</span></span></code></pre></div></div></div><div id=R-tab-id-6d6bd63279e245f54b236d45207494c2 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>NAME                        STATUS   AGE
</span></span><span class=line><span class=cl>llama-32-nv-embedqa-1b-v2   Ready    82s</span></span></code></pre></div></div></div></div></div><h2 id=test-the-embeddings-model>Test the Embeddings Model</h2><p>Let&rsquo;s ensure the embeddings is working as expected.</p><p>Start a pod that has access to the curl command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc run --rm -it -n default curl --image<span class=o>=</span>curlimages/curl:latest -- sh</span></span></code></pre></div><p>Then run the following command to send a prompt to the LLM:</p><div class=tab-panel data-tab-group=R-tabs-da44ff3aceabd4f61353d783dd3bf953><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-cfcca1b8effce5f9cae1fb05d9d83241 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-da44ff3aceabd4f61353d783dd3bf953","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-6b452d1cca9edf3ce71adec2fab35bde aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-da44ff3aceabd4f61353d783dd3bf953","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-cfcca1b8effce5f9cae1fb05d9d83241 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>  curl -X POST http://llama-32-nv-embedqa-1b-v2.nim-service:8000/v1/embeddings <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s1>&#39;Accept: application/json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;input&#34;: [&#34;What is the capital of France?&#34;],
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;model&#34;: &#34;nvidia/llama-3.2-nv-embedqa-1b-v2&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;input_type&#34;: &#34;query&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;encoding_format&#34;: &#34;float&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;truncate&#34;: &#34;NONE&#34;
</span></span></span><span class=line><span class=cl><span class=s1>  }&#39;</span></span></span></code></pre></div></div></div><div id=R-tab-id-6b452d1cca9edf3ce71adec2fab35bde data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>{</span><span class=s2>&#34;object&#34;</span>:<span class=s2>&#34;list&#34;</span>,<span class=s2>&#34;data&#34;</span>:<span class=o>[{</span><span class=s2>&#34;index&#34;</span>:0,<span class=s2>&#34;embedding&#34;</span>:<span class=o>[</span>-0.016632080078125,0.041259765625,-0.0156707763671875,0.032379150390625,0.045074462890625,0.0169830322265625,-0.03546142578125,-0.0003402233123779297,-0.038909912109375,-0.0023651123046875,-0.0001741647720336914,-0.01377105712890625,-0.01200103759765625,-0.00659942626953125,0.002536773681640625,0.0185394287109375,0.01546478271484375,0.0216827392578125,0.0139923095703125,-0.0121612548828125,-0.015869140625,0.005313873291015625,-0.020599365234375,0.02984619140625,-0.031982421875,0.0005679130554199219,-0.021697998046875,-0.0305938720703125,0.027618408203125,0.005340576171875,0.011993408203125,0.0135345458984375,-0.015625,0.036651611328125,-0.0210113525390625,0.0033321380615234375,0.033172607421875,-0.009552001953125,0.0226287841796875,0.01448822021484375,-0.05474853515625,-0.00861358642578125,-0.01513671875,-0.028656005859375,-0.0095977783203125,-0.025146484375,-0.0352783203125,0.03106689453125,-0.00726318359375,0.0157623291015625,0.01319122314453125,-0.005218505859375,-0.0013561248779296875,0.01277923583984375,-0.007328033447265625,0.01486968994140625,-0.05413818359375,-0.022125244140625,-0.015869140625,-0.00917816162109375,0.0186309814453125,-0.00814056396484375,-0.04730224609375,0.01406097412109375,-0.0248260498046875,0.0094757080078125,0.0309600830078125,0.0196533203125,-0.0270843505859375,-0.01113128662109375,-0.0056915283203125,-0.01154327392578125,0.037750244140625,-0.0028896331787109375,-0.00376129150390625,0.03692626953125,0.020416259765625,0.00200653076171875,0.0396728515625,0.004985809326171875,-0.04425048828125,-0.034820556640625,-0.0102386474609375,0.0218505859375,0.003604888916015625,0.00940704345703125,0.01468658447265625,0.0089111328125,-0.0032196044921875,-0.043243408203125,0.015411376953125,-0.00653839111328125,-0.01128387451171875,-0.052734375,0.032684326171875,-0.0101470947265625,-0.018218994140625,-0.003955841064453125,0.007648468017578125,-0.02044677734375,-0.0285186767578125,0.0153350830078125,0.03692626953125,0.0147247314453125,0.01043701171875,0.0007462501525878906,0.0261077880859375,0.024169921875,-0.040283203125,-0.005828857421875,0.00736236572265625,-0.00909423828125,0.00920867919921875,-0.00243377685546875,-0.03204345703125,-0.0232696533203125,0.01131439208984375,-0.0192413330078125,-0.025482177734375,-0.0267333984375,-0.03350830078125,-0.0008440017700195312,-0.040496826171875,0.0281982421875,-0.03533935546875,-0.0005216598510742188,0.061859130859375,0.0439453125,-0.00656890869140625,0.004627227783203125,-0.05615234375,0.027801513671875,-0.0027790069580078125,-0.011322021484375,-0.00841522216796875,0.027191162109375,-0.0018453598022460938,-0.00560760498046875,0.020263671875,-0.0295867919921875,0.03759765625,-0.00951385498046875,0.014190673828125,-0.039764404296875,-0.0199127197265625,-0.007427215576171875,-0.021392822265625,0.00946807861328125,0.03955078125,0.0015478134155273438,0.0227203369140625,0.020843505859375,-0.00531768798828125,0.0087432861328125,-0.01617431640625,0.002574920654296875,0.0104217529296875,0.01215362548828125,0.00970458984375,0.003803253173828125,0.005451202392578125,-0.001972198486328125,-0.01171875,-0.0216217041015625,0.033355712890625,-0.007137298583984375,0.00890350341796875,-0.01293182373046875,0.0189666748046875,-0.0168609619140625,-0.0153350830078125,0.0113525390625,-0.0123443603515625,0.046905517578125,0.0082244873046875,-0.019500732421875,0.004482269287109375,0.01007080078125,0.0037708282470703125,0.053619384765625,0.0171051025390625,-0.0305023193359375,-0.0240478515625,0.007648468017578125,-0.03973388671875,0.00847625732421875,-0.0207061767578125,-0.025115966796875,0.0168914794921875,0.03619384765625,0.00720977783203125,0.00803375244140625,0.022064208984375,-0.01111602783203125,-0.0024890899658203125,0.0047760009765625,-0.02374267578125,-0.0197296142578125,0.0203704833984375,0.00572967529296875,0.0254058837890625,0.0186920166015625,-0.022796630859375,-0.02191162109375,-0.0182952880859375,-0.00365447998046875,-0.01262664794921875,-0.0128326416015625,0.0157318115234375,-0.004596710205078125,0.033843994140625,0.01313018798828125,0.00656890869140625,0.0004596710205078125,-0.020355224609375,0.03411865234375,0.00034546852111816406,0.0205230712890625,0.02960205078125,-0.0157318115234375,-0.051483154296875,-0.0255584716796875,0.039825439453125,0.0258636474609375,0.038238525390625,-0.03424072265625,0.0188140869140625,0.03216552734375,-0.048126220703125,-0.0227203369140625,0.0032215118408203125,-0.0156097412109375,-0.003170013427734375,0.01444244384765625,-0.0232086181640625,0.002437591552734375,0.012451171875,-0.0066680908203125,0.01158905029296875,0.026397705078125,-0.00373077392578125,0.008087158203125,-0.00798797607421875,-0.0173187255859375,-0.013580322265625,0.033660888671875,-0.0028629302978515625,0.046295166015625,0.0299530029296875,-0.0159759521484375,-0.005580902099609375,0.0015277862548828125,0.01123046875,0.0031585693359375,-0.01151275634765625,0.00814056396484375,-0.0369873046875,0.0267181396484375,0.0013856887817382812,0.028656005859375,0.01409149169921875,0.035614013671875,-0.01189422607421875,-0.01190185546875,-0.053619384765625,0.037139892578125,-0.02288818359375,-0.024139404296875,0.01678466796875,-0.01020050048828125,-0.0222930908203125,-0.01059722900390625,0.044525146484375,0.006526947021484375,0.006084442138671875,-0.0015411376953125,-0.040618896484375,0.027801513671875,-0.00839996337890625,-0.01126861572265625,-0.01000213623046875,0.01197052001953125,-0.01062774658203125,-0.0155487060546875,0.011688232421875,0.01044464111328125,-0.0528564453125,0.031005859375,-0.0007734298706054688,8.52346420288086e-6,-0.00894927978515625,-0.005870819091796875,0.04254150390625,-0.03216552734375,0.0215911865234375,-0.01029205322265625,-0.01015472412109375,-0.036285400390625,0.0111083984375,0.0018520355224609375,-0.01177215576171875,0.01256561279296875,-0.004901885986328125,-0.006866455078125,-0.0084381103515625,-0.01160430908203125,-0.044891357421875,0.00632476806640625,0.0015001296997070312,-0.0016727447509765625,-0.013031005859375,-0.01404571533203125,-0.035888671875,-0.013397216796875,-0.0006346702575683594,0.00981903076171875,-0.0134735107421875,-0.022705078125,-0.02606201171875,-0.018402099609375,-0.046966552734375,-0.012542724609375,0.0183563232421875,0.0179901123046875,-0.0225067138671875,0.02801513671875,-0.032379150390625,-0.0079803466796875,0.0070953369140625,0.017333984375,0.026611328125,-0.03778076171875,-0.023590087890625,-0.005245208740234375,0.024383544921875,-0.02105712890625,0.020843505859375,0.033905029296875,0.0225372314453125,0.00942230224609375,0.0005245208740234375,-0.0284881591796875,0.01499176025390625,-0.0124664306640625,-0.0267333984375,0.023040771484375,0.01265716552734375,-0.0026264190673828125,0.00955963134765625,-0.0036773681640625,-0.0394287109375,0.015716552734375,-0.01300048828125,0.0187225341796875,-0.01275634765625,-0.0273590087890625,0.045562744140625,-0.00913238525390625,-0.004268646240234375,-0.005107879638671875,-0.026702880859375,0.0015077590942382812,-0.02862548828125,0.0003228187561035156,0.0099334716796875,-0.0305328369140625,-0.0362548828125,0.0114898681640625,-0.00025653839111328125,-0.0022735595703125,0.0106201171875,0.01090240478515625,0.00992584228515625,0.00998687744140625,-0.00634002685546875,0.00711822509765625,-0.02337646484375,-0.01367950439453125,-0.006389617919921875,-0.006000518798828125,0.01027679443359375,-0.00838470458984375,0.004673004150390625,0.002841949462890625,0.014404296875,-0.02838134765625,0.023834228515625,-0.00823974609375,-0.038970947265625,0.003002166748046875,-0.04510498046875,-0.0265655517578125,-0.0036182403564453125,-0.046661376953125,-0.01062774658203125,-0.05804443359375,-0.02117919921875,-0.029815673828125,0.036712646484375,-0.0069122314453125,0.0079345703125,0.0164794921875,-0.007534027099609375,-0.01111602783203125,0.0135650634765625,-0.0017242431640625,0.009490966796875,-0.0222320556640625,0.043853759765625,0.054718017578125,-0.003208160400390625,-0.004199981689453125,0.01529693603515625,-0.007190704345703125,0.00637054443359375,-0.004749298095703125,-0.0217132568359375,-0.0093841552734375,-0.0335693359375,-0.0017490386962890625,0.0081939697265625,0.0247802734375,0.0148468017578125,0.026763916015625,0.002079010009765625,0.0292816162109375,0.04705810546875,0.02166748046875,-0.0120697021484375,0.01050567626953125,0.0131988525390625,0.0169525146484375,0.0291595458984375,-0.00270843505859375,-0.0095062255859375,-0.0211944580078125,-0.035980224609375,0.006805419921875,0.002735137939453125,0.043731689453125,-0.01515960693359375,0.0010576248168945312,-0.00913238525390625,0.001293182373046875,-0.00027489662170410156,-0.00868988037109375,0.007389068603515625,0.0023212432861328125,-0.01528167724609375,0.017852783203125,-0.03643798828125,0.045623779296875,-0.0030364990234375,-0.0271453857421875,0.0268402099609375,-0.0033473968505859375,0.0186920166015625,-0.0225067138671875,0.0125732421875,-0.01386260986328125,-0.0218658447265625,0.01248931884765625,0.025848388671875,0.021453857421875,0.008056640625,0.025421142578125,0.01224517822265625,0.0208740234375,-0.003856658935546875,-0.021209716796875,-0.00545501708984375,-0.0254058837890625,0.04388427734375,0.0204315185546875,-0.0072174072265625,-0.0110626220703125,0.0007481575012207031,-0.0022411346435546875,-0.046905517578125,-0.028472900390625,0.0196533203125,0.014129638671875,0.0130615234375,-0.01288604736328125,-0.03607177734375,-0.01568603515625,-0.00814056396484375,-0.01499176025390625,0.0112152099609375,-0.00360870361328125,0.024688720703125,-0.0189361572265625,-0.007122039794921875,0.00634002685546875,-0.00626373291015625,-0.000766754150390625,0.0193939208984375,-0.002841949462890625,0.041717529296875,-0.00016701221466064453,-0.043365478515625,-0.023773193359375,0.0283660888671875,0.0245208740234375,-0.055450439453125,0.01096343994140625,-0.0180511474609375,0.0189056396484375,0.0164947509765625,-0.033111572265625,0.0262603759765625,0.0294189453125,0.00084686279296875,0.0279388427734375,-0.003910064697265625,0.002910614013671875,0.00890350341796875,-0.033843994140625,0.004856109619140625,0.00033974647521972656,-0.056549072265625,-0.0110626220703125,-0.0178375244140625,0.006381988525390625,0.018798828125,0.0205230712890625,-0.05609130859375,-0.01023101806640625,-0.001201629638671875,-0.02227783203125,0.01910400390625,0.006931304931640625,0.0017032623291015625,-0.01849365234375,-0.0249786376953125,-0.0176849365234375,0.007389068603515625,-0.01025390625,0.036407470703125,-0.0275421142578125,0.021514892578125,-0.0198822021484375,-0.0189056396484375,-0.0156402587890625,0.01025390625,0.02197265625,-0.007740020751953125,-0.034515380859375,0.0011262893676757812,0.024566650390625,0.0229339599609375,0.004810333251953125,-0.01171875,-0.0238189697265625,0.021392822265625,0.0008301734924316406,0.019378662109375,-0.00894927978515625,-0.01496124267578125,0.01558685302734375,-0.0229339599609375,0.00020587444305419922,-0.0202178955078125,0.0298919677734375,0.00969696044921875,-0.0011949539184570312,-0.007144927978515625,-0.0198211669921875,0.0030422210693359375,-0.037811279296875,-0.039306640625,-0.027587890625,-0.0274810791015625,0.025390625,-0.0333251953125,-0.0062103271484375,-0.016876220703125,0.002651214599609375,-0.0020275115966796875,0.042144775390625,0.013092041015625,0.01690673828125,0.0268707275390625,0.0082244873046875,0.066650390625,0.0053253173828125,0.08526611328125,-0.0146331787109375,-0.0261688232421875,-0.04266357421875,0.004474639892578125,-0.005229949951171875,-0.01806640625,0.00479888916015625,0.00183868408203125,-0.01030731201171875,0.0028285980224609375,-0.0239410400390625,0.0166778564453125,0.0006723403930664062,-0.00923919677734375,-0.00504302978515625,0.0159759521484375,-0.0248260498046875,0.03179931640625,-0.01517486572265625,-0.0006771087646484375,-0.0117645263671875,0.016510009765625,0.00168609619140625,-0.016387939453125,0.0421142578125,-0.00951385498046875,-0.00388336181640625,-0.04559326171875,-0.0194091796875,0.043853759765625,-0.007541656494140625,0.0275421142578125,-0.005645751953125,0.003803253173828125,-0.01438140869140625,0.018218994140625,-0.006381988525390625,-0.012664794921875,-0.011962890625,0.035186767578125,0.0225067138671875,-0.005321502685546875,-0.007659912109375,0.0022792816162109375,-0.00830078125,-0.0092926025390625,-0.0278778076171875,-0.00011402368545532227,0.0027523040771484375,0.0082855224609375,0.0175933837890625,0.0029430389404296875,0.0721435546875,0.01525115966796875,-0.059967041015625,-0.0626220703125,0.0222625732421875,-0.05810546875,-0.01192474365234375,-0.0056610107421875,0.0173492431640625,-0.0008497238159179688,-0.01050567626953125,-0.01558685302734375,0.0032196044921875,0.00745391845703125,-0.05029296875,0.00310516357421875,0.0333251953125,-0.01166534423828125,-0.0347900390625,-0.00830078125,0.01305389404296875,0.01030731201171875,0.017730712890625,-0.007415771484375,-0.00287628173828125,0.01197052001953125,-0.004016876220703125,-0.038421630859375,0.000743865966796875,-0.006237030029296875,0.0511474609375,-0.003826141357421875,-0.00838470458984375,-0.007572174072265625,0.00522613525390625,0.01514434814453125,0.00557708740234375,-0.035186767578125,0.0077056884765625,-0.0330810546875,-0.0043487548828125,-0.0307464599609375,-0.00670623779296875,0.01395416259765625,-0.0247039794921875,-0.03399658203125,0.0176849365234375,-0.00827789306640625,-0.0132293701171875,0.011016845703125,0.00740814208984375,-0.022735595703125,0.01110076904296875,-0.0127105712890625,-0.01074981689453125,-0.04150390625,-0.05438232421875,-0.0014743804931640625,-0.00507354736328125,-0.05291748046875,-0.0126800537109375,0.032135009765625,0.0266571044921875,-0.0240020751953125,-0.0033702850341796875,0.0021076202392578125,0.0206756591796875,0.01454925537109375,-0.00954437255859375,0.0178680419921875,0.004734039306640625,-0.0014028549194335938,0.0109710693359375,-0.0200042724609375,-0.030029296875,0.04022216796875,-0.0190887451171875,0.028594970703125,0.0205841064453125,-0.0028095245361328125,0.0024242401123046875,-0.0151214599609375,0.0025386810302734375,-0.006633758544921875,0.01265716552734375,-0.019073486328125,0.0030384063720703125,-0.024871826171875,-0.01148223876953125,0.00914764404296875,-0.004367828369140625,-0.0186920166015625,0.021514892578125,-0.027435302734375,0.00736236572265625,0.037872314453125,-0.00222015380859375,0.0041351318359375,-0.0224151611328125,-0.0255279541015625,0.03271484375,-0.0242919921875,0.0097198486328125,-0.02008056640625,-0.01003265380859375,-0.0215606689453125,-0.00974273681640625,-0.0428466796875,-0.0343017578125,-0.0006017684936523438,-0.0230865478515625,0.020782470703125,0.01134490966796875,0.0107421875,-0.0165863037109375,-0.0043487548828125,0.0165252685546875,0.0276947021484375,0.0051116943359375,0.03497314453125,0.0288848876953125,0.0205230712890625,-0.0099029541015625,0.0014505386352539062,-0.045074462890625,-0.0226898193359375,0.002422332763671875,0.0013151168823242188,-0.0031642913818359375,-0.0247344970703125,0.013885498046875,-0.002410888671875,0.046051025390625,0.0328369140625,0.04193115234375,0.006710052490234375,-0.004138946533203125,-0.031768798828125,0.024658203125,0.00417327880859375,-0.01116943359375,0.0097198486328125,-0.021270751953125,0.0285491943359375,0.02581787109375,0.0167083740234375,0.0206298828125,0.009185791015625,0.00794219970703125,-0.0022792816162109375,0.004337310791015625,-0.01166534423828125,-0.01227569580078125,0.00905609130859375,0.0156707763671875,-0.04217529296875,0.025054931640625,-0.01058197021484375,0.0171356201171875,0.001369476318359375,0.003917694091796875,-0.00817108154296875,0.026123046875,0.0200042724609375,-0.0294189453125,0.032440185546875,-0.0297393798828125,-0.0109100341796875,-0.00856781005859375,0.0034465789794921875,0.0186920166015625,0.0199737548828125,-0.03558349609375,-0.025146484375,-0.009307861328125,0.0081024169921875,0.0131378173828125,0.0117340087890625,0.0063018798828125,0.0000546574592590332,0.01898193359375,-0.0167694091796875,0.01666259765625,0.0374755859375,0.02374267578125,-0.0103912353515625,0.01207733154296875,-0.032989501953125,-0.004108428955078125,-0.0026798248291015625,0.01166534423828125,0.0257568359375,-0.056732177734375,0.0282745361328125,-0.0034351348876953125,-0.007415771484375,0.0081634521484375,0.029998779296875,0.0019369125366210938,-0.0014734268188476562,0.004573822021484375,0.04296875,0.025665283203125,-0.0121307373046875,0.029266357421875,0.016815185546875,-0.002536773681640625,-0.015045166015625,-0.0211334228515625,0.0020351409912109375,0.008087158203125,-0.004528045654296875,-0.0172882080078125,0.023712158203125,0.0305633544921875,0.0213470458984375,-0.0154266357421875,-0.035675048828125,0.0002543926239013672,0.01149749755859375,0.00833892822265625,0.01506805419921875,0.019500732421875,-0.01265716552734375,0.01947021484375,0.0242767333984375,-0.017486572265625,-0.01294708251953125,-0.012603759765625,-0.0093994140625,-0.00226593017578125,0.020355224609375,-0.0369873046875,0.0166168212890625,0.034332275390625,-0.0240631103515625,-0.03558349609375,0.036376953125,-0.009246826171875,0.0041656494140625,0.0439453125,-0.023284912109375,0.004749298095703125,-0.0232391357421875,-0.0105743408203125,-0.01030731201171875,-0.01318359375,0.0220184326171875,0.005840301513671875,0.0217437744140625,-0.01007080078125,0.01398468017578125,0.0019063949584960938,-0.011383056640625,-0.00424957275390625,-0.0208282470703125,0.012237548828125,0.01526641845703125,0.00959014892578125,0.027191162109375,0.001735687255859375,0.0177154541015625,-0.01139068603515625,0.0218963623046875,0.03814697265625,-0.018951416015625,0.011016845703125,-0.01287078857421875,0.046875,-0.007415771484375,0.01198577880859375,-0.02532958984375,0.00311279296875,0.018524169921875,0.005390167236328125,-0.01435089111328125,0.0018949508666992188,0.0421142578125,0.0045928955078125,-0.006099700927734375,0.007049560546875,0.00502777099609375,-0.00963592529296875,0.00894927978515625,-0.034515380859375,-0.0035114288330078125,-0.0142974853515625,-0.034515380859375,-0.02142333984375,0.017608642578125,-0.014892578125,-0.01244354248046875,-0.017486572265625,0.00013899803161621094,0.00011283159255981445,-0.00756072998046875,-0.0132293701171875,0.0108489990234375,0.0305328369140625,-0.001163482666015625,-0.002880096435546875,-0.0007386207580566406,0.00370025634765625,0.00797271728515625,-0.010528564453125,-0.0073089599609375,-0.0279693603515625,-0.01343536376953125,-0.005908966064453125,-0.0003764629364013672,0.053955078125,0.0237884521484375,-0.053497314453125,-0.01165771484375,-0.037628173828125,0.0099639892578125,-0.02386474609375,0.032958984375,0.0239715576171875,0.0016231536865234375,-0.033111572265625,0.0007448196411132812,0.0245819091796875,-0.0094757080078125,-0.03131103515625,-0.02459716796875,0.021453857421875,0.01398468017578125,-0.0017442703247070312,0.054107666015625,0.0193328857421875,0.0057373046875,0.03485107421875,0.0258636474609375,0.004131317138671875,-0.02239990234375,-0.002368927001953125,0.01102447509765625,-0.017181396484375,0.01454925537109375,-0.0119781494140625,-0.0017871856689453125,-0.0166778564453125,0.008544921875,-0.0135345458984375,-0.03192138671875,0.0030956268310546875,-0.0279083251953125,0.0235595703125,-0.017974853515625,0.0108184814453125,0.0031032562255859375,-0.003093719482421875,-0.014129638671875,0.01361083984375,-0.03619384765625,-0.00826263427734375,0.033477783203125,-0.004150390625,0.0157012939453125,0.0011501312255859375,0.059844970703125,-0.01555633544921875,0.031219482421875,0.0177001953125,-0.0307464599609375,0.01264190673828125,0.0291290283203125,0.01045989990234375,-0.0097503662109375,0.01226806640625,0.00598907470703125,0.01849365234375,-0.02801513671875,-0.0112152099609375,-0.006011962890625,-0.006664276123046875,0.00928497314453125,0.0002186298370361328,-0.0012874603271484375,-0.0233001708984375,-0.0065155029296875,-0.0220947265625,-0.00310516357421875,0.049041748046875,-0.04925537109375,0.0262451171875,-0.0028095245361328125,-0.0091400146484375,0.0240631103515625,-0.002864837646484375,0.0120391845703125,-0.021942138671875,0.0347900390625,0.023834228515625,-0.0134429931640625,0.00028228759765625,0.0277557373046875,0.03082275390625,0.006237030029296875,-0.015350341796875,-0.005039215087890625,0.0145416259765625,0.01226806640625,-0.01474761962890625,-0.004917144775390625,-0.005733489990234375,-0.010986328125,0.0223236083984375,0.0224609375,-0.035736083984375,-0.008544921875,-0.0009150505065917969,-0.0119476318359375,0.0178070068359375,-0.005352020263671875,-0.01558685302734375,-0.0208740234375,-0.0160675048828125,0.0069122314453125,-0.0357666015625,0.01319122314453125,-0.00457000732421875,0.00502777099609375,-0.0006170272827148438,0.0032196044921875,-0.008209228515625,0.0026721954345703125,-0.022705078125,0.01666259765625,-0.0217132568359375,-0.024017333984375,-0.00527191162109375,0.0005908012390136719,0.0028228759765625,-0.0205841064453125,-0.05108642578125,0.02947998046875,-0.00861358642578125,-0.035552978515625,-0.0090484619140625,-0.044464111328125,-0.0284881591796875,0.004901885986328125,0.00669097900390625,0.020538330078125,0.01218414306640625,0.01477813720703125,0.0011930465698242188,0.027587890625,-0.037811279296875,0.0273284912109375,-0.0006680488586425781,0.0179901123046875,0.047393798828125,0.033355712890625,-0.018646240234375,-0.031585693359375,-0.0190887451171875,0.0059051513671875,-0.005916595458984375,0.0247802734375,0.00881195068359375,-0.004108428955078125,-0.0091552734375,0.021697998046875,-0.0207061767578125,0.0207977294921875,-0.048095703125,-0.01544189453125,0.015533447265625,0.0228424072265625,0.0255126953125,-0.0172119140625,-0.0450439453125,0.0005936622619628906,0.0027103424072265625,0.03704833984375,-0.018218994140625,-0.00972747802734375,0.0067901611328125,-0.000598907470703125,-0.00482940673828125,-0.00786590576171875,0.0011510848999023438,0.0364990234375,-0.0128631591796875,-0.0198822021484375,0.0000896453857421875,-0.022735595703125,0.01479339599609375,-0.0034351348876953125,0.0120086669921875,0.0070037841796875,-0.01971435546875,0.04010009765625,0.0034389495849609375,-0.0109100341796875,0.01395416259765625,0.03509521484375,0.01096343994140625,-0.0209808349609375,-0.0009293556213378906,-0.00043487548828125,0.005519866943359375,-0.016448974609375,0.032470703125,0.0284881591796875,0.0144195556640625,-0.0307464599609375,0.0217437744140625,-0.0303497314453125,-0.05926513671875,0.01444244384765625,-0.01264190673828125,0.040313720703125,-0.012603759765625,-0.0178375244140625,-0.04339599609375,0.01222991943359375,-0.0025005340576171875,-0.010406494140625,-0.003086090087890625,-0.0214385986328125,0.01045989990234375,0.005886077880859375,-0.0175933837890625,0.04840087890625,-0.0168914794921875,0.01800537109375,-0.01354217529296875,-0.01383209228515625,0.04083251953125,0.034271240234375,0.021514892578125,0.04022216796875,0.0231781005859375,-0.01110076904296875,-0.0224151611328125,0.0021991729736328125,-0.01206207275390625,-0.01557159423828125,0.0548095703125,0.02618408203125,0.023956298828125,-0.00994110107421875,-0.004299163818359375,0.007030487060546875,-0.0113372802734375,0.0140228271484375,-0.01084136962890625,0.010711669921875,-0.0236358642578125,0.01776123046875,0.04461669921875,-0.0460205078125,-0.012969970703125,0.0078277587890625,-0.040313720703125,-0.004344940185546875,-0.00681304931640625,-0.00937652587890625,0.00601959228515625,-0.0086669921875,0.038238525390625,-0.00726318359375,-0.00667572021484375,-0.0282745361328125,-0.01448822021484375,-0.004566192626953125,0.002193450927734375,0.0408935546875,-0.018951416015625,-0.0347900390625,-0.0038661956787109375,0.0011167526245117188,0.00603485107421875,0.004985809326171875,0.004299163818359375,0.009552001953125,-0.04736328125,0.018310546875,0.004238128662109375,0.028839111328125,-0.02349853515625,0.00798797607421875,0.021270751953125,-0.01384735107421875,-0.02392578125,0.03662109375,0.0032825469970703125,0.056182861328125,-0.007129669189453125,-0.0014019012451171875,0.030426025390625,-0.017974853515625,-0.0118560791015625,0.0104827880859375,-0.0132293701171875,0.01959228515625,-0.0006871223449707031,-0.038055419921875,0.03125,0.01332855224609375,0.0675048828125,0.0005002021789550781,0.0117950439453125,0.0179901123046875,-0.0034618377685546875,-0.029205322265625,0.0136871337890625,-0.01409149169921875,-0.020111083984375,-0.06976318359375,-0.03985595703125,-0.020965576171875,0.002532958984375,-0.000797271728515625,0.00029206275939941406,-0.04278564453125,0.01293182373046875,-0.0178375244140625,-0.01496124267578125,-0.0289154052734375,-0.00551605224609375,-0.0135498046875,-0.0019350051879882812,-0.0008111000061035156,0.032958984375,0.005794525146484375,-0.00988006591796875,0.0147247314453125,0.0008878707885742188,-0.0347900390625,0.04827880859375,0.03656005859375,0.0005245208740234375,0.0078887939453125,0.0218048095703125,0.0177764892578125,0.02093505859375,-0.028656005859375,0.0273284912109375,-0.038818359375,0.01300811767578125,0.0174102783203125,0.01216888427734375,-0.0258941650390625,0.028778076171875,-0.024658203125,0.00337982177734375,-0.00594329833984375,-0.00948333740234375,0.036773681640625,-0.006595611572265625,-0.01033782958984375,0.001506805419921875,-0.03656005859375,-0.0239105224609375,0.041229248046875,-0.04071044921875,-0.0152435302734375,0.0151214599609375,0.037994384765625,-0.01058197021484375,-0.01062774658203125,0.002964019775390625,0.0294189453125,0.01041412353515625,0.038299560546875,-0.036163330078125,-0.036346435546875,-0.00850677490234375,-0.0098876953125,-0.051788330078125,0.02398681640625,-0.0219268798828125,0.023406982421875,0.008941650390625,0.010772705078125,-0.0265960693359375,-0.0099639892578125,-0.00727081298828125,0.0234222412109375,0.0023441314697265625,-0.01409912109375,0.01169586181640625,0.0023250579833984375,-0.0189208984375,-0.01013946533203125,-0.01739501953125,-0.0309295654296875,-0.00823974609375,0.029205322265625,0.01111602783203125,-0.01509857177734375,-0.01160430908203125,0.0173187255859375,0.0169830322265625,-0.00464630126953125,0.0253448486328125,0.0095062255859375,-0.0179443359375,0.0223846435546875,-0.0219879150390625,-0.0004260540008544922,-0.025421142578125,-0.007659912109375,-0.01485443115234375,-0.0166168212890625,0.011444091796875,0.0185394287109375,-0.02984619140625,0.061767578125,0.0189971923828125,-0.016693115234375,0.002613067626953125,-0.01242828369140625,0.0262298583984375,0.029388427734375,-0.0711669921875,-0.0263519287109375,0.01184844970703125,0.00977325439453125,-0.0232696533203125,-0.0131072998046875,0.00910186767578125,0.0251617431640625,0.04644775390625,-0.00033926963806152344,0.00894927978515625,0.01216888427734375,-0.00942230224609375,0.01220703125,0.002918243408203125,0.0167694091796875,0.0286865234375,0.01436614990234375,-0.02581787109375,-0.0123138427734375,-0.0143890380859375,0.0200042724609375,-0.020660400390625,-0.017791748046875,-0.006740570068359375,0.02484130859375,-0.028472900390625,-0.0142364501953125,-0.007534027099609375,0.021697998046875,-0.013580322265625,-0.003910064697265625,0.01214599609375,-0.01267242431640625,-0.005466461181640625,0.0239410400390625,0.01348876953125,0.0171661376953125,-0.00982666015625,-0.009613037109375,0.0189208984375,-0.01146697998046875,-0.01364898681640625,-0.021820068359375,-0.017181396484375,0.0097503662109375,-0.0240478515625,0.031829833984375,0.0172271728515625,0.01308441162109375,0.006938934326171875,0.0212249755859375,-0.007843017578125,-0.041839599609375,0.003757476806640625,-0.01332855224609375,-0.0081024169921875,-0.0252227783203125,0.0125732421875,0.00164794921875,-0.009490966796875,-0.0182647705078125,-0.03497314453125,-0.0187225341796875,-0.001026153564453125,-0.06793212890625,-0.05291748046875,-0.0297393798828125,-0.005031585693359375,-0.026519775390625,-0.00891876220703125,0.0096893310546875,-0.0189056396484375,0.01444244384765625,-0.0270233154296875,-0.0010528564453125,0.006771087646484375,-0.00942230224609375,0.03399658203125,-0.0203094482421875,-0.004795074462890625,0.0025959014892578125,0.01538848876953125,-0.00620269775390625,-0.035675048828125,-0.01142120361328125,0.0011234283447265625,-0.0278778076171875,0.00807952880859375,-0.017547607421875,0.0211639404296875,0.037139892578125,-0.0108642578125,-0.0287017822265625,-0.0008664131164550781,-0.00862884521484375,-0.006320953369140625,-0.00901031494140625,-0.012451171875,0.017913818359375,0.005092620849609375,-0.04345703125,-0.027801513671875,0.023040771484375,0.007328033447265625,-0.013916015625,-0.007678985595703125,-0.0031185150146484375,0.01546478271484375,0.02020263671875,-0.01259613037109375,0.0040130615234375,0.005023956298828125,0.00421142578125,-0.0018835067749023438,0.0369873046875,-0.0006284713745117188,0.007049560546875,-0.0213165283203125,-0.02215576171875,-0.05023193359375,-0.006420135498046875,0.001811981201171875,0.01995849609375,0.007694244384765625,-0.0081329345703125,-0.0347900390625,0.01042938232421875,-0.03131103515625,0.0312042236328125,-0.00971221923828125,-0.0352783203125,0.021209716796875,-0.009490966796875,0.00710296630859375,-0.004848480224609375,-0.01030731201171875,0.0037136077880859375,0.0234222412109375,0.004337310791015625,-0.03436279296875,0.0008835792541503906,-0.036712646484375,0.007740020751953125,0.003978729248046875,-0.0178985595703125,-0.0027065277099609375,0.035491943359375,0.01148223876953125,0.01496124267578125,-0.0025386810302734375,0.014404296875,0.007572174072265625,0.016876220703125,-0.0023212432861328125,0.002727508544921875,-0.005374908447265625,0.01690673828125,-0.020599365234375,-0.00002384185791015625,0.0305328369140625,-0.052734375,0.01496124267578125,0.0039215087890625,-0.00762176513671875,0.031585693359375,-0.01617431640625,-0.01222991943359375,0.00873565673828125,-0.033966064453125,0.01061248779296875,-0.0209197998046875,-0.0198516845703125,0.035247802734375,0.0244598388671875,0.0082550048828125,-0.00787353515625,-0.01544952392578125,0.01302337646484375,-0.0166168212890625,-0.0147247314453125,0.02618408203125,-0.0158233642578125,-0.0394287109375,0.0151214599609375,-0.004146575927734375,-0.035369873046875,0.045928955078125,0.04241943359375,0.01354217529296875,0.0343017578125,-0.007183074951171875,0.0129241943359375,-0.004955291748046875,0.025299072265625,0.01538848876953125,-0.0054779052734375,-0.00630950927734375,-0.010711669921875,0.043914794921875,-0.004856109619140625,0.05169677734375,-0.020111083984375,0.023406982421875,-0.0021114349365234375,-0.039215087890625,-0.01314544677734375,-0.0036773681640625,0.01031494140625,-0.00981903076171875,0.01366424560546875,0.0101776123046875,0.0274658203125,-0.0386962890625,0.0194244384765625,-0.04803466796875,0.033172607421875,0.0269775390625,-0.0176849365234375,-0.0016927719116210938,-0.02783203125,0.0015516281127929688,0.01325225830078125,-0.028472900390625,0.01470947265625,0.036773681640625,-0.038482666015625,-0.0009303092956542969,0.0236053466796875,-0.00498199462890625,0.0165557861328125,0.00003445148468017578,-0.03741455078125,-0.0517578125,-0.0090179443359375,-0.033966064453125,-0.0170440673828125,0.0013637542724609375,-0.04473876953125,-0.059478759765625,-0.0165557861328125,-0.047119140625,-0.033721923828125,0.018890380859375,0.00160980224609375,0.050811767578125,-0.0221099853515625,0.0306396484375,-0.01096343994140625,-0.007175445556640625,0.01580810546875,-0.00650787353515625,-0.00467681884765625,0.0256500244140625,0.006931304931640625,0.00316619873046875,-0.0170745849609375,-0.003265380859375,0.00554656982421875,-0.0166473388671875,0.0006661415100097656,0.0297393798828125,-0.00568389892578125,0.01043701171875,-0.03863525390625,0.01531982421875,0.021087646484375,0.002185821533203125,0.00977325439453125,-0.028594970703125,-0.0166473388671875,-0.00018537044525146484,-0.0014066696166992188,0.014312744140625,0.025299072265625,-0.0149383544921875,0.001495361328125,0.03692626953125,0.00438690185546875,0.05572509765625,-0.00350189208984375,0.0156402587890625,0.005992889404296875,-0.005748748779296875,-0.01739501953125,0.017059326171875,0.0006203651428222656,-0.0163726806640625,-0.0203704833984375,-0.005962371826171875,0.006130218505859375,-0.00022983551025390625,-0.014007568359375,-0.0025844573974609375,-0.0171356201171875,0.0130157470703125,-0.005809783935546875,0.0174560546875,-0.0196075439453125,-0.017486572265625,-0.035369873046875,0.0016012191772460938,-0.02008056640625,-0.0213775634765625,0.04119873046875,-0.0125732421875,-0.00983428955078125,0.01010894775390625,-0.01099395751953125,-0.009613037109375,-0.01091766357421875,0.0032520294189453125,-0.004924774169921875,-0.041656494140625,0.01227569580078125,0.011077880859375,-0.040740966796875,0.002017974853515625,-0.0193023681640625,0.014739990234375,-0.0018491744995117188,0.008636474609375,0.017791748046875,-0.0012598037719726562,-0.004123687744140625,-0.006511688232421875,-0.0179443359375,-0.03619384765625,-0.0009822845458984375,0.0066680908203125,-0.0012950897216796875,0.0031185150146484375,-0.05401611328125,0.0266876220703125,-0.035308837890625,-0.0234375,0.0234222412109375,-0.037384033203125,0.002349853515625,0.01290130615234375,-0.0321044921875,0.019622802734375,-0.052337646484375,-0.00556182861328125,0.005496978759765625,0.0078125,0.010101318359375,-0.0055084228515625,0.021087646484375,0.016754150390625,0.0192413330078125,-0.024261474609375,0.0457763671875,-0.0185394287109375,0.0007729530334472656,0.0173187255859375,0.0224456787109375,0.0283355712890625,0.00576019287109375,0.04150390625,-0.005279541015625,0.01000213623046875,0.01496124267578125,0.003604888916015625,-0.033447265625,0.013824462890625,-0.0014410018920898438,-0.0225067138671875,-0.0017547607421875,0.0235443115234375,0.0171966552734375,0.0234375,-0.00482177734375,-0.0062103271484375,0.01885986328125,-0.003917694091796875,0.0172119140625,0.0240478515625,-0.006069183349609375,-0.0166015625,-0.00955963134765625,-0.01861572265625,0.0198822021484375,-0.046875,-0.0011920928955078125,-0.00972747802734375,0.01349639892578125,-0.00629425048828125,-0.0087738037109375,0.01393890380859375,0.0006022453308105469,-0.007038116455078125,-0.017181396484375,-0.00965118408203125,0.0133514404296875,-0.0025787353515625,0.017547607421875,-0.0276641845703125,0.018890380859375,0.01517486572265625,-0.0311737060546875,-0.016815185546875,0.00264739990234375,-0.0214080810546875,0.0181884765625,-0.01145172119140625,-0.0011072158813476562,0.02880859375,0.00782012939453125,-0.0238037109375,0.039031982421875,-0.00690460205078125,0.0018301010131835938,0.0305023193359375,0.005344390869140625,-0.003803253173828125,-0.033782958984375,0.01241302490234375,0.0206146240234375,0.00766754150390625,0.0177459716796875,-0.002201080322265625,-0.01444244384765625,0.031402587890625,-0.04498291015625,-0.02203369140625,-0.017486572265625,0.031341552734375,0.032562255859375,-0.031951904296875,0.0182037353515625,-0.01207733154296875,0.0235748291015625,0.0391845703125,0.00971221923828125,0.029388427734375,-0.038360595703125,0.025726318359375,-0.0040435791015625,0.020233154296875,0.0009427070617675781,0.0347900390625,-0.0226287841796875,0.01318359375,0.01505279541015625,0.01042938232421875,-0.011749267578125,-0.022705078125,-0.006938934326171875,0.008087158203125,-0.00205230712890625,-0.018463134765625,0.02960205078125,-0.0309600830078125,-0.024749755859375,0.004817962646484375,-0.01258087158203125,0.00850677490234375,-0.00560760498046875,-0.021881103515625,-0.004638671875,0.0244903564453125,-0.020416259765625,0.02655029296875,-0.0226287841796875,0.030029296875,0.024139404296875,0.03497314453125,0.0161285400390625,0.0206756591796875,-0.040924072265625,0.01042938232421875,0.048126220703125,0.006565093994140625,-0.00260162353515625,0.037139892578125,0.0006361007690429688,-0.01007843017578125,0.0282745361328125,-0.013702392578125,0.044525146484375,-0.006237030029296875,0.034637451171875,0.0285186767578125,0.0124053955078125,-0.034423828125,0.0007100105285644531,-0.045501708984375,-0.0219268798828125,-0.00836181640625,-0.03704833984375,-0.07000732421875,0.006748199462890625,-0.0036602020263671875,0.00751495361328125,-0.0162353515625,-0.0137176513671875,0.0227203369140625,0.001644134521484375,-0.028656005859375,-0.00397491455078125,-0.0088043212890625,-0.0007772445678710938,0.035797119140625,0.0389404296875,0.0380859375,-0.005031585693359375,0.0059967041015625,-0.016815185546875,-0.0027980804443359375,0.0127410888671875,0.03399658203125,-0.0003867149353027344,0.00679779052734375,-0.0079193115234375,-0.02294921875,0.023101806640625,0.0009560585021972656,0.042694091796875,-0.031768798828125,-0.00247955322265625,0.0197296142578125,0.0196075439453125,-0.0229339599609375,-0.0250396728515625,-0.0006723403930664062,0.011871337890625,0.0308990478515625,0.002803802490234375,0.003803253173828125,-0.0112762451171875,0.0016689300537109375,-0.040985107421875,0.0175933837890625,0.029083251953125,-0.00962066650390625,-0.0384521484375,-0.006683349609375,0.00439453125,0.0269012451171875,0.02252197265625,-0.027587890625,0.003749847412109375,-0.004119873046875,-0.015228271484375,-0.031036376953125,-0.0042724609375,-0.043853759765625,-0.0016918182373046875,-0.015411376953125,0.03643798828125,-0.03814697265625,0.020599365234375,-0.007030487060546875,-0.02532958984375,-0.0216522216796875,0.0016412734985351562,0.00982666015625,0.0205230712890625,0.02484130859375,0.0078887939453125,-0.0261077880859375,0.0247039794921875,-0.01251983642578125,0.0090789794921875,0.013092041015625,0.0082550048828125,0.006603240966796875,-0.00423431396484375,0.01424407958984375,0.01349639892578125,-0.02264404296875,0.0236358642578125,-0.001506805419921875,0.007030487060546875,-0.01727294921875,-0.0249481201171875,-0.00611114501953125,0.0177459716796875,-0.0077056884765625,0.023773193359375,0.01357269287109375,0.012237548828125,0.0338134765625,-0.029022216796875,0.02880859375,-0.0018472671508789062,-0.024139404296875,-0.032989501953125,0.055084228515625,0.02984619140625,0.040618896484375,0.0006160736083984375,0.03814697265625,0.022552490234375,-0.01071929931640625,0.0250091552734375,0.033782958984375,0.00806427001953125,-0.005443572998046875,-0.00899505615234375,-0.00969696044921875,0.01045989990234375,0.037384033203125,0.01308441162109375,-0.01435089111328125,-0.0032367706298828125,0.0186004638671875,-0.0330810546875,-0.014617919921875,0.01088714599609375,-0.00847625732421875,0.02984619140625,-0.0283355712890625,0.023162841796875,0.019134521484375,-0.01218414306640625,-0.033966064453125,-0.028839111328125,-0.022552490234375,-0.02001953125,0.005214691162109375,-0.01418304443359375,0.0035915374755859375,-0.011993408203125,0.0076751708984375,-0.0098876953125,-0.002002716064453125,-0.0008831024169921875,-0.01294708251953125,-0.05120849609375,0.0008082389831542969,0.0205535888671875,-0.0017843246459960938,0.006366729736328125,0.0137939453125,0.060699462890625,-0.0177459716796875,-0.005641937255859375,0.0170440673828125,0.0026397705078125,0.009857177734375,-0.024658203125,0.006175994873046875,0.04205322265625,0.0253143310546875,0.00972747802734375,0.0031375885009765625,-0.022064208984375,0.0006480216979980469,-0.004180908203125,-0.00794219970703125,-0.015106201171875,-0.00901031494140625,-0.00812530517578125,-0.01406097412109375,-0.0247039794921875,-0.0221405029296875,0.025543212890625,0.037353515625,-0.01702880859375,-0.0021762847900390625,0.0237274169921875,0.016632080078125,-0.0335693359375,0.002178192138671875,-0.022705078125,-0.011810302734375,0.01666259765625,0.0287628173828125,-0.02313232421875,-0.011199951171875,0.026702880859375,-0.0195770263671875,0.0278778076171875,0.0106658935546875,-0.0199432373046875,-0.035919189453125,0.028656005859375,0.0009784698486328125,-0.004291534423828125,-0.0309906005859375,0.03277587890625,0.011260986328125,0.0112457275390625,-0.034698486328125,-0.01111602783203125,0.0309906005859375,0.042236328125<span class=o>]</span>,<span class=s2>&#34;object&#34;</span>:<span class=s2>&#34;embedding&#34;</span><span class=o>}]</span>,<span class=s2>&#34;model&#34;</span>:<span class=s2>&#34;nvidia/llama-3.2-nv-embedqa-1b-v2&#34;</span>,<span class=s2>&#34;usage&#34;</span>:<span class=o>{</span><span class=s2>&#34;prompt_tokens&#34;</span>:10,<span class=s2>&#34;total_tokens&#34;</span>:10<span class=o>}}</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-the-prometheus-receiver>Configure the Prometheus Receiver</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>Now that our LLM is up and running, we&rsquo;ll add the Prometheus receiver to our
OpenTelemetry collector to gather metrics from it.</p><h2 id=capture-the-nvidia-dcgm-exporter-metrics>Capture the NVIDIA DCGM Exporter metrics</h2><p>The NVIDIA DCGM exporter is running in our OpenShift cluster. It
exposes GPU metrics that we can send to Splunk.</p><p>To do this, let&rsquo;s customize the configuration of the collector by editing the
<code>otel-collector-values.yaml</code> file that we used earlier when deploying the collector.</p><p>Add the following content, just below the <code>kubeletstats</code> section:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span><span class=nt>receiver_creator/nvidia</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># Name of the extensions to watch for endpoints to start and stop.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>k8s_observer ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>prometheus/dcgm</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=l>gpu-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                          </span>- <span class=s1>&#39;`endpoint`:9400&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; labels[&#34;app&#34;] == &#34;nvidia-dcgm-exporter&#34;</span></span></span></code></pre></div><p>This tells the collector to look for pods with a label of <code>app=nvidia-dcgm-exporter</code>.
And when it finds a pod with this label, scrape the <code>/v1/metrics</code> endpoint using port 9400.</p><p>To ensure the receiver is used, we&rsquo;ll need to add a new pipeline to the <code>otel-collector-values.yaml</code> file
as well.</p><p>Add the following code to the bottom of the file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics/nvidia-metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>receiver_creator/nvidia</span></span></span></code></pre></div><p>Before applying the changes, let&rsquo;s add one more Prometheus receiver in the next section.</p><h2 id=capture-the-nvidia-nim-metrics>Capture the NVIDIA NIM metrics</h2><p>The <code>meta-llama-3-2-1b-instruct</code> LLM that we just deployed with NVIDIA NIM also
includes a Prometheus endpoint that we can scrape with the collector. Let&rsquo;s add the
following to the <code>otel-collector-values.yaml</code> file, just below the receiver we added earlier:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>          </span><span class=nt>prometheus/nim-llm</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=l>nim-for-llm-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>metrics_path</span><span class=p>:</span><span class=w> </span><span class=l>/v1/metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                          </span>- <span class=s1>&#39;`endpoint`:8000&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; labels[&#34;app&#34;] == &#34;meta-llama-3-2-1b-instruct&#34;</span></span></span></code></pre></div><p>This tells the collector to look for pods with a label of <code>app=meta-llama-3-2-1b-instruct</code>.
And when it finds a pod with this label, scrape the <code>/v1/metrics</code> endpoint using port 8000.</p><p>There&rsquo;s no need to make changes to the pipeline, as this receiver will already be picked up
as part of the <code>receiver_creator/nvidia</code> receiver.</p><h2 id=add-a-filter-processor>Add a Filter Processor</h2><p>Prometheus endpoints can expose a large number of metrics, sometimes with high cardinality.</p><p>Let&rsquo;s add a filter processor that defines exactly what metrics we want to send to Splunk.
Specifically, we&rsquo;ll send only the metrics that are utilized by a dashboard chart or an
alert detector.</p><p>Add the following code to the <code>otel-collector-values.yaml</code> file, after the exporters section
but before the receivers section:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filter/metrics_to_be_included</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># Include only metrics used in charts and detectors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>match_type</span><span class=p>:</span><span class=w> </span><span class=l>strict</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>metric_names</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_FB_FREE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_FB_USED</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_GPU_TEMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_GPU_UTIL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_MEM_CLOCK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_MEM_COPY_UTIL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_MEMORY_TEMP</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_POWER_USAGE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_SM_CLOCK</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_TOTAL_ENERGY_CONSUMPTION</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_PROF_DRAM_ACTIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_PROF_GR_ENGINE_ACTIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_PROF_PCIE_RX_BYTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_PROF_PCIE_TX_BYTES</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_PROF_PIPE_TENSOR_ACTIVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>generation_tokens_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_alloc_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_alloc_bytes_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_buck_hash_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_frees_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_gc_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_alloc_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_idle_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_inuse_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_objects</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_released_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_heap_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_last_gc_time_seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_lookups_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_mallocs_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_mcache_inuse_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_mcache_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_mspan_inuse_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_mspan_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_next_gc_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_other_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_stack_inuse_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_stack_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_memstats_sys_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>go_sched_gomaxprocs_threads</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>gpu_cache_usage_perc</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>gpu_total_energy_consumption_joules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>http.server.active_requests</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>num_request_max</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>num_requests_running</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>num_requests_waiting</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_cpu_seconds_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_max_fds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_open_fds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_resident_memory_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_start_time_seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_virtual_memory_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>process_virtual_memory_max_bytes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>promhttp_metric_handler_requests_in_flight</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>promhttp_metric_handler_requests_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>prompt_tokens_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>python_gc_collections_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>python_gc_objects_collected_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>python_gc_objects_uncollectable_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>python_info</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>request_finish_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>request_success_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>system.cpu.time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>e2e_request_latency_seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>time_to_first_token_seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>time_per_output_token_seconds</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>request_prompt_tokens</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>request_generation_tokens</span></span></span></code></pre></div><p>Ensure this processor is included in the pipeline we added earlier to the
bottom of the file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>    service:
</span></span><span class=line><span class=cl>      pipelines:
</span></span><span class=line><span class=cl>        metrics/nvidia-metrics:
</span></span><span class=line><span class=cl>          exporters:
</span></span><span class=line><span class=cl>            - signalfx
</span></span><span class=line><span class=cl>          processors:
</span></span><span class=line><span class=cl>            - memory_limiter
</span></span><span class=line><span class=cl>            - filter/metrics_to_be_included
</span></span><span class=line><span class=cl>            - batch
</span></span><span class=line><span class=cl>            - resourcedetection
</span></span><span class=line><span class=cl>            - resource
</span></span><span class=line><span class=cl>          receivers:
</span></span><span class=line><span class=cl>            - receiver_creator/nvidia</span></span></code></pre></div><h2 id=verify-changes>Verify Changes</h2><p>Before applying the configuration changes to the collector, take a moment to compare the
contents of your modified <code>otel-collector-values.yaml</code> file with the <code>otel-collector-values-with-nvidia.yaml</code> file.
Update your file as needed to ensure the contents match. Remember that indentation is important
for <code>yaml</code> files, and needs to be precise.</p><h2 id=update-the-opentelemetry-collector-config>Update the OpenTelemetry Collector Config</h2><p>Now we can update the OpenTelemetry collector configuration by running the
following Helm command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$CLUSTER_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$ENVIRONMENT_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$SPLUNK_ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$SPLUNK_REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$SPLUNK_HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$SPLUNK_HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=</span><span class=nv>$SPLUNK_INDEX</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f ./otel-collector/otel-collector-values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n otel <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><h2 id=confirm-metrics-are-sent-to-splunk>Confirm Metrics are Sent to Splunk</h2><p>Navigate to the <a href="https://app.us1.signalfx.com/#/dashboard/GvmWJyPA4Ak?startTime=-15m&endTime=Now&variables%5B%5D=K8s%20cluster%3Dk8s.cluster.name:%5B%22rosa-test%22%5D&groupId=GvmVcarA4AA&configId=GuzVkWWA4BE" rel=external>Cisco AI Pod</a>
dashboard in Splunk Observability Cloud. Ensure it&rsquo;s filtered on your OpenShift cluster name, and that
the charts are populated as in the following example:</p><p><a href=#R-image-7d0ea018ff93bb830c13460eb88c1306 class=lightbox-link><img alt="Kubernetes Pods" class="lazy lightbox figure-image" loading=lazy src=../images/Cisco-AI-Pod-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7d0ea018ff93bb830c13460eb88c1306><img alt="Kubernetes Pods" class="lazy lightbox lightbox-image" loading=lazy src=../images/Cisco-AI-Pod-dashboard.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 26, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-vector-database>Deploy the Vector Database</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In this step, we&rsquo;ll deploy a vector database to the OpenShift cluster and populate it with
test data.</p><h2 id=what-is-a-vector-database>What is a Vector Database?</h2><p>A <strong>vector database</strong> stores and indexes data as numerical &ldquo;vector embeddings,&rdquo; which capture
the <strong>semantic meaning</strong> of information like text or images. Unlike traditional databases,
they excel at <strong>similarity searches</strong>, finding conceptually related data points rather
than exact matches.</p><h2 id=how-is-a-vector-database-used>How is a Vector Database Used?</h2><p>Vector databases play a key role in a pattern called
<strong>Retrieval Augmented Generation (RAG)</strong>, which is widely used by
applications that leverage Large Language Models (LLMs).</p><p>The pattern is as follows:</p><ul><li>The end-user asks a question to the application</li><li>The application takes the question and calculates a vector embedding for it</li><li>The app then performs a similarity search, looking for related documents in the vector database</li><li>The app then takes the original question and the related documents, and sends it to the LLM as context</li><li>The LLM reviews the context and returns a response to the application</li></ul><h2 id=deploy-a-vector-database>Deploy a Vector Database</h2><p>For the workshop, we&rsquo;ll deploy an open-source vector database named
<a href=https://weaviate.io/ rel=external>Weaviate</a>.</p><p>First, add the Weaviate helm repo that contains the Weaviate helm chart:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm repo add weaviate https://weaviate.github.io/weaviate-helm
</span></span><span class=line><span class=cl>helm repo update</span></span></code></pre></div><p>The <code>weaviate/weaviate-values.yaml</code> file includes the configuration we&rsquo;ll use to deploy
the Weviate vector database.</p><p>We&rsquo;ve set the following environment variables to <code>TRUE</code>, to ensure Weaviate exposes
metrics that we can scrape later with the Prometheus receiver:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>  PROMETHEUS_MONITORING_ENABLED: true
  PROMETHEUS_MONITORING_GROUP: true</code></pre></div><p>Review <a href=https://docs.weaviate.io/deploy/installation-guides/k8s-installation rel=external>Weaviate documentation</a>
to explore additional customization options available.</p><p>Let&rsquo;s create a new namespace:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc create namespace weaviate</span></span></code></pre></div><p>Run the following command to allow Weaviate to run a privileged container:</p><blockquote><p>Note: this approach is not recommended for production environments</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc adm policy add-scc-to-user privileged -z default -n weaviate</span></span></code></pre></div><p>Then deploy Weaviate:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade --install <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=s2>&#34;weaviate&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  weaviate/weaviate <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --namespace <span class=s2>&#34;weaviate&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --values ./weaviate/weaviate-values.yaml</span></span></code></pre></div><h2 id=capture-weaviate-metrics-with-prometheus>Capture Weaviate Metrics with Prometheus</h2><p>Now that Weaviate is installed in our OpenShift cluster, let&rsquo;s modify the
OpenTelemetry collector configuration to scrape Weaviate&rsquo;s Prometheus
metrics.</p><p>To do so, let&rsquo;s add an additional Prometheus receiver creator section
to the <code>otel-collector-values.yaml</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span><span class=nt>receiver_creator/weaviate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=c># Name of the extensions to watch for endpoints to start and stop.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>watch_observers</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=w> </span><span class=l>k8s_observer ]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>prometheus/weaviate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span><span class=nt>config</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                </span><span class=nt>scrape_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                  </span>- <span class=nt>job_name</span><span class=p>:</span><span class=w> </span><span class=l>weaviate-metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>scrape_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                    </span><span class=nt>static_configs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                      </span>- <span class=nt>targets</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>                          </span>- <span class=s1>&#39;`endpoint`:2112&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>rule</span><span class=p>:</span><span class=w> </span><span class=l>type == &#34;pod&#34; &amp;&amp; labels[&#34;app&#34;] == &#34;weaviate&#34;</span></span></span></code></pre></div><p>We&rsquo;ll need to ensure that Weaviate&rsquo;s metrics are added to the <code>filter/metrics_to_be_included</code> filter
processor configuration as well:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>filter/metrics_to_be_included</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=c># Include only metrics used in charts and detectors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>include</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>match_type</span><span class=p>:</span><span class=w> </span><span class=l>strict</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>metric_names</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>DCGM_FI_DEV_FB_FREE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>...</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>object_count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>vector_index_size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>vector_index_operations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>vector_index_tombstones</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>vector_index_tombstone_cleanup_threads</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>vector_index_tombstone_cleanup_threads</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>requests_total</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>objects_durations_ms_sum</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>objects_durations_ms_count</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>batch_delete_durations_ms_sum</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>              </span>- <span class=l>batch_delete_durations_ms_count</span></span></span></code></pre></div><p>We also want to add a Resource processor to the configuration file, with the following configuration:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span><span class=nt>resource/weaviate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>weaviate.instance.id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>from_attribute</span><span class=p>:</span><span class=w> </span><span class=l>service.instance.id</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>insert</span></span></span></code></pre></div><p>This processor takes the <code>service.instance.id</code> property on the Weaviate metrics
and copies it into a new property called <code>weaviate.instance.id</code>. This is done so
that we can more easily distinguish Weaviate metrics from other metrics that use
<code>service.instance.id</code>, which is a standard OpenTelemetry property used in
Splunk Observability Cloud.</p><p>We&rsquo;ll need to add a new metrics pipeline for Weaviate metrics as well (we
need to use a separate pipeline since we don&rsquo;t want the <code>weaviate.instance.id</code>
metric to be added to non-Weaviate metrics):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>        </span><span class=nt>metrics/weaviate</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>signalfx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>filter/metrics_to_be_included</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>resource/weaviate</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>resource</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span>- <span class=l>receiver_creator/weaviate</span></span></span></code></pre></div><p>Before applying the configuration changes to the collector, take a moment to compare the
contents of your modified <code>otel-collector-values.yaml</code> file with the
<code>otel-collector-values-with-weaviate.yaml</code> file.
Update your file as needed to ensure the contents match. Remember that indentation is important
for <code>yaml</code> files, and needs to be precise.</p><p>Now we can update the OpenTelemetry collector configuration by running the
following Helm command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm upgrade splunk-otel-collector <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;clusterName=</span><span class=nv>$CLUSTER_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;environment=</span><span class=nv>$ENVIRONMENT_NAME</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.accessToken=</span><span class=nv>$SPLUNK_ACCESS_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkObservability.realm=</span><span class=nv>$SPLUNK_REALM</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.endpoint=</span><span class=nv>$SPLUNK_HEC_URL</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.token=</span><span class=nv>$SPLUNK_HEC_TOKEN</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --set<span class=o>=</span><span class=s2>&#34;splunkPlatform.index=</span><span class=nv>$SPLUNK_INDEX</span><span class=s2>&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f ./otel-collector/otel-collector-values.yaml <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -n otel <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  splunk-otel-collector-chart/splunk-otel-collector</span></span></code></pre></div><p>In Splunk Observability Cloud, navigate to <code>Infrastructure</code> -> <code>AI Frameworks</code> -> <code>Weaviate</code>.
Filter on the <code>k8s.cluster.name</code> of interest, and ensure the navigator is populated as in the
following example:</p><p><a href=#R-image-4d881fc9c01eba11ad0f66c4d36456aa class=lightbox-link><img alt="Kubernetes Pods" class="lazy lightbox figure-image" loading=lazy src=../images/WeaviateNavigator.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4d881fc9c01eba11ad0f66c4d36456aa><img alt="Kubernetes Pods" class="lazy lightbox lightbox-image" loading=lazy src=../images/WeaviateNavigator.png></a></p><h2 id=populate-the-vector-database>Populate the Vector Database</h2><p>Now that Weaviate is up and running, and we&rsquo;re capturing metrics from it,
let&rsquo;s add some data to it that we&rsquo;ll use in the next part
of the workshop with a custom application.</p><p>The application used to do this is based on
<a href=https://docs.nvidia.com/nim/nemo-retriever/text-embedding/latest/playbook.html#generate-embeddings-with-text-embedding-nim rel=external>LangChain Playbook for NeMo Retriever Text Embedding NIM</a>.</p><p>Per the configuration in <code>./load-embeddings/k8s-job.yaml</code>, we&rsquo;re going to load
a <a href=https://nvdam.widen.net/content/udc6mzrk7a/original/hpc-datasheet-sc23-h200-datasheet-3002446.pdf rel=external>datasheet for the NVIDIA H200 Tensor Core GPU</a>
into our vector database.</p><p>This document includes information about NVIDIA&rsquo;s H200 GPUs that our large language model
isn&rsquo;t trained on. And in the next part of the workshop, we&rsquo;ll build an application that
uses an LLM to answer questions using the context from this document, which will be loaded
into the vector database.</p><p>We&rsquo;ll deploy a Kubernetes Job to our OpenShift cluster to load the embeddings.
A Kubernetes Job is used rather than a Pod to ensure that this process runs only once:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc create namespace llm-app
</span></span><span class=line><span class=cl>oc apply -f ./load-embeddings/k8s-job.yaml</span></span></code></pre></div><blockquote><p>Note: to build a Docker image for the Python application that loads the embeddings
into Weaviate, we executed the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/cisco-ai-pods/load-embeddings
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t derekmitchell399/load-embeddings:1.0 .
</span></span><span class=line><span class=cl>docker push derekmitchell399/load-embeddings:1.0</span></span></code></pre></div></blockquote><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deploy-the-llm-application>Deploy the LLM Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>In the final step of the workshop, we&rsquo;ll deploy an application to our OpenShift cluster
that uses the instruct and embeddings models that we deployed earlier using the
NVIDIA NIM operator.</p><h2 id=application-overview>Application Overview</h2><p>Like most applications that interact with LLMs, our application is written in Python.
It also uses <a href=https://www.langchain.com/ rel=external>LangChain</a>, which is an open-source orchestration
framework that simplifies the development of applications powered by LLMs.</p><p>Our application starts by connecting to two LLMs that we&rsquo;ll be using:</p><ul><li><code>meta/llama-3.2-1b-instruct</code>: used for responding to user prompts</li><li><code>nvidia/llama-3.2-nv-embedqa-1b-v2</code>: used to calculate embeddings</li></ul><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># connect to a LLM NIM at the specified endpoint, specifying a specific model</span>
</span></span><span class=line><span class=cl><span class=n>llm</span> <span class=o>=</span> <span class=n>ChatNVIDIA</span><span class=p>(</span><span class=n>base_url</span><span class=o>=</span><span class=n>INSTRUCT_MODEL_URL</span><span class=p>,</span> <span class=n>model</span><span class=o>=</span><span class=s2>&#34;meta/llama-3.2-1b-instruct&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize and connect to a NeMo Retriever Text Embedding NIM (nvidia/llama-3.2-nv-embedqa-1b-v2)</span>
</span></span><span class=line><span class=cl><span class=n>embeddings_model</span> <span class=o>=</span> <span class=n>NVIDIAEmbeddings</span><span class=p>(</span><span class=n>model</span><span class=o>=</span><span class=s2>&#34;nvidia/llama-3.2-nv-embedqa-1b-v2&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                   <span class=n>base_url</span><span class=o>=</span><span class=n>EMBEDDINGS_MODEL_URL</span><span class=p>)</span></span></span></code></pre></div><p>The URL&rsquo;s used for both LLMs are defined in the <code>k8s-manifest.yaml</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>INSTRUCT_MODEL_URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://meta-llama-3-2-1b-instruct.nim-service:8000/v1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>EMBEDDINGS_MODEL_URL</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://llama-32-nv-embedqa-1b-v2.nim-service:8000/v1&#34;</span></span></span></code></pre></div><p>The application then defines a prompt template that will be used in interactions
with the LLM:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>prompt</span> <span class=o>=</span> <span class=n>ChatPromptTemplate</span><span class=o>.</span><span class=n>from_messages</span><span class=p>([</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;system&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;You are a helpful and friendly AI!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Your responses should be concise and no longer than two sentences.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Do not hallucinate. Say you don&#39;t know if you don&#39;t have this information.&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Answer the question using only the context&#34;</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;</span><span class=se>\n\n</span><span class=s2>Question: </span><span class=si>{question}</span><span class=se>\n\n</span><span class=s2>Context: </span><span class=si>{context}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=s2>&#34;user&#34;</span><span class=p>,</span> <span class=s2>&#34;</span><span class=si>{question}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>])</span></span></span></code></pre></div><blockquote><p>Note how we&rsquo;re explicitly instructing the LLM to just say it doesn&rsquo;t know the answer if
it doesn&rsquo;t know, which helps minimize hallucinations. There&rsquo;s also a placeholder for
us to provide context that the LLM can use to answer the question.</p></blockquote><p>The application uses Flask, and defines a single endpoint named <code>/askquestion</code> to
respond to questions from end users. To implement this endpoint, the application
connects to the Weaviate vector database, and then invokes a chain (using LangChain)
that takes the user&rsquo;s question, converts it to an embedding, and then looks up similar
documents in the vector database. It then sends the user&rsquo;s question to the LLM, along
with the related documents, and returns the LLM&rsquo;s response.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>   <span class=c1># connect with the vector store that was populated earlier</span>
</span></span><span class=line><span class=cl>    <span class=n>vector_store</span> <span class=o>=</span> <span class=n>WeaviateVectorStore</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>client</span><span class=o>=</span><span class=n>weaviate_client</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>embedding</span><span class=o>=</span><span class=n>embeddings_model</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>index_name</span><span class=o>=</span><span class=s2>&#34;CustomDocs&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>text_key</span><span class=o>=</span><span class=s2>&#34;page_content&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>chain</span> <span class=o>=</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;context&#34;</span><span class=p>:</span> <span class=n>vector_store</span><span class=o>.</span><span class=n>as_retriever</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;question&#34;</span><span class=p>:</span> <span class=n>RunnablePassthrough</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=o>|</span> <span class=n>prompt</span>
</span></span><span class=line><span class=cl>        <span class=o>|</span> <span class=n>llm</span>
</span></span><span class=line><span class=cl>        <span class=o>|</span> <span class=n>StrOutputParser</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>response</span> <span class=o>=</span> <span class=n>chain</span><span class=o>.</span><span class=n>invoke</span><span class=p>(</span><span class=n>question</span><span class=p>)</span></span></span></code></pre></div><h2 id=instrument-the-application-with-opentelemetry>Instrument the Application with OpenTelemetry</h2><p>To capture metrics, traces, and logs from our application, we&rsquo;ve instrumented it with OpenTelemetry.
This required adding the following package to the <code>requirements.txt</code> file (which ultimately gets
installed with <code>pip install</code>):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>splunk-opentelemetry==2.7.0</code></pre></div><p>We also added the following to the <code>Dockerfile</code> used to build the
container image for this application, to install additional OpenTelemetry
instrumentation packages:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=c># Add additional OpenTelemetry instrumentation packages</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> opentelemetry-bootstrap --action<span class=o>=</span>install</span></span></code></pre></div><p>Then we modified the <code>ENTRYPOINT</code> in the <code>Dockerfile</code> to call <code>opentelemetry-instrument</code>
when running the application:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;opentelemetry-instrument&#34;</span><span class=p>,</span> <span class=s2>&#34;flask&#34;</span><span class=p>,</span> <span class=s2>&#34;run&#34;</span><span class=p>,</span> <span class=s2>&#34;-p&#34;</span><span class=p>,</span> <span class=s2>&#34;8080&#34;</span><span class=p>,</span> <span class=s2>&#34;--host&#34;</span><span class=p>,</span> <span class=s2>&#34;0.0.0.0&#34;</span><span class=p>]</span></span></span></code></pre></div><p>Finally, to enhance the traces and metrics collected with OpenTelemetry, we added a
package named <a href=https://openlit.io/ rel=external>OpenLIT</a> to the <code>requirements.txt</code> file:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>openlit==1.35.4</code></pre></div><p>OpenLIT supports LangChain, and adds additional context to traces at instrumentation time,
such as the number of tokens used to process the request, and what the prompt and
response were.</p><p>To initialize OpenLIT, we added the following to the application code:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>openlit</span>
</span></span><span class=line><span class=cl><span class=o>...</span>
</span></span><span class=line><span class=cl><span class=n>openlit</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>environment</span><span class=o>=</span><span class=s2>&#34;llm-app&#34;</span><span class=p>)</span></span></span></code></pre></div><h2 id=deploy-the-llm-application>Deploy the LLM Application</h2><p>Use the following command to deploy this application to the OpenShift cluster:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc apply -f ./llm-app/k8s-manifest.yaml</span></span></code></pre></div><blockquote><p>Note: to build a Docker image for this Python application, we executed the following commands:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> workshop/cisco-ai-pods/llm-app
</span></span><span class=line><span class=cl>docker build --platform linux/amd64 -t derekmitchell399/llm-app:1.0 .
</span></span><span class=line><span class=cl>docker push derekmitchell399/llm-app:1.0</span></span></code></pre></div></blockquote><h2 id=test-the-llm-application>Test the LLM Application</h2><p>Let&rsquo;s ensure the application is working as expected.</p><p>Start a pod that has access to the curl command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>oc run --rm -it -n default curl --image<span class=o>=</span>curlimages/curl:latest -- sh</span></span></code></pre></div><p>Then run the following command to send a question to the LLM:</p><div class=tab-panel data-tab-group=R-tabs-c67efd46dc6efc6387f8c41a3f5d3462><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bd3e74bc910d2234376dc9d5321c6c07 aria-expanded=true data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c67efd46dc6efc6387f8c41a3f5d3462","R-tab-f907e651164789346ae0a1e257c462d8")'>
<span class=tab-nav-text>Script</span>
</button>
<button aria-controls=R-tab-id-7b568da38731c947bf768ff13f40b9d0 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-c67efd46dc6efc6387f8c41a3f5d3462","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-bd3e74bc910d2234376dc9d5321c6c07 data-tab-item=R-tab-f907e651164789346ae0a1e257c462d8 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X <span class=s2>&#34;POST&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> <span class=s1>&#39;http://llm-app.llm-app.svc.cluster.local:8080/askquestion&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s1>&#39;Accept: application/json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -H <span class=s1>&#39;Content-Type: application/json&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -d <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;question&#34;: &#34;How much memory does the NVIDIA H200 have?&#34;
</span></span></span><span class=line><span class=cl><span class=s1>  }&#39;</span></span></span></code></pre></div></div></div><div id=R-tab-id-7b568da38731c947bf768ff13f40b9d0 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>The NVIDIA H200 has 141GB of HBM3e memory, which is twice the capacity of the NVIDIA H100 Tensor Core GPU with 1.4X more memory bandwidth.</span></span></code></pre></div></div></div></div></div><h2 id=view-trace-data-in-splunk-observability-cloud>View Trace Data in Splunk Observability Cloud</h2><p>In Splunk Observability Cloud, navigate to <code>APM</code> and then select <code>Service Map</code>.
Ensure the <code>llm-app</code> environment is selected. You should see a service map
that looks like the following:</p><p><a href=#R-image-3b31443bc1e9d6ae7d8565f134140029 class=lightbox-link><img alt="Service Map" class="lazy lightbox figure-image" loading=lazy src=../images/ServiceMap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b31443bc1e9d6ae7d8565f134140029><img alt="Service Map" class="lazy lightbox lightbox-image" loading=lazy src=../images/ServiceMap.png></a></p><p>Click on <code>Traces</code> on the right-hand side menu. Then select one of the slower running
traces. It should look like the following example:</p><p><a href=#R-image-22817b7ce74392a563fc1371e5fccd64 class=lightbox-link><img alt=Trace class="lazy lightbox figure-image" loading=lazy src=../images/Trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-22817b7ce74392a563fc1371e5fccd64><img alt=Trace class="lazy lightbox lightbox-image" loading=lazy src=../images/Trace.png></a></p><p>The trace shows all the interactions that our application executed to return an answer
to the users question (i.e. &ldquo;How much memory does the NVIDIA H200 have?&rdquo;)</p><p>For example, we can see where our application performed a similarity search to look
for documents related to the question at hand in the Weaviate vector database:</p><p><a href=#R-image-e3125c86b07e796f182269dd6fa0ff5f class=lightbox-link><img alt="Document Retrieval" class="lazy lightbox figure-image" loading=lazy src=../images/DocumentRetrieval.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e3125c86b07e796f182269dd6fa0ff5f><img alt="Document Retrieval" class="lazy lightbox lightbox-image" loading=lazy src=../images/DocumentRetrieval.png></a></p><p>We can also see how the application created a prompt to send to the LLM, including the
context that was retrieved from the vector database:</p><p><a href=#R-image-a281b83bfd80fe1b799ed3624c74a028 class=lightbox-link><img alt="Prompt Template" class="lazy lightbox figure-image" loading=lazy src=../images/PromptTemplate.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a281b83bfd80fe1b799ed3624c74a028><img alt="Prompt Template" class="lazy lightbox lightbox-image" loading=lazy src=../images/PromptTemplate.png></a></p><p>Finally, we can see the response from the LLM, the time it took, and the number of
input and output tokens utilized:</p><p><a href=#R-image-f28ae09e20f94661929954893cf69947 class=lightbox-link><img alt="LLM Response" class="lazy lightbox figure-image" loading=lazy src=../images/LLMResponse.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f28ae09e20f94661929954893cf69947><img alt="LLM Response" class="lazy lightbox lightbox-image" loading=lazy src=../images/LLMResponse.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 3, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=wrap-up>Wrap-Up</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=wrap-up>Wrap-Up</h2><p>We hope you enjoyed this workshop, which provided hands-on experience deploying and working
with several of the technologies that are used to monitor Cisco AI PODs with
Splunk Observability Cloud. Specifically, you had the opportunity to:</p><ul><li>Deploy a RedHat OpenShift cluster with GPU-based worker nodes.</li><li>Deploy the NVIDIA NIM Operator and NVIDIA GPU Operator.</li><li>Deploy Large Language Models (LLMs) using NVIDIA NIM to the cluster.</li><li>Deploy the OpenTelemetry Collector in the Red Hat OpenShift cluster.</li><li>Add Prometheus receivers to the collector to ingest infrastructure metrics.</li><li>Deploy the Weaviate vector database to the cluster.</li><li>Instrument Python services that interact with Large Language Models (LLMs) with OpenTelemetry.</li><li>Understand which details which OpenTelemetry captures in the trace from applications that interact with LLMs.</li></ul><h2 id=clean-up-steps>Clean Up Steps</h2><p>Follow the steps in this section to uninstall the OpenShift cluster.</p><p>Get the cluster ID, the Amazon Resource Names (ARNs) for the cluster-specific Operator roles,
and the endpoint URL for the OIDC provider by running the following command:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa describe cluster --cluster<span class=o>=</span><span class=nv>$CLUSTER_NAME</span></span></span></code></pre></div><p>Delete the cluster using the following command</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa delete cluster --cluster<span class=o>=</span><span class=nv>$CLUSTER_NAME</span> --watch</span></span></code></pre></div><p>Delete the cluster-specific Operator IAM roles:</p><blockquote><p>Note: just accept the default values when prompted.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa delete operator-roles --prefix <span class=nv>$OPERATOR_ROLES_PREFIX</span></span></span></code></pre></div><p>Delete the OIDC provider:</p><blockquote><p>Note: just accept the default values when prompted.</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rosa delete oidc-provider --oidc-config-id <span class=nv>$OIDC_ID</span></span></span></code></pre></div><p>Delete the network:</p><blockquote><p>Note: add the name of the CloudFormation stack used to create the network before
running the following command</p></blockquote><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>aws cloudformation delete-stack --region <span class=nv>$AWS_REGION</span> --stack-name &lt;stack name i.e. rosa-network-stack-nnnnnnnnnnn&gt;</span></span></code></pre></div><p>Refer to <a href=https://docs.redhat.com/en/documentation/red_hat_openshift_service_on_aws/4/html/install_clusters/rosa-hcp-deleting-cluster rel=external>OpenShift documentation</a>
if you&rsquo;d like to completely remove the Red Hat OpenShift Service from your AWS account.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 30, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=splunk4ninjas-appdynamics>Splunk4Ninjas AppDynamics</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>Splunk AppDynamics is a full-stack performance monitoring solution for your critical business applications that offers the following features:</p><ul><li>Consistent end-to-end application monitoring, regardless of environment, traditional, hybrid, or cloud-native.</li><li>Accelerated cloud migration and enterprise-grade, end-to-end insights for your applications regardless of where they are deployed.</li><li>Unified monitoring that enables you to quickly resolve performance issues before they become business problems, with three clicks to root cause.</li></ul><p>You can optimize the total cost of ownership by leveraging existing personnel, processes, and training on AppDynamics platform for traditional, cloud, or hybrid deployments.</p><p><a href=#R-image-6e574697031b61f7d93ad926472729b6 class=lightbox-link><img alt="Screenshot of AppDynamics Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e574697031b61f7d93ad926472729b6><img alt="Screenshot of AppDynamics Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/images/controller-vm.png></a></p><h2 id=workshop-overview>Workshop Overview</h2><p>In this workshop, weâ€™ll cover the fundamentals of Splunk AppDynamics. We&rsquo;ll demonstrate how Splunk AppDynamics enables you to monitor the health of your application services, Web Applications, Databases and more. When you have completed this workshop, you will be able to :</p><ul><li>Download and install the AppDynamics Java APM Agent.</li><li>Configure collection settings in the Controller.</li><li>Monitor and troubleshoot your applicationâ€™s performance health.</li><li>Monitor alerts in AppDynamicâ€™s monitoring service based off of data captured by AppDynamics.</li><li>Monitor server health and troubleshoot issues</li><li>Monitor the health of your browser based application with BRUM</li><li>Monitor and troubleshoot Database performance</li><li>Gain deeper visibility into your users with Splunk AppDynamics Business IQ</li></ul><h2 id=additional-work-to-be-done>Additional Work to be Done</h2><ul><li>Add a section covering health rules, how to view existing ones, create new health rule</li><li>Application Security</li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 4, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Splunk4Ninjas AppDynamics</h1><article class=default><header class=headline></header><h1 id=application-performance-monitoring-apm>Application Performance Monitoring (APM)</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=objectives>Objectives</h2><p>In this Lab you learn how to use AppDynamics to monitor the health of your application services. You will need to complete this lab first before you start the other labs in this Workshop.</p><p>When you have completed this lab, you will be able to:</p><ul><li>Download the AppDynamics Java APM Agent.</li><li>Install the AppDynamics Java APM Agent.</li><li>Initialize the sample application with load.</li><li>Understand the core concepts of AppDynamics APM</li><li>Configure collection settings in the Controller.</li><li>Monitor your applicationâ€™s health.</li><li>Troubleshoot application performance issues to find root cause.</li><li>Monitor alerts in AppDynamicâ€™s monitoring service based off of data captured by AppDynamics.</li></ul><h2 id=workshop-environment>Workshop Environment</h2><p>The workshop environment has two hosts:</p><ul><li>The first host runs the AppDynamics Controller and will be referred to from this point on as the Controller.</li><li>The second host runs the Supercar Trader application used in the labs. It will be the host where you will install the AppDynamics agents and will be referred to from this point on as the Application VM.</li></ul><h2 id=controller>Controller</h2><p>You will be using the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> for this workshop.</p><p><a href=#R-image-9d9767cd1b1a97bd79bfaac0b90d449e class=lightbox-link><img alt=Controller class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9d9767cd1b1a97bd79bfaac0b90d449e><img alt=Controller class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/images/controller-vm.png></a></p><h2 id=application-vm>Application VM</h2><p>Supercar Trader is a Java-based Web Application</p><p>The purpose of Supercar-Trader collection is to generate dynamic traffic (Business Transactions) for the AppDynamics Controller.</p><p><a href=#R-image-017d4f992c0f90818b564fb9d970cb1a class=lightbox-link><img alt="Application VM" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/images/application-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-017d4f992c0f90818b564fb9d970cb1a><img alt="Application VM" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/images/application-vm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Application Performance Monitoring (APM)</h1><article class=default><header class=headline></header><h1 id=1-download-java-agent>1. Download Java Agent</h1><p>In this exercise you will access the AppDynamics Controller from a web browser and download the Java APM agent from there.</p><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=configure-your-application>Configure your Application</h2><ol><li>Select <strong>Overview</strong> on the left navigation panel</li><li>Click on <strong>Getting Started</strong> tab</li><li>Click on <strong>Getting Started Wizard</strong> button</li></ol><p><a href=#R-image-a87760482c912539d9f34bb63795880d class=lightbox-link><img alt="Getting Started Wizard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/agent-wizard-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a87760482c912539d9f34bb63795880d><img alt="Getting Started Wizard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/agent-wizard-rz.png></a></p><p>Select the Java Application Type</p><p><a href=#R-image-cffc58028cd1a0574e60f036177b3205 class=lightbox-link><img alt="Java Application" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/select-java-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cffc58028cd1a0574e60f036177b3205><img alt="Java Application" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/select-java-rz.png></a></p><h2 id=download-the-java-agent>Download the Java Agent</h2><ol><li>Select the <strong>Sun/JRockit - Legacy</strong> for the JVM type</li><li>Accept defaults for the Controller connection.</li><li>Under <strong>Set Application and Tier</strong>, select <strong>Create a new Application:</strong></li><li>Enter <strong>Supercar-Trader-YOURINITIALS</strong> as the application name.</li><li>Enter <strong>Web Portal</strong> for the new Tier</li><li>Enter <strong>Web-Portal_Node-01</strong> for the Node Name</li><li>Click <strong>Continue</strong></li><li>Click <strong>Click Here to Download</strong>.</li></ol><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Warning</summary><div class=box-content><p>The application name must be unique, make sure to append your initials or add a unique identifier to the application name</p></div></details><p><a href=#R-image-b860d4556d6985ba75ec02172572dfc0 class=lightbox-link><img alt="Agent Configuration1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/java-agent-config1-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b860d4556d6985ba75ec02172572dfc0><img alt="Agent Configuration1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/java-agent-config1-rz.png></a></p><p><a href=#R-image-bca81815df692386157f0acc873ada38 class=lightbox-link><img alt="Agent Configuration2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/java-agent-config2-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bca81815df692386157f0acc873ada38><img alt="Agent Configuration2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/java-agent-config2-rz.png></a></p><p>Your browser should prompt you that the agent is being downloaded to your local file system. Make sure to take note of where the file was downloaded to and the full name of it.</p><p><a href=#R-image-ef4a6b6f7872d28f0f69e88fed3213de class=lightbox-link><img alt="Agent Bundle" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/agent-bundle-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ef4a6b6f7872d28f0f69e88fed3213de><img alt="Agent Bundle" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/1-download-agent/images/agent-bundle-rz.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-install-the-java-agent>2. Install the Java Agent</h1><p>In this exercise you will perform the following actions:</p><ul><li>Upload the Java agent file to your EC2 instance</li><li>Unzip the file into a specific directory</li><li>Update the Java agents XML configuration file (optional)</li><li>Modify the Apache Tomcat startup script to add the Java agent</li></ul><h2 id=upload-java-agent-to-application-vm>Upload Java Agent to Application VM</h2><p>By this point you should have received the information regarding the EC2 instance that you will be using for this workshop. Ensure you have the IP address of your EC2 instance, username and password required to ssh into the instance .</p><p>On your local machine, open a terminal window and change into the directory where the java agent file was downloaded to. Upload the file into the EC2 instance using the following command. This may take some time to complete.</p><ul><li>Update the IP address or public DNS for your instance.</li><li>Update the filename to match your exact version.</li></ul><div class=tab-panel data-tab-group=R-tabs-2cef0ec16db4180d2fd28bd3f4ba923e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d75c260c3e9622e2dbbc7931f3fcfb26 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2cef0ec16db4180d2fd28bd3f4ba923e","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-f58cc702997566a4918afe174fa64973 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-2cef0ec16db4180d2fd28bd3f4ba923e","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d75c260c3e9622e2dbbc7931f3fcfb26 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/Downloads
</span></span><span class=line><span class=cl>scp -P <span class=m>2222</span> AppServerAgent-22.4.0.33722.zip splunk@i-0b6e3c9790292be66.splunk.show:/home/splunk</span></span></code></pre></div></div></div><div id=R-tab-id-f58cc702997566a4918afe174fa64973 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>(</span>splunk@44.247.206.254<span class=o>)</span> Password:
</span></span><span class=line><span class=cl>AppServerAgent-22.4.0.33722.zip                                                                    100%   22MB 255.5KB/s   01:26</span></span></code></pre></div></div></div></div></div><h2 id=unzip-the-java-agent>Unzip the Java Agent</h2><p>SSH into your EC2 instance using the instance and password assigned to you by the instructor.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -P <span class=m>2222</span> splunk@i-0b6e3c9790292be66.splunk.show</span></span></code></pre></div><p>Unzip the java agent bundle into a new directory.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics
</span></span><span class=line><span class=cl>mkdir javaagent
</span></span><span class=line><span class=cl>cp /home/splunk/AppServerAgent-*.zip /opt/appdynamics/javaagent
</span></span><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/javaagent
</span></span><span class=line><span class=cl>unzip AppServerAgent-*.zip</span></span></code></pre></div><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>We pre-configured the Java agent using the Controller&rsquo;s Getting Started Wizard. If you download the agent from the AppDynamics Portal, you will need to manually update the Java agentâ€™s XML configuration file.</p><p>There are three primary ways to set the configuration properties of the Java agent. These take precedence in the following order:</p><ol><li>System environment variables.</li><li>JVM properties passed on the command line.</li><li>Properties within the <code>controller-info.xml</code> file.</li></ol></div></details><h2 id=add-the-java-agent-to-the-tomcat-server>Add the Java Agent to the Tomcat Server</h2><p>First we want to make sure that the Tomcat server is not running</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./shutdown.sh</span></span></code></pre></div><p>We will now modify the catalina script to set an environment variable with the java agent.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>nano catalina.sh</span></span></code></pre></div><p>Add the following line at 125 (after the initial comments) & save the file</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>export</span> <span class=nv>CATALINA_OPTS</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$CATALINA_OPTS</span><span class=s2> -javaagent:/opt/appdynamics/javaagent/javaagent.jar&#34;</span></span></span></code></pre></div><p>Restart the server</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./startup.sh</span></span></code></pre></div><p>Validate that the Tomcat server is running, this can take a few minutes</p><div class=tab-panel data-tab-group=R-tabs-01028f904b26e3c01284940fd084dead><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-588960c453626797aa834d040b7271bb aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-01028f904b26e3c01284940fd084dead","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-e35128e16d5e562919d912337c974054 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-01028f904b26e3c01284940fd084dead","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-588960c453626797aa834d040b7271bb data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:8080</span></span></code></pre></div></div></div><div id=R-tab-id-e35128e16d5e562919d912337c974054 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;head&gt;
</span></span><span class=line><span class=cl>        &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;title&gt;Apache Tomcat/9.0.50&lt;/title&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;favicon.ico&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;image/x-icon&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;tomcat.css&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> /&gt;
</span></span><span class=line><span class=cl>    &lt;/head&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;body&gt;
</span></span><span class=line><span class=cl>        &lt;div <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;wrapper&#34;</span>
</span></span><span class=line><span class=cl>....</span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-generate-application-load>3. Generate Application Load</h1><p>In this exercise you will perform the following actions:</p><ul><li>Verify the sample app is running.</li><li>Start the load generation for the sample application.</li><li>Confirm the transaction load in the Controller.</li></ul><h2 id=verify-that-the-sample-application-is-running>Verify that the Sample Application is Running</h2><p>The sample application home page is accessible through your web browser with a URL in the format seen below. Enter that URL in your browserâ€™s navigation bar, substituting the IP Address of your EC2 instance.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://<span class=o>[</span>ec2-ip-address<span class=o>]</span>:8080/Supercar-Trader/home.do</span></span></code></pre></div><p>You should be able to see the home page of the Supercar Trader application.
<a href=#R-image-a7dcb5191a08d131d29ab79bbb1c1cc8 class=lightbox-link><img alt="Supercar Trade Home Page" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/SuperCarHomePage-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a7dcb5191a08d131d29ab79bbb1c1cc8><img alt="Supercar Trade Home Page" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/SuperCarHomePage-rz.png></a></p><h2 id=start-the-load-generation>Start the Load Generation</h2><p>SSH into your ec2 instance and start the load generation. It may take a few minutes for all the scripts to run.</p><div class=tab-panel data-tab-group=R-tabs-f604dd11a7ccc9e90f5e6ed847eaef45><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-06b44edc56692895cd1c209bdb7e9954 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f604dd11a7ccc9e90f5e6ed847eaef45","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-5b69d91fdee05927dab68b3bf1cbde5d aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-f604dd11a7ccc9e90f5e6ed847eaef45","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-06b44edc56692895cd1c209bdb7e9954 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./start_load.sh</span></span></code></pre></div></div></div><div id=R-tab-id-5b69d91fdee05927dab68b3bf1cbde5d data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Cleaning up artifacts from previous load...
</span></span><span class=line><span class=cl>Starting home-init-01
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>1</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>2</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>3</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>4</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>5</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>6</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>7</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>8</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>9</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>10</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>11</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>12</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>13</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>14</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>15</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>16</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>17</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>18</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>19</span>
</span></span><span class=line><span class=cl>Waiting <span class=k>for</span> additional JVMs to initialize... <span class=m>20</span>
</span></span><span class=line><span class=cl>Starting slow-query-01
</span></span><span class=line><span class=cl>Starting slow-query-02
</span></span><span class=line><span class=cl>Starting slow-query-03
</span></span><span class=line><span class=cl>Starting slow-query-04
</span></span><span class=line><span class=cl>Starting sessions-01
</span></span><span class=line><span class=cl>Starting sessions-02
</span></span><span class=line><span class=cl>Starting sell-car-01
</span></span><span class=line><span class=cl>Starting sell-car-02
</span></span><span class=line><span class=cl>Starting sessions-03
</span></span><span class=line><span class=cl>Starting sessions-04
</span></span><span class=line><span class=cl>Starting search-01
</span></span><span class=line><span class=cl>Starting request-error-01
</span></span><span class=line><span class=cl>Starting mem-leak-insurance
</span></span><span class=line><span class=cl>Finished starting load generator scripts                                                                100%   22MB 255.5KB/s   01:26</span></span></code></pre></div></div></div></div></div><h2 id=confirm-transaction-load-in-the-controller>Confirm transaction load in the Controller</h2><p>If you still have the Getting Started Wizard open in your web browser, you should see that the agent is now connected and that the Controller is receiving data.</p><p><a href=#R-image-f9e54422180d940d8812872331314112 class=lightbox-link><img alt="Agent Connected" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/agent_connected.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9e54422180d940d8812872331314112><img alt="Agent Connected" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/agent_connected.png></a></p><p>Click <strong>Continue</strong> and you will be taken to the <strong>Application Flow Map</strong> (you can jump to the Flow Map image below).</p><p>If you previously closed the Controller browser window, log back into the Controller.</p><ol><li><p>From the Overview page (Landing Page). Click on the <strong>Applications</strong> tab on the left navigation panel.</p><p><a href=#R-image-a5640275941bd9cbefd0f7a75f03891b class=lightbox-link><img alt="Controller Overview Page" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ControllerOverviewPage.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a5640275941bd9cbefd0f7a75f03891b><img alt="Controller Overview Page" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ControllerOverviewPage.png></a></p></li><li><p>Within the <strong>Applications</strong> page you can manually search for your application or you can use the search bar in the top right corner to narrow down your search.</p><p><a href=#R-image-a4d8221b59112c816713ef220bac95ce class=lightbox-link><img alt="Applications Search" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ApplicationsSearch.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4d8221b59112c816713ef220bac95ce><img alt="Applications Search" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ApplicationsSearch.png></a></p></li></ol><p>Click in your application&rsquo;s name, this should bring you into the <strong>Application Flow Map</strong>, you should see all the application components appear after twelve minutes.</p><p>If you donâ€™t see all the application components after twelve minutes, try waiting a few more minutes and refresh your browser tab.</p><p><a href=#R-image-11af8274cf14f9207ac8c338bb0765cb class=lightbox-link><img alt=FlowMap class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/SuperCarTrader_FlowMap-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11af8274cf14f9207ac8c338bb0765cb><img alt=FlowMap class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/SuperCarTrader_FlowMap-rz.png></a></p><p>During the agent download step we assigned the Tier name and Node name for the Tomcat server.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;tier-name&gt;Web-Portal&lt;/tier-name&gt;
</span></span><span class=line><span class=cl>&lt;node-name&gt;Web-Portal_Node-01&lt;/node-name&gt;</span></span></code></pre></div><p>You might be wondering how the other four services had their Tier and Node name assigned. The sample application dynamically creates four additional JVMs from the initial Tomcat JVM and assigns the Tier and Node names by passing those properties into the JVM startup command as -D properties for each of the four services. Any -D properties included on the JVM startup command line will supersede the properties defined in the Java agents <code>controller-info.xml</code> file.</p><p>To see the JVM startup parameters used for each of the four services that were dynamically started, issue the following command in your terminal window of your ec2 instance.</p><div class=tab-panel data-tab-group=R-tabs-361013ff4d6829880ef8096bdc9868d4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-621ccc123bbc00be2d2c2b9d7e53a978 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-361013ff4d6829880ef8096bdc9868d4","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-4325e74720d697a1bb0206342e5fb830 aria-expanded=false data-tab-item=R-tab-54a7ac992a5ca30f7ce891ff85a0ca52 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-361013ff4d6829880ef8096bdc9868d4","R-tab-54a7ac992a5ca30f7ce891ff85a0ca52")'>
<span class=tab-nav-text>Loadgen Output</span></button></div><div class=tab-content-container><div id=R-tab-id-621ccc123bbc00be2d2c2b9d7e53a978 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps -ef <span class=p>|</span> grep appdynamics.agent.tierName</span></span></code></pre></div></div></div><div id=R-tab-id-4325e74720d697a1bb0206342e5fb830 data-tab-item=R-tab-54a7ac992a5ca30f7ce891ff85a0ca52 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>splunk     <span class=m>47131</span>   <span class=m>46757</span>  <span class=m>3</span> 15:34 pts/1    00:08:17 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java -javaagent:/opt/appdynamics/javaagent/javaagent.jar -Dappdynamics.controller.hostName<span class=o>=</span>se-lab.saas.appdynamics.com -Dappdynamics.controller.port<span class=o>=</span><span class=m>443</span> -Dappdynamics.controller.ssl.enabled<span class=o>=</span><span class=nb>true</span> -Dappdynamics.agent.applicationName<span class=o>=</span>Supercar-Trader-AppD-Workshop -Dappdynamics.agent.tierName<span class=o>=</span>Api-Services -Dappdynamics.agent.nodeName<span class=o>=</span>Api-Services_Node-01 -Dappdynamics.agent.accountName<span class=o>=</span>se-lab -Dappdynamics.agent.accountAccessKey<span class=o>=</span>hj6a4d7h2cuq -Xms64m -Xmx512m -XX:MaxPermSize<span class=o>=</span>256m supercars.services.api.ApiService
</span></span><span class=line><span class=cl>splunk     <span class=m>47133</span>   <span class=m>46757</span>  <span class=m>2</span> 15:34 pts/1    00:08:11 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java -javaagent:/opt/appdynamics/javaagent/javaagent.jar -Dappdynamics.controller.hostName<span class=o>=</span>se-lab.saas.appdynamics.com -Dappdynamics.controller.port<span class=o>=</span><span class=m>443</span> -Dappdynamics.controller.ssl.enabled<span class=o>=</span><span class=nb>true</span> -Dappdynamics.agent.applicationName<span class=o>=</span>Supercar-Trader-AppD-Workshop -Dappdynamics.agent.tierName<span class=o>=</span>Inventory-Services -Dappdynamics.agent.nodeName<span class=o>=</span>Inventory-Services_Node-01 -Dappdynamics.agent.accountName<span class=o>=</span>se-lab -Dappdynamics.agent.accountAccessKey<span class=o>=</span>hj6a4d7h2cuq -Xms64m -Xmx512m -XX:MaxPermSize<span class=o>=</span>256m supercars.services.inventory.InventoryService
</span></span><span class=line><span class=cl>splunk     <span class=m>47151</span>   <span class=m>46757</span>  <span class=m>1</span> 15:34 pts/1    00:04:58 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java -javaagent:/opt/appdynamics/javaagent/javaagent.jar -Dappdynamics.controller.hostName<span class=o>=</span>se-lab.saas.appdynamics.com -Dappdynamics.controller.port<span class=o>=</span><span class=m>443</span> -Dappdynamics.controller.ssl.enabled<span class=o>=</span><span class=nb>true</span> -Dappdynamics.agent.applicationName<span class=o>=</span>Supercar-Trader-AppD-Workshop -Dappdynamics.agent.tierName<span class=o>=</span>Insurance-Services -Dappdynamics.agent.nodeName<span class=o>=</span>Insurance-Services_Node-01 -Dappdynamics.agent.accountName<span class=o>=</span>se-lab -Dappdynamics.agent.accountAccessKey<span class=o>=</span>hj6a4d7h2cuq -Xms64m -Xmx68m -XX:MaxPermSize<span class=o>=</span>256m supercars.services.insurance.InsuranceService
</span></span><span class=line><span class=cl>splunk     <span class=m>47153</span>   <span class=m>46757</span>  <span class=m>3</span> 15:34 pts/1    00:08:17 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java -javaagent:/opt/appdynamics/javaagent/javaagent.jar -Dappdynamics.controller.hostName<span class=o>=</span>se-lab.saas.appdynamics.com -Dappdynamics.controller.port<span class=o>=</span><span class=m>443</span> -Dappdynamics.controller.ssl.enabled<span class=o>=</span><span class=nb>true</span> -Dappdynamics.agent.applicationName<span class=o>=</span>Supercar-Trader-AppD-Workshop -Dappdynamics.agent.tierName<span class=o>=</span>Enquiry-Services -Dappdynamics.agent.nodeName<span class=o>=</span>Enquiry-Services_Node-01 -Dappdynamics.agent.accountName<span class=o>=</span>se-lab -Dappdynamics.agent.accountAccessKey<span class=o>=</span>hj6a4d7h2cuq -Xms64m -Xmx512m -XX:MaxPermSize<span class=o>=</span>256m supercars.services.enquiry.EnquiryService
</span></span><span class=line><span class=cl>splunk    <span class=m>144789</span>   <span class=m>46722</span>  <span class=m>0</span> 20:09 pts/1    00:00:00 grep --color<span class=o>=</span>auto appdynamics.agent.tierName</span></span></code></pre></div></div></div></div></div><p>Once all of the components appear on the flow map, you should see an HTTP cloud icon that represents the three HTTP backends called by the Insurance-Services Tier.</p><p>Ungroup the the three HTTP backends by following these steps.</p><ol><li>Right click the HTTP cloud icon labeled 3 HTTP backends</li><li>From the drop down menu, select Ungroup Backends</li></ol><p><a href=#R-image-66c719df32f3ab6409aecc03682dea9e class=lightbox-link><img alt="Ungroup Http" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ungroup-http-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-66c719df32f3ab6409aecc03682dea9e><img alt="Ungroup Http" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ungroup-http-rz.png></a></p><p>Once the HTTP backends have been ungrouped, you should see all three HTTP backends as shown in the following image.</p><p><a href=#R-image-5680df65c4b1de49ba33e2c3eb1fc615 class=lightbox-link><img alt="Ungroup flow" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ungrouped_flow-rz.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5680df65c4b1de49ba33e2c3eb1fc615><img alt="Ungroup flow" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/3-generate-application-load/images/ungrouped_flow-rz.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-appdynamics-core-concepts>4. AppDynamics Core Concepts</h1><p>In this section you will learn about the core concepts of Splunk Appdynamics APM features. By the end of the section you will understand the following concepts:</p><ul><li>Application Flow Maps</li><li>Business Transactions (BTs)</li><li>Snapshots</li><li>Call Graphs</li></ul><h2 id=flow-maps>Flow Maps</h2><p>AppDynamics app agents automatically discover the most common application frameworks and services. Using built-in application detection and configuration settings, agents collect application data and metrics to build Flow Maps.</p><p>AppDynamics automatically captures and scores every transaction. Flow Maps present a dynamic visual representation of the components and activities of your monitored application environment in direct context of the time frame that you have selected.</p><p>Familiarize yourself with the some of the different features of the Flow Map.</p><ol><li>Try using the different layout options (you can also click and drag each icon on the Flow Map to reposition it).</li><li>Try using the slider and mouse scrollwheel to adjust the zoom level.</li><li>Look at the Transaction Scorecard.</li><li>Explore the options for editing the Flow Map.</li></ol><p>You can read more about Flow Maps <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/business-applications/flow-maps/flow-map-overview rel=external>here</a></p><p><a href=#R-image-73e179a00a359da592eb5aa9150beba3 class=lightbox-link><img alt="Flow Map Components" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/FlowMapComponents.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-73e179a00a359da592eb5aa9150beba3><img alt="Flow Map Components" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/FlowMapComponents.png></a></p><h2 id=business-transactions>Business Transactions</h2><p>In the AppDynamics model, a Business Transaction represents the data processing flow for a request, most often a user request. In real-world terms, many different components in your application may interact to provide services to fulfill the following types of requests:</p><ul><li>In an e-commerce application, a user logging in, searching for items or adding items to the cart.</li><li>In a content portal, a user requests content such as sports, business or entertainment news.</li><li>In a stock trading application, operations such as receiving a stock quote, buying or selling stocks.<br>Because AppDynamics orients performance monitoring around Business Transactions, you can focus on the performance of your application components from the user perspective. You can quickly identify whether a component is readily available or if it is having performance issues. For instance, you can check whether users are able to log in, check out or view their data. You can see response times for users, and the causes of problems when they occur.</li></ul><p>You can read more about Business Transactions <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/overview-of-application-monitoring/business-transactions rel=external>here</a> and <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/business-transactions rel=external>here</a></p><h2 id=verifying-business-transactions>Verifying Business Transactions</h2><p>Verify that Business Transactions are being automatically detected by following these steps.</p><ol><li>Click the <strong>Business Transactions</strong> option on the left menu.</li><li>Look at the list of Business Transactions and their performance.</li></ol><p><a href=#R-image-f9282ff94890e3878aee2de9ff54562a class=lightbox-link><img alt="Business Transactions" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/business-transactions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f9282ff94890e3878aee2de9ff54562a><img alt="Business Transactions" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/business-transactions.png></a></p><h2 id=snapshots>Snapshots</h2><p>AppDynamics monitors every execution of a Business Transaction in the instrumented environment, and the metrics reflect all such executions. However, for troubleshooting purposes, AppDynamics takes snapshots (containing deep diagnostic information) of specific instances of transactions that are having problems.</p><p>Verify that transaction snapshots are being automatically collected by following these steps.</p><ol><li>Click the <strong>Application Dashboard</strong> option on the left menu.</li><li>Click the <strong>Transaction Snapshots</strong> tab.</li><li>Click the <strong>Exe Time (ms)</strong> column to sort the snapshots with the greatest execution time.</li><li>Double-click a Business Transaction snapshot to display the snapshot viewer</li></ol><p><a href=#R-image-c4c929fd9c6245a6653aad06de1ee82d class=lightbox-link><img alt=Snapshots class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/snapshots.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c4c929fd9c6245a6653aad06de1ee82d><img alt=Snapshots class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/snapshots.png></a></p><p>A transaction snapshot gives you a cross-tier view of the processing flow for a single invocation of a transaction.</p><p>The <strong>Potential Issues</strong> panel highlights slow methods and slow remote service calls and help you investigate the root cause for performance issues.</p><h2 id=drill-downs--call-graphs>Drill Downs & Call Graphs</h2><p>Call graphs and drill downs provide key information, including slowest methods, errors, and remote service calls for the transaction execution on a tier. A drill down may include a partial or complete call graph. Call graphs reflect the code-level view of the processing of the Business Transaction on a particular tier.</p><p>In the Flow Map for a Business Transaction snapshot, a tier with a Drill Down link indicates AppDynamics has taken a call graph for that tier.</p><p>Drill down into a call graph of the transaction snapshot by following these steps.</p><ol><li>Click on a slow call in the Potential Issues list on the left.</li><li>Click Drill Down into Call Graph.</li></ol><p><a href=#R-image-49cf9d65a543449f1cabb2201e050cea class=lightbox-link><img alt="Snapshot Drill Down" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/SnapShotDrillDown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-49cf9d65a543449f1cabb2201e050cea><img alt="Snapshot Drill Down" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/SnapShotDrillDown.png></a></p><p>The call graph view shows you the following details.</p><ol><li>The method execution sequence shows the names of the classes and methods that participated in processing the Business Transaction on this node, in the order in which the flow of control proceeded.</li><li>For each method, you can see the time and percentage spent processing and the line number in the source code, enabling you to pinpoint the location in the code that could be affecting the performance of the transaction.</li><li>The call graph displays exit call links for methods that make outbound calls to other components such as database queries and web service calls.</li></ol><p>You can read more about Transaction Snapshots <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/business-transactions/troubleshoot-business-transaction-performance-with-transaction-snapshots rel=external>here</a></p><p>You can read more about Call Graphs <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/business-transactions/troubleshoot-business-transaction-performance-with-transaction-snapshots/call-graphs rel=external>here</a></p><p><a href=#R-image-3e85511de2cb0dd129cb4b326fbe846a class=lightbox-link><img alt="Call Graph" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/call-graph.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e85511de2cb0dd129cb4b326fbe846a><img alt="Call Graph" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/4-apm-core-concepts/images/call-graph.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=5-configure-controller-settings>5. Configure Controller Settings</h1><p>In this exercise you will complete the following tasks:</p><ul><li>Adjust Business Transaction settings.</li><li>Adjust Call Graph settings.</li><li>Observe Business Transaction changes.</li></ul><h2 id=adjust-business-transaction-settings>Adjust Business Transaction Settings</h2><p>In the last exercise, you validated that Business Transactions were being auto-detected. There are times when you want to adjust the Business Transaction auto-detection rules to get them to an optimal state. This is the case with our sample application, which is built on an older Apache Struts framework.</p><p>The business transactions highlighted in the following image show that each pair has a Struts Action (.execute) and a Servlet type (.jsp). You will be adjusting the settings of the transaction detection rules so that these two types of transactions will be combined into one.</p><p>Anytime you see the time frame selector visible in the AppDynamics UI, the view you see will represents the context of the time frame selected. You can choose one of the pre-defined time frames or create your own custom time frame with the specific date and time range you want to view.</p><ol><li>Select the last 1 hour time frame.</li><li>Use your mouse to hover over the blue icons to see the Entry Point Type of the transaction.</li></ol><p><a href=#R-image-5d505945382cbf574c586e10d3b2f732 class=lightbox-link><img alt="List of Business Transactions" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/business-transactions-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d505945382cbf574c586e10d3b2f732><img alt="List of Business Transactions" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/business-transactions-list.png></a></p><p>Optimize the transaction detection by following these steps:</p><ol><li><p>Click the <strong>Configuration</strong> option toward the bottom left menu.</p></li><li><p>Click the <strong>Instrumentation</strong> link.</p><p><a href=#R-image-a908c095d878da3007a14970918ca486 class=lightbox-link><img alt="Configure Instrumentation" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/configure-instrumentation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a908c095d878da3007a14970918ca486><img alt="Configure Instrumentation" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/configure-instrumentation.png></a></p></li><li><p>Select <strong>Transaction Detection</strong> from the Instrumentation menu.</p></li><li><p>Select the <strong>Java Auto Discovery Rule</strong>.</p></li><li><p>Click <strong>Edit</strong>.</p><p><a href=#R-image-4c6f546d5978415096fb5c8beeebb3a8 class=lightbox-link><img alt="Edit Java Rules" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/edit-java-rule.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4c6f546d5978415096fb5c8beeebb3a8><img alt="Edit Java Rules" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/edit-java-rule.png></a></p></li><li><p>Select the <strong>Rule Configuration</strong> tab on the Rule Editor.</p></li><li><p>Uncheck all the boxes on <strong>Struts Action</strong> section.</p></li><li><p>Uncheck all the boxes on <strong>Web Service</strong> section.</p></li><li><p>Scroll down to find the Servlet settings.</p></li><li><p>Check the box <strong>Enable Servlet Filter Detection</strong> (all three boxes should be checked on Servlet settings).</p></li><li><p>Click <strong>Save</strong> to save your changes.</p></li></ol><p>You can read more about Transaction Detection Rules <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/configure-instrumentation/transaction-detection-rules rel=external>here</a>.</p><p><a href=#R-image-9a2480a96de61bc51be269e8e5a0c277 class=lightbox-link><img alt="Rule Configuration" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/rule-configuration1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9a2480a96de61bc51be269e8e5a0c277><img alt="Rule Configuration" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/rule-configuration1.png></a><br><a href=#R-image-9cbe790540ce4992acc6739558ebc238 class=lightbox-link><img alt="Rule Configuration Cont" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/rule-configuration2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9cbe790540ce4992acc6739558ebc238><img alt="Rule Configuration Cont" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/rule-configuration2.png></a></p><h2 id=adjust-call-graph-settings>Adjust Call Graph settings</h2><p>You can control the data captured in call graphs within transaction snapshots with the Call Graph Settings window seen below. In this step you will change the SQL Capture settings so the parameters of each SQL query are captured along with the full query. You can change the SQL Capture settings by following these steps.</p><ol><li>Select the <strong>Call Graph Settings</strong> tab from the Instrumentation window. This is within the <strong>Instrumentation</strong> settings which we navigated to from the previous exercise.</li><li>Ensure you have the <strong>Java</strong> tab selected within the settings.</li><li>Scroll down until you see the <strong>SQL Capture Settings</strong>.</li><li>Click the <strong>Capture Raw SQL</strong> option.</li><li>Click <strong>Save</strong>.</li></ol><p>You can read more about Call Graph settings <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/configure-instrumentation/call-graph-settings rel=external>here</a>.</p><p><a href=#R-image-76d0703a18692e30ef187b9d55ba9b80 class=lightbox-link><img alt="Call Graph Configuration" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/call-graph-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-76d0703a18692e30ef187b9d55ba9b80><img alt="Call Graph Configuration" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/call-graph-config.png></a></p><h2 id=observe-business-transaction-changes>Observe Business Transaction changes</h2><p>It may take up to 30 minutes for the new business transactions to replace the prior transactions. The list of business transactions should look like the following example after the new transactions are detected.</p><ol><li>Click on <strong>Business Transactions</strong> on the left menu.</li><li>Adjust your time range picker to look at the <strong>last 15 minutes</strong></li></ol><p><a href=#R-image-6b071ac84d6ab54eeefe967696e61657 class=lightbox-link><img alt="Updated BTs" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/updated_business_transactions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6b071ac84d6ab54eeefe967696e61657><img alt="Updated BTs" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/5-configure-controller/images/updated_business_transactions.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=6-troubleshooting-slow-transactions>6. Troubleshooting Slow Transactions</h1><p>In this exercise you will complete the following tasks:</p><ul><li>Monitor the application dashboard and flow map.</li><li>Troubleshoot a slow transaction snapshot.</li></ul><h2 id=monitor-the-application-dashboard-and-flow-map>Monitor the application dashboard and flow map</h2><p>In the previous exercises we looked at some of the basic features of the Application Flow Map. Letâ€™s take a deeper look at how we can use the Application Dashboard and Flow Map to immediately identify issues within the application.</p><ol><li><p>Health Rule Violations, Node Health issues, and the health of the Business Transactions will always show up in this area for the time frame you have selected. You can click the links available here to drill down to the details.</p></li><li><p>The Transaction Scorecard shows you the number and percentage of transactions that are normal, slow, very slow, stalled, and have errors. The scorecard also gives you the high level categories of exception types. You can click the links available here to drill down to the details.</p></li><li><p>Left-click (single-click) on any of the blue lines connecting the different application components to bring up an overview of the interactions between the two components.</p></li><li><p>Left-click (single-click) within the colored ring of a Tier to bring up detailed information about that Tier while remaining on the Flow Map.</p></li><li><p>Hover over the time series on one of the three charts at the bottom of the dashboard (Load, Response Time, Errors) to see the detail of the recorded metrics.</p><p><a href=#R-image-3685703d65f8093df0179437b98e4d0b class=lightbox-link><img alt="Flow Map Components" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/flow-map-components.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3685703d65f8093df0179437b98e4d0b><img alt="Flow Map Components" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/flow-map-components.png></a></p></li></ol><p>Now letâ€™s take look at Dynamics Baselines and options for the charts at the bottom of the dashboard.</p><ol><li><p>Compare the metrics on the charts to the Dynamic Baseline that has been automatically calculated for each of the metrics.</p></li><li><p>The Dynamic Baseline is shown in the load and response time charts as the blue dotted line seen in the following image.</p></li><li><p>Left-click and hold down your mouse button while dragging from left to right to highlight a spike seen in any of the three charts at the bottom of the dashboard.</p></li><li><p>Release your mouse button and select one of the three options in the pop-up menu.</p><p><a href=#R-image-edc3b143be43a4640830320f1d98c298 class=lightbox-link><img alt="Flow Map Components" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/flowmap_components2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-edc3b143be43a4640830320f1d98c298><img alt="Flow Map Components" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/flowmap_components2.png></a></p></li></ol><p>The precision of AppDynamics unique Dynamic Baselining increases over time to provide you with an accurate picture of the state of your applications, their components, and their business transactions, so you can be proactively alerted before things get to a critical state and take action before your end users are impacted.</p><p>You can read more about AppDynamics Dynamic Baselines <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/business-transactions/monitor-the-business-transaction-performance/dynamic-baselines rel=external>here</a>.</p><h2 id=troubleshoot-a-slow-transaction-snapshot>Troubleshoot a slow transaction snapshot</h2><p>Letâ€™s look at our business transactions and find the one that has the highest number of very slow transactions by following these steps.</p><ol><li><p>Click the <strong>Business Transactions</strong> option on the left menu.</p></li><li><p>Click the <strong>View Options</strong> button.</p></li><li><p>Check and uncheck the boxes on the options to match what you see in the following image:</p><p><a href=#R-image-846ae1119ec99cab80d177680b9099b2 class=lightbox-link><img alt="BTs Column Config" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/bt-configure-columns.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-846ae1119ec99cab80d177680b9099b2><img alt="BTs Column Config" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/bt-configure-columns.png></a></p></li><li><p>Find the Business Transaction named /Supercar-Trader/car.do and drill into the very slow transaction snapshots by clicking on the number of Very Slow Transactions for the business transaction.</p></li></ol><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If the /Supercar-Trader/car.do BT does not have any Very Slow Transactions, find a Business Transaction which has some and click in the number under that column. The screenshots may look slightly different moving forward but the concepts remain the same.</p></div></details><pre><code>![Very Slow Transaction](images/very-slow-transaction.png)
</code></pre><ol start=5><li><p>You should see the list of very slow transaction snapshots. Double-click on the snapshot that has the highest response time as seen below.</p><p><a href=#R-image-fbf9b7e516218a888a56d81220b2c5c1 class=lightbox-link><img alt="snapshot list" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/snapshot.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fbf9b7e516218a888a56d81220b2c5c1><img alt="snapshot list" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/snapshot.png></a></p><p>When the transaction snapshot viewer opens, we see the flow map view of all the components that were part of this specific transaction. This snapshot shows the transaction traversed through the components below in order.</p><ul><li>The Web-Portal Tier.</li><li>The Api-Services Tier.</li><li>The Enquiry-Services Tier.</li><li>The MySQL Database.</li></ul><p>The Potential Issues panel on the left highlights slow methods and slow remote services. While we can use the Potential Issues panel to drill straight into the call graph, we will use the Flow Map within the snapshot to follow the complete transaction in this example.</p></li><li><p>Click on Drill Down on the Web-Portal Tier shown on the Flow Map of the snapshot.</p><p><a href=#R-image-6a88dcccde127929796923b5afde1d7e class=lightbox-link><img alt="Web Portal Drilldown" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/webportal-drilldown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6a88dcccde127929796923b5afde1d7e><img alt="Web Portal Drilldown" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/webportal-drilldown.png></a></p><p>The tab that opens shows the call graph of the Web-Portal Tier. We can see that most of the time was from an outbound HTTP call.</p></li><li><p>Click on the block to drill down to the segment where the issue happening. Click the HTTP link to the details of the downstream call.</p><p><a href=#R-image-df89c29354318c78f0ffa0f635c2f7a0 class=lightbox-link><img alt="Call Graph" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/callgraph.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-df89c29354318c78f0ffa0f635c2f7a0><img alt="Call Graph" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/callgraph.png></a></p><p>The detail panel for the downstream call shows that the Web-Portal Tier made an outbound HTTP call to the Api-Services Tier. Follow the HTTP call into the Api-Services Tier.</p></li><li><p>Click Drill Down into Downstream Call.</p><p><a href=#R-image-3b7126e4a9e6e2b192b0fe4703914d8b class=lightbox-link><img alt="Call Graph Downstream" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/callgraph_downstream.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b7126e4a9e6e2b192b0fe4703914d8b><img alt="Call Graph Downstream" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/callgraph_downstream.png></a></p><p>The next tab that opens shows the call graph of the Api-Services Tier. We can see that 100% of the time was due to an outbound HTTP call.</p></li><li><p>Click the HTTP link to open the detail panel for the downstream call.</p><p><a href=#R-image-aef66bbf4c69cb70e532e475885e86fd class=lightbox-link><img alt="Downstream Call Graph" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/downstream_callgraph.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aef66bbf4c69cb70e532e475885e86fd><img alt="Downstream Call Graph" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/downstream_callgraph.png></a></p><p>The detail panel for the downstream call shows that the Api-Services Tier made an outbound HTTP call to the Enquiry-Services Tier. Follow the HTTP call into the Enquiry-Services Tier.</p></li><li><p>Click Drill Down into Downstream Call.</p><p><a href=#R-image-0bc7d77be071754ec0358bbe5c261fd3 class=lightbox-link><img alt="API service downstream" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/apiservices-downstream.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0bc7d77be071754ec0358bbe5c261fd3><img alt="API service downstream" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/apiservices-downstream.png></a></p><p>The next tab that opens shows the call graph of the Enquiry-Services Tier. We can see that there were JDBC calls to the database that caused issues with the transaction.</p></li><li><p>Click the JDBC link with the largest time to open the detail panel for the JDBC calls.</p><p><a href=#R-image-9893fd7e1a2d9f172e30d9efb66f977c class=lightbox-link><img alt="JDBC Callgraph" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/jdbc-callgraph.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9893fd7e1a2d9f172e30d9efb66f977c><img alt="JDBC Callgraph" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/jdbc-callgraph.png></a></p><p>The detail panel for the JDBC exit calls shows the specific query that took most of the time. We can see the full SQL statement along with the SQL parameter values.</p><p><a href=#R-image-21eda0d9234a2289ec036fe659b2605c class=lightbox-link><img alt="DB Call Details" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/db-query-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-21eda0d9234a2289ec036fe659b2605c><img alt="DB Call Details" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/6-apm-part1/images/db-query-details.png></a></p></li></ol><h2 id=summary>Summary</h2><p>In this lab, we first used Business Transactions to identify a very slow transaction that required troubleshooting. We then examined the call graph to pinpoint the specific part of the code causing delays. Following that, we drilled down into downstream services and the database to further analyze the root cause of the slowness. Finally, we successfully identified the exact inefficient SQL query responsible for the performance issue. This comprehensive approach demonstrates how AppDynamics helps in isolating and resolving transaction bottlenecks effectively.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=7-troubleshooting-errors--exceptions>7. Troubleshooting Errors & Exceptions</h1><p>In this exercise, you will learn how to effectively detect and diagnose errors within your application to identify their root causes. Additionally, you will explore how to pinpoint specific nodes that may be underperforming or experiencing errors, and apply troubleshooting techniques to resolve these performance issues. This hands-on experience will enhance your ability to maintain application health and ensure optimal performance.</p><h2 id=find-specific-errors-within-your-application>Find Specific Errors Within Your Application</h2><p>AppDynamics makes it easy to find errors and exceptions within your application. You can use the <strong>Errors</strong> dashboard to see transactions snapshots with errors and find the exceptions that are occurring most often. Identifying errors quickly helps prioritize fixes that improve application stability and user experience. Understanding the types and frequency of exceptions allows you to focus on the most impactful issues.</p><ol><li><p>Click on the <strong>Troubleshoot</strong> option on the left menu.</p></li><li><p>Click on the <strong>Errors</strong> option on the left menu. This navigates you to the Errors dashboard where you can quickly identify business transactions with errors</p></li><li><p>Explore a few of the error transaction snapshots. Reviewing snapshots helps you see the exact context and flow when errors occurred.</p></li><li><p>Click on the <strong>Exceptions</strong> tab to see exceptions grouped by type. Grouping by exception type helps identify recurring problems and patterns.</p><p><a href=#R-image-c19ae328d26766ee60ce4146b8f7792a class=lightbox-link><img alt="Errors Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/errors-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c19ae328d26766ee60ce4146b8f7792a><img alt="Errors Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/errors-dashboard.png></a></p><p>The <strong>Exceptions</strong> tab shows you what types of exceptions are occurring the most within the application so you can prioritize remediating the ones having the most impact.</p></li><li><p>Observe the <strong>Exceptions per minute</strong> and <strong>Exception count</strong> (6) to understand error frequency. High frequency exceptions often indicate critical issues needing immediate attention.</p></li><li><p>Note the <strong>Tier</strong> where exceptions occur to localize the problem within your application architecture. Knowing the affected tier helps narrow down the root cause.</p></li><li><p>Double-click on the MySQLIntegrityConstraintViolationException type to drill deeper.</p><p><a href=#R-image-f40804d638bc1592107f084edb9de654 class=lightbox-link><img alt="Exception Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/exception-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f40804d638bc1592107f084edb9de654><img alt="Exception Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/exception-dashboard.png></a></p></li><li><p>Review the overview dashboard showing snapshots that experienced this exception type.</p></li><li><p>The tab labeled <strong>Stack Traces for this Exception</strong> shows you an aggregated list of the unique stack traces generated by this exception type. Stack traces provide the exact code paths causing the error, essential for debugging.</p></li><li><p>Double-click a snapshot to open it and see the error in context.
This shows the transaction flow and pinpoints where the error happened.</p><p><a href=#R-image-ec868b7b74b4239048dc3fd0f1f1e7eb class=lightbox-link><img alt="MySQL Exception" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/MySQL-exception.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ec868b7b74b4239048dc3fd0f1f1e7eb><img alt="MySQL Exception" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/MySQL-exception.png></a></p><p>When you open an error snapshot from the exceptions screen, the snapshot opens to the specific segment within the snapshot where the error occurred.</p></li><li><p>Notice exit calls in red text indicating errors or exceptions.</p></li><li><p>Drill into the exit call to view detailed error information.</p></li><li><p>Click <strong>Error Details</strong> to see the full stack trace. Full stack traces are critical for developers to trace and fix bugs.</p></li></ol><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you want to learn more about error handling and exceptions, refer to the official AppDynamics documentation in the following link: <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/troubleshooting-applications/errors-and-exceptions rel=external>here</a>.</p></div></details><p><a href=#R-image-81c623ff6daa1bf184e4cd9185471721 class=lightbox-link><img alt="Call Graph Error" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/callgraph-error.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-81c623ff6daa1bf184e4cd9185471721><img alt="Call Graph Error" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/callgraph-error.png></a></p><h2 id=troubleshoot-node-issues>Troubleshoot Node Issues</h2><p>Node health directly impacts application performance and availability. Early detection of node issues prevents outages and ensures smooth operation. AppDynamics provides visual indicators throughout the UI, making it easy to quickly identify issues.</p><p>You can see indicators of Node issues in three areas on the Application Dashboard.</p><ol><li><p>Observe the <strong>Application Dashboard</strong> for visual indicators of node problems. Color changes and icons provide immediate alerts to issues</p></li><li><p>The <strong>Events</strong> panel shows Health Rule Violations, including those related to Node Health.</p></li><li><p>The <strong>Node Health</strong> panel tells you how many critical or warning issues are occurring for Nodes. Click on the Node Health link in the <strong>Node Health</strong> panel to drill into the <strong>Tiers & Nodes dashboard</strong>.</p><p><a href=#R-image-94bdfb8e46aef452cd888f5119086a73 class=lightbox-link><img alt="Application Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/application-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-94bdfb8e46aef452cd888f5119086a73><img alt="Application Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/application-dashboard.png></a></p></li><li><p>Alternatevely, you can click <strong>Tiers & Nodes</strong> on the left menu to reach the <strong>Tiers & Nodes dashboard</strong></p></li><li><p>Switch to Grid View for an organized list of nodes. Grid view makes it easier to scan and find nodes with warnings.</p></li><li><p>Click on the warning icon for the Insurance-Services_Node-01 Node.</p><p><a href=#R-image-0e5cae47349ea467ed71a8dc3b082091 class=lightbox-link><img alt="Tiers and Nodes List" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/tiers-nodes-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0e5cae47349ea467ed71a8dc3b082091><img alt="Tiers and Nodes List" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/tiers-nodes-list.png></a></p></li><li><p>Review the Health Rule Violations summary and click on violation descriptions.</p></li><li><p>Click on the <strong>Details</strong> button to see the details.</p><p><a href=#R-image-99ca3216f878d6f3ff61d6d6edbae780 class=lightbox-link><img alt="Health Rule Violation" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/health-rule-violations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-99ca3216f878d6f3ff61d6d6edbae780><img alt="Health Rule Violation" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/health-rule-violations.png></a></p><p>The <strong>Health Rule Violation</strong> details viewer shows you:</p></li><li><p>The current state of the violation.</p></li><li><p>The timeline of when the violation was occurring.</p></li><li><p>The specifics of what the violation is and the conditions that triggered it.</p></li><li><p>Click on the <strong>View Dashboard During Health Rule Violation</strong> to see node metrics at the time of the issue. Correlating violations with performance metrics aids diagnosis.</p><p><a href=#R-image-aa5da7cce0c89ecdec914bd8ecf9a7b3 class=lightbox-link><img alt="Health Rule Violation Details" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/health-rule-violation-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aa5da7cce0c89ecdec914bd8ecf9a7b3><img alt="Health Rule Violation Details" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/health-rule-violation-details.png></a></p><p>When you click on the <strong>View Dashboard During Health Rule Violation</strong> button, it opens the <strong>Server</strong> tab of the Node dashboard by default.</p><p>If you havenâ€™t installed the AppDynamics Server Visibility Monitoring agent yet then you wonâ€™t see the resource metrics for the host of the Node. You will be able to see those metrics in the next lab. The AppDynamics Java agent collects memory metrics from the JVM via JMX.</p><p>Investigate the JVM heap data using the steps below.</p></li><li><p>Click on the <strong>Memory</strong> tab.</p></li><li><p>Look at the current heap utilization.</p></li><li><p>Notice the Major Garbage Collections that have been occurring.</p></li></ol><p>Note: If you have an issue seeing the Memory screen, try using an alternate browser (Firefox should render correctly for Windows, Linux, and Mac).</p><pre><code>![Memory Dashboard](images/memory-dashboard.png)  
</code></pre><ol start=16><li>Use the outer scroll bar to scroll to the bottom of the screen.</li><li>Note high <strong>PS Old Gen</strong> memory usage as a potential sign of memory leaks or inefficient garbage collection. Identifying memory pressure early can prevent outages.</li></ol><p>You can read more about Node and JVM monitoring <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/tiers-and-nodes/troubleshoot-node-problems rel=external>here</a> and <a href=https://help.splunk.com/en/appdynamics-saas/application-performance-monitoring/25.7.0/tiers-and-nodes/monitor-jvms rel=external>here</a>.</p><p><a href=#R-image-06b75405e608dc26d24c858cadaa652f class=lightbox-link><img alt="PS Old Gen" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/ps-old-gen.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-06b75405e608dc26d24c858cadaa652f><img alt="PS Old Gen" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/1-application-performance-monitoring/7-apm-part2/images/ps-old-gen.png></a></p><h2 id=summary>Summary</h2><p>In this lab, you learned how to effectively use AppDynamics to identify and troubleshoot application errors and node health issues. You started by locating specific errors and exceptions using the Errors dashboard, understanding their frequency, types, and impact on your application. You drilled down into error snapshots and stack traces to pinpoint the root cause of failures.</p><p>Next, you explored node health monitoring by interpreting visual indicators on the Application Dashboard and investigating Health Rule Violations. You learned to analyze JVM memory metrics to detect potential performance bottlenecks related to garbage collection and heap usage.</p><p>Together, these skills enable proactive monitoring and rapid troubleshooting to maintain application performance and reliability.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=server-visibility-monitoring>Server Visibility Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Prerequsites</summary><div class=box-content><p>This is a continuation of the Application Performance Monitoring lab. Verify that your application is running and has load for the past hour. If needed return to the Generate Application Load section to restart the load generator.</p></div></details><h2 id=objectives>Objectives</h2><p>In this Lab you will learn about AppDynamics Server Visibility Monitoring and Service Availability Monitoring.</p><p>When you have completed this lab, you will be able to:</p><ul><li>Download the AppDynamics Server Visibility Agent.</li><li>Install the AppDynamics Server Visibility Agent.</li><li>Monitor server health.</li><li>Understand the agentâ€™s extended hardware metrics.</li><li>Quickly see underlying infrastructure issues impacting your application performance.</li></ul><h2 id=workshop-environment>Workshop Environment</h2><p>The lab environment has two hosts:</p><ul><li>The first host runs the AppDynamics Controller and will be referred to from this point on as the Controller.</li><li>The second host runs the Supercar Trader application used in the labs. It will be the host where you will install the AppDynamics agents and will be referred to from this point on as the Application VM.</li></ul><h2 id=controller>Controller</h2><p>You will be using the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> for this workshop.</p><p><a href=#R-image-dab76d416cb5ef35fc15c185d1d056ec class=lightbox-link><img alt=Controller class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dab76d416cb5ef35fc15c185d1d056ec><img alt=Controller class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/images/controller-vm.png></a></p><h2 id=application-vm>Application VM</h2><p>Supercar Trader is a Java-based Web Application</p><p>The purpose of Supercar-Trader collection is to generate dynamic traffic (business transactions) for AppDynamics Controller.</p><p><a href=#R-image-d5bb02bd96f45eb2c5cdf0ebf9c7fe9d class=lightbox-link><img alt="Application VM" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/images/application-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d5bb02bd96f45eb2c5cdf0ebf9c7fe9d><img alt="Application VM" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/images/application-vm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Server Visibility Monitoring</h1><article class=default><header class=headline></header><h1 id=deploy-machine-agent>Deploy Machine Agent</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>In this exercise you will perform the following actions:</p><ol><li>Run a script that will install the Machine agent</li><li>Configure the Machine agent</li><li>Start the Machine agent</li></ol><details open class="box cstyle notices orange"><summary class=box-label tabindex=-1>Note</summary><div class=box-content><p>We will use a script to download the machine agent into your EC2 instance. Normally, you would have to download the machine agent by logging into <a href=https://accounts.appdynamics.com/ rel=external>https://accounts.appdynamics.com/</a> but due to potential access limitations we will use the script which downloads it directly from the portal. If you have access to the AppDynamics portal and would like to download the machine agent, you can follow the below steps to download it and reference the steps used in the Install Agent section of the APM lab to SCP it into your VM.</p><ol><li>Log into the <a href=https://accounts.appdynamics.com/ rel=external>AppDynamics Portal</a></li><li>On the left side menu click on <strong>Downloads</strong></li><li>Under <strong>Type</strong> select <strong>Machine Agent</strong></li><li>Under <strong>Operating System</strong> Select <strong>Linux</strong></li><li>Find the <strong>Machine Agent Bundle - 64-bit linux (zip)</strong> and click on the <strong>Download</strong> button.</li><li>Follow the steps in the Install Agent section to SCP the downloaded file into your EC2 instance.</li><li>Unbundle the zip file into the /opt/appdynamics/machineagent directory and proceed to the configuration section of this lab</li></ol></div></details><h2 id=run-the-install-script>Run the Install Script</h2><p>Use the command below to change to the directrory where the script is located. The script will downlaod and unbundle the machine agent</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/machineagent/</span></span></code></pre></div><p>Use the command below to run the install script.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x install_machineagent.sh
</span></span><span class=line><span class=cl>./install_machineagent.sh</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-9cd02cbdc6ba724b2a9690d0d6fe8522 class=lightbox-link><img alt="Install Output" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/install-script-output.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9cd02cbdc6ba724b2a9690d0d6fe8522><img alt="Install Output" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/install-script-output.png></a></p><h2 id=configure-the-server-agent>Configure the Server Agent</h2><p>Obtain the configuration property values listed below from the Java Agents â€œcontroller-info.xmlâ€ and have them available for the next step.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /opt/appdynamics/javaagent/conf/controller-info.xml</span></span></code></pre></div><ul><li>controller-host</li><li>controller-port</li><li>controller-ssl-enabled</li><li>account-name</li><li>account-access-key</li></ul><p>Edit the â€œcontroller-info.xmlâ€ file of the machine Agent and insert the values for the properties you obtained from the Java Agent configuration file, listed below.</p><ul><li>controller-host</li><li>controller-port</li><li>controller-ssl-enabled</li><li>account-name</li><li>account-access-key</li></ul><p>You will need to set the â€œsim-enabledâ€ property to true and then save the file which should look similar to the image below.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/machineagent/conf
</span></span><span class=line><span class=cl>nano controller-info.xml</span></span></code></pre></div><p><a href=#R-image-a2c5539a0d5c39b52d448b78ceb50003 class=lightbox-link><img alt="Example Config" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/controller-example.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a2c5539a0d5c39b52d448b78ceb50003><img alt="Example Config" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/controller-example.png></a></p><h2 id=start-the-server-visibility-agent>Start the Server Visibility agent</h2><p>Use the following commands to start the Server Visibility agent and verify that it started.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/machineagent/bin
</span></span><span class=line><span class=cl>nohup ./machine-agent <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>ps -ef <span class=p>|</span> grep machine</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-f5122777535acb986cde7a0890d15212 class=lightbox-link><img alt="Example Output" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/run-machine-agent.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f5122777535acb986cde7a0890d15212><img alt="Example Output" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/3-deploy-server-agent/images/run-machine-agent.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-server-health>Monitor Server Health</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Review the Server Main dashboard</li><li>Review the Server Processes dashboard</li><li>Review the Server Volumes dashboard</li><li>Review the Server Network dashboard</li><li>Navigate between Server and Application contexts</li></ul><h2 id=review-the-server-main-dashboard>Review the Server Main Dashboard</h2><p>Now that you have the Machine agent installed, letâ€™s take a look at some of the features available in the Server Visibility module. From your <strong>Application Dashboard</strong>, click on the <strong>Servers</strong> tab and drill into the servers main dashboard by following these steps.</p><ol><li>Click the <strong>Servers</strong> tab on the left menu.</li><li>Check the <strong>checkbox</strong> on the left for your server.</li><li>Click <strong>View Details</strong>.</li></ol><p><a href=#R-image-6e53eb1fb812398e6b6dac76c4d13c10 class=lightbox-link><img alt="Server Dashboard" class="lazy lightbox figure-image" loading=lazy src=images/svm-viewDetails.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e53eb1fb812398e6b6dac76c4d13c10><img alt="Server Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=images/svm-viewDetails.png></a></p><p>You can now explore the server dashboard. This dashboard enables you to perform the following tasks:</p><p>See charts of key performance metrics for the selected monitored servers, including:</p><ul><li>Server availability</li><li>CPU, memory, and network usage percentages</li><li>Server properties</li><li>Disk, partition, and volume metrics</li><li>Top 10 processes consuming CPU resources and memory.</li></ul><p>You can read more about the Server Main dashboard <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/server-visibility/monitor-your-servers-using-server-visibility/server-dashboard rel=external>here</a>.</p><p>Review the <strong>Top Pane</strong> of the dashboard which provides you the following information:</p><ul><li>Host Id: This is an ID for the server that is unique to the Splunk AppDynamics Controller</li><li>Health: Shows the overall health of the server.</li><li>Hierachy: Arbitrary hierarchy to group your severs together. See documentation for additional details <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/machine-agent/configure-the-machine-agent/machine-agent-configuration-properties rel=external>here</a></li></ul><ol><li>Click on the health server icon to view the <strong>Violations * Anomalies</strong> panel. Review the panel to identify potential issues</li><li>Click on the <strong>Current Health Rule Evaluation Status</strong> to see if there are any current issues being alerted on for this server</li></ol><p><a href=#R-image-714ac2d424f5c3ce0a9bdaf40b11ca40 class=lightbox-link><img alt="Server Health" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-health.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-714ac2d424f5c3ce0a9bdaf40b11ca40><img alt="Server Health" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-health.png></a>
<a href=#R-image-aad6074a97a9fc28b8c3ffeef059056b class=lightbox-link><img alt="Server violations" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-health-violations.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aad6074a97a9fc28b8c3ffeef059056b><img alt="Server violations" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-health-violations.png></a></p><ol start=3><li>Click on the <strong>CPU Usage too high</strong> rule</li><li>Click on <strong>Edit Health Rule</strong>. This will open the <strong>Edit Health Rule</strong> panel</li></ol><p><a href=#R-image-420298b4ae5ae2b3251349616a643980 class=lightbox-link><img alt="Edit Health Rule" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-edit-hr.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-420298b4ae5ae2b3251349616a643980><img alt="Edit Health Rule" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-edit-hr.png></a></p><p>This panel gives us the ability to configure the Health Rule. A different lab will go into more details on creating and customizing health rules. For now we will just review the existing rule</p><ol start=5><li>Click on the <strong>Warning Criteria</strong></li></ol><p><a href=#R-image-3830c1c12024b4ae187a91c6d4396b89 class=lightbox-link><img alt="Edit Health Rule - Warning" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-warning.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3830c1c12024b4ae187a91c6d4396b89><img alt="Edit Health Rule - Warning" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-warning.png></a></p><p>In this example we can see that the warning criteria is set when the CPU is above 5%. This is the reason why our health rule is showing a warning and not a healthy state. Cancel out of the <strong>Edit Health Rule</strong> panel to get back to the <strong>Server Dashboard</strong></p><h2 id=review-the-server-processes-dashboard>Review the Server Processes Dashboard</h2><ol><li>Click the <strong>Processes</strong> tab.</li><li>Click <strong>View Options</strong> to select different data columns. Review the KPIs available to view</li></ol><p>You can now explore the server processes dashboard. This dashboard enables you to perform the following tasks:</p><ul><li>View all the processes active during the selected time period. The processes are grouped by class as specified in the ServerMonitoring.yml file.</li><li>View the full command line that started this process by hovering over the process entry in the Command Line column.</li><li>Expand a process class to see the processes associated with that class.</li><li>Use View Options to configure which columns to display in the chart.</li><li>Change the time period of the metrics displayed.</li><li>Sort the chart using the columns as a sorting key. You can not sort on sparkline charts: CPU Trend and Memory Trend.</li><li>See CPU and Memory usage trends at a glance.</li></ul><p>You can read more about the Server Processes dashboard <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/server-visibility/monitor-your-servers-using-server-visibility/server-process-metrics rel=external>here</a>.</p><p><a href=#R-image-4273724018faeeec3dbfb420d9c5c00e class=lightbox-link><img alt="Dashboard Processes" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-process-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4273724018faeeec3dbfb420d9c5c00e><img alt="Dashboard Processes" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-process-dashboard.png></a></p><h2 id=review-the-server-volumes-dashboard>Review the Server Volumes Dashboard</h2><ol><li>Click the <strong>Volumes</strong> tab.</li></ol><p>You can now explore the server volumes dashboard. This dashboard enables you to perform the following tasks:</p><ul><li>See the list of volumes, the percentage used and total storage space available on the disk, partition or volume.</li><li>See disk usage and I/O utilization, rate, operations per second, and wait time.</li><li>Change the time period of the metrics collected and displayed.</li><li>Click on any point on a chart to see the metric value for that time.</li></ul><p>You can read more about the Server Volumes dashboard <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/server-visibility/monitor-your-servers-using-server-visibility/server-volumes-metrics rel=external>here</a>.</p><p><a href=#R-image-0c47df2a5ea208cf782decd876c6c7ec class=lightbox-link><img alt="Dashboard Example" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-volumes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0c47df2a5ea208cf782decd876c6c7ec><img alt="Dashboard Example" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-volumes.png></a></p><h2 id=review-the-server-network-dashboard>Review the Server Network Dashboard</h2><ol><li>Click the Network tab.</li></ol><p>You can now explore the <strong>Server Network</strong> dashboard. This dashboard enables you to perform the following tasks:</p><ul><li>See the MAC, IPv4, and IPv6 address for each network interface.</li><li>See whether or not the network interface is enabled, functional, its operational state equipped with an ethernet cable that is plugged in, operating in full or half-full duplex mode, maximum transmission unit (MTU) or size (in bytes) of the largest protocol data unit that the network interface can pass, speed of the ethernet connection in Mbit/sec.</li><li>View network throughput in kilobytes/sec and packet traffic.</li><li>Change the time period of the metrics displayed.</li><li>Hover over on any point on a chart to see the metric value for that time.</li></ul><p>You can read more about the Server Network dashboard <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/server-visibility/monitor-your-servers-using-server-visibility/server-network-metrics rel=external>here</a>.</p><p><a href=#R-image-b41d3852388a2f137af223df8a9d0480 class=lightbox-link><img alt="Network Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-network.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b41d3852388a2f137af223df8a9d0480><img alt="Network Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/4-monitor-server-health/images/server-network.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=correlate-between-server-and-apm>Correlate Between Server and APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<h2 id=navigate-between-server-and-application-contexts>Navigate between Server and Application Contexts</h2><p>The Server Visibility Monitoring agent automatically associates itself with any Splunk AppDynamics APM agents running on the same host.</p><p>With Server Visibility enabled, you can access server performance metrics in the context of your applications. You can switch between server and application contexts in different ways. Follow these steps to navigate from the server main dashboard to one of the Nodes running on the server.</p><ol><li>Click the <strong>Dashboard</strong> tab to return to the main Server Dashboard.</li><li>Click the <strong>APM Correlation</strong> link.</li></ol><p><a href=#R-image-5d54709a28c1d74046a15c2dbac5ef3e class=lightbox-link><img alt="Server to APM" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-apm-link.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5d54709a28c1d74046a15c2dbac5ef3e><img alt="Server to APM" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-apm-link.png></a></p><ol start=2><li>Click the down arrow on one of the listed Tiers.</li><li>Click the Node of the Tier link.</li></ol><p><a href=#R-image-e54f7dc1b48884e3ec2faf08b6fd6192 class=lightbox-link><img alt="Dashboard Example" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-tier-link.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e54f7dc1b48884e3ec2faf08b6fd6192><img alt="Dashboard Example" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-tier-link.png></a></p><p>You are now on the <strong>Node Dashboard</strong>.</p><ol start=4><li>Click the <strong>Server</strong> tab to see the related host metrics</li></ol><p><a href=#R-image-3f676dee4744131da31d14d19992c52a class=lightbox-link><img alt="Dashboard Example" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-node-server.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f676dee4744131da31d14d19992c52a><img alt="Dashboard Example" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/2-server-visibility-monitoring/5-apm-to-server/images/server-node-server.png></a></p><p>When you have the Server Visibility Monitoring agent installed, the host metrics are always available within the context of the related Node.</p><p>You can read more about navigating between Server and Application Contexts <a href=https://help.splunk.com/en/appdynamics-saas/infrastructure-visibility/25.7.0/server-visibility/monitor-your-servers-using-server-visibility/navigating-between-server-and-application-contexts rel=external>here</a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=business-iq>Business iQ</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=objectives>Objectives</h2><p>In this Learning Lab you learn about AppDynamics Business iQ.</p><p>When you have completed this lab, you will be able to:</p><ul><li>Enable analytics with the new Agentless Analytics Java Agent (v 4.5.15 +).</li><li>Configure HTTP data collectors.</li><li>Configure method invocation data collectors.</li><li>Understand dashboard components.</li><li>Build a business dashboard.</li></ul><h2 id=workshop-environment>Workshop Environment</h2><p>The lab environment has two hosts:</p><ul><li>The first host runs the AppDynamics Controller and will be referred to from this point on as the Controller.</li><li>The second host runs the Supercar Trader application used in the labs. It will be the host where you will install the AppDynamics agents and will be referred to from this point on as the Application VM.</li></ul><h4 id=controller-vm>Controller VM</h4><p><a href=#R-image-c69f25c31912cdb366dfcd1283e6ad8b class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c69f25c31912cdb366dfcd1283e6ad8b><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/images/controller-vm.png></a></p><h4 id=application-vm>Application VM</h4><p><a href=#R-image-001a2b64a682e8e5af5c8261d1d7e693 class=lightbox-link><img alt=image class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/images/application-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-001a2b64a682e8e5af5c8261d1d7e693><img alt=image class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/images/application-vm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Business iQ</h1><article class=default><header class=headline></header><h1 id=lab-prerequisite>Lab Prerequisite</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Access your AppDynamics Controller from your web browser.</li><li>Verify transaction load to the application.</li><li>Restart the application and transaction load if needed.</li></ul><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=verify-transaction-load-to-the-application>Verify transaction load to the application</h2><p>Check the application flow map:</p><ol><li>Select the <strong>last 1 hour</strong> time frame.</li><li>Verify you see the five different Tiers on the flow map.</li><li>Verify there has been consistent load over the last 1 hour.</li></ol><p><a href=#R-image-990cbe10dd414fba106f468ca10c07a8 class=lightbox-link><img alt="Verify Load 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereque-appload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-990cbe10dd414fba106f468ca10c07a8><img alt="Verify Load 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereque-appload.png></a></p><p>Check the list of business transactions:</p><ol start=4><li>Click the <strong>Business Transactions</strong> option on the left menu.</li><li>Verify you see the eleven business transactions seen below.</li><li>Verify that they have some number of calls during the last hour.</li></ol><p><strong>Note:</strong> If you donâ€™t see the <strong>Calls</strong> column, you can click the <strong>View Options</strong> toolbar button to show that column.</p><p><a href=#R-image-e4585d95f5f18dd154ed8c3f01cfa328 class=lightbox-link><img alt="Verify Business transactions" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereq-bts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e4585d95f5f18dd154ed8c3f01cfa328><img alt="Verify Business transactions" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereq-bts.png></a></p><p>Check the agent status for the Nodes:</p><ol start=7><li>Click the <strong>Tiers & Nodes</strong> option on the left menu.</li><li>Click <strong>Grid View</strong>.</li><li>Verify that the <strong>App Agent Status</strong> for each Node is greater than 90% during the last hour.</li></ol><p><a href=#R-image-5ee0901d3e3d1c29ed851cea4e53e91c class=lightbox-link><img alt="Verify Agents" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereq-tiersnodes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5ee0901d3e3d1c29ed851cea4e53e91c><img alt="Verify Agents" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/01-prereq-tiersnodes.png></a></p><h2 id=restart-the-application-and-load-generation-if-needed>Restart the Application and Load Generation if Needed</h2><p>If any of the checks you performed in the previous steps could not be verified, SSH into your <strong>Application VM</strong> and follow these steps to restart the application and transaction load.</p><p>Use the following commands to stop the running instance of Apache Tomcat.<div class=tab-panel data-tab-group=R-tabs-20d43b96db7149dc399925709dd94a50><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bf095d041fc3064b9b317632f30b6ab5 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-20d43b96db7149dc399925709dd94a50","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-bf095d041fc3064b9b317632f30b6ab5 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./shutdown.sh</span></span></code></pre></div></div></div></div></div></p><p>Use the command below to check for remaining application JVMs still running.</p><div class=tab-panel data-tab-group=R-tabs-3d071d9a055a23f1b1a804741208cdb5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-af82ca388888ae6bf18430481d65f749 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-3d071d9a055a23f1b1a804741208cdb5","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-af82ca388888ae6bf18430481d65f749 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps -ef <span class=p>|</span> grep Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>If you find any remaining application JVMs still running, kill the remaining JVMs using the command below.</p><div class=tab-panel data-tab-group=R-tabs-84744553fd6def17a84670dd1167684c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8358b9ff9d2752d69a1e264dfa2b9086 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-84744553fd6def17a84670dd1167684c","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-8358b9ff9d2752d69a1e264dfa2b9086 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pkill -f Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>Use the following commands to stop the load generation for the application. Wait until all processes are stopped.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./stop_load.sh</span></span></code></pre></div><p>Restart the Tomcat server:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./startup.sh</span></span></code></pre></div><p>Wait for two minutes and use the following command to ensure Apache Tomcat is running on port 8080.</p><div class=tab-panel data-tab-group=R-tabs-8fc6a309a7c41db52724247b7784d404><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d69b50036e1f855afb75dc773816bfd9 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-8fc6a309a7c41db52724247b7784d404","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-33a989b43184c6223d612d0c6499d202 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-8fc6a309a7c41db52724247b7784d404","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-d69b50036e1f855afb75dc773816bfd9 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:8080</span></span></code></pre></div></div></div><div id=R-tab-id-33a989b43184c6223d612d0c6499d202 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;head&gt;
</span></span><span class=line><span class=cl>        &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;title&gt;Apache Tomcat/9.0.50&lt;/title&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;favicon.ico&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;image/x-icon&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;tomcat.css&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> /&gt;
</span></span><span class=line><span class=cl>    &lt;/head&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;body&gt;
</span></span><span class=line><span class=cl>        &lt;div <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;wrapper&#34;</span>
</span></span><span class=line><span class=cl>....</span></span></code></pre></div></div></div></div></div><p>Use the following commands to start the load generation for the application.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./start_load.sh</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-55d2ea9dd01d3a3cda5e6deee93448f6 class=lightbox-link><img alt="Restart App 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/restart-app-and-load-03.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-55d2ea9dd01d3a3cda5e6deee93448f6><img alt="Restart App 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/1-lab-prerequisites/images/restart-app-and-load-03.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=enable-analytics-on-the-application>Enable Analytics on the Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>Analytics formerly required a separate agent that was bundled with Machine Agent. However, Analytics is now agentless and embedded in the APM Agent for both .NET Agent >= 20.10 and Java Agent >= 4.5.15 on Controllers >= 4.5.16</p><p>In this exercise you will access your AppDynamics Controller from your web browser and enable the Agentless Analytics from there.</p><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=navigate-to-the-analytics-configuration>Navigate to the Analytics Configuration</h2><ol><li>** Select the <strong>Analytics</strong> tab at the top left of the screen.</li><li>** Select the <strong>Configuration</strong> Left tab.</li><li>** Select the <strong>Transaction Analytics - Configuration</strong> tab.</li><li>** <strong>Mark the Checkbox</strong> next to Your Application <strong>Supercat-Trader-YOURINITIALS</strong></li><li>** Click the <strong>Save</strong> button</li></ol><p><a href=#R-image-da58d3b03e1a0919cfdb240bb276e270 class=lightbox-link><img alt="Enable Analytics" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/2-enable-analytics/images/05-biq-transaction-analytics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-da58d3b03e1a0919cfdb240bb276e270><img alt="Enable Analytics" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/2-enable-analytics/images/05-biq-transaction-analytics.png></a></p><h2 id=validate-transaction-summary>Validate Transaction Summary</h2><p>You want to verify that Analytics is working for that application and showing transactions.</p><ol><li>Select the <strong>Analytics tab</strong> tab on the left menu.</li><li>Select the <strong>Home</strong> tab.</li><li>Under <strong>Transactions from</strong> filter to your application <strong>Supercar-Trader-YOURINITIALS</strong></li></ol><p><a href=#R-image-32435439572a68cb4ddb59c15a1b0512 class=lightbox-link><img alt="Validate Analytics" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/2-enable-analytics/images/05-biq-transaction-analytics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-32435439572a68cb4ddb59c15a1b0512><img alt="Validate Analytics" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/2-enable-analytics/images/05-biq-transaction-analytics.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-http-data-collectors>Configure HTTP Data Collectors</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>Data collectors enable you to supplement business transaction and transaction analytics data with application data. The application data can add context to business transaction performance issues. For example, they show the values of particular parameters or return value for business transactions affected by performance issues, such as the specific user, order, or product.</p><p>HTTP data collectors capture the URLs, parameter values, headers, and cookies of HTTP messages that are exchanged in a business transaction.</p><p>In this exercise you will perform the following tasks:</p><ul><li>Enable all HTTP data collectors.</li><li>Observe and Select relevant HTTP data collectors.</li><li>Capture Business Data in Analytics using HTTP Params.</li><li>Validate Analytics on HTTP Parameters.</li></ul><h2 id=enable-all-http-data-collectors>Enable all HTTP data collectors</h2><p>Initially, you can capture all HTTP data collectors to learn which useful parameters you can capture into Analytics and use it in your Dashboards</p><details open class="box cstyle notices orange"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>It is strongly recommended that you perform this step on a UAT environment, not production.</p></div></details><ol><li>Select the <strong>Applications</strong> tab at the top left of the screen.</li><li>Select the <strong>Supercar-Trader-YOURINITIALS</strong> Application.</li><li>Select the <strong>Configuration</strong> Left tab.</li><li>Click on the <strong>Instrumentation</strong> Link.</li><li>Select the <strong>Data Collectors</strong> tab.</li><li>Click on the <strong>Add</strong> Button in the <strong>HTTP Request Data Collectors</strong></li></ol><p><a href=#R-image-eddb25149ce0a90aed20def8c9e553b9 class=lightbox-link><img alt="HTTPDataCollectors 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-datacollectors.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-eddb25149ce0a90aed20def8c9e553b9><img alt="HTTPDataCollectors 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-datacollectors.png></a></p><p>You will now configure an HTTP data collector to capture all HTTP Parameters. You will only enable it on Transaction Snapshots to avoid any overheads until you identify the precise parameters that you need for Transaction Analytics</p><ol><li>For the <strong>Name</strong>, specify <strong>All HTTP Param</strong>.</li><li>Under <strong>Enable Data Collector for</strong> check the box for <strong>Transaction Snapshots</strong>.</li><li><strong>Do not</strong> enable Transaction Analytics.</li><li>Click on <strong>+ Add</strong> in the HTTP Parameters section.</li><li>For the new Parameter, specify <strong>All</strong> as the Display Name</li><li>Then specify an asterisk <strong>*</strong> in the HTTP Parameter name.</li><li>Click <strong>Save</strong></li></ol><p><a href=#R-image-aae37379ab1629e73c437aa72844d74b class=lightbox-link><img alt="HTTPDataCollectors 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-http-collector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aae37379ab1629e73c437aa72844d74b><img alt="HTTPDataCollectors 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-http-collector.png></a></p><ol start=8><li>Click &ldquo;Ok&rdquo; to confirm the data collector.</li><li>Enable <strong>/Supercar-Trader/sell.do</strong> Transaction</li><li>Click <strong>Save</strong></li></ol><p><a href=#R-image-603572f481845bb7b875b060d6a7cb54 class=lightbox-link><img alt="HTTPDataCollectors 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-bt-enble.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-603572f481845bb7b875b060d6a7cb54><img alt="HTTPDataCollectors 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-bt-enble.png></a></p><h2 id=observe-and-select-relevant-http-data-collectors>Observe and Select Relevant HTTP Data Collectors</h2><ol><li>Apply load on the Application, specifically the <strong>SellCar</strong> transaction. Open one of its snapshots with Full Call Graph, and select the <strong>Data Collectors Tab</strong>.</li></ol><p>You can now see all HTTP Parameters. You will see a number of key metrics, such as Car Price, Color, Year, and more.</p><ol start=2><li>Note the exact Parameter names to add them again in the <strong>HTTP Parameters</strong> list and enable them in Transaction Analytics.</li><li>Once they are added, delete the <strong>All HTTP Param</strong> HTTP data collector.</li></ol><p><a href=#R-image-52ee33db5af08fcb6abe4950dbcc3a79 class=lightbox-link><img alt="HTTPDataCollectors 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-snapshot-collector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-52ee33db5af08fcb6abe4950dbcc3a79><img alt="HTTPDataCollectors 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-snapshot-collector.png></a></p><h2 id=capture-business-data-in-analytics-with-http-params>Capture Business Data in Analytics with HTTP Params</h2><p>You will now configure the HTTP data collector again, but this time you will capture only the useful HTTP Parameters and enable them in Transaction Analytics. Add a new HTTP Data Collector: Application -> Configuration -> Instrumentation -> Data Collector tab -> Click <strong>Add</strong> Under the <strong>HTTP Request Data Collectors</strong> section</p><ol><li>In the Name, specify <strong>CarDetails</strong>.</li><li>Enable <strong>Transaction Snapshots</strong>.</li><li>Enable <strong>Transaction Analytics</strong>.</li><li>Click <strong>+ Add</strong> in the HTTP Parameters section.</li><li>For the new Parameter, specify <strong>CarPrice_http</strong> as the Display Name</li><li>Then specify <strong>carPrice</strong> as the HTTP Parameter name.</li><li>Repeat for the rest of the Car Parameters as shown below.</li><li>Click <strong>Save</strong></li><li>Click <strong>Ok</strong> to acknowledge the Data Collector implementation</li></ol><p><a href=#R-image-7bc6e7ac3d948364af76c25ff33d739e class=lightbox-link><img alt=SaveHttpDataCollectors class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-httpcollector-cardetails.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7bc6e7ac3d948364af76c25ff33d739e><img alt=SaveHttpDataCollectors class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-httpcollector-cardetails.png></a>
<a href=#R-image-1493158224d40e8e9ce31d6ce839ff27 class=lightbox-link><img alt="Car Params" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-car-params.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1493158224d40e8e9ce31d6ce839ff27><img alt="Car Params" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-car-params.png></a></p><ol start=10><li>Enable <strong>/Supercar-Trader/sell.do</strong> Transaction</li><li>Click <strong>Save</strong></li></ol><p><a href=#R-image-1f0852bd7ee8eb39e6c21920017ee730 class=lightbox-link><img alt="HTTPDataCollectors 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-cardetails-bt.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1f0852bd7ee8eb39e6c21920017ee730><img alt="HTTPDataCollectors 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-cardetails-bt.png></a></p><ol start=12><li>Delete the <strong>All HTTP Param</strong> Collector by Clicking on it, then click <strong>Delete</strong> button.</li></ol><h2 id=validate-analytics-on-http-parameters>Validate Analytics on HTTP Parameters</h2><p>You will now validate whether the business data was captured by HTTP data collectors in AppDynamics Analytics.</p><ol><li>Select the <strong>Analytics</strong> tab at the top left of the screen.</li><li>Select the <strong>Searches</strong> tab</li><li>Click the <strong>+ Add</strong> button and create a new <strong>Drag and Drop Search</strong>.</li></ol><p><a href=#R-image-e93b1fad1fb8ac2974741b4879f2022c class=lightbox-link><img alt="Drag and Drop Search" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-search.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e93b1fad1fb8ac2974741b4879f2022c><img alt="Drag and Drop Search" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-search.png></a></p><ol start=4><li>Click <strong>+ Add Criteria</strong></li><li>Select <strong>Application</strong> and Search For Your Application Name <strong>Supercar-Trader-YOURINITIALS</strong></li><li>Under the <strong>Fields</strong> panel verify that the <strong>Business Parameters</strong> appear as a field in the Custom HTTP Request Data.</li><li>Check the box for <strong>CarPrice_http</strong> and Validate that the field has data.</li></ol><p><a href=#R-image-038115a1ee1d40a1b67a1667ec19a718 class=lightbox-link><img alt=ValidateHttpDataCollectors class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-search-validation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-038115a1ee1d40a1b67a1667ec19a718><img alt=ValidateHttpDataCollectors class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/3-configure-http-data-collectors/images/05-biq-search-validation.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-method-data-collectors>Configure Method Data Collectors</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>Method invocation data collectors capture code data such as method arguments, variables, and return values. If HTTP data collectors donâ€™t have sufficient business data, you can still capture these information from the code execution.</p><p>In this exercise you will perform the following tasks:</p><ul><li>Discover methods.</li><li>Open a discovery session.</li><li>Discover method parameters.</li><li>Drill down to an object within the code.</li><li>Create a method invocation data collector.</li><li>Validate analytics on method invocation data collectors.</li></ul><h2 id=open-a-discovery-session>Open a Discovery Session</h2><p>You may not have an application developer available to identify the method or parameters from the source code. However, there is an approach to discover the application methods and objects directly from AppDynamics.</p><ol><li>Select the <strong>Applications</strong> tab at the top left of the screen.</li><li>Select <strong>Supercar-Trader-YOURINITIALS</strong> application</li><li>Select the <strong>Configuration</strong> tab.</li><li>Click on the <strong>Instrumentation</strong> link.</li><li>Select the <strong>Transaction Detection</strong> tab.</li><li>Click on the <strong>Live Preview Button</strong> on the tight.</li></ol><p><a href=#R-image-e9c7f962ccfdc84cf6af5070faeaa5dd class=lightbox-link><img alt=OpenDiscoverySession class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-live-preview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9c7f962ccfdc84cf6af5070faeaa5dd><img alt=OpenDiscoverySession class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-live-preview.png></a></p><ol start=7><li>Click on <strong>Start Discovery Session</strong> button</li><li>Select the <strong>Web-Portal Node</strong> in the pop-up windows. It should be the same node that the method you are investigating runs on</li><li>Click <strong>Ok</strong></li></ol><p><a href=#R-image-2a64c6e379542f53e74313695509f31e class=lightbox-link><img alt=OpenDiscoverySession class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-trans-disco.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2a64c6e379542f53e74313695509f31e><img alt=OpenDiscoverySession class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-trans-disco.png></a></p><ol start=10><li>Select <strong>Tools</strong> on the right toggle.</li><li>Select <strong>Classes/Methods</strong> in the drop-down list.</li><li>Select <strong>Classes</strong> with name in the <strong>Search</strong> section.</li><li>Type in the class name <strong>supercars.dataloader.CarDataLoader</strong> in the text box. To find the class name you can search through call graphs, or ideally find it in the source code.</li><li>Click <strong>Apply</strong> to search for the matching class methods.</li><li>Once the results appear, expand the class that matches your search.</li><li>Look for the same method <strong>saveCar</strong>.</li></ol><p><a href=#R-image-a2c9b3f691728341d9a20b7147fd7146 class=lightbox-link><img alt=OpenDiscoverySession class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-trans-disco-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a2c9b3f691728341d9a20b7147fd7146><img alt=OpenDiscoverySession class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-trans-disco-config.png></a></p><p>Note that the <strong>saveCar</strong> method takes a <strong>CarForm</strong> object as an input parameter.</p><h2 id=drill-down-to-the-object>Drill Down to the Object</h2><p>Now you have found the method, explore its parameters to find out where you can pull the car details properties.</p><p>You saw that <strong>saveCar</strong> method takes the complex object <strong>CarForm</strong> as an input parameter. This object will hold the form data that was entered on the application webpage. Next, you need to inspect that object and find out how you can pull the car details from it.</p><ol><li>Type in the class name of the input object <strong>supercars.form.CarForm</strong> in the text box</li><li>Click <strong>Apply</strong> to search for the class methods.</li><li>When the results appear, expand the <strong>supercars.form.CarForm</strong> class that matches the search.</li><li>Look for the methods that will return the car details that you want. You will find <strong>get</strong> methods for price, model, color, and more.</li></ol><p><a href=#R-image-85046ebd769bbd13be0866703e04678c class=lightbox-link><img alt=ObjectDrillDown class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-object-drilldown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85046ebd769bbd13be0866703e04678c><img alt=ObjectDrillDown class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-object-drilldown.png></a></p><h2 id=create-method-invocation-data-collector>Create Method Invocation Data Collector</h2><p>With the findings from the previous exercises, you can now configure a method invocation data collector to pull the car details directly from the running code in runtime.</p><ol><li>Select the <strong>Applications</strong> tab.</li><li>Select <strong>Supercar-Trader-YOURINITIALS</strong> Application</li><li>Select the <strong>Configuration</strong> tab.</li><li>Click on the <strong>Instrumentation</strong> link.</li><li>Select the <strong>Data Collectors</strong> tab.</li><li>Click <strong>Add</strong> in the <strong>Method Invocation Data Collectors</strong>.</li></ol><p><a href=#R-image-fad04544e13bb125c25f735508576c17 class=lightbox-link><img alt=MIDCDataCollector class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-method-collector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fad04544e13bb125c25f735508576c17><img alt=MIDCDataCollector class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-method-collector.png></a></p><p>We will create a method invocation data collector to capture the car details.</p><ol start=7><li>For the <strong>Name</strong>, specify <strong>SellCarMI-YOURINITIALS</strong>.</li><li>Enable <strong>Transaction Snapshots</strong>.</li><li>Enable <strong>Transaction Analytics</strong>.</li><li>Select <strong>with a Class Name that</strong>.</li><li>Add <strong>supercars.dataloader.CarDataLoader</strong> as the <strong>Class Name</strong>.</li><li>Add <strong>saveCar</strong> as the <strong>Method Name</strong>.</li></ol><p><a href=#R-image-cdd79cfb29caf71fd91eadc228945020 class=lightbox-link><img alt=NewMIDCDataCollector class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-config.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cdd79cfb29caf71fd91eadc228945020><img alt=NewMIDCDataCollector class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-config.png></a></p><p>Then as observed, the Input Parameter of Index 0 in SaveCar method was an on Object of Class <strong>CarForm</strong>, and then there is a Getter method inside that object that returns the car details properties such as <strong>getPrice()</strong>.</p><p>So to explain that how we fetched that value in the MIDC, we will do the below:</p><ol start=13><li>Click on <strong>Add</strong> at the bottom of the MIDC panel, to specify the new data that you want to collect.</li><li>In the Display Name, specify <strong>CarPrice_MIDC</strong></li><li>In the Collect Data From, select <strong>Method Parameter of Index 0</strong>, which is our <strong>CarForm Object</strong>.</li><li>For the <strong>Operation on Method Parameter</strong>, select <strong>Use Getter Chain</strong>. You will be calling a method inside CarForm to return the car details.</li><li>Then specify <strong>getPrice()</strong>, the Getter method inside the <strong>CarForm</strong> class that will return the price.</li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-ca2f0d59e427b953c921abcf667010c6 class=lightbox-link><img alt=CreateMIDCDataCollector1 class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-datacoll.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ca2f0d59e427b953c921abcf667010c6><img alt=CreateMIDCDataCollector1 class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-datacoll.png></a></p><ol start=19><li>Repeat the above steps for all the properties, including color, model, and any others that you want to collect data for.</li></ol><p><a href=#R-image-0cf5608359d6ad877381778f94d063bc class=lightbox-link><img alt=CreateMIDCDataCollector2 class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0cf5608359d6ad877381778f94d063bc><img alt=CreateMIDCDataCollector2 class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-midc-details.png></a></p><ol start=20><li><strong>Save MIDC</strong>, and apply to the <strong>â€/Supercar-Trader/sell.doâ€</strong> business transaction.</li></ol><p>The implementation of the MIDC requires that we restart the JVM:</p><ol><li>SSH into your EC2 instance</li><li>Shutdown the Tomcat Sever</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./shutdown.sh</span></span></code></pre></div><p>If you find any remaining application JVMs still running, kill the remaining JVMs using the command below.</p><div class=tab-panel data-tab-group=R-tabs-4a8d93440706d417dd83fc1a3753e055><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-96e084e9d73d9bc0a2fff9bd35231e96 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4a8d93440706d417dd83fc1a3753e055","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-96e084e9d73d9bc0a2fff9bd35231e96 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pkill -f Supercar-Trader</span></span></code></pre></div></div></div></div></div><ol start=3><li>Restart the Tomcat Server</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./startup.sh</span></span></code></pre></div><ol start=4><li>Validate that the Tomcat server is running, this can take a few minutes</li></ol><div class=tab-panel data-tab-group=R-tabs-f839fce7425bf48e9bc14fc56eb4b0f9><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-cb975f9a80ab504b6475aa7f362c544f aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-f839fce7425bf48e9bc14fc56eb4b0f9","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-c6ffbdd0bcdfd1aafe48e7b7fe40efb4 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-f839fce7425bf48e9bc14fc56eb4b0f9","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-cb975f9a80ab504b6475aa7f362c544f data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl localhost:8080</span></span></code></pre></div></div></div><div id=R-tab-id-c6ffbdd0bcdfd1aafe48e7b7fe40efb4 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>&lt;!DOCTYPE html&gt;
</span></span><span class=line><span class=cl>&lt;html <span class=nv>lang</span><span class=o>=</span><span class=s2>&#34;en&#34;</span>&gt;
</span></span><span class=line><span class=cl>    &lt;head&gt;
</span></span><span class=line><span class=cl>        &lt;meta <span class=nv>charset</span><span class=o>=</span><span class=s2>&#34;UTF-8&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;title&gt;Apache Tomcat/9.0.50&lt;/title&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;favicon.ico&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;icon&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;image/x-icon&#34;</span> /&gt;
</span></span><span class=line><span class=cl>        &lt;link <span class=nv>href</span><span class=o>=</span><span class=s2>&#34;tomcat.css&#34;</span> <span class=nv>rel</span><span class=o>=</span><span class=s2>&#34;stylesheet&#34;</span> <span class=nv>type</span><span class=o>=</span><span class=s2>&#34;text/css&#34;</span> /&gt;
</span></span><span class=line><span class=cl>    &lt;/head&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    &lt;body&gt;
</span></span><span class=line><span class=cl>        &lt;div <span class=nv>id</span><span class=o>=</span><span class=s2>&#34;wrapper&#34;</span>
</span></span><span class=line><span class=cl>....</span></span></code></pre></div></div></div></div></div><h2 id=validate-analytics-on-md-parameters>Validate analytics on MD parameters</h2><p>Go to the website and apply some manual load on the Sell Car Page by submitting the form a couple of times.</p><p>You will now verify if the business data was captured by HTTP data collectors in AppDynamics Analytics.</p><ol><li>Select the <strong>Analytics</strong> tab.</li><li>Select the <strong>Searches</strong> tab and Add a new <strong>Drag and Drop Search</strong>.</li><li>Click the <strong>+ Add</strong> button and create a new <strong>Drag and Drop Search</strong>.</li><li>Click <strong>+ Add Criteria</strong></li><li>Select <strong>Application</strong> and Search For Your Application Name <strong>Supercar-Trader-YOURINITIALS</strong></li><li>Verify that the <strong>Business Parameters</strong> appear as a field in the <strong>Custom Method Data</strong>.</li><li>Verify that the <strong>CarPrice Field</strong> has data.</li></ol><p><a href=#R-image-0a082cd60dc550f92c085c225fdcd2fc class=lightbox-link><img alt=ValidateMIDCDataCollector class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-search-results.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0a082cd60dc550f92c085c225fdcd2fc><img alt=ValidateMIDCDataCollector class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/4-configure-method-data-collectors/images/05-biq-search-results.png></a></p><h2 id=conclusion>Conclusion</h2><p>You have now captured the business data from the Sell Car transaction from the node at runtime. This data can be used in the Analytical and Dashboard features within AppDynamics to provide more context to the business and measure IT impact on the business.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=dashboard-components>Dashboard Components</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>The ability to build dashboards is a vital component of the AppDynamics capabilities and value. In this exercise,you will work with some of the dashboard components that can be used to build compelling dashboards.</p><h2 id=create-a-new-dashboard>Create a new dashboard</h2><ol><li>Select the <strong>Dashboard & Reports</strong> tab.</li><li>Click <strong>Create Dashboard</strong>.</li><li>Enter a dashboard name such as <strong>SuperCar-Dashboard-YOURINITIALS</strong>.</li><li>Select <strong>Absolute Layout</strong> as the <strong>Canvas Type</strong>.</li><li>Click <strong>OK</strong>.</li></ol><p><a href=#R-image-0cb901482996a4ebe5305cfd7609dfe8 class=lightbox-link><img alt=NewDashboard class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-create-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0cb901482996a4ebe5305cfd7609dfe8><img alt=NewDashboard class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-create-dashboard.png></a></p><p>Now open the newly created empty dashboard. You will now add various widget types.</p><h2 id=dashboard-components-custom-widget-builder>Dashboard components custom widget builder</h2><p>The custom widget builder is a highly flexible tool that can generate representations of data, including numeric vews, time series, pie charts, and more. It is based on the AppDynamics AD Query Language.</p><p>To create a widget, follow these steps:</p><ol><li>Toggle the <strong>Edit Mode</strong> at the upper left corner of the dashboard.</li><li>Click <strong>Add Widget</strong>.</li><li>Select the <strong>Analytics</strong> tab on the left.</li><li>Click <strong>Custom Widget Builder</strong>.</li></ol><p><a href=#R-image-8d87d75f3a9c4bf5aca8ab7d1ce129de class=lightbox-link><img alt=NewCustomWidgetBuilder class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-widget-builder.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8d87d75f3a9c4bf5aca8ab7d1ce129de><img alt=NewCustomWidgetBuilder class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-widget-builder.png></a></p><p>There are many chart types that you can create in the Customer Widget Builder. You can simply drag or drop information or create an AD Query in the Advanced pane..</p><p><a href=#R-image-42b75cf79b95868e0b51f1f5551d8d7f class=lightbox-link><img alt=NewCustomWidgetBuilder class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-add-widget.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-42b75cf79b95868e0b51f1f5551d8d7f><img alt=NewCustomWidgetBuilder class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-add-widget.png></a></p><p>For now, we will cover Numeric, Bar and Pie Charts.</p><h3 id=numeric-charts>Numeric charts</h3><p><strong>Exercise:</strong> Quantifying the dollar amount impacted by errors enables you to show the impact of IT performance on the business revenue.</p><ol><li>Select the <strong>Numeric</strong> chart type.</li><li>Add a Filter on the Application field and Select your application name: <strong>Supercar-Trader-YOURINITIALS</strong></li><li>Add a filter on the <strong>/Supercar-Trader/sell.do</strong> business transactions.</li><li>Add a filter on the User Experience Field selecting only the <strong>Error</strong> to show the impact of errors.</li><li>Find the <strong>CarPrice_MIDC</strong> field on the left panel and drag and drop it into the Y-Axis. Notice that SUM is the Aggregation used to capture the total price per model.</li><li>Change the font color to red for better visibility.</li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-c17bee5c270d47da8f1687a8d0c97516 class=lightbox-link><img alt=NumericChartWidget class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-lost-revenue.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c17bee5c270d47da8f1687a8d0c97516><img alt=NumericChartWidget class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-lost-revenue.png></a></p><p>Note that you could do the same for the <strong>$ Amount Transacted Successfully</strong> criterion by changing the user experience filter to only include NORMAL, SLOW and VERY SLOW.</p><p>You could also baseline this metric by creating a custom metric in the Analytics module and defining a health rule that indicates if the <strong>$ Amount Impacted</strong> is equal to or higher than the baseline. You can also add a label for the currency.</p><p><a href=#R-image-c46aaa4402eeb35245992a0d1d362011 class=lightbox-link><img alt=NumericChartSamples class="lazy lightbox figure-image" loading=lazy src=images/06-numeric-chart-widget-samples-09.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c46aaa4402eeb35245992a0d1d362011><img alt=NumericChartSamples class="lazy lightbox lightbox-image" loading=lazy src=images/06-numeric-chart-widget-samples-09.png></a></p><h3 id=bar-charts>Bar charts</h3><p><strong>Exercise:</strong> You will now create a bar chart to visualize Top Impacted Car Models. The chart will show the car models of all of the <strong>SellCar</strong> transactions, categorized by the User Experience.</p><ol><li>Create a New Widget by clicking <strong>+ Add Widget</strong>, <strong>Analytics</strong> and <strong>Custom Widger Builder</strong></li><li>Select the <strong>Column</strong> chart type.</li><li>Add the following filters: Application = <strong>Supercar-Trader-YOURINITIALS</strong> and Business Transaction = <strong>/Supercar-Trader/sell.do</strong>.</li><li>Add <strong>CarModel_MIDC</strong> and <strong>User Experience</strong> to the X-Axis.</li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-7b9fd1493fdcf2cbb807757a77c5c50f class=lightbox-link><img alt=BarChartWidget class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-bar-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7b9fd1493fdcf2cbb807757a77c5c50f><img alt=BarChartWidget class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-bar-chart.png></a></p><p>This chart type can be adjusted based on your need. For example, you could group the X-AXIS by Customer Type, Company, Organization, and more. Refer to the following example.</p><p><a href=#R-image-c9c7386ad65ce66d3c2e61d071023a84 class=lightbox-link><img alt=BarChartSamples class="lazy lightbox figure-image" loading=lazy src=images/06-bar-chart-widget-samples-05.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c9c7386ad65ce66d3c2e61d071023a84><img alt=BarChartSamples class="lazy lightbox lightbox-image" loading=lazy src=images/06-bar-chart-widget-samples-05.png></a></p><h3 id=pie-charts>Pie charts</h3><p>You will now create a pie chart that shows all the car models reported by the <code>sellCar</code> transaction and the sum of prices per model. This will show the most highly-demanded model in the application.</p><ol><li>Create a new Widget</li><li>Select the <strong>Pie</strong> chart type.</li><li>Add the following filters: Application = <strong>Supercar-Trader-YOURINITIALS</strong> and Business Transaction = <strong>/Supercar-Trader/sell.do</strong>.</li><li>Add <strong>CarModel_MIDC</strong> in the X-Axis</li><li>Add <strong>CarPrice_MIDC</strong> in the Y-Axis. Note that <strong>SUM</strong> is the aggregation used to capture the total price per model.</li><li>Add a Title <strong>Sold by Car Model</strong></li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-49c18381955f42be2bb4fcc02c729100 class=lightbox-link><img alt=PieChartWidget class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-pie-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-49c18381955f42be2bb4fcc02c729100><img alt=PieChartWidget class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-pie-chart.png></a></p><p>Refer to the following example for more uses of the pie chart widget.</p><p><a href=#R-image-3f86eb43a4bd7efbe069462d1111c8f4 class=lightbox-link><img alt=PieChartSamples class="lazy lightbox figure-image" loading=lazy src=images/06-pie-chart-widget-samples-07.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f86eb43a4bd7efbe069462d1111c8f4><img alt=PieChartSamples class="lazy lightbox lightbox-image" loading=lazy src=images/06-pie-chart-widget-samples-07.png></a></p><h2 id=dashboard-components-conversion-funnels>Dashboard components: Conversion funnels</h2><p>Conversion funnels help visualize the flow of users or events through a multi-step process. This enables you to better understand which steps can be optimized for more successful convergence. You can also use conversion funnels to examine the IT perfomance of every step, to understand how they impact the user experience and identify the cause of user drop-offs.</p><p>Note that the funnel is filtered according to the users who executed this path in that specific order, not the total visits per step.</p><p>The first step of funnel creation is to select a unique identifier of the transaction that can represent each user navigation through the funnel. Usually, the Session ID is the best choice, since it persists through each step in the funnel.</p><p>A Session ID can be captured from the transactions. Youâ€™ll need a <strong>SessionId</strong> data collector to use it as a counter for the Funnel transactions.</p><p>For Java applications, AppDynamics has the capability to Session IDs in the default HTTP data collector. Youâ€™ll ensure that it is enabled and apply it to all business transactions to capture the Session ID for every transaction.</p><ol><li>Select the <strong>Applications</strong> tab.</li><li>Select <strong>Supercar-Trader-YOURINITIALS</strong> Application.</li><li>Select the <strong>Configuration</strong> Left tab.</li><li>Click <strong>Instrumentation</strong>.</li><li>Select the <strong>Data Collectors</strong> tab.</li><li>Edit the <strong>Default HTTP Request Request Data Collectors</strong>.</li><li>Select <strong>Transaction Analytics</strong>.</li><li>Verify that <strong>SessionID</strong> is selected.</li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-279e998e8c2ad1446a104c40ec5af68b class=lightbox-link><img alt=EnableSessionId class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-session-id.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-279e998e8c2ad1446a104c40ec5af68b><img alt=EnableSessionId class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-session-id.png></a></p><p>Now apply some load by navigating multiple times from the <strong>/Supercar-Trader/home.do</strong> page. Then, directly navigate to <strong>/Supercar-Trader/sell.do</strong> page on the application.</p><p>Now Return to your Dashboard to create the funnel widget.</p><ol><li>Toggle the <strong>Edit</strong> slider.</li><li>Click <strong>Add Widget</strong>.</li><li>Select the <strong>Analytics</strong> tab.</li><li>Click <strong>Funnel Analysis</strong>.</li><li>Select <strong>Transactions</strong> from the drop-down list.</li><li>Under <strong>Count Distinct of</strong>, select <strong>uniqueSessionId</strong> from the drop-down list.</li><li>Click <strong>Add Step</strong>. Name it <strong>Home Page</strong>.</li><li>Click on <strong>Add Criteria</strong>. Add the following criteria: <strong>Application</strong>: Supercar-Trader-YOURINITIALS & <strong>Business Transactions</strong>: <strong>/Supercar-Trader/home.do</strong>.</li><li>Click <strong>Add Step</strong>. Name it <strong>SellCar Page</strong>.</li><li>Click on <strong>Add Criteria</strong>. Add the following criteria: <strong>Application:</strong> Supercar-Trader-YOURINITIALS & <strong>Business Transactions:</strong> /Supercar-Trader/sell.do.</li><li>Select the <strong>Show Health</strong> Checkbox on the right panel to visualize the transaction health in the flow map.</li><li>Click <strong>Save</strong></li></ol><p><a href=#R-image-f7deedbff67f0ab80a68a3036796c73e class=lightbox-link><img alt=FunnelWidget class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-funnel-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f7deedbff67f0ab80a68a3036796c73e><img alt=FunnelWidget class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/5-dashboard-components/images/05-biq-funnel-chart.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=build-your-dashboard>Build Your Dashboard</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<h2 id=exercise---build-your-own-dashboard>Exercise - Build Your Own Dashboard</h2><p>To conclude this Learning Lab, use the business data that was captured in the earlier exercise using method invocation data collectors and your understanding of the dashboard components to build an IT Business Impact Dashboard.</p><p>Refer to the following example and build your own dashboard, using the same data and widgets.</p><p><a href=#R-image-d7f9ed87d96bddcda696fd8f49bf6329 class=lightbox-link><img alt="DiscoverCallGraphMethods 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/6-build-your-dashboard/images/06-BusinessDashboard-01.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d7f9ed87d96bddcda696fd8f49bf6329><img alt="DiscoverCallGraphMethods 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/3-business-iq/6-build-your-dashboard/images/06-BusinessDashboard-01.png></a></p><p><strong>Congratulations! You have completed the BusinessIQ Fundamentals Learning Lab!</strong></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=browser-real-user-monitoring-brum>Browser Real User Monitoring (BRUM)</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=objectives>Objectives</h2><p>In this Learning Lab you learn how to use AppDynamics to monitor the health of your browser-based application.</p><p>When you have completed this lab, you will be able to:</p><ul><li>Create a browser application in the Controller</li><li>Configure the Browser Real User Monitoring (BRUM) agent to monitor your web applicationâ€™s health.</li><li>Troubleshoot performance issues and find the root cause, whether it occurs on the browser side or the server side of the transaction.</li></ul><h2 id=workshop-environment>Workshop Environment</h2><p>The workshop environment has two hosts:</p><ul><li>The first host runs the AppDynamics Controller and will be referred to from this point on as the Controller.</li><li>The second host runs the Supercar Trader application used in the labs. It will be the host where you will install the AppDynamics agents and will be referred to from this point on as the Application VM.</li></ul><h2 id=controller>Controller</h2><p>You will be using the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> for this workshop.</p><p><a href=#R-image-cc27bd8f6a25d1ce57c3ed61a75def64 class=lightbox-link><img alt=Controller class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cc27bd8f6a25d1ce57c3ed61a75def64><img alt=Controller class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/images/controller-vm.png></a></p><h2 id=application-vm>Application VM</h2><p>Supercar Trader is a Java-based Web Application</p><p>The purpose of Supercar-Trader collection is to generate dynamic traffic (business transactions) for AppDynamics Controller.</p><p><a href=#R-image-efac216b25cef47779620e6ca391a1dc class=lightbox-link><img alt="Application VM" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/images/application-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-efac216b25cef47779620e6ca391a1dc><img alt="Application VM" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/images/application-vm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Browser Real User Monitoring (BRUM)</h1><article class=default><header class=headline></header><h1 id=brum-lab-prerequisits>BRUM Lab Prerequisits</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Access your AppDynamics Controller from your web browser.</li><li>Verify transaction load to the application.</li><li>Restart the application and transaction load if needed.</li></ul><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=verify-transaction-load-to-the-application>Verify transaction load to the application</h2><p>Check the application flow map:</p><ol><li>Select the <strong>last 1 hour</strong> time frame.</li><li>Verify you see the five different Tiers on the flow map.</li><li>Verify there has been consistent load over the last 1 hour.</li></ol><p><a href=#R-image-492d87d9a57bad46c64192a7be6f1cf4 class=lightbox-link><img alt="Verify Load 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereque-appload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-492d87d9a57bad46c64192a7be6f1cf4><img alt="Verify Load 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereque-appload.png></a></p><p>Check the list of business transactions:</p><ol start=4><li>Click the <strong>Business Transactions</strong> option on the left menu.</li><li>Verify you see the eleven business transactions seen below.</li><li>Verify that they have some number of calls during the last hour.</li></ol><p><strong>Note:</strong> If you donâ€™t see the <strong>Calls</strong> column, you can click the <strong>View Options</strong> toolbar button to show that column.</p><p><a href=#R-image-178cbb53540746f188544b5981a1ce49 class=lightbox-link><img alt="Verify Business transactions" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereq-bts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-178cbb53540746f188544b5981a1ce49><img alt="Verify Business transactions" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereq-bts.png></a></p><p>Check the agent status for the Nodes:</p><ol start=7><li>Click the <strong>Tiers & Nodes</strong> option on the left menu.</li><li>Click <strong>Grid View</strong>.</li><li>Verify that the <strong>App Agent Status</strong> for each Node is greater than 90% during the last hour.</li></ol><p><a href=#R-image-960c68e92470d1c003a5ef3f173c4bb5 class=lightbox-link><img alt="Verify Agents" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereq-tiersnodes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-960c68e92470d1c003a5ef3f173c4bb5><img alt="Verify Agents" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/01-prereq-tiersnodes.png></a></p><h2 id=restart-the-application-and-load-generation-if-needed>Restart the Application and Load Generation if Needed</h2><p>If any of the checks you performed in the previous steps could not be verified, SSH into your <strong>Application VM</strong> and follow these steps to restart the application and transaction load.</p><p>Use the following commands to stop the running instance of Apache Tomcat.<div class=tab-panel data-tab-group=R-tabs-c88174a51b0255abb3270049e9946a4f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-4820a8d8b01691f34d11135369cd940f aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c88174a51b0255abb3270049e9946a4f","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-4820a8d8b01691f34d11135369cd940f data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./shutdown.sh</span></span></code></pre></div></div></div></div></div></p><p>Use the command below to check for remaining application JVMs still running.</p><div class=tab-panel data-tab-group=R-tabs-6c4dba4fb604aa2e1a963eda59850c0a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bea75e95360801ec969899b298db9382 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6c4dba4fb604aa2e1a963eda59850c0a","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-bea75e95360801ec969899b298db9382 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps -ef <span class=p>|</span> grep Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>If you find any remaining application JVMs still running, kill the remaining JVMs using the command below.</p><div class=tab-panel data-tab-group=R-tabs-59105245b60e1c8f15ce3bf816bf076c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-11cd576149ab60f35359834ee021e822 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-59105245b60e1c8f15ce3bf816bf076c","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-11cd576149ab60f35359834ee021e822 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pkill -f Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>Use the following commands to stop the load generation for the application. Wait until all processes are stopped.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./stop_load.sh</span></span></code></pre></div><p>Restart the Tomcat server:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./startup.sh</span></span></code></pre></div><p>Wait for two minutes and use the following command to ensure Apache Tomcat is running on port 8080.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo netstat -tulpn <span class=p>|</span> grep LISTEN</span></span></code></pre></div><p>You should see output similar to the following image showing that port 8080 is in use by Apache Tomcat.</p><p><a href=#R-image-42e5833f86f513bd88cd28a52189b091 class=lightbox-link><img alt="Restart App 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/restart-app-and-load-01.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-42e5833f86f513bd88cd28a52189b091><img alt="Restart App 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/restart-app-and-load-01.png></a></p><p>Use the following commands to start the load generation for the application.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./start_load.sh</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-7c9f14ea8359e7ab6f80e23f2d37e743 class=lightbox-link><img alt="Restart App 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/restart-app-and-load-03.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7c9f14ea8359e7ab6f80e23f2d37e743><img alt="Restart App 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/1-lab-prerequisites/images/restart-app-and-load-03.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-browser-application>Create Browser Application</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Access your AppDynamics Controller from your web browser.</li><li>Create the Browser Application in the Controller.</li><li>Configure the Browser Application.</li></ul><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=create-the-browser-application-in-the-controller>Create the Browser Application in the Controller</h2><p>Use the following steps to create your new browser application.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1>Note</summary><div class=box-content><p>It is <strong>very important</strong> that you create a unique name for your browser application in Step 5 below.</p></div></details><ol><li>Click the <strong>User Experience</strong> tab on the top menu.</li><li>Click the <strong>Browser Apps</strong> option under <strong>User Experience</strong>.</li><li>Click <strong>Add App</strong>.</li><li>Choose the option <strong>Create an Application manually</strong>.</li><li>Type in a unique name for your browser application in the format <em>Supercar-Trader-Web-&lt;your_initials_or_name>-&lt;four_random_numbers></em><ul><li>Example 1: Supercar-Trader-Web-JFK-3179</li><li>Example 2: Supercar-Trader-Web-JohnSmith-0953</li></ul></li><li>Click <strong>OK</strong>.</li></ol><p><a href=#R-image-7a2e0f5a300c6a5baf2f9c74c69b39c0 class=lightbox-link><img alt="Create App" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-create-app.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7a2e0f5a300c6a5baf2f9c74c69b39c0><img alt="Create App" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-create-app.png></a></p><p>You should now see the <strong>Browser App Dashboard</strong> for the <strong>Supercar-Trader-Web-##-####</strong> application.</p><ol><li>Click the <strong>Configuration</strong> tab on the left menu.</li><li>Click the <strong>Instrumentation</strong> option.</li></ol><p><a href=#R-image-d4be225fb670846c6996b75c98f32153 class=lightbox-link><img alt=Instrumentation class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-instrument.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d4be225fb670846c6996b75c98f32153><img alt=Instrumentation class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-instrument.png></a></p><p>Change the default configuration to have the IP Address stored along with the data captured by the browser monitoring agent by following these steps.</p><ol start=3><li>Click the <strong>Settings</strong> tab.</li><li>Use the scroll bar on the right to scroll to the bottom of the screen.</li><li>Check the <strong>Store IP Address</strong> check box.</li><li>Click <strong>Save</strong>.</li></ol><p>You can read more about configuring the Controller UI for Browser RUM <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-real-user-monitoring/overview-of-the-controller-ui-for-browser-rum/configure-the-controller-ui-for-browser-rum rel=external>here</a>.</p><p><a href=#R-image-0dca56ec43291efcdef5cc1123dfb970 class=lightbox-link><img alt="IPAddress Config" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-ipaddress.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-0dca56ec43291efcdef5cc1123dfb970><img alt="IPAddress Config" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/2-create-browser-application/images/02-brum-ipaddress.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-agent-injection>Configure Agent Injection</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Enable JavaScript Agent injection.</li><li>Select Business Transactions for injection.</li></ul><h2 id=enable-javascript-agent-injection>Enable JavaScript Agent injection</h2><p>While AppDynamics supports various methods for injecting the JavaScript Agent, you will be using the Auto-Injection method in this lab. Follow these steps to enable the Auto-Injection of the JavaScipt Agent.</p><ol><li>Click the <strong>Applications</strong> tab on the left menu and drill into your Supercar-Trader-## application.</li><li>Click the <strong>Configuration</strong> tab on the left menu at the bottom.</li><li>Click the <strong>User Experience App Integration</strong> option.</li></ol><p><a href=#R-image-dbabbd84114a3945d5503756890223bf class=lightbox-link><img alt="BRUM Dash 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-app-integration.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dbabbd84114a3945d5503756890223bf><img alt="BRUM Dash 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-app-integration.png></a></p><ol start=4><li>Click the <strong>JavaScript Agent Injection</strong> tab.</li><li>Click <strong>Enable</strong> so that it turns blue.</li><li>Ensure that <strong>Supercar-Trader-Web-##-####</strong> is the selected browser app. Choose the application that you created in the previous section</li><li>Check the <strong>Enable</strong> check box under <strong>Enable JavaScript Injection</strong></li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-6ee2e86d122ac815dbe959a16200cbe0 class=lightbox-link><img alt="BRUM Dash 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-agent-injection.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6ee2e86d122ac815dbe959a16200cbe0><img alt="BRUM Dash 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-agent-injection.png></a></p><p>It takes a few minutes for the Auto-Injection to discover potential Business Transactions. While this is happening, use these steps to enable the Business Transaction Correlation. For newer APM agents this is done automatically</p><ol start=9><li>Click the <strong>Business Transaction Correlation</strong> tab.</li><li>Click the <strong>Enable</strong> button under the <strong>Manually Enable Business Transactions</strong> section.</li><li>Click <strong>Save</strong>.</li></ol><p><a href=#R-image-ff714f9207c180ac183ac72be84ef1e3 class=lightbox-link><img alt="BRUM Dash 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-bt-manual.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ff714f9207c180ac183ac72be84ef1e3><img alt="BRUM Dash 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-bt-manual.png></a></p><h2 id=select-business-transactions-for-injection>Select Business Transactions for injection</h2><p>Use the following steps to select the Business Transactions for Auto-Injection.</p><ol><li>Click the <strong>JavaScript Agent Injection</strong> tab.</li><li>Type <strong>.do</strong> in the search box.</li><li>Click the <strong>Refresh List</strong> link for the Business Transactions until all 9 BTs show up.</li><li>Select all Business Transactions from the right list box.</li><li>Click the arrow button to move them to the left list box.</li><li>Ensure that all Business Transactions are moved into the left list box.</li><li>Click <strong>Save</strong>.</li></ol><p>You can read more about configuring Automatic Injection of the JavaScript Agent <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-real-user-monitoring/inject-the-javascript-agent/automatic-injection-of-the-javascript-agent rel=external><strong>here</strong></a>.</p><p><a href=#R-image-15c4ac92ee8bacc415364ca403f586fe class=lightbox-link><img alt="BRUM Dash 5" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-bts-auto-inject.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15c4ac92ee8bacc415364ca403f586fe><img alt="BRUM Dash 5" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/3-configure-agent-injection/images/03-brum-bts-auto-inject.png></a></p><p>Wait a few minutes for load to start showing up in your Browser Application.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-and-troubleshoot---part-1>Monitor and Troubleshoot - Part 1</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Review the Browser Application Overview Dashboard</li><li>Review the Browser Application Geo Dashboard</li><li>Review the Browser Application Usage Stats Dashboard</li><li>Navigate the Supercar-Trader application web pages</li></ul><h2 id=review-the-browser-application-overview-dashboard>Review the Browser Application Overview Dashboard</h2><p>Navigate to the User Experience dashboard and drill into the browser application overview dashboard by following these steps.</p><ol><li>Click the <strong>User Experience</strong> tab on the left menu.</li><li>Search for you Web Application <strong>Supercar-Trader-Web-##-###</strong>.</li><li>Click <strong>Details</strong> or double click on your application name</li></ol><p><a href=#R-image-975f352219eea9d318b60a3c19adf80e class=lightbox-link><img alt="BRUM Dash 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-app.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-975f352219eea9d318b60a3c19adf80e><img alt="BRUM Dash 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-app.png></a></p><p>The Overview dashboard displays a set of configurable widgets. The default widgets contain multiple graphs and lists that feature common high-level indicators of application performance, including:</p><ul><li>End User Response Time Distribution</li><li>End User Response Time Trend</li><li>Total Page Requests by Geo</li><li>End User Response Time by Geo</li><li>Top 10 Browsers</li><li>Top 10 Devices</li><li>Page Requests per Minute</li><li>Top 5 Pages by Total Requests</li><li>Top 5 Countries by Total Page Requests</li></ul><p>Explore the features of the dashboard.</p><ol start=4><li>Click <strong>+</strong> to choose additional graphs and widgets to add to the dashboard.</li><li>Click and drag the bottom right corner of any widget to resize it.</li><li>Select the outlined area in any widget to move and place it on the dashboard.</li><li>Click on the title of any widget to drill into the detail dashboard.</li><li>Click <strong>X</strong> in the top right corner of any widget to remove it from the dashboard.</li></ol><p>Any changes you make to the dashboard widget layout will automatically be saved.</p><p>You can read more about the Browser Application Overview dashboard <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-app-dashboard/overview rel=external><strong>here</strong></a>.</p><p><a href=#R-image-06da01ee14088d03053500628c8447cd class=lightbox-link><img alt="BRUM Dash 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-06da01ee14088d03053500628c8447cd><img alt="BRUM Dash 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-overview.png></a></p><h2 id=review-the-browser-application-geo-dashboard>Review the Browser Application Geo Dashboard</h2><p>The Geo Dashboard displays key performance metrics by geographic location based on page loads. The metrics displayed throughout the dashboard are for the region currently selected on the map or in the grid. The Map view displays load circles with labels for countries that are in the key timing metrics given in the right panel. Some countries and regions, however, are only displayed in the grid view.</p><p>Navigate to the Browser Application Geo dashboard and explore the features of the dashboard described below.</p><ol><li>Click the <strong>Geo Dashboard</strong> option.</li><li>Click on one of the load circles to drill down to the region.</li><li>Hover over one of the regions to show the region details.</li><li>Use the zoom slider to adjust the zoom level.</li><li>Click <strong>Configuration</strong> to explore the map options.</li><li>Switch between the grid view and map view.</li></ol><p>You can read more about the Browser Application Geo dashboard <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-app-dashboard/geo-tab rel=external><strong>here</strong></a>.</p><p><a href=#R-image-92afce29f316ef3c29ca2a7a862df0ac class=lightbox-link><img alt="BRUM Dash 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-geomap.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-92afce29f316ef3c29ca2a7a862df0ac><img alt="BRUM Dash 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-geomap.png></a></p><h2 id=review-the-browser-application-usage-stats-dashboard>Review the Browser Application Usage Stats Dashboard</h2><p>The <strong>Usage Stats</strong> dashboard presents an aggregated page-load usage data based on your users browser type and device/platform.</p><p>The Browser Application Usage Stats dashboard helps you discover:</p><ul><li>The slowest browsers in terms of total end-user response time.</li><li>The slowest browsers to render the response page.</li><li>The browsers that most of your end users use.</li><li>The browsers that most of your end users use in a particular country or region.</li></ul><p>Navigate to the Browser Application Usage Stats dashboard and explore the features of the dashboard described below.</p><ol><li>Click the <strong>Usage Stats</strong> option.</li><li>Click the <strong>Show Versions</strong> option.</li><li>Look at the different browsers and versions by load.</li><li>Hover over the sections in the pie chart to see the details.</li></ol><p><a href=#R-image-dce58eb719f98f6637ae632f36f9831d class=lightbox-link><img alt="BRUM Dash 4" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-usage-stats.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dce58eb719f98f6637ae632f36f9831d><img alt="BRUM Dash 4" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-usage-stats.png></a></p><p>Use these steps to explore more metrics by browser and version.</p><ol start=5><li>Use the scroll bar on the right to scroll to the bottom of the page.</li><li>Explore the available metrics by browser and version.</li><li>Explore the available metrics by country.</li></ol><p><a href=#R-image-e51ff104efdb20c6c8829a889ce33a69 class=lightbox-link><img alt="BRUM Dash 5" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-usage-stats2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e51ff104efdb20c6c8829a889ce33a69><img alt="BRUM Dash 5" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-usage-stats2.png></a></p><p>Navigate to the Devices dashboard and explore the features of the dashboard described below.</p><ol start=8><li>Click the <strong>Devices</strong> option.</li><li>Look at the load by device break out.</li><li>Hover over the sections in the pie chart to see the details.</li><li>Explore the available performance metrics by device.</li></ol><p>You can read more about the Browser Application Usage Stats dashboard <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-app-dashboard/usage-stats rel=external><strong>here</strong></a>.</p><p><a href=#R-image-8911ff56e10870e68b50f7f9fdbb359c class=lightbox-link><img alt="BRUM Dash 6" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-device.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8911ff56e10870e68b50f7f9fdbb359c><img alt="BRUM Dash 6" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-device.png></a></p><h2 id=navigate-the-supercar-trader-application-web-pages>Navigate the Supercar-Trader application web pages</h2><p>Now that you have the Browser Real User Monitoring agent configured and explored the first series of features, letâ€™s generate some additional load and record your unique browser session by navigating the web pages of the Supercar-Trader application.</p><p>Open the main page of the app with your web browser. In the example URL below, substitute the IP Address or fully qualified domain name of your Application VM.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>http://<span class=o>[</span>application-vm-ip-address<span class=o>]</span>:8080/Supercar-Trader/home.do</span></span></code></pre></div><p>You should see the home page of the application.</p><p><a href=#R-image-e367a61031dabc8c1ee6114dfd009aea class=lightbox-link><img alt="App Page 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-supercar-homepage.jpeg style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e367a61031dabc8c1ee6114dfd009aea><img alt="App Page 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/04-brum-supercar-homepage.jpeg></a></p><p>Open the listing of available Ferraris.</p><ol><li>Click on the <strong>Supercars</strong> tab on the top menu.</li><li>Clicking on the Ferrari logo.</li></ol><p><a href=#R-image-bc9ea9a6d2ba03ef527b3dcc27e39b7d class=lightbox-link><img alt="App Page 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-02.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bc9ea9a6d2ba03ef527b3dcc27e39b7d><img alt="App Page 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-02.png></a></p><p>You should see the list of Ferraris.</p><p><a href=#R-image-8a59e0b9a4dbc2f514c56bac20fa3115 class=lightbox-link><img alt="App Page 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-03.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8a59e0b9a4dbc2f514c56bac20fa3115><img alt="App Page 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-03.png></a></p><p>Click on the image of the first Ferrari.</p><ol><li>Click <strong>View Enquiries</strong>.</li><li>Click <strong>Enquire</strong>.</li></ol><p><a href=#R-image-e761e1b1010f1c9be2e02056b7babc2d class=lightbox-link><img alt="App Page 4" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-04.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e761e1b1010f1c9be2e02056b7babc2d><img alt="App Page 4" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-04.png></a></p><p>Submit an enquiry for the car.</p><ol><li>Complete the fields on the enquiry form with appropriate data.</li><li>Click <strong>Submit</strong>.</li></ol><p><a href=#R-image-6e54408ae85716c2b6deb499be016353 class=lightbox-link><img alt="App Page 5" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-05.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e54408ae85716c2b6deb499be016353><img alt="App Page 5" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-05.png></a></p><p>Search for cars and continue browsing the site.</p><ol><li>Click on the <strong>Search</strong> tab on the top menu.</li><li>Type the letter <strong>A</strong> into the search box and click <strong>Search</strong>.</li><li>Click on the remaining tabs to explore the web site.</li></ol><p><a href=#R-image-e9c13ed5ce78596470f6c2020ead8ccd class=lightbox-link><img alt="App Page 6" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-06.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e9c13ed5ce78596470f6c2020ead8ccd><img alt="App Page 6" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/4-monitor-and-troubleshoot-part-1/images/05-app-page-06.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-and-troubleshoot---part-2>Monitor and Troubleshoot - Part 2</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Review the Browser Session you created.</li><li>Review the Pages & AJAX Requests Dashboard.</li><li>Review the Dashboard for a specific Base Page.</li><li>Troubleshoot a Browser Snapshot.</li></ul><h2 id=review-the-browser-session-you-created>Review the Browser Session you created</h2><p>You can think of sessions as a time-based context to analyze a userâ€™s experience interacting with an application. By examining browser sessions, you can understand how your applications are performing and how users are interacting with them. This enables you to better manage and improve your application, whether that means modifying the UI or optimizing performance on the server side.</p><p>Navigate to the Sessions dashboard and find the browser session that you created in the last exercise from navigating the pages of the web application. Follow these steps.</p><details open class="box cstyle notices orange"><summary class=box-label tabindex=-1>Note</summary><div class=box-content><p>You may need to wait ten minutes after you hit the last page in the web application to see your browser session show up in the sessions list. If you donâ€™t see your session after ten minutes, this could be due to a problem with the Java Agent version in use.</p></div></details><ol><li>Click the <strong>Sessions</strong> tab on the left menu.</li><li>Check the <strong>IP Address</strong> in the Session Fields list.</li><li>Find the session you created by your IP Address.</li><li>Click on your session, then click <strong>View Details</strong>.</li></ol><p><a href=#R-image-b8dd68b0709f25f7aac33b825acc9956 class=lightbox-link><img alt="BRUM Dash 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-sessions.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8dd68b0709f25f7aac33b825acc9956><img alt="BRUM Dash 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-sessions.png></a></p><p>Once you find and open the session you created, follow these steps to explore the different features of the session view.</p><blockquote><p><em>Note:</em> Your session may not have a <strong>View Snapshot</strong> link in any of the pages (as seen in step five). You will find a session that has one to explore later in this exercise.</p></blockquote><ol start=5><li>Click the <strong>Session Summary</strong> link to view the summary data.</li><li>When you click on a page listed on the left, you see the details of that page on the right.</li><li>You can always see the full name of the page you have selected in the left list.</li><li>Click on a horizontal blue bar in the waterfall view to show the details of that item.</li><li>Some pages may have a link to a correlated snapshot that was captured on the server side.</li><li>Click the configuration icon to change the columns shown in the pages list.</li></ol><p>You can read more about the Browser RUM Sessions <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-real-user-monitoring/overview-of-the-controller-ui-for-browser-rum/browser-rum-sessions rel=external><strong>here</strong></a>.</p><p><a href=#R-image-f054ea45baac9330ceadf8c793733012 class=lightbox-link><img alt="BRUM Dash 2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-session-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-f054ea45baac9330ceadf8c793733012><img alt="BRUM Dash 2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-session-details.png></a></p><h2 id=review-the-pages--ajax-requests-dashboard>Review the Pages & AJAX Requests Dashboard</h2><p>Navigate to the Pages & AJAX Requests dashboard, review the options there, and open a specific Base Page dashboard by following these steps.</p><ol><li>Click the <strong>Pages & AJAX Requests</strong> tab on the left menu.</li><li>Explore the options on the toolbar.</li><li>Click the <strong>localhost:8080/supercar-trader/car.do</strong> page.</li><li>Click <strong>Details</strong> to open the Base Page dashboard.</li></ol><p><a href=#R-image-1cd64310e3f2f8df98c6ef4a3d630fb0 class=lightbox-link><img alt="BRUM Dash 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-ajax-list.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1cd64310e3f2f8df98c6ef4a3d630fb0><img alt="BRUM Dash 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-ajax-list.png></a></p><h2 id=review-the-dashboard-for-a-specific-base-page>Review the Dashboard for a specific Base Page</h2><p>At the top of the Base Page dashboard you will see key performance indicators, End User Response Time, Load, Cache Hits, and Page Views with JS errors across the period selected in the timeframe dropdown from the upper-right side of the Controller UI. Cache Hits indicates a resource fetched from a cache, such as a CDN, rather than from the source.</p><p>In the Timing Breakdown section you will see a waterfall graph that displays the average times needed for each aspect of the page load process. For more information on what each of the metrics measures, hover over its name on the left. A popup appears with a definition. For more detailed information, see <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-real-user-monitoring/browser-rum-metrics rel=external><strong>Browser RUM Metrics</strong></a>.</p><p>Review the details for the <strong>localhost:8080/supercar-trader/car.do</strong> Base Page by following these steps.</p><ol><li>Change the timeframe dropdown to <strong>last 2 hours</strong>.</li><li>Explore the key performance indicators.</li><li>Explore the metrics on the waterfall view.</li><li>Use the vertical scroll bar to move down the page.</li><li>Explore the graphs for all of the KPI Trends.</li></ol><p>You can read more about the Base Page dashboard <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-real-user-monitoring/overview-of-the-controller-ui-for-browser-rum/pages-and-ajax-requests/page-ajax-and-iframe-dashboards/page-and-iframe-dashboards rel=external><strong>here</strong></a>.</p><p><a href=#R-image-3f438d536244174cf398e95a38854036 class=lightbox-link><img alt="BRUM Dash 4" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-main-page-summary.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3f438d536244174cf398e95a38854036><img alt="BRUM Dash 4" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/05-brum-main-page-summary.png></a></p><h2 id=troubleshoot-a-browser-snapshot>Troubleshoot a Browser Snapshot</h2><details open class="box cstyle notices orange"><summary class=box-label tabindex=-1>Note</summary><div class=box-content><p>Your application may not have any browser snapshots as such you will not be able to follow the entire workflow. You can switch to the browser application <strong>AD-Ecommerce-Browser</strong> if you would like to follow this section with a different demo application</p></div></details><p>Navigate to the Browser Snapshots list dashboard and open a specific Browser Snapshot by following these steps.</p><ol><li>Click the <strong>Browser Snapshots</strong> option.</li><li>Click the <strong>End User Response Time</strong> column header twice to show the largest response times at the top.</li><li>Click on a browser snapshot that has a gray or blue icon in the third column from the left.</li><li>Click <strong>Details</strong> to open the browser snapshot.</li></ol><p><a href=#R-image-c2d09b1f7299a726536f7ed6019eb4bc class=lightbox-link><img alt="BRUM Dash 6" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-06.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2d09b1f7299a726536f7ed6019eb4bc><img alt="BRUM Dash 6" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-06.png></a></p><p>Once you open the browser snapshot, review the details and find root cause for the large response time by following these steps.</p><ol><li>Review the waterfall view to understand where the response time was impacted.</li><li>Notice the extended <strong>Server Time</strong> metric. Hover over the label for <strong>Server Time</strong> to understand its meaning.</li><li>Click the server side transaction that was automatically captured and correlated to the browser snapshot.</li><li>Click <strong>View Details</strong> to open the associated server side snapshot.</li></ol><p><a href=#R-image-2dcbd886f20f8588432bd9d51041bd27 class=lightbox-link><img alt="BRUM Dash 7" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-07.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2dcbd886f20f8588432bd9d51041bd27><img alt="BRUM Dash 7" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-07.png></a></p><p>Once you open the correlated server side snapshot, use the steps below to pinpoint the root cause of the performance degredation.</p><ol><li>You can see that the percentage of transaction time spent in the browser was minimal.</li><li>The timing between the browser and the Web-Portal Tier represents the initial connection from the browser until the full response was returned.</li><li>You will see that the JDBC call was taking the most time.</li><li>Click <strong>Drill Down</strong> to look at the code level view inside the Enquiry-Services Tier.</li></ol><p><a href=#R-image-079e447add8d6d11ad72ab67d00aca8f class=lightbox-link><img alt="BRUM Dash 8" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-08.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-079e447add8d6d11ad72ab67d00aca8f><img alt="BRUM Dash 8" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-08.png></a></p><p>Once you open the snapshot segment for the Enquiry-Services Tier, you can see that there were JDBC calls to the database that caused issues with the transaction.</p><ol><li>Click the <strong>JDBC</strong> link with the largest time to open the detail panel for the JDBC calls.</li><li>The detail panel for the JDBC exit calls shows the specific query that took most of the time.</li><li>You can see the full SQL statement along with the SQL parameter values</li></ol><p>You can read more about the Browser Snapshots <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-app-dashboard/browser-snapshots_1 rel=external><strong>here</strong></a> and <a href=https://help.splunk.com/en/appdynamics-saas/end-user-monitoring/25.7.0/end-user-monitoring/browser-monitoring/browser-app-dashboard/browser-snapshots_1/page-snapshots rel=external><strong>here</strong></a>.</p><p><a href=#R-image-11ad75de3bfbb072f4fd3a2b306e8242 class=lightbox-link><img alt="BRUM Dash 9" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-09.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-11ad75de3bfbb072f4fd3a2b306e8242><img alt="BRUM Dash 9" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/4-brum-monitoring/5-monitor-and-troubleshoot-part-2/images/06-brum-dashboard-09.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=database-monitoring>Database Monitoring</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=objectives>Objectives</h2><p>In this Lab you learn about AppDynamics Database Visibility Monitoring.</p><p>When you have completed this lab, you will be able to:</p><ul><li>Download the AppDynamics Database Visibility Agent.</li><li>Install the AppDynamics Database Visibility Agent.</li><li>Configure a Database Collector in the Controller.</li><li>Monitor the health of your databases.</li><li>Troubleshoot database performance issues.</li></ul><h2 id=workshop-environment>Workshop Environment</h2><p>The lab environment has two hosts:</p><ul><li>The first host runs the AppDynamics Controller and will be referred to from this point on as the Controller.</li><li>The second host runs the Supercar Trader application used in the labs. It will be the host where you will install the AppDynamics agents and will be referred to from this point on as the Application VM.</li></ul><h2 id=controller-vm>Controller VM</h2><p>You will be using the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> for this workshop.</p><p><a href=#R-image-20fae1ee0341a650ecc9ff78d57a85b8 class=lightbox-link><img alt=Controller class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/images/controller-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-20fae1ee0341a650ecc9ff78d57a85b8><img alt=Controller class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/images/controller-vm.png></a></p><h2 id=application-vm>Application VM</h2><p>Supercar Trader is a Java-based Web Application</p><p>The purpose of Supercar-Trader collection is to generate dynamic traffic (business transactions) for AppDynamics Controller.</p><p><a href=#R-image-b8373a8a17dc1c6312123cb608fbefc6 class=lightbox-link><img alt=Application class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/images/application-vm.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8373a8a17dc1c6312123cb608fbefc6><img alt=Application class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/images/application-vm.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Database Monitoring</h1><article class=default><header class=headline></header><h1 id=lab-prerequisite>Lab Prerequisite</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>3 minutes</span>
</span>&nbsp;<p>In this exercise you will complete the following tasks:</p><ul><li>Access your AppDynamics Controller from your web browser.</li><li>Verify transaction load to the application.</li><li>Restart the application and transaction load if needed.</li></ul><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=verify-transaction-load-to-the-application>Verify transaction load to the application</h2><p>Check the application flow map:</p><ol><li>Select the <strong>last 1 hour</strong> time frame.</li><li>Verify you see the five different Tiers on the flow map.</li><li>Verify there has been consistent load over the last 1 hour.</li></ol><p><a href=#R-image-fd4f6cb02dbae4be0d33f3a1546dfe77 class=lightbox-link><img alt="Verify Load 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereque-appload.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-fd4f6cb02dbae4be0d33f3a1546dfe77><img alt="Verify Load 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereque-appload.png></a></p><p>Check the list of business transactions:</p><ol start=4><li>Click the <strong>Business Transactions</strong> option on the left menu.</li><li>Verify you see the eleven business transactions seen below.</li><li>Verify that they have some number of calls during the last hour.</li></ol><p><strong>Note:</strong> If you donâ€™t see the <strong>Calls</strong> column, you can click the <strong>View Options</strong> toolbar button to show that column.</p><p><a href=#R-image-5e1810106116cd4a3cd4da8487bf7033 class=lightbox-link><img alt="Verify Business transactions" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereq-bts.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e1810106116cd4a3cd4da8487bf7033><img alt="Verify Business transactions" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereq-bts.png></a></p><p>Check the agent status for the Nodes:</p><ol start=7><li>Click the <strong>Tiers & Nodes</strong> option on the left menu.</li><li>Click <strong>Grid View</strong>.</li><li>Verify that the <strong>App Agent Status</strong> for each Node is greater than 90% during the last hour.</li></ol><p><a href=#R-image-2ffe3eed31d9192f559b8102f6a57cdc class=lightbox-link><img alt="Verify Agents" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereq-tiersnodes.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2ffe3eed31d9192f559b8102f6a57cdc><img alt="Verify Agents" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/01-prereq-tiersnodes.png></a></p><h2 id=restart-the-application-and-load-generation-if-needed>Restart the Application and Load Generation if Needed</h2><p>If any of the checks you performed in the previous steps could not be verified, SSH into your <strong>Application VM</strong> and follow these steps to restart the application and transaction load.</p><p>Use the following commands to stop the running instance of Apache Tomcat.<div class=tab-panel data-tab-group=R-tabs-579469e8e14b30386d77c6bf56040e00><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-431541dc4865c533d1d8cbf312d66977 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-579469e8e14b30386d77c6bf56040e00","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-431541dc4865c533d1d8cbf312d66977 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./shutdown.sh</span></span></code></pre></div></div></div></div></div></p><p>Use the command below to check for remaining application JVMs still running.</p><div class=tab-panel data-tab-group=R-tabs-0334bb68768528c2c5aca49fe8db0d01><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bc2d0d502f9cd25e93bcc17b769c76f1 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-0334bb68768528c2c5aca49fe8db0d01","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-bc2d0d502f9cd25e93bcc17b769c76f1 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ps -ef <span class=p>|</span> grep Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>If you find any remaining application JVMs still running, kill the remaining JVMs using the command below.</p><div class=tab-panel data-tab-group=R-tabs-10bbff9be4a1a843d28aad007db4d220><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-2defae4f8528f9db6b78077224a53514 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-10bbff9be4a1a843d28aad007db4d220","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span></button></div><div class=tab-content-container><div id=R-tab-id-2defae4f8528f9db6b78077224a53514 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo pkill -f Supercar-Trader</span></span></code></pre></div></div></div></div></div><p>Use the following commands to stop the load generation for the application. Wait until all processes are stopped.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./stop_load.sh</span></span></code></pre></div><p>Restart the Tomcat server:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /usr/local/apache/apache-tomcat-9/bin
</span></span><span class=line><span class=cl>./startup.sh</span></span></code></pre></div><p>Wait for two minutes and use the following command to ensure Apache Tomcat is running on port 8080.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo netstat -tulpn <span class=p>|</span> grep LISTEN</span></span></code></pre></div><p>You should see output similar to the following image showing that port 8080 is in use by Apache Tomcat.</p><p><a href=#R-image-dfe17bddedc16e05243f158928bead3f class=lightbox-link><img alt="Restart App 1" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/restart-app-and-load-01.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dfe17bddedc16e05243f158928bead3f><img alt="Restart App 1" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/restart-app-and-load-01.png></a></p><p>Use the following commands to start the load generation for the application.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/lab-artifacts/phantomjs
</span></span><span class=line><span class=cl>./start_load.sh</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-5e1422d940ad847df6bbee112af67f3d class=lightbox-link><img alt="Restart App 3" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/restart-app-and-load-03.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5e1422d940ad847df6bbee112af67f3d><img alt="Restart App 3" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/1-lab-prerequisites/images/restart-app-and-load-03.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=download-database-agent>Download Database Agent</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>In this exercise you will access your AppDynamics Controller from your web browser and download the Database Visibility agent from there.</p><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=download-the-database-agent>Download the Database Agent</h2><ol><li>Select the Home tab at the top left of the screen.</li><li>Select the <strong>Getting Started</strong> tab.</li><li>Click <strong>Getting Started Wizard</strong>.</li></ol><p><a href=#R-image-bb5e8ef55bde11dd2e6475512c50134c class=lightbox-link><img alt="Getting Started" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-gettingstarted.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-bb5e8ef55bde11dd2e6475512c50134c><img alt="Getting Started" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-gettingstarted.png></a></p><ol start=4><li>Click <strong>Databases</strong>.</li></ol><p><a href=#R-image-4b61da1477c3a2326f2130e2ffac72a0 class=lightbox-link><img alt="Select Agent" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-db-agent.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4b61da1477c3a2326f2130e2ffac72a0><img alt="Select Agent" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-db-agent.png></a></p><h2 id=download-the-database-agent-1>Download the Database Agent.</h2><ol start=5><li>Select <strong>MySQL</strong> from the Select Database Type dropdown menu.</li><li>Accept the defaults for the Controller connection.</li><li>Click <strong>Click Here to Download</strong>.</li></ol><p><a href=#R-image-3e85011d369898c008c4383fdb99855e class=lightbox-link><img alt=Download class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-download.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3e85011d369898c008c4383fdb99855e><img alt=Download class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-download.png></a></p><p>Save the Database Visibility Agent file to your local file system.</p><p>Your browser should prompt you to save the agent file to your local file system, similar to the following image(depending on your OS).</p><p><a href=#R-image-1fefdb2035b5813010b534337c770906 class=lightbox-link><img alt=Save class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-local-agent.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1fefdb2035b5813010b534337c770906><img alt=Save class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/2-download-database-agent/images/04-download-local-agent.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=install-database-agent>Install Database Agent</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<p>The AppDynamics Database Agent is a standalone Java program that collects performance metrics about your database instances and database servers. You can deploy the Database Agent on any machine running Java 1.8 or higher. The machine must have network access to the AppDynamics Controller and the database instance that you want to be monitored.</p><p>A database agent running on a typical machine with 16 GB of memory can monitor about 25 databases. On larger machines, a database agent can monitor up to 200 databases.</p><p>In this exercise you will perform the following tasks:</p><ul><li>Upload the Database Visibility agent file to your Application VM</li><li>Unzip the file into a specific directory on the file system</li><li>Start the Database Visibility agent</li></ul><h2 id=upload-database-agent-to-the-application-vm>Upload Database Agent to The Application VM</h2><p>By this point you should have received the information regarding the EC2 instance that you will be using for this workshop. Ensure you have the IP address of your EC2 instance, username and password required to ssh into the instance .</p><p>On your local machine, open a terminal window and change into the directory where the database agent file was downloaded to. Upload the file into the EC2 instance using the following command. This may take some time to complete. If you are in a Windows OS, you may have to use a programm such as WinSCP.</p><ul><li>Update the IP address or public DNS for your instance.</li><li>Update the filename to match your exact version.</li></ul><div class=tab-panel data-tab-group=R-tabs-dda01b97d5d2b206033c50da44263d80><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bcc14855b0dc01ba98782aa6ee34aa75 aria-expanded=true data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-dda01b97d5d2b206033c50da44263d80","R-tab-ee97be03cb04119af45014d815621ce1")'>
<span class=tab-nav-text>Command</span>
</button>
<button aria-controls=R-tab-id-6295daaf4cdc6b879b7b7ad182d82cd6 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-dda01b97d5d2b206033c50da44263d80","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-bcc14855b0dc01ba98782aa6ee34aa75 data-tab-item=R-tab-ee97be03cb04119af45014d815621ce1 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/Downloads
</span></span><span class=line><span class=cl>scp -P <span class=m>2222</span> db-agent-*.zip splunk@i-0267b13f78f891b64.splunk.show:/home/splunk</span></span></code></pre></div></div></div><div id=R-tab-id-6295daaf4cdc6b879b7b7ad182d82cd6 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>splunk@i-0267b13f78f891b64.splunk.show<span class=err>&#39;</span>s password:
</span></span><span class=line><span class=cl>db-agent-25.7.0.5137.zip                                                                                                                               100%   70MB   5.6MB/s   00:12</span></span></code></pre></div></div></div></div></div><h2 id=install-the-database-agent>Install the Database Agent</h2><p>Create the directory structure where you will unzip the Database agent zip file.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics
</span></span><span class=line><span class=cl>mkdir dbagent</span></span></code></pre></div><p>Use the following commands to copy the Database agent zip file to the directory and unzip the file. The name of your Database agent file may be slightly different than the example below.</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp ~/db-agent-*.zip /opt/appdynamics/dbagent/
</span></span><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/dbagent
</span></span><span class=line><span class=cl>unzip db-agent-*.zip</span></span></code></pre></div><h2 id=start-the-database-visibility-agent>Start the Database Visibility agent</h2><p>Use the following commands to start the Database agent and verify that it started.</p><p><strong>Append your inititals to the db agent name</strong>, this will be used in the following section. example: DBMon-Lab-Agent-IO</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/dbagent
</span></span><span class=line><span class=cl>nohup java -Dappdynamics.agent.maxMetrics<span class=o>=</span><span class=m>300000</span> -Ddbagent.name<span class=o>=</span>DBMon-Lab-Agent-YOURINITIALS -jar db-agent.jar <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>ps -ef <span class=p>|</span> grep db-agent</span></span></code></pre></div><p>You should see output similar to the following image.</p><p><a href=#R-image-8cd08488b8c3b6dc4a77fc3154b98889 class=lightbox-link><img alt=Output class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/3-install-database-agent/images/04-dbagent-install.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8cd08488b8c3b6dc4a77fc3154b98889><img alt=Output class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/3-install-database-agent/images/04-dbagent-install.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=configure-database-collector>Configure Database Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=configure-database-collector>Configure Database Collector</h2><p>The Database Agent Collector is the process that runs within the Database Agent to collect performance metrics about your database instances and database servers. One collector collects metrics for one database instance. Multiple collectors can run in one Database Agent. Once the Database Agent is connected to the Controller one or more collectors can be configured in the Controller.</p><p>In this exercise you will perform the following tasks:</p><ul><li>Access your AppDynamics Controller from your web browser</li><li>Configure a Database Collector in the Controller</li><li>Confirm the Database Collector is collecting data</li></ul><h2 id=login-to-the-controller>Login to the Controller</h2><p>Log into the <a href=https://se-lab.saas.appdynamics.com/controller/ rel=external>AppDynamics SE Lab Controller</a> using your Cisco credentials.</p><h2 id=configure-a-database-collector-in-the-controller>Configure a Database Collector in the Controller</h2><p>Use the following steps to change the settings for the query literals and navigate to the collectors configuration.</p><ol><li>Click the <strong>Databases</strong> tab on the left menu.</li><li>Click the <strong>Configuration</strong> tab on the bottom left.</li><li>Uncheck the checkbox for <strong>Remove literals from the queries</strong>.</li><li>Click the <strong>Collectors</strong> option.</li></ol><p><a href=#R-image-77d8f523101f06d871549849804c8908 class=lightbox-link><img alt=Configuration class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-configure-collector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-77d8f523101f06d871549849804c8908><img alt=Configuration class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-configure-collector.png></a></p><p>Use the following steps to configure a new Database collector.</p><ol start=6><li>Click <strong>Add</strong> button.</li><li>Select <strong>MySQL</strong> for the database type.</li><li>Select <strong>DBMon-Lab-Agent</strong> for the database agent and enter the following parameters.</li><li>Collector Name: <strong>Supercar-MySQL-YOURINITIALS</strong></li><li>Hostname or IP Address: <strong>localhost</strong></li><li>Listener Port: <strong>3306</strong></li></ol><p><a href=#R-image-38d09c43cbe04f352131687615f20a32 class=lightbox-link><img alt=Configuration1 class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-collector-config1.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-38d09c43cbe04f352131687615f20a32><img alt=Configuration1 class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-collector-config1.png></a></p><ol start=12><li>Username: <strong>root</strong></li><li>Password: <strong>Welcome1!</strong></li></ol><p><a href=#R-image-01a66af00a5358e0aa88bc9f1aec4f2b class=lightbox-link><img alt=Configuration2 class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-username.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-01a66af00a5358e0aa88bc9f1aec4f2b><img alt=Configuration2 class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-username.png></a></p><ol start=14><li>Select the <strong>Monitor Operating System</strong> checkbox under the <strong>Advanced Options</strong></li><li>Select <strong>Linux</strong> as the operating system and enter the following parameters.</li><li>SSH Port: <strong>22</strong></li><li>Username: <strong>splunk</strong></li><li>Password: <strong>Password Provided by Your Instructor to SSH into the EC2 Instance</strong></li><li>Click <strong>OK</strong> to save the collector.</li></ol><p><a href=#R-image-7abbb5f175ec4208343e375346c876c3 class=lightbox-link><img alt="Advance Options" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-advance-options.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7abbb5f175ec4208343e375346c876c3><img alt="Advance Options" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/05-db-advance-options.png></a></p><h2 id=confirm-that-the-database-collector-is-collecting-data>Confirm that the Database Collector is collecting data</h2><p>Wait for ten minutes to allow the collector to run and submit data, then follow these steps to verify that the database collector is connecting to the database and collecting database metrics.</p><ol><li>Click the <strong>Databases</strong> tab on the left menu</li><li>Search for the Collector created in the previous section: <strong>Supercar-MySQL-YOURINITIALS</strong></li><li>Ensure the status is green and there are no errors shown.</li><li>Click the Supercar-MySQL link to drill into the database.</li></ol><p><em>Note: It may take up to 18 minutes from the time you configure your collector to see the Top 10 SQL Wait States and any queries on the Queries tab.</em></p><p><a href=#R-image-8106483dd533d184d0e570ec4907e1b6 class=lightbox-link><img alt=Application class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/04-db-db-controller.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8106483dd533d184d0e570ec4907e1b6><img alt=Application class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/04-db-db-controller.png></a></p><p><a href=#R-image-a0a4c5298589d8dea0db12496f975545 class=lightbox-link><img alt=Application class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/04-db-db-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a0a4c5298589d8dea0db12496f975545><img alt=Application class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/4-configure-database-collector/images/04-db-db-dashboard.png></a></p><p>You can read more about configuring Database Collectors <a href=https://docs.appdynamics.com/appd/24.x/latest/en/database-visibility/add-database-collectors rel=external>here</a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-and-troubleshoot---part-1>Monitor and Troubleshoot - Part 1</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=monitor-and-troubleshoot---part-1>Monitor and Troubleshoot - Part 1</h2><p>In this exercise you will perform the following tasks:</p><ul><li>Review the Overall Database and Server Performance Dashboard</li><li>Review the Main Database Dashboard</li><li>Review the Reports in the Database Activity Window</li></ul><h2 id=review-the-overall-database-and-server-performance-dashboard>Review the Overall Database and Server Performance Dashboard</h2><p>The Overall Database and Server Performance Dashboard allows you to quickly see the health of each database at a glance.</p><ol><li>Filters: Enables you to explore the options to filter by health, load, time in database or type.</li><li>Actions: Exports the data on this window in a .csv formatted file.</li><li>View Options: Toggles the spark charts on and off.</li><li>View: Switches between the card and list view.</li><li>Sort: Displays the sorting options.</li><li>Supercar-MySQL: Drills into the main database dashboard.</li></ol><p><a href=#R-image-5c8eede25d52bb98ff691fc82aa325c8 class=lightbox-link><img alt="Overall Database and Server Performance Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-collector.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5c8eede25d52bb98ff691fc82aa325c8><img alt="Overall Database and Server Performance Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-collector.png></a></p><h2 id=review-the-main-database-dashboard>Review the Main Database Dashboard</h2><p>The main database dashboard shows you key insights for the database including:</p><ul><li>The health of the server that is running the database.</li><li>The total number of calls during the specified time period.</li><li>The number of calls for any point in time.</li><li>The total time spent executing SQL statements during the specified time period.</li><li>The top ten query wait states.</li><li>The average number of connections.</li><li>The database type or vendor.</li><li>Explore the features of the dashboard.</li></ul><ol><li>Click the health status circle to see details of the server health:</li></ol><ul><li>Green: server is healthy.</li><li>Yellow: server with warning-level violations.</li><li>Red: server with critical-level violations.</li></ul><ol start=2><li>The database type or vendor will always be seen here.</li><li>Observe the total time spent executing SQL statements during the specified time period.</li><li>Observe the total number of executions during the specified time period.</li><li>Hover over the time series on the chart to see the detail of the recorded metrics.</li></ol><p>Click the orange circle at the top of the data point to view the time comparison report, which shows query run times and wait states 15 minutes before and 15 minutes after the selected time.</p><ol start=6><li>Left-click and hold down your mouse button while dragging from left to right to highlight a spike seen in the chart.</li><li>Click the configuration button to exclude unwanted wait states from the top ten.</li><li>Hover over the labels for each wait state to see a more detailed description.</li><li>Observe the average number of active connections actively running a query during the selected time period.</li></ol><p><a href=#R-image-e57b75df3c487671c46f7f9746b79e5f class=lightbox-link><img alt="Main Database Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e57b75df3c487671c46f7f9746b79e5f><img alt="Main Database Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-overview.png></a></p><p>To view the OS metrics of the DB server for the time period that you have selected:</p><ol><li>Scroll to the bottom of the dashboard using the scroll bar on the right</li><li>CPU</li><li>Memory</li><li>Disk IO</li><li>Network IO</li></ol><p><a href=#R-image-3b1c6d33ca049a3100021c70e6ca9727 class=lightbox-link><img alt="OS Metrics" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-os-metrics.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b1c6d33ca049a3100021c70e6ca9727><img alt="OS Metrics" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-os-metrics.png></a></p><h2 id=review-the-reports-in-the-database-activity-window>Review the Reports in the Database Activity Window</h2><p>There are up to nine different reports available in Database Visibility on the Database Activity Window. The reports available depend on the database platform being monitored. In this exercise we will review three of the most common reports.</p><ul><li>Wait State Report</li><li>Top Activity Report</li><li>Query Wait State Report</li></ul><h2 id=wait-state-report>Wait State Report</h2><p>This report displays time-series data on Wait Events (states) within the database. Each distinct wait is color-coded, and the Y-axis displays time in seconds. This report also displays data in a table and highlights the time spent in each wait state for each SQL statement.</p><p>The wait states consuming the most time may point to performance bottlenecks. For example, db file sequential reads may be caused by segment header contention on indexes or by disk contention.</p><p><a href=#R-image-e1ea2f78b54c77279f156141a16d6d3e class=lightbox-link><img alt="Wait State" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-waitstate.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e1ea2f78b54c77279f156141a16d6d3e><img alt="Wait State" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-waitstate.png></a></p><h2 id=top-activity-report>Top Activity Report</h2><p>This report displays the top time in database SQL statements in a time-series view. This report also displays data in a table and highlights the time spent in the database for each of 10 top SQL statements.</p><p>Use this report to see which SQL statements are using the most database time. This helps to determine the impact of specific SQL statements on overall system performance allowing you to focus your tuning efforts on the statements that have the most impact on database performance.</p><p><a href=#R-image-b6d28ae4132c080e1bc99d13dd986506 class=lightbox-link><img alt="Top Activity Report" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-top-activity.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b6d28ae4132c080e1bc99d13dd986506><img alt="Top Activity Report" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-top-activity.png></a></p><h2 id=query-wait-state-report>Query Wait State Report</h2><p>This report displays the wait times for the top (10, 50, 100, 200) queries. This report also displays data in a table and highlights the time each query is spending in different wait states. Use the columns to sort the queries by the different wait states.</p><p>You can read more about the Reports in the Database Activity Window <a href=https://help.splunk.com/en/appdynamics-on-premises/database-visibility/25.4.0/monitor-databases-and-database-servers/monitor-database-performance/database-activity-window/features-of-the-database-activity-windows rel=external>here</a></p><p><a href=#R-image-85dc09fe8d72fe41885731870cd48a77 class=lightbox-link><img alt="Query Wait State Report" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-query-waitstate.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-85dc09fe8d72fe41885731870cd48a77><img alt="Query Wait State Report" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/5-monitor-and-troubleshoot-option-1/images/04-db-query-waitstate.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=monitor-and-troubleshoot---part-2>Monitor and Troubleshoot - Part 2</h1><h2 id=review-the-queries-dashboard>Review the Queries Dashboard</h2><p>The Queries window displays the SQL statements and stored procedures that consume the most time in the database. You can compare the query weights to other metrics such as SQL wait times to determine SQL that requires tuning.</p><ol><li><strong>Queries</strong> tab: Displays the queries window.</li><li><strong>Top Queries</strong> dropdown: Displays the top 5, 10, 100 or 200 queries.</li><li><strong>Filter by Wait States</strong>: Enables you to choose wait states to filter the Query list.</li><li><strong>Group Similar</strong>: Groups together queries with the same syntax.</li><li>Click on the query that shows the largest <strong>Weight (%)</strong> used.</li><li><strong>View Query Details</strong>: Drills into the query details.</li></ol><p><a href=#R-image-15ae9f1281f8f983a97fab0c6be19ee5 class=lightbox-link><img alt="Queries Dashboard" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-overview.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-15ae9f1281f8f983a97fab0c6be19ee5><img alt="Queries Dashboard" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-overview.png></a></p><h2 id=review-the-details-of-an-expensive-query>Review the details of an expensive query</h2><p>Once you have identified the statements on the Database Queries window that are spending the most amount of time in the database, you can dig down deeper for details that can help you tune those SQL statements. The database instance Query Details window displays details about the query selected on the Database Queries window.</p><ol><li><strong>Resource consumption over time</strong>: Displays the amount of time the query spent in the database using resources, the number of executions, and the amount of CPU time consumed.</li><li><strong>Wait states</strong>: The activities that contribute to the time it takes the database to service the selected SQL statement. The wait states consuming the most time may point to performance bottlenecks.</li><li><strong>Components Executing Similar Queries</strong>: Displays the Nodes that execute queries similar to this query.</li><li><strong>Business Transactions Executing Similar Queries</strong>: Displays the Java business transactions that execute queries similar to this query.</li></ol><p><a href=#R-image-355436312e1d86b1c52940650c117730 class=lightbox-link><img alt="Expensive Query Details" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-355436312e1d86b1c52940650c117730><img alt="Expensive Query Details" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-details.png></a></p><ol><li>Use the outer scroll bar on the right to scroll down.</li><li><strong>Clients</strong>: Displays the machines that executed the selected SQL statement and the percentage of the total time required to execute the statement performed by each machine.</li><li><strong>Sessions</strong>: Session of each database instance usage</li><li><strong>Query Active in Database</strong>: Displays the schemas that have been accessed by this SQL.</li><li><strong>Users</strong>: Displays the users that executed this query.</li><li><strong>Query Hashcode</strong>: Displays the unique ID for the query that allows the database server to more quickly locate this SQL statement in the cache.</li><li><strong>Query</strong>: Displays the entire syntax of the selected SQL statement. You can click the pencil icon in the top right corner of the Query card to edit the query name so that it is easy to identify.</li><li><strong>Execution Plan</strong>: Displays the the query execution plan window.</li></ol><p><a href=#R-image-8c7f2070557db2e631747e553744ad3c class=lightbox-link><img alt="Expensive Query Details2" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-details2.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8c7f2070557db2e631747e553744ad3c><img alt="Expensive Query Details2" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-queries-details2.png></a></p><h2 id=troubleshoot-an-expensive-query>Troubleshoot an expensive query</h2><p>The Database Query Execution Plan window can help you to determine the most efficient execution plan for your queries. Once youâ€™ve discovered a potentially problematic query, you can run the EXPLAIN PLAN statement to check the execution plan that the database created.</p><p>A queryâ€™s execution plan reveals whether the query is optimizing its use of indexes and executing efficiently. This information is useful for troubleshooting queries that are executing slowly.</p><ol><li>Click on the <strong>Execution Plan</strong> tab</li><li>Notice that the join type in the <strong>Type</strong> column is ALL for each table.</li><li>Hover over one of the join types to see the description for the join type.</li><li>Examine the entries in the <strong>Extras</strong> column.</li><li>Hover over each of the entries to see the description for the entry.</li></ol><p><a href=#R-image-93393ef58559336d7cea267a5c3c338b class=lightbox-link><img alt="Troubleshoot Expensive Query" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-execution-plan.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93393ef58559336d7cea267a5c3c338b><img alt="Troubleshoot Expensive Query" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-execution-plan.png></a></p><p>Letâ€™s investigate the indexes on the table using the Obect Browser next.</p><ol start=5><li>Click on the <strong>Object Browser</strong> option to view details of the schema for the tables</li><li>Click the <strong>Database</strong> option.</li><li>Click on the <strong>supercars</strong> schema to expand the list of tables.</li><li>Click on the <strong>CARS</strong> table to see the details of the table.</li><li>You can see that the CAR_ID column is defined as the primary key</li></ol><p><a href=#R-image-a1cbf32923778a7ed65b6a2f44d77cde class=lightbox-link><img alt="Troubleshoot Expensive Query" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-object-browser.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a1cbf32923778a7ed65b6a2f44d77cde><img alt="Troubleshoot Expensive Query" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-object-browser.png></a></p><ol start=10><li>Use the outer scroll bar to scroll down the page.</li><li>Notice the primary key index defined in the table.</li></ol><p><a href=#R-image-c7e9c3448498f170873ed1d6daf6c6ee class=lightbox-link><img alt="Troubleshoot Car Index" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-cars-index.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c7e9c3448498f170873ed1d6daf6c6ee><img alt="Troubleshoot Car Index" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-cars-index.png></a></p><ol start=12><li>Click on the <strong>MANUFACTURER</strong> table to view its details.</li><li>Notice the <strong>MANUFACTURER_ID</strong> column is not defined as a primary key.</li><li>Scroll down the page to see there are no indexes defined for the table.</li></ol><p><a href=#R-image-3316440b4941fc619d1cac3db4a7d711 class=lightbox-link><img alt="Troubleshoot Expensive Query" class="lazy lightbox figure-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-man-table.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3316440b4941fc619d1cac3db4a7d711><img alt="Troubleshoot Expensive Query" class="lazy lightbox lightbox-image" loading=lazy src=/observability-workshop/en/ninja-workshops/15-appd-workshop/5-database-monitoring/6-monitor-and-troubleshoot-option-2/images/04-db-man-table.png></a></p><p>The MANUFACTURER_ID column needs an index created for it to improve the performance of any queries on the table. If you analyzed a different query the underlying issue may be different but the most common issues shown in this lab come because the queries are either executing a join with the MANUFACTURER table or querying that table directly.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Oct 13, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=smartagent-deployment>SmartAgent Deployment</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>AppDynamics <strong>Smart Agent</strong> is a lightweight, intelligent agent that provides comprehensive monitoring capabilities for your infrastructure. This section covers three different deployment approaches, allowing you to choose the method that best fits your organization&rsquo;s needs and existing tooling.</p><p><a href=#R-image-dc5fb98436ccb7f8e433916bf516707a class=lightbox-link><img alt=AppDynamics class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dc5fb98436ccb7f8e433916bf516707a><img alt=AppDynamics class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat"></a></p><h2 id=what-is-smart-agent>What is Smart Agent?</h2><p>Smart Agent is AppDynamics&rsquo; next-generation monitoring agent that provides:</p><ul><li><strong>Unified Monitoring</strong>: Single agent for infrastructure, applications, and services</li><li><strong>Lightweight Design</strong>: Minimal resource footprint</li><li><strong>Auto-Discovery</strong>: Automatically discovers and monitors applications</li><li><strong>Native Instrumentation</strong>: Deep visibility into application performance</li><li><strong>Flexible Deployment</strong>: Multiple installation and management options</li></ul><h2 id=deployment-approaches>Deployment Approaches</h2><p>This section covers three distinct approaches to deploying Smart Agent at scale:</p><h3 id=1-remote-installation-smartagentctl>1. Remote Installation (smartagentctl)</h3><p>The most direct approach using the <code>smartagentctl</code> CLI tool to deploy via SSH.</p><p><strong>Best for:</strong></p><ul><li>Quick deployments to a moderate number of hosts</li><li>Environments without existing CI/CD infrastructure</li><li>Testing and proof-of-concept scenarios</li><li>Direct control over deployment process</li></ul><p><strong>Key Features:</strong></p><ul><li>Direct SSH-based deployment</li><li>Simple YAML configuration</li><li>No additional tooling required</li><li>Concurrent execution support</li></ul><h3 id=2-jenkins-automation>2. Jenkins Automation</h3><p>Enterprise-grade deployment using Jenkins pipelines for complete lifecycle management.</p><p><strong>Best for:</strong></p><ul><li>Organizations already using Jenkins</li><li>Complex deployment workflows</li><li>Environments requiring approval gates</li><li>Integration with existing CI/CD pipelines</li></ul><p><strong>Key Features:</strong></p><ul><li>Parameterized pipelines</li><li>Batch processing for thousands of hosts</li><li>Complete lifecycle management</li><li>Centralized logging and reporting</li></ul><h3 id=3-github-actions-automation>3. GitHub Actions Automation</h3><p>Modern CI/CD approach using GitHub Actions workflows with self-hosted runners.</p><p><strong>Best for:</strong></p><ul><li>Teams using GitHub for version control</li><li>Cloud-native environments</li><li>GitOps workflows</li><li>Distributed teams preferring web-based management</li></ul><p><strong>Key Features:</strong></p><ul><li>11 specialized workflows</li><li>Self-hosted runner in your VPC</li><li>GitHub secrets integration</li><li>Automatic batching for scalability</li></ul><h2 id=choosing-the-right-approach>Choosing the Right Approach</h2><table><thead><tr><th>Factor</th><th>Remote Installation</th><th>Jenkins</th><th>GitHub Actions</th></tr></thead><tbody><tr><td><strong>Setup Complexity</strong></td><td>Low</td><td>Medium</td><td>Medium</td></tr><tr><td><strong>Scalability</strong></td><td>Good (100s of hosts)</td><td>Excellent (1000s)</td><td>Excellent (1000s)</td></tr><tr><td><strong>Prerequisites</strong></td><td>SSH access only</td><td>Jenkins server</td><td>GitHub account</td></tr><tr><td><strong>Learning Curve</strong></td><td>Minimal</td><td>Moderate</td><td>Moderate</td></tr><tr><td><strong>Automation Level</strong></td><td>Manual execution</td><td>Full automation</td><td>Full automation</td></tr><tr><td><strong>Best Use Case</strong></td><td>Quick deployments</td><td>Enterprise CI/CD</td><td>Modern DevOps</td></tr></tbody></table><h2 id=common-features-across-all-approaches>Common Features Across All Approaches</h2><p>Regardless of which deployment method you choose, all approaches provide:</p><ul><li>âœ… <strong>SSH-based deployment</strong> to remote hosts</li><li>âœ… <strong>Concurrent execution</strong> for faster deployment</li><li>âœ… <strong>Complete lifecycle management</strong> (install, start, stop, uninstall)</li><li>âœ… <strong>Configuration management</strong> for controller settings</li><li>âœ… <strong>Error handling</strong> and logging</li><li>âœ… <strong>Scalability</strong> to hundreds or thousands of hosts</li></ul><h2 id=workshop-structure>Workshop Structure</h2><p>Each deployment approach has its own dedicated section:</p><ol><li><strong>Remote Installation</strong> - Direct CLI-based deployment</li><li><strong>Jenkins Automation</strong> - Pipeline-based enterprise deployment</li><li><strong>GitHub Actions</strong> - Modern workflow-based deployment</li></ol><p>You can follow one or all approaches depending on your needs.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>If you&rsquo;re new to Smart Agent deployment, we recommend starting with the <strong>Remote Installation</strong> approach to understand the basics before moving to more automated solutions.</p></div></details><h2 id=prerequisites>Prerequisites</h2><p>Before proceeding with any deployment approach, ensure you have:</p><ul><li>AppDynamics account with controller access</li><li>Account name and access key</li><li>Target hosts with SSH access</li><li>Network connectivity from hosts to AppDynamics Controller</li><li>Appropriate permissions on target hosts</li></ul><h2 id=next-steps>Next Steps</h2><p>Choose your preferred deployment approach and proceed to that section:</p><ul><li><strong>Start Simple</strong>: Begin with Remote Installation to learn the fundamentals</li><li><strong>Scale with Jenkins</strong>: Move to Jenkins for enterprise-grade automation</li><li><strong>Modernize with GitHub</strong>: Adopt GitHub Actions for cloud-native workflows</li></ul><p>Each section provides complete, hands-on guidance for deploying Smart Agent at scale!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of SmartAgent Deployment</h1><article class=default><header class=headline></header><h1 id=remote-installation>Remote Installation</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>This workshop demonstrates how to use the <strong>smartagentctl</strong> command-line tool to install and manage <strong>AppDynamics Smart Agent</strong> on multiple remote hosts simultaneously. This approach is ideal for quickly deploying Smart Agent to a fleet of servers using SSH-based remote execution, without the need for additional automation tools like Jenkins or GitHub Actions.</p><p><a href=#R-image-b8b49db9384ddc69c812a37397ff3903 class=lightbox-link><img alt=AppDynamics class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b8b49db9384ddc69c812a37397ff3903><img alt=AppDynamics class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat"></a></p><h2 id=what-youll-learn>What You&rsquo;ll Learn</h2><p>In this workshop, you&rsquo;ll learn how to:</p><ul><li><strong>Configure remote hosts</strong> using the <code>remote.yaml</code> file</li><li><strong>Configure Smart Agent settings</strong> using <code>config.ini</code></li><li><strong>Deploy Smart Agent</strong> to multiple hosts simultaneously via SSH</li><li><strong>Start and stop agents</strong> remotely across your infrastructure</li><li><strong>Check agent status</strong> on all remote hosts</li><li><strong>Troubleshoot</strong> common installation and connectivity issues</li></ul><h2 id=key-features>Key Features</h2><ul><li>ðŸš€ <strong>Direct SSH Deployment</strong> - No additional automation platform required</li><li>ðŸ”„ <strong>Complete Lifecycle Management</strong> - Install, start, stop, and uninstall agents</li><li>ðŸ—ï¸ <strong>Configuration as Code</strong> - YAML and INI-based configuration files</li><li>ðŸ” <strong>Secure</strong> - SSH key-based authentication</li><li>ðŸ“ˆ <strong>Concurrent Execution</strong> - Configurable concurrency for parallel deployment</li><li>ðŸŽ›ï¸ <strong>Simple CLI</strong> - Easy-to-use smartagentctl command-line interface</li></ul><h2 id=architecture-overview>Architecture Overview</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Remote Installation Architecture                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Control Node (smartagentctl) â”€â”€â–¶ SSH Connection               â”‚
â”‚                                          â”‚                       â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 1 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 2 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 3 (SSH)      â”‚
â”‚                                          â””â”€â”€â–¶ Host N (SSH)      â”‚
â”‚                                                                  â”‚
â”‚  All hosts send metrics â”€â”€â–¶ AppDynamics Controller             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h2 id=workshop-components>Workshop Components</h2><p>This workshop includes:</p><ol><li><strong>Prerequisites</strong> - Required access, tools, and permissions</li><li><strong>Configuration</strong> - Setting up <code>config.ini</code> and <code>remote.yaml</code></li><li><strong>Installation & Startup</strong> - Deploying and starting Smart Agent on remote hosts</li><li><strong>Troubleshooting</strong> - Common issues and solutions</li></ol><h2 id=prerequisites>Prerequisites</h2><ul><li>Control node with smartagentctl installed</li><li>SSH access to all remote hosts</li><li>SSH private key configured for authentication</li><li>Sudo privileges on the control node</li><li>Remote hosts with SSH enabled</li><li>AppDynamics account credentials</li></ul><h2 id=available-commands>Available Commands</h2><p>The <code>smartagentctl</code> tool supports the following remote operations:</p><ul><li><code>start --remote</code> - Install and start Smart Agent on remote hosts</li><li><code>stop --remote</code> - Stop Smart Agent on remote hosts</li><li><code>status --remote</code> - Check Smart Agent status on remote hosts</li><li><code>install --remote</code> - Install Smart Agent without starting</li><li><code>uninstall --remote</code> - Remove Smart Agent from remote hosts</li><li><code>--service</code> flag - Install as systemd service</li></ul><p>All commands support the <code>--verbose</code> flag for detailed logging.</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Remote Installation</h1><article class=default><header class=headline></header><h1 id=1-prerequisites>1. Prerequisites</h1><p>Before you begin installing Smart Agent on remote hosts, ensure you have the following prerequisites in place:</p><h2 id=required-access>Required Access</h2><ul><li><strong>SSH Access</strong>: You must have SSH access to all remote hosts where you plan to install Smart Agent</li><li><strong>SSH Private Key</strong>: A configured SSH private key for authentication</li><li><strong>Sudo Privileges</strong>: The control node user needs sudo privileges to run smartagentctl</li><li><strong>Remote SSH</strong>: Remote hosts must have SSH enabled and accessible</li></ul><h2 id=directory-structure>Directory Structure</h2><p>The Smart Agent installation directory should be set up on your control node:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/appdsm</span></span></code></pre></div><p>The directory contains:</p><ul><li><code>smartagentctl</code> - Command-line utility to manage SmartAgent</li><li><code>smartagent</code> - The SmartAgent binary</li><li><code>config.ini</code> - Main configuration file</li><li><code>remote.yaml</code> - Remote hosts configuration file</li><li><code>conf/</code> - Additional configuration files</li><li><code>lib/</code> - Required libraries</li></ul><h2 id=appdynamics-account-information>AppDynamics Account Information</h2><p>You&rsquo;ll need the following information from your AppDynamics account:</p><ul><li><strong>Controller URL</strong>: Your AppDynamics SaaS controller endpoint (e.g., <code>fso-tme.saas.appdynamics.com</code>)</li><li><strong>Account Name</strong>: Your AppDynamics account name</li><li><strong>Account Access Key</strong>: Your AppDynamics account access key</li><li><strong>Controller Port</strong>: Usually 443 for HTTPS connections</li></ul><h2 id=target-host-requirements>Target Host Requirements</h2><p>Your remote hosts should meet these requirements:</p><ul><li><strong>Operating System</strong>: Ubuntu/Linux-based systems</li><li><strong>SSH Server</strong>: SSH daemon running and accepting connections</li><li><strong>User Account</strong>: User account with appropriate permissions (typically root)</li><li><strong>Network Access</strong>: Ability to reach the AppDynamics Controller</li><li><strong>Disk Space</strong>: Sufficient space for Smart Agent installation (typically under 100MB)</li></ul><h2 id=security-considerations>Security Considerations</h2><p>Before proceeding, review these security best practices:</p><ol><li><strong>SSH Keys</strong>: Use strong SSH keys (RSA 4096-bit or ED25519)</li><li><strong>Access Keys</strong>: Store AccountAccessKey securely</li><li><strong>Host Key Validation</strong>: For production, plan to validate host keys</li><li><strong>SSL/TLS</strong>: Always use SSL/TLS for controller communication</li><li><strong>Log Files</strong>: Restrict access to log files containing sensitive information</li></ol><h2 id=verifying-prerequisites>Verifying Prerequisites</h2><h3 id=check-ssh-connectivity>Check SSH Connectivity</h3><p>Test SSH connectivity to your remote hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -i /home/ubuntu/.ssh/id_rsa ubuntu@&lt;remote-host-ip&gt;</span></span></code></pre></div><h3 id=verify-ssh-key-permissions>Verify SSH Key Permissions</h3><p>Ensure proper permissions on your SSH key:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>600</span> /home/ubuntu/.ssh/id_rsa</span></span></code></pre></div><h3 id=check-network-connectivity>Check Network Connectivity</h3><p>Verify that remote hosts can reach each other and the internet:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping &lt;remote-host-ip&gt;</span></span></code></pre></div><h3 id=verify-sudo-access>Verify Sudo Access</h3><p>Ensure you have sudo privileges:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo -v</span></span></code></pre></div><p>If all prerequisites are met, you&rsquo;re ready to proceed with configuration!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-configuration>2. Configuration</h1><p>Smart Agent remote installation requires two key configuration files: <code>config.ini</code> for Smart Agent settings and <code>remote.yaml</code> for defining remote hosts and connection parameters.</p><h2 id=configuration-files-overview>Configuration Files Overview</h2><p>Both configuration files should be located in the Smart Agent installation directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/appdsm</span></span></code></pre></div><p>The two files you&rsquo;ll configure:</p><ul><li><code>config.ini</code> - Smart Agent configuration deployed to all remote hosts</li><li><code>remote.yaml</code> - Remote hosts and SSH connection settings</li></ul><h2 id=configini---smart-agent-configuration>config.ini - Smart Agent Configuration</h2><p>The <code>config.ini</code> file contains the main Smart Agent configuration that will be deployed to all remote hosts.</p><p><strong>Location:</strong> <code>/home/ubuntu/appdsm/config.ini</code></p><h3 id=controller-configuration>Controller Configuration</h3><p>Configure your AppDynamics Controller connection:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>ControllerURL</span>    <span class=o>=</span> <span class=s>fso-tme.saas.appdynamics.com</span>
</span></span><span class=line><span class=cl><span class=na>ControllerPort</span>   <span class=o>=</span> <span class=s>443</span>
</span></span><span class=line><span class=cl><span class=na>FMServicePort</span>    <span class=o>=</span> <span class=s>443</span>
</span></span><span class=line><span class=cl><span class=na>AccountAccessKey</span> <span class=o>=</span> <span class=s>your-access-key-here</span>
</span></span><span class=line><span class=cl><span class=na>AccountName</span>      <span class=o>=</span> <span class=s>your-account-name</span>
</span></span><span class=line><span class=cl><span class=na>EnableSSL</span>        <span class=o>=</span> <span class=s>true</span></span></span></code></pre></div><p><strong>Key Parameters:</strong></p><ul><li><code>ControllerURL</code>: Your AppDynamics SaaS controller endpoint</li><li><code>ControllerPort</code>: HTTPS port for the controller (default: 443)</li><li><code>FMServicePort</code>: Flow Monitoring service port</li><li><code>AccountAccessKey</code>: Your AppDynamics account access key</li><li><code>AccountName</code>: Your AppDynamics account name</li><li><code>EnableSSL</code>: Enable SSL/TLS encryption (should be <code>true</code> for production)</li></ul><h3 id=common-configuration>Common Configuration</h3><p>Define the agent&rsquo;s identity and polling behavior:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[CommonConfig]</span>
</span></span><span class=line><span class=cl><span class=na>AgentName</span>            <span class=o>=</span> <span class=s>smartagent</span>
</span></span><span class=line><span class=cl><span class=na>PollingIntervalInSec</span> <span class=o>=</span> <span class=s>300</span>
</span></span><span class=line><span class=cl><span class=na>Tags</span>                 <span class=o>=</span> <span class=s>environment:production,region:us-east</span>
</span></span><span class=line><span class=cl><span class=na>ServiceName</span>          <span class=o>=</span> <span class=s>my-application</span></span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>AgentName</code>: Name identifier for the agent</li><li><code>PollingIntervalInSec</code>: How often the agent polls for data (in seconds)</li><li><code>Tags</code>: Custom tags for categorizing agents (comma-separated)</li><li><code>ServiceName</code>: Optional service name for logical grouping</li></ul><h3 id=telemetry-settings>Telemetry Settings</h3><p>Configure logging and profiling:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Telemetry]</span>
</span></span><span class=line><span class=cl><span class=na>LogLevel</span>  <span class=o>=</span> <span class=s>DEBUG</span>
</span></span><span class=line><span class=cl><span class=na>LogFile</span>   <span class=o>=</span> <span class=s>/opt/appdynamics/appdsmartagent/log.log</span>
</span></span><span class=line><span class=cl><span class=na>Profiling</span> <span class=o>=</span> <span class=s>false</span></span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>LogLevel</code>: Logging verbosity (<code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code>)</li><li><code>LogFile</code>: Path where logs will be written on remote hosts</li><li><code>Profiling</code>: Enable performance profiling (<code>true</code>/<code>false</code>)</li></ul><h3 id=tls-client-settings>TLS Client Settings</h3><p>Configure proxy and TLS settings:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[TLSClientSetting]</span>
</span></span><span class=line><span class=cl><span class=na>Insecure</span>        <span class=o>=</span> <span class=s>false</span>
</span></span><span class=line><span class=cl><span class=na>AgentHTTPProxy</span>  <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>AgentHTTPSProxy</span> <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>AgentNoProxy</span>    <span class=o>=</span> </span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>Insecure</code>: Skip TLS certificate verification (not recommended for production)</li><li><code>AgentHTTPProxy</code>: HTTP proxy server URL (if required)</li><li><code>AgentHTTPSProxy</code>: HTTPS proxy server URL (if required)</li><li><code>AgentNoProxy</code>: Comma-separated list of hosts to bypass proxy</li></ul><h3 id=auto-discovery>Auto Discovery</h3><p>Configure automatic application discovery:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[AutoDiscovery]</span>
</span></span><span class=line><span class=cl><span class=na>RunAutoDiscovery</span>          <span class=o>=</span> <span class=s>false</span>
</span></span><span class=line><span class=cl><span class=na>ExcludeLabels</span>             <span class=o>=</span> <span class=s>process.cpu.usage,process.memory.usage</span>
</span></span><span class=line><span class=cl><span class=na>ExcludeProcesses</span>          <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>ExcludeUsers</span>              <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>AutoDiscoveryTimeInterval</span> <span class=o>=</span> <span class=s>4h</span>
</span></span><span class=line><span class=cl><span class=na>AutoInstall</span>               <span class=o>=</span> <span class=s>false</span></span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>RunAutoDiscovery</code>: Automatically discover applications (<code>true</code>/<code>false</code>)</li><li><code>ExcludeLabels</code>: Metrics to exclude from discovery</li><li><code>ExcludeProcesses</code>: Process names to exclude from monitoring</li><li><code>ExcludeUsers</code>: User accounts to exclude from monitoring</li><li><code>AutoDiscoveryTimeInterval</code>: How often to run discovery (e.g., <code>4h</code>, <code>30m</code>)</li><li><code>AutoInstall</code>: Automatically install discovered applications</li></ul><h3 id=task-configuration>Task Configuration</h3><p>Configure native instrumentation:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[TaskConfig]</span>
</span></span><span class=line><span class=cl><span class=na>NativeEnable</span>        <span class=o>=</span> <span class=s>true</span>
</span></span><span class=line><span class=cl><span class=na>UserPortalUserName</span>  <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>UserPortalPassword</span>  <span class=o>=</span> 
</span></span><span class=line><span class=cl><span class=na>UserPortalAuth</span>      <span class=o>=</span> <span class=s>none</span>
</span></span><span class=line><span class=cl><span class=na>AutoUpdateLdPreload</span> <span class=o>=</span> <span class=s>true</span></span></span></code></pre></div><p><strong>Parameters:</strong></p><ul><li><code>NativeEnable</code>: Enable native instrumentation</li><li><code>AutoUpdateLdPreload</code>: Automatically update LD_PRELOAD settings</li></ul><h2 id=remoteyaml---remote-hosts-configuration>remote.yaml - Remote Hosts Configuration</h2><p>The <code>remote.yaml</code> file defines the remote hosts where Smart Agent will be installed and the connection parameters.</p><p><strong>Location:</strong> <code>/home/ubuntu/appdsm/remote.yaml</code></p><h3 id=example-configuration>Example Configuration</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>max_concurrency</span><span class=p>:</span><span class=w> </span><span class=m>4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>remote_dir</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/opt/appdynamics/appdsmartagent&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>protocol</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>ssh</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>private_key_path</span><span class=p>:</span><span class=w> </span><span class=l>/home/ubuntu/.ssh/id_rsa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>privileged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ignore_host_key_validation</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>known_hosts_path</span><span class=p>:</span><span class=w> </span><span class=l>/home/ubuntu/.ssh/known_hosts</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.243&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.48&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.142&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span></span></span></code></pre></div><h3 id=global-settings>Global Settings</h3><p><strong>max_concurrency:</strong> Maximum number of hosts to process simultaneously</p><ul><li>Default: <code>4</code></li><li>Increase for faster deployment to many hosts</li><li>Decrease if experiencing network or resource constraints</li></ul><p><strong>remote_dir:</strong> Installation directory on remote hosts</p><ul><li>Default: <code>/opt/appdynamics/appdsmartagent</code></li><li>Must be an absolute path</li><li>User must have write permissions</li></ul><h3 id=protocol-configuration>Protocol Configuration</h3><p><strong>type:</strong> Connection protocol</p><ul><li>Value: <code>ssh</code></li></ul><p><strong>auth.username:</strong> SSH username for authentication</p><ul><li>Example: <code>ubuntu</code>, <code>ec2-user</code>, <code>centos</code></li><li>Must match the user configured on remote hosts</li></ul><p><strong>auth.private_key_path:</strong> Path to SSH private key</p><ul><li>Must be an absolute path</li><li>Key must be accessible and have proper permissions (600)</li></ul><p><strong>auth.privileged:</strong> Run agent with elevated privileges</p><ul><li><code>true</code>: Install as root/systemd service</li><li><code>false</code>: Install as a user process</li><li>Recommended: <code>true</code> for production deployments</li></ul><p><strong>auth.ignore_host_key_validation:</strong> Skip SSH host key verification</p><ul><li><code>true</code>: Skip verification (useful for testing)</li><li><code>false</code>: Validate host keys (recommended for production)</li></ul><p><strong>auth.known_hosts_path:</strong> Path to SSH known_hosts file</p><ul><li>Default: <code>/home/ubuntu/.ssh/known_hosts</code></li><li>Used when host key validation is enabled</li></ul><h3 id=host-definitions>Host Definitions</h3><p>Each host entry requires:</p><p><strong>host:</strong> IP address or hostname of the remote machine</p><ul><li>Can be IPv4, IPv6, or hostname</li><li>Must be reachable from the control node</li></ul><p><strong>port:</strong> SSH port</p><ul><li>Default: <code>22</code></li><li>Change if SSH is running on a non-standard port</li></ul><p><strong>user:</strong> User account that will own the Smart Agent process</p><ul><li>Typically <code>root</code> for system-wide installation</li><li>Can be a regular user for user-specific installation</li></ul><p><strong>group:</strong> Group that will own the Smart Agent process</p><ul><li>Typically matches the user (e.g., <code>root</code>)</li></ul><h3 id=adding-more-hosts>Adding More Hosts</h3><p>To add additional remote hosts, append to the <code>hosts</code> list:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10.0.1.10&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10.0.1.11&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>port</span><span class=p>:</span><span class=w> </span><span class=m>22</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class=l>root</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>group</span><span class=p>:</span><span class=w> </span><span class=l>root</span></span></span></code></pre></div><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
Tip</summary><div class=box-content><p>You can add as many hosts as needed. The <code>max_concurrency</code> setting controls how many are processed in parallel.</p></div></details><h2 id=verifying-configuration>Verifying Configuration</h2><p>Before proceeding with installation, verify your configuration files:</p><h3 id=review-remoteyaml>Review remote.yaml</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /home/ubuntu/appdsm/remote.yaml</span></span></code></pre></div><p>Check that:</p><ul><li>All host IP addresses are correct</li><li>SSH key path is valid</li><li>Remote directory path is appropriate</li></ul><h3 id=review-configini>Review config.ini</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /home/ubuntu/appdsm/config.ini</span></span></code></pre></div><p>Verify that:</p><ul><li>Controller URL and account information are correct</li><li>Log file paths are valid</li><li>Settings match your environment requirements</li></ul><h3 id=validate-yaml-syntax>Validate YAML Syntax</h3><p>Ensure your YAML file is properly formatted:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s2>&#34;import yaml; yaml.safe_load(open(&#39;/home/ubuntu/appdsm/remote.yaml&#39;))&#34;</span></span></span></code></pre></div><p>If the command completes without errors, your YAML syntax is valid.</p><p>Once your configuration files are ready, you can proceed with the installation!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-installation--startup>3. Installation & Startup</h1><p>Now that your configuration files are ready, you can install and start Smart Agent on your remote hosts using the <code>smartagentctl</code> command-line tool.</p><h2 id=installation-process-overview>Installation Process Overview</h2><p>The installation process involves:</p><ol><li><strong>Connection</strong>: Establishes SSH connections to all defined hosts</li><li><strong>Transfer</strong>: Copies Smart Agent binaries and configuration to remote hosts</li><li><strong>Installation</strong>: Installs Smart Agent in <code>/opt/appdynamics/appdsmartagent/</code> on each host</li><li><strong>Startup</strong>: Starts the Smart Agent process on each remote host</li><li><strong>Logging</strong>: Outputs detailed progress to console and log file</li></ol><h2 id=step-1-navigate-to-installation-directory>Step 1: Navigate to Installation Directory</h2><p>Change to the Smart Agent installation directory:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /home/ubuntu/appdsm</span></span></code></pre></div><h2 id=step-2-verify-configuration-files>Step 2: Verify Configuration Files</h2><p>Before starting the installation, verify your configuration files are properly set up:</p><h3 id=review-remote-hosts-configuration>Review remote hosts configuration</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat remote.yaml</span></span></code></pre></div><p>Ensure all host IP addresses, ports, and SSH settings are correct.</p><h3 id=review-agent-configuration>Review agent configuration</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat config.ini</span></span></code></pre></div><p>Verify that controller URL, account credentials, and other settings are accurate.</p><h2 id=step-3-start-smart-agent-on-remote-hosts>Step 3: Start Smart Agent on Remote Hosts</h2><p>Run the following command to start Smart Agent on all remote hosts defined in <code>remote.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl start --remote --verbose</span></span></code></pre></div><h3 id=command-breakdown>Command Breakdown</h3><ul><li><code>sudo</code>: Required for privileged operations</li><li><code>./smartagentctl</code>: The control utility</li><li><code>start</code>: Command to start the Smart Agent</li><li><code>--remote</code>: Deploy to remote hosts (reads from <code>remote.yaml</code>)</li><li><code>--verbose</code>: Enable detailed debug logging</li></ul><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-triangle-exclamation"></i>
Note</summary><div class=box-content><p>The <code>--verbose</code> flag is highly recommended as it provides detailed output about the installation progress and helps identify any issues.</p></div></details><h2 id=step-4-monitor-the-installation>Step 4: Monitor the Installation</h2><p>The <code>--verbose</code> flag provides detailed output including:</p><ul><li>SSH connection status</li><li>File transfer progress</li><li>Installation steps on each host</li><li>Agent startup status</li><li>Any errors or warnings</li></ul><h3 id=expected-output>Expected Output</h3><p>You should see output similar to:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Starting Smart Agent deployment to remote hosts...
Connecting to 172.31.1.243:22...
Connection successful: 172.31.1.243
Transferring Smart Agent binaries...
Installing Smart Agent on 172.31.1.243...
Starting Smart Agent on 172.31.1.243...
Smart Agent started successfully on 172.31.1.243

Connecting to 172.31.1.48:22...
...</code></pre></div><h2 id=step-5-verify-installation>Step 5: Verify Installation</h2><p>After the installation completes, verify that Smart Agent is running on the remote hosts.</p><h3 id=check-status-remotely>Check Status Remotely</h3><p>Use the status command to check all remote hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl status --remote --verbose</span></span></code></pre></div><p>This will query each host and report whether Smart Agent is running.</p><h3 id=check-logs-on-control-node>Check Logs on Control Node</h3><p>View logs on the control node:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tail -f /home/ubuntu/appdsm/log.log</span></span></code></pre></div><h3 id=ssh-to-remote-host-and-check>SSH to Remote Host and Check</h3><p>You can also SSH to a remote host and check directly:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>tail -f /opt/appdynamics/appdsmartagent/log.log
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span> grep smartagent</span></span></code></pre></div><h2 id=additional-commands>Additional Commands</h2><h3 id=install-without-starting>Install Without Starting</h3><p>To install Smart Agent without starting it:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl install --remote --verbose</span></span></code></pre></div><p>This copies the binaries and configuration but doesn&rsquo;t start the agent process.</p><h3 id=stop-smart-agent>Stop Smart Agent</h3><p>To stop Smart Agent on all remote hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl stop --remote --verbose</span></span></code></pre></div><h3 id=install-as-system-service>Install as System Service</h3><p>To install Smart Agent as a systemd service (recommended for production):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl start --remote --verbose --service</span></span></code></pre></div><p>When installed as a service:</p><ul><li>Smart Agent will start automatically on system boot</li><li>Can be managed using <code>systemctl</code> commands</li><li>Better integration with system logging</li></ul><h3 id=uninstall-smart-agent>Uninstall Smart Agent</h3><p>To completely remove Smart Agent from remote hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo ./smartagentctl uninstall --remote --verbose</span></span></code></pre></div><details open class="box cstyle notices" style=--VARIABLE-BOX-color:danger><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>The uninstall command will remove all Smart Agent files from the remote hosts. Make sure you have backups of any important configuration or log files.</p></div></details><h2 id=verifying-in-appdynamics-controller>Verifying in AppDynamics Controller</h2><p>After starting Smart Agent on remote hosts:</p><ol><li><strong>Log into AppDynamics Controller</strong>: Navigate to your controller URL</li><li><strong>Go to Servers</strong>: Check the Servers section in the Controller UI</li><li><strong>Verify Agents</strong>: You should see your Smart Agents appear in the list</li><li><strong>Check Metrics</strong>: Verify that metrics are being collected from each host</li></ol><h3 id=expected-timeline>Expected Timeline</h3><ul><li><strong>Agent Registration</strong>: Agents typically appear in the Controller within 1-2 minutes</li><li><strong>Initial Metrics</strong>: First metrics usually arrive within 5 minutes</li><li><strong>Full Data</strong>: Complete data collection starts after the first polling interval (configured in <code>config.ini</code>)</li></ul><h2 id=log-file-locations>Log File Locations</h2><p>Logs are written to both the control node and remote hosts:</p><table><thead><tr><th>Location</th><th>Path</th><th>Description</th></tr></thead><tbody><tr><td><strong>Control Node</strong></td><td><code>/home/ubuntu/appdsm/log.log</code></td><td>Installation and deployment logs</td></tr><tr><td><strong>Remote Hosts</strong></td><td><code>/opt/appdynamics/appdsmartagent/log.log</code></td><td>Agent runtime logs</td></tr></tbody></table><h2 id=understanding-concurrency>Understanding Concurrency</h2><p>The <code>max_concurrency</code> setting in <code>remote.yaml</code> controls parallel execution:</p><ul><li><strong>Lower values (1-2)</strong>: Sequential processing, slower but safer</li><li><strong>Default (4)</strong>: Good balance for most environments</li><li><strong>Higher values (8+)</strong>: Faster deployment to many hosts, requires more resources</li></ul><p>Example: With 12 hosts and <code>max_concurrency: 4</code>:</p><ul><li>First batch: Hosts 1-4 processed simultaneously</li><li>Second batch: Hosts 5-8 processed simultaneously</li><li>Third batch: Hosts 9-12 processed simultaneously</li></ul><h2 id=what-happens-on-each-remote-host>What Happens on Each Remote Host</h2><p>When you run the start command, the following occurs on each remote host:</p><ol><li><strong>Directory Creation</strong>: Creates <code>/opt/appdynamics/appdsmartagent/</code></li><li><strong>File Transfer</strong>: Copies <code>smartagent</code> binary, <code>config.ini</code>, and libraries</li><li><strong>Permission Setting</strong>: Sets appropriate file permissions</li><li><strong>Process Start</strong>: Launches the Smart Agent process</li><li><strong>Verification</strong>: Confirms the process is running</li></ol><h2 id=next-steps>Next Steps</h2><p>After successfully installing and starting Smart Agent:</p><ol><li>âœ… Verify agents appear in the AppDynamics Controller UI</li><li>âœ… Check that metrics are being collected</li><li>âœ… Configure application monitoring as needed</li><li>âœ… Set up alerts and dashboards</li><li>âœ… Monitor agent health and performance</li></ol><p>If you encounter any issues, proceed to the Troubleshooting section.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-troubleshooting>4. Troubleshooting</h1><p>This section covers common issues you may encounter when deploying Smart Agent to remote hosts and how to resolve them.</p><h2 id=ssh-connection-issues>SSH Connection Issues</h2><h3 id=problem-cannot-connect-to-remote-hosts>Problem: Cannot Connect to Remote Hosts</h3><p><strong>Symptoms:</strong></p><ul><li>Connection timeout errors</li><li>&ldquo;Permission denied&rdquo; messages</li><li>Host key verification failures</li></ul><p><strong>Solutions:</strong></p><h4 id=1-verify-ssh-key-permissions>1. Verify SSH Key Permissions</h4><p>SSH keys must have the correct permissions:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>600</span> /home/ubuntu/.ssh/id_rsa
</span></span><span class=line><span class=cl>chmod <span class=m>644</span> /home/ubuntu/.ssh/id_rsa.pub
</span></span><span class=line><span class=cl>chmod <span class=m>700</span> /home/ubuntu/.ssh</span></span></code></pre></div><h4 id=2-test-ssh-connectivity-manually>2. Test SSH Connectivity Manually</h4><p>Test connection to each remote host:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -i /home/ubuntu/.ssh/id_rsa ubuntu@172.31.1.243</span></span></code></pre></div><p>If this fails, the issue is with SSH configuration, not smartagentctl.</p><h4 id=3-check-remote-host-reachability>3. Check Remote Host Reachability</h4><p>Verify network connectivity:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ping 172.31.1.243
</span></span><span class=line><span class=cl>telnet 172.31.1.243 <span class=m>22</span></span></span></code></pre></div><h4 id=4-verify-ssh-user>4. Verify SSH User</h4><p>Ensure the username in <code>remote.yaml</code> matches the SSH user:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>protocol</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>username</span><span class=p>:</span><span class=w> </span><span class=l>ubuntu </span><span class=w> </span><span class=c># Must match your SSH user</span></span></span></code></pre></div><h4 id=5-check-known-hosts>5. Check Known Hosts</h4><p>If host key validation is enabled, ensure hosts are in known_hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh-keyscan 172.31.1.243 &gt;&gt; /home/ubuntu/.ssh/known_hosts</span></span></code></pre></div><p>Or temporarily disable host key validation in <code>remote.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>protocol</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ignore_host_key_validation</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div><details open class="box cstyle notices" style=--VARIABLE-BOX-color:danger><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>Disabling host key validation should only be used for testing. Always enable it in production environments.</p></div></details><h2 id=permission-issues>Permission Issues</h2><h3 id=problem-permission-denied-during-installation>Problem: Permission Denied During Installation</h3><p><strong>Symptoms:</strong></p><ul><li>&ldquo;Permission denied&rdquo; when creating directories</li><li>Cannot write to <code>/opt/appdynamics/</code></li><li>Insufficient privileges errors</li></ul><p><strong>Solutions:</strong></p><h4 id=1-verify-sudo-access-on-control-node>1. Verify Sudo Access on Control Node</h4><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo -v</span></span></code></pre></div><h4 id=2-check-privileged-setting>2. Check Privileged Setting</h4><p>Ensure <code>privileged: true</code> is set in <code>remote.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>protocol</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>auth</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>privileged</span><span class=p>:</span><span class=w> </span><span class=kc>true</span></span></span></code></pre></div><h4 id=3-verify-remote-user-permissions>3. Verify Remote User Permissions</h4><p>The remote user must have sudo privileges or be root. Test on remote host:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>sudo mkdir -p /opt/appdynamics/test
</span></span><span class=line><span class=cl>sudo rm -rf /opt/appdynamics/test</span></span></code></pre></div><h4 id=4-check-remote-directory-permissions>4. Check Remote Directory Permissions</h4><p>If using a custom installation directory, ensure it&rsquo;s writable:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>ls -la /opt/appdynamics/</span></span></code></pre></div><h2 id=agent-not-starting>Agent Not Starting</h2><h3 id=problem-agent-installation-succeeds-but-agent-doesnt-start>Problem: Agent Installation Succeeds But Agent Doesn&rsquo;t Start</h3><p><strong>Symptoms:</strong></p><ul><li>Installation completes without errors</li><li>Agent process not running on remote hosts</li><li>No errors in control node logs</li></ul><p><strong>Solutions:</strong></p><h4 id=1-check-remote-host-logs>1. Check Remote Host Logs</h4><p>SSH to the remote host and check the agent logs:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>tail -100 /opt/appdynamics/appdsmartagent/log.log</span></span></code></pre></div><p>Look for error messages indicating:</p><ul><li>Configuration errors</li><li>Network connectivity issues</li><li>Missing dependencies</li></ul><h4 id=2-verify-agent-process>2. Verify Agent Process</h4><p>Check if the agent process is running:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span> grep smartagent</span></span></code></pre></div><p>If not running, try starting manually:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>sudo ./smartagent</span></span></code></pre></div><h4 id=3-check-configuration-files>3. Check Configuration Files</h4><p>Verify that <code>config.ini</code> was properly transferred:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>cat /opt/appdynamics/appdsmartagent/config.ini</span></span></code></pre></div><p>Ensure:</p><ul><li>Controller URL is correct</li><li>Account credentials are valid</li><li>All required fields are populated</li></ul><h4 id=4-test-controller-connectivity>4. Test Controller Connectivity</h4><p>From the remote host, verify connectivity to the AppDynamics Controller:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>curl -I https://fso-tme.saas.appdynamics.com</span></span></code></pre></div><h4 id=5-check-system-resources>5. Check System Resources</h4><p>Ensure the remote host has adequate resources:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>df -h  <span class=c1># Check disk space</span>
</span></span><span class=line><span class=cl>free -m  <span class=c1># Check memory</span></span></span></code></pre></div><h2 id=configuration-errors>Configuration Errors</h2><h3 id=problem-invalid-configuration>Problem: Invalid Configuration</h3><p><strong>Symptoms:</strong></p><ul><li>YAML parsing errors</li><li>Invalid configuration parameter errors</li><li>Agent fails to start with config errors</li></ul><p><strong>Solutions:</strong></p><h4 id=1-validate-yaml-syntax>1. Validate YAML Syntax</h4><p>Check for YAML syntax errors in <code>remote.yaml</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>python3 -c <span class=s2>&#34;import yaml; yaml.safe_load(open(&#39;/home/ubuntu/appdsm/remote.yaml&#39;))&#34;</span></span></span></code></pre></div><p>Common YAML issues:</p><ul><li>Incorrect indentation (use spaces, not tabs)</li><li>Missing colons</li><li>Unquoted special characters</li></ul><h4 id=2-verify-ini-file-format>2. Verify INI File Format</h4><p>Check <code>config.ini</code> for syntax errors:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /home/ubuntu/appdsm/config.ini</span></span></code></pre></div><p>Common INI issues:</p><ul><li>Missing section headers (e.g., <code>[CommonConfig]</code>)</li><li>Invalid parameter names</li><li>Missing equals signs</li></ul><h4 id=3-validate-controller-credentials>3. Validate Controller Credentials</h4><p>Ensure your AppDynamics credentials are correct:</p><ul><li><strong>ControllerURL</strong>: Should not include <code>https://</code> or <code>/controller</code></li><li><strong>AccountAccessKey</strong>: Should be the full access key</li><li><strong>AccountName</strong>: Should match your account name exactly</li></ul><p>Example correct format:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>ControllerURL</span>    <span class=o>=</span> <span class=s>fso-tme.saas.appdynamics.com</span>
</span></span><span class=line><span class=cl><span class=na>AccountAccessKey</span> <span class=o>=</span> <span class=s>abc123xyz789</span>
</span></span><span class=line><span class=cl><span class=na>AccountName</span>      <span class=o>=</span> <span class=s>fso-tme</span></span></span></code></pre></div><h2 id=agent-not-appearing-in-controller>Agent Not Appearing in Controller</h2><h3 id=problem-agent-starts-but-doesnt-appear-in-controller-ui>Problem: Agent Starts But Doesn&rsquo;t Appear in Controller UI</h3><p><strong>Symptoms:</strong></p><ul><li>Agent process is running on remote hosts</li><li>No errors in agent logs</li><li>Agent doesn&rsquo;t appear in Controller UI</li></ul><p><strong>Solutions:</strong></p><h4 id=1-wait-for-initial-registration>1. Wait for Initial Registration</h4><p>Agents may take 1-5 minutes to appear in the Controller after starting.</p><h4 id=2-verify-controller-configuration>2. Verify Controller Configuration</h4><p>Check that the agent can reach the controller:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>ping fso-tme.saas.appdynamics.com
</span></span><span class=line><span class=cl>curl -I https://fso-tme.saas.appdynamics.com</span></span></code></pre></div><h4 id=3-check-agent-logs-for-connection-errors>3. Check Agent Logs for Connection Errors</h4><p>Look for controller connection errors:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>grep -i <span class=s2>&#34;error\|fail\|controller&#34;</span> /opt/appdynamics/appdsmartagent/log.log</span></span></code></pre></div><h4 id=4-verify-ssltls-settings>4. Verify SSL/TLS Settings</h4><p>Ensure SSL is enabled in <code>config.ini</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=na>EnableSSL</span> <span class=o>=</span> <span class=s>true</span></span></span></code></pre></div><h4 id=5-check-firewall-rules>5. Check Firewall Rules</h4><p>Verify that outbound HTTPS (port 443) is allowed from remote hosts to the Controller.</p><h4 id=6-verify-account-credentials>6. Verify Account Credentials</h4><p>Double-check that your AccountAccessKey and AccountName are correct in the Controller UI:</p><ul><li>Log into AppDynamics Controller</li><li>Go to Settings â†’ License</li><li>Verify your account name and access key</li></ul><h2 id=performance-and-scaling-issues>Performance and Scaling Issues</h2><h3 id=problem-slow-deployment-or-timeouts>Problem: Slow Deployment or Timeouts</h3><p><strong>Symptoms:</strong></p><ul><li>Deployment takes too long</li><li>Timeout errors when deploying to many hosts</li><li>System resource exhaustion</li></ul><p><strong>Solutions:</strong></p><h4 id=1-adjust-concurrency>1. Adjust Concurrency</h4><p>Reduce <code>max_concurrency</code> in <code>remote.yaml</code> if experiencing issues:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>max_concurrency</span><span class=p>:</span><span class=w> </span><span class=m>2</span><span class=w>  </span><span class=c># Lower value for slower, more stable deployment</span></span></span></code></pre></div><p>Or increase for faster deployment if resources allow:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>max_concurrency</span><span class=p>:</span><span class=w> </span><span class=m>8</span><span class=w>  </span><span class=c># Higher value for faster deployment</span></span></span></code></pre></div><h4 id=2-deploy-in-batches>2. Deploy in Batches</h4><p>For very large deployments, split hosts into multiple groups:</p><p><strong>remote-batch1.yaml:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.2&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.3&#34;</span></span></span></code></pre></div><p><strong>remote-batch2.yaml:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hosts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.4&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.5&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>host</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;172.31.1.6&#34;</span></span></span></code></pre></div><p>Then deploy each batch separately.</p><h4 id=3-check-network-bandwidth>3. Check Network Bandwidth</h4><p>Monitor network usage during deployment:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iftop</span></span></code></pre></div><p>If bandwidth is saturated, reduce concurrency or deploy during off-peak hours.</p><h2 id=log-analysis>Log Analysis</h2><h3 id=checking-control-node-logs>Checking Control Node Logs</h3><p>View detailed deployment logs:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tail -f /home/ubuntu/appdsm/log.log</span></span></code></pre></div><p>Look for:</p><ul><li>SSH connection failures</li><li>File transfer errors</li><li>Permission denied errors</li><li>Timeout messages</li></ul><h3 id=checking-remote-host-logs>Checking Remote Host Logs</h3><p>View agent runtime logs on remote hosts:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>tail -f /opt/appdynamics/appdsmartagent/log.log</span></span></code></pre></div><p>Look for:</p><ul><li>Controller connection errors</li><li>Configuration errors</li><li>Agent startup failures</li><li>Network issues</li></ul><h3 id=increasing-log-verbosity>Increasing Log Verbosity</h3><p>For more detailed logging, set <code>LogLevel</code> to <code>DEBUG</code> in <code>config.ini</code>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[Telemetry]</span>
</span></span><span class=line><span class=cl><span class=na>LogLevel</span> <span class=o>=</span> <span class=s>DEBUG</span></span></span></code></pre></div><h2 id=getting-help>Getting Help</h2><p>If you&rsquo;re still experiencing issues:</p><ol><li><p><strong>Check Documentation</strong>: Review the smartagentctl help:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./smartagentctl --help
</span></span><span class=line><span class=cl>./smartagentctl start --help</span></span></code></pre></div></li><li><p><strong>Review AppDynamics Documentation</strong>: Visit the AppDynamics documentation portal</p></li><li><p><strong>Check Log Files</strong>: Always review both control node and remote host logs</p></li><li><p><strong>Test Components Individually</strong>:</p><ul><li>Test SSH connectivity separately</li><li>Test agent startup on a single host manually</li><li>Verify controller connectivity independently</li></ul></li><li><p><strong>Collect Diagnostic Information</strong>:</p><ul><li>Control node logs</li><li>Remote host logs</li><li>Configuration files (with sensitive data redacted)</li><li>Error messages and stack traces</li></ul></li></ol><h2 id=common-error-messages>Common Error Messages</h2><table><thead><tr><th>Error Message</th><th>Cause</th><th>Solution</th></tr></thead><tbody><tr><td>&ldquo;Permission denied (publickey)&rdquo;</td><td>SSH key authentication failure</td><td>Verify SSH key path and permissions</td></tr><tr><td>&ldquo;Connection refused&rdquo;</td><td>SSH port not accessible</td><td>Check firewall rules and SSH daemon</td></tr><tr><td>&ldquo;No such file or directory&rdquo;</td><td>Missing configuration file</td><td>Verify config files exist and paths are correct</td></tr><tr><td>&ldquo;YAML parse error&rdquo;</td><td>Invalid YAML syntax</td><td>Validate YAML syntax with parser</td></tr><tr><td>&ldquo;Controller unreachable&rdquo;</td><td>Network connectivity issue</td><td>Test controller connectivity from remote host</td></tr><tr><td>&ldquo;Invalid credentials&rdquo;</td><td>Wrong account key or name</td><td>Verify AppDynamics credentials</td></tr></tbody></table><h2 id=best-practices-for-troubleshooting>Best Practices for Troubleshooting</h2><ol><li><strong>Always use &ndash;verbose flag</strong>: Provides detailed output for debugging</li><li><strong>Test with a single host first</strong>: Deploy to one host before scaling</li><li><strong>Check logs immediately</strong>: Review logs right after deployment</li><li><strong>Verify prerequisites</strong>: Ensure all requirements are met before deploying</li><li><strong>Test connectivity separately</strong>: Verify SSH and network connectivity independently</li><li><strong>Use manual commands</strong>: Test manual SSH and agent startup to isolate issues</li></ol><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>When troubleshooting, start with the simplest tests first (e.g., ping, SSH connectivity) before moving to more complex issues.</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=jenkins-automation>Jenkins Automation</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>This workshop demonstrates how to use <strong>Jenkins</strong> to automate the deployment and lifecycle management of <strong>AppDynamics Smart Agent</strong> across multiple EC2 instances. Whether you&rsquo;re managing 10 hosts or 10,000, this guide shows you how to leverage Jenkins pipelines for scalable, secure, and repeatable Smart Agent operations.</p><p><a href=#R-image-4534f370f982d634904f0b35d9a6e409 class=lightbox-link><img alt="Jenkins and AppDynamics" class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/Jenkins-D24939?style=flat&logo=jenkins&logoColor=white" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4534f370f982d634904f0b35d9a6e409><img alt="Jenkins and AppDynamics" class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/Jenkins-D24939?style=flat&logo=jenkins&logoColor=white"></a> <a href=#R-image-ffb2b786defcd29f11362d72a84c84cb class=lightbox-link><img alt=AppDynamics class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ffb2b786defcd29f11362d72a84c84cb><img alt=AppDynamics class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat"></a></p><h2 id=what-youll-learn>What You&rsquo;ll Learn</h2><p>In this workshop, you&rsquo;ll learn how to:</p><ul><li><strong>Deploy Smart Agent</strong> to multiple hosts simultaneously using Jenkins</li><li><strong>Configure Jenkins credentials</strong> for secure SSH and AppDynamics access</li><li><strong>Create parameterized pipelines</strong> for flexible deployment scenarios</li><li><strong>Implement batch processing</strong> to scale to thousands of hosts</li><li><strong>Manage the complete agent lifecycle</strong> - install, configure, stop, and cleanup</li><li><strong>Handle failures gracefully</strong> with automatic error tracking and reporting</li></ul><h2 id=key-features>Key Features</h2><ul><li>ðŸš€ <strong>Parallel Deployment</strong> - Deploy to multiple hosts simultaneously</li><li>ðŸ”„ <strong>Complete Lifecycle Management</strong> - Install, uninstall, stop, and clean agents</li><li>ðŸ—ï¸ <strong>Infrastructure as Code</strong> - All pipelines version-controlled</li><li>ðŸ” <strong>Secure</strong> - SSH key-based authentication via Jenkins credentials</li><li>ðŸ“ˆ <strong>Massively Scalable</strong> - Deploy to thousands of hosts with automatic batching</li><li>ðŸŽ›ï¸ <strong>Jenkins Agent</strong> - Executes within your AWS VPC</li></ul><h2 id=architecture-overview>Architecture Overview</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Jenkins-based Deployment                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Developer â”€â”€â–¶ Jenkins Master â”€â”€â–¶ Jenkins Agent (AWS VPC)      â”‚
â”‚                                          â”‚                       â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 1 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 2 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 3 (SSH)      â”‚
â”‚                                          â””â”€â”€â–¶ Host N (SSH)      â”‚
â”‚                                                                  â”‚
â”‚  All hosts send metrics â”€â”€â–¶ AppDynamics Controller             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h2 id=workshop-components>Workshop Components</h2><p>This workshop includes:</p><ol><li><strong>Architecture & Design</strong> - Understanding the system design and network topology</li><li><strong>Jenkins Setup</strong> - Configuring Jenkins, credentials, and agents</li><li><strong>Pipeline Creation</strong> - Creating and configuring deployment pipelines</li><li><strong>Deployment Workflow</strong> - Executing deployments and verifying installations</li></ol><h2 id=prerequisites>Prerequisites</h2><ul><li>Jenkins server (2.300+) with Pipeline plugin</li><li>Jenkins agent in the same VPC as target EC2 instances</li><li>SSH key pair for authentication</li><li>AppDynamics Smart Agent package</li><li>Target Ubuntu EC2 instances with SSH access</li></ul><h2 id=github-repository>GitHub Repository</h2><p>All pipeline code and configuration files are available in the GitHub repository:</p><p><strong><a href=https://github.com/chambear2809/sm-jenkins rel=external>https://github.com/chambear2809/sm-jenkins</a></strong></p><p>The repository includes:</p><ul><li>Complete Jenkinsfile pipeline definitions</li><li>Detailed setup documentation</li><li>Configuration examples</li><li>Troubleshooting guides</li></ul><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of Jenkins Automation</h1><article class=default><header class=headline></header><h1 id=architecture--design>Architecture & Design</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=system-architecture>System Architecture</h2><p>The Jenkins-based Smart Agent deployment system uses a hub-and-spoke architecture where a Jenkins agent in your AWS VPC orchestrates deployments to multiple target hosts via SSH.</p><h3 id=high-level-architecture>High-Level Architecture</h3><pre class="mermaid align-center">graph TB
    subgraph &#34;Jenkins Infrastructure&#34;
        JM[Jenkins Master&lt;br/&gt;Web UI + Orchestration]
        JA[Jenkins Agent&lt;br/&gt;EC2 in VPC&lt;br/&gt;Label: linux]
    end
    
    subgraph &#34;AWS VPC - Private Network&#34;
        subgraph &#34;Target EC2 Instances&#34;
            H1[Host 1&lt;br/&gt;172.31.1.243]
            H2[Host 2&lt;br/&gt;172.31.1.48]
            H3[Host 3&lt;br/&gt;172.31.1.5]
            HN[Host N&lt;br/&gt;172.31.x.x]
        end
    end
    
    DEV[Developer/Operator]
    APPD[AppDynamics&lt;br/&gt;Controller]
    
    DEV --&gt;|1. Triggers Pipeline| JM
    JM --&gt;|2. Assigns Job| JA
    JA --&gt;|3. SSH Deploy&lt;br/&gt;Private IPs| H1
    JA --&gt;|3. SSH Deploy&lt;br/&gt;Private IPs| H2
    JA --&gt;|3. SSH Deploy&lt;br/&gt;Private IPs| H3
    JA --&gt;|3. SSH Deploy&lt;br/&gt;Private IPs| HN
    
    H1 -.-&gt;|Metrics| APPD
    H2 -.-&gt;|Metrics| APPD
    H3 -.-&gt;|Metrics| APPD
    HN -.-&gt;|Metrics| APPD
    
    style JM fill:#d4e6f1
    style JA fill:#a9cce3
    style H1 fill:#aed6f1
    style H2 fill:#aed6f1
    style H3 fill:#aed6f1
    style HN fill:#aed6f1</pre><h2 id=network-architecture>Network Architecture</h2><p>All infrastructure runs in a single AWS VPC with a shared security group. The Jenkins agent communicates with target hosts via private IPs, eliminating the need for public IP addresses on target hosts.</p><h3 id=vpc-layout>VPC Layout</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS VPC (10.0.0.0/16)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚              Security Group: app-agents-sg                â”‚  â”‚
â”‚  â”‚  Rules:                                                   â”‚  â”‚
â”‚  â”‚  - Inbound: SSH (22) from Jenkins Agent only             â”‚  â”‚
â”‚  â”‚  - Outbound: HTTPS (443) to AppDynamics Controller       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Jenkins Agentâ”‚    â”‚  Target EC2  â”‚    â”‚  Target EC2  â”‚      â”‚
â”‚  â”‚              â”‚    â”‚              â”‚    â”‚              â”‚      â”‚
â”‚  â”‚ Private IP:  â”‚â”€â”€â”€â–¶â”‚ Private IP:  â”‚    â”‚ Private IP:  â”‚      â”‚
â”‚  â”‚ 172.31.50.10 â”‚SSH â”‚ 172.31.1.243 â”‚    â”‚ 172.31.1.48  â”‚      â”‚
â”‚  â”‚              â”‚â”€â”€â”€â–¶â”‚              â”‚    â”‚              â”‚      â”‚
â”‚  â”‚ Label: linux â”‚    â”‚ Ubuntu 20.04 â”‚    â”‚ Ubuntu 20.04 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   AppDynamics    â”‚
                    â”‚    Controller    â”‚
                    â”‚  (SaaS/On-Prem)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h2 id=deployment-flow>Deployment Flow</h2><h3 id=complete-deployment-sequence>Complete Deployment Sequence</h3><pre class="mermaid align-center">sequenceDiagram
    participant Dev as Developer
    participant JM as Jenkins Master
    participant JA as Jenkins Agent&lt;br/&gt;(VPC)
    participant TH as Target Hosts&lt;br/&gt;(VPC)
    participant AppD as AppDynamics&lt;br/&gt;Controller
    
    Dev-&gt;&gt;JM: 1. Trigger Pipeline
    JM-&gt;&gt;JM: 2. Load Credentials
    JM-&gt;&gt;JA: 3. Schedule Job
    JA-&gt;&gt;JA: 4. Prepare Batches
    
    loop For Each Batch
        JA-&gt;&gt;TH: 5. SSH Copy Files (SCP)
        JA-&gt;&gt;TH: 6. SSH Execute Commands
        TH-&gt;&gt;TH: 7. Install/Config Agent
        TH--&gt;&gt;JA: 8. Return Status
    end
    
    JA-&gt;&gt;JM: 9. Report Results
    JM-&gt;&gt;Dev: 10. Show Build Status
    
    TH-&gt;&gt;AppD: 11. Send Metrics (Post-Install)
    AppD--&gt;&gt;Dev: 12. View Monitoring Data</pre><h2 id=component-details>Component Details</h2><h3 id=jenkins-master>Jenkins Master</h3><p><strong>Responsibilities:</strong></p><ul><li>Web UI for users</li><li>Pipeline orchestration</li><li>Credential management</li><li>Build history & logs</li><li>Job scheduling</li></ul><p><strong>Requirements:</strong></p><ul><li>Jenkins 2.300+</li><li>Plugins: Pipeline, SSH Agent, Credentials, Git</li><li>Network access to agent</li></ul><h3 id=jenkins-agent>Jenkins Agent</h3><p><strong>Location:</strong></p><ul><li>AWS VPC (same as targets)</li><li>Private network access</li></ul><p><strong>Responsibilities:</strong></p><ul><li>Execute pipeline stages</li><li>SSH to target hosts</li><li>File transfers (SCP)</li><li>Batching logic</li><li>Error collection</li></ul><p><strong>Requirements:</strong></p><ul><li>Label: <code>linux</code></li><li>Java 11+</li><li>SSH client</li><li>Network: SSH to all targets</li><li>Disk: ~20GB for artifacts</li></ul><h3 id=target-hosts>Target Hosts</h3><p><strong>Pre-requisites:</strong></p><ul><li>Ubuntu 20.04+</li><li>SSH server running</li><li>User with sudo access</li><li>Authorized SSH key</li></ul><p><strong>Post-deployment:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>/opt/appdynamics/
â””â”€â”€ appdsmartagent/
    â”œâ”€â”€ smartagentctl
    â”œâ”€â”€ config.ini
    â””â”€â”€ agents/
        â”œâ”€â”€ machine/
        â”œâ”€â”€ java/
        â”œâ”€â”€ node/
        â””â”€â”€ db/</code></pre></div><h2 id=security-architecture>Security Architecture</h2><h3 id=security-layers>Security Layers</h3><ol><li><p><strong>AWS VPC Isolation</strong></p><ul><li>Private subnet for agents</li><li>No direct internet access required</li><li>VPC flow logs enabled</li></ul></li><li><p><strong>Security Groups</strong></p><ul><li>Whitelist Jenkins Agent IP</li><li>Port 22 (SSH) only</li><li>Stateful firewall rules</li></ul></li><li><p><strong>SSH Key Authentication</strong></p><ul><li>No password authentication</li><li>Keys stored in Jenkins credentials</li><li>Temporary key files (600 perms)</li><li>Keys removed after each build</li></ul></li><li><p><strong>Jenkins RBAC</strong></p><ul><li>Role-based access control</li><li>Pipeline-level permissions</li><li>Credential access restrictions</li><li>Audit logging enabled</li></ul></li><li><p><strong>Secrets Management</strong></p><ul><li>No secrets in code/logs</li><li>Credentials binding only</li><li>Environment variable masking</li><li>Automatic secret rotation (optional)</li></ul></li></ol><h3 id=credential-flow>Credential Flow</h3><pre class="mermaid align-center">flowchart LR
    subgraph &#34;Jenkins Master&#34;
        CS[Credentials Store&lt;br/&gt;Encrypted at Rest]
        JM[Jenkins Master]
    end
    
    subgraph &#34;Jenkins Agent&#34;
        WS[Workspace&lt;br/&gt;Temp Files]
        KEY[SSH Key File&lt;br/&gt;600 permissions]
    end
    
    subgraph &#34;Target Hosts&#34;
        TH[EC2 Instances&lt;br/&gt;Authorized Keys]
    end
    
    CS --&gt;|Binding| JM
    JM --&gt;|Secure Copy| KEY
    KEY --&gt;|SSH Auth| TH
    WS -.-&gt;|Cleanup| X[Deleted]
    KEY -.-&gt;|Cleanup| X
    
    style CS fill:#fdeaa8
    style KEY fill:#fadbd8
    style X fill:#e8e8e8</pre><h2 id=batch-processing>Batch Processing</h2><p>The system uses automatic batching to support deployments at any scale. By default, hosts are processed in batches of 256, with all hosts within a batch deploying in parallel.</p><h3 id=how-batching-works>How Batching Works</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>HOST LIST (1000 hosts)              BATCH_SIZE = 256

Host 001: 172.31.1.1                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Host 002: 172.31.1.2      â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚   BATCH 1        â”‚
    ...                              â”‚   Hosts 1-256    â”‚ â”€â”€â”€â”
Host 256: 172.31.1.256               â”‚   Sequential     â”‚    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
Host 257: 172.31.1.257               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
Host 258: 172.31.1.258   â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   BATCH 2        â”‚    â”‚ SEQUENTIAL
    ...                              â”‚   Hosts 257-512  â”‚    â”‚ EXECUTION
Host 512: 172.31.1.512               â”‚   Sequential     â”‚    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
Host 513: 172.31.1.513               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    ...                              â”‚   BATCH 3        â”‚    â”‚
Host 768: 172.31.1.768   â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   Hosts 513-768  â”‚ â”€â”€â”€â”˜
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Host 769: 172.31.1.769               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    ...                              â”‚   BATCH 4        â”‚
Host 1000: 172.31.2.232  â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   Hosts 769-1000 â”‚
                                     â”‚   (232 hosts)    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WITHIN EACH BATCH:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  All hosts deploy in PARALLEL          â”‚
â”‚                                        â”‚
â”‚  Host 1 â”€â”€â”                           â”‚
â”‚  Host 2 â”€â”€â”¤                           â”‚
â”‚  Host 3 â”€â”€â”¼â”€â–¶ Background processes (&amp;)â”‚
â”‚    ...    â”‚                           â”‚
â”‚  Host 256â”€â”˜   â””â”€â–¶ wait command        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h3 id=scaling-characteristics>Scaling Characteristics</h3><p><strong>Deployment Speed (default BATCH_SIZE=256):</strong></p><ul><li>10 hosts â†’ 1 batch â†’ ~2 minutes</li><li>100 hosts â†’ 1 batch â†’ ~3 minutes</li><li>500 hosts â†’ 2 batches â†’ ~6 minutes</li><li>1,000 hosts â†’ 4 batches â†’ ~12 minutes</li><li>5,000 hosts â†’ 20 batches â†’ ~60 minutes</li></ul><p><strong>Factors affecting speed:</strong></p><ul><li>Network bandwidth (19MB package per host)</li><li>SSH connection overhead (~1s per host)</li><li>Target host CPU/disk speed</li><li>Jenkins agent resources</li></ul><h2 id=next-steps>Next Steps</h2><p>Now that you understand the architecture, let&rsquo;s move on to setting up Jenkins and configuring credentials.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=jenkins-setup>Jenkins Setup</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=prerequisites>Prerequisites</h2><p>Before you begin, ensure you have:</p><ul><li>Jenkins server (version 2.300 or later)</li><li>A Jenkins agent in the same AWS VPC as your target EC2 instances</li><li>SSH key pair for authentication to target hosts</li><li>AppDynamics Smart Agent package</li><li>Target Ubuntu EC2 instances with SSH access</li></ul><h2 id=required-jenkins-plugins>Required Jenkins Plugins</h2><p>Install these plugins via <strong>Manage Jenkins â†’ Plugins â†’ Available Plugins</strong>:</p><ol><li><strong>Pipeline</strong> (core plugin, usually pre-installed)</li><li><strong>SSH Agent Plugin</strong></li><li><strong>Credentials Plugin</strong> (usually pre-installed)</li><li><strong>Git Plugin</strong> (if using SCM)</li></ol><p>To install:</p><ol><li>Navigate to <strong>Manage Jenkins â†’ Plugins</strong></li><li>Click <strong>Available</strong> tab</li><li>Search for each plugin</li><li>Select and click <strong>Install</strong></li></ol><h2 id=configure-jenkins-agent>Configure Jenkins Agent</h2><p>Your Jenkins agent must be able to reach target EC2 instances via private IPs. There are two main options:</p><h3 id=option-a-ec2-instance-as-agent>Option A: EC2 Instance as Agent</h3><ol><li><p><strong>Launch EC2 instance in same VPC</strong> as your target hosts</p></li><li><p><strong>Install Java</strong> (required by Jenkins):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo apt-get update
</span></span><span class=line><span class=cl>sudo apt-get install -y openjdk-11-jdk</span></span></code></pre></div></li><li><p><strong>Add agent in Jenkins</strong>:</p><ul><li>Go to <strong>Manage Jenkins â†’ Nodes â†’ New Node</strong></li><li>Name: <code>aws-vpc-agent</code> (or your preferred name)</li><li>Type: <strong>Permanent Agent</strong></li><li>Configure:<ul><li><strong>Remote root directory</strong>: <code>/home/ubuntu/jenkins</code></li><li><strong>Labels</strong>: <code>linux</code> (must match pipeline agent label)</li><li><strong>Launch method</strong>: Launch agent via SSH</li><li><strong>Host</strong>: EC2 private IP</li><li><strong>Credentials</strong>: Add SSH credentials for agent</li></ul></li></ul></li></ol><h3 id=option-b-use-existing-linux-agent>Option B: Use Existing Linux Agent</h3><ul><li>Ensure agent has label <code>linux</code></li><li>Verify network connectivity to target hosts</li><li>Confirm SSH client is installed</li></ul><h3 id=configure-agent-labels>Configure Agent Labels</h3><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>All pipelines in this workshop use the <code>linux</code> label. Make sure your agent is configured with this label.</p></div></details><p>To set or modify labels:</p><ol><li>Go to <strong>Manage Jenkins â†’ Nodes</strong></li><li>Click on your agent</li><li>Click <strong>Configure</strong></li><li>Set <strong>Labels</strong> to <code>linux</code></li><li>Click <strong>Save</strong></li></ol><h2 id=credentials-setup>Credentials Setup</h2><p>Navigate to: <strong>Manage Jenkins â†’ Credentials â†’ System â†’ Global credentials (unrestricted)</strong></p><p>You&rsquo;ll need to create three credentials for the pipelines to work.</p><h3 id=1-ssh-private-key-for-target-hosts>1. SSH Private Key for Target Hosts</h3><p>This credential allows Jenkins to SSH into your target EC2 instances.</p><p><strong>Type</strong>: SSH Username with private key</p><ul><li><strong>ID</strong>: <code>ssh-private-key</code> (must match exactly)</li><li><strong>Description</strong>: <code>SSH key for EC2 target hosts</code></li><li><strong>Username</strong>: <code>ubuntu</code> (or your SSH user)</li><li><strong>Private Key</strong>: Choose one:<ul><li><strong>Enter directly</strong>: Paste your PEM file content</li><li><strong>From file</strong>: Upload PEM file</li><li><strong>From Jenkins master</strong>: Specify path</li></ul></li></ul><p><strong>Example format</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
...
-----END RSA PRIVATE KEY-----</code></pre></div><h3 id=2-deployment-hosts-list>2. Deployment Hosts List</h3><p>This credential contains the list of all target hosts where Smart Agent should be deployed.</p><p><strong>Type</strong>: Secret text</p><ul><li><strong>ID</strong>: <code>deployment-hosts</code> (must match exactly)</li><li><strong>Description</strong>: <code>List of target EC2 host IPs</code></li><li><strong>Secret</strong>: Enter newline-separated IPs</li></ul><p><strong>Example</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>172.31.1.243
172.31.1.48
172.31.1.5
172.31.10.20
172.31.10.21</code></pre></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p><strong>Format Requirements:</strong></p><ul><li>One IP per line</li><li>No commas</li><li>No spaces</li><li>No extra characters</li><li>Use Unix line endings (LF, not CRLF)</li></ul></div></details><h3 id=3-appdynamics-account-access-key>3. AppDynamics Account Access Key</h3><p>This credential contains your AppDynamics account access key for Smart Agent authentication.</p><p><strong>Type</strong>: Secret text</p><ul><li><strong>ID</strong>: <code>account-access-key</code> (must match exactly)</li><li><strong>Description</strong>: <code>AppDynamics account access key</code></li><li><strong>Secret</strong>: Your AppDynamics access key</li></ul><p><strong>Example</strong>: <code>abcd1234-ef56-7890-gh12-ijklmnopqrst</code></p><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>You can find your AppDynamics access key in the Controller under <strong>Settings â†’ License â†’ Account</strong>.</p></div></details><h2 id=credential-security-best-practices>Credential Security Best Practices</h2><p>Follow these best practices for credential management:</p><ul><li>âœ… Use Jenkins credential encryption (built-in)</li><li>âœ… Restrict access via Jenkins role-based authorization</li><li>âœ… Rotate SSH keys periodically</li><li>âœ… Use least-privilege IAM roles for EC2 instances</li><li>âœ… Enable audit logging for credential access</li><li>âœ… Never commit credentials to version control</li></ul><h2 id=smart-agent-package-setup>Smart Agent Package Setup</h2><p>The Smart Agent ZIP file should be placed in a location accessible to Jenkins. The recommended approach is to store it in the Jenkins home directory.</p><h3 id=download-smart-agent>Download Smart Agent</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Download from AppDynamics</span>
</span></span><span class=line><span class=cl>curl -o appdsmartagent_64_linux.zip <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  <span class=s2>&#34;https://download.appdynamics.com/download/prox/download-file/smart-agent/latest/appdsmartagent_64_linux.zip&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verify the download</span>
</span></span><span class=line><span class=cl>ls -lh appdsmartagent_64_linux.zip</span></span></code></pre></div><h3 id=storage-location>Storage Location</h3><p>The pipelines reference the Smart Agent ZIP at: <code>/var/jenkins_home/smartagent/appdsmartagent.zip</code></p><p>You can either:</p><ol><li>Place the ZIP at this exact location</li><li>Modify the <code>SMARTAGENT_ZIP_PATH</code> pipeline parameter to point to your ZIP location</li></ol><h2 id=verify-configuration>Verify Configuration</h2><p>Before proceeding to pipeline creation, verify your setup:</p><h3 id=1-check-agent-status>1. Check Agent Status</h3><ol><li>Go to <strong>Manage Jenkins â†’ Nodes</strong></li><li>Verify your agent shows as &ldquo;online&rdquo;</li><li>Confirm label is set to <code>linux</code></li></ol><h3 id=2-test-ssh-connectivity>2. Test SSH Connectivity</h3><p>Create a simple test pipeline to verify SSH works:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>pipeline</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>agent</span> <span class=o>{</span> <span class=n>label</span> <span class=s1>&#39;linux&#39;</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>stages</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>stage</span><span class=o>(</span><span class=s1>&#39;Test SSH&#39;</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>steps</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                <span class=n>withCredentials</span><span class=o>([</span>
</span></span><span class=line><span class=cl>                    <span class=n>sshUserPrivateKey</span><span class=o>(</span><span class=nl>credentialsId:</span> <span class=s1>&#39;ssh-private-key&#39;</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>                                     <span class=nl>keyFileVariable:</span> <span class=s1>&#39;SSH_KEY&#39;</span><span class=o>,</span> 
</span></span><span class=line><span class=cl>                                     <span class=nl>usernameVariable:</span> <span class=s1>&#39;SSH_USER&#39;</span><span class=o>),</span>
</span></span><span class=line><span class=cl>                    <span class=n>string</span><span class=o>(</span><span class=nl>credentialsId:</span> <span class=s1>&#39;deployment-hosts&#39;</span><span class=o>,</span> <span class=nl>variable:</span> <span class=s1>&#39;HOSTS&#39;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>                <span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>sh</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>                        echo &#34;Testing SSH credentials...&#34;
</span></span></span><span class=line><span class=cl><span class=s1>                        echo &#34;$HOSTS&#34; | head -1 | while read HOST; do
</span></span></span><span class=line><span class=cl><span class=s1>                            ssh -i $SSH_KEY \
</span></span></span><span class=line><span class=cl><span class=s1>                                -o StrictHostKeyChecking=no \
</span></span></span><span class=line><span class=cl><span class=s1>                                -o ConnectTimeout=10 \
</span></span></span><span class=line><span class=cl><span class=s1>                                $SSH_USER@$HOST \
</span></span></span><span class=line><span class=cl><span class=s1>                                &#34;echo &#39;Connection successful&#39;&#34;
</span></span></span><span class=line><span class=cl><span class=s1>                        done
</span></span></span><span class=line><span class=cl><span class=s1>                    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>                <span class=o>}</span>
</span></span><span class=line><span class=cl>            <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><h3 id=3-verify-credentials-exist>3. Verify Credentials Exist</h3><ol><li>Go to <strong>Manage Jenkins â†’ Credentials</strong></li><li>Confirm all three credentials are listed:<ul><li><code>ssh-private-key</code></li><li><code>deployment-hosts</code></li><li><code>account-access-key</code></li></ul></li></ol><h2 id=troubleshooting-common-issues>Troubleshooting Common Issues</h2><h3 id=agent-not-available>Agent Not Available</h3><p><strong>Symptom</strong>: &ldquo;No agent available&rdquo; error when running pipelines</p><p><strong>Solution</strong>:</p><ul><li>Check: <strong>Manage Jenkins â†’ Nodes</strong></li><li>Ensure agent is online</li><li>Verify agent has <code>linux</code> label</li><li>Test agent connectivity</li></ul><h3 id=ssh-connection-failures>SSH Connection Failures</h3><p><strong>Symptom</strong>: Cannot connect to target hosts via SSH</p><p><strong>Solution</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Test from Jenkins agent machine</span>
</span></span><span class=line><span class=cl>ssh -i /path/to/key ubuntu@172.31.1.243 -o <span class=nv>ConnectTimeout</span><span class=o>=</span><span class=m>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check security group allows SSH from agent</span>
</span></span><span class=line><span class=cl><span class=c1># Verify private key matches public key on target</span></span></span></code></pre></div><h3 id=credential-not-found>Credential Not Found</h3><p><strong>Symptom</strong>: &ldquo;Credential not found&rdquo; error</p><p><strong>Solution</strong>:</p><ul><li>Verify credential IDs exactly match:<ul><li><code>ssh-private-key</code></li><li><code>deployment-hosts</code></li><li><code>account-access-key</code></li></ul></li><li>Check credential scope is set to <strong>Global</strong></li></ul><h3 id=permission-denied-on-target-hosts>Permission Denied on Target Hosts</h3><p><strong>Symptom</strong>: SSH succeeds but commands fail with permission denied</p><p><strong>Solution</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># On target host, verify user is in sudoers</span>
</span></span><span class=line><span class=cl>sudo visudo
</span></span><span class=line><span class=cl><span class=c1># Add line:</span>
</span></span><span class=line><span class=cl>ubuntu <span class=nv>ALL</span><span class=o>=(</span>ALL<span class=o>)</span> NOPASSWD: ALL</span></span></code></pre></div><h2 id=next-steps>Next Steps</h2><p>Now that Jenkins is configured with credentials and agents, you&rsquo;re ready to create the deployment pipelines!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=pipeline-creation>Pipeline Creation</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=overview>Overview</h2><p>The GitHub repository contains four main pipelines for managing the Smart Agent lifecycle:</p><ol><li><strong>Deploy Smart Agent</strong> - Installs and starts Smart Agent service</li><li><strong>Install Machine Agent</strong> - Installs Machine Agent via smartagentctl</li><li><strong>Install Database Agent</strong> - Installs Database Agent via smartagentctl</li><li><strong>Cleanup All Agents</strong> - Removes /opt/appdynamics directory</li></ol><p>All pipeline code is available in the <a href=https://github.com/chambear2809/sm-jenkins rel=external>sm-jenkins GitHub repository</a>.</p><h2 id=pipeline-files>Pipeline Files</h2><p>The repository contains these Jenkinsfile pipeline definitions:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>sm-jenkins/
â””â”€â”€ pipelines/
    â”œâ”€â”€ Jenkinsfile.deploy                  # Deploy Smart Agent
    â”œâ”€â”€ Jenkinsfile.install-machine-agent  # Install Machine Agent
    â”œâ”€â”€ Jenkinsfile.install-db-agent       # Install Database Agent
    â””â”€â”€ Jenkinsfile.cleanup                # Cleanup All Agents</code></pre></div><h2 id=creating-pipelines-in-jenkins>Creating Pipelines in Jenkins</h2><p>For each Jenkinsfile you want to use, follow these steps to create a pipeline in Jenkins.</p><h3 id=method-1-pipeline-from-scm-recommended>Method 1: Pipeline from SCM (Recommended)</h3><p>This method keeps your pipeline code in version control and automatically syncs changes.</p><h4 id=step-1-fork-or-clone-the-repository>Step 1: Fork or Clone the Repository</h4><p>First, fork the repository to your own GitHub account or organization, or use the original repository directly.</p><p><strong>Repository URL</strong>: <code>https://github.com/chambear2809/sm-jenkins</code></p><h4 id=step-2-create-pipeline-in-jenkins>Step 2: Create Pipeline in Jenkins</h4><ol><li>Go to <strong>Jenkins Dashboard</strong></li><li>Click <strong>New Item</strong></li><li>Enter item name (e.g., <code>Deploy-Smart-Agent</code>)</li><li>Select <strong>Pipeline</strong></li><li>Click <strong>OK</strong></li></ol><h4 id=step-3-configure-pipeline>Step 3: Configure Pipeline</h4><p>In the pipeline configuration page:</p><p><strong>General Section:</strong></p><ul><li><strong>Description</strong>: <code>Deploys AppDynamics Smart Agent to multiple hosts</code></li><li>Leave <strong>Discard old builds</strong> unchecked (or configure as desired)</li></ul><p><strong>Build Triggers:</strong></p><ul><li>Leave unchecked for manual-only execution</li><li>Or configure webhook/polling if desired</li></ul><p><strong>Pipeline Section:</strong></p><ul><li><strong>Definition</strong>: Select <code>Pipeline script from SCM</code></li><li><strong>SCM</strong>: Select <code>Git</code></li><li><strong>Repository URL</strong>: <code>https://github.com/chambear2809/sm-jenkins</code></li><li><strong>Credentials</strong>: Add if using a private repository</li><li><strong>Branch Specifier</strong>: <code>*/main</code> (or <code>*/master</code>)</li><li><strong>Script Path</strong>: <code>pipelines/Jenkinsfile.deploy</code></li></ul><h4 id=step-4-save>Step 4: Save</h4><p>Click <strong>Save</strong> to create the pipeline.</p><h4 id=step-5-repeat-for-other-pipelines>Step 5: Repeat for Other Pipelines</h4><p>Repeat steps 2-4 for each pipeline you want to create, using the appropriate script path:</p><table><thead><tr><th>Pipeline Name</th><th>Script Path</th></tr></thead><tbody><tr><td>Deploy-Smart-Agent</td><td><code>pipelines/Jenkinsfile.deploy</code></td></tr><tr><td>Install-Machine-Agent</td><td><code>pipelines/Jenkinsfile.install-machine-agent</code></td></tr><tr><td>Install-Database-Agent</td><td><code>pipelines/Jenkinsfile.install-db-agent</code></td></tr><tr><td>Cleanup-All-Agents</td><td><code>pipelines/Jenkinsfile.cleanup</code></td></tr></tbody></table><h3 id=method-2-direct-pipeline-script>Method 2: Direct Pipeline Script</h3><p>Alternatively, you can copy the Jenkinsfile content directly into Jenkins.</p><ol><li><strong>Create New Item</strong> (same as Method 1)</li><li>In <strong>Pipeline</strong> section:<ul><li><strong>Definition</strong>: Select <code>Pipeline script</code></li><li><strong>Script</strong>: Copy/paste the entire Jenkinsfile content from GitHub</li></ul></li><li><strong>Save</strong></li></ol><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Method 1 (SCM) is recommended because it keeps your pipelines in version control and makes updates easier.</p></div></details><h2 id=pipeline-parameters>Pipeline Parameters</h2><p>Each pipeline accepts configurable parameters. Here are the key parameters for the main deployment pipeline:</p><h3 id=deploy-smart-agent-pipeline-parameters>Deploy Smart Agent Pipeline Parameters</h3><table><thead><tr><th>Parameter</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>SMARTAGENT_ZIP_PATH</code></td><td><code>/var/jenkins_home/smartagent/appdsmartagent.zip</code></td><td>Path to Smart Agent ZIP on Jenkins server</td></tr><tr><td><code>REMOTE_INSTALL_DIR</code></td><td><code>/opt/appdynamics/appdsmartagent</code></td><td>Installation directory on target hosts</td></tr><tr><td><code>APPD_USER</code></td><td><code>ubuntu</code></td><td>User to run Smart Agent process</td></tr><tr><td><code>APPD_GROUP</code></td><td><code>ubuntu</code></td><td>Group to run Smart Agent process</td></tr><tr><td><code>SSH_PORT</code></td><td><code>22</code></td><td>SSH port for remote hosts</td></tr><tr><td><code>AGENT_NAME</code></td><td><code>smartagent</code></td><td>Smart Agent name</td></tr><tr><td><code>LOG_LEVEL</code></td><td><code>DEBUG</code></td><td>Log level (DEBUG, INFO, WARN, ERROR)</td></tr></tbody></table><h3 id=cleanup-pipeline-parameters>Cleanup Pipeline Parameters</h3><table><thead><tr><th>Parameter</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td><code>REMOTE_INSTALL_DIR</code></td><td><code>/opt/appdynamics/appdsmartagent</code></td><td>Directory to remove</td></tr><tr><td><code>SSH_PORT</code></td><td><code>22</code></td><td>SSH port for remote hosts</td></tr><tr><td><code>CONFIRM_CLEANUP</code></td><td><code>false</code></td><td>Must be checked to proceed with cleanup</td></tr></tbody></table><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
Warning</summary><div class=box-content><p>The cleanup pipeline includes a confirmation parameter to prevent accidental deletion. You must check <code>CONFIRM_CLEANUP</code> to execute the cleanup.</p></div></details><h2 id=understanding-pipeline-structure>Understanding Pipeline Structure</h2><p>Let&rsquo;s examine the key components of the deployment pipeline:</p><h3 id=1-agent-declaration>1. Agent Declaration</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>agent</span> <span class=o>{</span> <span class=n>label</span> <span class=s1>&#39;linux&#39;</span> <span class=o>}</span></span></span></code></pre></div><p>This ensures the pipeline runs on a Jenkins agent with the <code>linux</code> label.</p><h3 id=2-parameters-block>2. Parameters Block</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>parameters</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span><span class=o>(</span><span class=nl>name:</span> <span class=s1>&#39;SMARTAGENT_ZIP_PATH&#39;</span><span class=o>,</span> <span class=o>...)</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span><span class=o>(</span><span class=nl>name:</span> <span class=s1>&#39;REMOTE_INSTALL_DIR&#39;</span><span class=o>,</span> <span class=o>...)</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ... more parameters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span></span></span></code></pre></div><p>Defines configurable parameters that can be set when triggering the build.</p><h3 id=3-stages>3. Stages</h3><p>The deployment pipeline has these stages:</p><ol><li><strong>Preparation</strong> - Loads target hosts from credentials</li><li><strong>Extract Smart Agent</strong> - Extracts ZIP file to staging directory</li><li><strong>Configure Smart Agent</strong> - Creates config.ini template</li><li><strong>Deploy to Remote Hosts</strong> - Copies files and starts Smart Agent on each host</li><li><strong>Verify Installation</strong> - Checks Smart Agent status on all hosts</li></ol><h3 id=4-credentials-binding>4. Credentials Binding</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>withCredentials</span><span class=o>([</span>
</span></span><span class=line><span class=cl>    <span class=n>sshUserPrivateKey</span><span class=o>(</span><span class=nl>credentialsId:</span> <span class=s1>&#39;ssh-private-key&#39;</span><span class=o>,</span> <span class=o>...),</span>
</span></span><span class=line><span class=cl>    <span class=n>string</span><span class=o>(</span><span class=nl>credentialsId:</span> <span class=s1>&#39;account-access-key&#39;</span><span class=o>,</span> <span class=o>...)</span>
</span></span><span class=line><span class=cl><span class=o>])</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Pipeline code with access to credentials
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span></span></span></code></pre></div><p>Securely loads credentials without exposing them in logs.</p><h3 id=5-post-actions>5. Post Actions</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-groovy data-lang=groovy><span class=line><span class=cl><span class=n>post</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>success</span> <span class=o>{</span> <span class=o>...</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>failure</span> <span class=o>{</span> <span class=o>...</span> <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=n>always</span> <span class=o>{</span> <span class=o>...</span> <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span></span></span></code></pre></div><p>Defines actions to run after pipeline completion, regardless of success or failure.</p><h2 id=pipeline-naming-convention>Pipeline Naming Convention</h2><p>For clarity and organization, use a consistent naming convention:</p><p><strong>Recommended names:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>01-Deploy-Smart-Agent
02-Install-Machine-Agent
03-Install-Database-Agent
04-Cleanup-All-Agents</code></pre></div><p>The numeric prefix helps maintain logical ordering in the Jenkins dashboard.</p><h2 id=organizing-pipelines-with-folders>Organizing Pipelines with Folders</h2><p>For better organization, you can use Jenkins folders:</p><ol><li><p><strong>Create Folder</strong>:</p><ul><li>Click <strong>New Item</strong></li><li>Enter name: <code>AppDynamics Smart Agent</code></li><li>Select <strong>Folder</strong></li><li>Click <strong>OK</strong></li></ul></li><li><p><strong>Create Pipelines in Folder</strong>:</p><ul><li>Enter the folder</li><li>Create pipelines as described above</li></ul></li></ol><p><strong>Example structure:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>AppDynamics Smart Agent/
â”œâ”€â”€ Deployment/
â”‚   â””â”€â”€ 01-Deploy-Smart-Agent
â”œâ”€â”€ Agent Installation/
â”‚   â”œâ”€â”€ 02-Install-Machine-Agent
â”‚   â””â”€â”€ 03-Install-Database-Agent
â””â”€â”€ Cleanup/
    â””â”€â”€ 04-Cleanup-All-Agents</code></pre></div><h2 id=viewing-pipeline-code>Viewing Pipeline Code</h2><p>You can view the complete pipeline code in the GitHub repository:</p><p><strong>Main deployment pipeline:</strong>
<a href=https://github.com/chambear2809/sm-jenkins/blob/main/pipelines/Jenkinsfile.deploy rel=external>https://github.com/chambear2809/sm-jenkins/blob/main/pipelines/Jenkinsfile.deploy</a></p><p><strong>Other pipelines:</strong></p><ul><li><a href=https://github.com/chambear2809/sm-jenkins/blob/main/pipelines/Jenkinsfile.install-machine-agent rel=external>Jenkinsfile.install-machine-agent</a></li><li><a href=https://github.com/chambear2809/sm-jenkins/blob/main/pipelines/Jenkinsfile.install-db-agent rel=external>Jenkinsfile.install-db-agent</a></li><li><a href=https://github.com/chambear2809/sm-jenkins/blob/main/pipelines/Jenkinsfile.cleanup rel=external>Jenkinsfile.cleanup</a></li></ul><h2 id=testing-pipeline-configuration>Testing Pipeline Configuration</h2><p>Before running a full deployment, test your pipeline configuration:</p><h3 id=1-dry-run-with-single-host>1. Dry Run with Single Host</h3><ol><li>Create a test credential <code>deployment-hosts-test</code> with only one IP</li><li>Temporarily modify your pipeline to use this credential</li><li>Run the pipeline and verify it works on a single host</li><li>Once verified, update to use the full host list</li></ol><h3 id=2-check-syntax>2. Check Syntax</h3><p>Jenkins provides a built-in syntax validator:</p><ol><li>Go to your pipeline</li><li>Click <strong>Pipeline Syntax</strong> link</li><li>Use the <strong>Declarative Directive Generator</strong> to validate syntax</li></ol><h2 id=next-steps>Next Steps</h2><p>With pipelines created, you&rsquo;re ready to execute your first Smart Agent deployment!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=deployment-workflow>Deployment Workflow</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<h2 id=first-deployment>First Deployment</h2><p>Now that your pipelines are configured, let&rsquo;s walk through executing your first Smart Agent deployment.</p><h3 id=step-1-navigate-to-pipeline>Step 1: Navigate to Pipeline</h3><ol><li>Go to <strong>Jenkins Dashboard</strong></li><li>Click on your <strong>Deploy-Smart-Agent</strong> pipeline</li></ol><h3 id=step-2-build-with-parameters>Step 2: Build with Parameters</h3><ol><li><p>Click <strong>Build with Parameters</strong> in the left sidebar</p></li><li><p>Review the default parameters:</p><ul><li><strong>SMARTAGENT_ZIP_PATH</strong>: Verify path is correct</li><li><strong>REMOTE_INSTALL_DIR</strong>: <code>/opt/appdynamics/appdsmartagent</code></li><li><strong>APPD_USER</strong>: <code>ubuntu</code> (or your SSH user)</li><li><strong>APPD_GROUP</strong>: <code>ubuntu</code></li><li><strong>SSH_PORT</strong>: <code>22</code></li><li><strong>AGENT_NAME</strong>: <code>smartagent</code></li><li><strong>LOG_LEVEL</strong>: <code>DEBUG</code></li></ul></li><li><p>Adjust parameters if needed</p></li><li><p>Click <strong>Build</strong></p></li></ol><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>For your first deployment, consider testing on a single host by creating a separate credential with just one IP address.</p></div></details><h3 id=step-3-monitor-pipeline-execution>Step 3: Monitor Pipeline Execution</h3><p>After clicking <strong>Build</strong>, you&rsquo;ll see:</p><ol><li><strong>Build added to queue</strong> - Build number appears in Build History</li><li><strong>Click build number</strong> (e.g., #1) to view details</li><li><strong>Click Console Output</strong> to view real-time logs</li></ol><h3 id=step-4-understanding-console-output>Step 4: Understanding Console Output</h3><p>The console output shows each stage of the deployment:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Started by user admin
Running in Durability level: MAX_SURVIVABILITY
[Pipeline] Start of Pipeline
[Pipeline] node
Running on aws-vpc-agent in /home/ubuntu/jenkins/workspace/Deploy-Smart-Agent
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Preparation)
[Pipeline] script
[Pipeline] {
Preparing Smart Agent deployment to 3 hosts: 172.31.1.243, 172.31.1.48, 172.31.1.5
...</code></pre></div><p>Key stages you&rsquo;ll see:</p><ol><li>âœ… <strong>Preparation</strong> - Loads and validates host list</li><li>âœ… <strong>Extract Smart Agent</strong> - Extracts ZIP file</li><li>âœ… <strong>Configure Smart Agent</strong> - Creates config.ini</li><li>âœ… <strong>Deploy to Remote Hosts</strong> - Deploys to each host</li><li>âœ… <strong>Verify Installation</strong> - Checks Smart Agent status</li></ol><h3 id=step-5-review-results>Step 5: Review Results</h3><p>After completion, you&rsquo;ll see:</p><p><strong>Success:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Smart Agent successfully deployed to all hosts
Finished: SUCCESS</code></pre></div><p><strong>Partial Success:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Deployment completed with some failures
Failed hosts: 172.31.1.48
Finished: UNSTABLE</code></pre></div><p><strong>Failure:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Smart Agent deployment failed. Check logs for details.
Finished: FAILURE</code></pre></div><h2 id=verifying-installation>Verifying Installation</h2><p>After a successful deployment, verify Smart Agent is running on target hosts.</p><h3 id=check-smart-agent-status>Check Smart Agent Status</h3><p>SSH into a target host and check the status:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># SSH to target host</span>
</span></span><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Navigate to installation directory</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check Smart Agent status</span>
</span></span><span class=line><span class=cl>sudo ./smartagentctl status</span></span></code></pre></div><p><strong>Expected output:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Smart Agent is running (PID: 12345)
Service: appdsmartagent.service
Status: active (running)</code></pre></div><h3 id=list-installed-agents>List Installed Agents</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>sudo ./smartagentctl list</span></span></code></pre></div><p><strong>Expected output:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>No agents currently installed
(Use install-machine-agent or install-db-agent pipelines to add agents)</code></pre></div><h3 id=check-logs>Check Logs</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>tail -f log.log</span></span></code></pre></div><p>Look for successful connection messages to the AppDynamics controller.</p><h3 id=verify-in-appdynamics-controller>Verify in AppDynamics Controller</h3><ol><li>Log into your AppDynamics Controller</li><li>Navigate to <strong>Servers â†’ Servers</strong></li><li>Look for your newly deployed hosts</li><li>Verify Smart Agent is reporting metrics</li></ol><h2 id=installing-additional-agents>Installing Additional Agents</h2><p>Once Smart Agent is deployed, you can install specific agent types using the other pipelines.</p><h3 id=install-machine-agent>Install Machine Agent</h3><ol><li>Go to <strong>Install-Machine-Agent</strong> pipeline</li><li>Click <strong>Build with Parameters</strong></li><li>Review parameters:<ul><li><strong>AGENT_NAME</strong>: <code>machine-agent</code></li><li><strong>SSH_PORT</strong>: <code>22</code></li></ul></li><li>Click <strong>Build</strong></li></ol><p>The pipeline will SSH to each host and execute:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>sudo ./smartagentctl install --component machine</span></span></code></pre></div><h3 id=install-database-agent>Install Database Agent</h3><ol><li>Go to <strong>Install-Database-Agent</strong> pipeline</li><li>Click <strong>Build with Parameters</strong></li><li>Configure database connection parameters</li><li>Click <strong>Build</strong></li></ol><p>The pipeline will install and configure the Database Agent on all hosts.</p><h3 id=verify-agent-installation>Verify Agent Installation</h3><p>After installing agents, verify they appear:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>sudo ./smartagentctl list</span></span></code></pre></div><p><strong>Expected output:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Installed agents:
- machine-agent (running)
- db-agent (running)</code></pre></div><h2 id=common-deployment-scenarios>Common Deployment Scenarios</h2><h3 id=scenario-1-initial-deployment>Scenario 1: Initial Deployment</h3><p><strong>Workflow:</strong></p><ol><li>Run <strong>Deploy-Smart-Agent</strong> pipeline</li><li>Wait for completion and verify</li><li>Run <strong>Install-Machine-Agent</strong> if needed</li><li>Run <strong>Install-Database-Agent</strong> if needed</li></ol><h3 id=scenario-2-update-smart-agent>Scenario 2: Update Smart Agent</h3><p>To update Smart Agent to a new version:</p><ol><li>Download new Smart Agent ZIP</li><li>Place it in Jenkins at configured path</li><li>Run <strong>Deploy-Smart-Agent</strong> pipeline again</li></ol><p>The pipeline automatically:</p><ul><li>Stops existing Smart Agent</li><li>Removes old files</li><li>Installs new version</li><li>Restarts Smart Agent</li></ul><h3 id=scenario-3-add-new-hosts>Scenario 3: Add New Hosts</h3><p>To add Smart Agent to new hosts:</p><ol><li>Update the <code>deployment-hosts</code> credential in Jenkins</li><li>Add new IP addresses (one per line)</li><li>Run <strong>Deploy-Smart-Agent</strong> pipeline</li></ol><p>The pipeline will:</p><ul><li>Skip already-configured hosts (if idempotent)</li><li>Deploy to new hosts only</li></ul><h3 id=scenario-4-complete-removal>Scenario 4: Complete Removal</h3><p>To completely remove Smart Agent from all hosts:</p><ol><li>Go to <strong>Cleanup-All-Agents</strong> pipeline</li><li>Click <strong>Build with Parameters</strong></li><li><strong>Check</strong> the <code>CONFIRM_CLEANUP</code> checkbox</li><li>Click <strong>Build</strong></li></ol><details open class="box cstyle notices" style=--VARIABLE-BOX-color:danger><summary class="box-label a11y-only" tabindex=-1><span class=a11y-only>Details</span></summary><div class=box-content><p>This will permanently delete <code>/opt/appdynamics/appdsmartagent</code> directory from all hosts. This action cannot be undone.</p></div></details><h2 id=troubleshooting-deployments>Troubleshooting Deployments</h2><h3 id=build-fails-at-preparation-stage>Build Fails at Preparation Stage</h3><p><strong>Symptom</strong>: Pipeline fails when loading host list</p><p><strong>Cause</strong>: Missing or incorrect <code>deployment-hosts</code> credential</p><p><strong>Solution</strong>:</p><ol><li>Go to <strong>Manage Jenkins â†’ Credentials</strong></li><li>Verify <code>deployment-hosts</code> credential exists</li><li>Check format (one IP per line, no commas)</li><li>Ensure no trailing spaces</li></ol><h3 id=ssh-connection-failures>SSH Connection Failures</h3><p><strong>Symptom</strong>: &ldquo;Permission denied&rdquo; or &ldquo;Connection refused&rdquo; errors</p><p><strong>Solutions</strong>:</p><p><strong>Check security group:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Verify Jenkins agent can reach target</span>
</span></span><span class=line><span class=cl>ping 172.31.1.243
</span></span><span class=line><span class=cl>telnet 172.31.1.243 <span class=m>22</span></span></span></code></pre></div><p><strong>Test SSH manually:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># From Jenkins agent machine</span>
</span></span><span class=line><span class=cl>ssh -i /path/to/key ubuntu@172.31.1.243</span></span></code></pre></div><p><strong>Verify SSH key:</strong></p><ol><li>Ensure <code>ssh-private-key</code> credential is correct</li><li>Verify public key is in <code>~/.ssh/authorized_keys</code> on target hosts</li></ol><h3 id=smart-agent-fails-to-start>Smart Agent Fails to Start</h3><p><strong>Symptom</strong>: Deployment completes but Smart Agent not running</p><p><strong>Solution</strong>:</p><p><strong>Check logs on target host:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>cat log.log</span></span></code></pre></div><p><strong>Common issues:</strong></p><ul><li><strong>Invalid access key</strong>: Check <code>account-access-key</code> credential</li><li><strong>Network connectivity</strong>: Verify outbound HTTPS to Controller</li><li><strong>Permission issues</strong>: Ensure APPD_USER has correct permissions</li></ul><h3 id=partial-deployment-success>Partial Deployment Success</h3><p><strong>Symptom</strong>: Some hosts succeed, others fail</p><p><strong>Solution</strong>:</p><ol><li><strong>Check Console Output</strong> - Identifies which hosts failed</li><li><strong>Investigate failed hosts</strong> - SSH and test manually</li><li><strong>Re-run pipeline</strong> - Jenkins tracks which hosts need retry</li></ol><h2 id=pipeline-best-practices>Pipeline Best Practices</h2><h3 id=1-test-on-single-host-first>1. Test on Single Host First</h3><p>Always test new configurations on a single host before deploying to production:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>1. Create deployment-hosts-test credential (1 IP)
2. Create test pipeline pointing to this credential
3. Verify success
4. Deploy to full host list</code></pre></div><h3 id=2-use-descriptive-build-descriptions>2. Use Descriptive Build Descriptions</h3><p>After triggering a build, add a description:</p><ol><li>Go to build page</li><li>Click <strong>Edit Build Information</strong></li><li>Add description: &ldquo;Production deployment - Q4 2024&rdquo;</li></ol><h3 id=3-monitor-build-history>3. Monitor Build History</h3><p>Regularly check build history for patterns:</p><ul><li>Failed builds</li><li>Duration trends</li><li>Error messages</li></ul><h3 id=4-schedule-deployments-during-maintenance-windows>4. Schedule Deployments During Maintenance Windows</h3><p>For production systems:</p><ul><li>Use Jenkins scheduled builds</li><li>Deploy during low-traffic periods</li><li>Have rollback plan ready</li></ul><h3 id=5-keep-credentials-updated>5. Keep Credentials Updated</h3><ul><li>Rotate SSH keys quarterly</li><li>Update host lists as infrastructure changes</li><li>Verify AppDynamics access key validity</li></ul><h2 id=next-steps>Next Steps</h2><p>Now let&rsquo;s explore scaling and operational considerations for large deployments.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=github-actions-automation>GitHub Actions Automation</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>2 minutes</span>
</span>&nbsp;<h2 id=introduction>Introduction</h2><p>This workshop demonstrates how to use <strong>GitHub Actions</strong> with a self-hosted runner to automate the deployment and lifecycle management of <strong>AppDynamics Smart Agent</strong> across multiple EC2 instances. Whether you&rsquo;re managing 10 hosts or 10,000, this guide shows you how to leverage GitHub Actions workflows for scalable, secure, and repeatable Smart Agent operations.</p><p><a href=#R-image-2c8c19fd642cfc64e49ee611787b09dc class=lightbox-link><img alt="GitHub Actions and AppDynamics" class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/GitHub%20Actions-2088FF?style=flat&logo=github-actions&logoColor=white" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2c8c19fd642cfc64e49ee611787b09dc><img alt="GitHub Actions and AppDynamics" class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/GitHub%20Actions-2088FF?style=flat&logo=github-actions&logoColor=white"></a> <a href=#R-image-2deb81ff6d19d2f0204a39deaf51029c class=lightbox-link><img alt=AppDynamics class="lazy lightbox figure-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat" style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2deb81ff6d19d2f0204a39deaf51029c><img alt=AppDynamics class="lazy lightbox lightbox-image" loading=lazy src="https://img.shields.io/badge/AppDynamics-0078D4?style=flat"></a></p><h2 id=what-youll-learn>What You&rsquo;ll Learn</h2><p>In this workshop, you&rsquo;ll learn how to:</p><ul><li><strong>Deploy Smart Agent</strong> to multiple hosts using GitHub Actions workflows</li><li><strong>Configure GitHub secrets and variables</strong> for secure credentials management</li><li><strong>Set up a self-hosted runner</strong> in your AWS VPC</li><li><strong>Implement automatic batching</strong> to scale to thousands of hosts</li><li><strong>Manage the complete agent lifecycle</strong> - install, uninstall, stop, and cleanup</li><li><strong>Monitor workflow execution</strong> and troubleshoot issues</li></ul><h2 id=key-features>Key Features</h2><ul><li>ðŸš€ <strong>Parallel Deployment</strong> - Deploy to multiple hosts simultaneously</li><li>ðŸ”„ <strong>Complete Lifecycle Management</strong> - 11 workflows covering all agent operations</li><li>ðŸ—ï¸ <strong>Infrastructure as Code</strong> - All workflows version-controlled in GitHub</li><li>ðŸ” <strong>Secure</strong> - SSH keys stored as GitHub secrets, private VPC networking</li><li>ðŸ“ˆ <strong>Massively Scalable</strong> - Deploy to thousands of hosts with automatic batching</li><li>ðŸŽ›ï¸ <strong>Self-hosted Runner</strong> - Executes within your AWS VPC</li></ul><h2 id=architecture-overview>Architecture Overview</h2><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  GitHub Actions-based Deployment                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Developer â”€â”€â–¶ GitHub.com â”€â”€â–¶ Self-hosted Runner (AWS VPC)     â”‚
â”‚                                          â”‚                       â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 1 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 2 (SSH)      â”‚
â”‚                                          â”œâ”€â”€â–¶ Host 3 (SSH)      â”‚
â”‚                                          â””â”€â”€â–¶ Host N (SSH)      â”‚
â”‚                                                                  â”‚
â”‚  All hosts send metrics â”€â”€â–¶ AppDynamics Controller             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h2 id=workshop-components>Workshop Components</h2><p>This workshop includes:</p><ol><li><strong>Architecture & Design</strong> - Understanding the GitHub Actions workflow architecture</li><li><strong>GitHub Setup</strong> - Configuring secrets, variables, and self-hosted runners</li><li><strong>Workflow Creation</strong> - Understanding and using the 11 available workflows</li><li><strong>Deployment Execution</strong> - Running workflows and verifying installations</li></ol><h2 id=available-workflows>Available Workflows</h2><p>This solution includes <strong>11 workflows</strong> for complete Smart Agent lifecycle management:</p><table><thead><tr><th>Category</th><th>Workflows</th><th>Description</th></tr></thead><tbody><tr><td><strong>Deployment</strong></td><td>1</td><td>Deploy and start Smart Agent</td></tr><tr><td><strong>Agent Installation</strong></td><td>4</td><td>Install Node, Machine, DB, and Java agents</td></tr><tr><td><strong>Agent Uninstallation</strong></td><td>4</td><td>Uninstall specific agent types</td></tr><tr><td><strong>Agent Management</strong></td><td>2</td><td>Stop/clean and complete cleanup</td></tr></tbody></table><p>All workflows support automatic batching for scalability!</p><h2 id=prerequisites>Prerequisites</h2><ul><li>GitHub account with repository access</li><li>AWS VPC with Ubuntu EC2 instances</li><li>Self-hosted GitHub Actions runner in the same VPC</li><li>SSH key pair for authentication</li><li>AppDynamics Smart Agent package</li></ul><h2 id=github-repository>GitHub Repository</h2><p>All workflow code and configuration files are available in the GitHub repository:</p><p><strong><a href=https://github.com/chambear2809/github-actions-lab rel=external>https://github.com/chambear2809/github-actions-lab</a></strong></p><p>The repository includes:</p><ul><li>11 complete workflow YAML files</li><li>Detailed setup documentation</li><li>Architecture diagrams</li><li>Troubleshooting guides</li></ul><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The easiest way to navigate through this workshop is by using:</p><ul><li>the left/right arrows (<strong>&lt;</strong> | <strong>></strong>) on the top right of this page</li><li>the left (â—€ï¸) and right (â–¶ï¸) cursor keys on your keyboard</li></ul></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of GitHub Actions Automation</h1><article class=default><header class=headline></header><h1 id=architecture--design>Architecture & Design</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h2 id=system-architecture>System Architecture</h2><p>The GitHub Actions-based Smart Agent deployment system uses a self-hosted runner within your AWS VPC to orchestrate deployments to multiple target hosts via SSH.</p><h3 id=high-level-architecture>High-Level Architecture</h3><pre class="mermaid align-center">graph TB
    subgraph Internet
        GH[GitHub.com&lt;br/&gt;Repository &amp; Actions]
        User[Developer&lt;br/&gt;Local Machine]
    end

    subgraph AWS[&#34;AWS VPC (172.31.0.0/16)&#34;]
        subgraph SG[&#34;Security Group: smartagent-lab&#34;]
            Runner[Self-hosted Runner&lt;br/&gt;EC2 Instance&lt;br/&gt;172.31.1.x]
            
            subgraph Targets[&#34;Target Hosts&#34;]
                T1[Target Host 1&lt;br/&gt;Ubuntu EC2&lt;br/&gt;172.31.1.243]
                T2[Target Host 2&lt;br/&gt;Ubuntu EC2&lt;br/&gt;172.31.1.48]
                T3[Target Host 3&lt;br/&gt;Ubuntu EC2&lt;br/&gt;172.31.1.5]
            end
        end
    end

    User --&gt;|git push| GH
    GH &lt;--&gt;|HTTPS:443&lt;br/&gt;Poll for jobs| Runner
    Runner --&gt;|SSH:22&lt;br/&gt;Private IPs| T1
    Runner --&gt;|SSH:22&lt;br/&gt;Private IPs| T2
    Runner --&gt;|SSH:22&lt;br/&gt;Private IPs| T3

    style GH fill:#24292e,color:#fff
    style User fill:#0366d6,color:#fff
    style Runner fill:#28a745,color:#fff
    style T1 fill:#ffd33d,color:#000
    style T2 fill:#ffd33d,color:#000
    style T3 fill:#ffd33d,color:#000</pre><h2 id=network-architecture>Network Architecture</h2><p>All infrastructure runs in a single AWS VPC with a shared security group. The self-hosted runner communicates with target hosts via private IPs.</p><h3 id=vpc-layout>VPC Layout</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS VPC (172.31.0.0/16)                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          Security Group: smartagent-lab                   â”‚  â”‚
â”‚  â”‚  Rules:                                                   â”‚  â”‚
â”‚  â”‚  - Inbound: SSH (22) from same security group            â”‚  â”‚
â”‚  â”‚  - Outbound: HTTPS (443) to GitHub                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Self-hosted â”‚    â”‚  Target EC2  â”‚    â”‚  Target EC2  â”‚       â”‚
â”‚  â”‚   Runner    â”‚    â”‚              â”‚    â”‚              â”‚       â”‚
â”‚  â”‚             â”‚â”€â”€â”€â–¶â”‚ Private IP:  â”‚    â”‚ Private IP:  â”‚       â”‚
â”‚  â”‚ 172.31.1.x  â”‚SSH â”‚ 172.31.1.243 â”‚    â”‚ 172.31.1.48  â”‚       â”‚
â”‚  â”‚             â”‚â”€â”€â”€â–¶â”‚              â”‚    â”‚              â”‚       â”‚
â”‚  â”‚ Polls GitHubâ”‚    â”‚ Ubuntu 20.04 â”‚    â”‚ Ubuntu 20.04 â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â”‚                    â”‚                    â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                              â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   AppDynamics    â”‚
                    â”‚    Controller    â”‚
                    â”‚  (SaaS/On-Prem)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h2 id=workflow-execution-flow>Workflow Execution Flow</h2><h3 id=complete-deployment-sequence>Complete Deployment Sequence</h3><pre class="mermaid align-center">sequenceDiagram
    participant Dev as Developer
    participant GH as GitHub
    participant Runner as Self-hosted Runner
    participant Target as Target Host(s)

    Dev-&gt;&gt;GH: 1. Push code or trigger workflow
    GH-&gt;&gt;GH: 2. Workflow event triggered
    Runner-&gt;&gt;GH: 3. Poll for jobs (HTTPS:443)
    GH-&gt;&gt;Runner: 4. Assign job to runner
    Runner-&gt;&gt;Runner: 5. Execute prepare job&lt;br/&gt;(load host matrix)
    
    par Parallel Execution
        Runner-&gt;&gt;Target: 6a. SSH to Host 1&lt;br/&gt;(port 22)
        Runner-&gt;&gt;Target: 6b. SSH to Host 2&lt;br/&gt;(port 22)
        Runner-&gt;&gt;Target: 6c. SSH to Host 3&lt;br/&gt;(port 22)
    end
    
    Target-&gt;&gt;Target: 7. Execute commands&lt;br/&gt;(install/uninstall/stop/clean)
    Target--&gt;&gt;Runner: 8. Return results
    Runner--&gt;&gt;GH: 9. Report job status
    GH--&gt;&gt;Dev: 10. Notify completion</pre><h2 id=component-details>Component Details</h2><h3 id=github-repository>GitHub Repository</h3><p><strong>Stores:</strong></p><ul><li>11 workflow YAML files</li><li>Smart Agent installation package</li><li>Configuration file (config.ini)</li></ul><p><strong>Secrets:</strong></p><ul><li>SSH private key</li></ul><p><strong>Variables:</strong></p><ul><li>Host list (DEPLOYMENT_HOSTS)</li><li>User/group settings (optional)</li></ul><h3 id=self-hosted-runner>Self-hosted Runner</h3><p><strong>Location:</strong></p><ul><li>AWS VPC (same as targets)</li><li>Private network access</li></ul><p><strong>Responsibilities:</strong></p><ul><li>Poll GitHub for workflow jobs</li><li>Execute workflow steps</li><li>SSH to target hosts</li><li>File transfers (SCP)</li><li>Parallel execution</li><li>Error collection</li></ul><p><strong>Requirements:</strong></p><ul><li>Ubuntu/Amazon Linux 2</li><li>Outbound HTTPS (443) to GitHub</li><li>Outbound SSH (22) to target hosts</li><li>SSH key authentication</li></ul><p><strong>Access:</strong></p><ul><li>Outbound HTTPS (443) to GitHub</li><li>Outbound SSH (22) to target hosts</li><li>Uses SSH key authentication</li></ul><h3 id=target-hosts>Target Hosts</h3><p><strong>Pre-requisites:</strong></p><ul><li>Ubuntu 20.04+</li><li>SSH server running</li><li>User with sudo access</li><li>Authorized SSH key</li></ul><p><strong>Post-deployment:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>/opt/appdynamics/
â””â”€â”€ appdsmartagent/
    â”œâ”€â”€ smartagentctl
    â”œâ”€â”€ config.ini
    â””â”€â”€ agents/
        â”œâ”€â”€ machine/
        â”œâ”€â”€ java/
        â”œâ”€â”€ node/
        â””â”€â”€ db/</code></pre></div><h2 id=security-architecture>Security Architecture</h2><h3 id=security-layers>Security Layers</h3><ol><li><p><strong>AWS VPC Isolation</strong></p><ul><li>Private subnet for hosts</li><li>No direct internet access required</li><li>VPC flow logs enabled</li></ul></li><li><p><strong>Security Groups</strong></p><ul><li>SSH (22) within same security group only</li><li>HTTPS (443) outbound for GitHub access</li><li>Stateful firewall rules</li></ul></li><li><p><strong>SSH Key Authentication</strong></p><ul><li>No password authentication</li><li>Keys stored in GitHub Secrets</li><li>Temporary key files on runner</li><li>Keys removed after workflow</li></ul></li><li><p><strong>GitHub Security</strong></p><ul><li>Repository access controls</li><li>Branch protection rules</li><li>Secrets never exposed in logs</li><li>Environment variable masking</li></ul></li><li><p><strong>Network Security</strong></p><ul><li>Private IP communication only</li><li>No public IPs required</li><li>Runner in same VPC as targets</li></ul></li></ol><h2 id=workflow-categories>Workflow Categories</h2><p>The system includes 11 workflows organized into 4 categories:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>GitHub Actions Workflows (11 Total)
â”œâ”€â”€ Deployment (1 workflow)
â”‚   â””â”€â”€ Deploy Smart Agent (Batched)
â”œâ”€â”€ Agent Installation (4 workflows)
â”‚   â”œâ”€â”€ Install Node Agent (Batched)
â”‚   â”œâ”€â”€ Install Machine Agent (Batched)
â”‚   â”œâ”€â”€ Install DB Agent (Batched)
â”‚   â””â”€â”€ Install Java Agent (Batched)
â”œâ”€â”€ Agent Uninstallation (4 workflows)
â”‚   â”œâ”€â”€ Uninstall Node Agent (Batched)
â”‚   â”œâ”€â”€ Uninstall Machine Agent (Batched)
â”‚   â”œâ”€â”€ Uninstall DB Agent (Batched)
â”‚   â””â”€â”€ Uninstall Java Agent (Batched)
â””â”€â”€ Smart Agent Management (2 workflows)
    â”œâ”€â”€ Stop and Clean Smart Agent (Batched)
    â””â”€â”€ Cleanup All Agents (Batched)</code></pre></div><h2 id=batching-strategy>Batching Strategy</h2><p>All workflows use automatic batching to support deployments at any scale.</p><h3 id=how-batching-works>How Batching Works</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>HOST LIST (1000 hosts)              BATCH_SIZE = 256

Host 001: 172.31.1.1                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
Host 002: 172.31.1.2      â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚   BATCH 1        â”‚
    ...                              â”‚   Hosts 1-256    â”‚ â”€â”€â”€â”
Host 256: 172.31.1.256               â”‚   Sequential     â”‚    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
Host 257: 172.31.1.257               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
Host 258: 172.31.1.258   â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   BATCH 2        â”‚    â”‚ SEQUENTIAL
    ...                              â”‚   Hosts 257-512  â”‚    â”‚ EXECUTION
Host 512: 172.31.1.512               â”‚   Sequential     â”‚    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
Host 513: 172.31.1.513               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
    ...                              â”‚   BATCH 3        â”‚    â”‚
Host 768: 172.31.1.768   â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   Hosts 513-768  â”‚ â”€â”€â”€â”˜
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Host 769: 172.31.1.769               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    ...                              â”‚   BATCH 4        â”‚
Host 1000: 172.31.2.232  â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚   Hosts 769-1000 â”‚
                                     â”‚   (232 hosts)    â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

WITHIN EACH BATCH:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  All hosts deploy in PARALLEL          â”‚
â”‚                                        â”‚
â”‚  Host 1 â”€â”€â”                           â”‚
â”‚  Host 2 â”€â”€â”¤                           â”‚
â”‚  Host 3 â”€â”€â”¼â”€â–¶ Background processes (&amp;)â”‚
â”‚    ...    â”‚                           â”‚
â”‚  Host 256â”€â”˜   â””â”€â–¶ wait command        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre></div><h3 id=why-sequential-batches>Why Sequential Batches?</h3><p><strong>Resource Management:</strong></p><ul><li>Prevents overwhelming the self-hosted runner</li><li>Each batch opens 256 parallel SSH connections</li><li>Sequential processing ensures stable performance</li></ul><p><strong>Configurable:</strong></p><ul><li>Default batch size: 256 (GitHub Actions matrix limit)</li><li>Adjustable via workflow input for smaller batches</li><li>Balance between speed and resource usage</li></ul><h3 id=scaling-characteristics>Scaling Characteristics</h3><p><strong>Deployment Speed (default BATCH_SIZE=256):</strong></p><ul><li>10 hosts â†’ 1 batch â†’ ~2 minutes</li><li>100 hosts â†’ 1 batch â†’ ~3 minutes</li><li>500 hosts â†’ 2 batches â†’ ~6 minutes</li><li>1,000 hosts â†’ 4 batches â†’ ~12 minutes</li><li>5,000 hosts â†’ 20 batches â†’ ~60 minutes</li></ul><p><strong>Factors affecting speed:</strong></p><ul><li>Network bandwidth (19MB package per host)</li><li>SSH connection overhead (~1s per host)</li><li>Target host CPU/disk speed</li><li>Runner resources (CPU/memory)</li></ul><h2 id=next-steps>Next Steps</h2><p>Now that you understand the architecture, let&rsquo;s move on to setting up GitHub and configuring the self-hosted runner.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=github-setup>GitHub Setup</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=prerequisites>Prerequisites</h2><p>Before you begin, ensure you have:</p><ul><li>GitHub account with repository access</li><li>AWS VPC with Ubuntu EC2 instances</li><li>SSH key pair (PEM file) for authentication to target hosts</li><li>AppDynamics Smart Agent package</li><li>Target Ubuntu EC2 instances with SSH access</li></ul><h2 id=fork-or-clone-the-repository>Fork or Clone the Repository</h2><p>First, get access to the GitHub Actions lab repository:</p><p><strong>Repository URL</strong>: <a href=https://github.com/chambear2809/github-actions-lab rel=external>https://github.com/chambear2809/github-actions-lab</a></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Option 1: Fork the repository via GitHub UI</span>
</span></span><span class=line><span class=cl><span class=c1># Go to https://github.com/chambear2809/github-actions-lab</span>
</span></span><span class=line><span class=cl><span class=c1># Click &#34;Fork&#34; button</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Option 2: Clone directly (for testing)</span>
</span></span><span class=line><span class=cl>git clone https://github.com/chambear2809/github-actions-lab.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> github-actions-lab</span></span></code></pre></div><h2 id=configure-self-hosted-runner>Configure Self-hosted Runner</h2><p>Your self-hosted runner must be deployed in the same AWS VPC as your target EC2 instances.</p><h3 id=install-runner-on-ec2-instance>Install Runner on EC2 Instance</h3><ol><li><p><strong>Launch EC2 instance</strong> in your VPC (Ubuntu or Amazon Linux 2)</p></li><li><p><strong>Navigate to runner settings</strong> in your forked repository:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Settings â†’ Actions â†’ Runners â†’ New self-hosted runner</code></pre></div></li><li><p><strong>SSH into the runner instance</strong> and execute installation commands:</p></li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Create runner directory</span>
</span></span><span class=line><span class=cl>mkdir actions-runner <span class=o>&amp;&amp;</span> <span class=nb>cd</span> actions-runner
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download runner (check GitHub for latest version)</span>
</span></span><span class=line><span class=cl>curl -o actions-runner-linux-x64-2.311.0.tar.gz -L <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  https://github.com/actions/runner/releases/download/v2.311.0/actions-runner-linux-x64-2.311.0.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Extract</span>
</span></span><span class=line><span class=cl>tar xzf ./actions-runner-linux-x64-2.311.0.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Configure (use token from GitHub UI)</span>
</span></span><span class=line><span class=cl>./config.sh --url https://github.com/YOUR_USERNAME/github-actions-lab --token YOUR_TOKEN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Install as service</span>
</span></span><span class=line><span class=cl>sudo ./svc.sh install
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Start service</span>
</span></span><span class=line><span class=cl>sudo ./svc.sh start</span></span></code></pre></div><h3 id=verify-runner-status>Verify Runner Status</h3><p>Check that the runner appears as <strong>&ldquo;Idle&rdquo;</strong> (green) in:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Settings â†’ Actions â†’ Runners</code></pre></div><details open class="box cstyle notices tip"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>The runner must remain online and idle to pick up workflow jobs. If it shows offline, check the service status: <code>sudo ./svc.sh status</code></p></div></details><h2 id=configure-github-secrets>Configure GitHub Secrets</h2><p>Navigate to: <strong>Settings â†’ Secrets and variables â†’ Actions â†’ Secrets</strong></p><h3 id=ssh-private-key-secret>SSH Private Key Secret</h3><p>This secret contains your SSH private key for accessing target hosts.</p><ol><li>Click <strong>&ldquo;New repository secret&rdquo;</strong></li><li><strong>Name</strong>: <code>SSH_PRIVATE_KEY</code></li><li><strong>Value</strong>: Paste the contents of your PEM file</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># View your PEM file</span>
</span></span><span class=line><span class=cl>cat /path/to/your-key.pem</span></span></code></pre></div><p>Example format:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
...
-----END RSA PRIVATE KEY-----</code></pre></div><ol start=4><li>Click <strong>&ldquo;Add secret&rdquo;</strong></li></ol><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
Important</summary><div class=box-content><p>Never commit SSH keys to your repository! Always use GitHub Secrets for sensitive credentials.</p></div></details><h2 id=configure-github-variables>Configure GitHub Variables</h2><p>Navigate to: <strong>Settings â†’ Secrets and variables â†’ Actions â†’ Variables</strong></p><h3 id=deployment-hosts-variable-required>Deployment Hosts Variable (Required)</h3><p>This variable contains the list of all target hosts where Smart Agent should be deployed.</p><ol><li>Click <strong>&ldquo;New repository variable&rdquo;</strong></li><li><strong>Name</strong>: <code>DEPLOYMENT_HOSTS</code></li><li><strong>Value</strong>: Enter your target host IPs (one per line)</li></ol><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>172.31.1.243
172.31.1.48
172.31.1.5
172.31.10.20
172.31.10.21</code></pre></div><p><strong>Format Requirements:</strong></p><ul><li>One IP per line</li><li>No commas</li><li>No spaces</li><li>No extra characters</li><li>Use Unix line endings (LF, not CRLF)</li></ul><ol start=4><li>Click <strong>&ldquo;Add variable&rdquo;</strong></li></ol><h3 id=optional-variables>Optional Variables</h3><p>These variables are optional and used for Smart Agent service user/group configuration:</p><h4 id=smartagent_user>SMARTAGENT_USER</h4><ol><li>Click <strong>&ldquo;New repository variable&rdquo;</strong></li><li><strong>Name</strong>: <code>SMARTAGENT_USER</code></li><li><strong>Value</strong>: e.g., <code>appdynamics</code></li><li>Click <strong>&ldquo;Add variable&rdquo;</strong></li></ol><h4 id=smartagent_group>SMARTAGENT_GROUP</h4><ol><li>Click <strong>&ldquo;New repository variable&rdquo;</strong></li><li><strong>Name</strong>: <code>SMARTAGENT_GROUP</code></li><li><strong>Value</strong>: e.g., <code>appdynamics</code></li><li>Click <strong>&ldquo;Add variable&rdquo;</strong></li></ol><h2 id=network-configuration>Network Configuration</h2><p>For the lab setup with all EC2 instances in the same VPC and security group:</p><h3 id=security-group-rules>Security Group Rules</h3><p><strong>Inbound Rules:</strong></p><ul><li>SSH (port 22) from same security group (source: same SG)</li></ul><p><strong>Outbound Rules:</strong></p><ul><li>HTTPS (port 443) to 0.0.0.0/0 (for GitHub API access)</li><li>SSH (port 22) to same security group (for target access)</li></ul><h3 id=network-best-practices>Network Best Practices</h3><ul><li>âœ… Use private IP addresses (172.31.x.x) for <code>DEPLOYMENT_HOSTS</code></li><li>âœ… Runner and targets in same security group</li><li>âœ… No public IPs needed on target hosts</li><li>âœ… Runner communicates via private network</li><li>âœ… Outbound HTTPS required for GitHub polling</li></ul><h2 id=verify-configuration>Verify Configuration</h2><p>Before running workflows, verify your setup:</p><h3 id=1-check-runner-status>1. Check Runner Status</h3><ol><li>Go to <strong>Settings â†’ Actions â†’ Runners</strong></li><li>Verify runner shows as &ldquo;Idle&rdquo; (green)</li><li>Check &ldquo;Last seen&rdquo; timestamp is recent</li></ol><h3 id=2-test-ssh-connectivity>2. Test SSH Connectivity</h3><p>SSH from your runner instance to a target host:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># On runner instance</span>
</span></span><span class=line><span class=cl>ssh -i ~/.ssh/your-key.pem ubuntu@172.31.1.243</span></span></code></pre></div><p>If successful, you should get a shell prompt on the target host.</p><h3 id=3-verify-secrets-and-variables>3. Verify Secrets and Variables</h3><ol><li>Go to <strong>Settings â†’ Secrets and variables â†’ Actions</strong></li><li>Confirm secrets tab shows: <code>SSH_PRIVATE_KEY</code></li><li>Confirm variables tab shows: <code>DEPLOYMENT_HOSTS</code></li></ol><h3 id=4-check-repository-access>4. Check Repository Access</h3><p>Ensure the runner can access the repository:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># On runner instance, as the runner user</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ~/actions-runner
</span></span><span class=line><span class=cl>./run.sh  <span class=c1># Test run (Ctrl+C to stop)</span></span></span></code></pre></div><p>You should see: &ldquo;Listening for Jobs&rdquo;</p><h2 id=troubleshooting-common-issues>Troubleshooting Common Issues</h2><h3 id=runner-not-picking-up-jobs>Runner Not Picking Up Jobs</h3><p><strong>Symptom</strong>: Workflows stay in &ldquo;queued&rdquo; state</p><p><strong>Solution</strong>:</p><ul><li>Check runner status: <code>sudo systemctl status actions.runner.*</code></li><li>Restart runner: <code>sudo ./svc.sh restart</code></li><li>Verify outbound HTTPS (443) connectivity to GitHub</li></ul><h3 id=ssh-connection-failures>SSH Connection Failures</h3><p><strong>Symptom</strong>: Workflows fail with &ldquo;Permission denied&rdquo; or &ldquo;Connection refused&rdquo;</p><p><strong>Solution</strong>:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Test from runner</span>
</span></span><span class=line><span class=cl>ssh -i ~/.ssh/test-key.pem ubuntu@172.31.1.243 -o <span class=nv>ConnectTimeout</span><span class=o>=</span><span class=m>10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check security group allows SSH from runner</span>
</span></span><span class=line><span class=cl><span class=c1># Verify private key matches public key on targets</span></span></span></code></pre></div><h3 id=invalid-characters-in-hostname>Invalid Characters in Hostname</h3><p><strong>Symptom</strong>: Error: &ldquo;hostname contains invalid characters&rdquo;</p><p><strong>Solution</strong>:</p><ul><li>Edit <code>DEPLOYMENT_HOSTS</code> variable</li><li>Ensure no trailing spaces</li><li>Use Unix line endings (LF, not CRLF)</li><li>One IP per line, no extra characters</li></ul><h3 id=secrets-not-found>Secrets Not Found</h3><p><strong>Symptom</strong>: Error: &ldquo;Secret SSH_PRIVATE_KEY not found&rdquo;</p><p><strong>Solution</strong>:</p><ul><li>Verify secret name exactly matches: <code>SSH_PRIVATE_KEY</code></li><li>Check secret is in repository secrets (not environment secrets)</li><li>Ensure you have repository admin access</li></ul><h2 id=security-best-practices>Security Best Practices</h2><p>Follow these best practices for secure operations:</p><ul><li>âœ… Use GitHub Secrets for all private keys</li><li>âœ… Rotate SSH keys regularly</li><li>âœ… Keep runner in private VPC subnet</li><li>âœ… Restrict runner security group to minimal access</li><li>âœ… Update runner software regularly</li><li>âœ… Enable branch protection rules</li><li>âœ… Use separate keys for different environments</li><li>âœ… Enable audit logging for repository access</li></ul><h2 id=next-steps>Next Steps</h2><p>With GitHub configured and the runner set up, you&rsquo;re ready to explore the available workflows and execute your first deployment!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=understanding-workflows>Understanding Workflows</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<h2 id=available-workflows>Available Workflows</h2><p>The GitHub Actions lab includes <strong>11 workflows</strong> for complete Smart Agent lifecycle management. All workflow files are available in the repository at <code>.github/workflows/</code>.</p><p><strong>Repository</strong>: <a href=https://github.com/chambear2809/github-actions-lab rel=external>https://github.com/chambear2809/github-actions-lab</a></p><h2 id=workflow-categories>Workflow Categories</h2><h3 id=1-deployment-1-workflow>1. Deployment (1 workflow)</h3><h4 id=deploy-smart-agent-batched>Deploy Smart Agent (Batched)</h4><ul><li><strong>File</strong>: <code>deploy-agent-batched.yml</code></li><li><strong>Purpose</strong>: Installs Smart Agent and starts the service</li><li><strong>Features</strong>:<ul><li>Automatic batching (default: 256 hosts per batch)</li><li>Configurable batch size</li><li>Parallel deployment within each batch</li><li>Sequential batch processing</li></ul></li><li><strong>Inputs</strong>:<ul><li><code>batch_size</code>: Number of hosts per batch (default: 256)</li></ul></li><li><strong>Trigger</strong>: Manual only (<code>workflow_dispatch</code>)</li></ul><h3 id=2-agent-installation-4-workflows>2. Agent Installation (4 workflows)</h3><p>All installation workflows use <code>smartagentctl</code> to install specific agent types:</p><h4 id=install-node-agent-batched>Install Node Agent (Batched)</h4><ul><li><strong>File</strong>: <code>install-node-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl install node</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=install-machine-agent-batched>Install Machine Agent (Batched)</h4><ul><li><strong>File</strong>: <code>install-machine-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl install machine</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=install-db-agent-batched>Install DB Agent (Batched)</h4><ul><li><strong>File</strong>: <code>install-db-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl install db</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=install-java-agent-batched>Install Java Agent (Batched)</h4><ul><li><strong>File</strong>: <code>install-java-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl install java</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h3 id=3-agent-uninstallation-4-workflows>3. Agent Uninstallation (4 workflows)</h3><p>All uninstallation workflows use <code>smartagentctl</code> to remove specific agent types:</p><h4 id=uninstall-node-agent-batched>Uninstall Node Agent (Batched)</h4><ul><li><strong>File</strong>: <code>uninstall-node-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl uninstall node</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=uninstall-machine-agent-batched>Uninstall Machine Agent (Batched)</h4><ul><li><strong>File</strong>: <code>uninstall-machine-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl uninstall machine</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=uninstall-db-agent-batched>Uninstall DB Agent (Batched)</h4><ul><li><strong>File</strong>: <code>uninstall-db-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl uninstall db</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=uninstall-java-agent-batched>Uninstall Java Agent (Batched)</h4><ul><li><strong>File</strong>: <code>uninstall-java-batched.yml</code></li><li><strong>Command</strong>: <code>smartagentctl uninstall java</code></li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h3 id=4-smart-agent-management-2-workflows>4. Smart Agent Management (2 workflows)</h3><h4 id=stop-and-clean-smart-agent-batched>Stop and Clean Smart Agent (Batched)</h4><ul><li><strong>File</strong>: <code>stop-clean-smartagent-batched.yml</code></li><li><strong>Commands</strong>:<ul><li><code>smartagentctl stop</code></li><li><code>smartagentctl clean</code></li></ul></li><li><strong>Purpose</strong>: Stops the Smart Agent service and purges all data</li><li><strong>Batched</strong>: Yes (configurable)</li></ul><h4 id=cleanup-all-agents-batched>Cleanup All Agents (Batched)</h4><ul><li><strong>File</strong>: <code>cleanup-appdynamics.yml</code></li><li><strong>Command</strong>: <code>sudo rm -rf /opt/appdynamics</code></li><li><strong>Purpose</strong>: Completely removes the /opt/appdynamics directory</li><li><strong>Batched</strong>: Yes (configurable)</li><li><strong>Warning</strong>: This permanently deletes all AppDynamics components</li></ul><details open class="box cstyle notices" style=--VARIABLE-BOX-color:danger><summary class="box-label a11y-only" tabindex=-1><span class=a11y-only>Details</span></summary><div class=box-content><p>The &ldquo;Cleanup All Agents&rdquo; workflow permanently deletes <code>/opt/appdynamics</code>. This action cannot be undone. Use with caution!</p></div></details><h2 id=workflow-structure>Workflow Structure</h2><p>All batched workflows follow a consistent two-job structure:</p><h3 id=job-1-prepare>Job 1: Prepare</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>prepare</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>self-hosted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>outputs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>batches</span><span class=p>:</span><span class=w> </span><span class=l>${{ steps.create-batches.outputs.batches }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Load hosts and create batches</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>run</span><span class=p>:</span><span class=w> </span><span class=p>|</span><span class=sd>
</span></span></span><span class=line><span class=cl><span class=sd>        # Load DEPLOYMENT_HOSTS variable
</span></span></span><span class=line><span class=cl><span class=sd>        # Split into batches of N hosts
</span></span></span><span class=line><span class=cl><span class=sd>        # Output as JSON array</span></span></span></code></pre></div><p><strong>Purpose</strong>: Loads target hosts from GitHub variables and creates batch matrix</p><h3 id=job-2-deployinstalluninstall>Job 2: Deploy/Install/Uninstall</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>needs</span><span class=p>:</span><span class=w> </span><span class=l>prepare</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>runs-on</span><span class=p>:</span><span class=w> </span><span class=l>self-hosted</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>strategy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matrix</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>batch</span><span class=p>:</span><span class=w> </span><span class=l>${{ fromJson(needs.prepare.outputs.batches) }}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>steps</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Setup SSH key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>Execute operation on all hosts in batch (parallel)</span></span></span></code></pre></div><p><strong>Purpose</strong>: Runs in parallel for each batch, executing the specific operation on all hosts within the batch</p><h2 id=batching-behavior>Batching Behavior</h2><h3 id=how-it-works>How It Works</h3><ol><li><strong>Prepare Job</strong> loads <code>DEPLOYMENT_HOSTS</code> and splits into batches</li><li><strong>Deploy Job</strong> creates one matrix entry per batch</li><li><strong>Batches process sequentially</strong> to avoid overwhelming the runner</li><li><strong>Within each batch</strong>, all hosts deploy in parallel using background processes</li></ol><h3 id=configurable-batch-size>Configurable Batch Size</h3><p>All workflows accept a <code>batch_size</code> input (default: 256):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Via GitHub CLI</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> -f <span class=nv>batch_size</span><span class=o>=</span><span class=m>128</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Via GitHub UI</span>
</span></span><span class=line><span class=cl>Actions â†’ Select workflow â†’ Run workflow â†’ Set batch_size</span></span></code></pre></div><h3 id=examples>Examples</h3><ul><li><strong>100 hosts, batch_size=256</strong>: 1 batch, ~3 minutes</li><li><strong>500 hosts, batch_size=256</strong>: 2 batches, ~6 minutes</li><li><strong>1,000 hosts, batch_size=128</strong>: 8 batches, ~16 minutes</li><li><strong>5,000 hosts, batch_size=256</strong>: 20 batches, ~60 minutes</li></ul><h2 id=workflow-execution-order>Workflow Execution Order</h2><h3 id=typical-deployment-sequence>Typical Deployment Sequence</h3><ol><li><strong>Deploy Smart Agent</strong> - Initial deployment</li><li><strong>Install Machine Agent</strong> - Install specific agents as needed</li><li><strong>Install DB Agent</strong> - Install database monitoring</li><li>(Use other install workflows as needed)</li></ol><h3 id=maintenanceupdate-sequence>Maintenance/Update Sequence</h3><ol><li><strong>Stop and Clean Smart Agent</strong> - Stop services and clean data</li><li><strong>Deploy Smart Agent</strong> - Redeploy with updated version</li><li><strong>Install agents again</strong> - Reinstall required agents</li></ol><h3 id=complete-removal-sequence>Complete Removal Sequence</h3><ol><li><strong>Stop and Clean Smart Agent</strong> - Stop services</li><li><strong>Cleanup All Agents</strong> - Remove /opt/appdynamics directory</li></ol><h2 id=viewing-workflow-code>Viewing Workflow Code</h2><p>You can view the complete workflow YAML files in the repository:</p><p><strong>Main deployment workflow:</strong>
<a href=https://github.com/chambear2809/github-actions-lab/blob/main/.github/workflows/deploy-agent-batched.yml rel=external>https://github.com/chambear2809/github-actions-lab/blob/main/.github/workflows/deploy-agent-batched.yml</a></p><p><strong>All workflows:</strong>
<a href=https://github.com/chambear2809/github-actions-lab/tree/main/.github/workflows rel=external>https://github.com/chambear2809/github-actions-lab/tree/main/.github/workflows</a></p><h2 id=workflow-features>Workflow Features</h2><h3 id=built-in-error-handling>Built-in Error Handling</h3><ul><li>Per-host error tracking</li><li>Failed host reporting</li><li>Batch-level failure handling</li><li>Always-executed summary</li></ul><h3 id=parallel-execution>Parallel Execution</h3><ul><li>All hosts within a batch deploy simultaneously</li><li>Uses SSH background processes (<code>&</code>)</li><li>Wait command ensures all complete</li><li>Maximum parallelism within resource limits</li></ul><h3 id=security>Security</h3><ul><li>SSH keys never exposed in logs</li><li>Credentials bound as environment variables</li><li>Strict host key checking disabled for automation</li><li>Keys removed after workflow completion</li></ul><h2 id=next-steps>Next Steps</h2><p>Now that you understand the available workflows, let&rsquo;s execute your first deployment!</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=running-workflows>Running Workflows</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<h2 id=triggering-workflows>Triggering Workflows</h2><p>All workflows are configured with <code>workflow_dispatch</code>, meaning they must be triggered manually. There are two main ways to run workflows:</p><ol><li><strong>GitHub UI</strong> - Visual interface, easiest for most users</li><li><strong>GitHub CLI</strong> - Command-line interface, great for automation</li></ol><h2 id=method-1-github-ui>Method 1: GitHub UI</h2><h3 id=step-1-navigate-to-actions-tab>Step 1: Navigate to Actions Tab</h3><ol><li>Go to your forked repository on GitHub</li><li>Click the <strong>Actions</strong> tab at the top</li></ol><h3 id=step-2-select-workflow>Step 2: Select Workflow</h3><p>On the left sidebar, you&rsquo;ll see all available workflows:</p><ul><li>Deploy Smart Agent</li><li>Install Node Agent (Batched)</li><li>Install Machine Agent (Batched)</li><li>Install DB Agent (Batched)</li><li>Install Java Agent (Batched)</li><li>Uninstall Node Agent (Batched)</li><li>Uninstall Machine Agent (Batched)</li><li>Uninstall DB Agent (Batched)</li><li>Uninstall Java Agent (Batched)</li><li>Stop and Clean Smart Agent (Batched)</li><li>Cleanup All Agents</li></ul><p>Click on the workflow you want to run.</p><h3 id=step-3-run-workflow>Step 3: Run Workflow</h3><ol><li>Click <strong>&ldquo;Run workflow&rdquo;</strong> button (top right)</li><li>Select branch: <strong>main</strong></li><li>(Optional) Adjust <strong>batch_size</strong> if desired</li><li>Click <strong>&ldquo;Run workflow&rdquo;</strong> button</li></ol><h3 id=step-4-monitor-execution>Step 4: Monitor Execution</h3><ol><li>The workflow will appear in the list below</li><li>Click on the workflow run to view details</li><li>Watch progress in real-time</li><li>Click on job names to see detailed logs</li></ol><h2 id=method-2-github-cli>Method 2: GitHub CLI</h2><h3 id=install-github-cli>Install GitHub CLI</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># macOS</span>
</span></span><span class=line><span class=cl>brew install gh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Linux</span>
</span></span><span class=line><span class=cl>curl -fsSL https://cli.github.com/packages/githubcli-archive-keyring.gpg <span class=p>|</span> sudo dd <span class=nv>of</span><span class=o>=</span>/usr/share/keyrings/githubcli-archive-keyring.gpg
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;deb [arch=</span><span class=k>$(</span>dpkg --print-architecture<span class=k>)</span><span class=s2> signed-by=/usr/share/keyrings/githubcli-archive-keyring.gpg] https://cli.github.com/packages stable main&#34;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/github-cli.list &gt; /dev/null
</span></span><span class=line><span class=cl>sudo apt update
</span></span><span class=line><span class=cl>sudo apt install gh</span></span></code></pre></div><h3 id=authenticate>Authenticate</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gh auth login</span></span></code></pre></div><h3 id=run-workflows>Run Workflows</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Deploy Smart Agent (default batch size)</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Deploy with custom batch size</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  -f <span class=nv>batch_size</span><span class=o>=</span><span class=m>128</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Install agents</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install Node Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install Machine Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Uninstall agents</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Uninstall Node Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Stop and clean</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Stop and Clean Smart Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Complete cleanup</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Cleanup All Agents&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab</span></span></code></pre></div><h3 id=monitor-workflows>Monitor Workflows</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># List recent workflow runs</span>
</span></span><span class=line><span class=cl>gh run list --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># View specific run</span>
</span></span><span class=line><span class=cl>gh run view RUN_ID --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Watch run in progress</span>
</span></span><span class=line><span class=cl>gh run watch RUN_ID --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># View failed logs</span>
</span></span><span class=line><span class=cl>gh run view RUN_ID --log-failed --repo YOUR_USERNAME/github-actions-lab</span></span></code></pre></div><h2 id=first-deployment-walkthrough>First Deployment Walkthrough</h2><p>Let&rsquo;s walk through a complete first-time deployment:</p><h3 id=step-1-verify-setup>Step 1: Verify Setup</h3><p>Before running any workflows, ensure:</p><ul><li>âœ… Self-hosted runner shows &ldquo;Idle&rdquo; (green)</li><li>âœ… <code>SSH_PRIVATE_KEY</code> secret is configured</li><li>âœ… <code>DEPLOYMENT_HOSTS</code> variable contains your target IPs</li><li>âœ… Network connectivity verified</li></ul><h3 id=step-2-deploy-smart-agent>Step 2: Deploy Smart Agent</h3><p><strong>Via GitHub UI:</strong></p><ol><li>Go to <strong>Actions</strong> tab</li><li>Select <strong>&ldquo;Deploy Smart Agent&rdquo;</strong></li><li>Click <strong>&ldquo;Run workflow&rdquo;</strong></li><li>Accept default batch_size (256)</li><li>Click <strong>&ldquo;Run workflow&rdquo;</strong></li></ol><p><strong>Via GitHub CLI:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> --repo YOUR_USERNAME/github-actions-lab</span></span></code></pre></div><h3 id=step-3-monitor-execution>Step 3: Monitor Execution</h3><p>The workflow will show:</p><ol><li><strong>Prepare</strong> job - Creating batch matrix</li><li><strong>Deploy</strong> job (one per batch) - Deploying to hosts</li></ol><p>Click on each job to view detailed logs.</p><h3 id=step-4-verify-installation>Step 4: Verify Installation</h3><p>SSH into a target host and check:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># SSH to target</span>
</span></span><span class=line><span class=cl>ssh ubuntu@172.31.1.243
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check Smart Agent status</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /opt/appdynamics/appdsmartagent
</span></span><span class=line><span class=cl>sudo ./smartagentctl status</span></span></code></pre></div><p><strong>Expected output:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Smart Agent is running (PID: 12345)
Service: appdsmartagent.service
Status: active (running)</code></pre></div><h3 id=step-5-install-additional-agents-optional>Step 5: Install Additional Agents (Optional)</h3><p>If needed, install specific agent types:</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Install Machine Agent</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install Machine Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Install DB Agent</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install DB Agent (Batched for Large Scale)&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  --repo YOUR_USERNAME/github-actions-lab</span></span></code></pre></div><h2 id=understanding-workflow-output>Understanding Workflow Output</h2><h3 id=prepare-job-output>Prepare Job Output</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Loading deployment hosts...
Total hosts: 1000
Batch size: 256
Creating 4 batches...
Batch 1: Hosts 1-256
Batch 2: Hosts 257-512
Batch 3: Hosts 513-768
Batch 4: Hosts 769-1000</code></pre></div><h3 id=deploy-job-output-per-batch>Deploy Job Output (per batch)</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Processing batch 1 of 4
Deploying to 256 hosts in parallel...
Host 172.31.1.1: SUCCESS
Host 172.31.1.2: SUCCESS
Host 172.31.1.3: SUCCESS
...
Batch 1 complete: 256/256 succeeded</code></pre></div><h3 id=completion-summary>Completion Summary</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0><code>Deployment Summary:
Total hosts: 1000
Successful: 998
Failed: 2
Failed hosts:
  - 172.31.1.48
  - 172.31.1.125</code></pre></div><h2 id=common-deployment-scenarios>Common Deployment Scenarios</h2><h3 id=scenario-1-initial-deployment>Scenario 1: Initial Deployment</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Deploy Smart Agent</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Verify deployment</span>
</span></span><span class=line><span class=cl><span class=c1># SSH to a host and check status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Install agents as needed</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install Machine Agent (Batched for Large Scale)&#34;</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install DB Agent (Batched for Large Scale)&#34;</span></span></span></code></pre></div><h3 id=scenario-2-update-smart-agent>Scenario 2: Update Smart Agent</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Stop and clean current installation</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Stop and Clean Smart Agent (Batched for Large Scale)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Update Smart Agent ZIP in repository</span>
</span></span><span class=line><span class=cl><span class=c1># (Push new version to repository)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Deploy new version</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Reinstall agents</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Install Machine Agent (Batched for Large Scale)&#34;</span></span></span></code></pre></div><h3 id=scenario-3-add-new-hosts>Scenario 3: Add New Hosts</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Update DEPLOYMENT_HOSTS variable in GitHub</span>
</span></span><span class=line><span class=cl><span class=c1># Add new IPs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Deploy to all hosts (will skip existing ones with idempotent logic)</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span></span></span></code></pre></div><h3 id=scenario-4-complete-removal>Scenario 4: Complete Removal</h3><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Stop and clean</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Stop and Clean Smart Agent (Batched for Large Scale)&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Complete removal</span>
</span></span><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Cleanup All Agents&#34;</span></span></span></code></pre></div><details open class="box cstyle notices" style=--VARIABLE-BOX-color:danger><summary class="box-label a11y-only" tabindex=-1><span class=a11y-only>Details</span></summary><div class=box-content><p>&ldquo;Cleanup All Agents&rdquo; permanently deletes <code>/opt/appdynamics</code>. This cannot be undone!</p></div></details><h2 id=troubleshooting-workflow-failures>Troubleshooting Workflow Failures</h2><h3 id=workflow-stays-in-queued>Workflow Stays in &ldquo;Queued&rdquo;</h3><p><strong>Symptom</strong>: Workflow doesn&rsquo;t start</p><p><strong>Cause</strong>: Runner not available or offline</p><p><strong>Solution</strong>:</p><ol><li>Check runner status: Settings â†’ Actions â†’ Runners</li><li>Verify runner shows &ldquo;Idle&rdquo; (green)</li><li>Restart runner if needed: <code>sudo ./svc.sh restart</code></li></ol><h3 id=ssh-connection-failures>SSH Connection Failures</h3><p><strong>Symptom</strong>: &ldquo;Permission denied&rdquo; or &ldquo;Connection refused&rdquo; errors</p><p><strong>Solutions</strong>:</p><p><strong>Test SSH manually:</strong></p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># From runner instance</span>
</span></span><span class=line><span class=cl>ssh -i ~/.ssh/test-key.pem ubuntu@172.31.1.243</span></span></code></pre></div><p><strong>Check security groups:</strong></p><ul><li>Verify SSH (22) allowed from runner</li><li>Confirm runner and targets in same security group</li></ul><p><strong>Verify SSH key:</strong></p><ul><li>Ensure <code>SSH_PRIVATE_KEY</code> secret matches actual key</li><li>Verify public key is on target hosts</li></ul><h3 id=partial-batch-failures>Partial Batch Failures</h3><p><strong>Symptom</strong>: Some hosts succeed, others fail</p><p><strong>Solution</strong>:</p><ol><li>View workflow logs to identify failed hosts</li><li>SSH to failed hosts to investigate</li><li>Re-run workflow (idempotent - skips successful hosts)</li></ol><h3 id=batch-job-errors>Batch Job Errors</h3><p><strong>Symptom</strong>: &ldquo;Error splitting hosts into batches&rdquo;</p><p><strong>Solution</strong>:</p><ul><li>Check <code>DEPLOYMENT_HOSTS</code> variable format</li><li>Ensure one IP per line</li><li>No trailing spaces or special characters</li><li>Use Unix line endings (LF, not CRLF)</li></ul><h2 id=performance-tuning>Performance Tuning</h2><h3 id=adjusting-batch-size>Adjusting Batch Size</h3><p><strong>Smaller batches</strong> (fewer resources, slower):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> -f <span class=nv>batch_size</span><span class=o>=</span><span class=m>128</span></span></span></code></pre></div><p><strong>Larger batches</strong> (more resources, faster):</p><div class="highlight wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gh workflow run <span class=s2>&#34;Deploy Smart Agent&#34;</span> -f <span class=nv>batch_size</span><span class=o>=</span><span class=m>256</span></span></span></code></pre></div><h3 id=runner-resource-recommendations>Runner Resource Recommendations</h3><table><thead><tr><th>Hosts</th><th>CPU</th><th>Memory</th><th>Batch Size</th></tr></thead><tbody><tr><td>1-100</td><td>2 cores</td><td>4 GB</td><td>256</td></tr><tr><td>100-500</td><td>4 cores</td><td>8 GB</td><td>256</td></tr><tr><td>500-2000</td><td>8 cores</td><td>16 GB</td><td>256</td></tr><tr><td>2000+</td><td>16 cores</td><td>32 GB</td><td>256</td></tr></tbody></table><h2 id=best-practices>Best Practices</h2><ol><li><p><strong>Test on single host first</strong></p><ul><li>Create a test variable with 1 IP</li><li>Run workflow to verify</li><li>Then deploy to full list</li></ul></li><li><p><strong>Monitor workflow execution</strong></p><ul><li>Watch logs in real-time</li><li>Check for errors immediately</li><li>Verify on sample hosts</li></ul></li><li><p><strong>Use appropriate batch sizes</strong></p><ul><li>Default (256) works for most cases</li><li>Reduce if runner struggles</li><li>Monitor runner resource usage</li></ul></li><li><p><strong>Keep workflows up to date</strong></p><ul><li>Pull latest changes from repository</li><li>Test updates on non-production first</li><li>Document any customizations</li></ul></li><li><p><strong>Maintain runner health</strong></p><ul><li>Keep runner online and idle</li><li>Update runner software regularly</li><li>Monitor disk space and resources</li></ul></li></ol><h2 id=next-steps>Next Steps</h2><p>Congratulations! You&rsquo;ve successfully learned how to automate AppDynamics Smart Agent deployment using GitHub Actions. For more information, visit the <a href=https://github.com/chambear2809/github-actions-lab rel=external>complete repository</a>.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Nov 17, 2025</span></span></footer></article></section></section></section></section></div></main></div><script src=/observability-workshop/js/js-yaml/js-yaml.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-color.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-dispatch.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-drag.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-ease.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-interpolate.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-selection.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-timer.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-transition.min.js?1763652610 defer></script><script src=/observability-workshop/js/d3/d3-zoom.min.js?1763652610 defer></script><script src=/observability-workshop/js/mermaid/mermaid.min.js?1763652610 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=/observability-workshop/js/clipboard/clipboard.min.js?1763652610 defer></script><script src=/observability-workshop/js/perfect-scrollbar/perfect-scrollbar.min.js?1763652610 defer></script><script src=/observability-workshop/js/theme.min.js?1763652610 defer></script></body></html>
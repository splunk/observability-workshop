<!doctype html><html lang=ja dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.0.0+tip"><meta name=description content="ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã€ Splunk OpenTelemetry CollectorãŒãã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼ˆtailï¼‰ã€Splunk Observability Platformã«æƒ…å ±ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚
1. FluentDã®è¨­å®š Splunk OpenTelemetry Collectorã‚’ã€Spring PetClinicã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’tailã— Splunk Observability Cloudã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
Splunk OpenTelemetry Collectorã¯ã€FluentDã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã®å–å¾—/å ±å‘Šã‚’è¡Œã„ã€ Spring PetClinicã®ãƒ­ã‚°ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®é©åˆ‡ãªè¨­å®šã‚’è¡Œã†ã«ã¯ã€ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ/etc/otel/collector/fluentd/conf.d/ï¼‰ã«FluentDã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚
ä»¥ä¸‹ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ã®FluentDè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã‚’æ–°ãŸã«ä½œæˆã—ã€
sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ« /tmp/spring-petclinic.logã‚’èª­ã¿å–ã‚‹ã‚ˆã†è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
<source> @type tail @label @SPLUNK tag petclinic.app path /tmp/spring-petclinic.log pos_file /tmp/spring-petclinic.pos_file read_from_head false <parse> @type none </parse> </source>ã“ã®ã¨ãã€ãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨æ‰€æœ‰æ¨©ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf sudo chmod 755 /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸã‚‰ã€FluentDãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚
sudo systemctl restart td-agent3. Logbackã®è¨­å®š Spring Pet Clinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã„ãã¤ã‹ã®Javaãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€logbackã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ãƒªã‚½ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ã« logback.xml ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦â€¦
nano src/main/resources/logback."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Log Observer :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã€ Splunk OpenTelemetry CollectorãŒãã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼ˆtailï¼‰ã€Splunk Observability Platformã«æƒ…å ±ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚
1. FluentDã®è¨­å®š Splunk OpenTelemetry Collectorã‚’ã€Spring PetClinicã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’tailã— Splunk Observability Cloudã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
Splunk OpenTelemetry Collectorã¯ã€FluentDã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã®å–å¾—/å ±å‘Šã‚’è¡Œã„ã€ Spring PetClinicã®ãƒ­ã‚°ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®é©åˆ‡ãªè¨­å®šã‚’è¡Œã†ã«ã¯ã€ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ/etc/otel/collector/fluentd/conf.d/ï¼‰ã«FluentDã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚
ä»¥ä¸‹ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ã®FluentDè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã‚’æ–°ãŸã«ä½œæˆã—ã€
sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ« /tmp/spring-petclinic.logã‚’èª­ã¿å–ã‚‹ã‚ˆã†è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
<source> @type tail @label @SPLUNK tag petclinic.app path /tmp/spring-petclinic.log pos_file /tmp/spring-petclinic.pos_file read_from_head false <parse> @type none </parse> </source>ã“ã®ã¨ãã€ãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨æ‰€æœ‰æ¨©ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf sudo chmod 755 /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸã‚‰ã€FluentDãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚
sudo systemctl restart td-agent3. Logbackã®è¨­å®š Spring Pet Clinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã„ãã¤ã‹ã®Javaãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€logbackã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ãƒªã‚½ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ã« logback.xml ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦â€¦
nano src/main/resources/logback."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.64/ja/other/pet-clinic/docs/logobserver/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Log Observer :: Splunk Observability Cloud Workshops"><meta property="og:description" content="ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã€ Splunk OpenTelemetry CollectorãŒãã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼ˆtailï¼‰ã€Splunk Observability Platformã«æƒ…å ±ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚
1. FluentDã®è¨­å®š Splunk OpenTelemetry Collectorã‚’ã€Spring PetClinicã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’tailã— Splunk Observability Cloudã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
Splunk OpenTelemetry Collectorã¯ã€FluentDã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã®å–å¾—/å ±å‘Šã‚’è¡Œã„ã€ Spring PetClinicã®ãƒ­ã‚°ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®é©åˆ‡ãªè¨­å®šã‚’è¡Œã†ã«ã¯ã€ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ/etc/otel/collector/fluentd/conf.d/ï¼‰ã«FluentDã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚
ä»¥ä¸‹ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ã®FluentDè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã‚’æ–°ãŸã«ä½œæˆã—ã€
sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ« /tmp/spring-petclinic.logã‚’èª­ã¿å–ã‚‹ã‚ˆã†è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
<source> @type tail @label @SPLUNK tag petclinic.app path /tmp/spring-petclinic.log pos_file /tmp/spring-petclinic.pos_file read_from_head false <parse> @type none </parse> </source>ã“ã®ã¨ãã€ãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨æ‰€æœ‰æ¨©ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf sudo chmod 755 /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸã‚‰ã€FluentDãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚
sudo systemctl restart td-agent3. Logbackã®è¨­å®š Spring Pet Clinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã„ãã¤ã‹ã®Javaãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€logbackã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ãƒªã‚½ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ã« logback.xml ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦â€¦
nano src/main/resources/logback."><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="Ninja Workshops"><meta property="article:modified_time" content="2023-11-16T11:44:50+00:00"><meta itemprop=name content="Log Observer :: Splunk Observability Cloud Workshops"><meta itemprop=description content="ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã€ Splunk OpenTelemetry CollectorãŒãã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼ˆtailï¼‰ã€Splunk Observability Platformã«æƒ…å ±ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚
1. FluentDã®è¨­å®š Splunk OpenTelemetry Collectorã‚’ã€Spring PetClinicã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’tailã— Splunk Observability Cloudã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
Splunk OpenTelemetry Collectorã¯ã€FluentDã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã®å–å¾—/å ±å‘Šã‚’è¡Œã„ã€ Spring PetClinicã®ãƒ­ã‚°ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®é©åˆ‡ãªè¨­å®šã‚’è¡Œã†ã«ã¯ã€ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ/etc/otel/collector/fluentd/conf.d/ï¼‰ã«FluentDã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚
ä»¥ä¸‹ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ã®FluentDè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã‚’æ–°ãŸã«ä½œæˆã—ã€
sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ« /tmp/spring-petclinic.logã‚’èª­ã¿å–ã‚‹ã‚ˆã†è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚
<source> @type tail @label @SPLUNK tag petclinic.app path /tmp/spring-petclinic.log pos_file /tmp/spring-petclinic.pos_file read_from_head false <parse> @type none </parse> </source>ã“ã®ã¨ãã€ãƒ•ã‚¡ã‚¤ãƒ« petclinic.conf ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨æ‰€æœ‰æ¨©ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf sudo chmod 755 /etc/otel/collector/fluentd/conf.d/petclinic.confãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸã‚‰ã€FluentDãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚
sudo systemctl restart td-agent3. Logbackã®è¨­å®š Spring Pet Clinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã„ãã¤ã‹ã®Javaãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ ã“ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€logbackã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
ãƒªã‚½ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ã« logback.xml ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦â€¦
nano src/main/resources/logback."><meta itemprop=dateModified content="2023-11-16T11:44:50+00:00"><meta itemprop=wordCount content="169"><title>Log Observer :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.64/ja/other/pet-clinic/docs/logobserver/index.html rel=canonical type=text/html title="Log Observer :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.64/images/favicon.ico?1721291821 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.64/css/fontawesome-all.min.css?1721291821 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/fontawesome-all.min.css?1721291821 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/nucleus.css?1721291821 rel=stylesheet><link href=/observability-workshop/v5.64/css/auto-complete.css?1721291821 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/auto-complete.css?1721291821 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/perfect-scrollbar.min.css?1721291821 rel=stylesheet><link href=/observability-workshop/v5.64/css/fonts.css?1721291821 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.64/css/fonts.css?1721291821 rel=stylesheet></noscript><link href=/observability-workshop/v5.64/css/theme.css?1721291821 rel=stylesheet><link href=/observability-workshop/v5.64/css/theme-splunk-light.css?1721291821 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.64/css/chroma-relearn-light.css?1721291821 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.64/css/variant.css?1721291821 rel=stylesheet><link href=/observability-workshop/v5.64/css/print.css?1721291821 rel=stylesheet media=print><link href=/observability-workshop/v5.64/css/format-print.css?1721291821 rel=stylesheet><script src=/observability-workshop/v5.64/js/variant.js?1721291821></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../..",window.relearn.relBaseUri="../../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.64",window.index_js_url="/observability-workshop/v5.64/ja/index.search.js?1721291821",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼`,window.T_Copied_to_clipboard=`ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼!`,window.T_Copy_link_to_clipboard=`ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼`,window.T_Link_copied_to_clipboard=`ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!`,window.T_Reset_view=`ãƒ“ãƒ¥ãƒ¼ã®ãƒªã‚»ãƒƒãƒˆ`,window.T_View_reset=`ãƒªã‚»ãƒƒãƒˆã‚’è¦‹ã‚‹`,window.T_No_results_found=`"{0}" ã®çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`,window.T_N_results_found=`"{0}" ã§ {1} ä»¶ã®çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.64/ja/other/pet-clinic/docs/logobserver/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.64/ja/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.64/ja/other/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.64/ja/other/pet-clinic/index.html><span itemprop=name>Pet Clinic Java ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>5. Log Observer</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.64/ja/other/pet-clinic/docs/rum/index.html title="Real User Monitoring (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.64/ja/other/opentelemetry-collector/index.html title="OpenTelemetryã§ã‚¯ãƒ©ã‚¦ãƒ‰ãƒã‚¤ãƒ†ã‚£ãƒ–ç’°å¢ƒã®ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ã‚’å®Ÿç¾ã™ã‚‹ (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=log-observer>Log Observer</h1><p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ãƒ­ã‚°ã‚’æ›¸ãè¾¼ã‚€ã‚ˆã†ã«è¨­å®šã—ã€
Splunk OpenTelemetry CollectorãŒãã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚Šï¼ˆtailï¼‰ã€Splunk Observability Platformã«æƒ…å ±ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã—ã¦ã„ãã¾ã™ã€‚</p><h2 id=1-fluentdã®è¨­å®š>1. FluentDã®è¨­å®š</h2><p>Splunk OpenTelemetry Collectorã‚’ã€Spring PetClinicã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’tailã—
Splunk Observability Cloudã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’å ±å‘Šã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>Splunk OpenTelemetry Collectorã¯ã€FluentDã‚’ä½¿ç”¨ã—ã¦ãƒ­ã‚°ã®å–å¾—/å ±å‘Šã‚’è¡Œã„ã€
Spring PetClinicã®ãƒ­ã‚°ã‚’å ±å‘Šã™ã‚‹ãŸã‚ã®é©åˆ‡ãªè¨­å®šã‚’è¡Œã†ã«ã¯ã€
ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆ<code>/etc/otel/collector/fluentd/conf.d/</code>ï¼‰ã«FluentDã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚</p><p>ä»¥ä¸‹ã¯ã€ã‚µãƒ³ãƒ—ãƒ«ã®FluentDè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« <code>petclinic.conf</code> ã‚’æ–°ãŸã«ä½œæˆã—ã€</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo nano /etc/otel/collector/fluentd/conf.d/petclinic.conf</span></span></code></pre></div><p>ãƒ•ã‚¡ã‚¤ãƒ« <code>/tmp/spring-petclinic.log</code>ã‚’èª­ã¿å–ã‚‹ã‚ˆã†è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚</p><div class="highlight wrap-code"><pre tabindex=0><code>&lt;source&gt;
  @type tail
  @label @SPLUNK
  tag petclinic.app
  path /tmp/spring-petclinic.log
  pos_file /tmp/spring-petclinic.pos_file
  read_from_head false
  &lt;parse&gt;
    @type none
  &lt;/parse&gt;
&lt;/source&gt;</code></pre></div><p>ã“ã®ã¨ãã€ãƒ•ã‚¡ã‚¤ãƒ« <code>petclinic.conf</code> ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã¨æ‰€æœ‰æ¨©ã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo chown td-agent:td-agent /etc/otel/collector/fluentd/conf.d/petclinic.conf
</span></span><span class=line><span class=cl>sudo chmod <span class=m>755</span> /etc/otel/collector/fluentd/conf.d/petclinic.conf</span></span></code></pre></div><p>ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚ŒãŸã‚‰ã€FluentDãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã—ã¾ã—ã‚‡ã†ã€‚</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo systemctl restart td-agent</span></span></code></pre></div><h2 id=3-logbackã®è¨­å®š>3. Logbackã®è¨­å®š</h2><p>Spring Pet Clinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€ã„ãã¤ã‹ã®Javaãƒ­ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã“ã®ã‚·ãƒŠãƒªã‚ªã§ã¯ã€logbackã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚</p><p>ãƒªã‚½ãƒ¼ã‚¹ãƒ•ã‚©ãƒ«ãƒ€ã« <code>logback.xml</code> ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦â€¦</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano src/main/resources/logback.xml</span></span></code></pre></div><p>ä»¥ä¸‹ã®è¨­å®šã‚’ä¿å­˜ã—ã¾ã—ã‚‡ã†:</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE xml&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;configuration</span> <span class=na>scan=</span><span class=s>&#34;true&#34;</span> <span class=na>scanPeriod=</span><span class=s>&#34;30 seconds&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;contextListener</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.classic.jul.LevelChangePropagator&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;resetJUL&gt;</span>true<span class=nt>&lt;/resetJUL&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/contextListener&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;logger</span> <span class=na>name=</span><span class=s>&#34;org.springframework.samples.petclinic&#34;</span> <span class=na>level=</span><span class=s>&#34;debug&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;appender</span> <span class=na>name=</span><span class=s>&#34;file&#34;</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.RollingFileAppender&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;file&gt;</span>/tmp/spring-petclinic.log<span class=nt>&lt;/file&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;rollingPolicy</span> <span class=na>class=</span><span class=s>&#34;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;fileNamePattern&gt;</span>springLogFile.%d{yyyy-MM-dd}.log<span class=nt>&lt;/fileNamePattern&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;maxHistory&gt;</span>5<span class=nt>&lt;/maxHistory&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;totalSizeCap&gt;</span>1GB<span class=nt>&lt;/totalSizeCap&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/rollingPolicy&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;encoder&gt;</span>
</span></span><span class=line><span class=cl>      <span class=nt>&lt;pattern&gt;</span>
</span></span><span class=line><span class=cl>      %d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg trace_id=%X{trace_id} span_id=%X{span_id} trace_flags=%X{trace_flags} service.name=%property{otel.resource.service.name}, deployment.environment=%property{otel.resource.deployment.environment} %n
</span></span><span class=line><span class=cl>      <span class=nt>&lt;/pattern&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/encoder&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/appender&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;root</span> <span class=na>level=</span><span class=s>&#34;debug&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;appender-ref</span> <span class=na>ref=</span><span class=s>&#34;file&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/root&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span></span></span></code></pre></div><p>ãã®å¾Œã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†æ§‹ç¯‰ã—ã¦å†åº¦å®Ÿè¡Œã—ã¦ã„ãã¾ã™ã€‚</p><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw package -Dmaven.test.skip<span class=o>=</span>true</span></span></code></pre></div><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>java -javaagent:./splunk-otel-javaagent.jar <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dserver.port<span class=o>=</span><span class=m>8083</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.service.name<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>.service <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dotel.resource.attributes<span class=o>=</span>deployment.environment<span class=o>=</span><span class=k>$(</span>hostname<span class=k>)</span>,version<span class=o>=</span>0.317 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.profiler.memory.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-Dsplunk.metrics.enabled<span class=o>=</span><span class=nb>true</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>-jar target/spring-petclinic-*.jar --spring.profiles.active<span class=o>=</span>mysql</span></span></code></pre></div><p>ã“ã‚Œã¾ã§é€šã‚Šã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ <code>http://&lt;VM_IP_ADDRESS>:8083</code> ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’ç”Ÿæˆã™ã‚‹ã¨ã€ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå ±å‘Šã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><p>å·¦å´ã®Log Observerã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ãƒ›ã‚¹ãƒˆã¨Spring PetClinicã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã¿ã‚’é¸æŠã™ã‚‹ãŸã‚ã®ãƒ•ã‚£ãƒ«ã‚¿ã‚’è¿½åŠ ã§ãã¾ã™ã€‚</p><ol><li>Add Filter â†’ Field â†’ host.name â†’ &lt;ã‚ãªãŸã®ãƒ›ã‚¹ãƒˆå></li><li>Add Filter â†’ Field â†’ service.name â†’ &lt;ã‚ãªãŸã®ãƒ›ã‚¹ãƒˆå>.service</li></ol><h2 id=4-ã¾ã¨ã‚>4. ã¾ã¨ã‚</h2><p>ã“ã‚Œã§ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã¯çµ‚äº†ã§ã™ã€‚
ã“ã‚Œã¾ã§ã«ã€Splunk Observability Cloudã«ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã€ã‚³ãƒ¼ãƒ‰ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ãŒå ±å‘Šã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>Robert Castley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>2023/11/16</span></span></footer></article></div></main></div><script src=/observability-workshop/v5.64/js/clipboard.min.js?1721291821 defer></script><script src=/observability-workshop/v5.64/js/perfect-scrollbar.min.js?1721291821 defer></script><script src=/observability-workshop/v5.64/js/theme.js?1721291821 defer></script></body></html>
<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.134.3"><meta name=generator content="Relearn 7.2.1"><meta name=description content="Scenario Overview In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.
The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Create an Ingest Pipeline :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Scenario Overview In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.
The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/3-create-an-ingest-pipeline/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Create an Ingest Pipeline :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Scenario Overview In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.
The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta itemprop=name content="Create an Ingest Pipeline :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Scenario Overview In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.
The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:"><meta itemprop=dateModified content="2025-01-29T17:32:54-05:00"><meta itemprop=wordCount content="268"><title>Create an Ingest Pipeline :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/3-create-an-ingest-pipeline/index.html rel=canonical type=text/html title="Create an Ingest Pipeline :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.79/images/favicon.ico?1738938790 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.79/css/fontawesome-all.min.css?1738938790 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.79/css/fontawesome-all.min.css?1738938790 rel=stylesheet></noscript><link href=/observability-workshop/v5.79/css/auto-complete.css?1738938790 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.79/css/auto-complete.css?1738938790 rel=stylesheet></noscript><link href=/observability-workshop/v5.79/css/perfect-scrollbar.min.css?1738938790 rel=stylesheet><link href=/observability-workshop/v5.79/css/theme.min.css?1738938790 rel=stylesheet><link href=/observability-workshop/v5.79/css/format-print.min.css?1738938790 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.79",window.relearn.min=`.min`,window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantname="my-custom-variant",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}}))},window.relearn.markVariant=function(){var t=window.localStorage.getItem(window.relearn.absBaseUri+"/variant"),e=document.querySelector("#R-select-variant");e&&(e.value=t)},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";e==window.relearn.customvariantname||(!e||!window.relearn.themevariants.includes(e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant(),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/3-create-an-ingest-pipeline/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div><div class="topbar-button topbar-button-toc" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title="Table of Contents (CTRL+ALT+t)"><i class="fa-fw fas fa-list-alt"></i></button><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#scenario-overview>Scenario Overview</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.79/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.79/en/ninja-workshops/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/index.html><span itemprop=name>Ingest Processor for Splunk Observability Cloud</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>3. Create an Ingest Pipeline</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/3-create-an-ingest-pipeline/index.print.html title="Print whole chapter (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></div><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/2-ingest-processor-pipelines/index.html title="How Ingest Processor Works (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.79/en/ninja-workshops/11-ingest_processor_for_observability_cloud/3-create-an-ingest-pipeline/1-login-to-splunk/index.html title="Login to Splunk Cloud (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div><div class="topbar-button topbar-button-more" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><button class=topbar-control onclick=toggleTopbarFlyout(this) type=button title=More><i class="fa-fw fas fa-ellipsis-v"></i></button><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable ninja-workshops" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=create-an-ingest-pipeline>Create an Ingest Pipeline</h1><h2 id=scenario-overview>Scenario Overview</h2><p>In this scenario you will be playing the role of a Splunk Admin responsible for managing your organizations Splunk Enterprise Cloud environment. You recently worked with an internal application team on instrumenting their Kubernetes environment with Splunk APM and Infrastructure monitoring using OpenTelemetry to monitor their critical microservice applications.</p><p>The logs from the Kubernetes environment are also being collected and sent to Splunk Enter Prize Cloud. These logs include:</p><ul><li>Pod logs (application logs)</li><li>Kubernetes Events</li><li>Kubernetes Cluster Logs<ul><li>Control Plane Node logs</li><li>Worker Node logs</li><li>Audit Logs</li></ul></li></ul><p>As a Splunk Admin you want to ensure that the data you are collecting is optimized so it can be analyzed in the most efficient way possible. Taking this approach accelerates troubleshooting and ensures efficient license utilization.</p><p>One way to accomplish this is by using Ingest Processor to convert robust logs to metrics and use Splunk Observability Cloud as the destination for those metrics. Not only does this make collecting the logs more efficient, you have the added ability of using the newly created metrics in Splunk Observability which can then be correlated with Splunk APM data (traces) and Splunk Infrastructure Monitoring data providing additional troubleshooting context. Because Splunk Observability Cloud uses a streaming metrics pipeline, the metrics can be alerted on in real-time speeding up problem identification. Additionally, you can use the Metrics Pipeline Management functionality to further optimize the data by aggregating, dropping unnecessary fields, and archiving less important or un-needed metrics.</p><p>In the next step you&rsquo;ll create an Ingest Processor Pipeline which will convert Kubernetes Audit Logs to metrics that will be sent to Observability Cloud.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 29, 2025</span></span></footer></article><section><h1 class=a11y-only>Subsections of 3. Create an Ingest Pipeline</h1><article class=default><header class=headline></header><h1 id=login-to-splunk-cloud>Login to Splunk Cloud</h1><p>In this section you will create an Ingest Pipeline which will convert Kubernetes Audit Logs to metrics which are sent to the Splunk Observability Cloud workshop organization. Before getting started you will need to access the Splunk Cloud and Ingest Processor SCS Tenant environments provided in the Splunk Show event details.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Pre-requisite: Login to Splunk Enterprise Cloud</summary><div class=box-content><p>Open the <strong>Ingest Processor Cloud Stack</strong> URL provided in the Splunk Show event details.</p><p><a href=#R-image-1740f02d52c3c422bae8a3fec2662b2d class=lightbox-link><img alt="Splunk Cloud Instance Details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/show_instances_sec.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1740f02d52c3c422bae8a3fec2662b2d><img alt="Splunk Cloud Instance Details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/show_instances_sec.png></a></p><p>In the Connection info click on the <strong>Stack URL</strong> link to open your Splunk Cloud stack.</p><p><a href=#R-image-3cab1b9ac88465fc726e972544639a4d class=lightbox-link><img alt="Splunk Cloud Connection Details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/sec_connection_details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3cab1b9ac88465fc726e972544639a4d><img alt="Splunk Cloud Connection Details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/sec_connection_details.png></a></p><p>Use the <code>admin</code> username and password to login to Splunk Cloud.</p><p><a href=#R-image-93fcc6bc952cb5c62017aca32cecf893 class=lightbox-link><img alt="Splunk Cloud Login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/sec_login.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-93fcc6bc952cb5c62017aca32cecf893><img alt="Splunk Cloud Login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/sec_login.png></a></p><p>After logging in, if prompted, accept the Terms of Service and click <strong>OK</strong></p><p><a href=#R-image-b1223d8bc139365616ddc7c88ea8c6e9 class=lightbox-link><img alt="Splunk Cloud Login" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/sec_terms.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b1223d8bc139365616ddc7c88ea8c6e9><img alt="Splunk Cloud Login" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/sec_terms.png></a></p><p>Navigate back to the Splunk Show event details and select the Ingest Processor SCS Tenant</p><p><a href=#R-image-dbd14483acbda2067d9516c3b674a66f class=lightbox-link><img alt="Ingest Processor Connection Details" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/show_instances_scs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-dbd14483acbda2067d9516c3b674a66f><img alt="Ingest Processor Connection Details" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/show_instances_scs.png></a></p><p>Click on the <strong>Console URL</strong> to access the <strong>Ingest Processor SCS Tenant</strong></p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p><strong>Single Sign-On (SSO)</strong>
Single Sign-on (SSO) is configured between the Splunk Data Management service (â€˜SCS Tenantâ€™) and Splunk Cloud environments, so if you already logged in to your Splunk Cloud stack you should automatically be logged in to Splunk Data Management service. If you are prompted for credentials, use the credentials provided in the Splunk Cloud Stack on Splunk Show event (listed under the â€˜Splunk Cloud Stackâ€™ section.)</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 29, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=review-kubernetes-audit-logs>Review Kubernetes Audit Logs</h1><p>In this section you will review the Kubernetes Audit Logs that are being collected. You can see that the events are quite robust, which can make charting them inefficient. To address this, you will create an Ingest Pipeline in Ingest Processor that will convert these events to metrics that will be sent to Splunk Observability Cloud. This will allow you to chart the events much more efficiently and take advantage of the real-time streaming metrics in Splunk Observability Cloud.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create Ingest Pipeline</summary><div class=box-content><ol><li><p>Open your <strong>Ingest Processor Cloud Stack</strong> instance using the URL provided in the Splunk Show workshop details.</p></li><li><p>Navigate to <strong>Apps</strong> -> <strong>Search and Reporting</strong></p></li></ol><p><a href=#R-image-831ee78374a5917ae39d261544771789 class=lightbox-link><img alt="Search and Reporting" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/search_and_reporting.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-831ee78374a5917ae39d261544771789><img alt="Search and Reporting" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/search_and_reporting.png?width=20vw"></a></p><ol start=3><li>In the search bar, enter the following SPL search string:</li></ol><div class="highlight wrap-code"><pre tabindex=0><code>```Replace PARTICIPANT_NUMBER with the participant number provided in your Splunk Show event details```
index=main sourcetype=&#34;kube:apiserver:audit:PARTICIPANT_NUMBER&#34;</code></pre></div><ol start=4><li>Press <strong>Enter</strong> or click the green magnifying glass to run the search.</li></ol><p><a href=#R-image-cdcc8f327aa483ce43dd0ee4413345ee class=lightbox-link><img alt="Kubernetes Audit Log" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/k8s_audit_log.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cdcc8f327aa483ce43dd0ee4413345ee><img alt="Kubernetes Audit Log" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/k8s_audit_log.png></a></p><p>You should now see the Kubernetes Audit Logs for your environment. Notice that the events are fairly robust. Explore the available fields and start to think about what information would be good candidates for metrics and dimensions. Ask yourself: What fields would I like to chart and how would I like to be able to filter, group, or split those fields?</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 29, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=create-an-ingest-pipeline>Create an Ingest Pipeline</h1><p>In this section you will create an Ingest Pipeline which will convert Kubernetes Audit Logs to metrics which are sent to the Splunk Observability Cloud workshop organization.</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Create Ingest Pipeline</summary><div class=box-content><ol><li>Open the <strong>Ingest Processor SCS Tenant</strong> using the connection details provided in the Splunk Show event.</li></ol><p><a href=#R-image-1b7c21e2eba2438d1b11f416f7c5e25b class=lightbox-link><img alt="Launch Splunk Cloud Platform" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/data_management_home.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1b7c21e2eba2438d1b11f416f7c5e25b><img alt="Launch Splunk Cloud Platform" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/data_management_home.png?width=40vw"></a></p><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p>When you open the <strong>Ingest Processor SCS Tenant</strong>, if you are taken to a welcome page, click on <strong>Launch</strong> under <strong>Splunk Cloud Platform</strong> to be taken the the Data Management page where you will configure the Ingest Pipeline.</p><p><a href=#R-image-c416d72e08eaa89a17a336bb0638b3e8 class=lightbox-link><img alt="Launch Splunk Cloud Platform" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=../../images/launch_scp.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c416d72e08eaa89a17a336bb0638b3e8><img alt="Launch Splunk Cloud Platform" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=../../images/launch_scp.png></a></p></div></details><ol start=2><li>From the Splunk Data Management console select <strong>Pipelines</strong> -> <strong>New pipeline</strong> -> <strong>Ingest Processor pipeline</strong>.</li></ol><p><a href=#R-image-69605464a8bf7ba1edc8538d2ea37fba class=lightbox-link><img alt="New Ingest Processor Pipeline" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/new_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-69605464a8bf7ba1edc8538d2ea37fba><img alt="New Ingest Processor Pipeline" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/new_pipeline.png?width=40vw"></a></p><ol start=3><li>In the <strong>Get started</strong> step of the Ingest Processor configuration page select <strong>Blank Pipeline</strong> and click <strong>Next</strong>.</li></ol><p><a href=#R-image-d007b55e9298794b2b9176d57c12d0a7 class=lightbox-link><img alt="Blank Ingest Processor Pipeline" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/blank_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-d007b55e9298794b2b9176d57c12d0a7><img alt="Blank Ingest Processor Pipeline" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/blank_pipeline.png?width=40vw"></a></p><ol start=4><li>In the <strong>Define your pipelineâ€™s partition</strong> step of the Ingest Processor configuration page select <strong>Partition by sourcetype</strong>. Select the <strong>= equals</strong> Operator and enter <code>kube:apiserver:audit:PARTICIPANT_NUMBER</code> (Be sure to replace PARTICIPANT_NUMBER with the participant number you were assigned) for the value. Click <strong>Apply</strong>.</li></ol><p><a href=#R-image-6d207db38b61283365bf526faa66694f class=lightbox-link><img alt="Add Partition" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/add_partition.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6d207db38b61283365bf526faa66694f><img alt="Add Partition" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/add_partition.png?width=40vw"></a></p><ol start=5><li><p>Click <strong>Next</strong></p></li><li><p>In the <strong>Add sample data</strong> step of the Ingest Processor configuration page select <strong>Capture new snapshot</strong>. Enter <code>k8s_audit</code> for the name and click <strong>Capture</strong>.</p></li></ol><p><a href=#R-image-55ed1f07ffce5f7dcb853bc91f1f8161 class=lightbox-link><img alt="Capture Snapshot" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/capture_snapshot.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-55ed1f07ffce5f7dcb853bc91f1f8161><img alt="Capture Snapshot" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/capture_snapshot.png?width=40vw"></a></p><ol start=7><li>Make sure your newly created snapshot (<code>k8s_audit</code>) is selected and then click <strong>Next</strong>.</li></ol><p><a href=#R-image-47843aad087019fa524116db6ed95bc5 class=lightbox-link><img alt="Configure Snapshot Sourcetype" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/capture_snapshot_sourcetype.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-47843aad087019fa524116db6ed95bc5><img alt="Configure Snapshot Sourcetype" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/capture_snapshot_sourcetype.png?width=20vw"></a></p><ol start=8><li>In the <strong>Select a metrics destination</strong> step of the Ingest Processor configuration page select <strong>show_o11y_org</strong>. Click <strong>Next</strong>.</li></ol><p><a href=#R-image-6d38d9c729d2dc30801a3add895cae49 class=lightbox-link><img alt="Metrics Destination" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/metrics_destination.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6d38d9c729d2dc30801a3add895cae49><img alt="Metrics Destination" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/metrics_destination.png?width=20vw"></a></p><ol start=9><li>In the <strong>Select a data destination</strong> step of the Ingest Processor configuration page select <strong>splunk_indexer</strong>. Under <strong>Specify how you want your events to be routed to an index</strong> select <strong>Default</strong>. Click <strong>Done</strong>.</li></ol><p><a href=#R-image-a4b008d287b147a53f4118e5bc2b7bcb class=lightbox-link><img alt="Event Routing" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/event_routing.png?width=20vw" style=height:auto;width:20vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-a4b008d287b147a53f4118e5bc2b7bcb><img alt="Event Routing" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/event_routing.png?width=20vw"></a></p><ol start=10><li>In the <strong>Pipeline search field</strong> replace the default search with the following.</li></ol><details open class="box cstyle notices primary"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
Note</summary><div class=box-content><p><strong>Replace <code>UNIQUE_FIELD</code> in the metric name with a unique value which will be used to identify your metric in Observability Cloud.</strong></p></div></details><div class="highlight wrap-code"><pre tabindex=0><code>/*A valid SPL2 statement for a pipeline must start with &#34;$pipeline&#34;, and include &#34;from $source&#34; and &#34;into $destination&#34;.*/
/* Import logs_to_metrics */
import logs_to_metrics from /splunk/ingest/commands
$pipeline =
| from $source
| thru [
//define the metric name, type, and value for the Kubernetes Events
| logs_to_metrics name=&#34;k8s_audit_UNIQUE_FIELD&#34; metrictype=&#34;counter&#34; value=1 time=_time
| into $metrics_destination
]
| eval index = &#34;kube_logs&#34;
//Send unfiltered logs to S3
| into $destination;</code></pre></div><details open class="box cstyle notices info"><summary class=box-label><i class="fa-fw fas fa-lightbulb"></i>
New to SPL2?</summary><div class=box-content><p>Here is a breakdown of what the SPL2 query is doing:</p><ul><li>First, you are importing the built in <code>logs_to_metrics</code> command which will be used to convert the kubernetes events to metrics.</li><li>You&rsquo;re using the source data, which you can see on the right is any event from the <code>kube:apiserver:audit</code> sourcetype.</li><li>Now, you use the <code>thru</code> command which writes the source dataset to the following command, in this case <code>logs_to_metrics</code>.</li><li>You can see that the metric name (<code>k8s_audit</code>), metric type (<code>counter</code>), value, and timestamp are all provided for the metric. Youâ€™re using a value of 1 for this metric because we want to count the number of times the event occurs.</li><li>Next, you choose the destination for the metric using the into <code>$metrics_destintation</code> command, which is our Splunk Observability Cloud organization</li><li>Finally, you can send the raw log events to another destination, in this case another index, so they are retained if we ever need to access them.</li></ul></div></details><ol start=11><li>In the upper-right corner click the <strong>Preview</strong> button <a href=#R-image-af73d027eab9a3f3e1b882eb8f126ed3 class=lightbox-link><img alt="Preview Button" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af73d027eab9a3f3e1b882eb8f126ed3><img alt="Preview Button" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/preview.png?height=20px&classes=inline"></a> or press CTRL+Enter (CMD+Enter on Mac). From the <strong>Previewing $pipeline</strong> dropdown select <strong>$metrics_destination</strong>. Confirm you are seeing a preview of the metrics that will be sent to Splunk Observability Cloud.</li></ol><p><a href=#R-image-1deacdeb475f815ed892d45f940e0115 class=lightbox-link><img alt="Preview Pipeline" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/preview_pipeline.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-1deacdeb475f815ed892d45f940e0115><img alt="Preview Pipeline" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/preview_pipeline.png?width=40vw"></a></p><ol start=12><li>In the upper-right corner click the <strong>Save pipeline</strong> button <a href=#R-image-53befc529ca44187c8986b5d8cc7b51d class=lightbox-link><img alt="Save Pipeline Button" class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline" style=height:20px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-53befc529ca44187c8986b5d8cc7b51d><img alt="Save Pipeline Button" class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/save_pipeline_btn.png?height=20px&classes=inline"></a>. Enter a name for your pipeline and click <strong>Save</strong>.</li></ol><p><a href=#R-image-aee297bc2f7ec8ddb8a851842d6ab206 class=lightbox-link><img alt="Save Pipeline Dialog" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/save_pipeline_dialog.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aee297bc2f7ec8ddb8a851842d6ab206><img alt="Save Pipeline Dialog" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/save_pipeline_dialog.png?width=40vw"></a></p><ol start=13><li>After clicking save you will be asked if you would like to apply the newly created pipeline. Click <strong>Yes, apply</strong>.</li></ol><p><a href=#R-image-3cbfbd2fe4c80680b0fba570cc4a8c82 class=lightbox-link><img alt="Apply Pipeline Dialog" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/apply_pipeline_dialog.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3cbfbd2fe4c80680b0fba570cc4a8c82><img alt="Apply Pipeline Dialog" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/apply_pipeline_dialog.png?width=40vw"></a></p><center><b>The Ingest Pipeline should now be sending metrics to Splunk Observability Cloud. Keep this tab open as it will be used it again in the next section.</b><p>In the next step you&rsquo;ll confirm the pipeline is working by viewing the metrics you just created in Splunk Observability Cloud.</p></center></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 29, 2025</span></span></footer></article><article class=default><header class=headline></header><h1 id=confirm-metrics-in-splunk-observability-cloud>Confirm Metrics in Splunk Observability Cloud</h1><p>Now that an Ingest Pipeline has been configured to convert Kubernetes Audit Logs into metrics and send them to Splunk Observability Cloud the metrics should be available. To confirm the metrics are being collected complete the following steps:</p><details open class="box cstyle notices green"><summary class=box-label><i class="fa-fw fas fa-running"></i>
Exercise: Confirm Metrics in Splunk Observability Cloud</summary><div class=box-content><ol><li>Login to the <strong>Splunk Observability Cloud</strong> organization you were invited for the workshop. In the upper-right corner, click the <strong>+</strong> Icon -> <strong>Chart</strong> to create a new chart.</li></ol><p><a href=#R-image-aba81c71231d94c2b01496c7ab6a08e4 class=lightbox-link><img alt="Create New Chart" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/create_new_chart.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-aba81c71231d94c2b01496c7ab6a08e4><img alt="Create New Chart" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/create_new_chart.png?width=40vw"></a></p><ol start=2><li>In the <strong>Plot Editor</strong> of the newly created chart enter the metric name you used while configuring the <strong>Ingest Pipeline</strong>.</li></ol><p><a href=#R-image-9e745db626ed609a98c4beb98a711951 class=lightbox-link><img alt="Review Metric" class="noborder lazy lightbox noshadow figure-image" loading=lazy src="../../images/review_metric.png?width=40vw" style=height:auto;width:40vw></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-9e745db626ed609a98c4beb98a711951><img alt="Review Metric" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src="../../images/review_metric.png?width=40vw"></a></p><center><b>You should see the metric you created in the Ingest Pipeline. Keep this tab open as it will be used again in the next section.</b><p>In the next step you will update the ingest pipeline to add dimensions to the metric so you have additional context for alerting and troubleshooting.</p></center></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Jan 29, 2025</span></span></footer></article></section></div></main></div><script src=/observability-workshop/v5.79/js/clipboard.min.js?1738938790 defer></script><script src=/observability-workshop/v5.79/js/perfect-scrollbar.min.js?1738938790 defer></script><script src=/observability-workshop/v5.79/js/theme.js?1738938790 defer></script></body></html>
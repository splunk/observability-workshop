<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This workshop is going to take you through the best-in-class observability solution for ingesting, monitoring, visualizing and analyzing data"><meta name=author content="Sales Engineering"><link href=https://signalfx.github.io/observability-workshop/lambda/springboot-apm/ rel=canonical><link rel="shortcut icon" href=../../images/favicon.ico><meta name=generator content="mkdocs-1.1.2, mkdocs-material-6.2.7"><title>Enable APM for Mobile Shop Springboot App - Splunk Observability Suite Workshop</title><link rel=stylesheet href=../../assets/stylesheets/main.cb6bc1d0.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.39b8e14a.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CUbuntu+Mono&display=fallback"><style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono",SFMono-Regular,Consolas,Menlo,monospace}</style><link rel=stylesheet href=../../stylesheets/extra.css></head> <body dir=ltr data-md-color-scheme=preference data-md-color-primary data-md-color-accent> <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#enable-apm-for-mobile-shop-springboot-app class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header-nav md-grid" aria-label=Header> <a href=https://signalfx.github.io/observability-workshop/ title="Splunk Observability Suite Workshop" class="md-header-nav__button md-logo" aria-label="Splunk Observability Suite Workshop"> <img src=../../images/logo.png alt=logo> </a> <label class="md-header-nav__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header-nav__title data-md-component=header-title> <div class=md-header-nav__ellipsis> <div class=md-header-nav__topic> <span class=md-ellipsis> Splunk Observability Suite Workshop </span> </div> <div class=md-header-nav__topic> <span class=md-ellipsis> Enable APM for Mobile Shop Springboot App </span> </div> </div> </div> <label class="md-header-nav__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear data-md-component=search-reset tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header-nav__source> <a href=https://github.com/signalfx/observability-workshop/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../../smartagent/ class=md-tabs__link> <b>Infrastructure & APM</b> </a> </li> <li class=md-tabs__item> <a href=../../oncall/getting_started/ class=md-tabs__link> <b>On-Call</b> </a> </li> <li class=md-tabs__item> <a href=../../resources/ class=md-tabs__link> <b>Resources</b> </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=https://signalfx.github.io/observability-workshop/ title="Splunk Observability Suite Workshop" class="md-nav__button md-logo" aria-label="Splunk Observability Suite Workshop"> <img src=../../images/logo.png alt=logo> </a> Splunk Observability Suite Workshop </label> <div class=md-nav__source> <a href=https://github.com/signalfx/observability-workshop/ title="Go to repository" class=md-source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2 type=checkbox id=nav-2> <label class=md-nav__link for=nav-2> <b>Infrastructure & APM</b> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Infrastructure & APM</b>" data-md-level=1> <label class=md-nav__title for=nav-2> <span class="md-nav__icon md-icon"></span> <b>Infrastructure & APM</b> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../smartagent/ class=md-nav__link> Workshop Introduction </a> </li> <li class=md-nav__item> <a href=../../smartagent/connect-info/ class=md-nav__link> Access AWS/EC2 instance </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-3 type=checkbox id=nav-2-3> <label class=md-nav__link for=nav-2-3> <b>Get Data In</b><br><small>20 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Get Data In</b><br /><small>20 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-3> <span class="md-nav__icon md-icon"></span> <b>Get Data In</b><br><small>20 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../smartagent/k3s/ class=md-nav__link> Deploy the Smart Agent in K3s </a> </li> <li class=md-nav__item> <a href=../../smartagent/nginx/ class=md-nav__link> Deploy NGINX in K3s </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-4 type=checkbox id=nav-2-4> <label class=md-nav__link for=nav-2-4> <b>Dashboards</b><br><small>30 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Dashboards</b><br /><small>30 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-4> <span class="md-nav__icon md-icon"></span> <b>Dashboards</b><br><small>30 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../dashboards/ class=md-nav__link> Introduction </a> </li> <li class=md-nav__item> <a href=../../dashboards/editing/ class=md-nav__link> Editing charts </a> </li> <li class=md-nav__item> <a href=../../dashboards/filtering/ class=md-nav__link> Using filters </a> </li> <li class=md-nav__item> <a href=../../dashboards/formulas/ class=md-nav__link> Using formulas </a> </li> <li class=md-nav__item> <a href=../../dashboards/overlay/ class=md-nav__link> Using overlays </a> </li> <li class=md-nav__item> <a href=../../dashboards/signalflow/ class=md-nav__link> SignalFlow </a> </li> <li class=md-nav__item> <a href=../../dashboards/adding-charts/ class=md-nav__link> Adding charts </a> </li> <li class=md-nav__item> <a href=../../dashboards/datalinks/ class=md-nav__link> Integration to Splunk </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-5 type=checkbox id=nav-2-5> <label class=md-nav__link for=nav-2-5> <b>Detectors</b><br><small>15 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Detectors</b><br /><small>15 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-5> <span class="md-nav__icon md-icon"></span> <b>Detectors</b><br><small>15 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../detectors/detectors/ class=md-nav__link> Creating a Detector </a> </li> <li class=md-nav__item> <a href=../../detectors/muting/ class=md-nav__link> Creating a Muting Rule </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-6 type=checkbox id=nav-2-6> <label class=md-nav__link for=nav-2-6> <b>Monitoring as Code</b><br><small>10 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Monitoring as Code</b><br /><small>10 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-6> <span class="md-nav__icon md-icon"></span> <b>Monitoring as Code</b><br><small>10 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../monitoring-as-code/ class=md-nav__link> Initial Setup </a> </li> <li class=md-nav__item> <a href=../../monitoring-as-code/plan-and-apply/ class=md-nav__link> Plan, Apply and Destroy </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-7 type=checkbox id=nav-2-7> <label class=md-nav__link for=nav-2-7> <b>APM</b><br><small>30 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>APM</b><br /><small>30 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-7> <span class="md-nav__icon md-icon"></span> <b>APM</b><br><small>30 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../apm/ class=md-nav__link> APM Architecture Overview </a> </li> <li class=md-nav__item> <a href=../../apm/hotrod/ class=md-nav__link> Deploying Hot R.O.D. in K3s </a> </li> <li class=md-nav__item> <a href=../../apm/hotrod-trouble-timebased/ class=md-nav__link> Troubleshooting Hot R.O.D. </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-2-8 type=checkbox id=nav-2-8> <label class=md-nav__link for=nav-2-8> <b>Service Bureau</b><br><small>20 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Service Bureau</b><br /><small>20 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-2-8> <span class="md-nav__icon md-icon"></span> <b>Service Bureau</b><br><small>20 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../servicebureau/billing-and-usage/ class=md-nav__link> Billing and Usage </a> </li> <li class=md-nav__item> <a href=../../servicebureau/teams/ class=md-nav__link> Teams </a> </li> <li class=md-nav__item> <a href=../../servicebureau/tokens/ class=md-nav__link> Control Usage </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3 type=checkbox id=nav-3> <label class=md-nav__link for=nav-3> <b>On-Call</b> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>On-Call</b>" data-md-level=1> <label class=md-nav__title for=nav-3> <span class="md-nav__icon md-icon"></span> <b>On-Call</b> </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-1 type=checkbox id=nav-3-1> <label class=md-nav__link for=nav-3-1> <b>Getting Started</b><br><small>45 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Getting Started</b><br /><small>45 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-3-1> <span class="md-nav__icon md-icon"></span> <b>Getting Started</b><br><small>45 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../oncall/getting_started/ class=md-nav__link> Initial Setup </a> </li> <li class=md-nav__item> <a href=../../oncall/getting_started/user_profile/ class=md-nav__link> User Profile </a> </li> <li class=md-nav__item> <a href=../../oncall/getting_started/team/ class=md-nav__link> Teams </a> </li> <li class=md-nav__item> <a href=../../oncall/getting_started/rotations/ class=md-nav__link> Configure Rotations </a> </li> <li class=md-nav__item> <a href=../../oncall/getting_started/escalation/ class=md-nav__link> Configure Escalation Policies </a> </li> <li class=md-nav__item> <a href=../../oncall/getting_started/routing/ class=md-nav__link> Creating Routing keys </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-2 type=checkbox id=nav-3-2> <label class=md-nav__link for=nav-3-2> <b>Incident Lifecycle</b><br><small>45 minutes</small> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Incident Lifecycle</b><br /><small>45 minutes</small>" data-md-level=2> <label class=md-nav__title for=nav-3-2> <span class="md-nav__icon md-icon"></span> <b>Incident Lifecycle</b><br><small>45 minutes</small> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../oncall/incident_lifecycle/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../oncall/incident_lifecycle/create_incidents/ class=md-nav__link> Create Incidents </a> </li> <li class=md-nav__item> <a href=../../oncall/incident_lifecycle/manage_incidents/ class=md-nav__link> Manage Incidents </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-3-3 type=checkbox id=nav-3-3> <label class=md-nav__link for=nav-3-3> <b>Optional Modules</b> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Optional Modules</b>" data-md-level=2> <label class=md-nav__title for=nav-3-3> <span class="md-nav__icon md-icon"></span> <b>Optional Modules</b> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../oncall/optional/sfx_integrations/ class=md-nav__link> SignalFx Integration </a> </li> <li class=md-nav__item> <a href=../../oncall/optional/multipass/ class=md-nav__link> Using Multipass VM </a> </li> <li class=md-nav__item> <a href=../../oncall/optional/detector/ class=md-nav__link> Create a Detector </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=nav-4 type=checkbox id=nav-4> <label class=md-nav__link for=nav-4> <b>Resources</b> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="<b>Resources</b>" data-md-level=1> <label class=md-nav__title for=nav-4> <span class="md-nav__icon md-icon"></span> <b>Resources</b> </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../resources/ class=md-nav__link> Links </a> </li> <li class=md-nav__item> <a href=../../resources/faq/ class=md-nav__link> FAQ </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=#1-validate-apm-environment class=md-nav__link> 1. Validate APM Environment </a> </li> <li class=md-nav__item> <a href=#2-update-the-settings-in-the-spring-boot-app class=md-nav__link> 2. Update the settings in the spring boot app </a> <nav class=md-nav aria-label="2. Update the settings in the spring boot app"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#21-update-the-framework-by-updating-pomxml class=md-nav__link> 2.1 Update the FrameWork by updating POM.XML </a> </li> <li class=md-nav__item> <a href=#22-update-the-application-property-file class=md-nav__link> 2.2 Update the application property file </a> </li> <li class=md-nav__item> <a href=#23-update-the-source-code-by-enabling-apm class=md-nav__link> 2.3 Update the source code by enabling APM </a> </li> <li class=md-nav__item> <a href=#24-run-the-app class=md-nav__link> 2.4 Run the App </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content> <article class="md-content__inner md-typeset"> <h1 id=enable-apm-for-mobile-shop-springboot-app>Enable APM for Mobile Shop Springboot App<a class=headerlink href=#enable-apm-for-mobile-shop-springboot-app title="Permanent link">&para;</a></h1> <h2 id=1-validate-apm-environment>1. Validate APM Environment<a class=headerlink href=#1-validate-apm-environment title="Permanent link">&para;</a></h2> <p>The first activity we are going to do is validate that we have access to the Splunk APM environment and establish our starting point. To do this please login to Splunk Infrastructure &amp; APM and select <strong>APM</strong>.</p> <p><img alt=APM-MENU class=zoom src=../../images/lambda/springboot-apm/IsAPMAvailable.png></p> <p>This will bring you to the APM monitoring page, depending how many services you are currently monitoring with Splunk APM, you may or may not see a list of services.</p> <p>Once you have run the applications with APM enabled, you can filter the environment by entering your unique id you have been provided. This should then show just your APM environment.</p> <p><img alt=APM-MENU class=zoom src=../../images/lambda/springboot-apm/APM-monitor.png></p> <p>So lets start enabling APM in our environment.</p> <hr> <h2 id=2-update-the-settings-in-the-spring-boot-app>2. Update the settings in the spring boot app<a class=headerlink href=#2-update-the-settings-in-the-spring-boot-app title="Permanent link">&para;</a></h2> <p>To enable APM on the Spring boot application we need to update the FrameWork (pom.xml), update the application settings en add enable some lines in the code.</p> <h3 id=21-update-the-framework-by-updating-pomxml>2.1 Update the FrameWork by updating POM.XML<a class=headerlink href=#21-update-the-framework-by-updating-pomxml title="Permanent link">&para;</a></h3> <p>Connect back into your EC2 instance and stop the running Spring boot application by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-c>C</kbd></span>. </p> <p>Once the application is stopped, open an editor and edit the pom.xml file</p> <div class=tabbed-set data-tabs=1:1><input checked=checked id=__tabbed_1_1 name=__tabbed_1 type=radio><label for=__tabbed_1_1>Shell Command</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>nano pom.xml
</code></pre></div> </div> </div> <p>Scroll down until you find the following section <img alt=pom-1 class=zoom src=../../images/lambda/springboot-apm/POM_xml-1.png></p> <p>and remove the comment marks lines <em>(&lt;-- &amp; --&gt;)</em> by placing the cursor on the line with the remark and press <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-k>K</kbd></span></p> <p>Afterwards the section will look like this: <img alt=pom-2 class=zoom src=../../images/lambda/springboot-apm/POM_xml-2.png></p> <p>Make sure the lines are properly aligned and save the file by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-o>O</kbd></span> followed by <span class=keys><kbd class=key-enter>Enter</kbd></span> to write the file pom.xml to disk.</p> <p>You can now leave the nano editor by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-x>X</kbd></span>. This should bring you back to the command line.</p> <h3 id=22-update-the-application-property-file>2.2 Update the application property file<a class=headerlink href=#22-update-the-application-property-file title="Permanent link">&para;</a></h3> <p>Edit the application property file of the springboot application in the nano editor by enter in the following command:</p> <div class=tabbed-set data-tabs=2:1><input checked=checked id=__tabbed_2_1 name=__tabbed_2 type=radio><label for=__tabbed_2_1>Shell Command</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>nano src/main/resources/application.properties
</code></pre></div> </div> </div> <p>Remove the comment marks ## on the following 2 lines: <strong>##spring.sleuth.sampler.probability=1.0</strong></p> <p><strong>##spring.zipkin.baseUrl=http://localhost:9080</strong></p> <p>The first line tells the springboot app to send 100% of the traces to Splunk APM and the second line directs the traces and spans to the local local OpenTelemetry Collector that will forward them to splunk APM.</p> <p>Your file should now look like this:</p> <div class=tabbed-set data-tabs=3:1><input checked=checked id=__tabbed_3_1 name=__tabbed_3 type=radio><label for=__tabbed_3_1>application.properties File</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>spring.thymeleaf.cache=false
spring.thymeleaf.enabled=true
spring.thymeleaf.prefix=classpath:/templates/
spring.thymeleaf.suffix=.html

server.port=8080
spring.application.name=ACME-Mobile-Web-Shop-Base

# For Sleuth 2.1+ use this property
## Enable this for full fidelity tracing   
spring.sleuth.sampler.probability=1.0

# The base url with the endpoint (/api/v2/spans) excluded
# OpenTelemetry Collector deployed in your TKE namespace
## Enable this to send Traces to SignalFX
spring.zipkin.baseUrl=http://localhost:9080
</code></pre></div> </div> </div> <p>Now save the file by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-o>O</kbd></span> followed by enter to write the file applications.properties file to disk.</p> <p>You can now leave the nano editor by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-x>X</kbd></span>. This should bring you back to the command line.</p> <h3 id=23-update-the-source-code-by-enabling-apm>2.3 Update the source code by enabling APM<a class=headerlink href=#23-update-the-source-code-by-enabling-apm title="Permanent link">&para;</a></h3> <p>Open the main java file of the springboot application in the nano editor by enter in the following command:</p> <div class=tabbed-set data-tabs=4:1><input checked=checked id=__tabbed_4_1 name=__tabbed_4 type=radio><label for=__tabbed_4_1>Shell Command</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>nano src/main/java/com/sfx/JavaLambda/JavaLambdaController.java
</code></pre></div> </div> </div> <p>Remove the comment marks /* &amp; */ around the following three lines:</p> <div class=codehilite><pre><span></span><code>/*
import brave.sampler.Sampler;
import brave.SpanCustomizer;
import brave.Tracer;
*/
</code></pre></div> <p>And remove the comment marks // in front of the following two lines:</p> <div class=codehilite><pre><span></span><code>//@Autowired Tracer tracer;
//@Autowired SpanCustomizer span;
</code></pre></div> <p>So that your JavaLambdaController.java file now looks like this (note only the first 33 lines are shown below for brevity):</p> <div class=tabbed-set data-tabs=5:1><input checked=checked id=__tabbed_5_1 name=__tabbed_5 type=radio><label for=__tabbed_5_1>JavaLambdaController.java</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>package com.sfx.JavaLambda;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.ObjectReader;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Bean;
import org.springframework.http.*;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.client.RestTemplate;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PostMapping;
import java.util.*;
import java.io.IOException;

import brave.sampler.Sampler;
import brave.SpanCustomizer;
import brave.Tracer;

@Controller
public class JavaLambdaController {
    // set up AutoWired sleuth for APM

        @Autowired Tracer tracer;
        @Autowired SpanCustomizer span;
</code></pre></div> </div> </div> <p>Now save the file by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-o>O</kbd></span> followed by enter to write the file Java file to disk. You can now leave the nano editor by pressing <span class=keys><kbd class=key-control>Ctrl</kbd><span>+</span><kbd class=key-x>X</kbd></span>. This should bring you back to the command line.</p> <h3 id=24-run-the-app>2.4 Run the App<a class=headerlink href=#24-run-the-app title="Permanent link">&para;</a></h3> <p>Run the application by issuing the following command again:</p> <div class=tabbed-set data-tabs=6:1><input checked=checked id=__tabbed_6_1 name=__tabbed_6 type=radio><label for=__tabbed_6_1>Shell Command</label><div class=tabbed-content> <div class=highlight><pre><span></span><code>mvn spring-boot:run 
</code></pre></div> </div> </div> <p>When you have updated the files correctly you should see the SpringBoot logo again with no errors .</p> <p><img alt=ec2-loaded class=zoom src=../../images/lambda/initial_run/Springboot.png></p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>If you get errors:</p> <p>Please make sure that all the files are properly aligned and replace any leading spaces with Tabs</p> </div> <p>Continue to the next section.</p> <hr> <div class=md-source-date> <small> Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">December 10, 2020 09:59:02</span> </small> </div> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; 2020 Splunk Inc. All rights reserved. </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-footer-social> <a href=https://github.com/signalfx/observability-workshop target=_blank rel=noopener title=github.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> <a href=https://twitter.com/splunk target=_blank rel=noopener title=twitter.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> </a> <a href=https://www.linkedin.com/company/splunk/ target=_blank rel=noopener title=www.linkedin.com class=md-footer-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> </div> </div> </div> </footer> </div> <script src=../../assets/javascripts/vendor.53cc9318.min.js></script> <script src=../../assets/javascripts/bundle.e9c9f54f.min.js></script><script id=__lang type=application/json>{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}</script> <script>
        app = initialize({
          base: "../..",
          features: ['tabs', 'navigation.tabs'],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.9c0e82ba.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script> <script src=../../javascripts/extra.js></script> </body> </html>
<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.1.1+tip"><meta name=description content="With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.
To look at the performance of your database queries, make sure you are on the APM Explore page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the Explore tile."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Database Query Performance :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.
To look at the performance of your database queries, make sure you are on the APM Explore page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the Explore tile."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Database Query Performance :: Splunk Observability Cloud Workshops"><meta property="og:description" content="With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.
To look at the performance of your database queries, make sure you are on the APM Explore page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the Explore tile."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="Ninja Workshops"><meta property="article:modified_time" content="2024-08-20T15:53:10+01:00"><meta itemprop=name content="Database Query Performance :: Splunk Observability Cloud Workshops"><meta itemprop=description content="With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.
To look at the performance of your database queries, make sure you are on the APM Explore page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the Explore tile."><meta itemprop=dateModified content="2024-08-20T15:53:10+01:00"><meta itemprop=wordCount content="366"><title>Database Query Performance :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/index.html rel=canonical type=text/html title="Database Query Performance :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.65/images/favicon.ico?1725615612 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.65/css/fontawesome-all.min.css?1725615612 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.65/css/fontawesome-all.min.css?1725615612 rel=stylesheet></noscript><link href=/observability-workshop/v5.65/css/nucleus.css?1725615612 rel=stylesheet><link href=/observability-workshop/v5.65/css/auto-complete.css?1725615612 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.65/css/auto-complete.css?1725615612 rel=stylesheet></noscript><link href=/observability-workshop/v5.65/css/perfect-scrollbar.min.css?1725615612 rel=stylesheet><link href=/observability-workshop/v5.65/css/fonts.css?1725615612 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.65/css/fonts.css?1725615612 rel=stylesheet></noscript><link href=/observability-workshop/v5.65/css/theme.css?1725615612 rel=stylesheet><link href=/observability-workshop/v5.65/css/theme-splunk-light.css?1725615612 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.65/css/chroma-relearn-light.css?1725615612 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.65/css/variant.css?1725615612 rel=stylesheet><link href=/observability-workshop/v5.65/css/print.css?1725615612 rel=stylesheet media=print><link href=/observability-workshop/v5.65/css/format-print.css?1725615612 rel=stylesheet><script src=/observability-workshop/v5.65/js/variant.js?1725615612></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../../..",window.relearn.relBaseUri="../../../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.65",window.index_js_url="/observability-workshop/v5.65/en/index.search.js?1725615612",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"eu0",rumAccessToken:"TR9BBfgYo7qJfqrfgqjoqA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.65/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.65/en/other/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.65/en/other/3-automatic-discovery/index.html><span itemprop=name>Automatic Discovery Workshops</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/index.html><span itemprop=name>PetClinic Kubernetes Workshop</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/index.html><span itemprop=name>6. Advanced Features</span></a><meta itemprop=position content="5">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>3. Database Query Performance</span><meta itemprop=position content="6"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/2-waterfall/index.html title="Always-On Profiling in the Trace Waterfall (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/4-section-break/index.html title="4. Section Break (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=database-query-performance>Database Query Performance</h1><p>With Database Query Performance, you can monitor the impact of your database queries on service availability directly in Splunk APM. This way, you can quickly identify long-running, unoptimized, or heavy queries and mitigate issues they might be causing, without having to instrument your databases.</p><p>To look at the performance of your database queries, make sure you are on the APM <strong>Explore</strong> page either by going back in the browser or navigating to the APM section in the Menu bar, then click on the <strong>Explore</strong> tile.
Select the inferred database service <code>mysql:petclinic</code> Inferred Database server in the Dependency map <strong>(1)</strong>, then scroll the right-hand pane to find the <strong>Database Query Performance</strong> Pane <strong>(2)</strong>.</p><p><a href=#R-image-6e372f1034274e0cf9ae204d3b5099eb class=lightbox-link><img alt="DB-query from map" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/db-query-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-6e372f1034274e0cf9ae204d3b5099eb><img alt="DB-query from map" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/db-query-map.png></a></p><p>If the service you have selected in the map is indeed an (inferred) database server, this pane will populate with the top 90% (P90) database calls based on duration. To dive deeper into the db-query performance function click somewhere on the word <strong>Database Query Performance</strong> at the top of the pane.</p><p>This will bring us to the DB-query Performance overview screen:</p><p><a href=#R-image-c4f13c64f9f546da3315e334c9ca9911 class=lightbox-link><img alt="DB-query full" class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/db-query-full.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c4f13c64f9f546da3315e334c9ca9911><img alt="DB-query full" class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/db-query-full.png></a></p><div class="box notices cstyle info"><div class=box-label><i class="fa-fw fas fa-info-circle"></i> Database Query Normalization</div><div class=box-content><p>By default, Splunk APM instrumentation sanitizes database queries to remove or mask sensible data, such as secrets or personally identifiable information (PII) from the <code>db.statements</code>. You can find how to turn off database query normalization <a href=https://docs.splunk.com/observability/en/apm/db-query-perf/db-perf-troubleshooting.html#turn-off-database-query-normalization rel=external target=_blank>here</a>.</p></div></div><p>This screen will show us all the Database queries <strong>(1)</strong> done towards our database from your application, based on the Traces & Spans sent to the Splunk Observability Cloud. Note that you can compare them across a time block or sort them on Total Time, P90 Latency & Requests <strong>(2)</strong>.</p><p>For each Database query in the list, we see the highest latency, the total number of calls during the time window and the number of requests per second <strong>(3)</strong>. This allows you to identify places where you might optimize your queries.</p><p>You can select traces containing Database Calls via the two charts in the right-hand pane <strong>(5)</strong>. Use the Tag Spotlight pane <strong>(6)</strong> to drill down what tags are related to the database calls, based on endpoints or tags.</p><p>If you click on a specific Query <strong>(1)</strong> you get a detailed query Details pane appears <strong>(2)</strong>, which you can use for more detailed investigations:
<a href=#R-image-10721eae81405ae1f7981c5c63c4884f class=lightbox-link><img alt=details class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/query-details.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-10721eae81405ae1f7981c5c63c4884f><img alt=details class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.65/en/other/3-automatic-discovery/2-petclinic-kubernetes/6-profiling-db-query/3-dbquery/../../images/query-details.png></a></p><footer class=footline><span class="badge cstyle tip badge-with-title"><span class=badge-title class=text-muted>Last Modified By
</span><span class=badge-content>rcastley</span>
</span>&nbsp;
<span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted><i class="fa-fw fas fa-calendar"></i>
</span><span class=badge-content>Aug 20, 2024</span></span></footer></article></div></main></div><script src=/observability-workshop/v5.65/js/clipboard.min.js?1725615612 defer></script><script src=/observability-workshop/v5.65/js/perfect-scrollbar.min.js?1725615612 defer></script><script src=/observability-workshop/v5.65/js/theme.js?1725615612 defer></script></body></html>
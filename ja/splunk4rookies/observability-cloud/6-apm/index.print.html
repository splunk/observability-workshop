<!doctype html><html id=R-html lang=ja dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 9.0.3+9bc97fdf9eaf3af61af9bcc11db2e010de83af95"><meta name=description content="このセクションでは、APMを使用して掘り下げ、問題がどこにあるかを特定します。"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Splunk APM :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="このセクションでは、APMを使用して掘り下げ、問題がどこにあるかを特定します。"><meta property="og:url" content="https://splunk.github.io/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Splunk APM :: Splunk Observability Cloud Workshops"><meta property="og:description" content="このセクションでは、APMを使用して掘り下げ、問題がどこにあるかを特定します。"><meta property="og:locale" content="ja"><meta property="og:type" content="website"><meta itemprop=name content="Splunk APM :: Splunk Observability Cloud Workshops"><meta itemprop=description content="このセクションでは、APMを使用して掘り下げ、問題がどこにあるかを特定します。"><meta itemprop=dateModified content="2025-04-30T13:25:05+09:00"><meta itemprop=wordCount content="18"><title>Splunk APM :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/splunk4rookies/observability-cloud/6-apm/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/splunk4rookies/observability-cloud/6-apm/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/index.html rel=canonical type=text/html title="Splunk APM :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/images/favicon.ico?1770054185 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/css/auto-complete/auto-complete.min.css?1770054185 rel=stylesheet><script src=/observability-workshop/js/auto-complete/auto-complete.min.js?1770054185 defer></script><script src=/observability-workshop/js/search-lunr.min.js?1770054185 defer></script><script src=/observability-workshop/js/search.min.js?1770054185 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/observability-workshop/searchindex.ja.js?1770054185"</script><script src=/observability-workshop/js/lunr/lunr.min.js?1770054185 defer></script><script src=/observability-workshop/js/lunr/lunr.stemmer.support.min.js?1770054185 defer></script><script src=/observability-workshop/js/lunr/lunr.multi.min.js?1770054185 defer></script><script src=/observability-workshop/js/lunr/tinyseg.js?1770054185 defer></script><script src=/observability-workshop/js/lunr/lunr.ja.min.js?1770054185 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["ja"]</script><link href=/observability-workshop/fonts/fontawesome/css/all.min.css?1770054185 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/fonts/fontawesome/css/all.min.css?1770054185 rel=stylesheet></noscript><link href=/observability-workshop/css/perfect-scrollbar/perfect-scrollbar.min.css?1770054185 rel=stylesheet><link href=/observability-workshop/css/theme.min.css?1770054185 rel=stylesheet><link href=/observability-workshop/css/format-print.min.css?1770054185 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/ja/splunk4rookies/observability-cloud/6-apm/index.html",window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop",window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!0,window.T_Copy_to_clipboard=`テキストをクリップボードにコピー`,window.T_Copied_to_clipboard=`テキストをクリップボードにコピーしました!`,window.T_Link_copied_to_clipboard=`リンクをクリップボードにコピーしました!`,window.T_Reset_view=`ビューのリセット`,window.T_View_reset=`リセットを見る`,window.T_No_results_found=`"{0}" の結果が見つかりません`,window.T_N_results_found=`"{0}" で {1} 件の結果が見つかりました`,window.T_Browser_unsupported_feature=`このブラウザはこの機能をサポートしていません`,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantprefix="my-custom-",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";(!e||!e.startsWith(window.relearn.customvariantprefix)&&!window.relearn.themevariants.includes(e)||e.startsWith(window.relearn.customvariantprefix)&&!window.localStorage.getItem(window.relearn.absBaseUri+"/variantstylesheet-"+e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({appplicationName:"observability-workshop",realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",recorder:"splunk",features:{video:!0}})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}p{margin:.75rem 0}.highlight{max-height:500px;overflow-y:auto}pre:not(.mermaid){margin:0}</style></head><body class="mobile-support print" data-origin=/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar class=default-animation><div class="topbar-wrapper default-animation"><div class="topbar-sidebar-divider default-animation"></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar default-animation" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleNav() type=button title="メニュー (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="目次 (CTRL+ALT+t)"><i class="fa-fw fas fa-table-list"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/splunk4rookies/index.html><span itemprop=name>Splunk4Rookies ワークショップ</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/splunk4rookies/observability-cloud/index.html><span itemprop=name>Observability Cloud</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>6. Splunk APM</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print default-animation" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/index.print.html title="章全体を印刷する (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span></div><div class="topbar-button topbar-button-prev default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/splunk4rookies/observability-cloud/5-rum/4-user-sessions/index.html title="4. ユーザーセッション (🡐)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/splunk4rookies/observability-cloud/6-apm/1-apm-explore/index.html title="1. APM探索 (🡒)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=更に><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable splunk4rookies" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=splunk-apm>Splunk APM</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>20 minutes</span>
</span>&nbsp;<details open class="box cstyle notices orange"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-user"></i>
ペルソナ</summary><div class=box-content><p>あなたは<strong>バックエンド開発者</strong>で、SRE が発見した問題の調査を手伝うよう依頼されました。SRE はユーザーエクスペリエンスの低下を特定し、あなたにその問題を調査するよう依頼しました。</p></div></details><p>RUM トレース（フロントエンド）から APM トレース（バックエンド）にジャンプすることで、完全なエンドツーエンドの可視性の力を発見します。すべてのサービスはテレメトリ（トレースとスパン）を送信しており、Splunk Observability Cloud はこれを視覚化、分析し、異常やエラーを検出するために使用できます。</p><p>RUM と APM は同じコインの表と裏です。RUM はアプリケーションのクライアント側からの視点であり、APM はサーバー側からの視点です。このセクションでは、APM を使用して掘り下げ、問題がどこにあるかを特定します。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/04/30</span></span></footer></article><section><h1 class=a11y-only>6. Splunk APMのサブセクション</h1><article class=default><header class=headline></header><h1 id=1-apm探索>1. APM探索</h1><p>APM サービスマップは、APM で計装された（インストルメンテーション）サービスと推測されるサービスの間の依存関係と接続を表示します。このマップは、時間範囲、環境、ワークフロー、サービス、タグフィルターでの選択に基づいて動的に生成されます。</p><p>RUM ウォーターフォールで APM リンクをクリックすると、そのワークフロー名（<code>frontend:/cart/checkout</code>）に関連するサービスを表示するために、サービスマップビューに自動的にフィルターが追加されました。</p><p>ワークフローに関連するサービスは<strong>Service Map</strong>で確認できます。サイドペインの<strong>Business Workflow</strong>の下には、選択したワークフローのチャートが表示されています。<strong>Service Map</strong>とビジネスワークフローチャートは同期しています。<strong>Service Map</strong>でサービスを選択すると、<strong>Business Workflow</strong>ペインのチャートが更新され、選択したサービスのメトリクスが表示されます。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li>サービスマップで<strong>paymentservice</strong>をクリックします。</li></ul></div></details><p><a href=#R-image-e268b4f1aa47996f8a3b9394805dbc55 class=lightbox-link><img alt=APM探索 class="lazy lightbox figure-image" loading=lazy src=../images/apm-business-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-e268b4f1aa47996f8a3b9394805dbc55><img alt=APM探索 class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-business-workflow.png></a></p><p>Splunk APM はまた、リアルタイムで発生している問題を確認し、問題がサービス、特定のエンドポイント、または基盤となるインフラストラクチャに関連しているかどうかを迅速に判断するのに役立つ組み込みの <strong>Service Centric View(サービス中心ビュー)</strong> も提供しています。より詳しく見てみましょう。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li>右側のペインで、青色の<strong>paymentservice</strong>をクリックします。</li></ul></div></details><p><a href=#R-image-89a14f55ceddbc5295116712249915d7 class=lightbox-link><img alt=APMサービス class="lazy lightbox figure-image" loading=lazy src=../images/apm-service.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-89a14f55ceddbc5295116712249915d7><img alt=APMサービス class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-service.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article><article class=default><header class=headline></header><h1 id=2-apmサービスビュー>2. APMサービスビュー</h1><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
サービスビュー</summary><div class=box-content><p>サービスオーナーとして、Splunk APM のサービスビューを使用して、単一のパネルでサービスの健全性の完全なビューを取得できます。サービスビューには、可用性、依存関係、リクエスト、エラー、および期間（RED）メトリクス、ランタイムメトリクス、インフラストラクチャメトリクス、Tag Spotlight、エンドポイント、および選択したサービスのログのためのサービスレベルインジケーター（SLI）が含まれています。また、サービスビューからサービスのコードプロファイリングとメモリプロファイリングにすぐにアクセスすることもできます。</p></div></details><p><a href=#R-image-357707f327f666325ed899bc87e63982 class=lightbox-link><img alt=サービスダッシュボード class="lazy lightbox figure-image" loading=lazy src=../images/apm-service-dashboard.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-357707f327f666325ed899bc87e63982><img alt=サービスダッシュボード class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-service-dashboard.png></a></p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>時間</strong>ボックスを確認すると、ダッシュボードは以前に選択した APM トレースが完了するまでにかかった時間に関連するデータのみを表示していることがわかります（チャートは静的であることに注意してください）。</li><li><strong>時間</strong>ボックスで時間枠を <strong>-1h</strong> に変更します。</li><li>これらのチャートはパフォーマンスの問題を素早く特定するのに非常に役立ちます。このダッシュボードを使用して、サービスの健全性を監視できます。</li><li>ページを下にスクロールして<strong>Infrustructure Metrics</strong>を展開します。ここでホストと Pod のメトリクスが表示されます。</li><li><strong>Runtime Metrics</strong>は、Node.js で書かれたサービスにはプロファイリングデータが利用できないため、使用できません。</li><li>では、探索ビューに戻りましょう。ブラウザの戻るボタンを押してください。</li></ul></div></details><p><a href=#R-image-8dfffa6f7ca3dd4c83de57d08aff35ec class=lightbox-link><img alt=APM探索 class="lazy lightbox figure-image" loading=lazy src=../images/apm-business-workflow.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-8dfffa6f7ca3dd4c83de57d08aff35ec><img alt=APM探索 class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-business-workflow.png></a></p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-235bf8f3a1588aac48e78bfbd4dc742d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-00f329f124c173faafbd6bea644803ca aria-expanded=true data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-235bf8f3a1588aac48e78bfbd4dc742d","R-tab-1aa3f84abb25d49b8ed243c3170a5eae")'>
<span class=tab-nav-text>質問</span>
</button>
<button aria-controls=R-tab-id-fe45ad66598ae4b4776d98cd1a42636c aria-expanded=false data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-235bf8f3a1588aac48e78bfbd4dc742d","R-tab-c08a41c4be1582f12e5db69330df48ee")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div id=R-tab-id-00f329f124c173faafbd6bea644803ca data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p>サービスマップで<strong>paymentservice</strong>の上にカーソルを置いてください。ポップアップサービスチャートからどのような結論を導き出せますか？</p></div></div><div id=R-tab-id-fe45ad66598ae4b4776d98cd1a42636c data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>エラーの割合が非常に高い。</strong></p></div></div></div></div></div></details><p><a href=#R-image-5810d31f7aa02c9e18d96005abf150c0 class=lightbox-link><img alt=APMサービスチャート class="lazy lightbox figure-image" loading=lazy src=../images/apm-service-popup-chart.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-5810d31f7aa02c9e18d96005abf150c0><img alt=APMサービスチャート class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-service-popup-chart.png></a></p><p>このエラー率にパターンがあるかどうかを理解する必要があります。そのための便利なツール、<strong>Tag Spotlight</strong>があります。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article><article class=default><header class=headline></header><h1 id=3-apm-tag-spotlight>3. APM Tag Spotlight</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>paymentservice</strong>のタグを表示するには、<strong>paymentservice</strong>をクリックし、右側の機能ペインの<strong>Tag Spotlight</strong>をクリックします（画面の解像度によっては下にスクロールする必要があるかもしれません）。</li><li><strong>Tag Spotlight</strong>に入ったら、フィルターアイコンから<strong>Show tags with no values</strong>チェックボックスがオフになっていることを確認してください。</li></ul></div></details><p><a href=#R-image-626bc15977075b734ea995f8b609f887 class=lightbox-link><img alt="APM Tag Spotlight" class="lazy lightbox figure-image" loading=lazy src=../images/apm-tag-spotlight.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-626bc15977075b734ea995f8b609f887><img alt="APM Tag Spotlight" class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-tag-spotlight.png></a></p><p><strong>Tag Spotlight</strong>のビューは、チャートとカードの両方で設定可能です。デフォルトでは<strong>リクエストとエラー</strong>に設定されています。</p><p>また、カードに表示されるタグメトリクスを設定することも可能です。以下の任意の組み合わせを選択できます：</p><ul><li>Requests</li><li>Errors</li><li>Root Cause errors</li><li>P50 Latency</li><li>P90 Latency</li><li>P99 Latency</li></ul><p>改めて、フィルターアイコンから<strong>Show tags with no values</strong>チェックボックスがオフになっていることを確認してください。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><div class=tab-panel data-tab-group=R-tabs-8770576a2728cb7693f4d9e14b5fa585><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8f4c5d3d481ba977436fc2a669db6d7e aria-expanded=true data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-8770576a2728cb7693f4d9e14b5fa585","R-tab-1aa3f84abb25d49b8ed243c3170a5eae")'>
<span class=tab-nav-text>質問</span>
</button>
<button aria-controls=R-tab-id-9336cad05076519e9ea59ad20bf6f11a aria-expanded=false data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-8770576a2728cb7693f4d9e14b5fa585","R-tab-c08a41c4be1582f12e5db69330df48ee")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div id=R-tab-id-8f4c5d3d481ba977436fc2a669db6d7e data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>どのカードが問題を特定するタグを明らかにしていますか？</strong></p></div></div><div id=R-tab-id-9336cad05076519e9ea59ad20bf6f11a data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>「Version」カードです。<code>v350.10</code>に対するリクエスト数がエラー数と一致しています（つまり 100%）</strong></p></div></div></div></div></div></details><p><strong>paymentservice</strong>の問題を引き起こしているバージョンを特定したので、エラーについてさらに詳しい情報が見つかるか確認してみましょう。ページ上部の <strong>← Tag Spotlight</strong> をクリックして、サービスマップに戻ります。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article><article class=default><header class=headline></header><h1 id=4-apmサービスブレイクダウン>4. APMサービスブレイクダウン</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li>サービスマップで<strong>paymentservice</strong>を選択します。</li><li>右側のペインで<span class="btn cstyle button grey noicon"><span><span class=title>Breakdown</span></span></span>をクリックします。</li><li>リストから<code>tenant.level</code>を選択します。</li><li>サービスマップに戻り、<strong>gold</strong>をクリックします。</li><li><span class="btn cstyle button grey noicon"><span><span class=title>Breakdown</span></span></span>をクリックして<code>version</code>を選択します。これはサービスバージョンを表示するタグです。</li><li>これを<strong>silver</strong>と<strong>bronze</strong>についても繰り返します。</li></ul><div class=tab-panel data-tab-group=R-tabs-16391bdd9211b36edb814e676f259683><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-323404822ae0f9ada074acb193a67d85 aria-expanded=true data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-16391bdd9211b36edb814e676f259683","R-tab-1aa3f84abb25d49b8ed243c3170a5eae")'>
<span class=tab-nav-text>質問</span>
</button>
<button aria-controls=R-tab-id-838e69b99a8b56981f138af76aed0b45 aria-expanded=false data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-16391bdd9211b36edb814e676f259683","R-tab-c08a41c4be1582f12e5db69330df48ee")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div id=R-tab-id-323404822ae0f9ada074acb193a67d85 data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>表示されている内容からどのような結論が導き出せますか？</strong></p></div></div><div id=R-tab-id-838e69b99a8b56981f138af76aed0b45 data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong>すべての<code>tenant.level</code>が<code>v350.10</code>の影響を受けています</strong></p></div></div></div></div></div></details><p>これで<strong>paymentservice</strong>が<strong>gold</strong>、<strong>silver</strong>、<strong>bronze</strong>の 3 つのサービスに分解されているのが確認できます。各テナントは 2 つのサービスに分解されており、それぞれのバージョン（<code>v350.10</code>と<code>v350.9</code>）に対応しています。</p><p><a href=#R-image-4c761bc5bba5ac1d5b9113c208968c09 class=lightbox-link><img alt=APMサービスブレイクダウン class="lazy lightbox figure-image" loading=lazy src=../images/apm-service-breakdown.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4c761bc5bba5ac1d5b9113c208968c09><img alt=APMサービスブレイクダウン class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-service-breakdown.png></a></p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
スパンタグ</summary><div class=box-content><p>スパンタグを使用してサービスを分解することは非常に強力な機能です。これにより、異なる顧客、異なるバージョン、異なる地域などに対して、サービスがどのようにパフォーマンスを発揮しているかを確認できます。この演習では、<strong>paymentservice</strong>の<code>v350.10</code>がすべての顧客に問題を引き起こしていることを特定しました。</p></div></details><p>次に、何が起きているかを確認するためにトレースを詳しく調べる必要があります。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article><article class=default><header class=headline></header><h1 id=5-apmトレースアナライザー>5. APMトレースアナライザー</h1><p>Splunk APM はすべてのサービスの<strong>NoSample</strong>（サンプリングなし）エンドツーエンドの可視性を提供するため、Splunk APM はすべてのトレースをキャプチャします。このワークショップでは、<strong>Order Confirmation ID</strong>がタグとして利用可能です。これは、ワークショップの前半で遭遇した不良なユーザー体験の正確なトレースを検索するためにこれを使用できることを意味します。</p><details open class="box cstyle notices info"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-info-circle"></i>
トレースアナライザー</summary><div class=box-content><p>Splunk Observability Cloud は、アプリケーション監視データを探索するためのいくつかのツールを提供しています。<strong>Trace Analyzer</strong>は、未知または新しい問題を調査するための高カーディナリティ、高粒度の検索と探索が必要なシナリオに適しています。</p></div></details><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>paymentservice</strong>の外側のボックスを選択した状態で、右側のペインで<strong>Trace</strong>をクリックします。</li><li><strong>Trace Analyzer</strong>を使用していることを確認するため、<span class="btn cstyle button transparent noicon"><span><span class=title>ク Switch to Classic View</span></span></span>ボタンが表示されていることを確認します。表示されていない場合は、<span class="btn cstyle button blue noicon"><span><span class=title>Switch to Trace Analyzer</span></span></span>をクリックします。</li><li><strong>時間範囲</strong>を<strong>過去 15 分</strong>に設定します。</li><li><strong>Sample Ratio</strong>が<code>1:10</code>ではなく<code>1:1</code>に設定されていることを確認します。</li></ul></div></details><p><a href=#R-image-4d7a5cf492e485baf6ce1a38f5189168 class=lightbox-link><img alt=APMトレースアナライザー class="lazy lightbox figure-image" loading=lazy src=../images/apm-trace-analyzer.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4d7a5cf492e485baf6ce1a38f5189168><img alt=APMトレースアナライザー class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-trace-analyzer.png></a></p><p><strong>Trace & Error count</strong>ビューは、積み上げ棒グラフで合計トレース数とエラーのあるトレース数を表示します。マウスを使用して、利用可能な時間枠内の特定の期間を選択できます。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>Trace & Error count</strong>と表示されているドロップダウンメニューをクリックし、<strong>Trace Duration</strong>に変更します</li></ul></div></details><p><a href=#R-image-b53dc08ee9a1e7109f9fc27abfbd154f class=lightbox-link><img alt=APMトレースアナライザーヒートマップ class="lazy lightbox figure-image" loading=lazy src=../images/apm-trace-analyzer-heat-map.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-b53dc08ee9a1e7109f9fc27abfbd154f><img alt=APMトレースアナライザーヒートマップ class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-trace-analyzer-heat-map.png></a></p><p><strong>Trace Duration</strong>ビューは、期間ごとのトレースのヒートマップを表示します。ヒートマップは 3 次元のデータを表しています：</p><ul><li>x 軸の時間</li><li>y 軸のトレース期間</li><li>ヒートマップの色合いで表される 1 秒あたりのトレース（またはリクエスト）数</li></ul><p>マウスを使ってヒートマップ上の領域を選択し、特定の時間帯とトレース期間の範囲にフォーカスすることができます。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>Trace Duration</strong>から<strong>Trace & Error count</strong>に戻します。</li><li>時間選択で<strong>過去 1 時間</strong>を選択します。</li><li>ほとんどのトレースにエラー（赤）があり、エラーのないトレース（青）は限られていることに注意してください。</li><li><strong>Sample Ratio</strong>が<code>1:10</code>ではなく<code>1:1</code>に設定されていることを確認します。</li><li><strong>Add filters</strong>をクリックし、<code>orderId</code>と入力してリストから<strong>orderId</strong>を選択します。</li><li>ワークショップの前半でショッピングを行った際の<strong>Order Confirmation ID</strong>を貼り付けて Enter キーを押します。もし ID を記録していない場合は、インストラクターに確認してください。
<a href=#R-image-252788945215abc970c1146c8f20ec6f class=lightbox-link><img alt=期間別トレース class="lazy lightbox figure-image" loading=lazy src=../images/apm-trace-by-duration.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-252788945215abc970c1146c8f20ec6f><img alt=期間別トレース class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-trace-by-duration.png></a></li></ul></div></details><p>これで、非常に長いチェックアウト待ちという不良なユーザーエクスペリエンスに遭遇した正確なトレースまでフィルタリングできました。</p><p>このトレースを表示することの二次的な利点は、トレースが最大 13 か月間アクセス可能であることです。これにより、開発者は後の段階でこの問題に戻り、このトレースを引き続き表示することができます。</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li>リスト内のトレースをクリックします。</li></ul></div></details><p>次に、トレースウォーターフォールを確認していきます。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article><article class=default><header class=headline></header><h1 id=6-apmウォーターフォール>6. APMウォーターフォール</h1><p><strong>トレースアナライザー</strong>から<strong>トレースウォーターフォール</strong>に到達しました。トレースは同じトレース ID を共有するスパンの集まりで、アプリケーションとその構成サービスによって処理される一意のトランザクションを表します。</p><p>Splunk APM の各スパンは、単一の操作をキャプチャします。Splunk APM は、スパンがキャプチャする操作がエラーになった場合、そのスパンをエラースパンとみなします。</p><p><a href=#R-image-53f4bc05a4edbd06964c3dacfacbdbf0 class=lightbox-link><img alt=トレースウォーターフォール class="lazy lightbox figure-image" loading=lazy src=../images/apm-trace-waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-53f4bc05a4edbd06964c3dacfacbdbf0><img alt=トレースウォーターフォール class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-trace-waterfall.png></a></p><p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li>ウォーターフォール内の任意の<code>paymentservice:grpc.hipstershop.PaymentService/Charge</code>スパンの横にある<span class="btn cstyle button red noicon"><span><span class=title>!</span></span></span>をクリックします。</li></ul><div class=tab-panel data-tab-group=R-tabs-a4980b3dc017df24e0f66ca2a72ea01e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-39904e6a89e1f345dbbeedf2609cc559 aria-expanded=true data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a4980b3dc017df24e0f66ca2a72ea01e","R-tab-1aa3f84abb25d49b8ed243c3170a5eae")'>
<span class=tab-nav-text>質問</span>
</button>
<button aria-controls=R-tab-id-b020271204c4fcf123028dd26e95e137 aria-expanded=false data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-a4980b3dc017df24e0f66ca2a72ea01e","R-tab-c08a41c4be1582f12e5db69330df48ee")'>
<span class=tab-nav-text>回答</span></button></div><div class=tab-content-container><div id=R-tab-id-39904e6a89e1f345dbbeedf2609cc559 data-tab-item=R-tab-1aa3f84abb25d49b8ed243c3170a5eae class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><p><strong>スパン詳細で報告されているエラーメッセージとバージョンは何ですか？</strong></p></div></div><div id=R-tab-id-b020271204c4fcf123028dd26e95e137 data-tab-item=R-tab-c08a41c4be1582f12e5db69330df48ee class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><strong><code>Invalid request</code>（無効なリクエスト）と<code>v350.10</code>です</strong>。</p></div></div></div></div></div></details>問題を引き起こしている<strong>paymentservice</strong>のバージョンを特定したので、エラーについてさらに詳しい情報が見つかるか確認してみましょう。ここで<strong>関連ログ</strong>の出番です。</p><p>関連コンテンツ(Related Contents)は、APM、インフラストラクチャモニタリング、および Log Observer が可観測性クラウド全体でフィルターを渡すことを可能にする特定のメタデータに依存しています。関連ログが機能するためには、ログに以下のメタデータが必要です：</p><ul><li><code>service.name</code></li><li><code>deployment.environment</code></li><li><code>host.name</code></li><li><code>trace_id</code></li><li><code>span_id</code></li></ul><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
演習</summary><div class=box-content><ul><li><strong>トレースウォーターフォール</strong>の一番下で<strong>Logs (1)<strong>をクリックします。これは、このトレースに</strong>関連ログ</strong>があることを示しています。</li><li>ポップアップの<strong>Logs for trace xxx</strong>（トレース xxx のログ）エントリをクリックすると、<strong>Log Observer</strong>で完全なトレースのログが開きます。</li></ul></div></details><p><a href=#R-image-616bb51c2f93e16251546cae1e71cac0 class=lightbox-link><img alt=関連ログ class="lazy lightbox figure-image" loading=lazy src=../images/apm-related-logs.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-616bb51c2f93e16251546cae1e71cac0><img alt=関連ログ class="lazy lightbox lightbox-image" loading=lazy src=../images/apm-related-logs.png></a></p><p>次に、ログのエラーについてさらに詳しく調べてみましょう。</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2025/05/02</span></span></footer></article></section></div></main></div><script src=/observability-workshop/js/perfect-scrollbar/perfect-scrollbar.min.js?1770054185 defer></script><script src=/observability-workshop/js/theme.min.js?1770054185 defer></script><div id=toast-container role=status aria-live=polite aria-atomic=false></div></body></html>
<!doctype html><html id=R-html lang=ja dir=ltr itemscope itemtype=http://schema.org/Article data-r-output-format=print><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.145.0"><meta name=generator content="Relearn 9.0.3+9bc97fdf9eaf3af61af9bcc11db2e010de83af95"><meta name=description content="OpenTelemetry Collector ã®è¨­å®šã‚’ã‚¼ãƒ­ã‹ã‚‰è¡Œã†ç·´ç¿’ã‚’è¡Œã„ã€ã„ãã¤ã‹ã®é«˜åº¦ãªè¨­å®šã‚·ãƒŠãƒªã‚ªã‚’ä½“é¨“ã—ã¾ã™ã€‚"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Advanced OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="OpenTelemetry Collector ã®è¨­å®šã‚’ã‚¼ãƒ­ã‹ã‚‰è¡Œã†ç·´ç¿’ã‚’è¡Œã„ã€ã„ãã¤ã‹ã®é«˜åº¦ãªè¨­å®šã‚·ãƒŠãƒªã‚ªã‚’ä½“é¨“ã—ã¾ã™ã€‚"><meta property="og:url" content="https://splunk.github.io/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Advanced OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta property="og:description" content="OpenTelemetry Collector ã®è¨­å®šã‚’ã‚¼ãƒ­ã‹ã‚‰è¡Œã†ç·´ç¿’ã‚’è¡Œã„ã€ã„ãã¤ã‹ã®é«˜åº¦ãªè¨­å®šã‚·ãƒŠãƒªã‚ªã‚’ä½“é¨“ã—ã¾ã™ã€‚"><meta property="og:locale" content="ja"><meta property="og:type" content="website"><meta itemprop=name content="Advanced OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><meta itemprop=description content="OpenTelemetry Collector ã®è¨­å®šã‚’ã‚¼ãƒ­ã‹ã‚‰è¡Œã†ç·´ç¿’ã‚’è¡Œã„ã€ã„ãã¤ã‹ã®é«˜åº¦ãªè¨­å®šã‚·ãƒŠãƒªã‚ªã‚’ä½“é¨“ã—ã¾ã™ã€‚"><meta itemprop=dateModified content="2026-01-28T19:28:21+00:00"><meta itemprop=wordCount content="47"><title>Advanced OpenTelemetry Collector :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html rel=alternate hreflang=x-default><link href=https://splunk.github.io/observability-workshop/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html rel=alternate hreflang=en><link href=https://splunk.github.io/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html rel=alternate hreflang=ja><link href=https://splunk.github.io/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html rel=canonical type=text/html title="Advanced OpenTelemetry Collector :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/images/favicon.ico?1769793366 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/css/auto-complete/auto-complete.min.css?1769793366 rel=stylesheet><script src=/observability-workshop/js/auto-complete/auto-complete.min.js?1769793366 defer></script><script src=/observability-workshop/js/search-lunr.min.js?1769793366 defer></script><script src=/observability-workshop/js/search.min.js?1769793366 defer></script><script>window.relearn=window.relearn||{},window.relearn.index_js_url="/observability-workshop/searchindex.ja.js?1769793366"</script><script src=/observability-workshop/js/lunr/lunr.min.js?1769793366 defer></script><script src=/observability-workshop/js/lunr/lunr.stemmer.support.min.js?1769793366 defer></script><script src=/observability-workshop/js/lunr/lunr.multi.min.js?1769793366 defer></script><script src=/observability-workshop/js/lunr/tinyseg.js?1769793366 defer></script><script src=/observability-workshop/js/lunr/lunr.ja.min.js?1769793366 defer></script><script>window.relearn=window.relearn||{},window.relearn.contentLangs=["ja"]</script><link href=/observability-workshop/fonts/fontawesome/css/all.min.css?1769793366 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/fonts/fontawesome/css/all.min.css?1769793366 rel=stylesheet></noscript><link href=/observability-workshop/css/perfect-scrollbar/perfect-scrollbar.min.css?1769793366 rel=stylesheet><link href=/observability-workshop/css/theme.min.css?1769793366 rel=stylesheet><link href=/observability-workshop/css/format-print.min.css?1769793366 rel=stylesheet id=R-format-style><script>window.relearn=window.relearn||{},window.relearn.min=`.min`,window.relearn.path="/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html",window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop",window.relearn.disableInlineCopyToClipboard=!0,window.relearn.enableBlockCodeWrap=!0,window.T_Copy_to_clipboard=`ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼`,window.T_Copied_to_clipboard=`ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!`,window.T_Link_copied_to_clipboard=`ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ!`,window.T_Reset_view=`ãƒ“ãƒ¥ãƒ¼ã®ãƒªã‚»ãƒƒãƒˆ`,window.T_View_reset=`ãƒªã‚»ãƒƒãƒˆã‚’è¦‹ã‚‹`,window.T_No_results_found=`"{0}" ã®çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`,window.T_N_results_found=`"{0}" ã§ {1} ä»¶ã®çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ`,window.T_Browser_unsupported_feature=`ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯ã“ã®æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“`,window.relearn.themevariants=["auto","splunk-light","splunk-dark"],window.relearn.customvariantprefix="my-custom-",window.relearn.changeVariant=function(e){var t=document.documentElement.dataset.rThemeVariant;window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e),document.documentElement.dataset.rThemeVariant=e,t!=e&&(document.dispatchEvent(new CustomEvent("themeVariantLoaded",{detail:{variant:e,oldVariant:t}})),window.relearn.markVariant())},window.relearn.markVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant");document.querySelectorAll(".R-variantswitcher select").forEach(t=>{t.value=e})},window.relearn.initVariant=function(){var e=window.localStorage.getItem(window.relearn.absBaseUri+"/variant")??"";(!e||!e.startsWith(window.relearn.customvariantprefix)&&!window.relearn.themevariants.includes(e)||e.startsWith(window.relearn.customvariantprefix)&&!window.localStorage.getItem(window.relearn.absBaseUri+"/variantstylesheet-"+e))&&(e=window.relearn.themevariants[0],window.localStorage.setItem(window.relearn.absBaseUri+"/variant",e)),document.documentElement.dataset.rThemeVariant=e},window.relearn.initVariant(),window.relearn.markVariant()</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({appplicationName:"observability-workshop",realm:"us1",rumAccessToken:"h7q1NLX6lJz0h_5-OqQJkg",recorder:"splunk",features:{video:!0}})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}p{margin:.75rem 0}.highlight{max-height:500px;overflow-y:auto}pre:not(.mermaid){margin:0}</style></head><body class="mobile-support print" data-origin=/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar class=default-animation><div class="topbar-wrapper default-animation"><div class="topbar-sidebar-divider default-animation"></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar default-animation" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleNav() type=button title="ãƒ¡ãƒ‹ãƒ¥ãƒ¼ (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></span></div><div class="topbar-button topbar-button-toc default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title="ç›®æ¬¡ (CTRL+ALT+t)"><i class="fa-fw fas fa-table-list"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><nav class=TableOfContents><ul><li><a href=#ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®æ¦‚è¦>ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®æ¦‚è¦</a></li></ul></nav></div></div></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/ninja-workshops/index.html><span itemprop=name>Splunk4Ninjas Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/index.html><span itemprop=name>OpenTelemetry Collector ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Advanced OpenTelemetry Collector</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-print default-animation" data-content-empty=disable data-width-s=area-more data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/index.print.html title="ç« å…¨ä½“ã‚’å°åˆ·ã™ã‚‹ (CTRL+ALT+p)"><i class="fa-fw fas fa-print"></i></a></span></div><div class="topbar-button topbar-button-prev default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/1-opentelemetry-collector/8-develop/5-business-logic/index.html title="OpenTelemetry Collector é–‹ç™º (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></span></div><div class="topbar-button topbar-button-next default-animation" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><a href=/observability-workshop/ja/ninja-workshops/3-opentelemetry-collector-workshops/2-advanced-collector/prerequisites/index.html title="å‰ææ¡ä»¶ (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></span></div><div class="topbar-button topbar-button-more default-animation" data-content-empty=hide data-width-s=show data-width-m=show data-width-l=show><span class="btn cstyle button link noborder notitle interactive"><button onclick=toggleTopbarFlyout(this) type=button title=æ›´ã«><i class="fa-fw fas fa-ellipsis-v"></i></button></span><div class=topbar-content><div class=topbar-content-wrapper><div class="topbar-area topbar-area-more" data-area=more></div></div></div></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable ninja-workshops" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=advanced-opentelemetry-collector>Advanced OpenTelemetry Collector</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>75 minutes</span>
</span>&nbsp;
<span class="badge cstyle blue badge-with-title"><span class=badge-title class=text-muted>Authors
</span><span class=badge-content>Robert Castley, Charity Anderson, Pieter Hagen, & Geoff Higginbottom</span></span><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®ç›®çš„ã¯ã€OpenTelemetry Collector ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆãƒ»å¤‰æ›´ã™ã‚‹éš›ã®è‡ªä¿¡ã‚’æ·±ã‚ã‚‹ã“ã¨ã§ã™ã€‚æœ€å°é™ã® <code>agent.yaml</code> ã¨ <code>gateway.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å§‹ã‚ã€ã„ãã¤ã‹ã®é«˜åº¦ãªå®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªã«å¯¾å¿œã§ãã‚‹ã‚ˆã†æ®µéšçš„ã«æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚</p><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã¯ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ™ãƒ³ãƒ€ãƒ¼ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«é€ä¿¡ã™ã‚‹ã®ã§ã¯ãªãã€ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã™ã‚‹ã‚ˆã† OpenTelemetry Collector ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã‚’å­¦ã¶ã“ã¨ã§ã™ã€‚ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¯ãƒ‡ãƒãƒƒã‚°ã‚„ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ç°¡ç´ åŒ–ã™ã‚‹ã ã‘ã§ãªãã€æœ¬ç•ªã‚·ã‚¹ãƒ†ãƒ ã¸ã®ãƒ‡ãƒ¼ã‚¿é€ä¿¡ã‚’é¿ã‘ãŸã„ãƒ†ã‚¹ãƒˆã‚„é–‹ç™ºç’°å¢ƒã«ã‚‚æœ€é©ã§ã™ã€‚</p><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã‚’æœ€å¤§é™ã«æ´»ç”¨ã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®çŸ¥è­˜ãŒå¿…è¦ã§ã™</p><ul><li>OpenTelemetry Collector ã¨ãã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã®åŸºæœ¬çš„ãªç†è§£</li><li>YAML ãƒ•ã‚¡ã‚¤ãƒ«ã®ç·¨é›†ã‚¹ã‚­ãƒ«</li></ul><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®ã™ã¹ã¦ã®å†…å®¹ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€å®Ÿè·µçš„ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚„ã™ã„å­¦ç¿’ä½“é¨“ã‚’æä¾›ã—ã¾ã™ã€‚ãã‚Œã§ã¯ã€æ§‹ç¯‰ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼</p><h2 id=ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®æ¦‚è¦>ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®æ¦‚è¦<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ã¯ã€ä»¥ä¸‹ã®ãƒˆãƒ”ãƒƒã‚¯ã‚’å–ã‚Šä¸Šã’ã¾ã™</p><ul><li><strong>Agent ã¨ Gateway ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</strong>: ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ãŒ Agent çµŒç”±ã§ Gateway ã«é€ã‚‰ã‚Œã‚‹ã“ã¨ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚</li><li><strong>Agent ã®è€éšœå®³æ€§ã‚’å¼·åŒ–</strong>: ãƒ•ã‚©ãƒ¼ãƒ«ãƒˆãƒˆãƒ¬ãƒ©ãƒ³ã‚¹ã®ãŸã‚ã®åŸºæœ¬è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚</li><li><strong>Processor ã®è¨­å®š</strong>:<ul><li>ç‰¹å®šã®ã‚¹ãƒ‘ãƒ³ï¼ˆä¾‹ï¼šãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼‰ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¦ãƒã‚¤ã‚ºã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚</li><li>ä¸è¦ãªã‚¿ã‚°ã‚’å‰Šé™¤ã—ã€æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¾ã™ã€‚</li><li>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‰ã«ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ OTTLï¼ˆOpenTelemetry Transformation Languageï¼‰ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›ã—ã¾ã™ã€‚</li></ul></li><li><strong>Connector ã®è¨­å®š</strong>:<ul><li>å—ä¿¡ã—ãŸå€¤ã«åŸºã¥ã„ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’ç•°ãªã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã¾ã™ã€‚</li></ul></li></ul><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã‚’çµ‚äº†ã™ã‚‹ã¨ã€ã•ã¾ã–ã¾ãªå®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«å¯¾å¿œã™ã‚‹ OpenTelemetry Collector ã®è¨­å®šã«ç²¾é€šã—ã¦ã„ã‚‹ã§ã—ã‚‡ã†ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/28</span></span></footer></article><section><h1 class=a11y-only>Advanced OpenTelemetry Collectorã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=å‰ææ¡ä»¶>å‰ææ¡ä»¶</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<h3 id=å‰ææ¡ä»¶>å‰ææ¡ä»¶<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><ul><li><code>vi</code>ã€<code>vim</code>ã€<code>nano</code>ã€ã¾ãŸã¯ãŠå¥½ã¿ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚’ä½¿ç”¨ã—ã¦ YAML ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã™ã‚‹ã‚¹ã‚­ãƒ«</li><li>ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ç’°å¢ƒ<ul><li>æä¾›ã•ã‚Œã‚‹ Splunk Workshop ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆæ¨å¥¨ï¼‰ã€‚<code>ssh</code> ã‚¢ã‚¯ã‚»ã‚¹ç”¨ã«ãƒãƒ¼ãƒˆ <code>2222</code> ã¸ã®å¤–éƒ¨ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚</li><li>Apple Macï¼ˆApple Siliconï¼‰ã€‚<code>jq</code> ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™ - <a href=https://jqlang.org/download/ rel=external><strong>https://jqlang.org/download/</strong></a></li></ul></li></ul><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ä½œæˆ</strong>: ç’°å¢ƒå†…ã§æ–°ã—ã„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã€ãã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir advanced-otel-workshop <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=nb>cd</span> advanced-otel-workshop</span></span></code></pre></div><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã®æ®‹ã‚Šã®éƒ¨åˆ†ã§ã¯ã€ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ <code>[WORKSHOP]</code> ã¨å‘¼ã³ã¾ã™ã€‚</p><details open class="box cstyle notices warning"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-triangle"></i>
æ—¢å­˜ã® OpenTelemetry Collector ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„</summary><div class=box-content><p>Splunk IM ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã‚’å®Œäº†ã—ã¦ã„ã‚‹å ´åˆã¯ã€ç¶šè¡Œã™ã‚‹å‰ã« Kubernetes ã§å®Ÿè¡Œä¸­ã® Collector ã‚’å‰Šé™¤ã—ã¦ãã ã•ã„ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦å‰Šé™¤ã§ãã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>helm delete splunk-otel-collector</span></span></code></pre></div><p>ãã®å ´åˆã€EC2 ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã¨å¹²æ¸‰ã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãŒå®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã‚Œã‚‰ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯åœæ­¢ã—ã¦ãã ã•ã„</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete ~/workshop/apm/deployment.yaml</span></span></code></pre></div></div></details><p><strong>ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ãƒã‚¤ãƒŠãƒªã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</strong>: <code>[WORKSHOP]</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€OpenTelemetry Collectorã€Load Generator ãƒã‚¤ãƒŠãƒªã€ãŠã‚ˆã³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-4b94328fe6ef224d2c637ddec7f252fc><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ecd061b15440b8675f4bcc1c01f7b3ac aria-expanded=true data-tab-item=R-tab-82857c7966640c0cfd614ba8cc6f34f0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4b94328fe6ef224d2c637ddec7f252fc","R-tab-82857c7966640c0cfd614ba8cc6f34f0")'>
<span class=tab-nav-text>Splunk Workshop Instance</span>
</button>
<button aria-controls=R-tab-id-57aa928a1c4f840027b1849f752ef69d aria-expanded=false data-tab-item=R-tab-720c44a46151d66d4db2d011603e7e1f class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4b94328fe6ef224d2c637ddec7f252fc","R-tab-720c44a46151d66d4db2d011603e7e1f")'>
<span class=tab-nav-text>Apple Silicon</span></button></div><div class=tab-content-container><div id=R-tab-id-ecd061b15440b8675f4bcc1c01f7b3ac data-tab-item=R-tab-82857c7966640c0cfd614ba8cc6f34f0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -L https://github.com/signalfx/splunk-otel-collector/releases/download/v0.136.0/otelcol_linux_amd64 -o otelcol <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/loadgen/build/loadgen-linux-amd64 -o loadgen <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/setup-workshop.sh -o setup-workshop.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>chmod +x setup-workshop.sh</span></span></code></pre></div></div></div><div id=R-tab-id-57aa928a1c4f840027b1849f752ef69d data-tab-item=R-tab-720c44a46151d66d4db2d011603e7e1f class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -L https://github.com/signalfx/splunk-otel-collector/releases/download/v0.136.0/otelcol_darwin_arm64 -o otelcol <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/loadgen/build/loadgen-darwin-arm64 -o loadgen <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>curl -L https://github.com/splunk/observability-workshop/raw/refs/heads/main/workshop/ninja/advanced-otel/setup-workshop.sh -o setup-workshop.sh <span class=o>&amp;&amp;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>chmod +x setup-workshop.sh</span></span></code></pre></div></div></div></div></div><p><code>setup-workshop.sh</code> ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯æ­£ã—ã„æ¨©é™ã‚’è¨­å®šã—ã€<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®åˆæœŸè¨­å®šã‚‚ä½œæˆã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-40d014fd4c5ae6333c533287a84096ea><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-445d2211747f17f11e495ad55c2e8a5c aria-expanded=true data-tab-item=R-tab-ed1ba283b4cfb63aa90843a7e81a1de7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-40d014fd4c5ae6333c533287a84096ea","R-tab-ed1ba283b4cfb63aa90843a7e81a1de7")'>
<span class=tab-nav-text>Setup Workshop</span>
</button>
<button aria-controls=R-tab-id-5eeeb1e8e530b0343714361e8fe1f1cf aria-expanded=false data-tab-item=R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-40d014fd4c5ae6333c533287a84096ea","R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24")'>
<span class=tab-nav-text>Verify Setup</span></button></div><div class=tab-content-container><div id=R-tab-id-445d2211747f17f11e495ad55c2e8a5c data-tab-item=R-tab-ed1ba283b4cfb63aa90843a7e81a1de7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./setup-workshop.sh</span></span></code></pre></div></div></div><div id=R-tab-id-5eeeb1e8e530b0343714361e8fe1f1cf data-tab-item=R-tab-f3e2501fbfa01a9bf4df67b1c72e5d24 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â–ˆâ–ˆâ•”â•    â•šâ–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•      â•šâ–ˆâ–ˆâ•—
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•—      â–ˆâ–ˆâ•”â•
</span></span><span class=line><span class=cl>â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•”â•
</span></span><span class=line><span class=cl>â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•â•šâ•â•  â•šâ•â•    â•šâ•â•
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Welcome to the Splunk Advanced OpenTelemetry Workshop!
</span></span><span class=line><span class=cl>======================================================
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>macOS detected. Removing quarantine attributes...
</span></span><span class=line><span class=cl>otelcol version v0.126.0
</span></span><span class=line><span class=cl>Usage: loadgen [OPTIONS]
</span></span><span class=line><span class=cl>Options:
</span></span><span class=line><span class=cl>  -base       Send base traces (enabled by default)
</span></span><span class=line><span class=cl>  -health     Send health traces
</span></span><span class=line><span class=cl>  -security   Send security traces
</span></span><span class=line><span class=cl>  -logs       Enable logging of random quotes to quotes.log
</span></span><span class=line><span class=cl>  -json       Output logs in JSON format (only applicable with -logs)
</span></span><span class=line><span class=cl>  -count      Number of traces or logs to send (default: infinite)
</span></span><span class=line><span class=cl>  -h, --help  Display this help message
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Example:
</span></span><span class=line><span class=cl>  loadgen -health -security -count 10   Send 10 health and security traces
</span></span><span class=line><span class=cl>  loadgen -logs -json -count 5          Write 5 random quotes in JSON format to quotes.log
</span></span><span class=line><span class=cl>Creating workshop directories...
</span></span><span class=line><span class=cl>âœ“ Created subdirectories:
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 1-agent-gateway
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 2-building-resilience
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 3-dropping-spans
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 4-sensitive-data
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 5-transform-data
</span></span><span class=line><span class=cl>  â”œâ”€â”€ 6-routing-data
</span></span><span class=line><span class=cl>  â””â”€â”€ 7-sum-count
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating configuration files for 1-agent-gateway...
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector agent configuration file: 1-agent-gateway/agent.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 1-agent-gateway/agent.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     4355 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector gateway configuration file: 1-agent-gateway/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 1-agent-gateway/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     3376 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>âœ“ Completed configuration files for 1-agent-gateway
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating configuration files for 2-building-resilience...
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector agent configuration file: 2-building-resilience/agent.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 2-building-resilience/agent.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     4355 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Creating OpenTelemetry Collector gateway configuration file: 2-building-resilience/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ Configuration file created successfully: 2-building-resilience/gateway.yaml
</span></span><span class=line><span class=cl>âœ“ File size:     3376 bytes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>âœ“ Completed configuration files for 2-building-resilience
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Workshop environment setup complete!
</span></span><span class=line><span class=cl>Configuration files created in the following directories:
</span></span><span class=line><span class=cl>  1-agent-gateway/
</span></span><span class=line><span class=cl>    â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>    â””â”€â”€ gateway.yaml
</span></span><span class=line><span class=cl>  2-building-resilience/
</span></span><span class=line><span class=cl>    â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>    â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><div class=tab-panel data-tab-group=R-tabs-6b9afb74ea71b2eb4a9016d4d2332c7d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a2c8e981a62b52a164dcb14c2730d105 aria-expanded=true data-tab-item=R-tab-b40a1b49bd294b76ac2b8778c756092f class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6b9afb74ea71b2eb4a9016d4d2332c7d","R-tab-b40a1b49bd294b76ac2b8778c756092f")'>
<span class=tab-nav-text>Initial Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-a2c8e981a62b52a164dcb14c2730d105 data-tab-item=R-tab-b40a1b49bd294b76ac2b8778c756092f class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>[WORKSHOP]
</span></span><span class=line><span class=cl>â”œâ”€â”€ 1-agent-gateway
</span></span><span class=line><span class=cl>â”œâ”€â”€ 2-building-resilience
</span></span><span class=line><span class=cl>â”œâ”€â”€ 3-dropping-spans
</span></span><span class=line><span class=cl>â”œâ”€â”€ 4-sensitive-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 5-transform-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 6-routing-data
</span></span><span class=line><span class=cl>â”œâ”€â”€ 7-sum-count
</span></span><span class=line><span class=cl>â”œâ”€â”€ loadgen
</span></span><span class=line><span class=cl>â”œâ”€â”€ otelcol
</span></span><span class=line><span class=cl>â””â”€â”€ setup-workshop.sh</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=1-agent-è¨­å®šã®ç¢ºèª>1. Agent è¨­å®šã®ç¢ºèª</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>15 minutes</span>
</span>&nbsp;<p>ã‚ˆã†ã“ãï¼ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã‚’å«ã‚€å®Œå…¨ã«æ©Ÿèƒ½ã™ã‚‹ OpenTelemetry ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‹ã‚‰å§‹ã‚ã¾ã™ã€‚</p><p>ã¾ãšã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç°¡å˜ã«ç¢ºèªã—ã¦ã€å…¨ä½“çš„ãªæ§‹é€ ã«æ…£ã‚Œã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’åˆ¶å¾¡ã™ã‚‹é‡è¦ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¾ã™ã€‚</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã‚’é€šã˜ã¦ã€è¤‡æ•°ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚æ•´ç†ã—ã‚„ã™ãã™ã‚‹ãŸã‚ã«ã€å„ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«å›ºæœ‰ã®åå‰ã¾ãŸã¯è‰²ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æ¼”ç¿’ä¸­ã«ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç°¡å˜ã«è­˜åˆ¥ã—ã¦åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ <strong>Agent</strong>ã€<strong>Gateway</strong>ã€<strong>Loadgen</strong>ã€<strong>Test</strong> ã¨å‘¼ã³ã¾ã™ã€‚</p></div></details><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ol><li><p>æœ€åˆã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ä½œæˆã—ã€<strong>Agent</strong> ã¨åå‰ã‚’ä»˜ã‘ã¾ã™ã€‚æœ€åˆã®æ¼”ç¿’ç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª <code>[WORKSHOP]/1-agent-gateway</code> ã«ç§»å‹•ã—ã€å¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> 1-agent-gateway
</span></span><span class=line><span class=cl>ls -l</span></span></code></pre></div></li><li><p>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚è¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯ã€<strong>å‰ææ¡ä»¶</strong> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§èª¬æ˜ã•ã‚Œã¦ã„ã‚‹ <code>setup-workshop.sh</code> ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å†å®Ÿè¡Œã—ã¦ãã ã•ã„</p><div class=tab-panel data-tab-group=R-tabs-fa6c2a5a9eb036e54d9698cd5db5d864><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e9aa716aed9405047aa5ac92b3cb1ab3 aria-expanded=true data-tab-item=R-tab-3ea4b283eb322e1c6373d63f91d032be class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fa6c2a5a9eb036e54d9698cd5db5d864","R-tab-3ea4b283eb322e1c6373d63f91d032be")'>
<span class=tab-nav-text>Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-e9aa716aed9405047aa5ac92b3cb1ab3 data-tab-item=R-tab-3ea4b283eb322e1c6373d63f91d032be class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></li></ol></div></details><h3 id=agent-è¨­å®šã®ç†è§£>Agent è¨­å®šã®ç†è§£<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ä½¿ç”¨ã™ã‚‹ <code>agent.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«é‡è¦ãªè¿½åŠ ãŒè¡Œã‚ã‚Œã¦ã„ã¾ã™ã€‚</p><h4 id=receiver>Receiver<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4><p><code>receivers</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€<strong>Agent</strong> ãŒãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€æ–¹æ³•ã‚’å®šç¾©ã—ã¾ã™ã€‚ã“ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ã¯ã€3ç¨®é¡ã® Receiver ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™</p><ul><li><p><strong>Host Metrics Receiver</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>hostmetrics</span><span class=p>:</span><span class=w>                         </span><span class=c># Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>collection_interval</span><span class=p>:</span><span class=w> </span><span class=l>3600s        </span><span class=w> </span><span class=c># Collection Interval (1hr)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>scrapers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>cpu</span><span class=p>:</span><span class=w>                             </span><span class=c># CPU Scraper</span></span></span></code></pre></div><p>ãƒ­ãƒ¼ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰1æ™‚é–“ã”ã¨ã« CPU ä½¿ç”¨ç‡ã‚’åé›†ã—ã¾ã™ã€‚ã“ã‚Œã‚’ä½¿ç”¨ã—ã¦ã‚µãƒ³ãƒ—ãƒ«ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p></li><li><p><strong>OTLP Receiverï¼ˆHTTP ãƒ—ãƒ­ãƒˆã‚³ãƒ«ï¼‰</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>otlp</span><span class=p>:</span><span class=w>                                </span><span class=c># OTLP Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>http</span><span class=p>:</span><span class=w>                            </span><span class=c># Configure HTTP protocol</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0:4318&#34;</span><span class=w>       </span><span class=c># Endpoint to bind to</span></span></span></code></pre></div><p>Agent ãŒãƒãƒ¼ãƒˆ <code>4318</code> ã§ HTTP çµŒç”±ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ã‚’å—ä¿¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ä»Šå¾Œã®æ¼”ç¿’ã§ Collector ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p></li><li><p><strong>FileLog Receiver</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>filelog/quotes</span><span class=p>:</span><span class=w>                      </span><span class=c># Receiver Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include</span><span class=p>:</span><span class=w> </span><span class=l>./quotes.log             </span><span class=w> </span><span class=c># The file to read log data from</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include_file_path</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>            </span><span class=c># Include file path in the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>include_file_name</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>           </span><span class=c># Exclude file name from the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resource</span><span class=p>:</span><span class=w>                          </span><span class=c># Add custom resource attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>com.splunk.source</span><span class=p>:</span><span class=w> </span><span class=l>./quotes.log </span><span class=w> </span><span class=c># Source of the log data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>com.splunk.sourcetype</span><span class=p>:</span><span class=w> </span><span class=l>quotes   </span><span class=w> </span><span class=c># Source type of the log data</span></span></span></code></pre></div><p>Agent ãŒãƒ­ãƒ¼ã‚«ãƒ«ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ<code>quotes.log</code>ï¼‰ã‚’ tail ã—ã€<code>source</code> ã‚„ <code>sourceType</code> ãªã©ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã§å¼·åŒ–ã•ã‚ŒãŸæ§‹é€ åŒ–ãƒ­ã‚°ã‚¤ãƒ™ãƒ³ãƒˆã«å¤‰æ›ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p></li></ul><h4 id=exporter>Exporter<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h4><ul><li><p><strong>Debug Exporter</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>                               </span><span class=c># Exporter Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed               </span><span class=w> </span><span class=c># Enabled detailed debug output</span></span></span></code></pre></div></li><li><p><strong>OTLPHTTP Exporter</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>otlphttp</span><span class=p>:</span><span class=w>                            </span><span class=c># Exporter Type</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://localhost:5318&#34;</span><span class=w>  </span><span class=c># Gateway OTLP endpoint</span></span></span></code></pre></div><p><code>debug</code> Exporter ã¯ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ä¸­ã®å¯è¦–æ€§ã¨ãƒ‡ãƒãƒƒã‚°ã®ãŸã‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«é€ä¿¡ã—ã€<code>otlphttp</code> Exporter ã¯ã™ã¹ã¦ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã® <strong>Gateway</strong> ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«è»¢é€ã—ã¾ã™ã€‚</p><p><strong>ã“ã®ãƒ‡ãƒ¥ã‚¢ãƒ«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæˆ¦ç•¥ã«ã‚ˆã‚Šã€ç”Ÿãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ç¢ºèªã—ãªãŒã‚‰ã€ã•ã‚‰ãªã‚‹å‡¦ç†ã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®ãŸã‚ã«ãƒ€ã‚¦ãƒ³ã‚¹ãƒˆãƒªãƒ¼ãƒ ã«é€ä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</strong></p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>1. Agent Configurationã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=11-gateway-è¨­å®šã®ç¢ºèª>1.1 Gateway è¨­å®šã®ç¢ºèª</h1><p><strong>OpenTelemetry Gateway</strong> ã¯ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã®å—ä¿¡ã€å‡¦ç†ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã®ãŸã‚ã®ä¸­å¤®ãƒãƒ–ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚½ãƒ¼ã‚¹ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚„ã‚µãƒ¼ãƒ“ã‚¹ãªã©ï¼‰ã¨ Splunk Observability Cloud ã®ã‚ˆã†ãªã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®é–“ã«ä½ç½®ã—ã¾ã™ã€‚</p><p>ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚’é›†ä¸­åŒ–ã™ã‚‹ã“ã¨ã§ã€Gateway ã¯ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¨ãƒ³ãƒªãƒƒãƒãƒ¡ãƒ³ãƒˆã€å¤‰æ›ã€ãŠã‚ˆã³1ã¤ä»¥ä¸Šã®å®›å…ˆã¸ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãªã©ã®é«˜åº¦ãªæ©Ÿèƒ½ã‚’å®Ÿç¾ã—ã¾ã™ã€‚å€‹ã€…ã®ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼å‡¦ç†ã‚’ã‚ªãƒ•ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§è² æ‹…ã‚’è»½æ¸›ã—ã€åˆ†æ•£ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã§ä¸€è²«ã—ãŸæ¨™æº–åŒ–ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºä¿ã—ã¾ã™ã€‚</p><p>ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ç®¡ç†ã€ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã€åˆ†æãŒå®¹æ˜“ã«ãªã‚Šã¾ã™ã€‚ç‰¹ã«è¤‡é›‘ãªãƒãƒ«ãƒã‚µãƒ¼ãƒ“ã‚¹ç’°å¢ƒã§ã¯åŠ¹æœçš„ã§ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>2ã¤ç›®ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã‹ä½œæˆã—ã€<strong>Gateway</strong> ã¨åå‰ã‚’ä»˜ã‘ã¾ã™ã€‚æœ€åˆã®æ¼”ç¿’ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª <code>[WORKSHOP]/1-agent-gateway</code> ã«ç§»å‹•ã—ã€<code>gateway.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç¢ºèªã—ã¾ã™ã€‚</p><p>ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€<strong>Gateway</strong> ãƒ¢ãƒ¼ãƒ‰ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚ŒãŸ OpenTelemetry Collector ã®ã‚³ã‚¢æ§‹é€ ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</p></div></details><h3 id=gateway-è¨­å®šã®ç†è§£>Gateway è¨­å®šã®ç†è§£<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ <strong>Gateway</strong> ãƒ¢ãƒ¼ãƒ‰ã® OpenTelemetry Collector ãŒã©ã®ã‚ˆã†ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã‚’å®šç¾©ã™ã‚‹ <code>gateway.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚ã“ã® <strong>Gateway</strong> ã¯ã€<strong>Agent</strong> ã‹ã‚‰ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚’å—ä¿¡ã—ã€å‡¦ç†ã—ã¦ã‹ã‚‰æ¤œæŸ»ã¾ãŸã¯è»¢é€ã®ãŸã‚ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å½¹å‰²ã‚’æ‹…ã„ã¾ã™ã€‚</p><ul><li><p><strong>OTLP Receiverï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒãƒ¼ãƒˆï¼‰</strong></p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>otlp</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>protocols</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>http</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>endpoint</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;0.0.0.0:5318&#34;</span></span></span></code></pre></div><p>ãƒãƒ¼ãƒˆ <code>5318</code> ã¯ <strong>Agent</strong> è¨­å®šã® <code>otlphttp</code> Exporter ã¨ä¸€è‡´ã—ã¦ãŠã‚Šã€<strong>Agent</strong> ãŒé€ä¿¡ã™ã‚‹ã™ã¹ã¦ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒ <strong>Gateway</strong> ã§å—ã‘å…¥ã‚Œã‚‰ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚</p></li></ul><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
ãƒ¡ãƒ¢</summary><div class=box-content><p>ã“ã®ãƒãƒ¼ãƒˆã®åˆ†é›¢ã«ã‚ˆã‚Šã€ç«¶åˆã‚’å›é¿ã—ã€Agent ã¨ Gateway ã®å½¹å‰²é–“ã®è²¬ä»»ã‚’æ˜ç¢ºã«ä¿ã¡ã¾ã™ã€‚</p></div></details><ul><li><p><strong>File Exporter</strong></p><p><strong>Gateway</strong> ã¯3ã¤ã® File Exporter ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã® Exporter ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¦ã„ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>exporters</span><span class=p>:</span><span class=w>                        </span><span class=c># List of exporters</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>debug</span><span class=p>:</span><span class=w>                          </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>verbosity</span><span class=p>:</span><span class=w> </span><span class=l>detailed          </span><span class=w> </span><span class=c># Enable detailed debug output</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces</span><span class=p>:</span><span class=w>                    </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces.out&#34;</span><span class=w>  </span><span class=c># Path for OTLP JSON output for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/metrics</span><span class=p>:</span><span class=w>                   </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-metrics.out&#34;</span><span class=w> </span><span class=c># Path for OTLP JSON output for metrics</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/logs</span><span class=p>:</span><span class=w>                      </span><span class=c># Exporter Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-logs.out&#34;</span><span class=w>    </span><span class=c># Path for OTLP JSON output for logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                 </span><span class=c># Overwrite the file each time</span></span></span></code></pre></div><p>å„ Exporter ã¯ã€ç‰¹å®šã®ã‚·ã‚°ãƒŠãƒ«ã‚¿ã‚¤ãƒ—ã‚’å¯¾å¿œã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ Gateway ãŒèµ·å‹•ã™ã‚‹ã¨ä½œæˆã•ã‚Œã€Agent ãŒãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã™ã‚‹ã¨å®Ÿéš›ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãŒæ›¸ãè¾¼ã¾ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é€šéã™ã‚‹ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã®æµã‚Œã‚’è¦³å¯Ÿã§ãã¾ã™ã€‚</p></li></ul><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=12-è¨­å®šã®æ¤œè¨¼ã¨ãƒ†ã‚¹ãƒˆ>1.2 è¨­å®šã®æ¤œè¨¼ã¨ãƒ†ã‚¹ãƒˆ</h1><p>æ¬¡ã«ã€<strong>Gateway</strong> ã¨ <strong>Agent</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚<strong>Agent</strong> ã¯èµ·å‹•æ™‚ã«è‡ªå‹•çš„ã« <strong>Host Metrics</strong> ã‚’é€ä¿¡ã™ã‚‹ã‚ˆã†è¨­å®šã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ãŒ <strong>Agent</strong> ã‹ã‚‰ <strong>Gateway</strong> ã«æ­£ã—ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway</strong>: <strong>Gateway ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ <strong>Gateway</strong> ã‚’èµ·å‹•ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-4aa325fbb3cf301dd50499cc9ec33a5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-0c2430db25811aadbf57a3f177781188 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4aa325fbb3cf301dd50499cc9ec33a5d","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-0c2430db25811aadbf57a3f177781188 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p>ã™ã¹ã¦ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆã€Collector ãŒèµ·å‹•ã—ã€å‡ºåŠ›ã« <code>Everything is ready. Begin running and processing data.</code> ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªå‡ºåŠ›ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-06-09T09:22:11.944+0100    info    service@v0.126.0/service.go:289 Everything is ready. Begin running and processing data. {&#34;resource&#34;: {}}</span></span></code></pre></div><p><strong>Gateway</strong> ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€ãƒãƒ¼ãƒˆ <code>5318</code> ã§å—ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªãƒƒã‚¹ãƒ³ã—ã€å—ä¿¡ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™</p><ul><li><code>gateway-traces.out</code></li><li><code>gateway-metrics.out</code></li><li><code>gateway-logs.out</code></li></ul><p><strong>Agent ã®èµ·å‹•</strong>: <strong>Agent ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€Agent è¨­å®šã‚’ä½¿ç”¨ã—ã¦ Agent ã‚’èµ·å‹•ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-56a16726926620409da3c19572a50f13><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-c27ed42dab06b7e05a272442ae987c54 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-56a16726926620409da3c19572a50f13","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-c27ed42dab06b7e05a272442ae987c54 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>CPU ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®ç¢ºèª</strong>:</p><ol><li><strong>Agent</strong> ãŒèµ·å‹•ã™ã‚‹ã¨ã€ã™ãã« <strong>CPU</strong> ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®é€ä¿¡ã‚’é–‹å§‹ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</li><li><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ãŒãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã«ã“ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚å‡ºåŠ›ã¯ä»¥ä¸‹ã®ã‚¹ãƒ‹ãƒšãƒƒãƒˆã®ã‚ˆã†ã«ãªã‚Šã¾ã™</li></ol><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>NumberDataPoints #31
</span></span><span class=line><span class=cl>Data point attributes:
</span></span><span class=line><span class=cl>     -&gt; cpu: Str(cpu3)
</span></span><span class=line><span class=cl>     -&gt; state: Str(wait)
</span></span><span class=line><span class=cl>StartTimestamp: 2025-07-07 16:49:42 +0000 UTC
</span></span><span class=line><span class=cl>Timestamp: 2025-07-09 09:36:21.190226459 +0000 UTC
</span></span><span class=line><span class=cl>Value: 77.380000
</span></span><span class=line><span class=cl>        {&#34;resource&#34;: {}, &#34;otelcol.component.id&#34;: &#34;debug&#34;, &#34;otelcol.component.kind&#34;: &#34;exporter&#34;, &#34;otelcol.signal&#34;: &#34;metrics&#34;}</span></span></code></pre></div><p>ã“ã®æ®µéšã§ã€<strong>Agent</strong> ã¯1æ™‚é–“ã”ã¨ã¾ãŸã¯å†èµ·å‹•ã”ã¨ã« <strong>CPU</strong> ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’åé›†ã—ã€Gateway ã«é€ä¿¡ã—ç¶šã‘ã¾ã™ã€‚<strong>Gateway</strong> ã¯ã“ã‚Œã‚‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å‡¦ç†ã—ã€<code>gateway-metrics.out</code> ã¨ã„ã†åå‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚ŒãŸãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä¿å­˜ã—ã¾ã™ã€‚</p><p><strong>Gateway ã«ãƒ‡ãƒ¼ã‚¿ãŒåˆ°ç€ã—ãŸã“ã¨ã®ç¢ºèª</strong>: CPU ãƒ¡ãƒˆãƒªã‚¯ã‚¹ï¼ˆç‰¹ã« <code>cpu0</code>ï¼‰ãŒ Gateway ã«æ­£å¸¸ã«åˆ°é”ã—ãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ã€<code>jq</code> ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ <code>gateway-metrics.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œæŸ»ã—ã¾ã™ã€‚</p><p>ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã¯ã€<code>system.cpu.time</code> ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¦æŠ½å‡ºã—ã€<code>cpu0</code> ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ã€‚ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã®çŠ¶æ…‹ï¼ˆä¾‹ï¼š<code>user</code>ã€<code>system</code>ã€<code>idle</code>ã€<code>interrupt</code>ï¼‰ã¨å¯¾å¿œã™ã‚‹å€¤ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p><p>3ã¤ç›®ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‹ãã‹ä½œæˆã—ã€<strong>Tests</strong> ã¨åå‰ã‚’ä»˜ã‘ã¾ã™ã€‚<strong>Tests ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ <code>system.cpu.time</code> ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-111ddf7ba2bf53e4156ebfc109ca59af><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-8216b058b99231cd5eccfbb2b321454e aria-expanded=true data-tab-item=R-tab-fe622e84764bc6f08467fa0eea9b5ec6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-111ddf7ba2bf53e4156ebfc109ca59af","R-tab-fe622e84764bc6f08467fa0eea9b5ec6")'>
<span class=tab-nav-text>Check CPU Metrics</span>
</button>
<button aria-controls=R-tab-id-654f78fe0b54e3e2b3d223a169ce648f aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-111ddf7ba2bf53e4156ebfc109ca59af","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-8216b058b99231cd5eccfbb2b321454e data-tab-item=R-tab-fe622e84764bc6f08467fa0eea9b5ec6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[] | select(.name == &#34;system.cpu.time&#34;) | .sum.dataPoints[] | select(.attributes[0].value.stringValue == &#34;cpu0&#34;) | {cpu: .attributes[0].value.stringValue, state: .attributes[1].value.stringValue, value: .asDouble}&#39;</span> gateway-metrics.out</span></span></code></pre></div></div></div><div id=R-tab-id-654f78fe0b54e3e2b3d223a169ce648f data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;user&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>123407.02</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;system&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>64866.6</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;idle&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mf>216427.87</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;cpu&#34;</span><span class=p>:</span> <span class=s2>&#34;cpu0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;state&#34;</span><span class=p>:</span> <span class=s2>&#34;interrupt&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=2-è€éšœå®³æ€§ã®æ§‹ç¯‰>2. è€éšœå®³æ€§ã®æ§‹ç¯‰</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>OpenTelemetry Collector ã® <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/19bc7d6ee854c0c1b5c97d8d348e5b9d1199e8aa/extension/storage/filestorage/README.md rel=external><strong>FileStorage Extension</strong></a> ã¯ã€ã‚ˆã‚Šè€éšœå®³æ€§ã®é«˜ã„ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®é‡è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Collector ã¯å‡¦ç†ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºå®Ÿã«ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã—ã€ãƒªãƒˆãƒ©ã‚¤ã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã—ã€è²´é‡ãªãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã‚’å¤±ã†ã“ã¨ãªãä¸€æ™‚çš„ãªéšœå®³ã‚’é©åˆ‡ã«å‡¦ç†ã§ãã¾ã™ã€‚</p><p>FileStorage ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€Collector ã¯ä¸­é–“çŠ¶æ…‹ã‚’ãƒ‡ã‚£ã‚¹ã‚¯ã«æ°¸ç¶šåŒ–ã§ãã‚‹ãŸã‚ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ä¸­æ–­ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®åœæ­¢ã€ã¾ãŸã¯ Collector ã®å†èµ·å‹•æ™‚ã«ã‚‚ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ãŒå¤±ã‚ã‚Œãªã„ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚ã¤ã¾ã‚Šã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãŒåˆ‡æ–­ã•ã‚ŒãŸã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãŒä¸€æ™‚çš„ã«åˆ©ç”¨ã§ããªããªã£ãŸã‚Šã—ã¦ã‚‚ã€Collector ã¯ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã®å—ä¿¡ã¨ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ã‚’ç¶™ç¶šã—ã€æ¥ç¶šãŒå¾©æ—§ã™ã‚‹ã¨é…ä¿¡ã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«å†é–‹ã—ã¾ã™ã€‚</p><p>FileStorage Extension ã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆã™ã‚‹ã“ã¨ã§ã€ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£ã‚¹ã‚¿ãƒƒã‚¯ã®è€ä¹…æ€§ã‚’å¼·åŒ–ã—ã€æ¥ç¶šãŒä¸å®‰å®šãªç’°å¢ƒã§ã‚‚é«˜å“è³ªãªãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼å–ã‚Šè¾¼ã¿ã‚’ç¶­æŒã§ãã¾ã™ã€‚<details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
ãƒ¡ãƒ¢</summary><div class=box-content><p>ã“ã®ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã€æ¥ç¶šãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒçŸ­ã„å ´åˆï¼ˆæœ€å¤§15åˆ†ï¼‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å¯¾ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãŒã“ã‚Œã‚’è¶…ãˆã‚‹ã¨ã€Splunk Observability Cloud ã¯ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã®é †åºãŒä¹±ã‚Œãªã„ã‚ˆã†ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ãƒ­ã‚°ã«ã¤ã„ã¦ã¯ã€ä»Šå¾Œã® Splunk OpenTelemetry Collector ãƒªãƒªãƒ¼ã‚¹ã§å®Œå…¨ãªã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºå¯¾å¿œã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã™ã‚‹è¨ˆç”»ãŒã‚ã‚Šã¾ã™ã€‚</p></div></details></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/09</span></span></footer></article><section><h1 class=a11y-only>2. Building Resilienceã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=21-file-storage-ã®è¨­å®š>2.1 File Storage ã®è¨­å®š</h1><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<code>agent.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã® <code>extensions:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°ã—ã¾ã™ã€‚ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ OpenTelemetry è¨­å®š YAML ã®ä¸€éƒ¨ã§ã‚ã‚Šã€OpenTelemetry Collector ã®å‹•ä½œã‚’æ‹¡å¼µã¾ãŸã¯å¤‰æ›´ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®šç¾©ã—ã¾ã™ã€‚</p><p>ã“ã‚Œã‚‰ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç›´æ¥å‡¦ç†ã—ã¾ã›ã‚“ãŒã€Collector ã®æ©Ÿèƒ½ã‚’å‘ä¸Šã•ã›ã‚‹è²´é‡ãªæ©Ÿèƒ½ã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong><em>ã™ã¹ã¦ã®</em> ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>2-building-resilience</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-6bdccd61cff2ca5978a5b4ba7a0ab338><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-511af5321794db25552c871dd5c9da1a aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-6bdccd61cff2ca5978a5b4ba7a0ab338","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-511af5321794db25552c871dd5c9da1a data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong><code>agent.yaml</code> ã®æ›´æ–°</strong>: <strong>Agent ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€æ—¢å­˜ã® <code>health_check</code> Extension ã®ä¸‹ã« <code>file_storage</code> Extension ã‚’è¿½åŠ ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>file_storage/checkpoint</span><span class=p>:</span><span class=w>             </span><span class=c># Extension Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./checkpoint-dir&#34;</span><span class=w>      </span><span class=c># Define directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>create_directory</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>             </span><span class=c># Create directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>timeout</span><span class=p>:</span><span class=w> </span><span class=l>1s                       </span><span class=w> </span><span class=c># Timeout for file operations</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>compaction</span><span class=p>:</span><span class=w>                        </span><span class=c># Compaction settings</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>on_start</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                   </span><span class=c># Start compaction at Collector startup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Define compaction directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>directory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./checkpoint-dir/tmp&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>max_transaction_size</span><span class=p>:</span><span class=w> </span><span class=m>65536</span><span class=w>      </span><span class=c># Max. size limit before compaction occurs</span></span></span></code></pre></div><p><strong>Exporter ã¸ã® <code>file_storage</code> ã®è¿½åŠ </strong>: <code>otlphttp</code> Exporter ã‚’å¤‰æ›´ã—ã¦ã€ãƒªãƒˆãƒ©ã‚¤ã¨ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’è¨­å®šã—ã€éšœå®³ãŒç™ºç”Ÿã—ãŸå ´åˆã«ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œå†é€ä¿¡ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚<code>endpoint: "http://localhost:5318"</code> ã®ä¸‹ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒ <code>endpoint</code> ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>retry_on_failure</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                    </span><span class=c># Enable retry on failure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>sending_queue</span><span class=p>:</span><span class=w>                     </span><span class=c>#</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>enabled</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>                    </span><span class=c># Enable sending queue</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>num_consumers</span><span class=p>:</span><span class=w> </span><span class=m>10</span><span class=w>                </span><span class=c># No. of consumers</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>queue_size</span><span class=p>:</span><span class=w> </span><span class=m>10000</span><span class=w>                </span><span class=c># Max. queue size</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>file_storage/checkpoint</span><span class=w> </span><span class=c># File storage extension</span></span></span></code></pre></div><p><strong><code>services</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ›´æ–°</strong>: æ—¢å­˜ã® <code>extensions:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« <code>file_storage/checkpoint</code> Extension ã‚’è¿½åŠ ã—ã¾ã™ã€‚è¨­å®šã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>service</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>extensions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>health_check</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>file_storage/checkpoint           </span><span class=w> </span><span class=c># Enabled extensions for this collector</span></span></span></code></pre></div><p><strong><code>metrics</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æ›´æ–°</strong>: ã“ã®æ¼”ç¿’ã§ã¯ã€ãƒ‡ãƒãƒƒã‚°ã¨ãƒ­ã‚°ã®ãƒã‚¤ã‚ºã‚’æ¸›ã‚‰ã™ãŸã‚ã«ã€Metric ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‹ã‚‰ <code>hostmetrics</code> Receiver ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¾ã™ã€‚è¨­å®šã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># - hostmetrics                    # Hostmetric reciever (cpu only)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span></span></span></code></pre></div></div></details><p><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦ <strong>Agent</strong> è¨­å®šã‚’æ¤œè¨¼ã—ã¦ãã ã•ã„ã€‚å‚è€ƒã¾ã§ã«ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>metrics:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO2(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      EXP1(&amp;ensp;debug&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(otlphttp&lt;br&gt;fa:fa-upload):::exporter
      EXP3(&amp;ensp;file&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    %% Links
    subID1:::sub-metrics
    subgraph &#34; &#34;
      subgraph subID1[**Metrics**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO2
      PRO2 --&gt; PRO3
      PRO3 --&gt; EXP1
      PRO3 --&gt; EXP3
      PRO3 --&gt; EXP2
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=22-è€éšœå®³æ€§ãƒ†ã‚¹ãƒˆç”¨ã®ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—>2.2 è€éšœå®³æ€§ãƒ†ã‚¹ãƒˆç”¨ã®ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h1><p>æ¬¡ã«ã€<strong>File Storage</strong> è¨­å®šã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹æº–å‚™ã¨ã—ã¦ç’°å¢ƒã‚’è¨­å®šã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway ã®èµ·å‹•</strong>: <strong>Gateway ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-2c8963afa111278ad125be230958fba2><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1e119144c37be9990989b64bc53c226f aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2c8963afa111278ad125be230958fba2","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-1e119144c37be9990989b64bc53c226f data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Agent ã®èµ·å‹•</strong>: <strong>Agent ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-a47c0800323148e81762f5c0088c6e0b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-bc494e6232ab9ec191a4367e7076f6fa aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a47c0800323148e81762f5c0088c6e0b","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-bc494e6232ab9ec191a4367e7076f6fa data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>5ã¤ã®ãƒ†ã‚¹ãƒˆã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡</strong>: <strong>Loadgen ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-7b4f8125bc9552cb78890f58912276a4><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e3094be67f1a20c5823a4732c1bcbcf3 aria-expanded=true data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7b4f8125bc9552cb78890f58912276a4","R-tab-5386e98c2a18696103b86ab3f8520915")'>
<span class=tab-nav-text>Start Load Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-e3094be67f1a20c5823a4732c1bcbcf3 data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ãŒãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã‚’è¡¨ç¤ºã—ã€<strong>Gateway</strong> ãŒ <code>./gateway-traces.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ã¯ãšã§ã™ã€‚</p><p>ã™ã¹ã¦ãŒæ­£å¸¸ã«æ©Ÿèƒ½ã—ã¦ã„ã‚‹å ´åˆã€ã‚·ã‚¹ãƒ†ãƒ ã®è€éšœå®³æ€§ã®ãƒ†ã‚¹ãƒˆã«é€²ã‚€ã“ã¨ãŒã§ãã¾ã™ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=23-éšœå®³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³>2.3 éšœå®³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h1><p><strong>Agent</strong> ã®è€éšœå®³æ€§ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ã«ã€ä¸€æ™‚çš„ãª <strong>Gateway</strong> ã®åœæ­¢ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã—ã€<strong>Agent</strong> ãŒãã‚Œã‚’ã©ã®ã‚ˆã†ã«å‡¦ç†ã™ã‚‹ã‹ã‚’è¦³å¯Ÿã—ã¾ã™</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>: <strong>Gateway ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã§ <code>Ctrl-C</code> ã‚’ä½¿ç”¨ã—ã¦ <strong>Gateway</strong> ã‚’åœæ­¢ã—ã€Gateway ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãŒåœæ­¢ã—ãŸã“ã¨ã‚’ç¤ºã™ã¾ã§å¾…ã¡ã¾ã™ã€‚<strong>Agent</strong> ã¯å¼•ãç¶šãå®Ÿè¡Œã•ã‚Œã¾ã™ãŒã€Gateway ã«ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã§ãã¾ã›ã‚“ã€‚<strong>Gateway ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã®å‡ºåŠ›ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-09T10:22:37.941Z        info    service@v0.126.0/service.go:345 Shutdown complete.      {&#34;resource&#34;: {}}</span></span></code></pre></div><p><strong>ãƒˆãƒ¬ãƒ¼ã‚¹ã®é€ä¿¡</strong>: <strong>Loadgen ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€<code>loadgen</code> ã‚’ä½¿ç”¨ã—ã¦ã•ã‚‰ã«5ã¤ã®ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’é€ä¿¡ã—ã¾ã™ã€‚</p><div class=tab-panel data-tab-group=R-tabs-20e094d4c5b1a45609f1f776224e1b2a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-ee00137bccaf27655ad030d388ce96b8 aria-expanded=true data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-20e094d4c5b1a45609f1f776224e1b2a","R-tab-5386e98c2a18696103b86ab3f8520915")'>
<span class=tab-nav-text>Start Load Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-ee00137bccaf27655ad030d388ce96b8 data-tab-item=R-tab-5386e98c2a18696103b86ab3f8520915 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p>Agent ã®ãƒªãƒˆãƒ©ã‚¤ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ãŒæœ‰åŠ¹ã«ãªã‚Šã€ãƒ‡ãƒ¼ã‚¿ã‚’å†é€ä¿¡ã—ã‚ˆã†ã¨ç¶™ç¶šçš„ã«è©¦ã¿ã¦ã„ã‚‹ã“ã¨ã«æ³¨ç›®ã—ã¦ãã ã•ã„ã€‚Agent ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã«ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç¹°ã‚Šè¿”ã—è¡¨ç¤ºã•ã‚Œã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-01-28T14:22:47.020+0100  info  internal/retry_sender.go:126  Exporting failed. Will retry the request after interval.  {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;traces&#34;, &#34;name&#34;: &#34;otlphttp&#34;, &#34;error&#34;: &#34;failed to make an HTTP request: Post \&#34;http://localhost:5318/v1/traces\&#34;: dial tcp 127.0.0.1:5318: connect: connection refused&#34;, &#34;interval&#34;: &#34;9.471474933s&#34;}</span></span></code></pre></div><p><strong>Agent ã®åœæ­¢</strong>: <strong>Agent ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€<code>Ctrl-C</code> ã‚’ä½¿ç”¨ã—ã¦ Agent ã‚’åœæ­¢ã—ã¾ã™ã€‚Agent ã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãŒåœæ­¢ã‚’ç¢ºèªã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-09T10:25:59.344Z        info    service@v0.126.0/service.go:345 Shutdown complete.      {&#34;resource&#34;: {}}</span></span></code></pre></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p>Agent ã‚’åœæ­¢ã™ã‚‹ã¨ã€ãƒªãƒˆãƒ©ã‚¤ç”¨ã«ãƒ¡ãƒ¢ãƒªã«ä¿æŒã•ã‚Œã¦ã„ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ã¯å¤±ã‚ã‚Œã¾ã™ã€‚ãŸã ã—ã€FileStorage Extension ã‚’è¨­å®šã—ã¦ã„ã‚‹ãŸã‚ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã§ã¾ã å—ã‘å…¥ã‚Œã‚‰ã‚Œã¦ã„ãªã„ã™ã¹ã¦ã®ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ã¯ãƒ‡ã‚£ã‚¹ã‚¯ã«å®‰å…¨ã«ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p>Agent ã®åœæ­¢ã¯ã€Agent ãŒå†èµ·å‹•ã•ã‚ŒãŸã¨ãã«ã‚·ã‚¹ãƒ†ãƒ ãŒã©ã®ã‚ˆã†ã«å¾©æ—§ã™ã‚‹ã‹ã‚’æ˜ç¢ºã«ç¤ºã™ãŸã‚ã®é‡è¦ãªã‚¹ãƒ†ãƒƒãƒ—ã§ã™ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=24-å¾©æ—§>2.4 å¾©æ—§</h1><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<strong>Gateway</strong> Collector ã‚’å†èµ·å‹•ã™ã‚‹ã“ã¨ã§ã€<strong>OpenTelemetry Collector</strong> ãŒãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯éšœå®³ã‹ã‚‰ã©ã®ã‚ˆã†ã«å¾©æ—§ã™ã‚‹ã‹ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚<strong>Gateway</strong> ãŒå†ã³åˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã¨ã€<strong>Agent</strong> ã¯æœ€å¾Œã«ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã•ã‚ŒãŸçŠ¶æ…‹ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡ã‚’å†é–‹ã—ã€ãƒ‡ãƒ¼ã‚¿æå¤±ãŒãªã„ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway ã®å†èµ·å‹•</strong>: <strong>Gateway ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-4686da71c0ed495190456b5ab596a31f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-80021b9f21822daa8b5cc4917cc77b5a aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4686da71c0ed495190456b5ab596a31f","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-80021b9f21822daa8b5cc4917cc77b5a data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Agent ã®å†èµ·å‹•</strong>: <strong>Agent ã‚¿ãƒ¼ãƒŸãƒŠãƒ«</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-69917b17d09db4d1847609ec296b04ce><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3010ea74b904f4d2f7a755d8992b2912 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-69917b17d09db4d1847609ec296b04ce","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-3010ea74b904f4d2f7a755d8992b2912 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><blockquote><p><strong>Agent</strong> ãŒèµ·å‹•ã—ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€<strong>File_Storage</strong> Extension ãŒãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€ãƒ¼å†…ã®ãƒãƒƒãƒ•ã‚¡ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’æ¤œå‡ºã—ã¾ã™ã€‚æœ€å¾Œã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã‹ã‚‰ä¿å­˜ã•ã‚ŒãŸã‚¹ãƒ‘ãƒ³ã‚’ãƒ‡ã‚­ãƒ¥ãƒ¼ã—å§‹ã‚ã€ãƒ‡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œãªã„ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚</p></blockquote><p><strong>Agent ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®ç¢ºèª:</strong> <strong>Agent</strong> ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã¯å¤‰åŒ–<strong>ã›ãš</strong>ã€ä»¥ä¸‹ã®è¡Œã‚’è¡¨ç¤ºã—ç¶šã‘ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ç¤ºã—ã¦ã„ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>2025-07-11T08:31:58.176Z        info    service@v0.126.0/service.go:289 Everything is ready. Begin running and processing data.   {&#34;resource&#34;: {}}</span></span></code></pre></div><p><strong>Gateway ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã®ç¢ºèª</strong>
<strong>Gateway</strong> ã®ãƒ‡ãƒãƒƒã‚°ç”»é¢ã‹ã‚‰ã€ä»¥å‰è¦‹é€ƒã•ã‚Œã¦ã„ãŸãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¿½åŠ ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãªã—ã§å—ä¿¡ã—å§‹ã‚ã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã‚‹ã¯ãšã§ã™ã€‚ä¾‹</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>   -&gt; user.name: Str(Luke Skywalker)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>   -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(75.75)
</span></span><span class=line><span class=cl>      {&#34;resource&#34;: {}, &#34;otelcol.component.id&#34;: &#34;debug&#34;, &#34;otelcol.component.kind&#34;: &#34;exporter&#34;, &#34;otelcol.signal&#34;: &#34;traces&#34;}</span></span></code></pre></div><p><strong><code>gateway-traces.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª:</strong> <code>jq</code> ã‚’ä½¿ç”¨ã—ã¦ã€å†ä½œæˆã•ã‚ŒãŸ <code>gateway-traces.out</code> å†…ã®ãƒˆãƒ¬ãƒ¼ã‚¹æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã™ã€‚<strong>Gateway</strong> ãŒãƒ€ã‚¦ãƒ³ã—ã¦ã„ãŸã¨ãã«é€ä¿¡ã—ãŸæ•°ã¨ä¸€è‡´ã™ã‚‹ã¯ãšã§ã™ã€‚</p><div class=tab-panel data-tab-group=R-tabs-2e5fd48b1aa5ca2ffff7f272f4c76ef3><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-121d37f2eb988394ccadd49bb4f2d657 aria-expanded=true data-tab-item=R-tab-4e2ba08c3a1a44c321b4ef1ba3812149 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-2e5fd48b1aa5ca2ffff7f272f4c76ef3","R-tab-4e2ba08c3a1a44c321b4ef1ba3812149")'>
<span class=tab-nav-text>Check Gateway Traces Out File</span>
</button>
<button aria-controls=R-tab-id-44593e5bde90458d81660989c6642319 aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-2e5fd48b1aa5ca2ffff7f272f4c76ef3","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-121d37f2eb988394ccadd49bb4f2d657 data-tab-item=R-tab-4e2ba08c3a1a44c321b4ef1ba3812149 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans | length | &#34;\(.) resourceSpans found&#34;&#39;</span> gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-44593e5bde90458d81660989c6642319 data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;5 resourceSpans found&#34;</span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details><h3 id=ã¾ã¨ã‚>ã¾ã¨ã‚<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h3><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<code>file_storage</code> Extension ã®è¨­å®šã€<code>otlp</code> Exporter ã®ãƒªãƒˆãƒ©ã‚¤ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®æœ‰åŠ¹åŒ–ã€ãŠã‚ˆã³ä¸€æ™‚çš„ãªãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨ã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚­ãƒ¥ãƒ¼ã®ä½¿ç”¨ã«ã‚ˆã‚Šã€OpenTelemetry Collector ã®è€éšœå®³æ€§ã‚’å¼·åŒ–ã™ã‚‹æ–¹æ³•ã‚’ç¤ºã—ã¾ã—ãŸã€‚</p><p>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã¨ã‚­ãƒ¥ãƒ¼ã®æ°¸ç¶šåŒ–ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒä¸€æ™‚çš„ãªä¸­æ–­ã‹ã‚‰é©åˆ‡ã«å¾©æ—§ã§ãã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã€æœ¬ç•ªç’°å¢ƒã§ã‚ˆã‚Šå …ç‰¢ã§ä¿¡é ¼æ€§ã®é«˜ã„ã‚‚ã®ã«ã—ã¾ã™ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=3-spanã®ãƒ‰ãƒ­ãƒƒãƒ—>3. Spanã®ãƒ‰ãƒ­ãƒƒãƒ—</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>5 minutes</span>
</span>&nbsp;<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/filterprocessor/README.md rel=external><strong>Filter Processor</strong></a> ã‚’ä½¿ç”¨ã—ã¦ã€ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦Spanã‚’é¸æŠçš„ã«ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚</p><p>å…·ä½“çš„ã«ã¯ã€Spanåã«åŸºã¥ã„ã¦ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’ãƒ‰ãƒ­ãƒƒãƒ—ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚„å†…éƒ¨é€šä¿¡ãƒˆãƒ¬ãƒ¼ã‚¹ãªã©ã®ä¸è¦ãªSpanã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã«ã‚ˆãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä»Šå›ã¯ã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢é€£ä»˜ã‘ã‚‰ã‚Œã‚‹ã“ã¨ãŒå¤šãã€é€šå¸¸ã¯éå¸¸ã«ã€Œ<strong>ãƒã‚¤ã‚¸ãƒ¼</strong>ã€ãª <code>"/_healthz"</code> ã‚’å«ã‚€Spanã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>ã™ã¹ã¦ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>3-dropping-spans</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p><code>2-building-resilience</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ <code>*.yaml</code> ã‚’ <code>3-dropping-spans</code> ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚æ›´æ–°å¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-ea2d154e28d596d412eb0e76e036666c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6c152532a1bd653000c62faa42185718 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-ea2d154e28d596d412eb0e76e036666c","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-6c152532a1bd653000c62faa42185718 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><p>æ¬¡ã«ã€<strong>filter processor</strong> ã¨å¯¾å¿œã™ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¨­å®šã—ã¾ã™ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>3. Spanã®ãƒ‰ãƒ­ãƒƒãƒ—ã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=31-è¨­å®š>3.1 è¨­å®š</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ‡ã‚Šæ›¿ãˆã¦ã€<code>gateway.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¾ã™ã€‚ä»¥ä¸‹ã®è¨­å®šã§ <code>processors</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æ›´æ–°ã—ã¾ã™</p><ol><li><p><strong><code>filter</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã™ã‚‹</strong>
<code>/_healthz</code> ã¨ã„ã†åå‰ã®Spanã‚’é™¤å¤–ã™ã‚‹ã‚ˆã†ã«Gatewayã‚’è¨­å®šã—ã¾ã™ã€‚<code>error_mode: ignore</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ä¸­ã«ç™ºç”Ÿã—ãŸã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–ã—ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒã‚¹ãƒ ãƒ¼ã‚ºã«å‹•ä½œã—ç¶šã‘ã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚<code>traces</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã€<code>/_healthz</code> ã¨ã„ã†åå‰ã®Spanã‚’é™¤å¤–å¯¾è±¡ã¨ã—ã¦æŒ‡å®šã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>filter/health</span><span class=p>:</span><span class=w>                       </span><span class=c># Defines a filter processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>error_mode</span><span class=p>:</span><span class=w> </span><span class=l>ignore                </span><span class=w> </span><span class=c># Ignore errors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>                            </span><span class=c># Filtering rules for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>span</span><span class=p>:</span><span class=w>                            </span><span class=c># Exclude spans named &#34;/_healthz&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span>- <span class=s1>&#39;name == &#34;/_healthz&#34;&#39;</span></span></span></code></pre></div></li><li><p><strong><code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã« <code>filter</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã™ã‚‹</strong>
<code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã« <code>filter/health</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã—ã¾ã™ã€‚æœ€é©ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å¾—ã‚‹ãŸã‚ã«ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã¯ã§ãã‚‹ã ã‘æ—©ã„æ®µéšã«é…ç½®ã—ã¾ã™ã€‚<code>memory_limiter</code> ã®ç›´å¾Œã€<code>batch</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã®å‰ã«é…ç½®ã—ã¦ãã ã•ã„ã€‚è¨­å®šã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filter/health            </span><span class=w> </span><span class=c># Filters data based on rules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces</span></span></span></code></pre></div></li></ol><p>ã“ã®è¨­å®šã«ã‚ˆã‚Šã€ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯é–¢é€£ã®Spanï¼ˆ<code>/_healthz</code>ï¼‰ãŒãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æ—©ã„æ®µéšã§ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚Œã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ä¸è¦ãªãƒã‚¤ã‚ºãŒå‰Šæ¸›ã•ã‚Œã¾ã™ã€‚</p></div></details><p><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦Agentè¨­å®šã‚’æ¤œè¨¼ã—ã¾ã™ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>traces:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(filter&lt;br&gt;fa:fa-microchip&lt;br&gt;health):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(&amp;ensp;debug&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;ensp;&amp;ensp;file&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
    %% Links
    subID1:::sub-traces
    subgraph &#34; &#34;
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO4
      PRO4 --&gt; PRO3
      PRO3 --&gt; PRO5
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=32-filter-processorã®ãƒ†ã‚¹ãƒˆ>3.2 Filter Processorã®ãƒ†ã‚¹ãƒˆ</h1><p>è¨­å®šã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ã«ã¯ã€<code>"/_healthz"</code> ã¨ã„ã†åå‰ã®Spanã‚’å«ã‚€ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gatewayã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Gateway</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config ./gateway.yaml</span></span></code></pre></div><p><strong>Agentã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Agent</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config ./agent.yaml</span></span></code></pre></div><p><strong>Loadgenã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯Spanã‚’æœ‰åŠ¹ã«ã—ãŸçŠ¶æ…‹ã§ãƒ­ãƒ¼ãƒ‰ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’èµ·å‹•ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -health -count <span class=m>5</span></span></span></code></pre></div><p><strong>Agent terminal</strong> ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã« <code>_healthz</code> SpanãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>InstrumentationScope healthz 1.0.0
</span></span><span class=line><span class=cl>Span #0
</span></span><span class=line><span class=cl>   Trace ID       : 0cce8759b5921c8f40b346b2f6e2f4b6
</span></span><span class=line><span class=cl>   Parent ID      :
</span></span><span class=line><span class=cl>   ID             : bc32bd0e4ddcb174
</span></span><span class=line><span class=cl>   Name           : /_healthz
</span></span><span class=line><span class=cl>   Kind           : Server
</span></span><span class=line><span class=cl>   Start time     : 2025-07-11 08:47:50.938703979 +0000 UTC
</span></span><span class=line><span class=cl>   End time       : 2025-07-11 08:47:51.938704091 +0000 UTC
</span></span><span class=line><span class=cl>   Status code    : Ok
</span></span><span class=line><span class=cl>   Status message : Success</span></span></code></pre></div><p>ã“ã‚Œã‚‰ã¯ã€å…ˆã»ã©è¨­å®šã—ãŸFilter Processorã«ã‚ˆã£ã¦ãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚Œã‚‹ãŸã‚ã€<strong>Gateway</strong> ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚</p><p><strong><code>agent.out</code> ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<strong>Test terminal</strong> ã§ <code>jq</code> ã‚’ä½¿ç”¨ã—ã¦ã€<strong>Agent</strong> ãŒå—ä¿¡ã—ãŸSpanã®åå‰ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-9258d2d5288233f3bcab20fd3d3ab2ea><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-782b832eeaa75c8c19a6407643c73cf0 aria-expanded=true data-tab-item=R-tab-acf06dfba3409686305aa9022a3341eb class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9258d2d5288233f3bcab20fd3d3ab2ea","R-tab-acf06dfba3409686305aa9022a3341eb")'>
<span class=tab-nav-text>Check spans in agent.out</span>
</button>
<button aria-controls=R-tab-id-c50011f7e8a480bf12046517b89e448d aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-9258d2d5288233f3bcab20fd3d3ab2ea","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-782b832eeaa75c8c19a6407643c73cf0 data-tab-item=R-tab-acf06dfba3409686305aa9022a3341eb class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[] | &#34;Span \(input_line_number) found with name \(.name)&#34;&#39;</span> ./agent.out</span></span></code></pre></div></div></div><div id=R-tab-id-c50011f7e8a480bf12046517b89e448d data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;Span 1 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 2 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 3 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 4 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 5 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 6 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 7 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 8 found with name /_healthz&#34;
</span></span><span class=line><span class=cl>&#34;Span 9 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 10 found with name /_healthz&#34;</span></span></code></pre></div></div></div></div></div><p><strong>Gateway ã®ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<code>jq</code> ã‚’ä½¿ç”¨ã—ã¦ã€<strong>Gateway</strong> ãŒå—ä¿¡ã—ãŸSpanã®åå‰ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-497ada399dbe043328e993298ac9dd2a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-574f26e95a9fbf1e68053c4156ffa240 aria-expanded=true data-tab-item=R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-497ada399dbe043328e993298ac9dd2a","R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3")'>
<span class=tab-nav-text>Check spans in gateway-traces.out</span>
</button>
<button aria-controls=R-tab-id-2929ca3a982000f9d4c06b3929f1ede3 aria-expanded=false data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-497ada399dbe043328e993298ac9dd2a","R-tab-587b796170a9abac4701cd8aa1bb38cb")'>
<span class=tab-nav-text>Example output</span></button></div><div class=tab-content-container><div id=R-tab-id-574f26e95a9fbf1e68053c4156ffa240 data-tab-item=R-tab-a9bb81bd9bb8c45ad95832f29cf5b7e3 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[] | &#34;Span \(input_line_number) found with name \(.name)&#34;&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-2929ca3a982000f9d4c06b3929f1ede3 data-tab-item=R-tab-587b796170a9abac4701cd8aa1bb38cb class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><code>gateway-metrics.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ <code>/_healthz</code> ã¨ã„ã†åå‰ã®Spanã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&#34;Span 1 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 2 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 3 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 4 found with name /movie-validator&#34;
</span></span><span class=line><span class=cl>&#34;Span 5 found with name /movie-validator&#34;</span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>Filter Processorã§æœ€é©ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç¢ºä¿ã™ã‚‹ã«ã¯ã€å—ä¿¡ãƒ‡ãƒ¼ã‚¿ã®å½¢å¼ã‚’ååˆ†ã«ç†è§£ã—ã€è¨­å®šã‚’å³å¯†ã«ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚<strong>ã§ãã‚‹ã ã‘å…·ä½“çš„ãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ã‚’ä½¿ç”¨</strong>ã—ã¦ã€é‡è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’èª¤ã£ã¦ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ãƒªã‚¹ã‚¯ã‚’æœ€å°é™ã«æŠ‘ãˆã¦ãã ã•ã„ã€‚</p><p>ã“ã®è¨­å®šã¯ã€ã•ã¾ã–ã¾ãªå±æ€§ã€ã‚¿ã‚°ã€ã¾ãŸã¯ã‚«ã‚¹ã‚¿ãƒ æ¡ä»¶ã«åŸºã¥ã„ã¦Spanã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«æ‹¡å¼µã§ãã€ç‰¹å®šã®ã‚ªãƒ–ã‚¶ãƒ¼ãƒãƒ“ãƒªãƒ†ã‚£è¦ä»¶ã«åˆã‚ã›ã¦ OpenTelemetry Collector ã®æŸ”è»Ÿæ€§ã¨åŠ¹ç‡ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=4-æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ç§˜åŒ¿åŒ–>4. æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ç§˜åŒ¿åŒ–</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€OpenTelemetry Collector ã‚’è¨­å®šã—ã¦ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼Spanã‹ã‚‰ç‰¹å®šã®ã‚¿ã‚°ã‚’å‰Šé™¤ã—ã€æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’ç§˜åŒ¿åŒ–ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ã“ã‚Œã¯ã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã€å€‹äººãƒ‡ãƒ¼ã‚¿ã€ãã®ä»–ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã®è©³ç´°ãªã©ã€å‡¦ç†ã¾ãŸã¯ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å‰ã«åŒ¿ååŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚‹æ©Ÿå¯†æƒ…å ±ã‚’ä¿è­·ã™ã‚‹ãŸã‚ã«é‡è¦ã§ã™ã€‚</p><p>OpenTelemetry Collector ã®ä¸»è¦ãªãƒ—ãƒ­ã‚»ãƒƒã‚µã®è¨­å®šã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™</p><ul><li><strong><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/attributesprocessor/README.md rel=external>Attributes Processor</a></strong>ï¼šç‰¹å®šã®Spanå±æ€§ã‚’å¤‰æ›´ã¾ãŸã¯å‰Šé™¤ã—ã¾ã™ã€‚</li><li><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/redactionprocessor/README.md rel=external><strong>Redaction Processor</strong></a>ï¼šæ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ãŒä¿å­˜ã¾ãŸã¯é€ä¿¡ã•ã‚Œã‚‹å‰ã«ã‚µãƒ‹ã‚¿ã‚¤ã‚ºã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚</li></ul><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>ã™ã¹ã¦ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>4-sensitive-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p><code>3-dropping-spans</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ <code>*.yaml</code> ã‚’ <code>4-sensitive-data</code> ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚æ›´æ–°å¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-752a4cd6548acdb469bf18fbf33deff5><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-881ff5a84ac3ec165d76b3b9c8f4df3d aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-752a4cd6548acdb469bf18fbf33deff5","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-881ff5a84ac3ec165d76b3b9c8f4df3d data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>4. æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=41-è¨­å®š>4.1 è¨­å®š</h1><p>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯ã€<code>agent.yaml</code> ã‚’ä¿®æ­£ã—ã¦ <code>attributes</code> ã¨ <code>redaction</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚»ãƒƒã‚µã¯ã€Spanå±æ€§å†…ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ãŒãƒ­ã‚°ã«è¨˜éŒ²ã¾ãŸã¯ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹å‰ã«é©åˆ‡ã«å‡¦ç†ã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚</p><p>ä»¥å‰ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¡¨ç¤ºã•ã‚ŒãŸSpanå±æ€§ã®ä¸€éƒ¨ã«å€‹äººæƒ…å ±ã‚„æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ã„ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã‹ã‚‰ã€ã“ã®æƒ…å ±ã‚’åŠ¹æœçš„ã«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŠã‚ˆã³ç§˜åŒ¿åŒ–ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¨­å®šã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>     -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>     -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>     -&gt; user.account_password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>     -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>     -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>     -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>  {&#34;kind&#34;: &#34;exporter&#34;, &#34;data_type&#34;: &#34;traces&#34;, &#34;name&#34;: &#34;debug&#34;}</span></span></code></pre></div><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ‡ã‚Šæ›¿ãˆã¦ã€ã‚¨ãƒ‡ã‚£ã‚¿ã§ <code>agent.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¾ã™ã€‚ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ã‚’å¼·åŒ–ã™ã‚‹ãŸã‚ã«ã€2ã¤ã®ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã—ã¾ã™ã€‚</p><p><strong>1. <code>attributes</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã™ã‚‹</strong>ï¼š<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/attributesprocessor rel=external><strong>Attributes Processor</strong></a> ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Spanå±æ€§ï¼ˆã‚¿ã‚°ï¼‰ã®å€¤ã‚’æ›´æ–°ã€å‰Šé™¤ã€ã¾ãŸã¯ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦å¤‰æ›´ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€æ©Ÿå¯†æƒ…å ±ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å‰ã«é›£èª­åŒ–ã™ã‚‹å ´åˆã«ç‰¹ã«ä¾¿åˆ©ã§ã™ã€‚</p><p>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯</p><ol><li><code>user.phone_number</code> å±æ€§ã‚’é™çš„ãªå€¤ï¼ˆ<code>"UNKNOWN NUMBER"</code>ï¼‰ã«<strong>æ›´æ–°</strong>ã—ã¾ã™ã€‚</li><li><code>user.email</code> å±æ€§ã‚’<strong>ãƒãƒƒã‚·ãƒ¥åŒ–</strong>ã—ã¦ã€å…ƒã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒå…¬é–‹ã•ã‚Œãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚</li><li><code>user.password</code> å±æ€§ã‚’<strong>å‰Šé™¤</strong>ã—ã¦ã€Spanã‹ã‚‰å®Œå…¨ã«å–ã‚Šé™¤ãã¾ã™ã€‚</li></ol><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>attributes/update</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>actions</span><span class=p>:</span><span class=w>                           </span><span class=c># Actions</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.phone_number        </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>update                </span><span class=w> </span><span class=c># Update action</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>value</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;UNKNOWN NUMBER&#34;</span><span class=w>        </span><span class=c># New value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.email               </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>hash                  </span><span class=w> </span><span class=c># Hash the email value</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.password            </span><span class=w> </span><span class=c># Target key</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>action</span><span class=p>:</span><span class=w> </span><span class=l>delete                </span><span class=w> </span><span class=c># Delete the password</span></span></span></code></pre></div><p><strong>2. <code>redaction</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¿½åŠ ã™ã‚‹</strong>ï¼š<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/redactionprocessor rel=external><strong>Redaction Processor</strong></a> ã¯ã€ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã‚„ãã®ä»–ã®å€‹äººè­˜åˆ¥æƒ…å ±ï¼ˆPIIï¼‰ãªã©ã®å®šç¾©æ¸ˆã¿ãƒ‘ã‚¿ãƒ¼ãƒ³ã«åŸºã¥ã„ã¦ã€Spanå±æ€§å†…ã®æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’æ¤œå‡ºã—ã¦ç§˜åŒ¿åŒ–ã—ã¾ã™ã€‚</p><p>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã¯</p><ul><li><p>ã™ã¹ã¦ã®å±æ€§ãŒå‡¦ç†ã•ã‚Œã‚‹ã‚ˆã†ã« <code>allow_all_keys: true</code> ã‚’è¨­å®šã—ã¾ã™ï¼ˆ<code>false</code> ã«è¨­å®šã™ã‚‹ã¨ã€æ˜ç¤ºçš„ã«è¨±å¯ã•ã‚ŒãŸã‚­ãƒ¼ã®ã¿ãŒä¿æŒã•ã‚Œã¾ã™ï¼‰ã€‚</p></li><li><p><strong>Visa</strong> ã¨ <strong>MasterCard</strong> ã®ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·ã‚’æ¤œå‡ºã—ã¦ç§˜åŒ¿åŒ–ã™ã‚‹ãŸã‚ã®æ­£è¦è¡¨ç¾ã‚’ <code>blocked_values</code> ã§å®šç¾©ã—ã¾ã™ã€‚</p></li><li><p><code>summary: debug</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã€ãƒ‡ãƒãƒƒã‚°ç›®çš„ã§ç§˜åŒ¿åŒ–ãƒ—ãƒ­ã‚»ã‚¹ã«é–¢ã™ã‚‹è©³ç´°æƒ…å ±ã‚’ãƒ­ã‚°ã«è¨˜éŒ²ã—ã¾ã™ã€‚</p></li></ul><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>redaction/redact</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>allow_all_keys</span><span class=p>:</span><span class=w> </span><span class=kc>true</span><span class=w>               </span><span class=c># If false, only allowed keys will be retained</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>blocked_values</span><span class=p>:</span><span class=w>                    </span><span class=c># List of regex patterns to block</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;\b4[0-9]{3}[\s-]?[0-9]{4}[\s-]?[0-9]{4}[\s-]?[0-9]{4}\b&#39;</span><span class=w>       </span><span class=c># Visa</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s1>&#39;\b5[1-5][0-9]{2}[\s-]?[0-9]{4}[\s-]?[0-9]{4}[\s-]?[0-9]{4}\b&#39;</span><span class=w>  </span><span class=c># MasterCard</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>summary</span><span class=p>:</span><span class=w> </span><span class=l>debug                    </span><span class=w> </span><span class=c># Show debug details about redaction</span></span></span></code></pre></div><p><strong><code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ›´æ–°ã™ã‚‹</strong>ï¼šä¸¡æ–¹ã®ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’ <code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«çµ±åˆã—ã¾ã™ã€‚æœ€åˆã¯ redaction ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠã„ã¦ãã ã•ã„ï¼ˆå¾Œã®æ¼”ç¿’ã§æœ‰åŠ¹ã«ã—ã¾ã™ï¼‰ã€‚è¨­å®šã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- redaction/redact               # Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div></div></details><p><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦Agentè¨­å®šã‚’æ¤œè¨¼ã—ã¾ã™ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>traces:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRML(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRRD(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
      PRRS(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRUP(attributes&lt;br&gt;fa:fa-microchip&lt;br&gt;update):::processor
      EXP1(otlphttp&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;ensp;&amp;ensp;debug&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP3(file&lt;br&gt;fa:fa-upload):::exporter

    %% Links
    subID1:::sub-traces
    subgraph &#34; &#34;
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRML
      PRML --&gt; PRUP
      PRUP --&gt; PRRD
      PRRD --&gt; PRRS
      PRRS --&gt; EXP2
      PRRS --&gt; EXP3
      PRRS --&gt; EXP1
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=42-attribute-processorã®ãƒ†ã‚¹ãƒˆ>4.2 Attribute Processorã®ãƒ†ã‚¹ãƒˆ</h1><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<strong>Agent</strong> ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å‰ã«ã€Spanãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ <code>user.account_password</code> ã‚’<strong>å‰Šé™¤</strong>ã—ã€<code>user.phone_number</code> <strong>å±æ€§</strong>ã‚’<strong>æ›´æ–°</strong>ã—ã€<code>user.email</code> ã‚’<strong>ãƒãƒƒã‚·ãƒ¥åŒ–</strong>ã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gatewayã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Gateway</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div><p><strong>Agentã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Agent</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div><p><strong>Load Generatorã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <code>loadgen</code> ã‚’èµ·å‹•ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p><strong>ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ã€<code>user.account_password</code> ãŒå‰Šé™¤ã•ã‚Œã€<code>user.phone_number</code> ã¨ <code>user.email</code> ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-406b970cbbd23518f21673ecf36cb768><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-216dfb86341bef4177c4a69a505be41c aria-expanded=true data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-406b970cbbd23518f21673ecf36cb768","R-tab-544b1806b43b802fec2d6ad565a4b9ad")'>
<span class=tab-nav-text>New Debug Output</span>
</button>
<button aria-controls=R-tab-id-b18d84523cb241ffef4d0319bff75c9e aria-expanded=false data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-406b970cbbd23518f21673ecf36cb768","R-tab-8269dab52767aefab4c11aaa5d8bb8c8")'>
<span class=tab-nav-text>Original Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-216dfb86341bef4177c4a69a505be41c data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>   -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(UNKNOWN NUMBER)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(51.71)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(5555 5555 5555 4444)</span></span></code></pre></div></div></div><div id=R-tab-id-b18d84523cb241ffef4d0319bff75c9e data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>    -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>    -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>    -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>    -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>    -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>    -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>    -&gt; payment.amount: Double(95.22)</span></span></code></pre></div></div></div></div></div><p><strong>ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<code>jq</code> ã‚’ä½¿ç”¨ã—ã¦ã€<code>gateway-traces.out</code> ã§ <code>user.account_password</code> ãŒå‰Šé™¤ã•ã‚Œã€<code>user.phone_number</code> ã¨ <code>user.email</code> ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-7f7dfa5713b29093bfe426981a5fde13><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-214a983d99cd88ea2c06bd942a0d94ce aria-expanded=true data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-7f7dfa5713b29093bfe426981a5fde13","R-tab-a1f23743b82743728073a9be5706f4e0")'>
<span class=tab-nav-text>Validate attribute changes</span>
</button>
<button aria-controls=R-tab-id-75548e5ef4e15d2f948e03200afea398 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-7f7dfa5713b29093bfe426981a5fde13","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-214a983d99cd88ea2c06bd942a0d94ce data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[].attributes[] | select(.key == &#34;user.password&#34; or .key == &#34;user.phone_number&#34; or .key == &#34;user.email&#34;) | {key: .key, value: .value.stringValue}&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-75548e5ef4e15d2f948e03200afea398 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><code>user.account_password</code> ãŒå‰Šé™¤ã•ã‚Œã€<code>user.phone_number</code> ã¨ <code>user.email</code> ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«æ³¨ç›®ã—ã¦ãã ã•ã„</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.phone_number&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;UNKNOWN NUMBER&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.email&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=43-redaction-processorã®ãƒ†ã‚¹ãƒˆ>4.3 Redaction Processorã®ãƒ†ã‚¹ãƒˆ</h1><p><code>redaction</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã¯ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ¼ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã©ã®å±æ€§ã¨å€¤ã‚’<strong>è¨±å¯</strong>ã¾ãŸã¯<strong>å‰Šé™¤</strong>ã™ã‚‹ã‹ã‚’æ­£ç¢ºã«åˆ¶å¾¡ã§ãã¾ã™ã€‚</p><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<strong>Agent</strong> ãŒã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å‰ã«ã€Spanãƒ‡ãƒ¼ã‚¿ã® <code>user.visa</code> ã¨ <code>user.mastercard</code> ã®å€¤ã‚’<strong>ç§˜åŒ¿åŒ–</strong>ã—ã¾ã™ã€‚<details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gatewayã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Gateway</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div><p><strong><code>redaction/redact</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’æœ‰åŠ¹ã«ã™ã‚‹</strong>ï¼š<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€<code>agent.yaml</code> ã‚’ç·¨é›†ã—ã¦å‰ã®æ¼”ç¿’ã§è¿½åŠ ã—ãŸ <code>#</code> ã‚’å‰Šé™¤ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div><p><strong>Agentã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Agent</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div><p><strong>Load Generatorã‚’èµ·å‹•ã™ã‚‹</strong>ï¼š<strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <code>loadgen</code> ã‚’èµ·å‹•ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p><strong>ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ã€<code>user.visa</code> ã¨ <code>user.mastercard</code> ã®å€¤ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚<code>user.amex</code> å±æ€§ã®å€¤ã¯ã€<code>blocked_values</code> ã«ä¸€è‡´ã™ã‚‹æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ç§˜åŒ¿åŒ–ã•ã‚Œã¦<strong>ã„ãªã„</strong>ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</p><div class=tab-panel data-tab-group=R-tabs-4bdb6de57a8b5c343924dba207149d62><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1e72c9b0bf6e3c88f908ef6a2621a9ba aria-expanded=true data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4bdb6de57a8b5c343924dba207149d62","R-tab-544b1806b43b802fec2d6ad565a4b9ad")'>
<span class=tab-nav-text>New Debug Output</span>
</button>
<button aria-controls=R-tab-id-df3994adec6f22a9473b1a8e0c773058 aria-expanded=false data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-4bdb6de57a8b5c343924dba207149d62","R-tab-8269dab52767aefab4c11aaa5d8bb8c8")'>
<span class=tab-nav-text>Original Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-1e72c9b0bf6e3c88f908ef6a2621a9ba data-tab-item=R-tab-544b1806b43b802fec2d6ad565a4b9ad class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>   -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>   -&gt; user.phone_number: Str(UNKNOWN NUMBER)
</span></span><span class=line><span class=cl>   -&gt; user.email: Str(62d5e03d8fd5808e77aee5ebbd90cf7627a470ae0be9ffd10e8025a4ad0e1287)
</span></span><span class=line><span class=cl>   -&gt; payment.amount: Double(69.71)
</span></span><span class=line><span class=cl>   -&gt; user.visa: Str(****)
</span></span><span class=line><span class=cl>   -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>   -&gt; user.mastercard: Str(****)
</span></span><span class=line><span class=cl>   -&gt; redaction.masked.keys: Str(user.mastercard,user.visa)
</span></span><span class=line><span class=cl>   -&gt; redaction.masked.count: Int(2)</span></span></code></pre></div></div></div><div id=R-tab-id-df3994adec6f22a9473b1a8e0c773058 data-tab-item=R-tab-8269dab52767aefab4c11aaa5d8bb8c8 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>    -&gt; user.name: Str(George Lucas)
</span></span><span class=line><span class=cl>    -&gt; user.phone_number: Str(+1555-867-5309)
</span></span><span class=line><span class=cl>    -&gt; user.email: Str(george@deathstar.email)
</span></span><span class=line><span class=cl>    -&gt; user.password: Str(LOTR&gt;StarWars1-2-3)
</span></span><span class=line><span class=cl>    -&gt; user.visa: Str(4111 1111 1111 1111)
</span></span><span class=line><span class=cl>    -&gt; user.amex: Str(3782 822463 10005)
</span></span><span class=line><span class=cl>    -&gt; user.mastercard: Str(5555 5555 5555 4444)
</span></span><span class=line><span class=cl>    -&gt; payment.amount: Double(65.54)</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices note"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-exclamation-circle"></i>
ãƒ¡ãƒ¢</summary><div class=box-content><p>redaction ãƒ—ãƒ­ã‚»ãƒƒã‚µã« <code>summary:debug</code> ã‚’å«ã‚ã‚‹ã¨ã€ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã«ã€ã©ã®ä¸€è‡´ã™ã‚‹ã‚­ãƒ¼å€¤ãŒç§˜åŒ¿åŒ–ã•ã‚ŒãŸã‹ã€ãŠã‚ˆã³ãƒã‚¹ã‚¯ã•ã‚ŒãŸå€¤ã®æ•°ã«é–¢ã™ã‚‹ã‚µãƒãƒªãƒ¼æƒ…å ±ãŒå«ã¾ã‚Œã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>     -&gt; redaction.masked.keys: Str(user.mastercard,user.visa)
</span></span><span class=line><span class=cl>     -&gt; redaction.masked.count: Int(2)</span></span></code></pre></div></div></details><p><strong>ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>ï¼š<code>jq</code> ã‚’ä½¿ç”¨ã—ã¦ã€<code>gateway-traces.out</code> ã§ <code>user.visa</code> ã¨ <code>user.mastercard</code> ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚</p><div class=tab-panel data-tab-group=R-tabs-80f70629a1640437ec6e047fba88fdbb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-27124e6056028914ae6450bff28f5265 aria-expanded=true data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-80f70629a1640437ec6e047fba88fdbb","R-tab-a1f23743b82743728073a9be5706f4e0")'>
<span class=tab-nav-text>Validate attribute changes</span>
</button>
<button aria-controls=R-tab-id-05101ce54417a0dc825ef92b86b8222b aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-80f70629a1640437ec6e047fba88fdbb","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-27124e6056028914ae6450bff28f5265 data-tab-item=R-tab-a1f23743b82743728073a9be5706f4e0 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceSpans[].scopeSpans[].spans[].attributes[] | select(.key == &#34;user.visa&#34; or .key == &#34;user.mastercard&#34; or .key == &#34;user.amex&#34;) | {key: .key, value: .value.stringValue}&#39;</span> ./gateway-traces.out</span></span></code></pre></div></div></div><div id=R-tab-id-05101ce54417a0dc825ef92b86b8222b data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><p><code>blocked_values</code> ã«ä¸€è‡´ã™ã‚‹æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¿½åŠ ã•ã‚Œã¦ã„ãªã„ãŸã‚ã€<code>user.amex</code> ã¯ç§˜åŒ¿åŒ–ã•ã‚Œã¦ã„ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.visa&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;****&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.amex&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;3782 822463 10005&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;key&#34;</span><span class=p>:</span> <span class=s2>&#34;user.mastercard&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;****&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>ã“ã‚Œã‚‰ã¯ã€<code>attributes</code> ã¨ <code>redaction</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µã‚’è¨­å®šã—ã¦æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’ä¿è­·ã™ã‚‹æ–¹æ³•ã®ã»ã‚“ã®ä¸€ä¾‹ã§ã™ã€‚</p></div></details></p><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ãƒ—ãƒ­ã‚»ã‚¹ã‚’ã€ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=5-transform-data>5. Transform Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p><a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/main/processor/transformprocessor/README.md rel=external><strong>Transform Processor</strong></a> ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æµã‚Œã‚‹ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ­ã‚°ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ï¼‰ã‚’å¤‰æ›´ã§ãã¾ã™ã€‚<strong>OpenTelemetry Transformation Language (OTTL)</strong> ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãªãã€ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¨ãƒ³ãƒªãƒƒãƒãƒ¡ãƒ³ãƒˆã€å¤‰æ›ã‚’ãã®å ´ã§è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚</p><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<code>gateway.yaml</code> ã‚’æ›´æ–°ã—ã¦ã€æ¬¡ã®å‡¦ç†ã‚’è¡Œã† <strong>Transform Processor</strong> ã‚’è¿½åŠ ã—ã¾ã™</p><ul><li>ãƒ­ã‚°ãƒªã‚½ãƒ¼ã‚¹å±æ€§ã® <strong>ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°</strong></li><li>JSONæ§‹é€ åŒ–ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ã®å±æ€§ã¸ã® <strong>ãƒ‘ãƒ¼ã‚¹</strong></li><li>ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æœ¬æ–‡ã«åŸºã¥ããƒ­ã‚°é‡å¤§åº¦ãƒ¬ãƒ™ãƒ«ã® <strong>è¨­å®š</strong></li></ul><p>ä»¥å‰ã®ãƒ­ã‚°ã§ <code>SeverityText</code> ã‚„ <code>SeverityNumber</code> ãŒæœªå®šç¾©ã ã£ãŸã“ã¨ã«ãŠæ°—ã¥ãã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã“ã‚Œã¯ <code>filelog</code> ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã®å…¸å‹çš„ãªå‹•ä½œã§ã™ã€‚ãŸã ã—ã€é‡å¤§åº¦ã¯ãƒ­ã‚°æœ¬æ–‡å†…ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä¾‹</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>SeverityText:
</span></span><span class=line><span class=cl>SeverityNumber: Unspecified(0)
</span></span><span class=line><span class=cl>Body: Str(2025-01-31 15:49:29 [WARN] - Do or do not, there is no try.)</span></span></code></pre></div><p>ãƒ­ã‚°ã«ã¯ã€ãƒ­ã‚°æœ¬æ–‡å†…ã«JSONã¨ã—ã¦ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å±æ€§ã¨ã—ã¦æŠ½å‡ºã™ã‚‹ã“ã¨ã§ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¯ã‚¨ãƒªã®åŠ¹ç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚ä¸‹æµã®ã‚·ã‚¹ãƒ†ãƒ ã§æ‰‹å‹•ã§JSONã‚’ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ä»£ã‚ã‚Šã«ã€OTTLã‚’ä½¿ç”¨ã—ã¦ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãƒ¬ãƒ™ãƒ«ã§è‡ªå‹•çš„ã«å¤‰æ›ã§ãã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>ã™ã¹ã¦ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>5-transform-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p><code>4-sensitve-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ <code>*.yaml</code> ã‚’ <code>5-transform-data</code> ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚æ›´æ–°å¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-44c8ca06f59e8d04bf849fd2d3c07220><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3051c31b53940887b53c37f67b6a3ee6 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-44c8ca06f59e8d04bf849fd2d3c07220","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-3051c31b53940887b53c37f67b6a3ee6 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>5. Transform Dataã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=51-configuration>5.1 Configuration</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong><code>transform</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã‚’è¿½åŠ ã™ã‚‹</strong>: <strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ‡ã‚Šæ›¿ãˆã€<code>gateway.yaml</code> ã‚’ç·¨é›†ã—ã¦æ¬¡ã® <code>transform</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã‚’è¿½åŠ ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>transform/logs</span><span class=p>:</span><span class=w>                      </span><span class=c># Processor Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>log_statements</span><span class=p>:</span><span class=w>                    </span><span class=c># Log Processing Statements</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>context</span><span class=p>:</span><span class=w> </span><span class=l>resource             </span><span class=w> </span><span class=c># Log Context</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>statements</span><span class=p>:</span><span class=w>                    </span><span class=c># List of attribute keys to keep</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>keep_keys(attributes, [&#34;com.splunk.sourcetype&#34;, &#34;host.name&#34;, &#34;otelcol.service.mode&#34;])</span></span></span></code></pre></div><p><code>-context: resource</code> ã‚­ãƒ¼ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ãƒ­ã‚°ã® <code>resourceLog</code> å±æ€§ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ã¦ã„ã¾ã™ã€‚</p><p>ã“ã®è¨­å®šã«ã‚ˆã‚Šã€é–¢é€£ã™ã‚‹ãƒªã‚½ãƒ¼ã‚¹å±æ€§ï¼ˆ<code>com.splunk.sourcetype</code>ã€<code>host.name</code>ã€<code>otelcol.service.mode</code>ï¼‰ã®ã¿ãŒä¿æŒã•ã‚Œã€ãƒ­ã‚°ã®åŠ¹ç‡ãŒå‘ä¸Šã—ã€ä¸è¦ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒå‰Šæ¸›ã•ã‚Œã¾ã™ã€‚</p><p><strong>ãƒ­ã‚°é‡å¤§åº¦ãƒãƒƒãƒ”ãƒ³ã‚°ç”¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ ã™ã‚‹</strong>: ãƒ­ã‚°ãƒ¬ã‚³ãƒ¼ãƒ‰ã® <code>severity_text</code> ã¨ <code>severity_number</code> ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é©åˆ‡ã«è¨­å®šã™ã‚‹ãŸã‚ã«ã€<code>log_statements</code> å†…ã« <code>log</code> ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã‚’è¿½åŠ ã—ã¾ã™ã€‚ã“ã®è¨­å®šã§ã¯ã€ãƒ­ã‚°æœ¬æ–‡ã‹ã‚‰ <code>level</code> å€¤ã‚’æŠ½å‡ºã—ã€<code>severity_text</code> ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã—ã€ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«ã«åŸºã¥ã„ã¦å¯¾å¿œã™ã‚‹ <code>severity_number</code> ã‚’å‰²ã‚Šå½“ã¦ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>      </span>- <span class=nt>context</span><span class=p>:</span><span class=w> </span><span class=l>log                  </span><span class=w> </span><span class=c># Log Context</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>statements</span><span class=p>:</span><span class=w>                    </span><span class=c># Transform Statements Array</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(cache, ParseJSON(body)) where IsMatch(body, &#34;^\\{&#34;) </span><span class=w> </span><span class=c># Parse JSON log body into a cache object</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>flatten(cache, &#34;&#34;)                                       </span><span class=w> </span><span class=c># Flatten nested JSON structure</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>merge_maps(attributes, cache, &#34;upsert&#34;)                  </span><span class=w> </span><span class=c># Merge cache into attributes, updating existing keys</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_text, attributes[&#34;level&#34;])                  </span><span class=w> </span><span class=c># Set severity_text from the &#34;level&#34; attribute</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 1) where severity_text == &#34;TRACE&#34;   </span><span class=w> </span><span class=c># Map severity_text to severity_number</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 5) where severity_text == &#34;DEBUG&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 9) where severity_text == &#34;INFO&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 13) where severity_text == &#34;WARN&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 17) where severity_text == &#34;ERROR&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>set(severity_number, 21) where severity_text == &#34;FATAL&#34;</span></span></span></code></pre></div><p><code>merge_maps</code> é–¢æ•°ã¯ã€2ã¤ã®ãƒãƒƒãƒ—ï¼ˆè¾æ›¸ï¼‰ã‚’1ã¤ã«çµåˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®å ´åˆã€<code>cache</code> ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆãƒ­ã‚°æœ¬æ–‡ã‹ã‚‰ãƒ‘ãƒ¼ã‚¹ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ï¼‰ã‚’ <code>attributes</code> ãƒãƒƒãƒ—ã«ãƒãƒ¼ã‚¸ã—ã¾ã™ã€‚</p><ul><li><strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</strong>:<ul><li><code>attributes</code>: ãƒ‡ãƒ¼ã‚¿ãŒãƒãƒ¼ã‚¸ã•ã‚Œã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒãƒƒãƒ—</li><li><code>cache</code>: ãƒ‘ãƒ¼ã‚¹ã•ã‚ŒãŸJSONãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ã‚½ãƒ¼ã‚¹ãƒãƒƒãƒ—</li><li><code>"upsert"</code>: ã“ã®ãƒ¢ãƒ¼ãƒ‰ã¯ã€<code>attributes</code> ãƒãƒƒãƒ—ã«ã™ã§ã«ã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€ãã®å€¤ãŒ <code>cache</code> ã®å€¤ã§æ›´æ–°ã•ã‚Œã‚‹ã“ã¨ã‚’ä¿è¨¼ã—ã¾ã™ã€‚ã‚­ãƒ¼ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ã€æŒ¿å…¥ã•ã‚Œã¾ã™ã€‚</li></ul></li></ul><p>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã€ãƒ­ã‚°æœ¬æ–‡ã‹ã‚‰ã®ã™ã¹ã¦ã®é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆä¾‹ï¼š<code>level</code>ã€<code>message</code> ãªã©ï¼‰ãŒ <code>attributes</code> ãƒãƒƒãƒ—ã«è¿½åŠ ã•ã‚Œã€ã•ã‚‰ãªã‚‹å‡¦ç†ã‚„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã§åˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã“ã¨ã‚’ä¿è¨¼ã™ã‚‹ãŸã‚ã€éå¸¸ã«é‡è¦ã§ã™ã€‚</p><p><strong>ä¸»è¦ãªå¤‰æ›ã®æ¦‚è¦</strong>:</p><ul><li><strong>Parse JSON</strong>: ãƒ­ã‚°æœ¬æ–‡ã‹ã‚‰æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã—ã¾ã™ã€‚</li><li><strong>Flatten JSON</strong>: ãƒã‚¹ãƒˆã•ã‚ŒãŸJSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ•ãƒ©ãƒƒãƒˆãªæ§‹é€ ã«å¤‰æ›ã—ã¾ã™ã€‚</li><li><strong>Merge Attributes</strong>: æŠ½å‡ºã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ­ã‚°å±æ€§ã«çµ±åˆã—ã¾ã™ã€‚</li><li><strong>Map Severity Text</strong>: ãƒ­ã‚°ã® level å±æ€§ã‹ã‚‰ severity_text ã‚’å‰²ã‚Šå½“ã¦ã¾ã™ã€‚</li><li><strong>Assign Severity Numbers</strong>: é‡å¤§åº¦ãƒ¬ãƒ™ãƒ«ã‚’æ¨™æº–åŒ–ã•ã‚ŒãŸæ•°å€¤ã«å¤‰æ›ã—ã¾ã™ã€‚</li></ul><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><code>resource</code> ç”¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã¨ <code>log</code> ç”¨ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã®2ã¤ã‚’å«ã‚€ <strong>å˜ä¸€ã®</strong> <code>transform</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ãŒå¿…è¦ã§ã™ã€‚</p></div></details><p>ã“ã®è¨­å®šã«ã‚ˆã‚Šã€ãƒ­ã‚°ã®é‡å¤§åº¦ãŒæ­£ã—ãæŠ½å‡ºã€æ¨™æº–åŒ–ã•ã‚Œã€åŠ¹ç‡çš„ãªå‡¦ç†ã®ãŸã‚ã«æ§‹é€ åŒ–ã•ã‚Œã¾ã™ã€‚</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>ã™ã¹ã¦ã®JSONãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®å±æ€§ã«ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã“ã®æ–¹æ³•ã¯ã€<strong>OTTLã®ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°</strong>ã®ã¿ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚æœ¬ç•ªç’°å¢ƒã§ã¯é«˜ã„ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ãŒç™ºç”Ÿã—ã¾ã™ã€‚</p></div></details><p><strong><code>logs</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ›´æ–°ã™ã‚‹</strong>: <code>logs:</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã« <code>transform/logs:</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã‚’è¿½åŠ ã—ã€è¨­å®šãŒæ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã‚ˆã†ã«ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>                         </span><span class=c># Logs pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp                     </span><span class=w> </span><span class=c># OTLP receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>                 </span><span class=c># Processors for logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                    </span><span class=w> </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/logs</span></span></span></code></pre></div></div></details><p><a href=https://otelbin.io/ rel=external><strong>https://otelbin.io</strong></a> ã‚’ä½¿ç”¨ã—ã¦ Agent ã®è¨­å®šã‚’æ¤œè¨¼ã—ã¾ã™ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>logs:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(transform&lt;br&gt;fa:fa-microchip&lt;br&gt;logs):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(file&lt;br&gt;fa:fa-upload&lt;br&gt;logs):::exporter
      EXP2(&amp;ensp;&amp;ensp;debug&amp;ensp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    %% Links
    subID1:::sub-logs
    subgraph &#34; &#34;
      subgraph subID1[**Logs**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PRO3
      PRO3 --&gt; PRO4
      PRO4 --&gt; PRO5
      PRO5 --&gt; EXP2
      PRO5 --&gt; EXP1
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=52-setup-environment>5.2 Setup Environment</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway ã‚’èµ·å‹•ã™ã‚‹</strong>: <strong>Gateway terminal</strong> ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-9fccbc99a2c222860a520f77d7b20b9c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e9e750ac85c979e74d570ee0ba1cef67 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-9fccbc99a2c222860a520f77d7b20b9c","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-e9e750ac85c979e74d570ee0ba1cef67 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Agent ã‚’èµ·å‹•ã™ã‚‹</strong>: <strong>Agent terminal</strong> ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-207429677621bf93566f5384deca0ca0><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-eef2223dc1e9bb1d1724d5b3a869a40f aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-207429677621bf93566f5384deca0ca0","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-eef2223dc1e9bb1d1724d5b3a869a40f data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Load Generator ã‚’èµ·å‹•ã™ã‚‹</strong>: <strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ <strong>JSON ã‚’æœ‰åŠ¹</strong>ã«ã—ãŸ Load Generator ã‚’èµ·å‹•ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-4ecacc468eeb0ef7db03d316f5ce7269><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-3ef1309b0da4645d464b855b908ff00b aria-expanded=true data-tab-item=R-tab-f39d270d077420f218253d70fb4d013a class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-4ecacc468eeb0ef7db03d316f5ce7269","R-tab-f39d270d077420f218253d70fb4d013a")'>
<span class=tab-nav-text>Log Generator</span></button></div><div class=tab-content-container><div id=R-tab-id-3ef1309b0da4645d464b855b908ff00b data-tab-item=R-tab-f39d270d077420f218253d70fb4d013a class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -logs -json -count <span class=m>5</span></span></span></code></pre></div></div></div></div></div><p><code>loadgen</code> ã¯ JSON å½¢å¼ã§ 5 è¡Œã®ãƒ­ã‚°ã‚’ <code>./quotes.log</code> ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=53-test-transform-processor>5.3 Test Transform Processor</h1><p>ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€<strong>Agent</strong> ã«ã‚ˆã£ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã•ã‚Œã‚‹å‰ã«ã€<code>com.splunk/source</code> ã¨ <code>os.type</code> ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒãƒ­ã‚°ãƒªã‚½ãƒ¼ã‚¹å±æ€§ã‹ã‚‰ <strong>å‰Šé™¤</strong> ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã•ã‚‰ã«ã€ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ä»¥ä¸‹ã‚’ç¢ºèªã—ã¾ã™</p><ol><li>é‡å¤§åº¦æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ãƒ­ã‚°æœ¬æ–‡ãŒãƒ‘ãƒ¼ã‚¹ã•ã‚Œã¦ã„ã‚‹ã“ã¨<ul><li><code>SeverityText</code> ã¨ <code>SeverityNumber</code> ãŒ <code>LogRecord</code> ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨</li></ul></li><li>ãƒ­ã‚°æœ¬æ–‡ã® JSON ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒ­ã‚° <code>attributes</code> ã«æ˜‡æ ¼ã—ã¦ã„ã‚‹ã“ã¨</li></ol><p>ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‰ã«é©åˆ‡ãªãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€é‡å¤§åº¦ãƒãƒƒãƒ”ãƒ³ã‚°ã€ãŠã‚ˆã³æ§‹é€ åŒ–ãƒ­ã‚°ã®ã‚¨ãƒ³ãƒªãƒƒãƒãƒ¡ãƒ³ãƒˆãŒè¡Œã‚ã‚Œã‚‹ã“ã¨ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>ãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>: <strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ã€<code>com.splunk/source</code> ã¨ <code>os.type</code> ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-a544c18b8726fa9a36c73be428c1d8ca><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f415c8297e0c47b87d028ee4a08304c7 aria-expanded=true data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a544c18b8726fa9a36c73be428c1d8ca","R-tab-e35301d59bcd0f79d44c5c0a86f077c6")'>
<span class=tab-nav-text>Gateway Debug Output</span>
</button>
<button aria-controls=R-tab-id-7dbf3d3aa7795573b399bde5763d15ce aria-expanded=false data-tab-item=R-tab-42538fea3c4f3a8e2d3b752dbdb349e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-a544c18b8726fa9a36c73be428c1d8ca","R-tab-42538fea3c4f3a8e2d3b752dbdb349e9")'>
<span class=tab-nav-text>Agent Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-f415c8297e0c47b87d028ee4a08304c7 data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Resource attributes:
</span></span><span class=line><span class=cl>   -&gt; com.splunk.sourcetype: Str(quotes)
</span></span><span class=line><span class=cl>   -&gt; host.name: Str(workshop-instance)
</span></span><span class=line><span class=cl>   -&gt; otelcol.service.mode: Str(agent)</span></span></code></pre></div></div></div><div id=R-tab-id-7dbf3d3aa7795573b399bde5763d15ce data-tab-item=R-tab-42538fea3c4f3a8e2d3b752dbdb349e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Resource attributes:
</span></span><span class=line><span class=cl>   -&gt; com.splunk.source: Str(./quotes.log)
</span></span><span class=line><span class=cl>   -&gt; com.splunk.sourcetype: Str(quotes)
</span></span><span class=line><span class=cl>   -&gt; host.name: Str(workshop-instance)
</span></span><span class=line><span class=cl>   -&gt; os.type: Str(linux)
</span></span><span class=line><span class=cl>   -&gt; otelcol.service.mode: Str(agent)</span></span></code></pre></div></div></div></div></div><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ã€<code>LogRecord</code> ã® <code>SeverityText</code> ã¨ <code>SeverityNumber</code> ãŒãƒ­ã‚°æœ¬æ–‡ã®é‡å¤§åº¦ <code>level</code> ã§å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚ã¾ãŸã€æœ¬æ–‡ã® JSON ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ã®ãƒ­ã‚° <code>Attributes</code> ã¨ã—ã¦ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-742a54904271bdb75f36ed4a0e02cb5d><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6656f4b5bd1954ebc63239714e173ca6 aria-expanded=true data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-742a54904271bdb75f36ed4a0e02cb5d","R-tab-e35301d59bcd0f79d44c5c0a86f077c6")'>
<span class=tab-nav-text>Gateway Debug Output</span>
</button>
<button aria-controls=R-tab-id-11ca96a9897591178068929876157ddb aria-expanded=false data-tab-item=R-tab-ead80b063f3a982e1fec2398ed5eb0e3 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-742a54904271bdb75f36ed4a0e02cb5d","R-tab-ead80b063f3a982e1fec2398ed5eb0e3")'>
<span class=tab-nav-text>Agemt Debug Output</span></button></div><div class=tab-content-container><div id=R-tab-id-6656f4b5bd1954ebc63239714e173ca6 data-tab-item=R-tab-e35301d59bcd0f79d44c5c0a86f077c6 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>SeverityText: WARN
</span></span><span class=line><span class=cl>SeverityNumber: Warn(13)
</span></span><span class=line><span class=cl>Body: Str({&#34;level&#34;:&#34;WARN&#34;,&#34;message&#34;:&#34;Your focus determines your reality.&#34;,&#34;movie&#34;:&#34;SW&#34;,&#34;timestamp&#34;:&#34;2025-03-07 11:17:26&#34;})
</span></span><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; log.file.path: Str(quotes.log)
</span></span><span class=line><span class=cl>     -&gt; level: Str(WARN)
</span></span><span class=line><span class=cl>     -&gt; message: Str(Your focus determines your reality.)
</span></span><span class=line><span class=cl>     -&gt; movie: Str(SW)
</span></span><span class=line><span class=cl>     -&gt; timestamp: Str(2025-03-07 11:17:26)
</span></span><span class=line><span class=cl>&lt;/snip&gt;</span></span></code></pre></div></div></div><div id=R-tab-id-11ca96a9897591178068929876157ddb data-tab-item=R-tab-ead80b063f3a982e1fec2398ed5eb0e3 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>&lt;snip&gt;
</span></span><span class=line><span class=cl>SeverityText:
</span></span><span class=line><span class=cl>SeverityNumber: Unspecified(0)
</span></span><span class=line><span class=cl>Body: Str({&#34;level&#34;:&#34;WARN&#34;,&#34;message&#34;:&#34;Your focus determines your reality.&#34;,&#34;movie&#34;:&#34;SW&#34;,&#34;timestamp&#34;:&#34;2025-03-07 11:17:26&#34;})
</span></span><span class=line><span class=cl>Attributes:
</span></span><span class=line><span class=cl>     -&gt; log.file.path: Str(quotes.log)
</span></span><span class=line><span class=cl>&lt;/snip&gt;</span></span></code></pre></div></div></div></div></div><p><strong>ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›ã‚’ç¢ºèªã™ã‚‹</strong>: æ–°ã—ã„ <code>gateway-logs.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ‡ãƒ¼ã‚¿ãŒå¤‰æ›ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-b0a52ca53be3519245f0242f3d3c3469><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-6c534b32bd4a2c7346ed73dde8826e0c aria-expanded=true data-tab-item=R-tab-58659ac8bbb7a3ec80b7df1029812298 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b0a52ca53be3519245f0242f3d3c3469","R-tab-58659ac8bbb7a3ec80b7df1029812298")'>
<span class=tab-nav-text>jq Query</span>
</button>
<button aria-controls=R-tab-id-8fe9a35cbfa07f16d64bede9f5239e43 aria-expanded=false data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-b0a52ca53be3519245f0242f3d3c3469","R-tab-4c50e65a8a1f9aa989870396b5c0a12b")'>
<span class=tab-nav-text>Example Output</span></button></div><div class=tab-content-container><div id=R-tab-id-6c534b32bd4a2c7346ed73dde8826e0c data-tab-item=R-tab-58659ac8bbb7a3ec80b7df1029812298 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;[.resourceLogs[].scopeLogs[].logRecords[] | {severityText, severityNumber, body: .body.stringValue}]&#39;</span> gateway-logs.out</span></span></code></pre></div></div></div><div id=R-tab-id-8fe9a35cbfa07f16d64bede9f5239e43 data-tab-item=R-tab-4c50e65a8a1f9aa989870396b5c0a12b class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;DEBUG&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;DEBUG\&#34;,\&#34;message\&#34;:\&#34;All we have to decide is what to do with the time that is given us.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;WARN&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>13</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;WARN\&#34;,\&#34;message\&#34;:\&#34;The Force will be with you. Always.\&#34;,\&#34;movie\&#34;:\&#34;SW\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;ERROR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>17</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;ERROR\&#34;,\&#34;message\&#34;:\&#34;One does not simply walk into Mordor.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;DEBUG&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;DEBUG\&#34;,\&#34;message\&#34;:\&#34;Do or do not, there is no try.\&#34;,\&#34;movie\&#34;:\&#34;SW\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityText&#34;</span><span class=p>:</span> <span class=s2>&#34;ERROR&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;severityNumber&#34;</span><span class=p>:</span> <span class=mi>17</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;body&#34;</span><span class=p>:</span> <span class=s2>&#34;{\&#34;level\&#34;:\&#34;ERROR\&#34;,\&#34;message\&#34;:\&#34;There is some good in this world, and it&#39;s worth fighting for.\&#34;,\&#34;movie\&#34;:\&#34;LOTR\&#34;,\&#34;timestamp\&#34;:\&#34;2025-03-07 11:56:29\&#34;}&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>]</span></span></span></code></pre></div></div></div></div></div></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p>ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦ã€<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=6-routing-data>6. Routing Data</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>OpenTelemetry ã® <a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/routingconnector rel=external><strong>Routing Connector</strong></a> ã¯ã€ç‰¹å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ï¼ˆ<code>traces</code>ã€<code>metrics</code>ã€ã¾ãŸã¯ <code>logs</code>ï¼‰ã‚’ç•°ãªã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³/å®›å…ˆã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹å¼·åŠ›ãªæ©Ÿèƒ½ã§ã™ã€‚ã“ã‚Œã¯ã€ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã«ç•°ãªã‚‹å‡¦ç†ã‚„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ­ã‚¸ãƒƒã‚¯ã‚’é©ç”¨ã—ãŸã„å ´åˆã«ç‰¹ã«æœ‰ç”¨ã§ã™ã€‚</p><p>ä¾‹ãˆã°ã€<em>æœ¬ç•ªç’°å¢ƒ</em> ã®ãƒ‡ãƒ¼ã‚¿ã‚’1ã¤ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã«é€ä¿¡ã—ã€<em>ãƒ†ã‚¹ãƒˆ</em> ã‚„ <em>é–‹ç™º</em> ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ¥ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã«æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åŒæ§˜ã«ã€ã‚µãƒ¼ãƒ“ã‚¹åã€ç’°å¢ƒã€ã‚¹ãƒ‘ãƒ³åãªã©ã®å±æ€§ã«åŸºã¥ã„ã¦ç‰¹å®šã®ã‚¹ãƒ‘ãƒ³ã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã€ã‚«ã‚¹ã‚¿ãƒ ã®å‡¦ç†ã‚„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ­ã‚¸ãƒƒã‚¯ã‚’é©ç”¨ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>ã™ã¹ã¦ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>6-routing-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p><code>5-transform-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ <code>*.yaml</code> ã‚’ <code>6-routing-data</code> ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚æ›´æ–°å¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-b6b027a9581e46681446e4217e024d73><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-71924d66fa619961b4853301a2c30599 aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b6b027a9581e46681446e4217e024d73","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-71924d66fa619961b4853301a2c30599 data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div></div></details><p>æ¬¡ã«ã€Routing Connector ã¨ãã‚Œãã‚Œã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¨­å®šã—ã¾ã™ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>6. Routing Dataã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=61-configure-the-routing-connector>6.1 Configure the Routing Connector</h1><p>ã“ã®æ¼”ç¿’ã§ã¯ã€<code>gateway.yaml</code> ã§ <strong>Routing Connector</strong> ã‚’è¨­å®šã—ã¾ã™ã€‚Routing Connector ã¯ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒˆãƒ¬ãƒ¼ã‚¹ã€ãƒ­ã‚°ã‚’ä»»æ„ã®å±æ€§ã«åŸºã¥ã„ã¦ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ãã¾ã™ãŒã€ã“ã“ã§ã¯ <code>deployment.environment</code> å±æ€§ã«åŸºã¥ããƒˆãƒ¬ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ç„¦ç‚¹ã‚’å½“ã¦ã¾ã™ï¼ˆãŸã ã—ã€ä»»æ„ã®ã‚¹ãƒ‘ãƒ³/ãƒ­ã‚°/ãƒ¡ãƒˆãƒªã‚¯ã‚¹å±æ€§ã‚’ä½¿ç”¨ã§ãã¾ã™ï¼‰ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>æ–°ã—ã„ <code>file</code> ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã‚’è¿½åŠ ã™ã‚‹</strong>: <code>routing</code> ã‚³ãƒã‚¯ã‚¿ãƒ¼ã«ã¯ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç”¨ã«ç•°ãªã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒå¿…è¦ã§ã™ã€‚<strong>Gateway terminal</strong> ã§ã€<code>gateway.yaml</code> ã® <code>exporters</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« 2 ã¤ã®æ–°ã—ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ <code>file/traces/route1-regular</code> ã¨ <code>file/traces/route2-security</code> ã‚’ä½œæˆã—ã€ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãæŒ¯ã‚Šåˆ†ã‘ã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces/route1-regular</span><span class=p>:</span><span class=w>                     </span><span class=c># Exporter for regular traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces-route1-regular.out&#34;</span><span class=w>   </span><span class=c># Path for saving trace data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                                 </span><span class=c># Overwrite the file each time</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file/traces/route2-security</span><span class=p>:</span><span class=w>                    </span><span class=c># Exporter for security traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;./gateway-traces-route2-security.out&#34;</span><span class=w>  </span><span class=c># Path for saving trace data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>append</span><span class=p>:</span><span class=w> </span><span class=kc>false</span><span class=w>                                 </span><span class=c># Overwrite the file each time</span></span></span></code></pre></div><p><strong>ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æœ‰åŠ¹ã«ã™ã‚‹</strong>: <code>routing</code> ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’è¿½åŠ ã—ã¾ã™ã€‚OpenTelemetry ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§ã¯ã€<code>connectors</code> ã¯ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã‚„ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã¨åŒæ§˜ã«å°‚ç”¨ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’æŒã£ã¦ã„ã¾ã™ã€‚</p><p><code>#connectors:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¦‹ã¤ã‘ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚’è§£é™¤ã—ã¾ã™ã€‚æ¬¡ã«ã€<code>connectors:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ä¸‹ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>routing</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>default_pipelines</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>traces/route1-regular] </span><span class=w> </span><span class=c># Default pipeline if no rule matches</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>error_mode</span><span class=p>:</span><span class=w> </span><span class=l>ignore                         </span><span class=w> </span><span class=c># Ignore errors in routing</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>table</span><span class=p>:</span><span class=w>                                      </span><span class=c># Define routing rules</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># Routes spans to a target pipeline if the resourceSpan attribute matches the rule</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>statement</span><span class=p>:</span><span class=w> </span><span class=l>route() where attributes[&#34;deployment.environment&#34;] == &#34;security-applications&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>pipelines</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=l>traces/route2-security]    </span><span class=w> </span><span class=c># Security target pipeline</span></span></span></code></pre></div></div></details><p>è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€ã‚­ãƒ£ãƒƒãƒã‚ªãƒ¼ãƒ«ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ«ãƒ¼ãƒ«ã«ä¸€è‡´ã—ãªã„ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆã“ã®å ´åˆã¯ã‚¹ãƒ‘ãƒ³ï¼‰ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å…ˆã¨ãªã‚Šã¾ã™ã€‚ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¯ã€<code>["deployment.environment"] == "security-applications"</code> ãƒ«ãƒ¼ãƒ«ã«ä¸€è‡´ã™ã‚‹ã‚¹ãƒ‘ãƒ³ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒå®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><p><code>routing</code> ã®è¨­å®šãŒå®Œäº†ã—ãŸã‚‰ã€æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã™ã‚‹ <code>pipelines</code> ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã™ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=62-configuring-the-pipelines>6.2 Configuring the Pipelines</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>å…ƒã® <code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ã«æ›´æ–°ã™ã‚‹</strong>:</p><ol><li><p><code>routing</code> ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ã€å…ƒã® <code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ›´æ–°ã—ã¦ã€<code>routing</code> ã®ã¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ä½¿ç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã™ã¹ã¦ã®ã‚¹ãƒ‘ãƒ³ãƒ‡ãƒ¼ã‚¿ãŒ <strong>Routing Connector</strong> ã‚’çµŒç”±ã—ã¦è©•ä¾¡ã•ã‚Œã€æ¥ç¶šã•ã‚ŒãŸãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«è»¢é€ã•ã‚Œã¾ã™ã€‚ã¾ãŸã€<strong>ã™ã¹ã¦ã®</strong> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã‚’å‰Šé™¤ã—ã€ç©ºã®é…åˆ—ï¼ˆ<code>[]</code>ï¼‰ã«ç½®ãæ›ãˆã¾ã™ã€‚ã“ã‚Œã¯ã€<code>traces/route1-regular</code> ã¨ <code>traces/route2-security</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§å‡¦ç†ã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã€å„ãƒ«ãƒ¼ãƒˆã«å¯¾ã—ã¦ã‚«ã‚¹ã‚¿ãƒ å‹•ä½œãŒå¯èƒ½ã«ãªã‚‹ãŸã‚ã§ã™ã€‚<code>traces:</code> ã®è¨­å®šã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>traces</span><span class=p>:</span><span class=w>                       </span><span class=c># Traces pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>otlp                     </span><span class=w> </span><span class=c># OTLP receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>processors</span><span class=p>:</span><span class=w> </span><span class=p>[]</span><span class=w>              </span><span class=c># Processors for traces</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>routing</span></span></span></code></pre></div></li></ol><p><strong>æ—¢å­˜ã® <code>traces</code> ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä¸‹ã« <code>route1-regular</code> ã¨ <code>route2-security</code> ã®ä¸¡æ–¹ã®ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ ã™ã‚‹</strong>:</p><ol><li><p><strong>Route1-regular ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¨­å®šã™ã‚‹</strong>: ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€ã‚³ãƒã‚¯ã‚¿ãƒ¼ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã«<strong>ä¸€è‡´ã—ãªã„</strong>ã™ã¹ã¦ã®ã‚¹ãƒ‘ãƒ³ã‚’å‡¦ç†ã—ã¾ã™ã€‚
ã“ã‚Œã¯å”¯ä¸€ã®ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã¨ã—ã¦ <code>routing</code> ã‚’ä½¿ç”¨ã—ã€å…ƒã® traces ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‹ã‚‰ã® <code>connection</code> ã‚’é€šã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å—ä¿¡ã™ã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces/route1-regular</span><span class=p>:</span><span class=w>         </span><span class=c># Default pipeline for unmatched spans</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>routing                   </span><span class=w> </span><span class=c># Receive data from the routing connector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter            </span><span class=w> </span><span class=c># Memory Limiter Processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode         </span><span class=w> </span><span class=c># Adds collector mode metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                     </span><span class=w> </span><span class=c># Debug Exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces/route1-regular</span><span class=w> </span><span class=c># File Exporter for unmatched spans</span></span></span></code></pre></div></li><li><p><strong>route2-security ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ ã™ã‚‹</strong>: ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã® <code>"[deployment.environment"] == "security-applications"</code> ãƒ«ãƒ¼ãƒ«ã«ä¸€è‡´ã™ã‚‹ã™ã¹ã¦ã®ã‚¹ãƒ‘ãƒ³ã‚’å‡¦ç†ã—ã¾ã™ã€‚ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚‚ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã¨ã—ã¦ <code>routing</code> ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’ <code>traces/route1-regular</code> ã®ä¸‹ã«è¿½åŠ ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>    </span><span class=nt>traces/route2-security</span><span class=p>:</span><span class=w>         </span><span class=c># Default pipeline for unmatched spans</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>routing                    </span><span class=w> </span><span class=c># Receive data from the routing connector</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter             </span><span class=w> </span><span class=c># Memory Limiter Processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode          </span><span class=w> </span><span class=c># Adds collector mode metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug                      </span><span class=w> </span><span class=c># Debug exporter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file/traces/route2-security</span><span class=w> </span><span class=c># File exporter for unmatched spans</span></span></span></code></pre></div></li></ol></div></details><p><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦ Agent ã®è¨­å®šã‚’æ¤œè¨¼ã—ã¾ã™ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>traces:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
      REC1(&amp;nbsp;&amp;nbsp;&amp;nbsp;otlp&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;br&gt;fa:fa-download):::receiver
      PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO2(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
      PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
      PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
      PRO6(batch&lt;br&gt;fa:fa-microchip):::processor
      EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP2(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
      EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
      EXP4(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt;traces):::exporter
      ROUTE1(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-export
      ROUTE2(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive
      ROUTE3(&amp;nbsp;routing&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive
    %% Links
    subID1:::sub-traces
    subID2:::sub-traces
    subID3:::sub-traces
    subgraph &#34; &#34;
    direction LR
      subgraph subID1[**Traces**]
      REC1 --&gt; ROUTE1
      end
      subgraph subID2[**Traces/route2-security**]
      ROUTE1 --&gt; ROUTE2
      ROUTE2 --&gt; PRO1
      PRO1 --&gt; PRO3
      PRO3 --&gt; PRO5
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end
      subgraph subID3[**Traces/route1-regular**]
      ROUTE1 --&gt; ROUTE3
      ROUTE3 --&gt; PRO2
      PRO2 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;</pre><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=63-test-routing-connector>6.3 Test Routing Connector</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€<strong>Gateway</strong> ç”¨ã«è¨­å®šã—ãŸ <code>routing</code> ãƒ«ãƒ¼ãƒ«ã‚’ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚æœŸå¾…ã•ã‚Œã‚‹çµæœã¯ã€<code>"[deployment.environment"] == "security-applications"</code> ãƒ«ãƒ¼ãƒ«ã«ä¸€è‡´ã™ã‚‹ <code>loadgen</code> ã«ã‚ˆã£ã¦ç”Ÿæˆã•ã‚ŒãŸ <code>span</code> ãŒ <code>gateway-traces-route2-security.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã§ã™ã€‚</p><p><strong>Gateway ã‚’èµ·å‹•ã™ã‚‹</strong>: <strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Gateway</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config gateway.yaml</span></span></code></pre></div><p><strong>Agent ã‚’èµ·å‹•ã™ã‚‹</strong>: <strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <strong>Agent</strong> ã‚’èµ·å‹•ã—ã¾ã™ã€‚</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config agent.yaml</span></span></code></pre></div><p><strong>é€šå¸¸ã®ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã™ã‚‹</strong>: <strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <code>loadgen</code> ã‚’ä½¿ç”¨ã—ã¦é€šå¸¸ã®ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>1</span></span></span></code></pre></div><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚Gateway ã¯æ–°ã—ã„ <code>gateway-traces-route1-regular.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚ç”Ÿæˆã—ã¾ã™ã€‚ã“ã‚ŒãŒé€šå¸¸ã®ã‚¹ãƒ‘ãƒ³ã®æŒ‡å®šã•ã‚ŒãŸå®›å…ˆã«ãªã‚Šã¾ã—ãŸã€‚</p><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p><code>gateway-traces-route1-regular.out</code> ã‚’ç¢ºèªã™ã‚‹ã¨ã€<code>loadgen</code> ã«ã‚ˆã£ã¦é€ä¿¡ã•ã‚ŒãŸ <code>span</code> ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã¾ãŸã€ç©ºã® <code>gateway-traces-route2-security..out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šãŒã€ä¸€è‡´ã™ã‚‹ã‚¹ãƒ‘ãƒ³ãŒã¾ã å‡¦ç†ã•ã‚Œã¦ã„ãªãã¦ã‚‚ã€ã™ãã«å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã§ã™ã€‚</p></div></details><p><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã™ã‚‹</strong>: <strong>Loadgen terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ <code>security</code> ãƒ•ãƒ©ã‚°ã‚’ä½¿ç”¨ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -security -count <span class=m>1</span></span></span></code></pre></div><p>å†ã³ã€<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ã§ã€é€ä¿¡ã—ãŸã‚¹ãƒ‘ãƒ³ã‚’å«ã‚€ãƒ‡ãƒãƒƒã‚°æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚ä»Šå›ã¯ã€<strong>Gateway</strong> ãŒ <code>gateway-traces-route2-security.out</code> ãƒ•ã‚¡ã‚¤ãƒ«ã«è¡Œã‚’æ›¸ãè¾¼ã¿ã¾ã™ã€‚ã“ã‚Œã¯ã€<code>deployment.environment</code> ãƒªã‚½ãƒ¼ã‚¹å±æ€§ãŒ <code>"security-applications"</code> ã«ä¸€è‡´ã™ã‚‹ã‚¹ãƒ‘ãƒ³ç”¨ã«æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã§ã™ã€‚</p><div class=tab-panel data-tab-group=R-tabs-19cdc911a64e507457cbc8bfd546c007><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-dab86b4b41cc0c79187a111eaefe07b7 aria-expanded=true data-tab-item=R-tab-ad0c2b09920ec6396d478d255cb39b4d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-19cdc911a64e507457cbc8bfd546c007","R-tab-ad0c2b09920ec6396d478d255cb39b4d")'>
<span class=tab-nav-text>Validate resource attribute matches</span>
</button>
<button aria-controls=R-tab-id-c353a3936c258a417743331b49eb6746 aria-expanded=false data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-19cdc911a64e507457cbc8bfd546c007","R-tab-29c2c02a361c9d7028472e5d92cd4a54")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div id=R-tab-id-dab86b4b41cc0c79187a111eaefe07b7 data-tab-item=R-tab-ad0c2b09920ec6396d478d255cb39b4d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -c <span class=s1>&#39;.resourceSpans[] as $resource | $resource.scopeSpans[].spans[] | {spanId: .spanId, deploymentEnvironment: ($resource.resource.attributes[] | select(.key == &#34;deployment.environment&#34;) | .value.stringValue)}&#39;</span> gateway-traces-route2-security.out</span></span></code></pre></div></div></div><div id=R-tab-id-c353a3936c258a417743331b49eb6746 data-tab-item=R-tab-29c2c02a361c9d7028472e5d92cd4a54 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;spanId&#34;</span><span class=p>:</span><span class=s2>&#34;cb799e92e26d5782&#34;</span><span class=p>,</span><span class=nt>&#34;deploymentEnvironment&#34;</span><span class=p>:</span><span class=s2>&#34;security-applications&#34;</span><span class=p>}</span></span></span></code></pre></div></div></div></div></div><p>ã“ã®ã‚·ãƒŠãƒªã‚ªã‚’è¤‡æ•°å›ç¹°ã‚Šè¿”ã™ã“ã¨ãŒã§ãã€å„ãƒˆãƒ¬ãƒ¼ã‚¹ã¯å¯¾å¿œã™ã‚‹å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¾ã‚Œã¾ã™ã€‚</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p>ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦ã€<strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details><h2 id=ã¾ã¨ã‚>ã¾ã¨ã‚<span class="btn cstyle anchor copyanchor scrollanchor link noborder notitle interactive"><button type=button title=ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼><i class="fa-fw fas fa-link fa-lg"></i></button></span></h2><p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ç•°ãªã‚‹ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã—ã€ãã®å®›å…ˆã‚’ç¢ºèªã™ã‚‹ã“ã¨ã§ã€Gateway ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚³ãƒã‚¯ã‚¿ãƒ¼ã‚’æ­£å¸¸ã«ãƒ†ã‚¹ãƒˆã—ã¾ã—ãŸã€‚</p><ul><li><p><strong>é€šå¸¸ã®ã‚¹ãƒ‘ãƒ³</strong> ã¯ <code>gateway-traces-route1-regular.out</code> ã«æ­£ã—ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã€ä¸€è‡´ã™ã‚‹ <code>deployment.environment</code> å±æ€§ã‚’æŒãŸãªã„ã‚¹ãƒ‘ãƒ³ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«å¾“ã†ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚</p></li><li><p><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é–¢é€£ã®ã‚¹ãƒ‘ãƒ³</strong> ã¯ <code>gateway-traces-route2-security.out</code> ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã•ã‚Œã€<code>"deployment.environment": "security-applications"</code> ã«åŸºã¥ããƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ãŒæœŸå¾…ã©ãŠã‚Šã«æ©Ÿèƒ½ã™ã‚‹ã“ã¨ãŒå®Ÿè¨¼ã•ã‚Œã¾ã—ãŸã€‚</p></li></ul><p>å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¤œæŸ»ã™ã‚‹ã“ã¨ã§ã€OpenTelemetry Collector ãŒ <em>ã‚¹ãƒ‘ãƒ³å±æ€§ã‚’æ­£ã—ãè©•ä¾¡ã—ã€é©åˆ‡ãªå®›å…ˆã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã„ã‚‹</em> ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ãŒç•°ãªã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å‘ã‘ã«ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹æœçš„ã«åˆ†é›¢ã—ã¦æŒ¯ã‚Šåˆ†ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã“ã¨ãŒæ¤œè¨¼ã•ã‚Œã¾ã—ãŸã€‚</p><p>è¿½åŠ ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã—ã¦ã€ç•°ãªã‚‹å±æ€§ã«åŸºã¥ã„ã¦ã‚¹ãƒ‘ãƒ³ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ­ã‚°ã‚’ã•ã‚‰ã«åˆ†é¡ã™ã‚‹ã“ã¨ã§ã€ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ‹¡å¼µã§ãã¾ã™ã€‚</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=7-count-connector-ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹>7. Count Connector ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/countconnector rel=external><strong>Count Connector</strong></a> ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ­ã‚°ã‹ã‚‰å±æ€§å€¤ã‚’æŠ½å‡ºã—ã€æ„å‘³ã®ã‚ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚</p><p>å…·ä½“çš„ã«ã¯ã€Count Connector ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ­ã‚°ã«å‡ºç¾ã™ã‚‹ã€ŒStar Warsã€ã¨ã€ŒLord of the Ringsã€ã®åè¨€ã®æ•°ã‚’è¿½è·¡ã—ã€æ¸¬å®šå¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã«å¤‰æ›ã—ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p><strong>ã™ã¹ã¦ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’ <code>7-sum-count</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤‰æ›´ã—ã€<code>clear</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</strong></p></div></details><p><code>6-routing-data</code> ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ <code>*.yaml</code> ã‚’ <code>7-sum-count</code> ã«ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚æ›´æ–°å¾Œã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-23d213496ec09a2ebe34da7fcd58a54b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-fec3b985ece07f8b1ba3b4326f9d917f aria-expanded=true data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-23d213496ec09a2ebe34da7fcd58a54b","R-tab-5a476a4994a778a4fb1b2011e6c9054c")'>
<span class=tab-nav-text>Updated Directory Structure</span></button></div><div class=tab-content-container><div id=R-tab-id-fec3b985ece07f8b1ba3b4326f9d917f data-tab-item=R-tab-5a476a4994a778a4fb1b2011e6c9054c class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>â”œâ”€â”€ agent.yaml
</span></span><span class=line><span class=cl>â””â”€â”€ gateway.yaml</span></span></code></pre></div></div></div></div></div><ul><li><strong>agent.yaml ã‚’æ›´æ–°</strong>ã—ã¦ã€ãƒ­ã‚°ã‚’èª­ã¿å–ã‚‹é »åº¦ã‚’å¤‰æ›´ã—ã¾ã™ã€‚
<code>agent.yaml</code> å†…ã® <code>filelog/quotes</code> ãƒ¬ã‚·ãƒ¼ãƒãƒ¼ã‚’è¦‹ã¤ã‘ã€<code>poll_interval</code> å±æ€§ã‚’è¿½åŠ ã—ã¦ãã ã•ã„</li></ul><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>filelog/quotes</span><span class=p>:</span><span class=w>                      </span><span class=c># Receiver Type/Name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>poll_interval</span><span class=p>:</span><span class=w> </span><span class=l>10s                </span><span class=w> </span><span class=c># Only read every ten seconds</span></span></span></code></pre></div></div></details><p>é…å»¶ã‚’è¨­å®šã™ã‚‹ç†ç”±ã¯ã€OpenTelemetry Collector ã® Count Connector ãŒå„å‡¦ç†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«å†…ã§ã®ã¿ãƒ­ã‚°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ãŸã‚ã§ã™ã€‚ã¤ã¾ã‚Šã€ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿å–ã‚‰ã‚Œã‚‹ãŸã³ã«ã€æ¬¡ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã§ã‚«ã‚¦ãƒ³ãƒˆãŒã‚¼ãƒ­ã«ãƒªã‚»ãƒƒãƒˆã•ã‚Œã¾ã™ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® <code>Filelog receiver</code> ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ« 200ms ã§ã¯ã€loadgen ãŒæ›¸ãè¾¼ã‚€ã™ã¹ã¦ã®è¡Œã‚’èª­ã¿å–ã‚Šã€ã‚«ã‚¦ãƒ³ãƒˆãŒ1ã«ãªã‚Šã¾ã™ã€‚ã“ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€è¤‡æ•°ã®ã‚¨ãƒ³ãƒˆãƒªã‚’ã‚«ã‚¦ãƒ³ãƒˆã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><p>ä»¥ä¸‹ã«ç¤ºã™ã‚ˆã†ã«ã€æ¡ä»¶ã‚’çœç•¥ã™ã‚‹ã“ã¨ã§ã€Collector ã¯å„èª­ã¿å–ã‚Šã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã®ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆã‚’ç¶­æŒã§ãã¾ã™ã€‚ãŸã ã—ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯é•·æœŸé–“ã«ã‚ãŸã£ã¦ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿½è·¡ã§ãã‚‹ãŸã‚ã€ç´¯è¨ˆã‚«ã‚¦ãƒ³ãƒˆã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ä»»ã›ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã§ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong>Count Connector ã‚’è¿½åŠ ã™ã‚‹</strong></li></ul><p>è¨­å®šã® connectors ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« Count Connector ã‚’è¿½åŠ ã—ã€ä½¿ç”¨ã™ã‚‹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’å®šç¾©ã—ã¾ã™</p><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>connectors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.full.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;Running count of all logs read in interval&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.sw.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;StarWarsCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;movie&#34;] == &#34;SW&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.lotr.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;LOTRCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;movie&#34;] == &#34;LOTR&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>logs.error.count</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>description</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;ErrorCount&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=l>attributes[&#34;level&#34;] == &#34;ERROR&#34;</span></span></span></code></pre></div><ul><li><p><strong>ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã®èª¬æ˜</strong></p><ul><li><code>logs.full.count</code>ï¼šå„èª­ã¿å–ã‚Šã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã§å‡¦ç†ã•ã‚ŒãŸãƒ­ã‚°ã®ç·æ•°ã‚’è¿½è·¡ã—ã¾ã™ã€‚
ã“ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«ã¯ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ¡ä»¶ãŒãªã„ãŸã‚ã€ã‚·ã‚¹ãƒ†ãƒ ã‚’é€šéã™ã‚‹ã™ã¹ã¦ã®ãƒ­ã‚°ãŒã‚«ã‚¦ãƒ³ãƒˆã«å«ã¾ã‚Œã¾ã™ã€‚</li><li><code>logs.sw.count</code>ï¼šStar Wars æ˜ ç”»ã®åè¨€ã‚’å«ã‚€ãƒ­ã‚°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã™ã€‚</li><li><code>logs.lotr.count</code>ï¼šLord of the Rings æ˜ ç”»ã®åè¨€ã‚’å«ã‚€ãƒ­ã‚°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã—ã¾ã™ã€‚</li><li><code>logs.error.count</code>ï¼šèª­ã¿å–ã‚Šã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã§é‡å¤§åº¦ãƒ¬ãƒ™ãƒ«ãŒ ERROR ã®ãƒ­ã‚°ã‚’ã‚«ã‚¦ãƒ³ãƒˆã™ã‚‹ã€å®Ÿéš›ã®ã‚·ãƒŠãƒªã‚ªã‚’è¡¨ã—ã¾ã™ã€‚</li></ul></li><li><p><strong>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ Count Connector ã‚’è¨­å®šã™ã‚‹</strong>
ä»¥ä¸‹ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šã§ã¯ã€connector exporter ãŒ <code>logs</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã€connector receiver ãŒ <code>metrics</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚</p></li></ul><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                          </span><span class=w> </span><span class=c># Count Connector that receives count metric from logs count exporter in logs pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- hostmetrics                    # Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filelog/quotes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs                </span><span class=w> </span><span class=c># Transform logs processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Count Connector that exports count as a metric to metrics pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div></div></details><p>ãƒ­ã‚°ã¯å±æ€§ã«åŸºã¥ã„ã¦ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã¾ã™ã€‚ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ãŒå±æ€§ã§ã¯ãªããƒ­ã‚°ãƒœãƒ‡ã‚£ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ <code>Transform</code> ãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ã‚­ãƒ¼/ãƒãƒªãƒ¥ãƒ¼ã®ãƒšã‚¢ã‚’æŠ½å‡ºã—ã€å±æ€§ã¨ã—ã¦è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p><p>ã“ã®ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ§ãƒƒãƒ—ã§ã¯ã€<code>05-transform-data</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§æ—¢ã« <code>merge_maps(attributes, cache, "upsert")</code> ã‚’è¿½åŠ ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é–¢é€£ã™ã‚‹ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒå‡¦ç†ç”¨ã®ãƒ­ã‚°å±æ€§ã«å«ã¾ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p><p>å±æ€§ã‚’ä½œæˆã™ã‚‹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’é¸æŠã™ã‚‹éš›ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ç„¡å·®åˆ¥ã«è¿½åŠ ã™ã‚‹ã“ã¨ã¯ã€æœ¬ç•ªç’°å¢ƒã§ã¯ä¸€èˆ¬çš„ã«ç†æƒ³çš„ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ä¸è¦ãªãƒ‡ãƒ¼ã‚¿ã®ä¹±é›‘ã•ã‚’é¿ã‘ã‚‹ãŸã‚ã€æœ¬å½“ã«å¿…è¦ãªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦ agent è¨­å®šã‚’<strong>æ¤œè¨¼</strong>ã—ã¦ãã ã•ã„ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>logs</code> ã¨ <code>metrics:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</li></ul><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
    REC1(otlp&lt;br&gt;fa:fa-download):::receiver
    REC2(filelog&lt;br&gt;fa:fa-download&lt;br&gt;quotes):::receiver
    REC3(otlp&lt;br&gt;fa:fa-download):::receiver
    PRO1(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
    PRO2(memory_limiter&lt;br&gt;fa:fa-microchip):::processor
    PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO5(batch&lt;br&gt;fa:fa-microchip):::processor
    PRO6(batch&lt;br&gt;fa:fa-microchip):::processor
    PRO7(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
    PRO8(resourcedetection&lt;br&gt;fa:fa-microchip):::processor
    PRO9(transfrom&lt;br&gt;fa:fa-microchip&lt;br&gt;logs):::processor
    EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    EXP2(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload):::exporter
    EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload):::exporter
    EXP4(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload):::exporter
    ROUTE1(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route):::con-export
    ROUTE2(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route):::con-receive

    %% Links
    subID1:::sub-logs
    subID2:::sub-metrics
    subgraph &#34; &#34;
      direction LR
      subgraph subID1[**Logs**]
      direction LR
      REC1 --&gt; PRO1
      REC2 --&gt; PRO1
      PRO1 --&gt; PRO7
      PRO7 --&gt; PRO3
      PRO3 --&gt; PRO9
      PRO9 --&gt; PRO5
      PRO5 --&gt; ROUTE1
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      end

      subgraph subID2[**Metrics**]
      direction LR
      ROUTE1 --&gt; ROUTE2
      ROUTE2 --&gt; PRO2
      REC3 --&gt; PRO2
      PRO2 --&gt; PRO8
      PRO8 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><section><h1 class=a11y-only>7. Count & Sum Connectorã®ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³</h1><article class=default><header class=headline></header><h1 id=71-count-connector-ã®ãƒ†ã‚¹ãƒˆ>7.1 Count Connector ã®ãƒ†ã‚¹ãƒˆ</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway ã‚’èµ·å‹•ã™ã‚‹</strong>
<strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-a01ed2f26103a23691b243bbedd3743a><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d5604c32e01c0137d5f08bd96464b181 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-a01ed2f26103a23691b243bbedd3743a","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-d5604c32e01c0137d5f08bd96464b181 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Agent ã‚’èµ·å‹•ã™ã‚‹</strong>
<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-c3134cf46059210cf162c8cbce7d6b77><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-0d6a435b6698624b4b3eb812a1ec132f aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-c3134cf46059210cf162c8cbce7d6b77","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-0d6a435b6698624b4b3eb812a1ec132f data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Loadgen ã§12è¡Œã®ãƒ­ã‚°ã‚’é€ä¿¡ã™ã‚‹</strong>
<strong>Spans terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€12è¡Œã®ãƒ­ã‚°ã‚’é€ä¿¡ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã¯2ã¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã§èª­ã¿å–ã‚‰ã‚Œã‚‹ã¯ãšã§ã™ã€‚ä»¥ä¸‹ã® <code>loadgen</code> ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„</p><div class=tab-panel data-tab-group=R-tabs-eaad5b3b216d1e2896b801a5ece5f94f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-a0311fd92aaf421b76009c9756ed11d9 aria-expanded=true data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-eaad5b3b216d1e2896b801a5ece5f94f","R-tab-c04840259ee1732c29330a07b53ce556")'>
<span class=tab-nav-text>Loadgen</span></button></div><div class=tab-content-container><div id=R-tab-id-a0311fd92aaf421b76009c9756ed11d9 data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -logs -json -count <span class=m>12</span></span></span></code></pre></div></div></div></div></div><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ãŒãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤ºã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚<code>loadgen</code> ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚</p><p><strong>ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒç”Ÿæˆã•ã‚ŒãŸã“ã¨ã‚’ç¢ºèªã™ã‚‹</strong>
ãƒ­ã‚°ãŒå‡¦ç†ã•ã‚Œã‚‹ã¨ã€<strong>Agent</strong> ãŒãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç”Ÿæˆã—ã¦ <strong>Gateway</strong> ã«è»¢é€ã—ã€Gateway ãŒãã‚Œã‚‰ã‚’ <code>gateway-metrics.out</code> ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚</p><p>å‡ºåŠ›ã« <code>logs.full.count</code>ã€<code>logs.sw.count</code>ã€<code>logs.lotr.count</code>ã€<code>logs.error.count</code> ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã® <strong>jq</strong> ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-8a34e8d76e1b0deedb6ebe9781a9c80b><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-1e3f2448ffae791de27a91a5605127d3 aria-expanded=true data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-8a34e8d76e1b0deedb6ebe9781a9c80b","R-tab-5bcdc0d6fffb60ccb3e52026507edd53")'>
<span class=tab-nav-text>jq query command</span>
</button>
<button aria-controls=R-tab-id-ed53dfae102c30f63926cc35274b9199 aria-expanded=false data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-8a34e8d76e1b0deedb6ebe9781a9c80b","R-tab-845b9df504b40e63fe9060457ddcf4e9")'>
<span class=tab-nav-text>jq example output</span></button></div><div class=tab-content-container><div id=R-tab-id-1e3f2448ffae791de27a91a5605127d3 data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[]
</span></span></span><span class=line><span class=cl><span class=s1>    | select(.name == &#34;logs.full.count&#34; or .name == &#34;logs.sw.count&#34; or .name == &#34;logs.lotr.count&#34; or .name == &#34;logs.error.count&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    | {name: .name, value: (.sum.dataPoints[0].asInt // &#34;-&#34;)}&#39;</span> gateway-metrics.out</span></span></code></pre></div></div></div><div id=R-tab-id-ed53dfae102c30f63926cc35274b9199 data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.sw.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.lotr.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.full.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;4&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.error.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.error.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.sw.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;2&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.lotr.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;6&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;name&#34;</span><span class=p>:</span> <span class=s2>&#34;logs.full.count&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;value&#34;</span><span class=p>:</span> <span class=s2>&#34;8&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices primary"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-lightbulb"></i>
Tip</summary><div class=box-content><p>æ³¨ï¼š<code>logs.full.count</code> ã¯é€šå¸¸ <code>logs.sw.count</code> + <code>logs.lotr.count</code> ã¨ç­‰ã—ããªã‚Šã¾ã™ãŒã€<code>logs.error.count</code> ã¯ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å€¤ã«ãªã‚Šã¾ã™ã€‚</p></div></details><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p>ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦ <strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=72-sum-connector-ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹>7.2 Sum Connector ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ä½œæˆã™ã‚‹</h1><span class="badge cstyle primary badge-with-title"><span class=badge-title><i class="fa-fw fas fa-clock"></i></span><span class=badge-content>10 minutes</span>
</span>&nbsp;<p>ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€<a href=https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/connector/sumconnector rel=external><strong>Sum Connector</strong></a> ãŒã‚¹ãƒ‘ãƒ³ã‹ã‚‰å€¤ã‚’æŠ½å‡ºã—ã¦ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å¤‰æ›ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚</p><p>å…·ä½“çš„ã«ã¯ã€ãƒ™ãƒ¼ã‚¹ã‚¹ãƒ‘ãƒ³ã‹ã‚‰ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®è«‹æ±‚é¡ã‚’å–å¾—ã—ã€Sum Connector ã‚’æ´»ç”¨ã—ã¦åˆè¨ˆè«‹æ±‚é¡ã‚’ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨ã—ã¦å–å¾—ã—ã¾ã™ã€‚</p><p>ã“ã® connector ã¯ã€ã‚¹ãƒ‘ãƒ³ã€ã‚¹ãƒ‘ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã€ãŠã‚ˆã³ãƒ­ã‚°ãƒ¬ã‚³ãƒ¼ãƒ‰ã‹ã‚‰å±æ€§å€¤ã‚’åé›†ï¼ˆ<strong>sum</strong>ï¼‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚å„å€‹åˆ¥ã®å€¤ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã«å¤‰æ›ã—ã¦è»¢é€ã—ã¾ã™ã€‚ãŸã ã—ã€ã“ã‚Œã‚‰ã®ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã¨å±æ€§ã‚’ä½¿ç”¨ã—ã¦è¨ˆç®—ã‚„ã•ã‚‰ãªã‚‹å‡¦ç†ã‚’è¡Œã†ã®ã¯<strong>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰</strong>ã®å½¹å‰²ã§ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«åˆ‡ã‚Šæ›¿ãˆã¦ã€ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ <code>agent.yaml</code> ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¾ã™ã€‚</p><ul><li><strong>Sum Connector ã‚’è¿½åŠ ã™ã‚‹</strong>
è¨­å®šã® connectors ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã« Sum Connector ã‚’è¿½åŠ ã—ã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’å®šç¾©ã—ã¾ã™</li></ul><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>sum</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spans</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=nt>user.card-charge</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>source_attribute</span><span class=p>:</span><span class=w> </span><span class=l>payment.amount</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>conditions</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=l>attributes[&#34;payment.amount&#34;] != &#34;NULL&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>attributes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span>- <span class=nt>key</span><span class=p>:</span><span class=w> </span><span class=l>user.name</span></span></span></code></pre></div></div></details><p>ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€ã‚¹ãƒ‘ãƒ³å†…ã® <code>payment.amount</code> å±æ€§ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã„ã¾ã™ã€‚æœ‰åŠ¹ãªå€¤ãŒã‚ã‚‹å ´åˆã€<strong>Sum</strong> connector ã¯ <code>user.card-charge</code> ã¨ã„ã†ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç”Ÿæˆã—ã€<code>user.name</code> ã‚’å±æ€§ã¨ã—ã¦å«ã‚ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯è«‹æ±‚ã‚µã‚¤ã‚¯ãƒ«ãªã©ã®é•·æœŸé–“ã«ã‚ãŸã£ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆè¨ˆè«‹æ±‚é¡ã‚’è¿½è·¡ã—ã¦è¡¨ç¤ºã§ãã¾ã™ã€‚</p><p>ä»¥ä¸‹ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¨­å®šã§ã¯ã€connector exporter ãŒ traces ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã€connector receiver ãŒ metrics ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«è¿½åŠ ã•ã‚Œã¦ã„ã¾ã™ã€‚</p><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><ul><li><strong>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ Count Connector ã‚’è¨­å®šã™ã‚‹</strong></li></ul><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=w>  </span><span class=nt>pipelines</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>traces</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>attributes/update             </span><span class=w> </span><span class=c># Update, hash, and remove attributes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redaction/redact              </span><span class=w> </span><span class=c># Redact sensitive fields using regex</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>file</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>sum                           </span><span class=w> </span><span class=c># Sum connector which aggregates payment.amount from spans and sends to metrics pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metrics</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>sum                           </span><span class=w> </span><span class=c># Receives metrics from the sum exporter in the traces pipeline</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Receives count metric from logs count exporter in logs pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>#- hostmetrics                   # Host Metrics Receiver</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logs</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>receivers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlp</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>filelog/quotes</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>processors</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>memory_limiter</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resourcedetection</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>resource/add_mode</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>transform/logs                </span><span class=w> </span><span class=c># Transform logs processor</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>batch</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>exporters</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>count                         </span><span class=w> </span><span class=c># Count Connector that exports count as a metric to metrics pipeline.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>debug</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>otlphttp</span></span></span></code></pre></div><ul><li><strong><a href=https://www.otelbin.io/ rel=external>otelbin.io</a></strong> ã‚’ä½¿ç”¨ã—ã¦ agent è¨­å®šã‚’<strong>æ¤œè¨¼</strong>ã—ã¦ãã ã•ã„ã€‚å‚è€ƒã¨ã—ã¦ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã® <code>traces</code> ã¨ <code>metrics:</code> ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™</li></ul><pre class="mermaid actionbar-wrapper align-center">%%{init:{&#34;fontFamily&#34;:&#34;monospace&#34;}}%%
graph LR
    %% Nodes
    REC1(otlp&lt;br&gt;fa:fa-download&lt;br&gt; ):::receiver
    REC3(otlp&lt;br&gt;fa:fa-download&lt;br&gt; ):::receiver
    PRO1(memory_limiter&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO2(memory_limiter&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO3(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO4(resource&lt;br&gt;fa:fa-microchip&lt;br&gt;add_mode):::processor
    PRO5(batch&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO6(batch&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO7(resourcedetection&lt;br&gt;fa:fa-microchip&lt;br&gt; ):::processor
    PRO8(resourcedetection&lt;br&gt;fa:fa-microchip&lt;br&gt;):::processor

    PROA(attributes&lt;br&gt;fa:fa-microchip&lt;br&gt;redact):::processor
    PROB(redaction&lt;br&gt;fa:fa-microchip&lt;br&gt;update):::processor
    EXP1(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP2(&amp;emsp;&amp;emsp;file&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP3(&amp;nbsp;&amp;ensp;debug&amp;nbsp;&amp;ensp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP4(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    EXP5(&amp;emsp;&amp;emsp;otlphttp&amp;emsp;&amp;emsp;&lt;br&gt;fa:fa-upload&lt;br&gt; ):::exporter
    ROUTE1(&amp;nbsp;sum&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-export
    ROUTE2(&amp;nbsp;count&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-receive
    ROUTE3(&amp;nbsp;sum&amp;nbsp;&lt;br&gt;fa:fa-route&lt;br&gt; ):::con-receive

    %% Links
    subID1:::sub-traces
    subID2:::sub-metrics
    subgraph &#34; &#34;
      direction LR
      subgraph subID1[**Traces**]
      direction LR
      REC1 --&gt; PRO1
      PRO1 --&gt; PROA
      PROA --&gt; PROB
      PROB --&gt; PRO7
      PRO7 --&gt; PRO3
      PRO3 --&gt; PRO5
      PRO5 --&gt; EXP1
      PRO5 --&gt; EXP2
      PRO5 --&gt; EXP5
      PRO5 --&gt; ROUTE1
      end

      subgraph subID2[**Metrics**]
      direction LR
      ROUTE1 --&gt; ROUTE3
      ROUTE3 --&gt; PRO2
      ROUTE2 --&gt; PRO2
      REC3 --&gt; PRO2
      PRO2 --&gt; PRO8
      PRO8 --&gt; PRO4
      PRO4 --&gt; PRO6
      PRO6 --&gt; EXP3
      PRO6 --&gt; EXP4
      end
    end
classDef receiver,exporter fill:#8b5cf6,stroke:#333,stroke-width:1px,color:#fff;
classDef processor fill:#6366f1,stroke:#333,stroke-width:1px,color:#fff;
classDef con-receive,con-export fill:#45c175,stroke:#333,stroke-width:1px,color:#fff;
classDef sub-logs stroke:#34d399,stroke-width:1px, color:#34d399,stroke-dasharray: 3 3;
classDef sub-traces stroke:#fbbf24,stroke-width:1px, color:#fbbf24,stroke-dasharray: 3 3;
classDef sub-metrics stroke:#38bdf8,stroke-width:1px, color:#38bdf8,stroke-dasharray: 3 3;</pre></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article><article class=default><header class=headline></header><h1 id=73-sum-connector-ã®ãƒ†ã‚¹ãƒˆ>7.3 Sum Connector ã®ãƒ†ã‚¹ãƒˆ</h1><details open class="box cstyle notices green"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-running"></i>
Exercise</summary><div class=box-content><p><strong>Gateway ã‚’èµ·å‹•ã™ã‚‹</strong>
<strong>Gateway terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-04e63e2107309223aec51aa87c141acb><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-f83a6ba0f6d8d17d460e0f8153aa5d12 aria-expanded=true data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-04e63e2107309223aec51aa87c141acb","R-tab-dc146ad677dc5dd9c26a2a6537f98eb7")'>
<span class=tab-nav-text>Start the Gateway</span></button></div><div class=tab-content-container><div id=R-tab-id-f83a6ba0f6d8d17d460e0f8153aa5d12 data-tab-item=R-tab-dc146ad677dc5dd9c26a2a6537f98eb7 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>gateway.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Agent ã‚’èµ·å‹•ã™ã‚‹</strong>
<strong>Agent terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-b6a3e34ca00678f5084b78c55793a184><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-d4e0140a3c99e5a88c40feb0c5fcd8c8 aria-expanded=true data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-b6a3e34ca00678f5084b78c55793a184","R-tab-e2d8debf4ffe3bb6331201655f536d9d")'>
<span class=tab-nav-text>Start the Agent</span></button></div><div class=tab-content-container><div id=R-tab-id-d4e0140a3c99e5a88c40feb0c5fcd8c8 data-tab-item=R-tab-e2d8debf4ffe3bb6331201655f536d9d class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../otelcol --config<span class=o>=</span>agent.yaml</span></span></code></pre></div></div></div></div></div><p><strong>Loadgen ã‚’èµ·å‹•ã™ã‚‹</strong>
<strong>Spans terminal</strong> ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ã€ä»¥ä¸‹ã® <code>loadgen</code> ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦8ã¤ã®ã‚¹ãƒ‘ãƒ³ã‚’é€ä¿¡ã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-fc4f25b8c2046c110fc7982d36449c5c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-e7c99c56205d1576a34fba678b54663a aria-expanded=true data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-fc4f25b8c2046c110fc7982d36449c5c","R-tab-c04840259ee1732c29330a07b53ce556")'>
<span class=tab-nav-text>Loadgen</span></button></div><div class=tab-content-container><div id=R-tab-id-e7c99c56205d1576a34fba678b54663a data-tab-item=R-tab-c04840259ee1732c29330a07b53ce556 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>../loadgen -count <span class=m>8</span></span></span></code></pre></div></div></div></div></div><p><strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ä¸¡æ–¹ãŒãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¡¨ç¤ºã—ã€ãƒ‡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã™ã€‚loadgen ãŒå®Œäº†ã™ã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚</p><p><strong>ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç¢ºèªã™ã‚‹</strong>
ã‚¹ãƒ‘ãƒ³ã‚’å‡¦ç†ã™ã‚‹éš›ã€<strong>Agent</strong> ã¯ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’ç”Ÿæˆã—ã¦ <strong>Gateway</strong> ã«è»¢é€ã—ã¾ã™ã€‚<strong>Gateway</strong> ã¯ãã‚Œã‚‰ã‚’ <code>gateway-metrics.out</code> ã«æ›¸ãè¾¼ã¿ã¾ã™ã€‚</p><p>ãƒ¡ãƒˆãƒªã‚¯ã‚¹å‡ºåŠ›ã« <code>user.card-charge</code> ãŒå­˜åœ¨ã—ã€ãã‚Œãã‚Œã« <code>user.name</code> å±æ€§ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã® jq ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã—ã¾ã™</p><div class=tab-panel data-tab-group=R-tabs-494680814170e9d4a5145ed1d65cde6e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button aria-controls=R-tab-id-4cb00e99c30b42f17004cba7c0641eb1 aria-expanded=true data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("R-tabs-494680814170e9d4a5145ed1d65cde6e","R-tab-5bcdc0d6fffb60ccb3e52026507edd53")'>
<span class=tab-nav-text>jq query command</span>
</button>
<button aria-controls=R-tab-id-0d8bcc62f472df218376658bebb1527b aria-expanded=false data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("R-tabs-494680814170e9d4a5145ed1d65cde6e","R-tab-845b9df504b40e63fe9060457ddcf4e9")'>
<span class=tab-nav-text>jq example output</span></button></div><div class=tab-content-container><div id=R-tab-id-4cb00e99c30b42f17004cba7c0641eb1 data-tab-item=R-tab-5bcdc0d6fffb60ccb3e52026507edd53 class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>jq -r <span class=s1>&#39;.resourceMetrics[].scopeMetrics[].metrics[] | select(.name == &#34;user.card-charge&#34;) | .sum.dataPoints[] | &#34;\(.attributes[] | select(.key == &#34;user.name&#34;).value.stringValue)\t\(.asDouble)&#34;&#39;</span> gateway-metrics.out <span class=p>|</span> <span class=k>while</span> <span class=nv>IFS</span><span class=o>=</span><span class=s1>$&#39;\t&#39;</span> <span class=nb>read</span> -r name charge<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>printf</span> <span class=s2>&#34;%-20s %s\n&#34;</span> <span class=s2>&#34;</span><span class=nv>$name</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$charge</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span></span></span></code></pre></div></div></div><div id=R-tab-id-0d8bcc62f472df218376658bebb1527b data-tab-item=R-tab-845b9df504b40e63fe9060457ddcf4e9 class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight actionbar-wrapper wrap-code" dir=auto><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>George Lucas         67.49
</span></span><span class=line><span class=cl>Frodo Baggins        87.14
</span></span><span class=line><span class=cl>Thorin Oakenshield   90.98
</span></span><span class=line><span class=cl>Luke Skywalker       51.37
</span></span><span class=line><span class=cl>Luke Skywalker       65.56
</span></span><span class=line><span class=cl>Thorin Oakenshield   67.5
</span></span><span class=line><span class=cl>Thorin Oakenshield   66.66
</span></span><span class=line><span class=cl>Peter Jackson        94.39</span></span></code></pre></div></div></div></div></div><details open class="box cstyle notices important"><summary class=box-label tabindex=-1><i class="fa-fw fas fa-bolt"></i>
é‡è¦</summary><div class=box-content><p>ãã‚Œãã‚Œã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ <code>Ctrl-C</code> ã‚’æŠ¼ã—ã¦ <strong>Agent</strong> ã¨ <strong>Gateway</strong> ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’åœæ­¢ã—ã¦ãã ã•ã„ã€‚</p></div></details></div></details><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/23</span></span></footer></article></section><article class=default><header class=headline></header><h1 id=8-ã¾ã¨ã‚>8. ã¾ã¨ã‚</h1><p><a href=#R-image-57e1c8a11c6406bb6d792181c4b5cacb class=lightbox-link><img alt="Well done" class="lazy lightbox figure-image" loading=lazy src=../images/welldone.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-57e1c8a11c6406bb6d792181c4b5cacb><img alt="Well done" class="lazy lightbox lightbox-image" loading=lazy src=../images/welldone.png></a></p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>2026/01/09</span></span></footer></article></section></div></main></div><script src=/observability-workshop/js/js-yaml/js-yaml.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-color.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-dispatch.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-drag.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-ease.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-interpolate.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-selection.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-timer.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-transition.min.js?1769793366 defer></script><script src=/observability-workshop/js/d3/d3-zoom.min.js?1769793366 defer></script><script src=/observability-workshop/js/mermaid/mermaid.min.js?1769793366 defer></script><script>window.relearn.themeUseMermaid=JSON.parse("{}")</script><script src=/observability-workshop/js/perfect-scrollbar/perfect-scrollbar.min.js?1769793366 defer></script><script src=/observability-workshop/js/theme.min.js?1769793366 defer></script><div id=toast-container role=status aria-live=polite aria-atomic=false></div></body></html>
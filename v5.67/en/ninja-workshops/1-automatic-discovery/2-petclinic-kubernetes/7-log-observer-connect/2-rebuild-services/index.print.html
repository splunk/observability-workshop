<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.4.0+tip"><meta name=description content="Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the pom.xml of our services: â€‹ Adding OTel dependencies Output . ~/workshop/petclinic/scripts/add_otel.sh Dependencies added successfully in spring-petclinic-admin-server Dependencies added successfully in spring-petclinic-api-gateway Dependencies added successfully in spring-petclinic-config-server Dependencies added successfully in spring-petclinic-discovery-server Dependencies added successfully in spring-petclinic-customers-service Dependencies added successfully in spring-petclinic-vets-service Dependencies added successfully in spring-petclinic-visits-service Dependency addition complete!"><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="Rebuild PetClinic :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the pom.xml of our services: â€‹ Adding OTel dependencies Output . ~/workshop/petclinic/scripts/add_otel.sh Dependencies added successfully in spring-petclinic-admin-server Dependencies added successfully in spring-petclinic-api-gateway Dependencies added successfully in spring-petclinic-config-server Dependencies added successfully in spring-petclinic-discovery-server Dependencies added successfully in spring-petclinic-customers-service Dependencies added successfully in spring-petclinic-vets-service Dependencies added successfully in spring-petclinic-visits-service Dependency addition complete!"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/2-rebuild-services/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="Rebuild PetClinic :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the pom.xml of our services: â€‹ Adding OTel dependencies Output . ~/workshop/petclinic/scripts/add_otel.sh Dependencies added successfully in spring-petclinic-admin-server Dependencies added successfully in spring-petclinic-api-gateway Dependencies added successfully in spring-petclinic-config-server Dependencies added successfully in spring-petclinic-discovery-server Dependencies added successfully in spring-petclinic-customers-service Dependencies added successfully in spring-petclinic-vets-service Dependencies added successfully in spring-petclinic-visits-service Dependency addition complete!"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="Ninja Workshops"><meta property="article:modified_time" content="2024-09-19T16:47:03+01:00"><meta itemprop=name content="Rebuild PetClinic :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the pom.xml of our services: â€‹ Adding OTel dependencies Output . ~/workshop/petclinic/scripts/add_otel.sh Dependencies added successfully in spring-petclinic-admin-server Dependencies added successfully in spring-petclinic-api-gateway Dependencies added successfully in spring-petclinic-config-server Dependencies added successfully in spring-petclinic-discovery-server Dependencies added successfully in spring-petclinic-customers-service Dependencies added successfully in spring-petclinic-vets-service Dependencies added successfully in spring-petclinic-visits-service Dependency addition complete!"><meta itemprop=dateModified content="2024-09-19T16:47:03+01:00"><meta itemprop=wordCount content="392"><title>Rebuild PetClinic :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/2-rebuild-services/index.html rel=canonical type=text/html title="Rebuild PetClinic :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.67/images/favicon.ico?1726779098 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.67/css/fontawesome-all.min.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/fontawesome-all.min.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/nucleus.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/auto-complete.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/auto-complete.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/perfect-scrollbar.min.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/fonts.css?1726779098 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.67/css/fonts.css?1726779098 rel=stylesheet></noscript><link href=/observability-workshop/v5.67/css/theme.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/theme-splunk-light.css?1726779098 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.67/css/chroma-relearn-light.css?1726779098 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.67/css/variant.css?1726779098 rel=stylesheet><link href=/observability-workshop/v5.67/css/print.css?1726779098 rel=stylesheet media=print><link href=/observability-workshop/v5.67/css/format-print.css?1726779098 rel=stylesheet><script src=/observability-workshop/v5.67/js/variant.js?1726779098></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../../../..",window.relearn.relBaseUri="../../../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.67",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.index_js_url="/observability-workshop/v5.67/en/index.search.js?1726779098",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/2-rebuild-services/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/index.html><span itemprop=name>Ninja Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/index.html><span itemprop=name>Automatic Discovery Workshops</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/index.html><span itemprop=name>PetClinic Kubernetes Workshop</span></a><meta itemprop=position content="4">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/index.html><span itemprop=name>7. Log Observer</span></a><meta itemprop=position content="5">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>2. Rebuild PetClinic</span><meta itemprop=position content="6"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/1-view-logs/index.html title="Viewing the Logs (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.67/en/ninja-workshops/1-automatic-discovery/2-petclinic-kubernetes/7-log-observer-connect/2-related-content/index.html title="Related Content (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=rebuild-petclinic>Rebuild PetClinic</h1><p>Before we can build the new services with the updated log format we need to add the OpenTelemetry dependency that handles field injection to the <code>pom.xml</code> of our services:<div class=tab-panel data-tab-group=3dcc9edafd796a1c2037090818fa2e2e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=adding-otel-dependencies class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("3dcc9edafd796a1c2037090818fa2e2e","adding-otel-dependencies")'>
<span class=tab-nav-text>Adding OTel dependencies</span>
</button>
<button data-tab-item=output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("3dcc9edafd796a1c2037090818fa2e2e","output")'>
<span class=tab-nav-text>Output</span></button></div><div class=tab-content-container><div data-tab-item=adding-otel-dependencies class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/add_otel.sh</span></span></code></pre></div></div></div><div data-tab-item=output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-admin-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-api-gateway
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-config-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-discovery-server
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-customers-service
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-vets-service
</span></span><span class=line><span class=cl>Dependencies added successfully in spring-petclinic-visits-service
</span></span><span class=line><span class=cl>Dependency addition complete!</span></span></code></pre></div></div></div></div></div></p><p>The Services are now ready to be built, so run the script that will use the <code>maven</code> command to compile/build/package the PetClinic microservices:</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>Note the <code>-P buildDocker</code>, this will build the new containers and take 3-5 minutes to complete.</p></div></div><div class=tab-panel data-tab-group=609d0253911774ea2b02978f5787932f><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=running-maven class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("609d0253911774ea2b02978f5787932f","running-maven")'>
<span class=tab-nav-text>Running maven</span>
</button>
<button data-tab-item=maven-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("609d0253911774ea2b02978f5787932f","maven-output")'>
<span class=tab-nav-text>Maven Output</span></button></div><div class=tab-content-container><div data-tab-item=running-maven class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>./mvnw clean install -D skipTests -P buildDocker</span></span></code></pre></div></div></div><div data-tab-item=maven-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>Successfully tagged quay.io/phagen/spring-petclinic-api-gateway:latest
</span></span><span class=line><span class=cl>[INFO] Built quay.io/phagen/spring-petclinic-api-gateway
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] Reactor Summary:
</span></span><span class=line><span class=cl>[INFO] 
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-microservices 0.0.1 ............... SUCCESS [  0.770 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-admin-server ...................... SUCCESS [01:03 min]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-customers-service ................. SUCCESS [ 29.031 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-vets-service ...................... SUCCESS [ 22.145 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-visits-service .................... SUCCESS [ 20.451 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-config-server ..................... SUCCESS [ 12.260 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-discovery-server .................. SUCCESS [ 14.174 s]
</span></span><span class=line><span class=cl>[INFO] spring-petclinic-api-gateway 0.0.1 ................. SUCCESS [ 29.832 s]
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] BUILD SUCCESS
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>[INFO] Total time: 03:14 min
</span></span><span class=line><span class=cl>[INFO] Finished at: 2024-01-02T12:43:20Z
</span></span><span class=line><span class=cl>[INFO] ------------------------------------------------------------------------</span></span></code></pre></div></div></div></div></div><p>Given that Kubernetes needs to pull these freshly built images from somewhere, we are going to store them in the repository we tested earlier. To do this, run the script that will push the newly built containers into our local repository:</p><div class=tab-panel data-tab-group=39fa2e1537550065858ec8cbaa9f278c><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=pushing-containers class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("39fa2e1537550065858ec8cbaa9f278c","pushing-containers")'>
<span class=tab-nav-text>pushing Containers</span>
</button>
<button data-tab-item=docker-push-output-partial class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("39fa2e1537550065858ec8cbaa9f278c","docker-push-output-partial")'>
<span class=tab-nav-text>Docker Push Output (partial)</span></button></div><div class=tab-content-container><div data-tab-item=pushing-containers class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>. ~/workshop/petclinic/scripts/push_docker.sh </span></span></code></pre></div></div></div><div data-tab-item=docker-push-output-partial class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>The push refers to repository [localhost:5000/spring-petclinic-vets-service]
</span></span><span class=line><span class=cl>0391386bcb2a: Preparing
</span></span><span class=line><span class=cl>bbb67f51a186: Preparing
</span></span><span class=line><span class=cl>105351d0ada3: Preparing
</span></span><span class=line><span class=cl>49cfeae6cb9f: Preparing
</span></span><span class=line><span class=cl>b4da5101fcde: Preparing
</span></span><span class=line><span class=cl>49cfeae6cb9f: Pushed
</span></span><span class=line><span class=cl>e742c14be110: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>540aa741fede: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>a1dfe59d4939: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>1e99e92c46bf: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>f5aa38537736: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>d2210512edb4: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>8e87ff28f1b5: Mounted from spring-petclinic-visits-service
</span></span><span class=line><span class=cl>local: digest: sha256:42337b2a4ff7d0ac9b7c2cf3c70aa20b7b52d092f1e05d351e031dd7fad956fc size: 3040
</span></span><span class=line><span class=cl>The push refers to repository [localhost:5000/spring-petclinic-customers-service]
</span></span><span class=line><span class=cl>15d54d9adca8: Preparing
</span></span><span class=line><span class=cl>886f6def5b35: Preparing
</span></span><span class=line><span class=cl>1575ae90e858: Preparing
</span></span><span class=line><span class=cl>ccc884d92d18: Preparing
</span></span><span class=line><span class=cl>b4da5101fcde: Preparing
</span></span><span class=line><span class=cl>ccc884d92d18: Pushed
</span></span><span class=line><span class=cl>e742c14be110: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>540aa741fede: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>a1dfe59d4939: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>1e99e92c46bf: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>f5aa38537736: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>d2210512edb4: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>8e87ff28f1b5: Mounted from spring-petclinic-vets-service
</span></span><span class=line><span class=cl>local: digest: sha256:3601c6e7f58224001946058fb0400483fbb8f1b0ea8a6dbaf403c62b4c1908be size: 3042</span></span></code></pre></div></div></div></div></div><p>The containers should now be stored in the local repository, let&rsquo;s confirm by checking the catalog:</p><div class=tab-panel data-tab-group=0128b17e30fb3e8129cfe6375c72958e><div class=tab-nav><div class=tab-nav-title>&#8203;</div><button data-tab-item=check-catalog class="tab-nav-button tab-panel-style cstyle initial active" tabindex=-1 onclick='switchTab("0128b17e30fb3e8129cfe6375c72958e","check-catalog")'>
<span class=tab-nav-text>Check Catalog</span>
</button>
<button data-tab-item=catalog-output class="tab-nav-button tab-panel-style cstyle initial" onclick='switchTab("0128b17e30fb3e8129cfe6375c72958e","catalog-output")'>
<span class=tab-nav-text>Catalog Output</span></button></div><div class=tab-content-container><div data-tab-item=check-catalog class="tab-content tab-panel-style cstyle initial active"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -X GET http://localhost:9999/v2/_catalog</span></span></code></pre></div></div></div><div data-tab-item=catalog-output class="tab-content tab-panel-style cstyle initial"><div class=tab-content-text><div class="highlight wrap-code"><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span><span class=nt>&#34;repositories&#34;</span><span class=p>:[</span><span class=s2>&#34;spring-petclinic-admin-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-api-gateway&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-config-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-customers-service&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-discovery-server&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-vets-service&#34;</span><span class=p>,</span><span class=s2>&#34;spring-petclinic-visits-service&#34;</span><span class=p>]}</span></span></span></code></pre></div></div></div></div></div><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></div></main></div><script src=/observability-workshop/v5.67/js/clipboard.min.js?1726779098 defer></script><script src=/observability-workshop/v5.67/js/perfect-scrollbar.min.js?1726779098 defer></script><script src=/observability-workshop/v5.67/js/theme.js?1726779098 defer></script></body></html>
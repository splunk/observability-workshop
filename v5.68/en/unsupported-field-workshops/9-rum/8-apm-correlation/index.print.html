<!doctype html><html lang=en dir=ltr itemscope itemtype=http://schema.org/Article><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.125.5"><meta name=generator content="Relearn 6.4.0+tip"><meta name=description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta name=author content><meta name=twitter:card content="summary"><meta name=twitter:title content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta name=twitter:description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:url" content="https://splunk.github.io/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/index.html"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta property="og:title" content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta property="og:description" content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="Unsupported Field Workshops"><meta property="article:modified_time" content="2024-09-19T16:47:03+01:00"><meta itemprop=name content="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><meta itemprop=description content="Continue with the RUM Session information in the RUM UI See correlated APM traces and logs in the APM & Log Observer UI 1. Finding backend service issues Click on the to close the Span view. Now continue to scroll down and find the POST /cart/checkout line.
Click on the blue link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user."><meta itemprop=dateModified content="2024-09-19T16:47:03+01:00"><meta itemprop=wordCount content="561"><title>8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops</title>
<link href=https://splunk.github.io/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/index.html rel=canonical type=text/html title="8. Correlate between Splunk RUM and APM backend services :: Splunk Observability Cloud Workshops"><link href=/observability-workshop/v5.68/images/favicon.ico?1727454570 rel=icon type=image/x-icon sizes=any><link href=/observability-workshop/v5.68/css/fontawesome-all.min.css?1727454570 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.68/css/fontawesome-all.min.css?1727454570 rel=stylesheet></noscript><link href=/observability-workshop/v5.68/css/nucleus.css?1727454570 rel=stylesheet><link href=/observability-workshop/v5.68/css/auto-complete.css?1727454570 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.68/css/auto-complete.css?1727454570 rel=stylesheet></noscript><link href=/observability-workshop/v5.68/css/perfect-scrollbar.min.css?1727454570 rel=stylesheet><link href=/observability-workshop/v5.68/css/fonts.css?1727454570 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=/observability-workshop/v5.68/css/fonts.css?1727454570 rel=stylesheet></noscript><link href=/observability-workshop/v5.68/css/theme.css?1727454570 rel=stylesheet><link href=/observability-workshop/v5.68/css/theme-splunk-light.css?1727454570 rel=stylesheet id=R-variant-style><link href=/observability-workshop/v5.68/css/chroma-relearn-light.css?1727454570 rel=stylesheet id=R-variant-chroma-style><link href=/observability-workshop/v5.68/css/variant.css?1727454570 rel=stylesheet><link href=/observability-workshop/v5.68/css/print.css?1727454570 rel=stylesheet media=print><link href=/observability-workshop/v5.68/css/format-print.css?1727454570 rel=stylesheet><script src=/observability-workshop/v5.68/js/variant.js?1727454570></script><script>window.relearn=window.relearn||{},window.relearn.relBasePath="../../../..",window.relearn.relBaseUri="../../../../../..",window.relearn.absBaseUri="https://splunk.github.io/observability-workshop/v5.68",window.relearn.disableAnchorCopy=!1,window.relearn.disableAnchorScrolling=!1,window.index_js_url="/observability-workshop/v5.68/en/index.search.js?1727454570",window.variants&&variants.init(["splunk-light","splunk-dark"]),window.T_Copy_to_clipboard=`Copy to clipboard`,window.T_Copied_to_clipboard=`Copied to clipboard!`,window.T_Copy_link_to_clipboard=`Copy link to clipboard`,window.T_Link_copied_to_clipboard=`Copied link to clipboard!`,window.T_Reset_view=`Reset view`,window.T_View_reset=`View reset!`,window.T_No_results_found=`No results found for "{0}"`,window.T_N_results_found=`{1} results found for "{0}"`</script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web.js crossorigin=anonymous></script><script src=https://cdn.signalfx.com/o11y-gdi-rum/latest/splunk-otel-web-session-recorder.js crossorigin=anonymous></script><script>SplunkRum.init({realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA",applicationName:"observability-workshop",deploymentEnvironment:"splunk.github.io",version:"1.0"}),SplunkSessionRecorder.init({app:"observability-workshop",realm:"us1",rumAccessToken:"dp3FKraOS_wVhe-l7eCOsA"})</script></script><style>:root{--MAIN-WIDTH-MAX:130rem;--MENU-WIDTH-L:23rem}</style></head><body class="mobile-support print disableInlineCopyToClipboard" data-url=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/index.html><div id=R-body class=default-animation><div id=R-body-overlay></div><nav id=R-topbar><div class=topbar-wrapper><div class=topbar-sidebar-divider></div><div class="topbar-area topbar-area-start" data-area=start><div class="topbar-button topbar-button-sidebar" data-content-empty=disable data-width-s=show data-width-m=hide data-width-l=hide><button class=topbar-control onclick=toggleNav() type=button title="Menu (CTRL+ALT+n)"><i class="fa-fw fas fa-bars"></i></button></div></div><ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.68/en/index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.68/en/unsupported-field-workshops/index.html><span itemprop=name>Unsupported Field Workshops</span></a><meta itemprop=position content="2">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/index.html><span itemprop=name>Splunk RUM</span></a><meta itemprop=position content="3">&nbsp;>&nbsp;</li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>8. APM & RUM Correlation</span><meta itemprop=position content="4"></li></ol><div class="topbar-area topbar-area-end" data-area=end><div class="topbar-button topbar-button-prev" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/7-rum-sessions/index.html title="7. Analyzing RUM Sessions (ðŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a></div><div class="topbar-button topbar-button-next" data-content-empty=disable data-width-s=show data-width-m=show data-width-l=show><a class=topbar-control href=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/9-alerting/index.html title="9. Custom alerts and charts based on RUM Metrics (ðŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a></div></div></div></nav><div id=R-main-overlay></div><main id=R-body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><article class=default><header class=headline></header><h1 id=8-correlate-between-splunk-rum-and-apm-backend-services>8. Correlate between Splunk RUM and APM backend services</h1><ul><li>Continue with the RUM Session information in the RUM UI</li><li>See correlated APM traces and logs in the APM & Log Observer UI</li></ul><hr><h2 id=1-finding-backend-service-issues>1. Finding backend service issues</h2><p>Click on the <a href=#R-image-af70d877c49a72e78ef8c34f8d6001ae class=lightbox-link><img alt=RUM-JS class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af70d877c49a72e78ef8c34f8d6001ae><img alt=RUM-JS class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-JS-Error.png?classes=inline&height=25px"></a> to close the Span view.
Now continue to scroll down and find the <strong>POST /cart/checkout</strong> line.</p><p><a href=#R-image-c5aa280349c58dac5c318e7e649e3605 class=lightbox-link><img alt=RUM-APM-Click class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM-Click.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c5aa280349c58dac5c318e7e649e3605><img alt=RUM-APM-Click class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM-Click.png></a></p><p>Click on the blue <a href=#R-image-4f122cdbd14d2b6cf55239a233bed75b class=lightbox-link><img alt=RUM-APM-BLUE class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-4f122cdbd14d2b6cf55239a233bed75b><img alt=RUM-APM-BLUE class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM.png?classes=inline&height=25px"></a> link, this should pop up a dialog showing information on the backend services that were part of the checkout action taken by the end user.</p><p><a href=#R-image-7719d6e4e8e8152750b58240f7db8dad class=lightbox-link><img alt=RUM-APM-Trace class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-7719d6e4e8e8152750b58240f7db8dad><img alt=RUM-APM-Trace class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace.png></a></p><p>In this popup, there are multiple sections available, providing you with a quick insight in the behavior of your backend services. For example the Performance Summary section will tell you where the time was spent during the backend call.</p><p><a href=#R-image-3b0dcf552209d69e48acb299e53020ec class=lightbox-link><img alt=RUM-APM-Trace-perf class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Performance.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3b0dcf552209d69e48acb299e53020ec><img alt=RUM-APM-Trace-perf class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Performance.png></a></p><p>In the above example you can see that more than 77,9% was spent in external services.</p><p>If you scroll down to the bottom of the dialog, you can see the complete Trace and Services section like shown below:</p><p><a href=#R-image-251d9be7f1301b12665bd517a74573fb class=lightbox-link><img alt=RUM-APM-Trace-services class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Services.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-251d9be7f1301b12665bd517a74573fb><img alt=RUM-APM-Trace-services class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Services.png></a></p><p>in the Services map, you can see two services flagged red, the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service in both in dark red. Light red means it received an error and dark red means an error originated from that service.</p><p><a href=#R-image-04d8acbe5748eb1f5c948297fd6ddb7a class=lightbox-link><img alt=RUM-APM-Trace-services-detail class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-04d8acbe5748eb1f5c948297fd6ddb7a><img alt=RUM-APM-Trace-services-detail class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-Services-Detail.png></a>
So already it is obvious there is a problem in the back end services.</p><p>Let&rsquo;s investigate!</p><h2 id=2--follow-the-trace-to-the-backend-service>2. Follow the Trace to the Backend service</h2><p>You can now click on the Trace Id link:</p><p><a href=#R-image-3d1a32aa470a284ad502f3e63bc18885 class=lightbox-link><img alt=RUM-APM-Trace-link class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-url.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-3d1a32aa470a284ad502f3e63bc18885><img alt=RUM-APM-Trace-link class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-Trace-url.png></a></p><p>This will bring you to the Waterfall APM view that will show you what occurred in detail in a call to the backend services.
On the right you see the Trace Id: and again the Performance Summary, as we saw before.
In the waterfall, you can identify the various backend services that were part of this call from the frontend.</p><p>As you can see there are red error indicators <a href=#R-image-af41aa65fb46dfdb6b87edae8f76fe2b class=lightbox-link><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-af41aa65fb46dfdb6b87edae8f76fe2b><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px"></a> before the <strong>Checkout</strong> Service and the <strong>Payment</strong> Service.</p><p><a href=#R-image-c2a4771257282ce25093c33ce1aabde4 class=lightbox-link><img alt=RUM-APM-waterfall class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM-Waterfall.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-c2a4771257282ce25093c33ce1aabde4><img alt=RUM-APM-waterfall class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-APM-Waterfall.png></a></p><p>Click on the <a href=#R-image-43d8d565718df72783f1ba33f989277a class=lightbox-link><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow figure-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px" style=height:25px;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-43d8d565718df72783f1ba33f989277a><img alt=RUM-APM-error-flag class="noborder inline lazy lightbox noshadow lightbox-image" loading=lazy src="/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/APM_Error_Flag.png?classes=inline&height=25px"></a> after the <strong>paymentservice: grpc.hipstershop.PaymentService/Charge</strong> line.</p><p><a href=#R-image-ed445536b4451dea3e6cf8a8a707f1d2 class=lightbox-link><img alt=RUM-payment-click class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/payment-click.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-ed445536b4451dea3e6cf8a8a707f1d2><img alt=RUM-payment-click class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/payment-click.png></a></p><p>This will open the span detail page to show you the detailed information about this service call.
You wil see that the call returned a <strong>401</strong> error code or <em>Invalid Request</em>.</p><h2 id=3--use-the-related-content---logs>3. Use the Related Content - Logs</h2><p>As the Splunk Observability cloud suite correlates trace metrics and logs automatically, the system will show you in the related content bar at the bottom of the page, the corresponding logs for this trace.</p><p><a href=#R-image-2811ccad2ab288bf03631f66befcbae4 class=lightbox-link><img alt=RUM-payment-related-content class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/log-corelation.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-2811ccad2ab288bf03631f66befcbae4><img alt=RUM-payment-related-content class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/log-corelation.png></a></p><p>Click on the Log link to see the logs.</p><p>When the logs are shown, notice that the filter at the top of the page contains the logs for the trace.
Next select one of the lines indicating an error for the payment service.
This should open the log message on the right.</p><p>It clearly shows the reason why the payment service fails: we are using an invalid token towards the service:<br>*<strong>Failed payment processing through ButtercupPayments: Invalid API Token (test-20e26e90-356b-432e-a2c6-956fc03f5609)</strong></p><p><a href=#R-image-cf06a990b2cdc383a290745d46245db1 class=lightbox-link><img alt=RUM-logs class="noborder lazy lightbox noshadow figure-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-LogObserver.png style=height:auto;width:auto></a>
<a href=javascript:history.back(); class=lightbox-back id=R-image-cf06a990b2cdc383a290745d46245db1><img alt=RUM-logs class="noborder lazy lightbox noshadow lightbox-image" loading=lazy src=/observability-workshop/v5.68/en/unsupported-field-workshops/9-rum/8-apm-correlation/../images/RUM-LogObserver.png></a></p><h2 id=4--conclusion>4. Conclusion</h2><p>In the workshop, you have seen how to add RUM functionality to you website.
We investigate the performance of your Website using RUM Metrics.
Using the Tag profile, you have searched for your own session, and with the session waterfall, you identified two problems:</p><ul><li>A Java script error that caused your price calculation to be zero.</li><li>An issue in the payment backend service that caused payments to fail.</li></ul><p>Using the ability to correlate RUM traces with the Backend APM trace and Logs, you have found the reason for the payment failure.</p><p>This concludes the RUM workshop.</p><footer class=footline><span class="badge cstyle note badge-with-title"><span class=badge-title class=text-muted>Last Modified
</span><span class=badge-content>Sep 19, 2024</span></span></footer></article></div></main></div><script src=/observability-workshop/v5.68/js/clipboard.min.js?1727454570 defer></script><script src=/observability-workshop/v5.68/js/perfect-scrollbar.min.js?1727454570 defer></script><script src=/observability-workshop/v5.68/js/theme.js?1727454570 defer></script></body></html>
# 使用量をコントロールする - ラボの概要

* 個別のアクセストークンを作成し、制限を設けることで利用を制限する方法を紹介します

## 1. アクセストークン

ホスト、コンテナ、カスタムメトリクス、高解像度メトリクスの使用量をコントロールしたい場合は、複数のアクセストークンを作成し、組織内の異なる部分に割り当てることができます。

UIの左上のハンバーガーをクリックして、**Organizations Settings → Access Tokens** を選択します。

**Access Tokens** インターフェースでは、生成されたアクセストークンのリストで概要が表示されます。すべての組織では、最初のセットアップ時に **Default** のトークンが生成され、その他のトークンを追加・削除できるようになっています。

各トークンは一意であり、消費できるホスト、コンテナ、カスタムメトリクス、高解像度メトリクスの量に制限を設けることができます。

**Usage Status** 欄は、トークンが割り当てられた制限値を上回っているか下回っているかを素早く表示します。

![New token](../images/servicebureau/access-tokens.png)

## 2. 新しいトークンの作成

**New Token**{: .label-button .sfx-ui-button-blue} ボタンをクリックして、新しいトークンを作成しましょう。**Name Your Access Token** ダイアログが表示されます。

ここでは、**Ingest Token** と **API Token** の両方のチェックボックスにチェックを入れてください。

![Name Your token](../images/servicebureau/new-access-token.png){: .shadow}

**OK**{: .label-button .sfx-ui-button-blue} を押すと、**Access Token** のUIに戻ります。ここでは、他の人が作成したトークンの中に、あなたの新しいトークンが表示されているはずです。

![full tokenlist](../images/servicebureau/access-token-created.png)

名前を間違えたり、トークンを無効/有効にしたり、トークンの制限を設定したい場合は、トークンの制限の後ろにある省略記号(**...**)のメニューボタンをクリックして、トークンの管理メニューを開きます。

![Show Menu](../images/servicebureau/manage-access-token.png)

タイプミスがあった場合は、**Rename Token** オプションを使用して、トークンの名前を修正することができます。

## 3. トークンの無効化

トークンがメトリクスの送信に使用できないようにする必要がある場合は、トークンを無効にすることができます。

**Disable** ボタンを押すことで、トークンを無効化できます。これにより、トークンがSplunk Observability Cloudへのデータ送信に使用できなくなります。

以下のスクリーンショットのように、トークンの行がグレーになり、無効化されたことを示しています。

![Token disabled](../images/servicebureau/disable-access-token.png)

省略記号(**...**)のメニューボタンをクリックして、トークンの無効化と有効化を行ってください。

## 4. トークンの使用制限の管理

**...** メニューの **Manage Token Limit** をクリックして、使用量を制限してみましょう。

トークン制限管理ダイアログが表示されます。

![Set Limits on token](../images/servicebureau/manage-token-limit.png){: .shadow}

このダイアログでは、カテゴリごとに制限を設定することができます。

先に進み、各使用指標に対して以下のように制限を指定してください。

| リミット              | 値  |
| -------------------- | -- |
| ホストの制限           |  5 |
| コンテナ制限           | 15 |
| カスタムメトリクスの制限 | 20 |
| 高解像度メトリックの制限 |  0 |

また、上の表に示すように、ダイアログボックスに正しい数字が表示されていることを再確認してください。

トークンリミットは、5分間の使用量がリミットの90％を超えたときに、1人または複数の受信者に通知するアラートのトリガーとして使用されます。

受信者を指定するには、**Add Recipient**{: .label-button .sfx-ui-button-blue} をクリックして、使用する受信者または通知方法を選択します（受信者の指定は任意ですが、強くお勧めします）。

トークンアラートの重大度は常に「Critical」です。

**Update**{: .label-button .sfx-ui-button-blue} をクリックすると、アクセストークンの制限とアラートの設定が保存されます。

!!! note "トークンの上限を超えた場合"
    トークンが使用カテゴリの上限に達したとき、または上限を超えたとき、その使用カテゴリの新しいメトリクスはObservability Cloudに保存されず、処理されません。これにより、チームが無制限にデータを送信することによる予期せぬコストが発生しないようになります。

!!! note "高度なアラート"
    90%に達する前にアラートを取得したい場合は、必要な値を使用して追加のディテクターを作成できます。これらのディテクターは、特定のアクセストークンを消費しているチームをターゲットにすることができ、管理者が関与する必要がある前に行動を起こすことができます。

これらの新しいアクセストークンを様々なチームに配布し、Observability Cloudに送信できる情報やデータの量をコントロールできるようになります。

これにより、Observability Cloudの使用量を微調整することができ、過剰な使用を防ぐことができます。

**おめでとうございます！** これで、サービスビューローモジュールを完了しました。

<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=generator content="Relearn 5.11.2+tip"><meta name=description content="Splunk Observability Workshops"><title>Build a Distributed Trace in Lambda :: Splunk Observability Cloud Workshops</title><link href=../../../tko/session-6/lab2/index.xml rel=alternate type=application/rss+xml title="Build a Distributed Trace in Lambda :: Splunk Observability Cloud Workshops"><link href=../../../tko/session-6/lab2/index.print.html rel=alternate type=text/html title="Build a Distributed Trace in Lambda :: Splunk Observability Cloud Workshops"><link href=../../../images/favicon.ico?1676905180 rel=icon type=image/x-icon><link href=../../../css/fontawesome-all.min.css?1676905180 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/fontawesome-all.min.css?1676905180 rel=stylesheet></noscript><link href=../../../css/nucleus.css?1676905180 rel=stylesheet><link href=../../../css/auto-complete.css?1676905180 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/auto-complete.css?1676905180 rel=stylesheet></noscript><link href=../../../css/perfect-scrollbar.min.css?1676905180 rel=stylesheet><link href=../../../css/fonts.css?1676905180 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=../../../css/fonts.css?1676905180 rel=stylesheet></noscript><link href=../../../css/theme.css?1676905180 rel=stylesheet><link href=../../../css/theme-splunk-light.css?1676905180 rel=stylesheet id=variant-style><link href=../../../css/variant.css?1676905180 rel=stylesheet><link href=../../../css/print.css?1676905180 rel=stylesheet media=print><link href=../../../css/ie.css?1676905180 rel=stylesheet><script src=../../../js/url.js?1676905180></script>
<script src=../../../js/variant.js?1676905180></script>
<script>window.index_js_url="../../../index.search.js";var root_url="../../../",baseUriFull,baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",window.T_No_results_found="No results found for \u0022{0}\u0022",window.T_N_results_found="{1} results found for \u0022{0}\u0022",baseUriFull="https://splunk.github.io/observability-workshop/v4.65/",window.variants&&variants.init(["splunk-light","splunk-dark","aws"])</script></head><body class="mobile-support html disableInlineCopyToClipboard" data-url=../../../tko/session-6/lab2/index.html><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next topbar-link" href=../../../other/index.html title="Other Workshops (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev topbar-link" href=../../../tko/session-6/lab1/index.html title="6. O11y - Distributed Tracing for modern applications (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=top-print-link><a class="print-link topbar-link" title='Print whole chapter (CTRL+ALT+p)' href=../../../tko/session-6/lab2/index.print.html><i class="fas fa-print fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle class=topbar-link title='Menu (CTRL+ALT+n)'><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title='Table of Contents (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../index.html><span itemprop=name>Splunk Observability Workshops</span></a><meta itemprop=position content="1">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../tko/index.html><span itemprop=name>TKO Workshops</span></a><meta itemprop=position content="2">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><a itemprop=item href=../../../tko/session-6/index.html><span itemprop=name>6. O11y - Distributed Tracing for modern applications</span></a><meta itemprop=position content="3">></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><span itemprop=name>Build a Distributed Trace in Lambda</span><meta itemprop=position content="4"></li></ol></div><div class="default-animation progress"><div class=toc-wrapper><nav id=TableOfContents><ul><li><a href=#pre-requisites>Pre-Requisites</a><ul><li><a href=#1-set-environment-variables>1. Set Environment Variables</a></li><li><a href=#2-update-auto-instrumentation-serverless-template>2. Update Auto-instrumentation serverless template</a></li><li><a href=#3-update-manual-instrumentation-template>3. Update Manual instrumentation template</a></li><li><a href=#4-set-your-aws-credentials>4. Set your AWS Credentials</a></li></ul></li><li><a href=#auto-instrumentation>Auto-Instrumentation</a><ul><li><a href=#deploy-your-lambdas>Deploy your Lambdas</a></li><li><a href=#send-some-traffic>Send some Traffic</a></li><li><a href=#find-your-lambda-data-in-splunk-apm>Find your Lambda data in Splunk APM</a></li></ul></li><li><a href=#manual-instrumentation>Manual Instrumentation</a><ul><li><a href=#inject-trace-context-in-producer-function>Inject Trace Context in Producer Function</a></li><li><a href=#re-deploy-your-lambdas>Re-deploy your Lambdas</a></li><li><a href=#send-some-traffic-again>Send some Traffic again</a></li><li><a href=#find-your-updated-lambda-data-in-splunk-apm>Find your updated Lambda data in Splunk APM</a></li></ul></li><li><a href=#before-you-go>Before you Go</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags></div><article class=default><h1 id=build-a-distributed-trace-in-lambda>Build a Distributed Trace in Lambda</h1><p>This lab will make a tracing superhero out of you!</p><p>In this lab you will learn how a distributed trace is constructed for a small serverless application that runs on <a href=https://aws.amazon.com/lambda/ target=_blank>AWS Lambda</a>, producing and consuming your message via <a href=https://aws.amazon.com/kinesis/ target=_blank>AWS Kinesis</a>.</p><p><a href=#image-be66d4a824dc3202181ec16ad18d2dcf class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219358330-50022c0d-7882-47a3-a047-c4edda81de0d.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-be66d4a824dc3202181ec16ad18d2dcf><img src=https://user-images.githubusercontent.com/5187861/219358330-50022c0d-7882-47a3-a047-c4edda81de0d.png alt=image class=lightbox-image loading=lazy></a></p><h2 id=pre-requisites>Pre-Requisites</h2><p>You should already have the lab content available on your EC2 lab host.</p><p>Ensure that this lab&rsquo;s required folder <code>o11y-lambda-lab</code> is on your home directory:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button>
<button data-tab-item=Output class=tab-nav-button onclick='switchTab("default","Output")'>
<span>Output</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~ <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> ls
</span></span></code></pre></div></div><div data-tab-item=Output class=tab-content-text><p>o11y-lambda-lab</p></div></div></div><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>If you don&rsquo;t see it, fetch the lab contents by running the following command:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git clone https://github.com/kdroukman/o11y-lambda-lab.git
</span></span></code></pre></div></div></div><h3 id=1-set-environment-variables>1. Set Environment Variables</h3><p>In your Splunk Observability Cloud Organisation (Org) obtain your Access Token and Realm Values.</p><p>Please reset your environment variables from the earlier lab. Take care that for this lab we may be using different names - make sure to match the Environment Variable names bellow.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Export Environment Variables" class="tab-nav-button active" onclick='switchTab("default","Export Environment Variables")'>
<span>Export Environment Variables</span></button></div><div class=tab-content><div data-tab-item="Export Environment Variables" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>export</span> <span style=color:#000>ACCESS_TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span>CHANGE_ME <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span><span style=color:#204a87>export</span> <span style=color:#000>REALM</span><span style=color:#ce5c00;font-weight:700>=</span>CHANGE_ME <span style=color:#4e9a06>\
</span></span></span><span style=display:flex><span><span style=color:#4e9a06></span><span style=color:#204a87>export</span> <span style=color:#000>PREFIX</span><span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span>
</span></span></code></pre></div></div></div></div><h3 id=2-update-auto-instrumentation-serverless-template>2. Update Auto-instrumentation serverless template</h3><p>Update your auto-instrumentation Serverless template to include new values from the Enviornment variables.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Substitute Environment Variables" class="tab-nav-button active" onclick='switchTab("default","Substitute Environment Variables")'>
<span>Substitute Environment Variables</span></button></div><div class=tab-content><div data-tab-item="Substitute Environment Variables" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/o11y-lambda-lab/auto/serverless_unset.yml <span style=color:#000;font-weight:700>|</span> envsubst &gt; ~/o11y-lambda-lab/auto/serverless.yml
</span></span></code></pre></div></div></div></div><p>Examine the output of the updated serverless.yml contents (you may need to scroll up to the relevant section).</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Check file contents" class="tab-nav-button active" onclick='switchTab("default","Check file contents")'>
<span>Check file contents</span></button>
<button data-tab-item="Expected Content" class=tab-nav-button onclick='switchTab("default","Expected Content")'>
<span>Expected Content</span></button></div><div class=tab-content><div data-tab-item="Check file contents" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/o11y-lambda-lab/auto/serverless.yml
</span></span></code></pre></div></div><div data-tab-item="Expected Content" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># USER SET VALUES =====================              
</span></span><span style=display:flex><span>custom: 
</span></span><span style=display:flex><span>  accessToken: &lt;updated to your Access Token&gt;
</span></span><span style=display:flex><span>  realm: &lt;updated to your Realm&gt;
</span></span><span style=display:flex><span>  prefix: &lt;updated to your Hostname&gt;
</span></span><span style=display:flex><span>#====================================== 
</span></span></code></pre></div></div></div></div><h3 id=3-update-manual-instrumentation-template>3. Update Manual instrumentation template</h3><p>Update your manual instrumentation Serverless template to include new values from the Enviornment variables.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Substitute Environment Variables" class="tab-nav-button active" onclick='switchTab("default","Substitute Environment Variables")'>
<span>Substitute Environment Variables</span></button></div><div class=tab-content><div data-tab-item="Substitute Environment Variables" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/o11y-lambda-lab/manual/serverless_unset.yml <span style=color:#000;font-weight:700>|</span> envsubst &gt; ~/o11y-lambda-lab/manual/serverless.yml
</span></span></code></pre></div></div></div></div><p>Examine the output of the updated serverless.yml contents (you may need to scroll up to the relevant section).</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Check file contents" class="tab-nav-button active" onclick='switchTab("default","Check file contents")'>
<span>Check file contents</span></button>
<button data-tab-item="Expected Content" class=tab-nav-button onclick='switchTab("default","Expected Content")'>
<span>Expected Content</span></button></div><div class=tab-content><div data-tab-item="Check file contents" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat ~/o11y-lambda-lab/manual/serverless.yml
</span></span></code></pre></div></div><div data-tab-item="Expected Content" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span># USER SET VALUES =====================              
</span></span><span style=display:flex><span>custom: 
</span></span><span style=display:flex><span>  accessToken: &lt;updated to your Access Token&gt;
</span></span><span style=display:flex><span>  realm: &lt;updated to your Realm&gt;
</span></span><span style=display:flex><span>  prefix: &lt;updated to your Hostname&gt;
</span></span><span style=display:flex><span>#====================================== 
</span></span></code></pre></div></div></div></div><h3 id=4-set-your-aws-credentials>4. Set your AWS Credentials</h3><p>You will be provided with AWS Access Key ID and AWS Secret Access Key values - substitue these values in place of <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_ACCESS_KEY_SECRET</code> in the bellow command:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Set AWS Credentials" class="tab-nav-button active" onclick='switchTab("default","Set AWS Credentials")'>
<span>Set AWS Credentials</span></button></div><div class=tab-content><div data-tab-item="Set AWS Credentials" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls config credentials --provider aws --key AWS_ACCCESS_KEY_ID --secret AWS_ACCESS_KEY_SECRET
</span></span></code></pre></div></div></div></div><p>This command will create a file <code>~/.aws/credentials</code> with your AWS Credentails populated.</p><p>Note that we are using <code>sls</code> here, which is a <a href=https://www.serverless.com/ target=_blank>Serverless</a> framework for developing and deploying AWS Lambda functions. We will be using this command throughout the lab.</p><p>Now you are set up and ready go!</p><h2 id=auto-instrumentation>Auto-Instrumentation</h2><p>Navigate to the <code>auto</code> directory that contains auto-instrumentation code.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/o11y-lambda-lab/auto
</span></span></code></pre></div></div></div></div><p>Inspect the contents of the files in this directory.
Take a look at the <code>serverless.yml</code> template.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat serverless.yml
</span></span></code></pre></div></div></div></div><ol><li>Can you identify which AWS entities are being created by this template?</li><li>Can you identify where OpenTelemetry instrumentation is being set up?</li><li>Can you determine which instrumentation information is being provided by the Environment Variables?</li></ol><p>You should see the Splunk OpenTelemetry Lambda layer being added to each fuction.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>layers:
</span></span><span style=display:flex><span>      - arn:aws:lambda:us-east-1:254067382080:layer:splunk-apm:70
</span></span></code></pre></div><p>You can see the relevant layer ARNs (Amazon Resource Name) and latest versions for each AWS region here: <a href=https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md target=_blank>https://github.com/signalfx/lambda-layer-versions/blob/main/splunk-apm/splunk-apm.md</a></p><p>You should also see a section where the Environment variables that are being set.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span> environment:
</span></span><span style=display:flex><span>      AWS_LAMBDA_EXEC_WRAPPER: /opt/nodejs-otel-handler
</span></span><span style=display:flex><span>      OTEL_RESOURCE_ATTRIBUTES: deployment.environment=${self:custom.prefix}-apm-lambda
</span></span><span style=display:flex><span>      OTEL_SERVICE_NAME: consumer-lambda
</span></span><span style=display:flex><span>      SPLUNK_ACCESS_TOKEN: ${self:custom.accessToken}
</span></span><span style=display:flex><span>      SPLUNK_REALM: ${self:custom.realm}
</span></span></code></pre></div><p>Using the environment variables we are configuring and enriching our auto-instrumentation.</p><p>Here we provide minimum information, such as NodeJS wrapper location in the Splunk APM Layer, environment name, service name, and our Splunk Org credentials. We are sending trace data directly to Splunk Observability Cloud. You could alternatively export traces to an OpenTelemetry Collector set up in <a href=https://opentelemetry.io/docs/collector/deployment/#gateway target=_blank>Gateway</a> mode.</p><p>Take a look at the function code.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat handler.js
</span></span></code></pre></div></div></div></div><ol><li>Can you identify the code for <strong>producer</strong> function?</li><li>Can you identify the code for <strong>consumer</strong> function?</li></ol><p>Notice there is no mention of Splunk or OpenTelemetry in the code. We are adding the instrumentation using the Lambda layer and Environment Variables only.</p><h3 id=deploy-your-lambdas>Deploy your Lambdas</h3><p>Run the following command to deploy your Lambda Functions:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Deploy Command" class="tab-nav-button active" onclick='switchTab("default","Deploy Command")'>
<span>Deploy Command</span></button>
<button data-tab-item="Expected Output" class=tab-nav-button onclick='switchTab("default","Expected Output")'>
<span>Expected Output</span></button></div><div class=tab-content><div data-tab-item="Deploy Command" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls deploy
</span></span></code></pre></div></div><div data-tab-item="Expected Output" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Deploying hostname-lambda-lab to stage dev (us-east-1)
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>endpoint: POST - https://randomstring.execute-api.us-east-1.amazonaws.com/dev/producer
</span></span><span style=display:flex><span>functions:
</span></span><span style=display:flex><span>  producer: hostname-lambda-lab-dev-producer (1.6 kB)
</span></span><span style=display:flex><span>  consumer: hostname-lambda-lab-dev-consumer (1.6 kB)
</span></span></code></pre></div></div></div></div><p>This command will follow the instructions in your <code>serverless.yml</code> template to create your Lambda functions and your Kinesis stream.
Note it may take a <em>1-2 minutes</em> to execute.</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p><code>serverless.yml</code> is in fact a CloudFormation template. CloudFormation is an infrastructure as code service from AWS. You can read more about it here - <a href=https://aws.amazon.com/cloudformation/ target=_blank>https://aws.amazon.com/cloudformation/</a></p></div></div><p>Check the details of your serverless functions:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls info
</span></span></code></pre></div></div></div></div><p>Take note of your endpoint value:</p><p><a href=#image-c4c0cf0dd6dc4d5f9458775dc3413da5 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219366650-2babbe19-8253-43a0-8521-f47c1dda7200.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-c4c0cf0dd6dc4d5f9458775dc3413da5><img src=https://user-images.githubusercontent.com/5187861/219366650-2babbe19-8253-43a0-8521-f47c1dda7200.png alt=image class=lightbox-image loading=lazy></a></p><h3 id=send-some-traffic>Send some Traffic</h3><p>Use the <code>curl</code> command to send a payload to your <strong>producer</strong> function.
Note the command option <code>-d</code> is followed by your message payload.</p><p>Try changing the value of <code>name</code> to your name and telling the Lambda function about your <code>superpower</code>.
Replace <code>YOUR_ENDPOINT</code> with the endpoint from your previous step.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{ &#34;name&#34;: &#34;CHANGE_ME&#34;, &#34;superpower&#34;: &#34;CHANGE_ME&#34; }&#39;</span> YOUR_ENDPOINT
</span></span></code></pre></div></div></div></div><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>curl -d &#39;{ &#34;name&#34;: &#34;Kate&#34;, &#34;superpower&#34;: &#34;Distributed Tracing&#34; }&#39; https://xvq043lj45.execute-api.us-east-1.amazonaws.com/dev/producer
</span></span></code></pre></div><p>You should see the following output if your message is successful:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Message placed in the Event Stream: hostname-eventSteam&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If unsuccessful, you will see:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Internal server error&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If this occurs, ask one of the lab facilitators for assistance.</p><p>If you see a success message, generate more load: <em>re-send that messate <strong>5+ times</strong></em>.
You should keep seeing a success message after each send.</p><p>Check the lambda logs output.</p><h4 id=producer-function-logs>Producer function logs</h4><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Producer Function Logs" class="tab-nav-button active" onclick='switchTab("default","Producer Function Logs")'>
<span>Producer Function Logs</span></button></div><div class=tab-content><div data-tab-item="Producer Function Logs" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls logs -f producer
</span></span></code></pre></div></div></div></div><h4 id=consumer-function-logs>Consumer function logs</h4><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Consumer Function Logs" class="tab-nav-button active" onclick='switchTab("default","Consumer Function Logs")'>
<span>Consumer Function Logs</span></button></div><div class=tab-content><div data-tab-item="Consumer Function Logs" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls logs -f consumer
</span></span></code></pre></div></div></div></div><p>Examine the logs carefully. Do you see OpenTelemetry being loaded? Look out for lines with <code>splunk-extension-wrapper</code>.</p><h3 id=find-your-lambda-data-in-splunk-apm>Find your Lambda data in Splunk APM</h3><p>Now it&rsquo;s time to check how your Lambda traffic has been captured in Splunk APM.</p><p>Navigate to your <a href=https://app.us1.signalfx.com target=_blank>Splunk Observability Cloud</a></p><p>Select APM from the Main Menu and then select your APM Environment. Your APM environment should be in the format <code>$(hostname)-apm-lambda</code> where the hostname value is a four letter name of your lab host. (Check it by looking at your command prompt, or by running <code>echo $(hostname)</code>)</p><div class="box notices cstyle note"><div class=box-label><i class="fa-fw fas fa-exclamation-circle"></i> Note</div><div class=box-content><p>It may take a few minutes for you traces to appear in Splunk APM. Try hitting refresh on your browser until you find your environement name in the list of Envrionments</p></div></div><p><a href=#image-2bc49b019ca43a9bcc4ee908ec2aed0e class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219368081-20a1522e-a908-40d8-b635-942bffdbb0bd.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-2bc49b019ca43a9bcc4ee908ec2aed0e><img src=https://user-images.githubusercontent.com/5187861/219368081-20a1522e-a908-40d8-b635-942bffdbb0bd.png alt=image class=lightbox-image loading=lazy></a></p><p>Go to Explore the Service Map to see the Dependencies between your Lambda Functions.</p><p><a href=#image-14e7330042899ce626eaf78a04c6cd93 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219001784-a25e7c9f-981d-49b9-b6df-f39d2bff0975.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-14e7330042899ce626eaf78a04c6cd93><img src=https://user-images.githubusercontent.com/5187861/219001784-a25e7c9f-981d-49b9-b6df-f39d2bff0975.png alt=image class=lightbox-image loading=lazy></a></p><p>You should be able to see the <code>producer-lambda</code> and the call it is making to <code>Kinesis</code> service. What about your <code>consumer-lambda</code>?
<a href=#image-f43c0aad4a307208b4873c67010dbbd0 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219368350-5bebb65b-d658-42be-9895-5d39a8d60a2d.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-f43c0aad4a307208b4873c67010dbbd0><img src=https://user-images.githubusercontent.com/5187861/219368350-5bebb65b-d658-42be-9895-5d39a8d60a2d.png alt=image class=lightbox-image loading=lazy></a></p><p>Click into <em>Traces</em> and examine some traces that container <strong>procuder</strong> function calls and traces with <strong>consumer</strong> function calls.
<a href=#image-39f771121182fdf4092ce05960d34b34 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219002535-d11afd2f-9134-4e1b-87fb-f3af47969372.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-39f771121182fdf4092ce05960d34b34><img src=https://user-images.githubusercontent.com/5187861/219002535-d11afd2f-9134-4e1b-87fb-f3af47969372.png alt=image class=lightbox-image loading=lazy></a></p><p>We can see the <code>producer-lambda</code> putting a Record on the Kinesis stream. But the action of <code>consumer-function</code> is disconnected!</p><p>This is because the <strong>Trace Context</strong> is not being propagated.</p><p>This is not something that is supported automatically Out-of-the-Box by Kinesis service at the time of this lab. Our Distributed Trace stops at <em>Kinesis</em> inferred service, and we can&rsquo;t see the propagation any further.</p><p>Not yet&mldr;</p><p>Let&rsquo;s see how we work around this in the next section of this lab.</p><h2 id=manual-instrumentation>Manual Instrumentation</h2><p>Navigate to the <code>manual</code> directory that contains manually instrumentated code.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#204a87>cd</span> ~/o11y-lambda-lab/manual
</span></span></code></pre></div></div></div></div><p>Inspect the contents of the files in this directory.
Take a look at the <code>serverless.yml</code> template.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat serverless.yml
</span></span></code></pre></div></div></div></div><p>Do you see any difference from the same file in your <code>auto</code> directory?</p><p>You can try to compare them with a <code>diff</code> command:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Diff Command" class="tab-nav-button active" onclick='switchTab("default","Diff Command")'>
<span>Diff Command</span></button>
<button data-tab-item="Expected Output" class=tab-nav-button onclick='switchTab("default","Expected Output")'>
<span>Expected Output</span></button></div><div class=tab-content><div data-tab-item="Diff Command" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>diff ~/o11y-lambda-lab/auto/serverless.yml ~/o11y-lambda-lab/manual/serverless.yml 
</span></span></code></pre></div></div><div data-tab-item="Expected Output" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>19c19
</span></span><span style=display:flex><span>&lt; #======================================    
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span>&gt; #======================================   
</span></span></code></pre></div></div></div></div><p>There is no difference! <em>(Well, there shouldn&rsquo;t be. Ask your lab facilitator to assist you if there is)</em></p><p>Now compare <code>handler.js</code> it with the same file in <code>auto</code> directory using the <code>diff</code> command:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Diff Command" class="tab-nav-button active" onclick='switchTab("default","Diff Command")'>
<span>Diff Command</span></button></div><div class=tab-content><div data-tab-item="Diff Command" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>diff ~/o11y-lambda-lab/auto/handler.js ~/o11y-lambda-lab/manual/handler.js 
</span></span></code></pre></div></div></div></div><p>Look at all these differences!</p><p><em>You may wish to view the entire file with <code>cat handler.js</code> command and examine its content.</em></p><p>Notice how we are now importing some OpenTelemetry libraries directly into our function to handle some of the manual instrumenation tasks we require.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>const otelapi  = require(&#39;@opentelemetry/api&#39;);
</span></span><span style=display:flex><span>const otelcore = require(&#39;@opentelemetry/core&#39;);
</span></span></code></pre></div><p>We are using <a href=https://www.npmjs.com/package/@opentelemetry/api target=_blank>https://www.npmjs.com/package/@opentelemetry/api</a> to manipulate the tracing logic in our functions.
We are using <a href=https://www.npmjs.com/package/@opentelemetry/core target=_blank>https://www.npmjs.com/package/@opentelemetry/core</a> to access the <strong>Propagator</strong> objects that we will use to manually propagate our context with.</p><h3 id=inject-trace-context-in-producer-function>Inject Trace Context in Producer Function</h3><p>The bellow code executes the following steps inside the Producer function:</p><ol><li>Get the current Active Span.</li><li>Create a Propagator.</li><li>Initialize a context carrier object.</li><li>Inject the context of the active span into the carrier object.</li><li>Modify the record we are about to put on our Kinesis stream to include the carrier that will carry the active span&rsquo;s context to the consumer.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>const activeSpan = otelapi.trace.getSpan(otelapi.context.active());
</span></span><span style=display:flex><span>const propagator = new otelcore.W3CTraceContextPropagator();
</span></span><span style=display:flex><span>let carrier = {};
</span></span><span style=display:flex><span>propagator.inject(otelapi.trace.setSpanContext(otelapi.ROOT_CONTEXT, activeSpan.spanContext()),
</span></span><span style=display:flex><span>                 carrier,
</span></span><span style=display:flex><span>                otelapi.defaultTextMapSetter
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>const data = &#34;{\&#34;tracecontext\&#34;: &#34; + JSON.stringify(carrier) + &#34;, \&#34;record\&#34;:&#34; + event.body + &#34;}&#34;;
</span></span><span style=display:flex><span>console.log(`Record with Trace Context added: 
</span></span><span style=display:flex><span>             ${data}`);
</span></span></code></pre></div><h4 id=extract-trace-context-in-consumer-function>Extract Trace Context in Consumer Function</h4><p>The bellow code executes the following steps inside the Consumer function:</p><ol><li>Extract the context that we obtained from the Producer into a carrier object.</li><li>Create a Propagator.</li><li>Extract the context from the carrier object in Customer function&rsquo;s parent span context.</li><li>Start a new span with the parent span context.</li><li>Bonus: Add extra attributes to your span, including custom ones with the values from your message!</li><li>Once completed, end the span.</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>const carrier = JSON.parse( message ).tracecontext;
</span></span><span style=display:flex><span>const propagator = new otelcore.W3CTraceContextPropagator();
</span></span><span style=display:flex><span>const parentContext = propagator.extract(otelapi.ROOT_CONTEXT, carrier, otelapi.defaultTextMapGetter);
</span></span><span style=display:flex><span>const tracer = otelapi.trace.getTracer(process.env.OTEL_SERVICE_NAME);
</span></span><span style=display:flex><span>const span = tracer.startSpan(&#34;Kinesis.getRecord&#34;, undefined, parentContext);
</span></span><span style=display:flex><span>                         
</span></span><span style=display:flex><span>span.setAttribute(&#34;span.kind&#34;, &#34;server&#34;);
</span></span><span style=display:flex><span>const body = JSON.parse( message ).record;
</span></span><span style=display:flex><span>if (body.name) {
</span></span><span style=display:flex><span>    span.setAttribute(&#34;custom.tag.name&#34;, body.name);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> if (body.superpower) {
</span></span><span style=display:flex><span>    span.setAttribute(&#34;custom.tag.superpower&#34;, body.superpower);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>  --- function does some work
</span></span><span style=display:flex><span> span.end();
</span></span></code></pre></div><p>Now let&rsquo;s see the difference this makes.</p><h3 id=re-deploy-your-lambdas>Re-deploy your Lambdas</h3><p>While remaining in your <code>manual</code> directory, run the following commandd to re-deploy your Lambda Functions:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Deploy Producer Code" class="tab-nav-button active" onclick='switchTab("default","Deploy Producer Code")'>
<span>Deploy Producer Code</span></button>
<button data-tab-item="Expected Output" class=tab-nav-button onclick='switchTab("default","Expected Output")'>
<span>Expected Output</span></button></div><div class=tab-content><div data-tab-item="Deploy Producer Code" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls deploy -f producer
</span></span></code></pre></div></div><div data-tab-item="Expected Output" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Deploying function producer to stage dev (us-east-1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>✔ Function code deployed (6s)
</span></span><span style=display:flex><span>Configuration did not change. Configuration update skipped. (6s)
</span></span></code></pre></div></div></div></div><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Deploy Consumer Code" class="tab-nav-button active" onclick='switchTab("default","Deploy Consumer Code")'>
<span>Deploy Consumer Code</span></button>
<button data-tab-item="Expected Output" class=tab-nav-button onclick='switchTab("default","Expected Output")'>
<span>Expected Output</span></button></div><div class=tab-content><div data-tab-item="Deploy Consumer Code" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls deploy -f consumer
</span></span></code></pre></div></div><div data-tab-item="Expected Output" class=tab-content-text><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Deploying function consumer to stage dev (us-east-1)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>✔ Function code deployed (6s)
</span></span><span style=display:flex><span>Configuration did not change. Configuration update skipped. (6s)
</span></span></code></pre></div></div></div></div><p>Note that this deployment now only updates the code changes within the function. Our configuration remains the same.</p><p>Check the details of your serverless functions:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls info
</span></span></code></pre></div></div></div></div><p>You endpoint value should remain the same:</p><p><a href=#image-d70797049ae0ba0402b163d4c70cb1ba class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219371979-4e474746-2633-4824-9d7a-1b39d3d2ce3f.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-d70797049ae0ba0402b163d4c70cb1ba><img src=https://user-images.githubusercontent.com/5187861/219371979-4e474746-2633-4824-9d7a-1b39d3d2ce3f.png alt=image class=lightbox-image loading=lazy></a></p><h3 id=send-some-traffic-again>Send some Traffic again</h3><p>Use the <code>curl</code> command to send a payload to your <strong>producer</strong> function.
Note the command option <code>-d</code> is followed by your message payload.</p><p>Try changing the value of <code>name</code> to your name and telling the Lambda function about your <code>superpower</code>.
Replace <code>YOUR_ENDPOINT</code> with the endpoint from your previous step.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item=Command class="tab-nav-button active" onclick='switchTab("default","Command")'>
<span>Command</span></button></div><div class=tab-content><div data-tab-item=Command class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -d <span style=color:#4e9a06>&#39;{ &#34;name&#34;: &#34;CHANGE_ME&#34;, &#34;superpower&#34;: &#34;CHANGE_ME&#34; }&#39;</span> YOUR_ENDPOINT
</span></span></code></pre></div></div></div></div><p>For example:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>curl -d &#39;{ &#34;name&#34;: &#34;Kate&#34;, &#34;superpower&#34;: &#34;Distributed Tracing&#34; }&#39; https://xvq043lj45.execute-api.us-east-1.amazonaws.com/dev/producer
</span></span></code></pre></div><p>You should see the following output if your message is successful:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span><span style=color:#4e9a06>&#34;Message placed in the Event Stream: hostname-eventSteam&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If unsuccessful, you will see:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#000;font-weight:700>{</span><span style=color:#204a87;font-weight:700>&#34;message&#34;</span><span style=color:#000;font-weight:700>:</span> <span style=color:#4e9a06>&#34;Internal server error&#34;</span><span style=color:#000;font-weight:700>}</span>
</span></span></code></pre></div><p>If this occurs, ask one of the lab facilitators for assistance.</p><p>If you see a success message, generate more load: <em>re-send that messate <strong>5+ times</strong></em>. You should keep seeing a success message after each send.</p><p>Check the lambda logs output.</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Producer Function Logs" class="tab-nav-button active" onclick='switchTab("default","Producer Function Logs")'>
<span>Producer Function Logs</span></button></div><div class=tab-content><div data-tab-item="Producer Function Logs" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls logs -f producer
</span></span></code></pre></div></div></div></div><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Consumer Function Logs" class="tab-nav-button active" onclick='switchTab("default","Consumer Function Logs")'>
<span>Consumer Function Logs</span></button></div><div class=tab-content><div data-tab-item="Consumer Function Logs" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls logs -f consumer
</span></span></code></pre></div></div></div></div><p>Examine the logs carefully. Do you notice the difference?</p><p>Note that we are logging our Record together with the Trace context that we have added to it. Copy one of the underlined sub-sections of your trace parent context, and save it for later.</p><p><a href=#image-dd14fdb5c1eebe0b74dc49f3ba865a06 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219372916-ed1afce5-176f-4baf-a9a3-0aae29e3f01b.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-dd14fdb5c1eebe0b74dc49f3ba865a06><img src=https://user-images.githubusercontent.com/5187861/219372916-ed1afce5-176f-4baf-a9a3-0aae29e3f01b.png alt=image class=lightbox-image loading=lazy></a></p><h3 id=find-your-updated-lambda-data-in-splunk-apm>Find your updated Lambda data in Splunk APM</h3><p>Navigate back to APM in <a href=https://app.us1.signalfx.com/#/apm target=_blank>Splunk Observabilty Cloud</a></p><p>Go back to your Service Dependency map. Notice the difference?</p><p><a href=#image-ed83e37141a0531f5bd31c5f01512b40 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219373312-0d556475-9f27-4729-af38-ac94f0773c5c.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-ed83e37141a0531f5bd31c5f01512b40><img src=https://user-images.githubusercontent.com/5187861/219373312-0d556475-9f27-4729-af38-ac94f0773c5c.png alt=image class=lightbox-image loading=lazy></a></p><p>You should be able to see the <strong>consumer-lambda</strong> now clearly connected to the <strong>producer-lambda</strong>.</p><p>Remember the value you copied from your producer logs? You can run <code>sls logs -f consumer</code> command again on your EC2 lab host to fetch one.</p><p>Take that value, and paste it into trace search:</p><p><a href=#image-befd0da2b5140caf5ffbcd9060fe8933 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219373635-cc5a5841-5afb-49f9-baea-9d4d45aabfb6.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-befd0da2b5140caf5ffbcd9060fe8933><img src=https://user-images.githubusercontent.com/5187861/219373635-cc5a5841-5afb-49f9-baea-9d4d45aabfb6.png alt=image class=lightbox-image loading=lazy></a></p><p>Click on <em>Go</em> and you should be able to find the logged Trace:</p><p><a href=#image-b94d40a25040e1603a6d2edea1289714 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219374024-de32aa68-f34a-43eb-8f00-5cc698864b00.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-b94d40a25040e1603a6d2edea1289714><img src=https://user-images.githubusercontent.com/5187861/219374024-de32aa68-f34a-43eb-8f00-5cc698864b00.png alt=image class=lightbox-image loading=lazy></a></p><p>Notice that the <strong>Trace ID</strong> is something that makes up the trace <em>context</em> that we propagated.</p><p>You can read up on the two common propagation standards:</p><ol><li>W3C: <a href=https://www.w3.org/TR/trace-context/#traceparent-header target=_blank>https://www.w3.org/TR/trace-context/#traceparent-header</a></li><li>B3: <a href=https://github.com/openzipkin/b3-propagation#overall-process target=_blank>https://github.com/openzipkin/b3-propagation#overall-process</a></li></ol><p>Which one are we using? <em>It should be self-explanatory from the Propagator we are creating in the Functions</em></p><p><strong>Bonus Question:</strong> What happens if we mix and match the W3C and B3 headers?</p><p>Expand the <strong>consumer-lambda</strong> span. Can you find the attributes from your message?</p><p><a href=#image-8c0bbf64f6ce115337cb2636ac75e8e0 class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219374303-d143515b-d1b1-46b4-bd03-0c4653ea08c0.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-8c0bbf64f6ce115337cb2636ac75e8e0><img src=https://user-images.githubusercontent.com/5187861/219374303-d143515b-d1b1-46b4-bd03-0c4653ea08c0.png alt=image class=lightbox-image loading=lazy></a></p><h2 id=before-you-go>Before you Go</h2><p>Please kindly clean up your lab using the following command:</p><div class=tab-panel data-tab-group=default><div class=tab-nav><button data-tab-item="Remove Functions" class="tab-nav-button active" onclick='switchTab("default","Remove Functions")'>
<span>Remove Functions</span></button></div><div class=tab-content><div data-tab-item="Remove Functions" class="tab-content-text active"><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sls remove
</span></span></code></pre></div></div></div></div><h2 id=conclusion>Conclusion</h2><p>Congratuations on finishing the lab. You have seen how we complement auto-instrumentation with manual steps to force <strong>Producer</strong> function&rsquo;s context to be sent to <strong>Consumer</strong> function via a Record put on a Kinesis stream. This allowed us to build the expected Distributed Trace.</p><p><a href=#image-80492f2ad20da66da73dd70b85a5cbea class=lightbox-link><img src=https://user-images.githubusercontent.com/5187861/219375907-5a5e23ce-b9bb-4939-865d-7dbbaa668c53.png alt=image style=height:auto;width:auto loading=lazy></a>
<a href=javascript:history.back(); class=lightbox id=image-80492f2ad20da66da73dd70b85a5cbea><img src=https://user-images.githubusercontent.com/5187861/219375907-5a5e23ce-b9bb-4939-865d-7dbbaa668c53.png alt=image class=lightbox-image loading=lazy></a></p><p>You can now built out a Trace manually by linking two different functions together. This is very powerful when your auto-instrumenation, or third-party systems, do not support context propagation out of the box.</p><footer class=footline></footer></article></div></main></div><aside id=sidebar class="default-animation showVisitedLinks"><div id=header-wrapper class=default-animation><div id=header class=default-animation><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 -10 107 42.8" style="enable-background:new 0 -10 107 42.8"><style>.st0{fill:#fff}</style><title>splunk-logo</title><path class="st0" d="M11.5 19.8c0 .7-.1 1.4-.4 2s-.7 1.1-1.3 1.5c-.6.4-1.2.8-1.9 1-.8.2-1.6.4-2.4.4-1 0-1.9-.1-2.8-.4-.9-.3-1.8-.8-2.5-1.5l1.4-2.3c.6.5 1.2.9 1.8 1.2C3.8 22 4.4 22.2 5 22.1c.6.0 1.2-.2 1.7-.5.4-.4.7-.9.6-1.4.0-.2.0-.5-.1-.7-.1-.3-.2-.5-.4-.7-.3-.3-.6-.5-.9-.8-.4-.3-.8-.6-1.4-1-.4-.3-.9-.7-1.3-1s-.8-.6-1.1-1c-.3-.4-.6-.8-.8-1.2-.2-.5-.3-1-.3-1.6s.1-1.3.4-1.8c.3-.5.7-1 1.2-1.4s1.1-.7 1.7-.9C5 7.9 5.8 7.8 6.5 7.8c.8.0 1.7.1 2.5.3.8.2 1.5.6 2.2 1l-1.3 2c-.8-.6-1.7-.9-2.7-.9-.5.0-1 .1-1.4.4-.4.3-.6.7-.6 1.1s.2.9.5 1.2c.5.5 1.1 1 1.7 1.4.8.6 1.5 1.1 2 1.6.5.4.9.8 1.3 1.3.3.4.5.8.6 1.2C11.5 18.9 11.6 19.4 11.5 19.8"/><path class="st0" d="M25.8 16c.1-1.5-.3-2.9-1.1-4.2-.6-1-1.7-1.6-2.9-1.5-1.2.0-2.4.6-3.1 1.6-.8 1.3-1.2 2.9-1.1 4.4-.1 1.5.3 3 1.1 4.3.7 1 1.8 1.6 3.1 1.5.7.0 1.4-.2 1.9-.6.5-.4.9-.9 1.2-1.5s.5-1.3.7-2C25.7 17.3 25.8 16.7 25.8 16M30.3 15.8c0 1.2-.2 2.4-.6 3.5-.4 1-.9 2-1.6 2.8-1.4 1.6-3.4 2.5-5.5 2.5-.5.0-.9.0-1.4-.1-.4-.1-.8-.2-1.2-.4s-.8-.5-1.1-.8c-.4-.4-.8-.8-1.2-1.2v10.2h-4.2V8.1h4.2v2.3c.7-.9 1.5-1.6 2.5-2.1s2-.7 3.1-.7c1 0 2 .2 2.9.6s1.6.9 2.3 1.6 1.2 1.6 1.5 2.6C30.1 13.6 30.3 14.7 30.3 15.8"/><rect x="32.2" y=".6" class="st0" width="4.2" height="23.7"/><path class="st0" d="M50.3 24.3v-2.2c-.7.8-1.6 1.5-2.5 2-.9.4-2 .6-3 .6-1.1.0-2.2-.2-3.2-.8-.9-.5-1.5-1.3-1.9-2.2-.1-.2-.2-.5-.2-.7-.1-.3-.1-.6-.2-.9.0-.4-.1-.8-.1-1.1.0-.4.0-1 0-1.6V8.1h4.2v9.2c0 .6.0 1.3.1 1.9.1.4.2.8.4 1.2.5.9 1.6 1.5 2.6 1.4 1.4.1 2.8-.7 3.3-2 .2-.4.3-.8.3-1.1.1-.6.1-1.2.1-1.8V8.1h4.2v16.2H50.3z"/><path class="st0" d="M68.7 24.3V15c0-.6.0-1.3-.1-1.9-.1-.4-.2-.8-.4-1.2-.5-.9-1.6-1.5-2.6-1.4-.7.0-1.4.2-2.1.5-.6.3-1 .9-1.3 1.5-.2.4-.3.8-.3 1.2-.1.6-.1 1.2-.1 1.8v8.7h-4.3V8.1h4.3v2.2c.7-.8 1.6-1.5 2.5-2 .9-.4 2-.6 3-.6 1.1.0 2.2.2 3.2.8.9.5 1.5 1.3 1.9 2.2.1.2.2.5.2.7.1.3.1.6.2.9.0.4.1.8.1 1.1.0.4.0 1 0 1.6v9.2L68.7 24.3z"/><polygon class="st0" points="86.6,24.6 80.2,15.7 80.2,24.3 75.9,24.3 75.9,0.6 80.2,0.6 80.2,14.5 80.6,14.5 86.3,7.9 89.5,9.3 84.1,15.1 90.5,23.2"/><polygon class="st0" points="94.2,23.8 94.2,21 104.2,16.1 94.2,11.2 94.2,8.3 107.1,14.8 107.1,17.4"/><path class="st0" d="M95.5 4.1c.8.0 1.4.7 1.4 1.5S96.2 7 95.4 7C94.6 7 94 6.4 94 5.6 94 4.8 94.6 4.1 95.5 4.1 95.4 4.1 95.4 4.1 95.5 4.1zm0 .2c-.7.0-1.2.6-1.2 1.2.0.6.5 1.2 1.2 1.2.6.0 1.2-.5 1.2-1.2C96.7 4.9 96.1 4.4 95.5 4.3zM95.2 6.4h-.3V4.8c.2.0.3.0.5.0s.3.0.5.1C96 5 96.1 5.1 96 5.2c0 .2-.1.4-.3.4C95.9 5.6 96 5.8 96 6c0 .1.0.3.1.4h-.3c-.1-.1-.1-.3-.1-.4.0-.2-.1-.3-.3-.3h-.2v.7zm0-.9h.2c.2.0.4-.1.4-.3S95.7 5 95.4 5h-.2v.5z"/></svg></div><form action=../../../search.html method=get><div class="searchbox default-animation"><button type=submit title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
<label class=a11y-only for=search-by>Search</label>
<input data-search-input id=search-by name=search-by class=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div></form><script>var contentLangs=["ja","en"]</script><script src=../../../js/auto-complete.js?1676905181 defer></script>
<script src=../../../js/lunr/lunr.min.js?1676905181 defer></script>
<script src=../../../js/lunr/lunr.stemmer.support.min.js?1676905181 defer></script>
<script src=../../../js/lunr/lunr.multi.min.js?1676905181 defer></script>
<script src=../../../js/lunr/tinyseg.js?1676905181 defer></script>
<script src=../../../js/lunr/lunr.ja.min.js?1676905181 defer></script>
<script src=../../../js/lunr/lunr.en.min.js?1676905181 defer></script>
<script src=../../../js/search.js?1676905181 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=../../../index.html><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics collapsible-menu"><li data-nav-id=/imt/index.html class=dd-item><input type=checkbox id=section-cacc3102db66b140458a5b2dc8fd1e84 aria-controls=subsections-cacc3102db66b140458a5b2dc8fd1e84 class=toggle><label class="a11y-only toggle" for=section-cacc3102db66b140458a5b2dc8fd1e84>Submenu Splunk IM</label><a href=../../../imt/index.html>Splunk IM<i class="fas fa-check read-icon"></i></a><ul id=subsections-cacc3102db66b140458a5b2dc8fd1e84><li data-nav-id=/imt/initial-setup/index.html class=dd-item><a href=../../../imt/initial-setup/index.html>1. Access AWS/EC2 Instance<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/gdi/index.html class=dd-item><input type=checkbox id=section-e4b0906e412a1fefd38641cb47895e54 aria-controls=subsections-e4b0906e412a1fefd38641cb47895e54 class=toggle><label class="a11y-only toggle" for=section-e4b0906e412a1fefd38641cb47895e54>Submenu 2. Get Data In</label><a href=../../../imt/gdi/index.html>2. Get Data In<i class="fas fa-check read-icon"></i></a><ul id=subsections-e4b0906e412a1fefd38641cb47895e54><li data-nav-id=/imt/gdi/nginx/index.html class=dd-item><a href=../../../imt/gdi/nginx/index.html>2.1 Deploy and Monitor NGINX<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/imt/dashboards/index.html class=dd-item><input type=checkbox id=section-61aca98458d9474a5c1deef21a09316a aria-controls=subsections-61aca98458d9474a5c1deef21a09316a class=toggle><label class="a11y-only toggle" for=section-61aca98458d9474a5c1deef21a09316a>Submenu 3. Dashboards</label><a href=../../../imt/dashboards/index.html>3. Dashboards<i class="fas fa-check read-icon"></i></a><ul id=subsections-61aca98458d9474a5c1deef21a09316a><li data-nav-id=/imt/dashboards/editing/index.html class=dd-item><a href=../../../imt/dashboards/editing/index.html>3.1 Editing charts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/dashboards/savingcharts/index.html class=dd-item><a href=../../../imt/dashboards/savingcharts/index.html>3.2 Saving charts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/dashboards/filtering/index.html class=dd-item><a href=../../../imt/dashboards/filtering/index.html>3.3 Using Filters & Formulas<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/dashboards/signalflow/index.html class=dd-item><a href=../../../imt/dashboards/signalflow/index.html>3.4 SignalFlow<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/dashboards/adding-charts/index.html class=dd-item><a href=../../../imt/dashboards/adding-charts/index.html>3.5 Adding more charts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/dashboards/notes-and-layout/index.html class=dd-item><a href=../../../imt/dashboards/notes-and-layout/index.html>3.6 Notes and layout<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/imt/detectors/index.html class=dd-item><input type=checkbox id=section-88264d1f5623c424f98d3947a90d4c1e aria-controls=subsections-88264d1f5623c424f98d3947a90d4c1e class=toggle><label class="a11y-only toggle" for=section-88264d1f5623c424f98d3947a90d4c1e>Submenu 4. Detectors</label><a href=../../../imt/detectors/index.html>4. Detectors<i class="fas fa-check read-icon"></i></a><ul id=subsections-88264d1f5623c424f98d3947a90d4c1e><li data-nav-id=/imt/detectors/muting/index.html class=dd-item><a href=../../../imt/detectors/muting/index.html>4.1 Creating a Muting Rule<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/imt/monitoring-as-code/index.html class=dd-item><a href=../../../imt/monitoring-as-code/index.html>5. Monitoring as Code<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/servicebureau/index.html class=dd-item><input type=checkbox id=section-9bd7ac9c63c703f2e5cd0e92b93ef044 aria-controls=subsections-9bd7ac9c63c703f2e5cd0e92b93ef044 class=toggle><label class="a11y-only toggle" for=section-9bd7ac9c63c703f2e5cd0e92b93ef044>Submenu 6. Service Bureau</label><a href=../../../imt/servicebureau/index.html>6. Service Bureau<i class="fas fa-check read-icon"></i></a><ul id=subsections-9bd7ac9c63c703f2e5cd0e92b93ef044><li data-nav-id=/imt/servicebureau/teams/index.html class=dd-item><a href=../../../imt/servicebureau/teams/index.html>6.1 Teams<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/imt/servicebureau/tokens/index.html class=dd-item><a href=../../../imt/servicebureau/tokens/index.html>6.2 Control Usage<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/apm/index.html class=dd-item><input type=checkbox id=section-f08d4e4d9891c94f3d520f2f51a031c2 aria-controls=subsections-f08d4e4d9891c94f3d520f2f51a031c2 class=toggle><label class="a11y-only toggle" for=section-f08d4e4d9891c94f3d520f2f51a031c2>Submenu Splunk APM</label><a href=../../../apm/index.html>Splunk APM<i class="fas fa-check read-icon"></i></a><ul id=subsections-f08d4e4d9891c94f3d520f2f51a031c2><li data-nav-id=/apm/online-boutique/index.html class=dd-item><input type=checkbox id=section-4ca7ef32ec7d1d69bf8324606de57871 aria-controls=subsections-4ca7ef32ec7d1d69bf8324606de57871 class=toggle><label class="a11y-only toggle" for=section-4ca7ef32ec7d1d69bf8324606de57871>Submenu 1. Deploy the Online Boutique</label><a href=../../../apm/online-boutique/index.html>1. Deploy the Online Boutique<i class="fas fa-check read-icon"></i></a><ul id=subsections-4ca7ef32ec7d1d69bf8324606de57871><li data-nav-id=/apm/online-boutique/locust/index.html class=dd-item><a href=../../../apm/online-boutique/locust/index.html>1.1 Generate load using Locust<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/apm/using-splunk-apm/index.html class=dd-item><input type=checkbox id=section-4d3f52d94118ff1499ff5d1c32c4f7a6 aria-controls=subsections-4d3f52d94118ff1499ff5d1c32c4f7a6 class=toggle><label class="a11y-only toggle" for=section-4d3f52d94118ff1499ff5d1c32c4f7a6>Submenu 2. Using Splunk APM</label><a href=../../../apm/using-splunk-apm/index.html>2. Using Splunk APM<i class="fas fa-check read-icon"></i></a><ul id=subsections-4d3f52d94118ff1499ff5d1c32c4f7a6><li data-nav-id=/apm/using-splunk-apm/service_map/index.html class=dd-item><a href=../../../apm/using-splunk-apm/service_map/index.html>2.1 Service Map<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/apm/using-splunk-apm/tag_spotlight/index.html class=dd-item><a href=../../../apm/using-splunk-apm/tag_spotlight/index.html>2.2 Tag Spotlight<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/apm/using-splunk-apm/example_trace/index.html class=dd-item><a href=../../../apm/using-splunk-apm/example_trace/index.html>2.3 Example trace<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/rum/index.html class=dd-item><input type=checkbox id=section-2d4a228468ffe7961a407622de348030 aria-controls=subsections-2d4a228468ffe7961a407622de348030 class=toggle><label class="a11y-only toggle" for=section-2d4a228468ffe7961a407622de348030>Submenu Splunk RUM</label><a href=../../../rum/index.html>Splunk RUM<i class="fas fa-check read-icon"></i></a><ul id=subsections-2d4a228468ffe7961a407622de348030><li data-nav-id=/rum/1-overview/index.html class=dd-item><a href=../../../rum/1-overview/index.html>1. Overview<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/2-showcase/index.html class=dd-item><a href=../../../rum/2-showcase/index.html>2. Showcase<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/3-setup/index.html class=dd-item><a href=../../../rum/3-setup/index.html>3. Using RUM on your Website<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/4-rum-landing/index.html class=dd-item><a href=../../../rum/4-rum-landing/index.html>4. RUM Landing Page<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/5-browser-app-summary/index.html class=dd-item><a href=../../../rum/5-browser-app-summary/index.html>5. Browser Application Summary<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/6-analyzing-metrics/index.html class=dd-item><a href=../../../rum/6-analyzing-metrics/index.html>6. Analyzing RUM Metrics<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/7-tag-spotlight/index.html class=dd-item><a href=../../../rum/7-tag-spotlight/index.html>7. Using Tag Spotlight<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/8-rum-sessions/index.html class=dd-item><a href=../../../rum/8-rum-sessions/index.html>8. Analyzing RUM Sessions<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/9-apm-correlation/index.html class=dd-item><a href=../../../rum/9-apm-correlation/index.html>9. APM & RUM Correlation<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/10-alerting/index.html class=dd-item><a href=../../../rum/10-alerting/index.html>10. Alerts<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/rum/11-mobile-app-summary/index.html class=dd-item><a href=../../../rum/11-mobile-app-summary/index.html>11. Mobile Applications<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/synthetics/index.html class=dd-item><input type=checkbox id=section-197f0de93637f50d082c5ec6ab8b667b aria-controls=subsections-197f0de93637f50d082c5ec6ab8b667b class=toggle><label class="a11y-only toggle" for=section-197f0de93637f50d082c5ec6ab8b667b>Submenu Splunk Synthetics</label><a href=../../../synthetics/index.html>Splunk Synthetics<i class="fas fa-check read-icon"></i></a><ul id=subsections-197f0de93637f50d082c5ec6ab8b667b><li data-nav-id=/synthetics/real-browser-checks/index.html class=dd-item><a href=../../../synthetics/real-browser-checks/index.html>1. Real Browser Checks<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/synthetics/api-checks/index.html class=dd-item><a href=../../../synthetics/api-checks/index.html>2. API Checks<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/oncall/index.html class=dd-item><input type=checkbox id=section-f27c2accba03cd0a63aaf5f22f666205 aria-controls=subsections-f27c2accba03cd0a63aaf5f22f666205 class=toggle><label class="a11y-only toggle" for=section-f27c2accba03cd0a63aaf5f22f666205>Submenu Splunk OnCall</label><a href=../../../oncall/index.html>Splunk OnCall<i class="fas fa-check read-icon"></i></a><ul id=subsections-f27c2accba03cd0a63aaf5f22f666205><li data-nav-id=/oncall/getting_started/index.html class=dd-item><input type=checkbox id=section-e6dbeb1824f74c454676b919636c1c8f aria-controls=subsections-e6dbeb1824f74c454676b919636c1c8f class=toggle><label class="a11y-only toggle" for=section-e6dbeb1824f74c454676b919636c1c8f>Submenu 1. Getting Started</label><a href=../../../oncall/getting_started/index.html>1. Getting Started<i class="fas fa-check read-icon"></i></a><ul id=subsections-e6dbeb1824f74c454676b919636c1c8f><li data-nav-id=/oncall/getting_started/team/index.html class=dd-item><a href=../../../oncall/getting_started/team/index.html>1.1 Teams<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/oncall/getting_started/rotations/index.html class=dd-item><a href=../../../oncall/getting_started/rotations/index.html>1.2 Rotations<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/oncall/getting_started/escalation/index.html class=dd-item><a href=../../../oncall/getting_started/escalation/index.html>1.3 Escalation Policies<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/oncall/getting_started/routing/index.html class=dd-item><a href=../../../oncall/getting_started/routing/index.html>1.4 Routing Keys<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/oncall/incident_lifecycle/index.html class=dd-item><input type=checkbox id=section-08a295e8c40955314a135c57f14667cc aria-controls=subsections-08a295e8c40955314a135c57f14667cc class=toggle><label class="a11y-only toggle" for=section-08a295e8c40955314a135c57f14667cc>Submenu 2. Incident Lifecycle</label><a href=../../../oncall/incident_lifecycle/index.html>2. Incident Lifecycle<i class="fas fa-check read-icon"></i></a><ul id=subsections-08a295e8c40955314a135c57f14667cc><li data-nav-id=/oncall/incident_lifecycle/create_incidents/index.html class=dd-item><a href=../../../oncall/incident_lifecycle/create_incidents/index.html>2.1 Create Incidents<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/oncall/incident_lifecycle/manage_incidents/index.html class=dd-item><a href=../../../oncall/incident_lifecycle/manage_incidents/index.html>2.2 Manage Incidents<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/tko/index.html class="dd-item parent"><input type=checkbox id=section-db85eaf49422470e545b05eedd2e0120 aria-controls=subsections-db85eaf49422470e545b05eedd2e0120 class=toggle checked><label class="a11y-only toggle" for=section-db85eaf49422470e545b05eedd2e0120>Submenu TKO Workshops</label><a href=../../../tko/index.html>TKO Workshops<i class="fas fa-check read-icon"></i></a><ul id=subsections-db85eaf49422470e545b05eedd2e0120><li data-nav-id=/tko/session-2/index.html class=dd-item><input type=checkbox id=section-78afcc6eae778ecf7847bcd64fdb0089 aria-controls=subsections-78afcc6eae778ecf7847bcd64fdb0089 class=toggle><label class="a11y-only toggle" for=section-78afcc6eae778ecf7847bcd64fdb0089>Submenu Session 2</label><a href=../../../tko/session-2/index.html>Session 2<i class="fas fa-check read-icon"></i></a><ul id=subsections-78afcc6eae778ecf7847bcd64fdb0089><li data-nav-id=/tko/session-2/getting_started/index.html class=dd-item><a href=../../../tko/session-2/getting_started/index.html>Getting started<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-2/deploy/index.html class=dd-item><a href=../../../tko/session-2/deploy/index.html>Deployment<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-2/code_to_python/index.html class=dd-item><a href=../../../tko/session-2/code_to_python/index.html>Code to Kubernetes<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-2/instrument/index.html class=dd-item><a href=../../../tko/session-2/instrument/index.html>Instrumentation<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-2/forwarder/index.html class=dd-item><a href=../../../tko/session-2/forwarder/index.html>UF Deployment<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/tko/session-5/index.html class=dd-item><input type=checkbox id=section-3e61847691a4347245cab38cf2d54c73 aria-controls=subsections-3e61847691a4347245cab38cf2d54c73 class=toggle><label class="a11y-only toggle" for=section-3e61847691a4347245cab38cf2d54c73>Submenu Session 5</label><a href=../../../tko/session-5/index.html>Session 5<i class="fas fa-check read-icon"></i></a><ul id=subsections-3e61847691a4347245cab38cf2d54c73><li data-nav-id=/tko/session-5/deploy-otel/index.html class=dd-item><a href=../../../tko/session-5/deploy-otel/index.html>1. Deploy the OTel Collector<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-5/check-new-navigator-short/index.html class=dd-item><a href=../../../tko/session-5/check-new-navigator-short/index.html>2. Kubernetes Navigator v2<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-5/deploy-apache/index.html class=dd-item><a href=../../../tko/session-5/deploy-apache/index.html>3. Deploying PHP/Apache<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-5/fix-apache/index.html class=dd-item><a href=../../../tko/session-5/fix-apache/index.html>4. Fix PHP/Apache Issue<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-5/deploy-loadgen/index.html class=dd-item><a href=../../../tko/session-5/deploy-loadgen/index.html>5. Deploy Load Generator<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-5/setup-hpa/index.html class=dd-item><a href=../../../tko/session-5/setup-hpa/index.html>6. Setup HPA<i class="fas fa-check read-icon"></i></a></li></ul></li><li data-nav-id=/tko/session-6/index.html class="dd-item parent"><input type=checkbox id=section-2eb90612077cbb385496f5a561e70a70 aria-controls=subsections-2eb90612077cbb385496f5a561e70a70 class=toggle checked><label class="a11y-only toggle" for=section-2eb90612077cbb385496f5a561e70a70>Submenu Session 6</label><a href=../../../tko/session-6/index.html>Session 6<i class="fas fa-check read-icon"></i></a><ul id=subsections-2eb90612077cbb385496f5a561e70a70><li data-nav-id=/tko/session-6/lab1/index.html class=dd-item><a href=../../../tko/session-6/lab1/index.html>Module 1<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/tko/session-6/lab2/index.html class="dd-item active"><a href=../../../tko/session-6/lab2/index.html>Module 2<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li><li data-nav-id=/other/index.html class=dd-item><input type=checkbox id=section-94cf2303bb7e3418ce54e9f29b391e36 aria-controls=subsections-94cf2303bb7e3418ce54e9f29b391e36 class=toggle><label class="a11y-only toggle" for=section-94cf2303bb7e3418ce54e9f29b391e36>Submenu Other Workshops</label><a href=../../../other/index.html>Other Workshops<i class="fas fa-check read-icon"></i></a><ul id=subsections-94cf2303bb7e3418ce54e9f29b391e36><li data-nav-id=/other/pet-clinic/index.html class=dd-item><input type=checkbox id=section-7634e8be4fd16e127e84aa15b6d16a79 aria-controls=subsections-7634e8be4fd16e127e84aa15b6d16a79 class=toggle><label class="a11y-only toggle" for=section-7634e8be4fd16e127e84aa15b6d16a79>Submenu PetClinic Java Workshop</label><a href=../../../other/pet-clinic/index.html>PetClinic Java Workshop<i class="fas fa-check read-icon"></i></a><ul id=subsections-7634e8be4fd16e127e84aa15b6d16a79><li data-nav-id=/other/pet-clinic/docs/imt/index.html class=dd-item><a href=../../../other/pet-clinic/docs/imt/index.html>1. OpenTelemetry Collector<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/other/pet-clinic/docs/apm/index.html class=dd-item><a href=../../../other/pet-clinic/docs/apm/index.html>2. Zero Configuration<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/other/pet-clinic/docs/rum/index.html class=dd-item><a href=../../../other/pet-clinic/docs/rum/index.html>3. Real User Monitoring<i class="fas fa-check read-icon"></i></a></li><li data-nav-id=/other/pet-clinic/docs/logobserver/index.html class=dd-item><a href=../../../other/pet-clinic/docs/logobserver/index.html>4. Log Observer<i class="fas fa-check read-icon"></i></a></li></ul></li></ul></li></ul><div id=shortcuts><div class=nav-title>More</div><ul><li><a class=padding href=https://github.com/splunk/observability-workshop><i class='fab fa-fw fa-github'></i> GitHub Repository</a></li><li><a class=padding href=https://opentelemetry.io><i class="fab fa-fw fa-wpexplorer"></i> OpenTelemetry</a></li><li><a class=padding href=https://twitter.com/splunk><i class="fab fa-fw fa-twitter"></i> Twitter</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVariantSwitch showVisitedLinks showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showLangSwitch showVariantSwitch showVisitedLinks showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks showLangSwitch showVariantSwitch showVisitedLinks"><ul><li id=select-language-container class="footerLangSwitch showLangSwitch"><div class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-language>Language</label>
<select id=select-language onchange="location=baseUri+this.value"><option lang=en id=en value=/tko/session-6/lab2/index.html selected>English</option></select></div><div class=select-clear></div></div></li><li id=select-variant-container class="footerVariantSwitch showVariantSwitch"><div class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><label class=a11y-only for=select-variant>Theme</label>
<select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=splunk-light value=splunk-light selected>Splunk Light</option><option id=splunk-dark value=splunk-dark>Splunk Dark</option><option id=aws value=aws>Aws</option></select></div><div class=select-clear></div></div><script>window.variants&&variants.markSelectedVariant()</script></li><li class="footerVisitedLinks showVisitedLinks"><button class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</button></li></ul></div><div id=footer class="footerFooter showFooter"><style>#footer{font-size:13px;height:100px;margin-left:auto;margin-right:auto;padding:2rem 1rem;text-align:center;min-width:230px;max-width:300px}#footer p{margin:0}</style><p><a href=https://splunk.com title=Splunk>&copy; 2023 Splunk Inc. All Rights Reserved</a></p></div></div></aside><script src=../../../js/clipboard.min.js?1676905181 defer></script>
<script src=../../../js/perfect-scrollbar.min.js?1676905181 defer></script>
<script src=../../../js/theme.js?1676905181 defer></script></body></html>